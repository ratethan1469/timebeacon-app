(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function pp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var bm={exports:{}},ac={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function zT(){if(jv)return ac;jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,s){var l=null;if(s!==void 0&&(l=""+s),r.key!==void 0&&(l=""+r.key),"key"in r){s={};for(var u in r)u!=="key"&&(s[u]=r[u])}else s=r;return r=s.ref,{$$typeof:n,type:i,key:l,ref:r!==void 0?r:null,props:s}}return ac.Fragment=e,ac.jsx=t,ac.jsxs=t,ac}var Dv;function UT(){return Dv||(Dv=1,bm.exports=zT()),bm.exports}var d=UT(),Sm={exports:{}},nt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv;function HT(){if(Nv)return nt;Nv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function y(V){return V===null||typeof V!="object"?null:(V=v&&V[v]||V["@@iterator"],typeof V=="function"?V:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function T(V,he,I){this.props=V,this.context=he,this.refs=b,this.updater=I||S}T.prototype.isReactComponent={},T.prototype.setState=function(V,he){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,he,"setState")},T.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function E(){}E.prototype=T.prototype;function w(V,he,I){this.props=V,this.context=he,this.refs=b,this.updater=I||S}var C=w.prototype=new E;C.constructor=w,_(C,T.prototype),C.isPureReactComponent=!0;var j=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function D(V,he,I,Y,G,K){return I=K.ref,{$$typeof:n,type:V,key:he,ref:I!==void 0?I:null,props:K}}function z(V,he){return D(V.type,he,void 0,void 0,void 0,V.props)}function R(V){return typeof V=="object"&&V!==null&&V.$$typeof===n}function W(V){var he={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(I){return he[I]})}var q=/\/+/g;function J(V,he){return typeof V=="object"&&V!==null&&V.key!=null?W(""+V.key):he.toString(36)}function me(){}function Ce(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(me,me):(V.status="pending",V.then(function(he){V.status==="pending"&&(V.status="fulfilled",V.value=he)},function(he){V.status==="pending"&&(V.status="rejected",V.reason=he)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function ve(V,he,I,Y,G){var K=typeof V;(K==="undefined"||K==="boolean")&&(V=null);var se=!1;if(V===null)se=!0;else switch(K){case"bigint":case"string":case"number":se=!0;break;case"object":switch(V.$$typeof){case n:case e:se=!0;break;case p:return se=V._init,ve(se(V._payload),he,I,Y,G)}}if(se)return G=G(V),se=Y===""?"."+J(V,0):Y,j(G)?(I="",se!=null&&(I=se.replace(q,"$&/")+"/"),ve(G,he,I,"",function(we){return we})):G!=null&&(R(G)&&(G=z(G,I+(G.key==null||V&&V.key===G.key?"":(""+G.key).replace(q,"$&/")+"/")+se)),he.push(G)),1;se=0;var Le=Y===""?".":Y+":";if(j(V))for(var Oe=0;Oe<V.length;Oe++)Y=V[Oe],K=Le+J(Y,Oe),se+=ve(Y,he,I,K,G);else if(Oe=y(V),typeof Oe=="function")for(V=Oe.call(V),Oe=0;!(Y=V.next()).done;)Y=Y.value,K=Le+J(Y,Oe++),se+=ve(Y,he,I,K,G);else if(K==="object"){if(typeof V.then=="function")return ve(Ce(V),he,I,Y,G);throw he=String(V),Error("Objects are not valid as a React child (found: "+(he==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":he)+"). If you meant to render a collection of children, use an array instead.")}return se}function ne(V,he,I){if(V==null)return V;var Y=[],G=0;return ve(V,Y,"","",function(K){return he.call(I,K,G++)}),Y}function Z(V){if(V._status===-1){var he=V._result;he=he(),he.then(function(I){(V._status===0||V._status===-1)&&(V._status=1,V._result=I)},function(I){(V._status===0||V._status===-1)&&(V._status=2,V._result=I)}),V._status===-1&&(V._status=0,V._result=he)}if(V._status===1)return V._result.default;throw V._result}var be=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var he=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(he))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)};function Ne(){}return nt.Children={map:ne,forEach:function(V,he,I){ne(V,function(){he.apply(this,arguments)},I)},count:function(V){var he=0;return ne(V,function(){he++}),he},toArray:function(V){return ne(V,function(he){return he})||[]},only:function(V){if(!R(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},nt.Component=T,nt.Fragment=t,nt.Profiler=r,nt.PureComponent=w,nt.StrictMode=i,nt.Suspense=f,nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,nt.__COMPILER_RUNTIME={__proto__:null,c:function(V){return k.H.useMemoCache(V)}},nt.cache=function(V){return function(){return V.apply(null,arguments)}},nt.cloneElement=function(V,he,I){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Y=_({},V.props),G=V.key,K=void 0;if(he!=null)for(se in he.ref!==void 0&&(K=void 0),he.key!==void 0&&(G=""+he.key),he)!P.call(he,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&he.ref===void 0||(Y[se]=he[se]);var se=arguments.length-2;if(se===1)Y.children=I;else if(1<se){for(var Le=Array(se),Oe=0;Oe<se;Oe++)Le[Oe]=arguments[Oe+2];Y.children=Le}return D(V.type,G,void 0,void 0,K,Y)},nt.createContext=function(V){return V={$$typeof:l,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:s,_context:V},V},nt.createElement=function(V,he,I){var Y,G={},K=null;if(he!=null)for(Y in he.key!==void 0&&(K=""+he.key),he)P.call(he,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(G[Y]=he[Y]);var se=arguments.length-2;if(se===1)G.children=I;else if(1<se){for(var Le=Array(se),Oe=0;Oe<se;Oe++)Le[Oe]=arguments[Oe+2];G.children=Le}if(V&&V.defaultProps)for(Y in se=V.defaultProps,se)G[Y]===void 0&&(G[Y]=se[Y]);return D(V,K,void 0,void 0,null,G)},nt.createRef=function(){return{current:null}},nt.forwardRef=function(V){return{$$typeof:u,render:V}},nt.isValidElement=R,nt.lazy=function(V){return{$$typeof:p,_payload:{_status:-1,_result:V},_init:Z}},nt.memo=function(V,he){return{$$typeof:m,type:V,compare:he===void 0?null:he}},nt.startTransition=function(V){var he=k.T,I={};k.T=I;try{var Y=V(),G=k.S;G!==null&&G(I,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(Ne,be)}catch(K){be(K)}finally{k.T=he}},nt.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},nt.use=function(V){return k.H.use(V)},nt.useActionState=function(V,he,I){return k.H.useActionState(V,he,I)},nt.useCallback=function(V,he){return k.H.useCallback(V,he)},nt.useContext=function(V){return k.H.useContext(V)},nt.useDebugValue=function(){},nt.useDeferredValue=function(V,he){return k.H.useDeferredValue(V,he)},nt.useEffect=function(V,he,I){var Y=k.H;if(typeof I=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(V,he)},nt.useId=function(){return k.H.useId()},nt.useImperativeHandle=function(V,he,I){return k.H.useImperativeHandle(V,he,I)},nt.useInsertionEffect=function(V,he){return k.H.useInsertionEffect(V,he)},nt.useLayoutEffect=function(V,he){return k.H.useLayoutEffect(V,he)},nt.useMemo=function(V,he){return k.H.useMemo(V,he)},nt.useOptimistic=function(V,he){return k.H.useOptimistic(V,he)},nt.useReducer=function(V,he,I){return k.H.useReducer(V,he,I)},nt.useRef=function(V){return k.H.useRef(V)},nt.useState=function(V){return k.H.useState(V)},nt.useSyncExternalStore=function(V,he,I){return k.H.useSyncExternalStore(V,he,I)},nt.useTransition=function(){return k.H.useTransition()},nt.version="19.1.0",nt}var Ov;function gp(){return Ov||(Ov=1,Sm.exports=HT()),Sm.exports}var H=gp();const Go=pp(H);var _m={exports:{}},sc={},Tm={exports:{}},wm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rv;function WT(){return Rv||(Rv=1,function(n){function e(ne,Z){var be=ne.length;ne.push(Z);e:for(;0<be;){var Ne=be-1>>>1,V=ne[Ne];if(0<r(V,Z))ne[Ne]=Z,ne[be]=V,be=Ne;else break e}}function t(ne){return ne.length===0?null:ne[0]}function i(ne){if(ne.length===0)return null;var Z=ne[0],be=ne.pop();if(be!==Z){ne[0]=be;e:for(var Ne=0,V=ne.length,he=V>>>1;Ne<he;){var I=2*(Ne+1)-1,Y=ne[I],G=I+1,K=ne[G];if(0>r(Y,be))G<V&&0>r(K,Y)?(ne[Ne]=K,ne[G]=be,Ne=G):(ne[Ne]=Y,ne[I]=be,Ne=I);else if(G<V&&0>r(K,be))ne[Ne]=K,ne[G]=be,Ne=G;else break e}}return Z}function r(ne,Z){var be=ne.sortIndex-Z.sortIndex;return be!==0?be:ne.id-Z.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var f=[],m=[],p=1,v=null,y=3,S=!1,_=!1,b=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function j(ne){for(var Z=t(m);Z!==null;){if(Z.callback===null)i(m);else if(Z.startTime<=ne)i(m),Z.sortIndex=Z.expirationTime,e(f,Z);else break;Z=t(m)}}function k(ne){if(b=!1,j(ne),!_)if(t(f)!==null)_=!0,P||(P=!0,J());else{var Z=t(m);Z!==null&&ve(k,Z.startTime-ne)}}var P=!1,D=-1,z=5,R=-1;function W(){return T?!0:!(n.unstable_now()-R<z)}function q(){if(T=!1,P){var ne=n.unstable_now();R=ne;var Z=!0;try{e:{_=!1,b&&(b=!1,w(D),D=-1),S=!0;var be=y;try{t:{for(j(ne),v=t(f);v!==null&&!(v.expirationTime>ne&&W());){var Ne=v.callback;if(typeof Ne=="function"){v.callback=null,y=v.priorityLevel;var V=Ne(v.expirationTime<=ne);if(ne=n.unstable_now(),typeof V=="function"){v.callback=V,j(ne),Z=!0;break t}v===t(f)&&i(f),j(ne)}else i(f);v=t(f)}if(v!==null)Z=!0;else{var he=t(m);he!==null&&ve(k,he.startTime-ne),Z=!1}}break e}finally{v=null,y=be,S=!1}Z=void 0}}finally{Z?J():P=!1}}}var J;if(typeof C=="function")J=function(){C(q)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,Ce=me.port2;me.port1.onmessage=q,J=function(){Ce.postMessage(null)}}else J=function(){E(q,0)};function ve(ne,Z){D=E(function(){ne(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ne){ne.callback=null},n.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<ne?Math.floor(1e3/ne):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(ne){switch(y){case 1:case 2:case 3:var Z=3;break;default:Z=y}var be=y;y=Z;try{return ne()}finally{y=be}},n.unstable_requestPaint=function(){T=!0},n.unstable_runWithPriority=function(ne,Z){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var be=y;y=ne;try{return Z()}finally{y=be}},n.unstable_scheduleCallback=function(ne,Z,be){var Ne=n.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?Ne+be:Ne):be=Ne,ne){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=be+V,ne={id:p++,callback:Z,priorityLevel:ne,startTime:be,expirationTime:V,sortIndex:-1},be>Ne?(ne.sortIndex=be,e(m,ne),t(f)===null&&ne===t(m)&&(b?(w(D),D=-1):b=!0,ve(k,be-Ne))):(ne.sortIndex=V,e(f,ne),_||S||(_=!0,P||(P=!0,J()))),ne},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(ne){var Z=y;return function(){var be=y;y=Z;try{return ne.apply(this,arguments)}finally{y=be}}}}(wm)),wm}var Mv;function VT(){return Mv||(Mv=1,Tm.exports=WT()),Tm.exports}var Em={exports:{}},qn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lv;function GT(){if(Lv)return qn;Lv=1;var n=gp();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(f,m,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:v==null?null:""+v,children:f,containerInfo:m,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return qn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,qn.createPortal=function(f,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return s(f,m,null,p)},qn.flushSync=function(f){var m=l.T,p=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=m,i.p=p,i.d.f()}},qn.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(f,m))},qn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},qn.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?i.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:S}):p==="script"&&i.d.X(f,{crossOrigin:v,integrity:y,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},qn.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(f)},qn.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin);i.d.L(f,p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},qn.preloadModule=function(f,m){if(typeof f=="string")if(m){var p=u(m.as,m.crossOrigin);i.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(f)},qn.requestFormReset=function(f){i.d.r(f)},qn.unstable_batchedUpdates=function(f,m){return f(m)},qn.useFormState=function(f,m,p){return l.H.useFormState(f,m,p)},qn.useFormStatus=function(){return l.H.useHostTransitionStatus()},qn.version="19.1.0",qn}var Iv;function YT(){if(Iv)return Em.exports;Iv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Em.exports=GT(),Em.exports}var Pv;function $T(){if(Pv)return sc;Pv=1;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=VT(),e=gp(),t=YT();function i(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var o=a,c=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(c=o.return),a=o.return;while(a)}return o.tag===3?c:null}function l(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function u(a){if(s(a)!==a)throw Error(i(188))}function f(a){var o=a.alternate;if(!o){if(o=s(a),o===null)throw Error(i(188));return o!==a?null:a}for(var c=a,h=o;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return u(g),a;if(x===h)return u(g),o;x=x.sibling}throw Error(i(188))}if(c.return!==h.return)c=g,h=x;else{for(var A=!1,O=g.child;O;){if(O===c){A=!0,c=g,h=x;break}if(O===h){A=!0,h=g,c=x;break}O=O.sibling}if(!A){for(O=x.child;O;){if(O===c){A=!0,c=x,h=g;break}if(O===h){A=!0,h=x,c=g;break}O=O.sibling}if(!A)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?a:o}function m(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=m(a),o!==null)return o;a=a.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),C=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function J(a){return a===null||typeof a!="object"?null:(a=q&&a[q]||a["@@iterator"],typeof a=="function"?a:null)}var me=Symbol.for("react.client.reference");function Ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===me?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case _:return"Fragment";case T:return"Profiler";case b:return"StrictMode";case k:return"Suspense";case P:return"SuspenseList";case R:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case S:return"Portal";case C:return(a.displayName||"Context")+".Provider";case w:return(a._context.displayName||"Context")+".Consumer";case j:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case D:return o=a.displayName||null,o!==null?o:Ce(a.type)||"Memo";case z:o=a._payload,a=a._init;try{return Ce(a(o))}catch{}}return null}var ve=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},Ne=[],V=-1;function he(a){return{current:a}}function I(a){0>V||(a.current=Ne[V],Ne[V]=null,V--)}function Y(a,o){V++,Ne[V]=a.current,a.current=o}var G=he(null),K=he(null),se=he(null),Le=he(null);function Oe(a,o){switch(Y(se,o),Y(K,a),Y(G,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?iv(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=iv(o),a=rv(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}I(G),Y(G,a)}function we(){I(G),I(K),I(se)}function ke(a){a.memoizedState!==null&&Y(Le,a);var o=G.current,c=rv(o,a.type);o!==c&&(Y(K,a),Y(G,c))}function dt(a){K.current===a&&(I(G),I(K)),Le.current===a&&(I(Le),ec._currentValue=be)}var et=Object.prototype.hasOwnProperty,Yt=n.unstable_scheduleCallback,at=n.unstable_cancelCallback,Yn=n.unstable_shouldYield,vt=n.unstable_requestPaint,Pe=n.unstable_now,An=n.unstable_getCurrentPriorityLevel,Mn=n.unstable_ImmediatePriority,ni=n.unstable_UserBlockingPriority,ii=n.unstable_NormalPriority,Qe=n.unstable_LowPriority,ze=n.unstable_IdlePriority,Ye=n.log,Ze=n.unstable_setDisableYieldValue,Rt=null,Et=null;function Wt(a){if(typeof Ye=="function"&&Ze(a),Et&&typeof Et.setStrictMode=="function")try{Et.setStrictMode(Rt,a)}catch{}}var te=Math.clz32?Math.clz32:We,Ee=Math.log,Ke=Math.LN2;function We(a){return a>>>=0,a===0?32:31-(Ee(a)/Ke|0)|0}var st=256,ft=4194304;function Vt(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function ri(a,o,c){var h=a.pendingLanes;if(h===0)return 0;var g=0,x=a.suspendedLanes,A=a.pingedLanes;a=a.warmLanes;var O=h&134217727;return O!==0?(h=O&~x,h!==0?g=Vt(h):(A&=O,A!==0?g=Vt(A):c||(c=O&~a,c!==0&&(g=Vt(c))))):(O=h&~x,O!==0?g=Vt(O):A!==0?g=Vt(A):c||(c=h&~a,c!==0&&(g=Vt(c)))),g===0?0:o!==0&&o!==g&&(o&x)===0&&(x=g&-g,c=o&-o,x>=c||x===32&&(c&4194048)!==0)?o:g}function tt(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function ai(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $n(){var a=st;return st<<=1,(st&4194048)===0&&(st=256),a}function ji(){var a=ft;return ft<<=1,(ft&62914560)===0&&(ft=4194304),a}function _r(a){for(var o=[],c=0;31>c;c++)o.push(a);return o}function Kt(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Gi(a,o,c,h,g,x){var A=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var O=a.entanglements,X=a.expirationTimes,le=a.hiddenUpdates;for(c=A&~c;0<c;){var ye=31-te(c),Se=1<<ye;O[ye]=0,X[ye]=-1;var ue=le[ye];if(ue!==null)for(le[ye]=null,ye=0;ye<ue.length;ye++){var pe=ue[ye];pe!==null&&(pe.lane&=-536870913)}c&=~Se}h!==0&&Sa(a,h,0),x!==0&&g===0&&a.tag!==0&&(a.suspendedLanes|=x&~(A&~o))}function Sa(a,o,c){a.pendingLanes|=o,a.suspendedLanes&=~o;var h=31-te(o);a.entangledLanes|=o,a.entanglements[h]=a.entanglements[h]|1073741824|c&4194090}function eo(a,o){var c=a.entangledLanes|=o;for(a=a.entanglements;c;){var h=31-te(c),g=1<<h;g&o|a[h]&o&&(a[h]|=o),c&=~g}}function cs(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function us(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function to(){var a=Z.p;return a!==0?a:(a=window.event,a===void 0?32:Tv(a.type))}function xn(a,o){var c=Z.p;try{return Z.p=a,o()}finally{Z.p=c}}var hi=Math.random().toString(36).slice(2),en="__reactFiber$"+hi,tn="__reactProps$"+hi,Tr="__reactContainer$"+hi,ds="__reactEvents$"+hi,cl="__reactListeners$"+hi,N="__reactHandles$"+hi,U="__reactResources$"+hi,M="__reactMarker$"+hi;function L(a){delete a[en],delete a[tn],delete a[ds],delete a[cl],delete a[N]}function F(a){var o=a[en];if(o)return o;for(var c=a.parentNode;c;){if(o=c[Tr]||c[en]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(a=lv(a);a!==null;){if(c=a[en])return c;a=lv(a)}return o}a=c,c=a.parentNode}return null}function B(a){if(a=a[en]||a[Tr]){var o=a.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return a}return null}function oe(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(i(33))}function de(a){var o=a[U];return o||(o=a[U]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ie(a){a[M]=!0}var ce=new Set,fe={};function Te(a,o){De(a,o),De(a+"Capture",o)}function De(a,o){for(fe[a]=o,a=0;a<o.length;a++)ce.add(o[a])}var Be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ae={},Ie={};function Ge(a){return et.call(Ie,a)?!0:et.call(Ae,a)?!1:Be.test(a)?Ie[a]=!0:(Ae[a]=!0,!1)}function yt(a,o,c){if(Ge(o))if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+c)}}function xt(a,o,c){if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+c)}}function mt(a,o,c,h){if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(o,c,""+h)}}var mi,Di;function si(a){if(mi===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);mi=o&&o[1]||"",Di=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+mi+a+Di}var pi=!1;function Vr(a,o){if(!a||pi)return"";pi=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(pe){var ue=pe}Reflect.construct(a,[],Se)}else{try{Se.call()}catch(pe){ue=pe}a.call(Se.prototype)}}else{try{throw Error()}catch(pe){ue=pe}(Se=a())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(pe){if(pe&&ue&&typeof pe.stack=="string")return[pe.stack,ue.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=h.DetermineComponentFrameRoot(),A=x[0],O=x[1];if(A&&O){var X=A.split(`
`),le=O.split(`
`);for(g=h=0;h<X.length&&!X[h].includes("DetermineComponentFrameRoot");)h++;for(;g<le.length&&!le[g].includes("DetermineComponentFrameRoot");)g++;if(h===X.length||g===le.length)for(h=X.length-1,g=le.length-1;1<=h&&0<=g&&X[h]!==le[g];)g--;for(;1<=h&&0<=g;h--,g--)if(X[h]!==le[g]){if(h!==1||g!==1)do if(h--,g--,0>g||X[h]!==le[g]){var ye=`
`+X[h].replace(" at new "," at ");return a.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",a.displayName)),ye}while(1<=h&&0<=g);break}}}finally{pi=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?si(c):""}function oi(a){switch(a.tag){case 26:case 27:case 5:return si(a.type);case 16:return si("Lazy");case 13:return si("Suspense");case 19:return si("SuspenseList");case 0:case 15:return Vr(a.type,!1);case 11:return Vr(a.type.render,!1);case 1:return Vr(a.type,!0);case 31:return si("Activity");default:return""}}function _a(a){try{var o="";do o+=oi(a),a=a.return;while(a);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function bn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Gr(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function iu(a){var o=Gr(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,o),h=""+a[o];if(!a.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,x=c.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return g.call(this)},set:function(A){h=""+A,x.call(this,A)}}),Object.defineProperty(a,o,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(A){h=""+A},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function fs(a){a._valueTracker||(a._valueTracker=iu(a))}function ul(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return a&&(h=Gr(a)?a.checked?"true":"false":a.value),a=h,a!==c?(o.setValue(a),!0):!1}function Ta(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var ru=/[\n"\\]/g;function Ln(a){return a.replace(ru,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function wa(a,o,c,h,g,x,A,O){a.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?a.type=A:a.removeAttribute("type"),o!=null?A==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+bn(o)):a.value!==""+bn(o)&&(a.value=""+bn(o)):A!=="submit"&&A!=="reset"||a.removeAttribute("value"),o!=null?wr(a,A,bn(o)):c!=null?wr(a,A,bn(c)):h!=null&&a.removeAttribute("value"),g==null&&x!=null&&(a.defaultChecked=!!x),g!=null&&(a.checked=g&&typeof g!="function"&&typeof g!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?a.name=""+bn(O):a.removeAttribute("name")}function Yi(a,o,c,h,g,x,A,O){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(a.type=x),o!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||o!=null))return;c=c!=null?""+bn(c):"",o=o!=null?""+bn(o):c,O||o===a.value||(a.value=o),a.defaultValue=o}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,a.checked=O?a.checked:!!h,a.defaultChecked=!!h,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(a.name=A)}function wr(a,o,c){o==="number"&&Ta(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Er(a,o,c,h){if(a=a.options,o){o={};for(var g=0;g<c.length;g++)o["$"+c[g]]=!0;for(c=0;c<a.length;c++)g=o.hasOwnProperty("$"+a[c].value),a[c].selected!==g&&(a[c].selected=g),g&&h&&(a[c].defaultSelected=!0)}else{for(c=""+bn(c),o=null,g=0;g<a.length;g++){if(a[g].value===c){a[g].selected=!0,h&&(a[g].defaultSelected=!0);return}o!==null||a[g].disabled||(o=a[g])}o!==null&&(o.selected=!0)}}function no(a,o,c){if(o!=null&&(o=""+bn(o),o!==a.value&&(a.value=o),c==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=c!=null?""+bn(c):""}function au(a,o,c,h){if(o==null){if(h!=null){if(c!=null)throw Error(i(92));if(ve(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),o=c}c=bn(o),a.defaultValue=c,h=a.textContent,h===c&&h!==""&&h!==null&&(a.value=h)}function or(a,o){if(o){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=o;return}}a.textContent=o}var io=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function su(a,o,c){var h=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":h?a.setProperty(o,c):typeof c!="number"||c===0||io.has(o)?o==="float"?a.cssFloat=c:a[o]=(""+c).trim():a[o]=c+"px"}function Ea(a,o,c){if(o!=null&&typeof o!="object")throw Error(i(62));if(a=a.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?a.setProperty(h,""):h==="float"?a.cssFloat="":a[h]="");for(var g in o)h=o[g],o.hasOwnProperty(g)&&c[g]!==h&&su(a,g,h)}else for(var x in o)o.hasOwnProperty(x)&&su(a,x,o[x])}function dl(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function lr(a){return dn.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var fl=null;function ro(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ar=null,Yr=null;function hl(a){var o=B(a);if(o&&(a=o.stateNode)){var c=a[tn]||null;e:switch(a=o.stateNode,o.type){case"input":if(wa(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Ln(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==a&&h.form===a.form){var g=h[tn]||null;if(!g)throw Error(i(90));wa(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<c.length;o++)h=c[o],h.form===a.form&&ul(h)}break e;case"textarea":no(a,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Er(a,!!c.multiple,o,!1)}}}var ml=!1;function Ni(a,o,c){if(ml)return a(o,c);ml=!0;try{var h=a(o);return h}finally{if(ml=!1,(Ar!==null||Yr!==null)&&(Hu(),Ar&&(o=Ar,a=Yr,Yr=Ar=null,hl(o),a)))for(o=0;o<a.length;o++)hl(a[o])}}function $i(a,o){var c=a.stateNode;if(c===null)return null;var h=c[tn]||null;if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(a=a.type,h=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!h;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(i(231,o,typeof c));return c}var Xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ao=!1;if(Xi)try{var $r={};Object.defineProperty($r,"passive",{get:function(){ao=!0}}),window.addEventListener("test",$r,$r),window.removeEventListener("test",$r,$r)}catch{ao=!1}var cr=null,Oi=null,hs=null;function pl(){if(hs)return hs;var a,o=Oi,c=o.length,h,g="value"in cr?cr.value:cr.textContent,x=g.length;for(a=0;a<c&&o[a]===g[a];a++);var A=c-a;for(h=1;h<=A&&o[c-h]===g[x-h];h++);return hs=g.slice(a,1<h?1-h:void 0)}function ms(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function ps(){return!0}function ou(){return!1}function Fe(a){function o(c,h,g,x,A){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=x,this.target=A,this.currentTarget=null;for(var O in a)a.hasOwnProperty(O)&&(c=a[O],this[O]=c?c(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ps:ou,this.isPropagationStopped=ou,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ps)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ps)},persist:function(){},isPersistent:ps}),o}var Q={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},je=Fe(Q),Ue=p({},Q,{view:0,detail:0}),zt=Fe(Ue),fn,Zt,hn,gi=p({},Ue,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==hn&&(hn&&a.type==="mousemove"?(fn=a.screenX-hn.screenX,Zt=a.screenY-hn.screenY):Zt=fn=0,hn=a),fn)},movementY:function(a){return"movementY"in a?a.movementY:Zt}}),Aa=Fe(gi),gl=p({},gi,{dataTransfer:0}),kn=Fe(gl),lu=p({},Ue,{relatedTarget:0}),so=Fe(lu),V2=p({},Q,{animationName:0,elapsedTime:0,pseudoElement:0}),G2=Fe(V2),Y2=p({},Q,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),$2=Fe(Y2),X2=p({},Q,{data:0}),ug=Fe(X2),q2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},K2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Z2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function J2(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=Z2[a])?!!o[a]:!1}function Cf(){return J2}var Q2=p({},Ue,{key:function(a){if(a.key){var o=q2[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=ms(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?K2[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cf,charCode:function(a){return a.type==="keypress"?ms(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ms(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),e_=Fe(Q2),t_=p({},gi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dg=Fe(t_),n_=p({},Ue,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cf}),i_=Fe(n_),r_=p({},Q,{propertyName:0,elapsedTime:0,pseudoElement:0}),a_=Fe(r_),s_=p({},gi,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),o_=Fe(s_),l_=p({},Q,{newState:0,oldState:0}),c_=Fe(l_),u_=[9,13,27,32],jf=Xi&&"CompositionEvent"in window,vl=null;Xi&&"documentMode"in document&&(vl=document.documentMode);var d_=Xi&&"TextEvent"in window&&!vl,fg=Xi&&(!jf||vl&&8<vl&&11>=vl),hg=" ",mg=!1;function pg(a,o){switch(a){case"keyup":return u_.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gg(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var oo=!1;function f_(a,o){switch(a){case"compositionend":return gg(o);case"keypress":return o.which!==32?null:(mg=!0,hg);case"textInput":return a=o.data,a===hg&&mg?null:a;default:return null}}function h_(a,o){if(oo)return a==="compositionend"||!jf&&pg(a,o)?(a=pl(),hs=Oi=cr=null,oo=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return fg&&o.locale!=="ko"?null:o.data;default:return null}}var m_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vg(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!m_[a.type]:o==="textarea"}function yg(a,o,c,h){Ar?Yr?Yr.push(h):Yr=[h]:Ar=h,o=Xu(o,"onChange"),0<o.length&&(c=new je("onChange","change",null,c,h),a.push({event:c,listeners:o}))}var yl=null,xl=null;function p_(a){J1(a,0)}function cu(a){var o=oe(a);if(ul(o))return a}function xg(a,o){if(a==="change")return o}var bg=!1;if(Xi){var Df;if(Xi){var Nf="oninput"in document;if(!Nf){var Sg=document.createElement("div");Sg.setAttribute("oninput","return;"),Nf=typeof Sg.oninput=="function"}Df=Nf}else Df=!1;bg=Df&&(!document.documentMode||9<document.documentMode)}function _g(){yl&&(yl.detachEvent("onpropertychange",Tg),xl=yl=null)}function Tg(a){if(a.propertyName==="value"&&cu(xl)){var o=[];yg(o,xl,a,ro(a)),Ni(p_,o)}}function g_(a,o,c){a==="focusin"?(_g(),yl=o,xl=c,yl.attachEvent("onpropertychange",Tg)):a==="focusout"&&_g()}function v_(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return cu(xl)}function y_(a,o){if(a==="click")return cu(o)}function x_(a,o){if(a==="input"||a==="change")return cu(o)}function b_(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var Ri=typeof Object.is=="function"?Object.is:b_;function bl(a,o){if(Ri(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var c=Object.keys(a),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!et.call(o,g)||!Ri(a[g],o[g]))return!1}return!0}function wg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Eg(a,o){var c=wg(a);a=0;for(var h;c;){if(c.nodeType===3){if(h=a+c.textContent.length,a<=o&&h>=o)return{node:c,offset:o-a};a=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=wg(c)}}function Ag(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?Ag(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function kg(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=Ta(a.document);o instanceof a.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)a=o.contentWindow;else break;o=Ta(a.document)}return o}function Of(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var S_=Xi&&"documentMode"in document&&11>=document.documentMode,lo=null,Rf=null,Sl=null,Mf=!1;function Cg(a,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Mf||lo==null||lo!==Ta(h)||(h=lo,"selectionStart"in h&&Of(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Sl&&bl(Sl,h)||(Sl=h,h=Xu(Rf,"onSelect"),0<h.length&&(o=new je("onSelect","select",null,o,c),a.push({event:o,listeners:h}),o.target=lo)))}function gs(a,o){var c={};return c[a.toLowerCase()]=o.toLowerCase(),c["Webkit"+a]="webkit"+o,c["Moz"+a]="moz"+o,c}var co={animationend:gs("Animation","AnimationEnd"),animationiteration:gs("Animation","AnimationIteration"),animationstart:gs("Animation","AnimationStart"),transitionrun:gs("Transition","TransitionRun"),transitionstart:gs("Transition","TransitionStart"),transitioncancel:gs("Transition","TransitionCancel"),transitionend:gs("Transition","TransitionEnd")},Lf={},jg={};Xi&&(jg=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function vs(a){if(Lf[a])return Lf[a];if(!co[a])return a;var o=co[a],c;for(c in o)if(o.hasOwnProperty(c)&&c in jg)return Lf[a]=o[c];return a}var Dg=vs("animationend"),Ng=vs("animationiteration"),Og=vs("animationstart"),__=vs("transitionrun"),T_=vs("transitionstart"),w_=vs("transitioncancel"),Rg=vs("transitionend"),Mg=new Map,If="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");If.push("scrollEnd");function ur(a,o){Mg.set(a,o),Te(o,[a])}var Lg=new WeakMap;function qi(a,o){if(typeof a=="object"&&a!==null){var c=Lg.get(a);return c!==void 0?c:(o={value:a,source:o,stack:_a(o)},Lg.set(a,o),o)}return{value:a,source:o,stack:_a(o)}}var Ki=[],uo=0,Pf=0;function uu(){for(var a=uo,o=Pf=uo=0;o<a;){var c=Ki[o];Ki[o++]=null;var h=Ki[o];Ki[o++]=null;var g=Ki[o];Ki[o++]=null;var x=Ki[o];if(Ki[o++]=null,h!==null&&g!==null){var A=h.pending;A===null?g.next=g:(g.next=A.next,A.next=g),h.pending=g}x!==0&&Ig(c,g,x)}}function du(a,o,c,h){Ki[uo++]=a,Ki[uo++]=o,Ki[uo++]=c,Ki[uo++]=h,Pf|=h,a.lanes|=h,a=a.alternate,a!==null&&(a.lanes|=h)}function Bf(a,o,c,h){return du(a,o,c,h),fu(a)}function fo(a,o){return du(a,null,null,o),fu(a)}function Ig(a,o,c){a.lanes|=c;var h=a.alternate;h!==null&&(h.lanes|=c);for(var g=!1,x=a.return;x!==null;)x.childLanes|=c,h=x.alternate,h!==null&&(h.childLanes|=c),x.tag===22&&(a=x.stateNode,a===null||a._visibility&1||(g=!0)),a=x,x=x.return;return a.tag===3?(x=a.stateNode,g&&o!==null&&(g=31-te(c),a=x.hiddenUpdates,h=a[g],h===null?a[g]=[o]:h.push(o),o.lane=c|536870912),x):null}function fu(a){if(50<Yl)throw Yl=0,Vh=null,Error(i(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var ho={};function E_(a,o,c,h){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mi(a,o,c,h){return new E_(a,o,c,h)}function Ff(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Xr(a,o){var c=a.alternate;return c===null?(c=Mi(a.tag,o,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=o,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,o=a.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function Pg(a,o){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,o=c.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function hu(a,o,c,h,g,x){var A=0;if(h=a,typeof a=="function")Ff(a)&&(A=1);else if(typeof a=="string")A=kT(a,c,G.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case R:return a=Mi(31,c,o,g),a.elementType=R,a.lanes=x,a;case _:return ys(c.children,g,x,o);case b:A=8,g|=24;break;case T:return a=Mi(12,c,o,g|2),a.elementType=T,a.lanes=x,a;case k:return a=Mi(13,c,o,g),a.elementType=k,a.lanes=x,a;case P:return a=Mi(19,c,o,g),a.elementType=P,a.lanes=x,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:case C:A=10;break e;case w:A=9;break e;case j:A=11;break e;case D:A=14;break e;case z:A=16,h=null;break e}A=29,c=Error(i(130,a===null?"null":typeof a,"")),h=null}return o=Mi(A,c,o,g),o.elementType=a,o.type=h,o.lanes=x,o}function ys(a,o,c,h){return a=Mi(7,a,h,o),a.lanes=c,a}function zf(a,o,c){return a=Mi(6,a,null,o),a.lanes=c,a}function Uf(a,o,c){return o=Mi(4,a.children!==null?a.children:[],a.key,o),o.lanes=c,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var mo=[],po=0,mu=null,pu=0,Zi=[],Ji=0,xs=null,qr=1,Kr="";function bs(a,o){mo[po++]=pu,mo[po++]=mu,mu=a,pu=o}function Bg(a,o,c){Zi[Ji++]=qr,Zi[Ji++]=Kr,Zi[Ji++]=xs,xs=a;var h=qr;a=Kr;var g=32-te(h)-1;h&=~(1<<g),c+=1;var x=32-te(o)+g;if(30<x){var A=g-g%5;x=(h&(1<<A)-1).toString(32),h>>=A,g-=A,qr=1<<32-te(o)+g|c<<g|h,Kr=x+a}else qr=1<<x|c<<g|h,Kr=a}function Hf(a){a.return!==null&&(bs(a,1),Bg(a,1,0))}function Wf(a){for(;a===mu;)mu=mo[--po],mo[po]=null,pu=mo[--po],mo[po]=null;for(;a===xs;)xs=Zi[--Ji],Zi[Ji]=null,Kr=Zi[--Ji],Zi[Ji]=null,qr=Zi[--Ji],Zi[Ji]=null}var li=null,nn=null,_t=!1,Ss=null,kr=!1,Vf=Error(i(519));function _s(a){var o=Error(i(418,""));throw wl(qi(o,a)),Vf}function Fg(a){var o=a.stateNode,c=a.type,h=a.memoizedProps;switch(o[en]=a,o[tn]=h,c){case"dialog":ut("cancel",o),ut("close",o);break;case"iframe":case"object":case"embed":ut("load",o);break;case"video":case"audio":for(c=0;c<Xl.length;c++)ut(Xl[c],o);break;case"source":ut("error",o);break;case"img":case"image":case"link":ut("error",o),ut("load",o);break;case"details":ut("toggle",o);break;case"input":ut("invalid",o),Yi(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),fs(o);break;case"select":ut("invalid",o);break;case"textarea":ut("invalid",o),au(o,h.value,h.defaultValue,h.children),fs(o)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||h.suppressHydrationWarning===!0||nv(o.textContent,c)?(h.popover!=null&&(ut("beforetoggle",o),ut("toggle",o)),h.onScroll!=null&&ut("scroll",o),h.onScrollEnd!=null&&ut("scrollend",o),h.onClick!=null&&(o.onclick=qu),o=!0):o=!1,o||_s(a)}function zg(a){for(li=a.return;li;)switch(li.tag){case 5:case 13:kr=!1;return;case 27:case 3:kr=!0;return;default:li=li.return}}function _l(a){if(a!==li)return!1;if(!_t)return zg(a),_t=!0,!1;var o=a.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||sm(a.type,a.memoizedProps)),c=!c),c&&nn&&_s(a),zg(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));e:{for(a=a.nextSibling,o=0;a;){if(a.nodeType===8)if(c=a.data,c==="/$"){if(o===0){nn=fr(a.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++;a=a.nextSibling}nn=null}}else o===27?(o=nn,Ha(a.type)?(a=um,um=null,nn=a):nn=o):nn=li?fr(a.stateNode.nextSibling):null;return!0}function Tl(){nn=li=null,_t=!1}function Ug(){var a=Ss;return a!==null&&(xi===null?xi=a:xi.push.apply(xi,a),Ss=null),a}function wl(a){Ss===null?Ss=[a]:Ss.push(a)}var Gf=he(null),Ts=null,Zr=null;function ka(a,o,c){Y(Gf,o._currentValue),o._currentValue=c}function Jr(a){a._currentValue=Gf.current,I(Gf)}function Yf(a,o,c){for(;a!==null;){var h=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),a===c)break;a=a.return}}function $f(a,o,c,h){var g=a.child;for(g!==null&&(g.return=a);g!==null;){var x=g.dependencies;if(x!==null){var A=g.child;x=x.firstContext;e:for(;x!==null;){var O=x;x=g;for(var X=0;X<o.length;X++)if(O.context===o[X]){x.lanes|=c,O=x.alternate,O!==null&&(O.lanes|=c),Yf(x.return,c,a),h||(A=null);break e}x=O.next}}else if(g.tag===18){if(A=g.return,A===null)throw Error(i(341));A.lanes|=c,x=A.alternate,x!==null&&(x.lanes|=c),Yf(A,c,a),A=null}else A=g.child;if(A!==null)A.return=g;else for(A=g;A!==null;){if(A===a){A=null;break}if(g=A.sibling,g!==null){g.return=A.return,A=g;break}A=A.return}g=A}}function El(a,o,c,h){a=null;for(var g=o,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var A=g.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var O=g.type;Ri(g.pendingProps.value,A.value)||(a!==null?a.push(O):a=[O])}}else if(g===Le.current){if(A=g.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(a!==null?a.push(ec):a=[ec])}g=g.return}a!==null&&$f(o,a,c,h),o.flags|=262144}function gu(a){for(a=a.firstContext;a!==null;){if(!Ri(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function ws(a){Ts=a,Zr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Xn(a){return Hg(Ts,a)}function vu(a,o){return Ts===null&&ws(a),Hg(a,o)}function Hg(a,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},Zr===null){if(a===null)throw Error(i(308));Zr=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else Zr=Zr.next=o;return c}var A_=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(c,h){a.push(h)}};this.abort=function(){o.aborted=!0,a.forEach(function(c){return c()})}},k_=n.unstable_scheduleCallback,C_=n.unstable_NormalPriority,Sn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xf(){return{controller:new A_,data:new Map,refCount:0}}function Al(a){a.refCount--,a.refCount===0&&k_(C_,function(){a.controller.abort()})}var kl=null,qf=0,go=0,vo=null;function j_(a,o){if(kl===null){var c=kl=[];qf=0,go=Zh(),vo={status:"pending",value:void 0,then:function(h){c.push(h)}}}return qf++,o.then(Wg,Wg),o}function Wg(){if(--qf===0&&kl!==null){vo!==null&&(vo.status="fulfilled");var a=kl;kl=null,go=0,vo=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function D_(a,o){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return a.then(function(){h.status="fulfilled",h.value=o;for(var g=0;g<c.length;g++)(0,c[g])(o)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var Vg=ne.S;ne.S=function(a,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&j_(a,o),Vg!==null&&Vg(a,o)};var Es=he(null);function Kf(){var a=Es.current;return a!==null?a:Ut.pooledCache}function yu(a,o){o===null?Y(Es,Es.current):Y(Es,o.pool)}function Gg(){var a=Kf();return a===null?null:{parent:Sn._currentValue,pool:a}}var Cl=Error(i(460)),Yg=Error(i(474)),xu=Error(i(542)),Zf={then:function(){}};function $g(a){return a=a.status,a==="fulfilled"||a==="rejected"}function bu(){}function Xg(a,o,c){switch(c=a[c],c===void 0?a.push(o):c!==o&&(o.then(bu,bu),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Kg(a),a;default:if(typeof o.status=="string")o.then(bu,bu);else{if(a=Ut,a!==null&&100<a.shellSuspendCounter)throw Error(i(482));a=o,a.status="pending",a.then(function(h){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=h}},function(h){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Kg(a),a}throw jl=o,Cl}}var jl=null;function qg(){if(jl===null)throw Error(i(459));var a=jl;return jl=null,a}function Kg(a){if(a===Cl||a===xu)throw Error(i(483))}var Ca=!1;function Jf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qf(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ja(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Da(a,o,c){var h=a.updateQueue;if(h===null)return null;if(h=h.shared,(At&2)!==0){var g=h.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),h.pending=o,o=fu(a),Ig(a,null,c),o}return du(a,h,o,c),fu(a)}function Dl(a,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var h=o.lanes;h&=a.pendingLanes,c|=h,o.lanes=c,eo(a,c)}}function eh(a,o){var c=a.updateQueue,h=a.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var A={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=A:x=x.next=A,c=c.next}while(c!==null);x===null?g=x=o:x=x.next=o}else g=x=o;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:h.shared,callbacks:h.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=o:a.next=o,c.lastBaseUpdate=o}var th=!1;function Nl(){if(th){var a=vo;if(a!==null)throw a}}function Ol(a,o,c,h){th=!1;var g=a.updateQueue;Ca=!1;var x=g.firstBaseUpdate,A=g.lastBaseUpdate,O=g.shared.pending;if(O!==null){g.shared.pending=null;var X=O,le=X.next;X.next=null,A===null?x=le:A.next=le,A=X;var ye=a.alternate;ye!==null&&(ye=ye.updateQueue,O=ye.lastBaseUpdate,O!==A&&(O===null?ye.firstBaseUpdate=le:O.next=le,ye.lastBaseUpdate=X))}if(x!==null){var Se=g.baseState;A=0,ye=le=X=null,O=x;do{var ue=O.lane&-536870913,pe=ue!==O.lane;if(pe?(ht&ue)===ue:(h&ue)===ue){ue!==0&&ue===go&&(th=!0),ye!==null&&(ye=ye.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var qe=a,$e=O;ue=o;var It=c;switch($e.tag){case 1:if(qe=$e.payload,typeof qe=="function"){Se=qe.call(It,Se,ue);break e}Se=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=$e.payload,ue=typeof qe=="function"?qe.call(It,Se,ue):qe,ue==null)break e;Se=p({},Se,ue);break e;case 2:Ca=!0}}ue=O.callback,ue!==null&&(a.flags|=64,pe&&(a.flags|=8192),pe=g.callbacks,pe===null?g.callbacks=[ue]:pe.push(ue))}else pe={lane:ue,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ye===null?(le=ye=pe,X=Se):ye=ye.next=pe,A|=ue;if(O=O.next,O===null){if(O=g.shared.pending,O===null)break;pe=O,O=pe.next,pe.next=null,g.lastBaseUpdate=pe,g.shared.pending=null}}while(!0);ye===null&&(X=Se),g.baseState=X,g.firstBaseUpdate=le,g.lastBaseUpdate=ye,x===null&&(g.shared.lanes=0),Ba|=A,a.lanes=A,a.memoizedState=Se}}function Zg(a,o){if(typeof a!="function")throw Error(i(191,a));a.call(o)}function Jg(a,o){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)Zg(c[a],o)}var yo=he(null),Su=he(0);function Qg(a,o){a=aa,Y(Su,a),Y(yo,o),aa=a|o.baseLanes}function nh(){Y(Su,aa),Y(yo,yo.current)}function ih(){aa=Su.current,I(yo),I(Su)}var Na=0,ot=null,Mt=null,mn=null,_u=!1,xo=!1,As=!1,Tu=0,Rl=0,bo=null,N_=0;function ln(){throw Error(i(321))}function rh(a,o){if(o===null)return!1;for(var c=0;c<o.length&&c<a.length;c++)if(!Ri(a[c],o[c]))return!1;return!0}function ah(a,o,c,h,g,x){return Na=x,ot=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ne.H=a===null||a.memoizedState===null?I0:P0,As=!1,x=c(h,g),As=!1,xo&&(x=t0(o,c,h,g)),e0(a),x}function e0(a){ne.H=ju;var o=Mt!==null&&Mt.next!==null;if(Na=0,mn=Mt=ot=null,_u=!1,Rl=0,bo=null,o)throw Error(i(300));a===null||Cn||(a=a.dependencies,a!==null&&gu(a)&&(Cn=!0))}function t0(a,o,c,h){ot=a;var g=0;do{if(xo&&(bo=null),Rl=0,xo=!1,25<=g)throw Error(i(301));if(g+=1,mn=Mt=null,a.updateQueue!=null){var x=a.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ne.H=B_,x=o(c,h)}while(xo);return x}function O_(){var a=ne.H,o=a.useState()[0];return o=typeof o.then=="function"?Ml(o):o,a=a.useState()[0],(Mt!==null?Mt.memoizedState:null)!==a&&(ot.flags|=1024),o}function sh(){var a=Tu!==0;return Tu=0,a}function oh(a,o,c){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~c}function lh(a){if(_u){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}_u=!1}Na=0,mn=Mt=ot=null,xo=!1,Rl=Tu=0,bo=null}function vi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mn===null?ot.memoizedState=mn=a:mn=mn.next=a,mn}function pn(){if(Mt===null){var a=ot.alternate;a=a!==null?a.memoizedState:null}else a=Mt.next;var o=mn===null?ot.memoizedState:mn.next;if(o!==null)mn=o,Mt=a;else{if(a===null)throw ot.alternate===null?Error(i(467)):Error(i(310));Mt=a,a={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},mn===null?ot.memoizedState=mn=a:mn=mn.next=a}return mn}function ch(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ml(a){var o=Rl;return Rl+=1,bo===null&&(bo=[]),a=Xg(bo,a,o),o=ot,(mn===null?o.memoizedState:mn.next)===null&&(o=o.alternate,ne.H=o===null||o.memoizedState===null?I0:P0),a}function wu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ml(a);if(a.$$typeof===C)return Xn(a)}throw Error(i(438,String(a)))}function uh(a){var o=null,c=ot.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var h=ot.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=ch(),ot.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(a),h=0;h<a;h++)c[h]=W;return o.index++,c}function Qr(a,o){return typeof o=="function"?o(a):o}function Eu(a){var o=pn();return dh(o,Mt,a)}function dh(a,o,c){var h=a.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var g=a.baseQueue,x=h.pending;if(x!==null){if(g!==null){var A=g.next;g.next=x.next,x.next=A}o.baseQueue=g=x,h.pending=null}if(x=a.baseState,g===null)a.memoizedState=x;else{o=g.next;var O=A=null,X=null,le=o,ye=!1;do{var Se=le.lane&-536870913;if(Se!==le.lane?(ht&Se)===Se:(Na&Se)===Se){var ue=le.revertLane;if(ue===0)X!==null&&(X=X.next={lane:0,revertLane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Se===go&&(ye=!0);else if((Na&ue)===ue){le=le.next,ue===go&&(ye=!0);continue}else Se={lane:0,revertLane:le.revertLane,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},X===null?(O=X=Se,A=x):X=X.next=Se,ot.lanes|=ue,Ba|=ue;Se=le.action,As&&c(x,Se),x=le.hasEagerState?le.eagerState:c(x,Se)}else ue={lane:Se,revertLane:le.revertLane,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},X===null?(O=X=ue,A=x):X=X.next=ue,ot.lanes|=Se,Ba|=Se;le=le.next}while(le!==null&&le!==o);if(X===null?A=x:X.next=O,!Ri(x,a.memoizedState)&&(Cn=!0,ye&&(c=vo,c!==null)))throw c;a.memoizedState=x,a.baseState=A,a.baseQueue=X,h.lastRenderedState=x}return g===null&&(h.lanes=0),[a.memoizedState,h.dispatch]}function fh(a){var o=pn(),c=o.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=a;var h=c.dispatch,g=c.pending,x=o.memoizedState;if(g!==null){c.pending=null;var A=g=g.next;do x=a(x,A.action),A=A.next;while(A!==g);Ri(x,o.memoizedState)||(Cn=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),c.lastRenderedState=x}return[x,h]}function n0(a,o,c){var h=ot,g=pn(),x=_t;if(x){if(c===void 0)throw Error(i(407));c=c()}else c=o();var A=!Ri((Mt||g).memoizedState,c);A&&(g.memoizedState=c,Cn=!0),g=g.queue;var O=a0.bind(null,h,g,a);if(Ll(2048,8,O,[a]),g.getSnapshot!==o||A||mn!==null&&mn.memoizedState.tag&1){if(h.flags|=2048,So(9,Au(),r0.bind(null,h,g,c,o),null),Ut===null)throw Error(i(349));x||(Na&124)!==0||i0(h,o,c)}return c}function i0(a,o,c){a.flags|=16384,a={getSnapshot:o,value:c},o=ot.updateQueue,o===null?(o=ch(),ot.updateQueue=o,o.stores=[a]):(c=o.stores,c===null?o.stores=[a]:c.push(a))}function r0(a,o,c,h){o.value=c,o.getSnapshot=h,s0(o)&&o0(a)}function a0(a,o,c){return c(function(){s0(o)&&o0(a)})}function s0(a){var o=a.getSnapshot;a=a.value;try{var c=o();return!Ri(a,c)}catch{return!0}}function o0(a){var o=fo(a,2);o!==null&&Fi(o,a,2)}function hh(a){var o=vi();if(typeof a=="function"){var c=a;if(a=c(),As){Wt(!0);try{c()}finally{Wt(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qr,lastRenderedState:a},o}function l0(a,o,c,h){return a.baseState=c,dh(a,Mt,typeof h=="function"?h:Qr)}function R_(a,o,c,h,g){if(Cu(a))throw Error(i(485));if(a=o.action,a!==null){var x={payload:g,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){x.listeners.push(A)}};ne.T!==null?c(!0):x.isTransition=!1,h(x),c=o.pending,c===null?(x.next=o.pending=x,c0(o,x)):(x.next=c.next,o.pending=c.next=x)}}function c0(a,o){var c=o.action,h=o.payload,g=a.state;if(o.isTransition){var x=ne.T,A={};ne.T=A;try{var O=c(g,h),X=ne.S;X!==null&&X(A,O),u0(a,o,O)}catch(le){mh(a,o,le)}finally{ne.T=x}}else try{x=c(g,h),u0(a,o,x)}catch(le){mh(a,o,le)}}function u0(a,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){d0(a,o,h)},function(h){return mh(a,o,h)}):d0(a,o,c)}function d0(a,o,c){o.status="fulfilled",o.value=c,f0(o),a.state=c,o=a.pending,o!==null&&(c=o.next,c===o?a.pending=null:(c=c.next,o.next=c,c0(a,c)))}function mh(a,o,c){var h=a.pending;if(a.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=c,f0(o),o=o.next;while(o!==h)}a.action=null}function f0(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function h0(a,o){return o}function m0(a,o){if(_t){var c=Ut.formState;if(c!==null){e:{var h=ot;if(_t){if(nn){t:{for(var g=nn,x=kr;g.nodeType!==8;){if(!x){g=null;break t}if(g=fr(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){nn=fr(g.nextSibling),h=g.data==="F!";break e}}_s(h)}h=!1}h&&(o=c[0])}}return c=vi(),c.memoizedState=c.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h0,lastRenderedState:o},c.queue=h,c=R0.bind(null,ot,h),h.dispatch=c,h=hh(!1),x=xh.bind(null,ot,!1,h.queue),h=vi(),g={state:o,dispatch:null,action:a,pending:null},h.queue=g,c=R_.bind(null,ot,g,x,c),g.dispatch=c,h.memoizedState=a,[o,c,!1]}function p0(a){var o=pn();return g0(o,Mt,a)}function g0(a,o,c){if(o=dh(a,o,h0)[0],a=Eu(Qr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Ml(o)}catch(A){throw A===Cl?xu:A}else h=o;o=pn();var g=o.queue,x=g.dispatch;return c!==o.memoizedState&&(ot.flags|=2048,So(9,Au(),M_.bind(null,g,c),null)),[h,x,a]}function M_(a,o){a.action=o}function v0(a){var o=pn(),c=Mt;if(c!==null)return g0(o,c,a);pn(),o=o.memoizedState,c=pn();var h=c.queue.dispatch;return c.memoizedState=a,[o,h,!1]}function So(a,o,c,h){return a={tag:a,create:c,deps:h,inst:o,next:null},o=ot.updateQueue,o===null&&(o=ch(),ot.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=a.next=a:(h=c.next,c.next=a,a.next=h,o.lastEffect=a),a}function Au(){return{destroy:void 0,resource:void 0}}function y0(){return pn().memoizedState}function ku(a,o,c,h){var g=vi();h=h===void 0?null:h,ot.flags|=a,g.memoizedState=So(1|o,Au(),c,h)}function Ll(a,o,c,h){var g=pn();h=h===void 0?null:h;var x=g.memoizedState.inst;Mt!==null&&h!==null&&rh(h,Mt.memoizedState.deps)?g.memoizedState=So(o,x,c,h):(ot.flags|=a,g.memoizedState=So(1|o,x,c,h))}function x0(a,o){ku(8390656,8,a,o)}function b0(a,o){Ll(2048,8,a,o)}function S0(a,o){return Ll(4,2,a,o)}function _0(a,o){return Ll(4,4,a,o)}function T0(a,o){if(typeof o=="function"){a=a();var c=o(a);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function w0(a,o,c){c=c!=null?c.concat([a]):null,Ll(4,4,T0.bind(null,o,a),c)}function ph(){}function E0(a,o){var c=pn();o=o===void 0?null:o;var h=c.memoizedState;return o!==null&&rh(o,h[1])?h[0]:(c.memoizedState=[a,o],a)}function A0(a,o){var c=pn();o=o===void 0?null:o;var h=c.memoizedState;if(o!==null&&rh(o,h[1]))return h[0];if(h=a(),As){Wt(!0);try{a()}finally{Wt(!1)}}return c.memoizedState=[h,o],h}function gh(a,o,c){return c===void 0||(Na&1073741824)!==0?a.memoizedState=o:(a.memoizedState=c,a=j1(),ot.lanes|=a,Ba|=a,c)}function k0(a,o,c,h){return Ri(c,o)?c:yo.current!==null?(a=gh(a,c,h),Ri(a,o)||(Cn=!0),a):(Na&42)===0?(Cn=!0,a.memoizedState=c):(a=j1(),ot.lanes|=a,Ba|=a,o)}function C0(a,o,c,h,g){var x=Z.p;Z.p=x!==0&&8>x?x:8;var A=ne.T,O={};ne.T=O,xh(a,!1,o,c);try{var X=g(),le=ne.S;if(le!==null&&le(O,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ye=D_(X,h);Il(a,o,ye,Bi(a))}else Il(a,o,h,Bi(a))}catch(Se){Il(a,o,{then:function(){},status:"rejected",reason:Se},Bi())}finally{Z.p=x,ne.T=A}}function L_(){}function vh(a,o,c,h){if(a.tag!==5)throw Error(i(476));var g=j0(a).queue;C0(a,g,o,be,c===null?L_:function(){return D0(a),c(h)})}function j0(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qr,lastRenderedState:be},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qr,lastRenderedState:c},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function D0(a){var o=j0(a).next.queue;Il(a,o,{},Bi())}function yh(){return Xn(ec)}function N0(){return pn().memoizedState}function O0(){return pn().memoizedState}function I_(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var c=Bi();a=ja(c);var h=Da(o,a,c);h!==null&&(Fi(h,o,c),Dl(h,o,c)),o={cache:Xf()},a.payload=o;return}o=o.return}}function P_(a,o,c){var h=Bi();c={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Cu(a)?M0(o,c):(c=Bf(a,o,c,h),c!==null&&(Fi(c,a,h),L0(c,o,h)))}function R0(a,o,c){var h=Bi();Il(a,o,c,h)}function Il(a,o,c,h){var g={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Cu(a))M0(o,g);else{var x=a.alternate;if(a.lanes===0&&(x===null||x.lanes===0)&&(x=o.lastRenderedReducer,x!==null))try{var A=o.lastRenderedState,O=x(A,c);if(g.hasEagerState=!0,g.eagerState=O,Ri(O,A))return du(a,o,g,0),Ut===null&&uu(),!1}catch{}finally{}if(c=Bf(a,o,g,h),c!==null)return Fi(c,a,h),L0(c,o,h),!0}return!1}function xh(a,o,c,h){if(h={lane:2,revertLane:Zh(),action:h,hasEagerState:!1,eagerState:null,next:null},Cu(a)){if(o)throw Error(i(479))}else o=Bf(a,c,h,2),o!==null&&Fi(o,a,2)}function Cu(a){var o=a.alternate;return a===ot||o!==null&&o===ot}function M0(a,o){xo=_u=!0;var c=a.pending;c===null?o.next=o:(o.next=c.next,c.next=o),a.pending=o}function L0(a,o,c){if((c&4194048)!==0){var h=o.lanes;h&=a.pendingLanes,c|=h,o.lanes=c,eo(a,c)}}var ju={readContext:Xn,use:wu,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useLayoutEffect:ln,useInsertionEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useSyncExternalStore:ln,useId:ln,useHostTransitionStatus:ln,useFormState:ln,useActionState:ln,useOptimistic:ln,useMemoCache:ln,useCacheRefresh:ln},I0={readContext:Xn,use:wu,useCallback:function(a,o){return vi().memoizedState=[a,o===void 0?null:o],a},useContext:Xn,useEffect:x0,useImperativeHandle:function(a,o,c){c=c!=null?c.concat([a]):null,ku(4194308,4,T0.bind(null,o,a),c)},useLayoutEffect:function(a,o){return ku(4194308,4,a,o)},useInsertionEffect:function(a,o){ku(4,2,a,o)},useMemo:function(a,o){var c=vi();o=o===void 0?null:o;var h=a();if(As){Wt(!0);try{a()}finally{Wt(!1)}}return c.memoizedState=[h,o],h},useReducer:function(a,o,c){var h=vi();if(c!==void 0){var g=c(o);if(As){Wt(!0);try{c(o)}finally{Wt(!1)}}}else g=o;return h.memoizedState=h.baseState=g,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:g},h.queue=a,a=a.dispatch=P_.bind(null,ot,a),[h.memoizedState,a]},useRef:function(a){var o=vi();return a={current:a},o.memoizedState=a},useState:function(a){a=hh(a);var o=a.queue,c=R0.bind(null,ot,o);return o.dispatch=c,[a.memoizedState,c]},useDebugValue:ph,useDeferredValue:function(a,o){var c=vi();return gh(c,a,o)},useTransition:function(){var a=hh(!1);return a=C0.bind(null,ot,a.queue,!0,!1),vi().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,c){var h=ot,g=vi();if(_t){if(c===void 0)throw Error(i(407));c=c()}else{if(c=o(),Ut===null)throw Error(i(349));(ht&124)!==0||i0(h,o,c)}g.memoizedState=c;var x={value:c,getSnapshot:o};return g.queue=x,x0(a0.bind(null,h,x,a),[a]),h.flags|=2048,So(9,Au(),r0.bind(null,h,x,c,o),null),c},useId:function(){var a=vi(),o=Ut.identifierPrefix;if(_t){var c=Kr,h=qr;c=(h&~(1<<32-te(h)-1)).toString(32)+c,o=""+o+"R"+c,c=Tu++,0<c&&(o+="H"+c.toString(32)),o+=""}else c=N_++,o=""+o+"r"+c.toString(32)+"";return a.memoizedState=o},useHostTransitionStatus:yh,useFormState:m0,useActionState:m0,useOptimistic:function(a){var o=vi();o.memoizedState=o.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=xh.bind(null,ot,!0,c),c.dispatch=o,[a,o]},useMemoCache:uh,useCacheRefresh:function(){return vi().memoizedState=I_.bind(null,ot)}},P0={readContext:Xn,use:wu,useCallback:E0,useContext:Xn,useEffect:b0,useImperativeHandle:w0,useInsertionEffect:S0,useLayoutEffect:_0,useMemo:A0,useReducer:Eu,useRef:y0,useState:function(){return Eu(Qr)},useDebugValue:ph,useDeferredValue:function(a,o){var c=pn();return k0(c,Mt.memoizedState,a,o)},useTransition:function(){var a=Eu(Qr)[0],o=pn().memoizedState;return[typeof a=="boolean"?a:Ml(a),o]},useSyncExternalStore:n0,useId:N0,useHostTransitionStatus:yh,useFormState:p0,useActionState:p0,useOptimistic:function(a,o){var c=pn();return l0(c,Mt,a,o)},useMemoCache:uh,useCacheRefresh:O0},B_={readContext:Xn,use:wu,useCallback:E0,useContext:Xn,useEffect:b0,useImperativeHandle:w0,useInsertionEffect:S0,useLayoutEffect:_0,useMemo:A0,useReducer:fh,useRef:y0,useState:function(){return fh(Qr)},useDebugValue:ph,useDeferredValue:function(a,o){var c=pn();return Mt===null?gh(c,a,o):k0(c,Mt.memoizedState,a,o)},useTransition:function(){var a=fh(Qr)[0],o=pn().memoizedState;return[typeof a=="boolean"?a:Ml(a),o]},useSyncExternalStore:n0,useId:N0,useHostTransitionStatus:yh,useFormState:v0,useActionState:v0,useOptimistic:function(a,o){var c=pn();return Mt!==null?l0(c,Mt,a,o):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:uh,useCacheRefresh:O0},_o=null,Pl=0;function Du(a){var o=Pl;return Pl+=1,_o===null&&(_o=[]),Xg(_o,a,o)}function Bl(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Nu(a,o){throw o.$$typeof===v?Error(i(525)):(a=Object.prototype.toString.call(o),Error(i(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function B0(a){var o=a._init;return o(a._payload)}function F0(a){function o(re,ee){if(a){var ae=re.deletions;ae===null?(re.deletions=[ee],re.flags|=16):ae.push(ee)}}function c(re,ee){if(!a)return null;for(;ee!==null;)o(re,ee),ee=ee.sibling;return null}function h(re){for(var ee=new Map;re!==null;)re.key!==null?ee.set(re.key,re):ee.set(re.index,re),re=re.sibling;return ee}function g(re,ee){return re=Xr(re,ee),re.index=0,re.sibling=null,re}function x(re,ee,ae){return re.index=ae,a?(ae=re.alternate,ae!==null?(ae=ae.index,ae<ee?(re.flags|=67108866,ee):ae):(re.flags|=67108866,ee)):(re.flags|=1048576,ee)}function A(re){return a&&re.alternate===null&&(re.flags|=67108866),re}function O(re,ee,ae,xe){return ee===null||ee.tag!==6?(ee=zf(ae,re.mode,xe),ee.return=re,ee):(ee=g(ee,ae),ee.return=re,ee)}function X(re,ee,ae,xe){var He=ae.type;return He===_?ye(re,ee,ae.props.children,xe,ae.key):ee!==null&&(ee.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===z&&B0(He)===ee.type)?(ee=g(ee,ae.props),Bl(ee,ae),ee.return=re,ee):(ee=hu(ae.type,ae.key,ae.props,null,re.mode,xe),Bl(ee,ae),ee.return=re,ee)}function le(re,ee,ae,xe){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ae.containerInfo||ee.stateNode.implementation!==ae.implementation?(ee=Uf(ae,re.mode,xe),ee.return=re,ee):(ee=g(ee,ae.children||[]),ee.return=re,ee)}function ye(re,ee,ae,xe,He){return ee===null||ee.tag!==7?(ee=ys(ae,re.mode,xe,He),ee.return=re,ee):(ee=g(ee,ae),ee.return=re,ee)}function Se(re,ee,ae){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=zf(""+ee,re.mode,ae),ee.return=re,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case y:return ae=hu(ee.type,ee.key,ee.props,null,re.mode,ae),Bl(ae,ee),ae.return=re,ae;case S:return ee=Uf(ee,re.mode,ae),ee.return=re,ee;case z:var xe=ee._init;return ee=xe(ee._payload),Se(re,ee,ae)}if(ve(ee)||J(ee))return ee=ys(ee,re.mode,ae,null),ee.return=re,ee;if(typeof ee.then=="function")return Se(re,Du(ee),ae);if(ee.$$typeof===C)return Se(re,vu(re,ee),ae);Nu(re,ee)}return null}function ue(re,ee,ae,xe){var He=ee!==null?ee.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return He!==null?null:O(re,ee,""+ae,xe);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:return ae.key===He?X(re,ee,ae,xe):null;case S:return ae.key===He?le(re,ee,ae,xe):null;case z:return He=ae._init,ae=He(ae._payload),ue(re,ee,ae,xe)}if(ve(ae)||J(ae))return He!==null?null:ye(re,ee,ae,xe,null);if(typeof ae.then=="function")return ue(re,ee,Du(ae),xe);if(ae.$$typeof===C)return ue(re,ee,vu(re,ae),xe);Nu(re,ae)}return null}function pe(re,ee,ae,xe,He){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return re=re.get(ae)||null,O(ee,re,""+xe,He);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case y:return re=re.get(xe.key===null?ae:xe.key)||null,X(ee,re,xe,He);case S:return re=re.get(xe.key===null?ae:xe.key)||null,le(ee,re,xe,He);case z:var lt=xe._init;return xe=lt(xe._payload),pe(re,ee,ae,xe,He)}if(ve(xe)||J(xe))return re=re.get(ae)||null,ye(ee,re,xe,He,null);if(typeof xe.then=="function")return pe(re,ee,ae,Du(xe),He);if(xe.$$typeof===C)return pe(re,ee,ae,vu(ee,xe),He);Nu(ee,xe)}return null}function qe(re,ee,ae,xe){for(var He=null,lt=null,Ve=ee,Xe=ee=0,Dn=null;Ve!==null&&Xe<ae.length;Xe++){Ve.index>Xe?(Dn=Ve,Ve=null):Dn=Ve.sibling;var bt=ue(re,Ve,ae[Xe],xe);if(bt===null){Ve===null&&(Ve=Dn);break}a&&Ve&&bt.alternate===null&&o(re,Ve),ee=x(bt,ee,Xe),lt===null?He=bt:lt.sibling=bt,lt=bt,Ve=Dn}if(Xe===ae.length)return c(re,Ve),_t&&bs(re,Xe),He;if(Ve===null){for(;Xe<ae.length;Xe++)Ve=Se(re,ae[Xe],xe),Ve!==null&&(ee=x(Ve,ee,Xe),lt===null?He=Ve:lt.sibling=Ve,lt=Ve);return _t&&bs(re,Xe),He}for(Ve=h(Ve);Xe<ae.length;Xe++)Dn=pe(Ve,re,Xe,ae[Xe],xe),Dn!==null&&(a&&Dn.alternate!==null&&Ve.delete(Dn.key===null?Xe:Dn.key),ee=x(Dn,ee,Xe),lt===null?He=Dn:lt.sibling=Dn,lt=Dn);return a&&Ve.forEach(function($a){return o(re,$a)}),_t&&bs(re,Xe),He}function $e(re,ee,ae,xe){if(ae==null)throw Error(i(151));for(var He=null,lt=null,Ve=ee,Xe=ee=0,Dn=null,bt=ae.next();Ve!==null&&!bt.done;Xe++,bt=ae.next()){Ve.index>Xe?(Dn=Ve,Ve=null):Dn=Ve.sibling;var $a=ue(re,Ve,bt.value,xe);if($a===null){Ve===null&&(Ve=Dn);break}a&&Ve&&$a.alternate===null&&o(re,Ve),ee=x($a,ee,Xe),lt===null?He=$a:lt.sibling=$a,lt=$a,Ve=Dn}if(bt.done)return c(re,Ve),_t&&bs(re,Xe),He;if(Ve===null){for(;!bt.done;Xe++,bt=ae.next())bt=Se(re,bt.value,xe),bt!==null&&(ee=x(bt,ee,Xe),lt===null?He=bt:lt.sibling=bt,lt=bt);return _t&&bs(re,Xe),He}for(Ve=h(Ve);!bt.done;Xe++,bt=ae.next())bt=pe(Ve,re,Xe,bt.value,xe),bt!==null&&(a&&bt.alternate!==null&&Ve.delete(bt.key===null?Xe:bt.key),ee=x(bt,ee,Xe),lt===null?He=bt:lt.sibling=bt,lt=bt);return a&&Ve.forEach(function(FT){return o(re,FT)}),_t&&bs(re,Xe),He}function It(re,ee,ae,xe){if(typeof ae=="object"&&ae!==null&&ae.type===_&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:e:{for(var He=ae.key;ee!==null;){if(ee.key===He){if(He=ae.type,He===_){if(ee.tag===7){c(re,ee.sibling),xe=g(ee,ae.props.children),xe.return=re,re=xe;break e}}else if(ee.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===z&&B0(He)===ee.type){c(re,ee.sibling),xe=g(ee,ae.props),Bl(xe,ae),xe.return=re,re=xe;break e}c(re,ee);break}else o(re,ee);ee=ee.sibling}ae.type===_?(xe=ys(ae.props.children,re.mode,xe,ae.key),xe.return=re,re=xe):(xe=hu(ae.type,ae.key,ae.props,null,re.mode,xe),Bl(xe,ae),xe.return=re,re=xe)}return A(re);case S:e:{for(He=ae.key;ee!==null;){if(ee.key===He)if(ee.tag===4&&ee.stateNode.containerInfo===ae.containerInfo&&ee.stateNode.implementation===ae.implementation){c(re,ee.sibling),xe=g(ee,ae.children||[]),xe.return=re,re=xe;break e}else{c(re,ee);break}else o(re,ee);ee=ee.sibling}xe=Uf(ae,re.mode,xe),xe.return=re,re=xe}return A(re);case z:return He=ae._init,ae=He(ae._payload),It(re,ee,ae,xe)}if(ve(ae))return qe(re,ee,ae,xe);if(J(ae)){if(He=J(ae),typeof He!="function")throw Error(i(150));return ae=He.call(ae),$e(re,ee,ae,xe)}if(typeof ae.then=="function")return It(re,ee,Du(ae),xe);if(ae.$$typeof===C)return It(re,ee,vu(re,ae),xe);Nu(re,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,ee!==null&&ee.tag===6?(c(re,ee.sibling),xe=g(ee,ae),xe.return=re,re=xe):(c(re,ee),xe=zf(ae,re.mode,xe),xe.return=re,re=xe),A(re)):c(re,ee)}return function(re,ee,ae,xe){try{Pl=0;var He=It(re,ee,ae,xe);return _o=null,He}catch(Ve){if(Ve===Cl||Ve===xu)throw Ve;var lt=Mi(29,Ve,null,re.mode);return lt.lanes=xe,lt.return=re,lt}finally{}}}var To=F0(!0),z0=F0(!1),Qi=he(null),Cr=null;function Oa(a){var o=a.alternate;Y(_n,_n.current&1),Y(Qi,a),Cr===null&&(o===null||yo.current!==null||o.memoizedState!==null)&&(Cr=a)}function U0(a){if(a.tag===22){if(Y(_n,_n.current),Y(Qi,a),Cr===null){var o=a.alternate;o!==null&&o.memoizedState!==null&&(Cr=a)}}else Ra()}function Ra(){Y(_n,_n.current),Y(Qi,Qi.current)}function ea(a){I(Qi),Cr===a&&(Cr=null),I(_n)}var _n=he(0);function Ou(a){for(var o=a;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||cm(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function bh(a,o,c,h){o=a.memoizedState,c=c(h,o),c=c==null?o:p({},o,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var Sh={enqueueSetState:function(a,o,c){a=a._reactInternals;var h=Bi(),g=ja(h);g.payload=o,c!=null&&(g.callback=c),o=Da(a,g,h),o!==null&&(Fi(o,a,h),Dl(o,a,h))},enqueueReplaceState:function(a,o,c){a=a._reactInternals;var h=Bi(),g=ja(h);g.tag=1,g.payload=o,c!=null&&(g.callback=c),o=Da(a,g,h),o!==null&&(Fi(o,a,h),Dl(o,a,h))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var c=Bi(),h=ja(c);h.tag=2,o!=null&&(h.callback=o),o=Da(a,h,c),o!==null&&(Fi(o,a,c),Dl(o,a,c))}};function H0(a,o,c,h,g,x,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(h,x,A):o.prototype&&o.prototype.isPureReactComponent?!bl(c,h)||!bl(g,x):!0}function W0(a,o,c,h){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==a&&Sh.enqueueReplaceState(o,o.state,null)}function ks(a,o){var c=o;if("ref"in o){c={};for(var h in o)h!=="ref"&&(c[h]=o[h])}if(a=a.defaultProps){c===o&&(c=p({},c));for(var g in a)c[g]===void 0&&(c[g]=a[g])}return c}var Ru=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function V0(a){Ru(a)}function G0(a){console.error(a)}function Y0(a){Ru(a)}function Mu(a,o){try{var c=a.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function $0(a,o,c){try{var h=a.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function _h(a,o,c){return c=ja(c),c.tag=3,c.payload={element:null},c.callback=function(){Mu(a,o)},c}function X0(a){return a=ja(a),a.tag=3,a}function q0(a,o,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=h.value;a.payload=function(){return g(x)},a.callback=function(){$0(o,c,h)}}var A=c.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(a.callback=function(){$0(o,c,h),typeof g!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var O=h.stack;this.componentDidCatch(h.value,{componentStack:O!==null?O:""})})}function F_(a,o,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=c.alternate,o!==null&&El(o,c,g,!0),c=Qi.current,c!==null){switch(c.tag){case 13:return Cr===null?Yh():c.alternate===null&&rn===0&&(rn=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===Zf?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([h]):o.add(h),Xh(a,h,g)),!1;case 22:return c.flags|=65536,h===Zf?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([h]):c.add(h)),Xh(a,h,g)),!1}throw Error(i(435,c.tag))}return Xh(a,h,g),Yh(),!1}if(_t)return o=Qi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,h!==Vf&&(a=Error(i(422),{cause:h}),wl(qi(a,c)))):(h!==Vf&&(o=Error(i(423),{cause:h}),wl(qi(o,c))),a=a.current.alternate,a.flags|=65536,g&=-g,a.lanes|=g,h=qi(h,c),g=_h(a.stateNode,h,g),eh(a,g),rn!==4&&(rn=2)),!1;var x=Error(i(520),{cause:h});if(x=qi(x,c),Gl===null?Gl=[x]:Gl.push(x),rn!==4&&(rn=2),o===null)return!0;h=qi(h,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,a=g&-g,c.lanes|=a,a=_h(c.stateNode,h,a),eh(c,a),!1;case 1:if(o=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Fa===null||!Fa.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=X0(g),q0(g,a,c,h),eh(c,g),!1}c=c.return}while(c!==null);return!1}var K0=Error(i(461)),Cn=!1;function In(a,o,c,h){o.child=a===null?z0(o,null,c,h):To(o,a.child,c,h)}function Z0(a,o,c,h,g){c=c.render;var x=o.ref;if("ref"in h){var A={};for(var O in h)O!=="ref"&&(A[O]=h[O])}else A=h;return ws(o),h=ah(a,o,c,A,x,g),O=sh(),a!==null&&!Cn?(oh(a,o,g),ta(a,o,g)):(_t&&O&&Hf(o),o.flags|=1,In(a,o,h,g),o.child)}function J0(a,o,c,h,g){if(a===null){var x=c.type;return typeof x=="function"&&!Ff(x)&&x.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=x,Q0(a,o,x,h,g)):(a=hu(c.type,null,h,o,o.mode,g),a.ref=o.ref,a.return=o,o.child=a)}if(x=a.child,!Dh(a,g)){var A=x.memoizedProps;if(c=c.compare,c=c!==null?c:bl,c(A,h)&&a.ref===o.ref)return ta(a,o,g)}return o.flags|=1,a=Xr(x,h),a.ref=o.ref,a.return=o,o.child=a}function Q0(a,o,c,h,g){if(a!==null){var x=a.memoizedProps;if(bl(x,h)&&a.ref===o.ref)if(Cn=!1,o.pendingProps=h=x,Dh(a,g))(a.flags&131072)!==0&&(Cn=!0);else return o.lanes=a.lanes,ta(a,o,g)}return Th(a,o,c,h,g)}function e1(a,o,c){var h=o.pendingProps,g=h.children,x=a!==null?a.memoizedState:null;if(h.mode==="hidden"){if((o.flags&128)!==0){if(h=x!==null?x.baseLanes|c:c,a!==null){for(g=o.child=a.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;o.childLanes=x&~h}else o.childLanes=0,o.child=null;return t1(a,o,h,c)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&yu(o,x!==null?x.cachePool:null),x!==null?Qg(o,x):nh(),U0(o);else return o.lanes=o.childLanes=536870912,t1(a,o,x!==null?x.baseLanes|c:c,c)}else x!==null?(yu(o,x.cachePool),Qg(o,x),Ra(),o.memoizedState=null):(a!==null&&yu(o,null),nh(),Ra());return In(a,o,g,c),o.child}function t1(a,o,c,h){var g=Kf();return g=g===null?null:{parent:Sn._currentValue,pool:g},o.memoizedState={baseLanes:c,cachePool:g},a!==null&&yu(o,null),nh(),U0(o),a!==null&&El(a,o,h,!0),null}function Lu(a,o){var c=o.ref;if(c===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(a===null||a.ref!==c)&&(o.flags|=4194816)}}function Th(a,o,c,h,g){return ws(o),c=ah(a,o,c,h,void 0,g),h=sh(),a!==null&&!Cn?(oh(a,o,g),ta(a,o,g)):(_t&&h&&Hf(o),o.flags|=1,In(a,o,c,g),o.child)}function n1(a,o,c,h,g,x){return ws(o),o.updateQueue=null,c=t0(o,h,c,g),e0(a),h=sh(),a!==null&&!Cn?(oh(a,o,x),ta(a,o,x)):(_t&&h&&Hf(o),o.flags|=1,In(a,o,c,x),o.child)}function i1(a,o,c,h,g){if(ws(o),o.stateNode===null){var x=ho,A=c.contextType;typeof A=="object"&&A!==null&&(x=Xn(A)),x=new c(h,x),o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Sh,o.stateNode=x,x._reactInternals=o,x=o.stateNode,x.props=h,x.state=o.memoizedState,x.refs={},Jf(o),A=c.contextType,x.context=typeof A=="object"&&A!==null?Xn(A):ho,x.state=o.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(bh(o,c,A,h),x.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(A=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),A!==x.state&&Sh.enqueueReplaceState(x,x.state,null),Ol(o,h,x,g),Nl(),x.state=o.memoizedState),typeof x.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(a===null){x=o.stateNode;var O=o.memoizedProps,X=ks(c,O);x.props=X;var le=x.context,ye=c.contextType;A=ho,typeof ye=="object"&&ye!==null&&(A=Xn(ye));var Se=c.getDerivedStateFromProps;ye=typeof Se=="function"||typeof x.getSnapshotBeforeUpdate=="function",O=o.pendingProps!==O,ye||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(O||le!==A)&&W0(o,x,h,A),Ca=!1;var ue=o.memoizedState;x.state=ue,Ol(o,h,x,g),Nl(),le=o.memoizedState,O||ue!==le||Ca?(typeof Se=="function"&&(bh(o,c,Se,h),le=o.memoizedState),(X=Ca||H0(o,c,X,h,ue,le,A))?(ye||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=le),x.props=h,x.state=le,x.context=A,h=X):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{x=o.stateNode,Qf(a,o),A=o.memoizedProps,ye=ks(c,A),x.props=ye,Se=o.pendingProps,ue=x.context,le=c.contextType,X=ho,typeof le=="object"&&le!==null&&(X=Xn(le)),O=c.getDerivedStateFromProps,(le=typeof O=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(A!==Se||ue!==X)&&W0(o,x,h,X),Ca=!1,ue=o.memoizedState,x.state=ue,Ol(o,h,x,g),Nl();var pe=o.memoizedState;A!==Se||ue!==pe||Ca||a!==null&&a.dependencies!==null&&gu(a.dependencies)?(typeof O=="function"&&(bh(o,c,O,h),pe=o.memoizedState),(ye=Ca||H0(o,c,ye,h,ue,pe,X)||a!==null&&a.dependencies!==null&&gu(a.dependencies))?(le||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,pe,X),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,pe,X)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||A===a.memoizedProps&&ue===a.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&ue===a.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=pe),x.props=h,x.state=pe,x.context=X,h=ye):(typeof x.componentDidUpdate!="function"||A===a.memoizedProps&&ue===a.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&ue===a.memoizedState||(o.flags|=1024),h=!1)}return x=h,Lu(a,o),h=(o.flags&128)!==0,x||h?(x=o.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:x.render(),o.flags|=1,a!==null&&h?(o.child=To(o,a.child,null,g),o.child=To(o,null,c,g)):In(a,o,c,g),o.memoizedState=x.state,a=o.child):a=ta(a,o,g),a}function r1(a,o,c,h){return Tl(),o.flags|=256,In(a,o,c,h),o.child}var wh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Eh(a){return{baseLanes:a,cachePool:Gg()}}function Ah(a,o,c){return a=a!==null?a.childLanes&~c:0,o&&(a|=er),a}function a1(a,o,c){var h=o.pendingProps,g=!1,x=(o.flags&128)!==0,A;if((A=x)||(A=a!==null&&a.memoizedState===null?!1:(_n.current&2)!==0),A&&(g=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,a===null){if(_t){if(g?Oa(o):Ra(),_t){var O=nn,X;if(X=O){e:{for(X=O,O=kr;X.nodeType!==8;){if(!O){O=null;break e}if(X=fr(X.nextSibling),X===null){O=null;break e}}O=X}O!==null?(o.memoizedState={dehydrated:O,treeContext:xs!==null?{id:qr,overflow:Kr}:null,retryLane:536870912,hydrationErrors:null},X=Mi(18,null,null,0),X.stateNode=O,X.return=o,o.child=X,li=o,nn=null,X=!0):X=!1}X||_s(o)}if(O=o.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return cm(O)?o.lanes=32:o.lanes=536870912,null;ea(o)}return O=h.children,h=h.fallback,g?(Ra(),g=o.mode,O=Iu({mode:"hidden",children:O},g),h=ys(h,g,c,null),O.return=o,h.return=o,O.sibling=h,o.child=O,g=o.child,g.memoizedState=Eh(c),g.childLanes=Ah(a,A,c),o.memoizedState=wh,h):(Oa(o),kh(o,O))}if(X=a.memoizedState,X!==null&&(O=X.dehydrated,O!==null)){if(x)o.flags&256?(Oa(o),o.flags&=-257,o=Ch(a,o,c)):o.memoizedState!==null?(Ra(),o.child=a.child,o.flags|=128,o=null):(Ra(),g=h.fallback,O=o.mode,h=Iu({mode:"visible",children:h.children},O),g=ys(g,O,c,null),g.flags|=2,h.return=o,g.return=o,h.sibling=g,o.child=h,To(o,a.child,null,c),h=o.child,h.memoizedState=Eh(c),h.childLanes=Ah(a,A,c),o.memoizedState=wh,o=g);else if(Oa(o),cm(O)){if(A=O.nextSibling&&O.nextSibling.dataset,A)var le=A.dgst;A=le,h=Error(i(419)),h.stack="",h.digest=A,wl({value:h,source:null,stack:null}),o=Ch(a,o,c)}else if(Cn||El(a,o,c,!1),A=(c&a.childLanes)!==0,Cn||A){if(A=Ut,A!==null&&(h=c&-c,h=(h&42)!==0?1:cs(h),h=(h&(A.suspendedLanes|c))!==0?0:h,h!==0&&h!==X.retryLane))throw X.retryLane=h,fo(a,h),Fi(A,a,h),K0;O.data==="$?"||Yh(),o=Ch(a,o,c)}else O.data==="$?"?(o.flags|=192,o.child=a.child,o=null):(a=X.treeContext,nn=fr(O.nextSibling),li=o,_t=!0,Ss=null,kr=!1,a!==null&&(Zi[Ji++]=qr,Zi[Ji++]=Kr,Zi[Ji++]=xs,qr=a.id,Kr=a.overflow,xs=o),o=kh(o,h.children),o.flags|=4096);return o}return g?(Ra(),g=h.fallback,O=o.mode,X=a.child,le=X.sibling,h=Xr(X,{mode:"hidden",children:h.children}),h.subtreeFlags=X.subtreeFlags&65011712,le!==null?g=Xr(le,g):(g=ys(g,O,c,null),g.flags|=2),g.return=o,h.return=o,h.sibling=g,o.child=h,h=g,g=o.child,O=a.child.memoizedState,O===null?O=Eh(c):(X=O.cachePool,X!==null?(le=Sn._currentValue,X=X.parent!==le?{parent:le,pool:le}:X):X=Gg(),O={baseLanes:O.baseLanes|c,cachePool:X}),g.memoizedState=O,g.childLanes=Ah(a,A,c),o.memoizedState=wh,h):(Oa(o),c=a.child,a=c.sibling,c=Xr(c,{mode:"visible",children:h.children}),c.return=o,c.sibling=null,a!==null&&(A=o.deletions,A===null?(o.deletions=[a],o.flags|=16):A.push(a)),o.child=c,o.memoizedState=null,c)}function kh(a,o){return o=Iu({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function Iu(a,o){return a=Mi(22,a,null,o),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Ch(a,o,c){return To(o,a.child,null,c),a=kh(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function s1(a,o,c){a.lanes|=o;var h=a.alternate;h!==null&&(h.lanes|=o),Yf(a.return,o,c)}function jh(a,o,c,h,g){var x=a.memoizedState;x===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(x.isBackwards=o,x.rendering=null,x.renderingStartTime=0,x.last=h,x.tail=c,x.tailMode=g)}function o1(a,o,c){var h=o.pendingProps,g=h.revealOrder,x=h.tail;if(In(a,o,h.children,c),h=_n.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&s1(a,c,o);else if(a.tag===19)s1(a,c,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}h&=1}switch(Y(_n,h),g){case"forwards":for(c=o.child,g=null;c!==null;)a=c.alternate,a!==null&&Ou(a)===null&&(g=c),c=c.sibling;c=g,c===null?(g=o.child,o.child=null):(g=c.sibling,c.sibling=null),jh(o,!1,g,c,x);break;case"backwards":for(c=null,g=o.child,o.child=null;g!==null;){if(a=g.alternate,a!==null&&Ou(a)===null){o.child=g;break}a=g.sibling,g.sibling=c,c=g,g=a}jh(o,!0,c,null,x);break;case"together":jh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ta(a,o,c){if(a!==null&&(o.dependencies=a.dependencies),Ba|=o.lanes,(c&o.childLanes)===0)if(a!==null){if(El(a,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(i(153));if(o.child!==null){for(a=o.child,c=Xr(a,a.pendingProps),o.child=c,c.return=o;a.sibling!==null;)a=a.sibling,c=c.sibling=Xr(a,a.pendingProps),c.return=o;c.sibling=null}return o.child}function Dh(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&gu(a)))}function z_(a,o,c){switch(o.tag){case 3:Oe(o,o.stateNode.containerInfo),ka(o,Sn,a.memoizedState.cache),Tl();break;case 27:case 5:ke(o);break;case 4:Oe(o,o.stateNode.containerInfo);break;case 10:ka(o,o.type,o.memoizedProps.value);break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(Oa(o),o.flags|=128,null):(c&o.child.childLanes)!==0?a1(a,o,c):(Oa(o),a=ta(a,o,c),a!==null?a.sibling:null);Oa(o);break;case 19:var g=(a.flags&128)!==0;if(h=(c&o.childLanes)!==0,h||(El(a,o,c,!1),h=(c&o.childLanes)!==0),g){if(h)return o1(a,o,c);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Y(_n,_n.current),h)break;return null;case 22:case 23:return o.lanes=0,e1(a,o,c);case 24:ka(o,Sn,a.memoizedState.cache)}return ta(a,o,c)}function l1(a,o,c){if(a!==null)if(a.memoizedProps!==o.pendingProps)Cn=!0;else{if(!Dh(a,c)&&(o.flags&128)===0)return Cn=!1,z_(a,o,c);Cn=(a.flags&131072)!==0}else Cn=!1,_t&&(o.flags&1048576)!==0&&Bg(o,pu,o.index);switch(o.lanes=0,o.tag){case 16:e:{a=o.pendingProps;var h=o.elementType,g=h._init;if(h=g(h._payload),o.type=h,typeof h=="function")Ff(h)?(a=ks(h,a),o.tag=1,o=i1(null,o,h,a,c)):(o.tag=0,o=Th(null,o,h,a,c));else{if(h!=null){if(g=h.$$typeof,g===j){o.tag=11,o=Z0(null,o,h,a,c);break e}else if(g===D){o.tag=14,o=J0(null,o,h,a,c);break e}}throw o=Ce(h)||h,Error(i(306,o,""))}}return o;case 0:return Th(a,o,o.type,o.pendingProps,c);case 1:return h=o.type,g=ks(h,o.pendingProps),i1(a,o,h,g,c);case 3:e:{if(Oe(o,o.stateNode.containerInfo),a===null)throw Error(i(387));h=o.pendingProps;var x=o.memoizedState;g=x.element,Qf(a,o),Ol(o,h,null,c);var A=o.memoizedState;if(h=A.cache,ka(o,Sn,h),h!==x.cache&&$f(o,[Sn],c,!0),Nl(),h=A.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=x,o.memoizedState=x,o.flags&256){o=r1(a,o,h,c);break e}else if(h!==g){g=qi(Error(i(424)),o),wl(g),o=r1(a,o,h,c);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(nn=fr(a.firstChild),li=o,_t=!0,Ss=null,kr=!0,c=z0(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Tl(),h===g){o=ta(a,o,c);break e}In(a,o,h,c)}o=o.child}return o;case 26:return Lu(a,o),a===null?(c=fv(o.type,null,o.pendingProps,null))?o.memoizedState=c:_t||(c=o.type,a=o.pendingProps,h=Ku(se.current).createElement(c),h[en]=o,h[tn]=a,Bn(h,c,a),ie(h),o.stateNode=h):o.memoizedState=fv(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return ke(o),a===null&&_t&&(h=o.stateNode=cv(o.type,o.pendingProps,se.current),li=o,kr=!0,g=nn,Ha(o.type)?(um=g,nn=fr(h.firstChild)):nn=g),In(a,o,o.pendingProps.children,c),Lu(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&_t&&((g=h=nn)&&(h=mT(h,o.type,o.pendingProps,kr),h!==null?(o.stateNode=h,li=o,nn=fr(h.firstChild),kr=!1,g=!0):g=!1),g||_s(o)),ke(o),g=o.type,x=o.pendingProps,A=a!==null?a.memoizedProps:null,h=x.children,sm(g,x)?h=null:A!==null&&sm(g,A)&&(o.flags|=32),o.memoizedState!==null&&(g=ah(a,o,O_,null,null,c),ec._currentValue=g),Lu(a,o),In(a,o,h,c),o.child;case 6:return a===null&&_t&&((a=c=nn)&&(c=pT(c,o.pendingProps,kr),c!==null?(o.stateNode=c,li=o,nn=null,a=!0):a=!1),a||_s(o)),null;case 13:return a1(a,o,c);case 4:return Oe(o,o.stateNode.containerInfo),h=o.pendingProps,a===null?o.child=To(o,null,h,c):In(a,o,h,c),o.child;case 11:return Z0(a,o,o.type,o.pendingProps,c);case 7:return In(a,o,o.pendingProps,c),o.child;case 8:return In(a,o,o.pendingProps.children,c),o.child;case 12:return In(a,o,o.pendingProps.children,c),o.child;case 10:return h=o.pendingProps,ka(o,o.type,h.value),In(a,o,h.children,c),o.child;case 9:return g=o.type._context,h=o.pendingProps.children,ws(o),g=Xn(g),h=h(g),o.flags|=1,In(a,o,h,c),o.child;case 14:return J0(a,o,o.type,o.pendingProps,c);case 15:return Q0(a,o,o.type,o.pendingProps,c);case 19:return o1(a,o,c);case 31:return h=o.pendingProps,c=o.mode,h={mode:h.mode,children:h.children},a===null?(c=Iu(h,c),c.ref=o.ref,o.child=c,c.return=o,o=c):(c=Xr(a.child,h),c.ref=o.ref,o.child=c,c.return=o,o=c),o;case 22:return e1(a,o,c);case 24:return ws(o),h=Xn(Sn),a===null?(g=Kf(),g===null&&(g=Ut,x=Xf(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),o.memoizedState={parent:h,cache:g},Jf(o),ka(o,Sn,g)):((a.lanes&c)!==0&&(Qf(a,o),Ol(o,null,null,c),Nl()),g=a.memoizedState,x=o.memoizedState,g.parent!==h?(g={parent:h,cache:h},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),ka(o,Sn,h)):(h=x.cache,ka(o,Sn,h),h!==g.cache&&$f(o,[Sn],c,!0))),In(a,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function na(a){a.flags|=4}function c1(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!vv(o)){if(o=Qi.current,o!==null&&((ht&4194048)===ht?Cr!==null:(ht&62914560)!==ht&&(ht&536870912)===0||o!==Cr))throw jl=Zf,Yg;a.flags|=8192}}function Pu(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?ji():536870912,a.lanes|=o,ko|=o)}function Fl(a,o){if(!_t)switch(a.tailMode){case"hidden":o=a.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:h.sibling=null}}function Jt(a){var o=a.alternate!==null&&a.alternate.child===a.child,c=0,h=0;if(o)for(var g=a.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=h,a.childLanes=c,o}function U_(a,o,c){var h=o.pendingProps;switch(Wf(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(o),null;case 1:return Jt(o),null;case 3:return c=o.stateNode,h=null,a!==null&&(h=a.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),Jr(Sn),we(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(_l(o)?na(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Ug())),Jt(o),null;case 26:return c=o.memoizedState,a===null?(na(o),c!==null?(Jt(o),c1(o,c)):(Jt(o),o.flags&=-16777217)):c?c!==a.memoizedState?(na(o),Jt(o),c1(o,c)):(Jt(o),o.flags&=-16777217):(a.memoizedProps!==h&&na(o),Jt(o),o.flags&=-16777217),null;case 27:dt(o),c=se.current;var g=o.type;if(a!==null&&o.stateNode!=null)a.memoizedProps!==h&&na(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return Jt(o),null}a=G.current,_l(o)?Fg(o):(a=cv(g,h,c),o.stateNode=a,na(o))}return Jt(o),null;case 5:if(dt(o),c=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==h&&na(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return Jt(o),null}if(a=G.current,_l(o))Fg(o);else{switch(g=Ku(se.current),a){case 1:a=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:a=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":a=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":a=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":a=g.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?a.multiple=!0:h.size&&(a.size=h.size);break;default:a=typeof h.is=="string"?g.createElement(c,{is:h.is}):g.createElement(c)}}a[en]=o,a[tn]=h;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)a.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=a;e:switch(Bn(a,c,h),c){case"button":case"input":case"select":case"textarea":a=!!h.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&na(o)}}return Jt(o),o.flags&=-16777217,null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==h&&na(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(i(166));if(a=se.current,_l(o)){if(a=o.stateNode,c=o.memoizedProps,h=null,g=li,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}a[en]=o,a=!!(a.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||nv(a.nodeValue,c)),a||_s(o)}else a=Ku(a).createTextNode(h),a[en]=o,o.stateNode=a}return Jt(o),null;case 13:if(h=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(g=_l(o),h!==null&&h.dehydrated!==null){if(a===null){if(!g)throw Error(i(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[en]=o}else Tl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Jt(o),g=!1}else g=Ug(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(ea(o),o):(ea(o),null)}if(ea(o),(o.flags&128)!==0)return o.lanes=c,o;if(c=h!==null,a=a!==null&&a.memoizedState!==null,c){h=o.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var x=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==g&&(h.flags|=2048)}return c!==a&&c&&(o.child.flags|=8192),Pu(o,o.updateQueue),Jt(o),null;case 4:return we(),a===null&&tm(o.stateNode.containerInfo),Jt(o),null;case 10:return Jr(o.type),Jt(o),null;case 19:if(I(_n),g=o.memoizedState,g===null)return Jt(o),null;if(h=(o.flags&128)!==0,x=g.rendering,x===null)if(h)Fl(g,!1);else{if(rn!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(x=Ou(a),x!==null){for(o.flags|=128,Fl(g,!1),a=x.updateQueue,o.updateQueue=a,Pu(o,a),o.subtreeFlags=0,a=c,c=o.child;c!==null;)Pg(c,a),c=c.sibling;return Y(_n,_n.current&1|2),o.child}a=a.sibling}g.tail!==null&&Pe()>zu&&(o.flags|=128,h=!0,Fl(g,!1),o.lanes=4194304)}else{if(!h)if(a=Ou(x),a!==null){if(o.flags|=128,h=!0,a=a.updateQueue,o.updateQueue=a,Pu(o,a),Fl(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!_t)return Jt(o),null}else 2*Pe()-g.renderingStartTime>zu&&c!==536870912&&(o.flags|=128,h=!0,Fl(g,!1),o.lanes=4194304);g.isBackwards?(x.sibling=o.child,o.child=x):(a=g.last,a!==null?a.sibling=x:o.child=x,g.last=x)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Pe(),o.sibling=null,a=_n.current,Y(_n,h?a&1|2:a&1),o):(Jt(o),null);case 22:case 23:return ea(o),ih(),h=o.memoizedState!==null,a!==null?a.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(c&536870912)!==0&&(o.flags&128)===0&&(Jt(o),o.subtreeFlags&6&&(o.flags|=8192)):Jt(o),c=o.updateQueue,c!==null&&Pu(o,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==c&&(o.flags|=2048),a!==null&&I(Es),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),Jr(Sn),Jt(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function H_(a,o){switch(Wf(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return Jr(Sn),we(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return dt(o),null;case 13:if(ea(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(i(340));Tl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return I(_n),null;case 4:return we(),null;case 10:return Jr(o.type),null;case 22:case 23:return ea(o),ih(),a!==null&&I(Es),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return Jr(Sn),null;case 25:return null;default:return null}}function u1(a,o){switch(Wf(o),o.tag){case 3:Jr(Sn),we();break;case 26:case 27:case 5:dt(o);break;case 4:we();break;case 13:ea(o);break;case 19:I(_n);break;case 10:Jr(o.type);break;case 22:case 23:ea(o),ih(),a!==null&&I(Es);break;case 24:Jr(Sn)}}function zl(a,o){try{var c=o.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&a)===a){h=void 0;var x=c.create,A=c.inst;h=x(),A.destroy=h}c=c.next}while(c!==g)}}catch(O){Ft(o,o.return,O)}}function Ma(a,o,c){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var x=g.next;h=x;do{if((h.tag&a)===a){var A=h.inst,O=A.destroy;if(O!==void 0){A.destroy=void 0,g=o;var X=c,le=O;try{le()}catch(ye){Ft(g,X,ye)}}}h=h.next}while(h!==x)}}catch(ye){Ft(o,o.return,ye)}}function d1(a){var o=a.updateQueue;if(o!==null){var c=a.stateNode;try{Jg(o,c)}catch(h){Ft(a,a.return,h)}}}function f1(a,o,c){c.props=ks(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(h){Ft(a,o,h)}}function Ul(a,o){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var h=a.stateNode;break;case 30:h=a.stateNode;break;default:h=a.stateNode}typeof c=="function"?a.refCleanup=c(h):c.current=h}}catch(g){Ft(a,o,g)}}function jr(a,o){var c=a.ref,h=a.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){Ft(a,o,g)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Ft(a,o,g)}else c.current=null}function h1(a){var o=a.type,c=a.memoizedProps,h=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){Ft(a,a.return,g)}}function Nh(a,o,c){try{var h=a.stateNode;cT(h,a.type,c,o),h[tn]=o}catch(g){Ft(a,a.return,g)}}function m1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ha(a.type)||a.tag===4}function Oh(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||m1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ha(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Rh(a,o,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(a),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=qu));else if(h!==4&&(h===27&&Ha(a.type)&&(c=a.stateNode,o=null),a=a.child,a!==null))for(Rh(a,o,c),a=a.sibling;a!==null;)Rh(a,o,c),a=a.sibling}function Bu(a,o,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,o?c.insertBefore(a,o):c.appendChild(a);else if(h!==4&&(h===27&&Ha(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Bu(a,o,c),a=a.sibling;a!==null;)Bu(a,o,c),a=a.sibling}function p1(a){var o=a.stateNode,c=a.memoizedProps;try{for(var h=a.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);Bn(o,h,c),o[en]=a,o[tn]=c}catch(x){Ft(a,a.return,x)}}var ia=!1,cn=!1,Mh=!1,g1=typeof WeakSet=="function"?WeakSet:Set,jn=null;function W_(a,o){if(a=a.containerInfo,rm=nd,a=kg(a),Of(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var A=0,O=-1,X=-1,le=0,ye=0,Se=a,ue=null;t:for(;;){for(var pe;Se!==c||g!==0&&Se.nodeType!==3||(O=A+g),Se!==x||h!==0&&Se.nodeType!==3||(X=A+h),Se.nodeType===3&&(A+=Se.nodeValue.length),(pe=Se.firstChild)!==null;)ue=Se,Se=pe;for(;;){if(Se===a)break t;if(ue===c&&++le===g&&(O=A),ue===x&&++ye===h&&(X=A),(pe=Se.nextSibling)!==null)break;Se=ue,ue=Se.parentNode}Se=pe}c=O===-1||X===-1?null:{start:O,end:X}}else c=null}c=c||{start:0,end:0}}else c=null;for(am={focusedElem:a,selectionRange:c},nd=!1,jn=o;jn!==null;)if(o=jn,a=o.child,(o.subtreeFlags&1024)!==0&&a!==null)a.return=o,jn=a;else for(;jn!==null;){switch(o=jn,x=o.alternate,a=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&x!==null){a=void 0,c=o,g=x.memoizedProps,x=x.memoizedState,h=c.stateNode;try{var qe=ks(c.type,g,c.elementType===c.type);a=h.getSnapshotBeforeUpdate(qe,x),h.__reactInternalSnapshotBeforeUpdate=a}catch($e){Ft(c,c.return,$e)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,c=a.nodeType,c===9)lm(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":lm(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(i(163))}if(a=o.sibling,a!==null){a.return=o.return,jn=a;break}jn=o.return}}function v1(a,o,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:La(a,c),h&4&&zl(5,c);break;case 1:if(La(a,c),h&4)if(a=c.stateNode,o===null)try{a.componentDidMount()}catch(A){Ft(c,c.return,A)}else{var g=ks(c.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(g,o,a.__reactInternalSnapshotBeforeUpdate)}catch(A){Ft(c,c.return,A)}}h&64&&d1(c),h&512&&Ul(c,c.return);break;case 3:if(La(a,c),h&64&&(a=c.updateQueue,a!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{Jg(a,o)}catch(A){Ft(c,c.return,A)}}break;case 27:o===null&&h&4&&p1(c);case 26:case 5:La(a,c),o===null&&h&4&&h1(c),h&512&&Ul(c,c.return);break;case 12:La(a,c);break;case 13:La(a,c),h&4&&b1(a,c),h&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=J_.bind(null,c),gT(a,c))));break;case 22:if(h=c.memoizedState!==null||ia,!h){o=o!==null&&o.memoizedState!==null||cn,g=ia;var x=cn;ia=h,(cn=o)&&!x?Ia(a,c,(c.subtreeFlags&8772)!==0):La(a,c),ia=g,cn=x}break;case 30:break;default:La(a,c)}}function y1(a){var o=a.alternate;o!==null&&(a.alternate=null,y1(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&L(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var $t=null,yi=!1;function ra(a,o,c){for(c=c.child;c!==null;)x1(a,o,c),c=c.sibling}function x1(a,o,c){if(Et&&typeof Et.onCommitFiberUnmount=="function")try{Et.onCommitFiberUnmount(Rt,c)}catch{}switch(c.tag){case 26:cn||jr(c,o),ra(a,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:cn||jr(c,o);var h=$t,g=yi;Ha(c.type)&&($t=c.stateNode,yi=!1),ra(a,o,c),Kl(c.stateNode),$t=h,yi=g;break;case 5:cn||jr(c,o);case 6:if(h=$t,g=yi,$t=null,ra(a,o,c),$t=h,yi=g,$t!==null)if(yi)try{($t.nodeType===9?$t.body:$t.nodeName==="HTML"?$t.ownerDocument.body:$t).removeChild(c.stateNode)}catch(x){Ft(c,o,x)}else try{$t.removeChild(c.stateNode)}catch(x){Ft(c,o,x)}break;case 18:$t!==null&&(yi?(a=$t,ov(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),rc(a)):ov($t,c.stateNode));break;case 4:h=$t,g=yi,$t=c.stateNode.containerInfo,yi=!0,ra(a,o,c),$t=h,yi=g;break;case 0:case 11:case 14:case 15:cn||Ma(2,c,o),cn||Ma(4,c,o),ra(a,o,c);break;case 1:cn||(jr(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"&&f1(c,o,h)),ra(a,o,c);break;case 21:ra(a,o,c);break;case 22:cn=(h=cn)||c.memoizedState!==null,ra(a,o,c),cn=h;break;default:ra(a,o,c)}}function b1(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{rc(a)}catch(c){Ft(o,o.return,c)}}function V_(a){switch(a.tag){case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new g1),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new g1),o;default:throw Error(i(435,a.tag))}}function Lh(a,o){var c=V_(a);o.forEach(function(h){var g=Q_.bind(null,a,h);c.has(h)||(c.add(h),h.then(g,g))})}function Li(a,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],x=a,A=o,O=A;e:for(;O!==null;){switch(O.tag){case 27:if(Ha(O.type)){$t=O.stateNode,yi=!1;break e}break;case 5:$t=O.stateNode,yi=!1;break e;case 3:case 4:$t=O.stateNode.containerInfo,yi=!0;break e}O=O.return}if($t===null)throw Error(i(160));x1(x,A,g),$t=null,yi=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)S1(o,a),o=o.sibling}var dr=null;function S1(a,o){var c=a.alternate,h=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Li(o,a),Ii(a),h&4&&(Ma(3,a,a.return),zl(3,a),Ma(5,a,a.return));break;case 1:Li(o,a),Ii(a),h&512&&(cn||c===null||jr(c,c.return)),h&64&&ia&&(a=a.updateQueue,a!==null&&(h=a.callbacks,h!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=dr;if(Li(o,a),Ii(a),h&512&&(cn||c===null||jr(c,c.return)),h&4){var x=c!==null?c.memoizedState:null;if(h=a.memoizedState,c===null)if(h===null)if(a.stateNode===null){e:{h=a.type,c=a.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":x=g.getElementsByTagName("title")[0],(!x||x[M]||x[en]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(h),g.head.insertBefore(x,g.querySelector("head > title"))),Bn(x,h,c),x[en]=a,ie(x),h=x;break e;case"link":var A=pv("link","href",g).get(h+(c.href||""));if(A){for(var O=0;O<A.length;O++)if(x=A[O],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){A.splice(O,1);break t}}x=g.createElement(h),Bn(x,h,c),g.head.appendChild(x);break;case"meta":if(A=pv("meta","content",g).get(h+(c.content||""))){for(O=0;O<A.length;O++)if(x=A[O],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){A.splice(O,1);break t}}x=g.createElement(h),Bn(x,h,c),g.head.appendChild(x);break;default:throw Error(i(468,h))}x[en]=a,ie(x),h=x}a.stateNode=h}else gv(g,a.type,a.stateNode);else a.stateNode=mv(g,h,a.memoizedProps);else x!==h?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,h===null?gv(g,a.type,a.stateNode):mv(g,h,a.memoizedProps)):h===null&&a.stateNode!==null&&Nh(a,a.memoizedProps,c.memoizedProps)}break;case 27:Li(o,a),Ii(a),h&512&&(cn||c===null||jr(c,c.return)),c!==null&&h&4&&Nh(a,a.memoizedProps,c.memoizedProps);break;case 5:if(Li(o,a),Ii(a),h&512&&(cn||c===null||jr(c,c.return)),a.flags&32){g=a.stateNode;try{or(g,"")}catch(pe){Ft(a,a.return,pe)}}h&4&&a.stateNode!=null&&(g=a.memoizedProps,Nh(a,g,c!==null?c.memoizedProps:g)),h&1024&&(Mh=!0);break;case 6:if(Li(o,a),Ii(a),h&4){if(a.stateNode===null)throw Error(i(162));h=a.memoizedProps,c=a.stateNode;try{c.nodeValue=h}catch(pe){Ft(a,a.return,pe)}}break;case 3:if(Qu=null,g=dr,dr=Zu(o.containerInfo),Li(o,a),dr=g,Ii(a),h&4&&c!==null&&c.memoizedState.isDehydrated)try{rc(o.containerInfo)}catch(pe){Ft(a,a.return,pe)}Mh&&(Mh=!1,_1(a));break;case 4:h=dr,dr=Zu(a.stateNode.containerInfo),Li(o,a),Ii(a),dr=h;break;case 12:Li(o,a),Ii(a);break;case 13:Li(o,a),Ii(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Uh=Pe()),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Lh(a,h)));break;case 22:g=a.memoizedState!==null;var X=c!==null&&c.memoizedState!==null,le=ia,ye=cn;if(ia=le||g,cn=ye||X,Li(o,a),cn=ye,ia=le,Ii(a),h&8192)e:for(o=a.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(c===null||X||ia||cn||Cs(a)),c=null,o=a;;){if(o.tag===5||o.tag===26){if(c===null){X=c=o;try{if(x=X.stateNode,g)A=x.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{O=X.stateNode;var Se=X.memoizedProps.style,ue=Se!=null&&Se.hasOwnProperty("display")?Se.display:null;O.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(pe){Ft(X,X.return,pe)}}}else if(o.tag===6){if(c===null){X=o;try{X.stateNode.nodeValue=g?"":X.memoizedProps}catch(pe){Ft(X,X.return,pe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=a.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Lh(a,c))));break;case 19:Li(o,a),Ii(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,Lh(a,h)));break;case 30:break;case 21:break;default:Li(o,a),Ii(a)}}function Ii(a){var o=a.flags;if(o&2){try{for(var c,h=a.return;h!==null;){if(m1(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var g=c.stateNode,x=Oh(a);Bu(a,x,g);break;case 5:var A=c.stateNode;c.flags&32&&(or(A,""),c.flags&=-33);var O=Oh(a);Bu(a,O,A);break;case 3:case 4:var X=c.stateNode.containerInfo,le=Oh(a);Rh(a,le,X);break;default:throw Error(i(161))}}catch(ye){Ft(a,a.return,ye)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function _1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;_1(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function La(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)v1(a,o.alternate,o),o=o.sibling}function Cs(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:Ma(4,o,o.return),Cs(o);break;case 1:jr(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&f1(o,o.return,c),Cs(o);break;case 27:Kl(o.stateNode);case 26:case 5:jr(o,o.return),Cs(o);break;case 22:o.memoizedState===null&&Cs(o);break;case 30:Cs(o);break;default:Cs(o)}a=a.sibling}}function Ia(a,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,g=a,x=o,A=x.flags;switch(x.tag){case 0:case 11:case 15:Ia(g,x,c),zl(4,x);break;case 1:if(Ia(g,x,c),h=x,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(le){Ft(h,h.return,le)}if(h=x,g=h.updateQueue,g!==null){var O=h.stateNode;try{var X=g.shared.hiddenCallbacks;if(X!==null)for(g.shared.hiddenCallbacks=null,g=0;g<X.length;g++)Zg(X[g],O)}catch(le){Ft(h,h.return,le)}}c&&A&64&&d1(x),Ul(x,x.return);break;case 27:p1(x);case 26:case 5:Ia(g,x,c),c&&h===null&&A&4&&h1(x),Ul(x,x.return);break;case 12:Ia(g,x,c);break;case 13:Ia(g,x,c),c&&A&4&&b1(g,x);break;case 22:x.memoizedState===null&&Ia(g,x,c),Ul(x,x.return);break;case 30:break;default:Ia(g,x,c)}o=o.sibling}}function Ih(a,o){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&Al(c))}function Ph(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Al(a))}function Dr(a,o,c,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)T1(a,o,c,h),o=o.sibling}function T1(a,o,c,h){var g=o.flags;switch(o.tag){case 0:case 11:case 15:Dr(a,o,c,h),g&2048&&zl(9,o);break;case 1:Dr(a,o,c,h);break;case 3:Dr(a,o,c,h),g&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Al(a)));break;case 12:if(g&2048){Dr(a,o,c,h),a=o.stateNode;try{var x=o.memoizedProps,A=x.id,O=x.onPostCommit;typeof O=="function"&&O(A,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(X){Ft(o,o.return,X)}}else Dr(a,o,c,h);break;case 13:Dr(a,o,c,h);break;case 23:break;case 22:x=o.stateNode,A=o.alternate,o.memoizedState!==null?x._visibility&2?Dr(a,o,c,h):Hl(a,o):x._visibility&2?Dr(a,o,c,h):(x._visibility|=2,wo(a,o,c,h,(o.subtreeFlags&10256)!==0)),g&2048&&Ih(A,o);break;case 24:Dr(a,o,c,h),g&2048&&Ph(o.alternate,o);break;default:Dr(a,o,c,h)}}function wo(a,o,c,h,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var x=a,A=o,O=c,X=h,le=A.flags;switch(A.tag){case 0:case 11:case 15:wo(x,A,O,X,g),zl(8,A);break;case 23:break;case 22:var ye=A.stateNode;A.memoizedState!==null?ye._visibility&2?wo(x,A,O,X,g):Hl(x,A):(ye._visibility|=2,wo(x,A,O,X,g)),g&&le&2048&&Ih(A.alternate,A);break;case 24:wo(x,A,O,X,g),g&&le&2048&&Ph(A.alternate,A);break;default:wo(x,A,O,X,g)}o=o.sibling}}function Hl(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=a,h=o,g=h.flags;switch(h.tag){case 22:Hl(c,h),g&2048&&Ih(h.alternate,h);break;case 24:Hl(c,h),g&2048&&Ph(h.alternate,h);break;default:Hl(c,h)}o=o.sibling}}var Wl=8192;function Eo(a){if(a.subtreeFlags&Wl)for(a=a.child;a!==null;)w1(a),a=a.sibling}function w1(a){switch(a.tag){case 26:Eo(a),a.flags&Wl&&a.memoizedState!==null&&jT(dr,a.memoizedState,a.memoizedProps);break;case 5:Eo(a);break;case 3:case 4:var o=dr;dr=Zu(a.stateNode.containerInfo),Eo(a),dr=o;break;case 22:a.memoizedState===null&&(o=a.alternate,o!==null&&o.memoizedState!==null?(o=Wl,Wl=16777216,Eo(a),Wl=o):Eo(a));break;default:Eo(a)}}function E1(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function Vl(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];jn=h,k1(h,a)}E1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)A1(a),a=a.sibling}function A1(a){switch(a.tag){case 0:case 11:case 15:Vl(a),a.flags&2048&&Ma(9,a,a.return);break;case 3:Vl(a);break;case 12:Vl(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,Fu(a)):Vl(a);break;default:Vl(a)}}function Fu(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];jn=h,k1(h,a)}E1(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:Ma(8,o,o.return),Fu(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Fu(o));break;default:Fu(o)}a=a.sibling}}function k1(a,o){for(;jn!==null;){var c=jn;switch(c.tag){case 0:case 11:case 15:Ma(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Al(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,jn=h;else e:for(c=a;jn!==null;){h=jn;var g=h.sibling,x=h.return;if(y1(h),h===c){jn=null;break e}if(g!==null){g.return=x,jn=g;break e}jn=x}}}var G_={getCacheForType:function(a){var o=Xn(Sn),c=o.data.get(a);return c===void 0&&(c=a(),o.data.set(a,c)),c}},Y_=typeof WeakMap=="function"?WeakMap:Map,At=0,Ut=null,ct=null,ht=0,kt=0,Pi=null,Pa=!1,Ao=!1,Bh=!1,aa=0,rn=0,Ba=0,js=0,Fh=0,er=0,ko=0,Gl=null,xi=null,zh=!1,Uh=0,zu=1/0,Uu=null,Fa=null,Pn=0,za=null,Co=null,jo=0,Hh=0,Wh=null,C1=null,Yl=0,Vh=null;function Bi(){if((At&2)!==0&&ht!==0)return ht&-ht;if(ne.T!==null){var a=go;return a!==0?a:Zh()}return to()}function j1(){er===0&&(er=(ht&536870912)===0||_t?$n():536870912);var a=Qi.current;return a!==null&&(a.flags|=32),er}function Fi(a,o,c){(a===Ut&&(kt===2||kt===9)||a.cancelPendingCommit!==null)&&(Do(a,0),Ua(a,ht,er,!1)),Kt(a,c),((At&2)===0||a!==Ut)&&(a===Ut&&((At&2)===0&&(js|=c),rn===4&&Ua(a,ht,er,!1)),Nr(a))}function D1(a,o,c){if((At&6)!==0)throw Error(i(327));var h=!c&&(o&124)===0&&(o&a.expiredLanes)===0||tt(a,o),g=h?q_(a,o):$h(a,o,!0),x=h;do{if(g===0){Ao&&!h&&Ua(a,o,0,!1);break}else{if(c=a.current.alternate,x&&!$_(c)){g=$h(a,o,!1),x=!1;continue}if(g===2){if(x=o,a.errorRecoveryDisabledLanes&x)var A=0;else A=a.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var O=a;g=Gl;var X=O.current.memoizedState.isDehydrated;if(X&&(Do(O,A).flags|=256),A=$h(O,A,!1),A!==2){if(Bh&&!X){O.errorRecoveryDisabledLanes|=x,js|=x,g=4;break e}x=xi,xi=g,x!==null&&(xi===null?xi=x:xi.push.apply(xi,x))}g=A}if(x=!1,g!==2)continue}}if(g===1){Do(a,0),Ua(a,o,0,!0);break}e:{switch(h=a,x=g,x){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Ua(h,o,er,!Pa);break e;case 2:xi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(g=Uh+300-Pe(),10<g)){if(Ua(h,o,er,!Pa),ri(h,0,!0)!==0)break e;h.timeoutHandle=av(N1.bind(null,h,c,xi,Uu,zh,o,er,js,ko,Pa,x,2,-0,0),g);break e}N1(h,c,xi,Uu,zh,o,er,js,ko,Pa,x,0,-0,0)}}break}while(!0);Nr(a)}function N1(a,o,c,h,g,x,A,O,X,le,ye,Se,ue,pe){if(a.timeoutHandle=-1,Se=o.subtreeFlags,(Se&8192||(Se&16785408)===16785408)&&(Ql={stylesheets:null,count:0,unsuspend:CT},w1(o),Se=DT(),Se!==null)){a.cancelPendingCommit=Se(B1.bind(null,a,o,x,c,h,g,A,O,X,ye,1,ue,pe)),Ua(a,x,A,!le);return}B1(a,o,x,c,h,g,A,O,X)}function $_(a){for(var o=a;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],x=g.getSnapshot;g=g.value;try{if(!Ri(x(),g))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ua(a,o,c,h){o&=~Fh,o&=~js,a.suspendedLanes|=o,a.pingedLanes&=~o,h&&(a.warmLanes|=o),h=a.expirationTimes;for(var g=o;0<g;){var x=31-te(g),A=1<<x;h[x]=-1,g&=~A}c!==0&&Sa(a,c,o)}function Hu(){return(At&6)===0?($l(0),!1):!0}function Gh(){if(ct!==null){if(kt===0)var a=ct.return;else a=ct,Zr=Ts=null,lh(a),_o=null,Pl=0,a=ct;for(;a!==null;)u1(a.alternate,a),a=a.return;ct=null}}function Do(a,o){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,dT(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),Gh(),Ut=a,ct=c=Xr(a.current,null),ht=o,kt=0,Pi=null,Pa=!1,Ao=tt(a,o),Bh=!1,ko=er=Fh=js=Ba=rn=0,xi=Gl=null,zh=!1,(o&8)!==0&&(o|=o&32);var h=a.entangledLanes;if(h!==0)for(a=a.entanglements,h&=o;0<h;){var g=31-te(h),x=1<<g;o|=a[g],h&=~x}return aa=o,uu(),c}function O1(a,o){ot=null,ne.H=ju,o===Cl||o===xu?(o=qg(),kt=3):o===Yg?(o=qg(),kt=4):kt=o===K0?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Pi=o,ct===null&&(rn=1,Mu(a,qi(o,a.current)))}function R1(){var a=ne.H;return ne.H=ju,a===null?ju:a}function M1(){var a=ne.A;return ne.A=G_,a}function Yh(){rn=4,Pa||(ht&4194048)!==ht&&Qi.current!==null||(Ao=!0),(Ba&134217727)===0&&(js&134217727)===0||Ut===null||Ua(Ut,ht,er,!1)}function $h(a,o,c){var h=At;At|=2;var g=R1(),x=M1();(Ut!==a||ht!==o)&&(Uu=null,Do(a,o)),o=!1;var A=rn;e:do try{if(kt!==0&&ct!==null){var O=ct,X=Pi;switch(kt){case 8:Gh(),A=6;break e;case 3:case 2:case 9:case 6:Qi.current===null&&(o=!0);var le=kt;if(kt=0,Pi=null,No(a,O,X,le),c&&Ao){A=0;break e}break;default:le=kt,kt=0,Pi=null,No(a,O,X,le)}}X_(),A=rn;break}catch(ye){O1(a,ye)}while(!0);return o&&a.shellSuspendCounter++,Zr=Ts=null,At=h,ne.H=g,ne.A=x,ct===null&&(Ut=null,ht=0,uu()),A}function X_(){for(;ct!==null;)L1(ct)}function q_(a,o){var c=At;At|=2;var h=R1(),g=M1();Ut!==a||ht!==o?(Uu=null,zu=Pe()+500,Do(a,o)):Ao=tt(a,o);e:do try{if(kt!==0&&ct!==null){o=ct;var x=Pi;t:switch(kt){case 1:kt=0,Pi=null,No(a,o,x,1);break;case 2:case 9:if($g(x)){kt=0,Pi=null,I1(o);break}o=function(){kt!==2&&kt!==9||Ut!==a||(kt=7),Nr(a)},x.then(o,o);break e;case 3:kt=7;break e;case 4:kt=5;break e;case 7:$g(x)?(kt=0,Pi=null,I1(o)):(kt=0,Pi=null,No(a,o,x,7));break;case 5:var A=null;switch(ct.tag){case 26:A=ct.memoizedState;case 5:case 27:var O=ct;if(!A||vv(A)){kt=0,Pi=null;var X=O.sibling;if(X!==null)ct=X;else{var le=O.return;le!==null?(ct=le,Wu(le)):ct=null}break t}}kt=0,Pi=null,No(a,o,x,5);break;case 6:kt=0,Pi=null,No(a,o,x,6);break;case 8:Gh(),rn=6;break e;default:throw Error(i(462))}}K_();break}catch(ye){O1(a,ye)}while(!0);return Zr=Ts=null,ne.H=h,ne.A=g,At=c,ct!==null?0:(Ut=null,ht=0,uu(),rn)}function K_(){for(;ct!==null&&!Yn();)L1(ct)}function L1(a){var o=l1(a.alternate,a,aa);a.memoizedProps=a.pendingProps,o===null?Wu(a):ct=o}function I1(a){var o=a,c=o.alternate;switch(o.tag){case 15:case 0:o=n1(c,o,o.pendingProps,o.type,void 0,ht);break;case 11:o=n1(c,o,o.pendingProps,o.type.render,o.ref,ht);break;case 5:lh(o);default:u1(c,o),o=ct=Pg(o,aa),o=l1(c,o,aa)}a.memoizedProps=a.pendingProps,o===null?Wu(a):ct=o}function No(a,o,c,h){Zr=Ts=null,lh(o),_o=null,Pl=0;var g=o.return;try{if(F_(a,g,o,c,ht)){rn=1,Mu(a,qi(c,a.current)),ct=null;return}}catch(x){if(g!==null)throw ct=g,x;rn=1,Mu(a,qi(c,a.current)),ct=null;return}o.flags&32768?(_t||h===1?a=!0:Ao||(ht&536870912)!==0?a=!1:(Pa=a=!0,(h===2||h===9||h===3||h===6)&&(h=Qi.current,h!==null&&h.tag===13&&(h.flags|=16384))),P1(o,a)):Wu(o)}function Wu(a){var o=a;do{if((o.flags&32768)!==0){P1(o,Pa);return}a=o.return;var c=U_(o.alternate,o,aa);if(c!==null){ct=c;return}if(o=o.sibling,o!==null){ct=o;return}ct=o=a}while(o!==null);rn===0&&(rn=5)}function P1(a,o){do{var c=H_(a.alternate,a);if(c!==null){c.flags&=32767,ct=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(a=a.sibling,a!==null)){ct=a;return}ct=a=c}while(a!==null);rn=6,ct=null}function B1(a,o,c,h,g,x,A,O,X){a.cancelPendingCommit=null;do Vu();while(Pn!==0);if((At&6)!==0)throw Error(i(327));if(o!==null){if(o===a.current)throw Error(i(177));if(x=o.lanes|o.childLanes,x|=Pf,Gi(a,c,x,A,O,X),a===Ut&&(ct=Ut=null,ht=0),Co=o,za=a,jo=c,Hh=x,Wh=g,C1=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,eT(ii,function(){return W1(),null})):(a.callbackNode=null,a.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=ne.T,ne.T=null,g=Z.p,Z.p=2,A=At,At|=4;try{W_(a,o,c)}finally{At=A,Z.p=g,ne.T=h}}Pn=1,F1(),z1(),U1()}}function F1(){if(Pn===1){Pn=0;var a=za,o=Co,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var h=Z.p;Z.p=2;var g=At;At|=4;try{S1(o,a);var x=am,A=kg(a.containerInfo),O=x.focusedElem,X=x.selectionRange;if(A!==O&&O&&O.ownerDocument&&Ag(O.ownerDocument.documentElement,O)){if(X!==null&&Of(O)){var le=X.start,ye=X.end;if(ye===void 0&&(ye=le),"selectionStart"in O)O.selectionStart=le,O.selectionEnd=Math.min(ye,O.value.length);else{var Se=O.ownerDocument||document,ue=Se&&Se.defaultView||window;if(ue.getSelection){var pe=ue.getSelection(),qe=O.textContent.length,$e=Math.min(X.start,qe),It=X.end===void 0?$e:Math.min(X.end,qe);!pe.extend&&$e>It&&(A=It,It=$e,$e=A);var re=Eg(O,$e),ee=Eg(O,It);if(re&&ee&&(pe.rangeCount!==1||pe.anchorNode!==re.node||pe.anchorOffset!==re.offset||pe.focusNode!==ee.node||pe.focusOffset!==ee.offset)){var ae=Se.createRange();ae.setStart(re.node,re.offset),pe.removeAllRanges(),$e>It?(pe.addRange(ae),pe.extend(ee.node,ee.offset)):(ae.setEnd(ee.node,ee.offset),pe.addRange(ae))}}}}for(Se=[],pe=O;pe=pe.parentNode;)pe.nodeType===1&&Se.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<Se.length;O++){var xe=Se[O];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}nd=!!rm,am=rm=null}finally{At=g,Z.p=h,ne.T=c}}a.current=o,Pn=2}}function z1(){if(Pn===2){Pn=0;var a=za,o=Co,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var h=Z.p;Z.p=2;var g=At;At|=4;try{v1(a,o.alternate,o)}finally{At=g,Z.p=h,ne.T=c}}Pn=3}}function U1(){if(Pn===4||Pn===3){Pn=0,vt();var a=za,o=Co,c=jo,h=C1;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Pn=5:(Pn=0,Co=za=null,H1(a,a.pendingLanes));var g=a.pendingLanes;if(g===0&&(Fa=null),us(c),o=o.stateNode,Et&&typeof Et.onCommitFiberRoot=="function")try{Et.onCommitFiberRoot(Rt,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=ne.T,g=Z.p,Z.p=2,ne.T=null;try{for(var x=a.onRecoverableError,A=0;A<h.length;A++){var O=h[A];x(O.value,{componentStack:O.stack})}}finally{ne.T=o,Z.p=g}}(jo&3)!==0&&Vu(),Nr(a),g=a.pendingLanes,(c&4194090)!==0&&(g&42)!==0?a===Vh?Yl++:(Yl=0,Vh=a):Yl=0,$l(0)}}function H1(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Al(o)))}function Vu(a){return F1(),z1(),U1(),W1()}function W1(){if(Pn!==5)return!1;var a=za,o=Hh;Hh=0;var c=us(jo),h=ne.T,g=Z.p;try{Z.p=32>c?32:c,ne.T=null,c=Wh,Wh=null;var x=za,A=jo;if(Pn=0,Co=za=null,jo=0,(At&6)!==0)throw Error(i(331));var O=At;if(At|=4,A1(x.current),T1(x,x.current,A,c),At=O,$l(0,!1),Et&&typeof Et.onPostCommitFiberRoot=="function")try{Et.onPostCommitFiberRoot(Rt,x)}catch{}return!0}finally{Z.p=g,ne.T=h,H1(a,o)}}function V1(a,o,c){o=qi(c,o),o=_h(a.stateNode,o,2),a=Da(a,o,2),a!==null&&(Kt(a,2),Nr(a))}function Ft(a,o,c){if(a.tag===3)V1(a,a,c);else for(;o!==null;){if(o.tag===3){V1(o,a,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Fa===null||!Fa.has(h))){a=qi(c,a),c=X0(2),h=Da(o,c,2),h!==null&&(q0(c,h,o,a),Kt(h,2),Nr(h));break}}o=o.return}}function Xh(a,o,c){var h=a.pingCache;if(h===null){h=a.pingCache=new Y_;var g=new Set;h.set(o,g)}else g=h.get(o),g===void 0&&(g=new Set,h.set(o,g));g.has(c)||(Bh=!0,g.add(c),a=Z_.bind(null,a,o,c),o.then(a,a))}function Z_(a,o,c){var h=a.pingCache;h!==null&&h.delete(o),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Ut===a&&(ht&c)===c&&(rn===4||rn===3&&(ht&62914560)===ht&&300>Pe()-Uh?(At&2)===0&&Do(a,0):Fh|=c,ko===ht&&(ko=0)),Nr(a)}function G1(a,o){o===0&&(o=ji()),a=fo(a,o),a!==null&&(Kt(a,o),Nr(a))}function J_(a){var o=a.memoizedState,c=0;o!==null&&(c=o.retryLane),G1(a,c)}function Q_(a,o){var c=0;switch(a.tag){case 13:var h=a.stateNode,g=a.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=a.stateNode;break;case 22:h=a.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(o),G1(a,c)}function eT(a,o){return Yt(a,o)}var Gu=null,Oo=null,qh=!1,Yu=!1,Kh=!1,Ds=0;function Nr(a){a!==Oo&&a.next===null&&(Oo===null?Gu=Oo=a:Oo=Oo.next=a),Yu=!0,qh||(qh=!0,nT())}function $l(a,o){if(!Kh&&Yu){Kh=!0;do for(var c=!1,h=Gu;h!==null;){if(a!==0){var g=h.pendingLanes;if(g===0)var x=0;else{var A=h.suspendedLanes,O=h.pingedLanes;x=(1<<31-te(42|a)+1)-1,x&=g&~(A&~O),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,q1(h,x))}else x=ht,x=ri(h,h===Ut?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(x&3)===0||tt(h,x)||(c=!0,q1(h,x));h=h.next}while(c);Kh=!1}}function tT(){Y1()}function Y1(){Yu=qh=!1;var a=0;Ds!==0&&(uT()&&(a=Ds),Ds=0);for(var o=Pe(),c=null,h=Gu;h!==null;){var g=h.next,x=$1(h,o);x===0?(h.next=null,c===null?Gu=g:c.next=g,g===null&&(Oo=c)):(c=h,(a!==0||(x&3)!==0)&&(Yu=!0)),h=g}$l(a)}function $1(a,o){for(var c=a.suspendedLanes,h=a.pingedLanes,g=a.expirationTimes,x=a.pendingLanes&-62914561;0<x;){var A=31-te(x),O=1<<A,X=g[A];X===-1?((O&c)===0||(O&h)!==0)&&(g[A]=ai(O,o)):X<=o&&(a.expiredLanes|=O),x&=~O}if(o=Ut,c=ht,c=ri(a,a===o?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h=a.callbackNode,c===0||a===o&&(kt===2||kt===9)||a.cancelPendingCommit!==null)return h!==null&&h!==null&&at(h),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||tt(a,c)){if(o=c&-c,o===a.callbackPriority)return o;switch(h!==null&&at(h),us(c)){case 2:case 8:c=ni;break;case 32:c=ii;break;case 268435456:c=ze;break;default:c=ii}return h=X1.bind(null,a),c=Yt(c,h),a.callbackPriority=o,a.callbackNode=c,o}return h!==null&&h!==null&&at(h),a.callbackPriority=2,a.callbackNode=null,2}function X1(a,o){if(Pn!==0&&Pn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(Vu()&&a.callbackNode!==c)return null;var h=ht;return h=ri(a,a===Ut?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h===0?null:(D1(a,h,o),$1(a,Pe()),a.callbackNode!=null&&a.callbackNode===c?X1.bind(null,a):null)}function q1(a,o){if(Vu())return null;D1(a,o,!0)}function nT(){fT(function(){(At&6)!==0?Yt(Mn,tT):Y1()})}function Zh(){return Ds===0&&(Ds=$n()),Ds}function K1(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:lr(""+a)}function Z1(a,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,a.id&&c.setAttribute("form",a.id),o.parentNode.insertBefore(c,o),a=new FormData(a),c.parentNode.removeChild(c),a}function iT(a,o,c,h,g){if(o==="submit"&&c&&c.stateNode===g){var x=K1((g[tn]||null).action),A=h.submitter;A&&(o=(o=A[tn]||null)?K1(o.formAction):A.getAttribute("formAction"),o!==null&&(x=o,A=null));var O=new je("action","action",null,h,g);a.push({event:O,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ds!==0){var X=A?Z1(g,A):new FormData(g);vh(c,{pending:!0,data:X,method:g.method,action:x},null,X)}}else typeof x=="function"&&(O.preventDefault(),X=A?Z1(g,A):new FormData(g),vh(c,{pending:!0,data:X,method:g.method,action:x},x,X))},currentTarget:g}]})}}for(var Jh=0;Jh<If.length;Jh++){var Qh=If[Jh],rT=Qh.toLowerCase(),aT=Qh[0].toUpperCase()+Qh.slice(1);ur(rT,"on"+aT)}ur(Dg,"onAnimationEnd"),ur(Ng,"onAnimationIteration"),ur(Og,"onAnimationStart"),ur("dblclick","onDoubleClick"),ur("focusin","onFocus"),ur("focusout","onBlur"),ur(__,"onTransitionRun"),ur(T_,"onTransitionStart"),ur(w_,"onTransitionCancel"),ur(Rg,"onTransitionEnd"),De("onMouseEnter",["mouseout","mouseover"]),De("onMouseLeave",["mouseout","mouseover"]),De("onPointerEnter",["pointerout","pointerover"]),De("onPointerLeave",["pointerout","pointerover"]),Te("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Te("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Te("onBeforeInput",["compositionend","keypress","textInput","paste"]),Te("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Te("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xl));function J1(a,o){o=(o&4)!==0;for(var c=0;c<a.length;c++){var h=a[c],g=h.event;h=h.listeners;e:{var x=void 0;if(o)for(var A=h.length-1;0<=A;A--){var O=h[A],X=O.instance,le=O.currentTarget;if(O=O.listener,X!==x&&g.isPropagationStopped())break e;x=O,g.currentTarget=le;try{x(g)}catch(ye){Ru(ye)}g.currentTarget=null,x=X}else for(A=0;A<h.length;A++){if(O=h[A],X=O.instance,le=O.currentTarget,O=O.listener,X!==x&&g.isPropagationStopped())break e;x=O,g.currentTarget=le;try{x(g)}catch(ye){Ru(ye)}g.currentTarget=null,x=X}}}}function ut(a,o){var c=o[ds];c===void 0&&(c=o[ds]=new Set);var h=a+"__bubble";c.has(h)||(Q1(o,a,2,!1),c.add(h))}function em(a,o,c){var h=0;o&&(h|=4),Q1(c,a,h,o)}var $u="_reactListening"+Math.random().toString(36).slice(2);function tm(a){if(!a[$u]){a[$u]=!0,ce.forEach(function(c){c!=="selectionchange"&&(sT.has(c)||em(c,!1,a),em(c,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[$u]||(o[$u]=!0,em("selectionchange",!1,o))}}function Q1(a,o,c,h){switch(Tv(o)){case 2:var g=RT;break;case 8:g=MT;break;default:g=pm}c=g.bind(null,o,c,a),g=void 0,!ao||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),h?g!==void 0?a.addEventListener(o,c,{capture:!0,passive:g}):a.addEventListener(o,c,!0):g!==void 0?a.addEventListener(o,c,{passive:g}):a.addEventListener(o,c,!1)}function nm(a,o,c,h,g){var x=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var O=h.stateNode.containerInfo;if(O===g)break;if(A===4)for(A=h.return;A!==null;){var X=A.tag;if((X===3||X===4)&&A.stateNode.containerInfo===g)return;A=A.return}for(;O!==null;){if(A=F(O),A===null)return;if(X=A.tag,X===5||X===6||X===26||X===27){h=x=A;continue e}O=O.parentNode}}h=h.return}Ni(function(){var le=x,ye=ro(c),Se=[];e:{var ue=Mg.get(a);if(ue!==void 0){var pe=je,qe=a;switch(a){case"keypress":if(ms(c)===0)break e;case"keydown":case"keyup":pe=e_;break;case"focusin":qe="focus",pe=so;break;case"focusout":qe="blur",pe=so;break;case"beforeblur":case"afterblur":pe=so;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=Aa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=kn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=i_;break;case Dg:case Ng:case Og:pe=G2;break;case Rg:pe=a_;break;case"scroll":case"scrollend":pe=zt;break;case"wheel":pe=o_;break;case"copy":case"cut":case"paste":pe=$2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=dg;break;case"toggle":case"beforetoggle":pe=c_}var $e=(o&4)!==0,It=!$e&&(a==="scroll"||a==="scrollend"),re=$e?ue!==null?ue+"Capture":null:ue;$e=[];for(var ee=le,ae;ee!==null;){var xe=ee;if(ae=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||ae===null||re===null||(xe=$i(ee,re),xe!=null&&$e.push(ql(ee,xe,ae))),It)break;ee=ee.return}0<$e.length&&(ue=new pe(ue,qe,null,c,ye),Se.push({event:ue,listeners:$e}))}}if((o&7)===0){e:{if(ue=a==="mouseover"||a==="pointerover",pe=a==="mouseout"||a==="pointerout",ue&&c!==fl&&(qe=c.relatedTarget||c.fromElement)&&(F(qe)||qe[Tr]))break e;if((pe||ue)&&(ue=ye.window===ye?ye:(ue=ye.ownerDocument)?ue.defaultView||ue.parentWindow:window,pe?(qe=c.relatedTarget||c.toElement,pe=le,qe=qe?F(qe):null,qe!==null&&(It=s(qe),$e=qe.tag,qe!==It||$e!==5&&$e!==27&&$e!==6)&&(qe=null)):(pe=null,qe=le),pe!==qe)){if($e=Aa,xe="onMouseLeave",re="onMouseEnter",ee="mouse",(a==="pointerout"||a==="pointerover")&&($e=dg,xe="onPointerLeave",re="onPointerEnter",ee="pointer"),It=pe==null?ue:oe(pe),ae=qe==null?ue:oe(qe),ue=new $e(xe,ee+"leave",pe,c,ye),ue.target=It,ue.relatedTarget=ae,xe=null,F(ye)===le&&($e=new $e(re,ee+"enter",qe,c,ye),$e.target=ae,$e.relatedTarget=It,xe=$e),It=xe,pe&&qe)t:{for($e=pe,re=qe,ee=0,ae=$e;ae;ae=Ro(ae))ee++;for(ae=0,xe=re;xe;xe=Ro(xe))ae++;for(;0<ee-ae;)$e=Ro($e),ee--;for(;0<ae-ee;)re=Ro(re),ae--;for(;ee--;){if($e===re||re!==null&&$e===re.alternate)break t;$e=Ro($e),re=Ro(re)}$e=null}else $e=null;pe!==null&&ev(Se,ue,pe,$e,!1),qe!==null&&It!==null&&ev(Se,It,qe,$e,!0)}}e:{if(ue=le?oe(le):window,pe=ue.nodeName&&ue.nodeName.toLowerCase(),pe==="select"||pe==="input"&&ue.type==="file")var He=xg;else if(vg(ue))if(bg)He=x_;else{He=v_;var lt=g_}else pe=ue.nodeName,!pe||pe.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?le&&dl(le.elementType)&&(He=xg):He=y_;if(He&&(He=He(a,le))){yg(Se,He,c,ye);break e}lt&&lt(a,ue,le),a==="focusout"&&le&&ue.type==="number"&&le.memoizedProps.value!=null&&wr(ue,"number",ue.value)}switch(lt=le?oe(le):window,a){case"focusin":(vg(lt)||lt.contentEditable==="true")&&(lo=lt,Rf=le,Sl=null);break;case"focusout":Sl=Rf=lo=null;break;case"mousedown":Mf=!0;break;case"contextmenu":case"mouseup":case"dragend":Mf=!1,Cg(Se,c,ye);break;case"selectionchange":if(S_)break;case"keydown":case"keyup":Cg(Se,c,ye)}var Ve;if(jf)e:{switch(a){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else oo?pg(a,c)&&(Xe="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(Xe="onCompositionStart");Xe&&(fg&&c.locale!=="ko"&&(oo||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&oo&&(Ve=pl()):(cr=ye,Oi="value"in cr?cr.value:cr.textContent,oo=!0)),lt=Xu(le,Xe),0<lt.length&&(Xe=new ug(Xe,a,null,c,ye),Se.push({event:Xe,listeners:lt}),Ve?Xe.data=Ve:(Ve=gg(c),Ve!==null&&(Xe.data=Ve)))),(Ve=d_?f_(a,c):h_(a,c))&&(Xe=Xu(le,"onBeforeInput"),0<Xe.length&&(lt=new ug("onBeforeInput","beforeinput",null,c,ye),Se.push({event:lt,listeners:Xe}),lt.data=Ve)),iT(Se,a,le,c,ye)}J1(Se,o)})}function ql(a,o,c){return{instance:a,listener:o,currentTarget:c}}function Xu(a,o){for(var c=o+"Capture",h=[];a!==null;){var g=a,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=$i(a,c),g!=null&&h.unshift(ql(a,g,x)),g=$i(a,o),g!=null&&h.push(ql(a,g,x))),a.tag===3)return h;a=a.return}return[]}function Ro(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function ev(a,o,c,h,g){for(var x=o._reactName,A=[];c!==null&&c!==h;){var O=c,X=O.alternate,le=O.stateNode;if(O=O.tag,X!==null&&X===h)break;O!==5&&O!==26&&O!==27||le===null||(X=le,g?(le=$i(c,x),le!=null&&A.unshift(ql(c,le,X))):g||(le=$i(c,x),le!=null&&A.push(ql(c,le,X)))),c=c.return}A.length!==0&&a.push({event:o,listeners:A})}var oT=/\r\n?/g,lT=/\u0000|\uFFFD/g;function tv(a){return(typeof a=="string"?a:""+a).replace(oT,`
`).replace(lT,"")}function nv(a,o){return o=tv(o),tv(a)===o}function qu(){}function Lt(a,o,c,h,g,x){switch(c){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||or(a,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&or(a,""+h);break;case"className":xt(a,"class",h);break;case"tabIndex":xt(a,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":xt(a,c,h);break;case"style":Ea(a,h,x);break;case"data":if(o!=="object"){xt(a,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||c!=="href")){a.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=lr(""+h),a.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(o!=="input"&&Lt(a,o,"name",g.name,g,null),Lt(a,o,"formEncType",g.formEncType,g,null),Lt(a,o,"formMethod",g.formMethod,g,null),Lt(a,o,"formTarget",g.formTarget,g,null)):(Lt(a,o,"encType",g.encType,g,null),Lt(a,o,"method",g.method,g,null),Lt(a,o,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=lr(""+h),a.setAttribute(c,h);break;case"onClick":h!=null&&(a.onclick=qu);break;case"onScroll":h!=null&&ut("scroll",a);break;case"onScrollEnd":h!=null&&ut("scrollend",a);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));a.innerHTML=c}}break;case"multiple":a.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":a.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){a.removeAttribute("xlink:href");break}c=lr(""+h),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""+h):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":h===!0?a.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,h):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?a.setAttribute(c,h):a.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?a.removeAttribute(c):a.setAttribute(c,h);break;case"popover":ut("beforetoggle",a),ut("toggle",a),yt(a,"popover",h);break;case"xlinkActuate":mt(a,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":mt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":mt(a,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":mt(a,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":mt(a,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":mt(a,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":mt(a,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":mt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":mt(a,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":yt(a,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=kf.get(c)||c,yt(a,c,h))}}function im(a,o,c,h,g,x){switch(c){case"style":Ea(a,h,x);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));a.innerHTML=c}}break;case"children":typeof h=="string"?or(a,h):(typeof h=="number"||typeof h=="bigint")&&or(a,""+h);break;case"onScroll":h!=null&&ut("scroll",a);break;case"onScrollEnd":h!=null&&ut("scrollend",a);break;case"onClick":h!=null&&(a.onclick=qu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fe.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),o=c.slice(2,g?c.length-7:void 0),x=a[tn]||null,x=x!=null?x[c]:null,typeof x=="function"&&a.removeEventListener(o,x,g),typeof h=="function")){typeof x!="function"&&x!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(o,h,g);break e}c in a?a[c]=h:h===!0?a.setAttribute(c,""):yt(a,c,h)}}}function Bn(a,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ut("error",a),ut("load",a);var h=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var A=c[x];if(A!=null)switch(x){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Lt(a,o,x,A,c,null)}}g&&Lt(a,o,"srcSet",c.srcSet,c,null),h&&Lt(a,o,"src",c.src,c,null);return;case"input":ut("invalid",a);var O=x=A=g=null,X=null,le=null;for(h in c)if(c.hasOwnProperty(h)){var ye=c[h];if(ye!=null)switch(h){case"name":g=ye;break;case"type":A=ye;break;case"checked":X=ye;break;case"defaultChecked":le=ye;break;case"value":x=ye;break;case"defaultValue":O=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(i(137,o));break;default:Lt(a,o,h,ye,c,null)}}Yi(a,x,O,X,le,A,g,!1),fs(a);return;case"select":ut("invalid",a),h=A=x=null;for(g in c)if(c.hasOwnProperty(g)&&(O=c[g],O!=null))switch(g){case"value":x=O;break;case"defaultValue":A=O;break;case"multiple":h=O;default:Lt(a,o,g,O,c,null)}o=x,c=A,a.multiple=!!h,o!=null?Er(a,!!h,o,!1):c!=null&&Er(a,!!h,c,!0);return;case"textarea":ut("invalid",a),x=g=h=null;for(A in c)if(c.hasOwnProperty(A)&&(O=c[A],O!=null))switch(A){case"value":h=O;break;case"defaultValue":g=O;break;case"children":x=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(91));break;default:Lt(a,o,A,O,c,null)}au(a,h,g,x),fs(a);return;case"option":for(X in c)if(c.hasOwnProperty(X)&&(h=c[X],h!=null))switch(X){case"selected":a.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Lt(a,o,X,h,c,null)}return;case"dialog":ut("beforetoggle",a),ut("toggle",a),ut("cancel",a),ut("close",a);break;case"iframe":case"object":ut("load",a);break;case"video":case"audio":for(h=0;h<Xl.length;h++)ut(Xl[h],a);break;case"image":ut("error",a),ut("load",a);break;case"details":ut("toggle",a);break;case"embed":case"source":case"link":ut("error",a),ut("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in c)if(c.hasOwnProperty(le)&&(h=c[le],h!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Lt(a,o,le,h,c,null)}return;default:if(dl(o)){for(ye in c)c.hasOwnProperty(ye)&&(h=c[ye],h!==void 0&&im(a,o,ye,h,c,void 0));return}}for(O in c)c.hasOwnProperty(O)&&(h=c[O],h!=null&&Lt(a,o,O,h,c,null))}function cT(a,o,c,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,A=null,O=null,X=null,le=null,ye=null;for(pe in c){var Se=c[pe];if(c.hasOwnProperty(pe)&&Se!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":X=Se;default:h.hasOwnProperty(pe)||Lt(a,o,pe,null,h,Se)}}for(var ue in h){var pe=h[ue];if(Se=c[ue],h.hasOwnProperty(ue)&&(pe!=null||Se!=null))switch(ue){case"type":x=pe;break;case"name":g=pe;break;case"checked":le=pe;break;case"defaultChecked":ye=pe;break;case"value":A=pe;break;case"defaultValue":O=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,o));break;default:pe!==Se&&Lt(a,o,ue,pe,h,Se)}}wa(a,A,O,X,le,ye,x,g);return;case"select":pe=A=O=ue=null;for(x in c)if(X=c[x],c.hasOwnProperty(x)&&X!=null)switch(x){case"value":break;case"multiple":pe=X;default:h.hasOwnProperty(x)||Lt(a,o,x,null,h,X)}for(g in h)if(x=h[g],X=c[g],h.hasOwnProperty(g)&&(x!=null||X!=null))switch(g){case"value":ue=x;break;case"defaultValue":O=x;break;case"multiple":A=x;default:x!==X&&Lt(a,o,g,x,h,X)}o=O,c=A,h=pe,ue!=null?Er(a,!!c,ue,!1):!!h!=!!c&&(o!=null?Er(a,!!c,o,!0):Er(a,!!c,c?[]:"",!1));return;case"textarea":pe=ue=null;for(O in c)if(g=c[O],c.hasOwnProperty(O)&&g!=null&&!h.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Lt(a,o,O,null,h,g)}for(A in h)if(g=h[A],x=c[A],h.hasOwnProperty(A)&&(g!=null||x!=null))switch(A){case"value":ue=g;break;case"defaultValue":pe=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==x&&Lt(a,o,A,g,h,x)}no(a,ue,pe);return;case"option":for(var qe in c)if(ue=c[qe],c.hasOwnProperty(qe)&&ue!=null&&!h.hasOwnProperty(qe))switch(qe){case"selected":a.selected=!1;break;default:Lt(a,o,qe,null,h,ue)}for(X in h)if(ue=h[X],pe=c[X],h.hasOwnProperty(X)&&ue!==pe&&(ue!=null||pe!=null))switch(X){case"selected":a.selected=ue&&typeof ue!="function"&&typeof ue!="symbol";break;default:Lt(a,o,X,ue,h,pe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $e in c)ue=c[$e],c.hasOwnProperty($e)&&ue!=null&&!h.hasOwnProperty($e)&&Lt(a,o,$e,null,h,ue);for(le in h)if(ue=h[le],pe=c[le],h.hasOwnProperty(le)&&ue!==pe&&(ue!=null||pe!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,o));break;default:Lt(a,o,le,ue,h,pe)}return;default:if(dl(o)){for(var It in c)ue=c[It],c.hasOwnProperty(It)&&ue!==void 0&&!h.hasOwnProperty(It)&&im(a,o,It,void 0,h,ue);for(ye in h)ue=h[ye],pe=c[ye],!h.hasOwnProperty(ye)||ue===pe||ue===void 0&&pe===void 0||im(a,o,ye,ue,h,pe);return}}for(var re in c)ue=c[re],c.hasOwnProperty(re)&&ue!=null&&!h.hasOwnProperty(re)&&Lt(a,o,re,null,h,ue);for(Se in h)ue=h[Se],pe=c[Se],!h.hasOwnProperty(Se)||ue===pe||ue==null&&pe==null||Lt(a,o,Se,ue,h,pe)}var rm=null,am=null;function Ku(a){return a.nodeType===9?a:a.ownerDocument}function iv(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rv(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function sm(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var om=null;function uT(){var a=window.event;return a&&a.type==="popstate"?a===om?!1:(om=a,!0):(om=null,!1)}var av=typeof setTimeout=="function"?setTimeout:void 0,dT=typeof clearTimeout=="function"?clearTimeout:void 0,sv=typeof Promise=="function"?Promise:void 0,fT=typeof queueMicrotask=="function"?queueMicrotask:typeof sv<"u"?function(a){return sv.resolve(null).then(a).catch(hT)}:av;function hT(a){setTimeout(function(){throw a})}function Ha(a){return a==="head"}function ov(a,o){var c=o,h=0,g=0;do{var x=c.nextSibling;if(a.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(0<h&&8>h){c=h;var A=a.ownerDocument;if(c&1&&Kl(A.documentElement),c&2&&Kl(A.body),c&4)for(c=A.head,Kl(c),A=c.firstChild;A;){var O=A.nextSibling,X=A.nodeName;A[M]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&A.rel.toLowerCase()==="stylesheet"||c.removeChild(A),A=O}}if(g===0){a.removeChild(x),rc(o);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:h=c.charCodeAt(0)-48;else h=0;c=x}while(c);rc(o)}function lm(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":lm(c),L(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function mT(a,o,c,h){for(;a.nodeType===1;){var g=c;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(h){if(!a[M])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(x=a.getAttribute("rel"),x==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(x!==g.rel||a.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||a.getAttribute("title")!==(g.title==null?null:g.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(x=a.getAttribute("src"),(x!==(g.src==null?null:g.src)||a.getAttribute("type")!==(g.type==null?null:g.type)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&a.getAttribute("name")===x)return a}else return a;if(a=fr(a.nextSibling),a===null)break}return null}function pT(a,o,c){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=fr(a.nextSibling),a===null))return null;return a}function cm(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function gT(a,o){var c=a.ownerDocument;if(a.data!=="$?"||c.readyState==="complete")o();else{var h=function(){o(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),a._reactRetry=h}}function fr(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return a}var um=null;function lv(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return a;o--}else c==="/$"&&o++}a=a.previousSibling}return null}function cv(a,o,c){switch(o=Ku(c),a){case"html":if(a=o.documentElement,!a)throw Error(i(452));return a;case"head":if(a=o.head,!a)throw Error(i(453));return a;case"body":if(a=o.body,!a)throw Error(i(454));return a;default:throw Error(i(451))}}function Kl(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);L(a)}var tr=new Map,uv=new Set;function Zu(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var sa=Z.d;Z.d={f:vT,r:yT,D:xT,C:bT,L:ST,m:_T,X:wT,S:TT,M:ET};function vT(){var a=sa.f(),o=Hu();return a||o}function yT(a){var o=B(a);o!==null&&o.tag===5&&o.type==="form"?D0(o):sa.r(a)}var Mo=typeof document>"u"?null:document;function dv(a,o,c){var h=Mo;if(h&&typeof o=="string"&&o){var g=Ln(o);g='link[rel="'+a+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),uv.has(g)||(uv.add(g),a={rel:a,crossOrigin:c,href:o},h.querySelector(g)===null&&(o=h.createElement("link"),Bn(o,"link",a),ie(o),h.head.appendChild(o)))}}function xT(a){sa.D(a),dv("dns-prefetch",a,null)}function bT(a,o){sa.C(a,o),dv("preconnect",a,o)}function ST(a,o,c){sa.L(a,o,c);var h=Mo;if(h&&a&&o){var g='link[rel="preload"][as="'+Ln(o)+'"]';o==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Ln(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Ln(c.imageSizes)+'"]')):g+='[href="'+Ln(a)+'"]';var x=g;switch(o){case"style":x=Lo(a);break;case"script":x=Io(a)}tr.has(x)||(a=p({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:a,as:o},c),tr.set(x,a),h.querySelector(g)!==null||o==="style"&&h.querySelector(Zl(x))||o==="script"&&h.querySelector(Jl(x))||(o=h.createElement("link"),Bn(o,"link",a),ie(o),h.head.appendChild(o)))}}function _T(a,o){sa.m(a,o);var c=Mo;if(c&&a){var h=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+Ln(h)+'"][href="'+Ln(a)+'"]',x=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Io(a)}if(!tr.has(x)&&(a=p({rel:"modulepreload",href:a},o),tr.set(x,a),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Jl(x)))return}h=c.createElement("link"),Bn(h,"link",a),ie(h),c.head.appendChild(h)}}}function TT(a,o,c){sa.S(a,o,c);var h=Mo;if(h&&a){var g=de(h).hoistableStyles,x=Lo(a);o=o||"default";var A=g.get(x);if(!A){var O={loading:0,preload:null};if(A=h.querySelector(Zl(x)))O.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":o},c),(c=tr.get(x))&&dm(a,c);var X=A=h.createElement("link");ie(X),Bn(X,"link",a),X._p=new Promise(function(le,ye){X.onload=le,X.onerror=ye}),X.addEventListener("load",function(){O.loading|=1}),X.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Ju(A,o,h)}A={type:"stylesheet",instance:A,count:1,state:O},g.set(x,A)}}}function wT(a,o){sa.X(a,o);var c=Mo;if(c&&a){var h=de(c).hoistableScripts,g=Io(a),x=h.get(g);x||(x=c.querySelector(Jl(g)),x||(a=p({src:a,async:!0},o),(o=tr.get(g))&&fm(a,o),x=c.createElement("script"),ie(x),Bn(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function ET(a,o){sa.M(a,o);var c=Mo;if(c&&a){var h=de(c).hoistableScripts,g=Io(a),x=h.get(g);x||(x=c.querySelector(Jl(g)),x||(a=p({src:a,async:!0,type:"module"},o),(o=tr.get(g))&&fm(a,o),x=c.createElement("script"),ie(x),Bn(x,"link",a),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(g,x))}}function fv(a,o,c,h){var g=(g=se.current)?Zu(g):null;if(!g)throw Error(i(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Lo(c.href),c=de(g).hoistableStyles,h=c.get(o),h||(h={type:"style",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=Lo(c.href);var x=de(g).hoistableStyles,A=x.get(a);if(A||(g=g.ownerDocument||g,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(a,A),(x=g.querySelector(Zl(a)))&&!x._p&&(A.instance=x,A.state.loading=5),tr.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},tr.set(a,c),x||AT(g,a,c,A.state))),o&&h===null)throw Error(i(528,""));return A}if(o&&h!==null)throw Error(i(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Io(c),c=de(g).hoistableScripts,h=c.get(o),h||(h={type:"script",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,a))}}function Lo(a){return'href="'+Ln(a)+'"'}function Zl(a){return'link[rel="stylesheet"]['+a+"]"}function hv(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function AT(a,o,c,h){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=a.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),Bn(o,"link",c),ie(o),a.head.appendChild(o))}function Io(a){return'[src="'+Ln(a)+'"]'}function Jl(a){return"script[async]"+a}function mv(a,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var h=a.querySelector('style[data-href~="'+Ln(c.href)+'"]');if(h)return o.instance=h,ie(h),h;var g=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(a.ownerDocument||a).createElement("style"),ie(h),Bn(h,"style",g),Ju(h,c.precedence,a),o.instance=h;case"stylesheet":g=Lo(c.href);var x=a.querySelector(Zl(g));if(x)return o.state.loading|=4,o.instance=x,ie(x),x;h=hv(c),(g=tr.get(g))&&dm(h,g),x=(a.ownerDocument||a).createElement("link"),ie(x);var A=x;return A._p=new Promise(function(O,X){A.onload=O,A.onerror=X}),Bn(x,"link",h),o.state.loading|=4,Ju(x,c.precedence,a),o.instance=x;case"script":return x=Io(c.src),(g=a.querySelector(Jl(x)))?(o.instance=g,ie(g),g):(h=c,(g=tr.get(x))&&(h=p({},c),fm(h,g)),a=a.ownerDocument||a,g=a.createElement("script"),ie(g),Bn(g,"link",h),a.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,Ju(h,c.precedence,a));return o.instance}function Ju(a,o,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,x=g,A=0;A<h.length;A++){var O=h[A];if(O.dataset.precedence===o)x=O;else if(x!==g)break}x?x.parentNode.insertBefore(a,x.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(a,o.firstChild))}function dm(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function fm(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var Qu=null;function pv(a,o,c){if(Qu===null){var h=new Map,g=Qu=new Map;g.set(c,h)}else g=Qu,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(a))return h;for(h.set(a,null),c=c.getElementsByTagName(a),g=0;g<c.length;g++){var x=c[g];if(!(x[M]||x[en]||a==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var A=x.getAttribute(o)||"";A=a+A;var O=h.get(A);O?O.push(x):h.set(A,[x])}}return h}function gv(a,o,c){a=a.ownerDocument||a,a.head.insertBefore(c,o==="title"?a.querySelector("head > title"):null)}function kT(a,o,c){if(c===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function vv(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var Ql=null;function CT(){}function jT(a,o,c){if(Ql===null)throw Error(i(475));var h=Ql;if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Lo(c.href),x=a.querySelector(Zl(g));if(x){a=x._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(h.count++,h=ed.bind(h),a.then(h,h)),o.state.loading|=4,o.instance=x,ie(x);return}x=a.ownerDocument||a,c=hv(c),(g=tr.get(g))&&dm(c,g),x=x.createElement("link"),ie(x);var A=x;A._p=new Promise(function(O,X){A.onload=O,A.onerror=X}),Bn(x,"link",c),o.instance=x}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(h.count++,o=ed.bind(h),a.addEventListener("load",o),a.addEventListener("error",o))}}function DT(){if(Ql===null)throw Error(i(475));var a=Ql;return a.stylesheets&&a.count===0&&hm(a,a.stylesheets),0<a.count?function(o){var c=setTimeout(function(){if(a.stylesheets&&hm(a,a.stylesheets),a.unsuspend){var h=a.unsuspend;a.unsuspend=null,h()}},6e4);return a.unsuspend=o,function(){a.unsuspend=null,clearTimeout(c)}}:null}function ed(){if(this.count--,this.count===0){if(this.stylesheets)hm(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var td=null;function hm(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,td=new Map,o.forEach(NT,a),td=null,ed.call(a))}function NT(a,o){if(!(o.state.loading&4)){var c=td.get(a);if(c)var h=c.get(null);else{c=new Map,td.set(a,c);for(var g=a.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var A=g[x];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(c.set(A.dataset.precedence,A),h=A)}h&&c.set(null,h)}g=o.instance,A=g.getAttribute("data-precedence"),x=c.get(A)||h,x===h&&c.set(null,g),c.set(A,g),this.count++,h=ed.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),x?x.parentNode.insertBefore(g,x.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(g,a.firstChild)),o.state.loading|=4}}var ec={$$typeof:C,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function OT(a,o,c,h,g,x,A,O){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_r(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_r(0),this.hiddenUpdates=_r(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function yv(a,o,c,h,g,x,A,O,X,le,ye,Se){return a=new OT(a,o,c,A,O,X,le,Se),o=1,x===!0&&(o|=24),x=Mi(3,null,null,o),a.current=x,x.stateNode=a,o=Xf(),o.refCount++,a.pooledCache=o,o.refCount++,x.memoizedState={element:h,isDehydrated:c,cache:o},Jf(x),a}function xv(a){return a?(a=ho,a):ho}function bv(a,o,c,h,g,x){g=xv(g),h.context===null?h.context=g:h.pendingContext=g,h=ja(o),h.payload={element:c},x=x===void 0?null:x,x!==null&&(h.callback=x),c=Da(a,h,o),c!==null&&(Fi(c,a,o),Dl(c,a,o))}function Sv(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<o?c:o}}function mm(a,o){Sv(a,o),(a=a.alternate)&&Sv(a,o)}function _v(a){if(a.tag===13){var o=fo(a,67108864);o!==null&&Fi(o,a,67108864),mm(a,67108864)}}var nd=!0;function RT(a,o,c,h){var g=ne.T;ne.T=null;var x=Z.p;try{Z.p=2,pm(a,o,c,h)}finally{Z.p=x,ne.T=g}}function MT(a,o,c,h){var g=ne.T;ne.T=null;var x=Z.p;try{Z.p=8,pm(a,o,c,h)}finally{Z.p=x,ne.T=g}}function pm(a,o,c,h){if(nd){var g=gm(h);if(g===null)nm(a,o,h,id,c),wv(a,h);else if(IT(g,a,o,c,h))h.stopPropagation();else if(wv(a,h),o&4&&-1<LT.indexOf(a)){for(;g!==null;){var x=B(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var A=Vt(x.pendingLanes);if(A!==0){var O=x;for(O.pendingLanes|=2,O.entangledLanes|=2;A;){var X=1<<31-te(A);O.entanglements[1]|=X,A&=~X}Nr(x),(At&6)===0&&(zu=Pe()+500,$l(0))}}break;case 13:O=fo(x,2),O!==null&&Fi(O,x,2),Hu(),mm(x,2)}if(x=gm(h),x===null&&nm(a,o,h,id,c),x===g)break;g=x}g!==null&&h.stopPropagation()}else nm(a,o,h,null,c)}}function gm(a){return a=ro(a),vm(a)}var id=null;function vm(a){if(id=null,a=F(a),a!==null){var o=s(a);if(o===null)a=null;else{var c=o.tag;if(c===13){if(a=l(o),a!==null)return a;a=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return id=a,null}function Tv(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(An()){case Mn:return 2;case ni:return 8;case ii:case Qe:return 32;case ze:return 268435456;default:return 32}default:return 32}}var ym=!1,Wa=null,Va=null,Ga=null,tc=new Map,nc=new Map,Ya=[],LT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wv(a,o){switch(a){case"focusin":case"focusout":Wa=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":Ga=null;break;case"pointerover":case"pointerout":tc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":nc.delete(o.pointerId)}}function ic(a,o,c,h,g,x){return a===null||a.nativeEvent!==x?(a={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:x,targetContainers:[g]},o!==null&&(o=B(o),o!==null&&_v(o)),a):(a.eventSystemFlags|=h,o=a.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),a)}function IT(a,o,c,h,g){switch(o){case"focusin":return Wa=ic(Wa,a,o,c,h,g),!0;case"dragenter":return Va=ic(Va,a,o,c,h,g),!0;case"mouseover":return Ga=ic(Ga,a,o,c,h,g),!0;case"pointerover":var x=g.pointerId;return tc.set(x,ic(tc.get(x)||null,a,o,c,h,g)),!0;case"gotpointercapture":return x=g.pointerId,nc.set(x,ic(nc.get(x)||null,a,o,c,h,g)),!0}return!1}function Ev(a){var o=F(a.target);if(o!==null){var c=s(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){a.blockedOn=o,xn(a.priority,function(){if(c.tag===13){var h=Bi();h=cs(h);var g=fo(c,h);g!==null&&Fi(g,c,h),mm(c,h)}});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function rd(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var c=gm(a.nativeEvent);if(c===null){c=a.nativeEvent;var h=new c.constructor(c.type,c);fl=h,c.target.dispatchEvent(h),fl=null}else return o=B(c),o!==null&&_v(o),a.blockedOn=c,!1;o.shift()}return!0}function Av(a,o,c){rd(a)&&c.delete(o)}function PT(){ym=!1,Wa!==null&&rd(Wa)&&(Wa=null),Va!==null&&rd(Va)&&(Va=null),Ga!==null&&rd(Ga)&&(Ga=null),tc.forEach(Av),nc.forEach(Av)}function ad(a,o){a.blockedOn===o&&(a.blockedOn=null,ym||(ym=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,PT)))}var sd=null;function kv(a){sd!==a&&(sd=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){sd===a&&(sd=null);for(var o=0;o<a.length;o+=3){var c=a[o],h=a[o+1],g=a[o+2];if(typeof h!="function"){if(vm(h||c)===null)continue;break}var x=B(c);x!==null&&(a.splice(o,3),o-=3,vh(x,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function rc(a){function o(X){return ad(X,a)}Wa!==null&&ad(Wa,a),Va!==null&&ad(Va,a),Ga!==null&&ad(Ga,a),tc.forEach(o),nc.forEach(o);for(var c=0;c<Ya.length;c++){var h=Ya[c];h.blockedOn===a&&(h.blockedOn=null)}for(;0<Ya.length&&(c=Ya[0],c.blockedOn===null);)Ev(c),c.blockedOn===null&&Ya.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],x=c[h+1],A=g[tn]||null;if(typeof x=="function")A||kv(c);else if(A){var O=null;if(x&&x.hasAttribute("formAction")){if(g=x,A=x[tn]||null)O=A.formAction;else if(vm(g)!==null)continue}else O=A.action;typeof O=="function"?c[h+1]=O:(c.splice(h,3),h-=3),kv(c)}}}function xm(a){this._internalRoot=a}od.prototype.render=xm.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(i(409));var c=o.current,h=Bi();bv(c,h,a,o,null,null)},od.prototype.unmount=xm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;bv(a.current,2,null,a,null,null),Hu(),o[Tr]=null}};function od(a){this._internalRoot=a}od.prototype.unstable_scheduleHydration=function(a){if(a){var o=to();a={blockedOn:null,target:a,priority:o};for(var c=0;c<Ya.length&&o!==0&&o<Ya[c].priority;c++);Ya.splice(c,0,a),c===0&&Ev(a)}};var Cv=e.version;if(Cv!=="19.1.0")throw Error(i(527,Cv,"19.1.0"));Z.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(i(188)):(a=Object.keys(a).join(","),Error(i(268,a)));return a=f(o),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var BT={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ld=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ld.isDisabled&&ld.supportsFiber)try{Rt=ld.inject(BT),Et=ld}catch{}}return sc.createRoot=function(a,o){if(!r(a))throw Error(i(299));var c=!1,h="",g=V0,x=G0,A=Y0,O=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(O=o.unstable_transitionCallbacks)),o=yv(a,1,!1,null,null,c,h,g,x,A,O,null),a[Tr]=o.current,tm(a),new xm(o)},sc.hydrateRoot=function(a,o,c){if(!r(a))throw Error(i(299));var h=!1,g="",x=V0,A=G0,O=Y0,X=null,le=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(O=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(X=c.unstable_transitionCallbacks),c.formState!==void 0&&(le=c.formState)),o=yv(a,1,!0,o,c??null,h,g,x,A,O,X,le),o.context=xv(null),c=o.current,h=Bi(),h=cs(h),g=ja(h),g.callback=null,Da(c,g,h),c=h,o.current.lanes=c,Kt(o,c),Nr(o),a[Tr]=o.current,tm(a),new od(o)},sc.version="19.1.0",sc}var Bv;function XT(){if(Bv)return _m.exports;Bv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_m.exports=$T(),_m.exports}var qT=XT();const KT=pp(qT);/**
 * react-router v7.7.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Fv="popstate";function ZT(n={}){function e(i,r){let{pathname:s,search:l,hash:u}=i.location;return Jm("",{pathname:s,search:l,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Nc(r)}return QT(e,t,null,n)}function qt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function br(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JT(){return Math.random().toString(36).substring(2,10)}function zv(n,e){return{usr:n.state,key:n.key,idx:e}}function Jm(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?tl(e):e,state:t,key:e&&e.key||i||JT()}}function Nc({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function tl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function QT(n,e,t,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,l=r.history,u="POP",f=null,m=p();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function p(){return(l.state||{idx:null}).idx}function v(){u="POP";let T=p(),E=T==null?null:T-m;m=T,f&&f({action:u,location:b.location,delta:E})}function y(T,E){u="PUSH";let w=Jm(b.location,T,E);m=p()+1;let C=zv(w,m),j=b.createHref(w);try{l.pushState(C,"",j)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(j)}s&&f&&f({action:u,location:b.location,delta:1})}function S(T,E){u="REPLACE";let w=Jm(b.location,T,E);m=p();let C=zv(w,m),j=b.createHref(w);l.replaceState(C,"",j),s&&f&&f({action:u,location:b.location,delta:0})}function _(T){return ew(T)}let b={get action(){return u},get location(){return n(r,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(Fv,v),f=T,()=>{r.removeEventListener(Fv,v),f=null}},createHref(T){return e(r,T)},createURL:_,encodeLocation(T){let E=_(T);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:y,replace:S,go(T){return l.go(T)}};return b}function ew(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),qt(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:Nc(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function eb(n,e,t="/"){return tw(n,e,t,!1)}function tw(n,e,t,i){let r=typeof e=="string"?tl(e):e,s=ga(r.pathname||"/",t);if(s==null)return null;let l=tb(n);nw(l);let u=null;for(let f=0;u==null&&f<l.length;++f){let m=hw(s);u=dw(l[f],m,i)}return u}function tb(n,e=[],t=[],i=""){let r=(s,l,u)=>{let f={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};f.relativePath.startsWith("/")&&(qt(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length));let m=fa([i,f.relativePath]),p=t.concat(f);s.children&&s.children.length>0&&(qt(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),tb(s.children,e,p,m)),!(s.path==null&&!s.index)&&e.push({path:m,score:cw(m,s.index),routesMeta:p})};return n.forEach((s,l)=>{if(s.path===""||!s.path?.includes("?"))r(s,l);else for(let u of nb(s.path))r(s,l,u)}),e}function nb(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let l=nb(i.join("/")),u=[];return u.push(...l.map(f=>f===""?s:[s,f].join("/"))),r&&u.push(...l),u.map(f=>n.startsWith("/")&&f===""?"/":f)}function nw(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:uw(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var iw=/^:[\w-]+$/,rw=3,aw=2,sw=1,ow=10,lw=-2,Uv=n=>n==="*";function cw(n,e){let t=n.split("/"),i=t.length;return t.some(Uv)&&(i+=lw),e&&(i+=aw),t.filter(r=>!Uv(r)).reduce((r,s)=>r+(iw.test(s)?rw:s===""?sw:ow),i)}function uw(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function dw(n,e,t=!1){let{routesMeta:i}=n,r={},s="/",l=[];for(let u=0;u<i.length;++u){let f=i[u],m=u===i.length-1,p=s==="/"?e:e.slice(s.length)||"/",v=Ud({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},p),y=f.route;if(!v&&m&&t&&!i[i.length-1].route.index&&(v=Ud({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!v)return null;Object.assign(r,v.params),l.push({params:r,pathname:fa([s,v.pathname]),pathnameBase:vw(fa([s,v.pathnameBase])),route:y}),v.pathnameBase!=="/"&&(s=fa([s,v.pathnameBase]))}return l}function Ud(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=fw(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],l=s.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:i.reduce((m,{paramName:p,isOptional:v},y)=>{if(p==="*"){let _=u[y]||"";l=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const S=u[y];return v&&!S?m[p]=void 0:m[p]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:s,pathnameBase:l,pattern:n}}function fw(n,e=!1,t=!0){br(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,f)=>(i.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function hw(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return br(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ga(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function mw(n,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?tl(n):n;return{pathname:t?t.startsWith("/")?t:pw(t,e):e,search:yw(i),hash:xw(r)}}function pw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function Am(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gw(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function vp(n){let e=gw(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function yp(n,e,t,i=!1){let r;typeof n=="string"?r=tl(n):(r={...n},qt(!r.pathname||!r.pathname.includes("?"),Am("?","pathname","search",r)),qt(!r.pathname||!r.pathname.includes("#"),Am("#","pathname","hash",r)),qt(!r.search||!r.search.includes("#"),Am("#","search","hash",r)));let s=n===""||r.pathname==="",l=s?"/":r.pathname,u;if(l==null)u=t;else{let v=e.length-1;if(!i&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),v-=1;r.pathname=y.join("/")}u=v>=0?e[v]:"/"}let f=mw(r,u),m=l&&l!=="/"&&l.endsWith("/"),p=(s||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(m||p)&&(f.pathname+="/"),f}var fa=n=>n.join("/").replace(/\/\/+/g,"/"),vw=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),yw=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,xw=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function bw(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var ib=["POST","PUT","PATCH","DELETE"];new Set(ib);var Sw=["GET",...ib];new Set(Sw);var nl=H.createContext(null);nl.displayName="DataRouter";var df=H.createContext(null);df.displayName="DataRouterState";H.createContext(!1);var rb=H.createContext({isTransitioning:!1});rb.displayName="ViewTransition";var _w=H.createContext(new Map);_w.displayName="Fetchers";var Tw=H.createContext(null);Tw.displayName="Await";var Sr=H.createContext(null);Sr.displayName="Navigation";var Yc=H.createContext(null);Yc.displayName="Location";var Hr=H.createContext({outlet:null,matches:[],isDataRoute:!1});Hr.displayName="Route";var xp=H.createContext(null);xp.displayName="RouteError";function ww(n,{relative:e}={}){qt(il(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=H.useContext(Sr),{hash:r,pathname:s,search:l}=$c(n,{relative:e}),u=s;return t!=="/"&&(u=s==="/"?t:fa([t,s])),i.createHref({pathname:u,search:l,hash:r})}function il(){return H.useContext(Yc)!=null}function Wr(){return qt(il(),"useLocation() may be used only in the context of a <Router> component."),H.useContext(Yc).location}var ab="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sb(n){H.useContext(Sr).static||H.useLayoutEffect(n)}function ff(){let{isDataRoute:n}=H.useContext(Hr);return n?Pw():Ew()}function Ew(){qt(il(),"useNavigate() may be used only in the context of a <Router> component.");let n=H.useContext(nl),{basename:e,navigator:t}=H.useContext(Sr),{matches:i}=H.useContext(Hr),{pathname:r}=Wr(),s=JSON.stringify(vp(i)),l=H.useRef(!1);return sb(()=>{l.current=!0}),H.useCallback((f,m={})=>{if(br(l.current,ab),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=yp(f,JSON.parse(s),r,m.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:fa([e,p.pathname])),(m.replace?t.replace:t.push)(p,m.state,m)},[e,t,s,r,n])}H.createContext(null);function $c(n,{relative:e}={}){let{matches:t}=H.useContext(Hr),{pathname:i}=Wr(),r=JSON.stringify(vp(t));return H.useMemo(()=>yp(n,JSON.parse(r),i,e==="path"),[n,r,i,e])}function Aw(n,e){return ob(n,e)}function ob(n,e,t,i){qt(il(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=H.useContext(Sr),{matches:s}=H.useContext(Hr),l=s[s.length-1],u=l?l.params:{},f=l?l.pathname:"/",m=l?l.pathnameBase:"/",p=l&&l.route;{let E=p&&p.path||"";lb(f,!p||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let v=Wr(),y;if(e){let E=typeof e=="string"?tl(e):e;qt(m==="/"||E.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${E.pathname}" was given in the \`location\` prop.`),y=E}else y=v;let S=y.pathname||"/",_=S;if(m!=="/"){let E=m.replace(/^\//,"").split("/");_="/"+S.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=eb(n,{pathname:_});br(p||b!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),br(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=Nw(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},u,E.params),pathname:fa([m,r.encodeLocation?r.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?m:fa([m,r.encodeLocation?r.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),s,t,i);return e&&T?H.createElement(Yc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function kw(){let n=Iw(),e=bw(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=H.createElement(H.Fragment,null,H.createElement("p",null," Hey developer "),H.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",H.createElement("code",{style:s},"ErrorBoundary")," or"," ",H.createElement("code",{style:s},"errorElement")," prop on your route.")),H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},e),t?H.createElement("pre",{style:r},t):null,l)}var Cw=H.createElement(kw,null),jw=class extends H.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?H.createElement(Hr.Provider,{value:this.props.routeContext},H.createElement(xp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Dw({routeContext:n,match:e,children:t}){let i=H.useContext(nl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),H.createElement(Hr.Provider,{value:n},t)}function Nw(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let r=n,s=t?.errors;if(s!=null){let f=r.findIndex(m=>m.route.id&&s?.[m.route.id]!==void 0);qt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),r=r.slice(0,Math.min(r.length,f+1))}let l=!1,u=-1;if(t)for(let f=0;f<r.length;f++){let m=r[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:p,errors:v}=t,y=m.route.loader&&!p.hasOwnProperty(m.route.id)&&(!v||v[m.route.id]===void 0);if(m.route.lazy||y){l=!0,u>=0?r=r.slice(0,u+1):r=[r[0]];break}}}return r.reduceRight((f,m,p)=>{let v,y=!1,S=null,_=null;t&&(v=s&&m.route.id?s[m.route.id]:void 0,S=m.route.errorElement||Cw,l&&(u<0&&p===0?(lb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,_=null):u===p&&(y=!0,_=m.route.hydrateFallbackElement||null)));let b=e.concat(r.slice(0,p+1)),T=()=>{let E;return v?E=S:y?E=_:m.route.Component?E=H.createElement(m.route.Component,null):m.route.element?E=m.route.element:E=f,H.createElement(Dw,{match:m,routeContext:{outlet:f,matches:b,isDataRoute:t!=null},children:E})};return t&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?H.createElement(jw,{location:t.location,revalidation:t.revalidation,component:S,error:v,children:T(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):T()},null)}function bp(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ow(n){let e=H.useContext(nl);return qt(e,bp(n)),e}function Rw(n){let e=H.useContext(df);return qt(e,bp(n)),e}function Mw(n){let e=H.useContext(Hr);return qt(e,bp(n)),e}function Sp(n){let e=Mw(n),t=e.matches[e.matches.length-1];return qt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Lw(){return Sp("useRouteId")}function Iw(){let n=H.useContext(xp),e=Rw("useRouteError"),t=Sp("useRouteError");return n!==void 0?n:e.errors?.[t]}function Pw(){let{router:n}=Ow("useNavigate"),e=Sp("useNavigate"),t=H.useRef(!1);return sb(()=>{t.current=!0}),H.useCallback(async(r,s={})=>{br(t.current,ab),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...s}))},[n,e])}var Hv={};function lb(n,e,t){!e&&!Hv[n]&&(Hv[n]=!0,br(!1,t))}H.memo(Bw);function Bw({routes:n,future:e,state:t}){return ob(n,void 0,t,e)}function cb({to:n,replace:e,state:t,relative:i}){qt(il(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=H.useContext(Sr);br(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=H.useContext(Hr),{pathname:l}=Wr(),u=ff(),f=yp(n,vp(s),l,i==="path"),m=JSON.stringify(f);return H.useEffect(()=>{u(JSON.parse(m),{replace:e,state:t,relative:i})},[u,m,i,e,t]),null}function Tn(n){qt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Fw({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:s=!1}){qt(!il(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=H.useMemo(()=>({basename:l,navigator:r,static:s,future:{}}),[l,r,s]);typeof t=="string"&&(t=tl(t));let{pathname:f="/",search:m="",hash:p="",state:v=null,key:y="default"}=t,S=H.useMemo(()=>{let _=ga(f,l);return _==null?null:{location:{pathname:_,search:m,hash:p,state:v,key:y},navigationType:i}},[l,f,m,p,v,y,i]);return br(S!=null,`<Router basename="${l}"> is not able to match the URL "${f}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:H.createElement(Sr.Provider,{value:u},H.createElement(Yc.Provider,{children:e,value:S}))}function zw({children:n,location:e}){return Aw(Qm(n),e)}function Qm(n,e=[]){let t=[];return H.Children.forEach(n,(i,r)=>{if(!H.isValidElement(i))return;let s=[...e,r];if(i.type===H.Fragment){t.push.apply(t,Qm(i.props.children,s));return}qt(i.type===Tn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),qt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=Qm(i.props.children,s)),t.push(l)}),t}var Pd="get",Bd="application/x-www-form-urlencoded";function hf(n){return n!=null&&typeof n.tagName=="string"}function Uw(n){return hf(n)&&n.tagName.toLowerCase()==="button"}function Hw(n){return hf(n)&&n.tagName.toLowerCase()==="form"}function Ww(n){return hf(n)&&n.tagName.toLowerCase()==="input"}function Vw(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Gw(n,e){return n.button===0&&(!e||e==="_self")&&!Vw(n)}var cd=null;function Yw(){if(cd===null)try{new FormData(document.createElement("form"),0),cd=!1}catch{cd=!0}return cd}var $w=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function km(n){return n!=null&&!$w.has(n)?(br(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bd}"`),null):n}function Xw(n,e){let t,i,r,s,l;if(Hw(n)){let u=n.getAttribute("action");i=u?ga(u,e):null,t=n.getAttribute("method")||Pd,r=km(n.getAttribute("enctype"))||Bd,s=new FormData(n)}else if(Uw(n)||Ww(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||u.getAttribute("action");if(i=f?ga(f,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||Pd,r=km(n.getAttribute("formenctype"))||km(u.getAttribute("enctype"))||Bd,s=new FormData(u,n),!Yw()){let{name:m,type:p,value:v}=n;if(p==="image"){let y=m?`${m}.`:"";s.append(`${y}x`,"0"),s.append(`${y}y`,"0")}else m&&s.append(m,v)}}else{if(hf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Pd,i=null,r=Bd,l=n}return s&&r==="text/plain"&&(l=s,s=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:s,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function _p(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qw(n,e,t){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return i.pathname==="/"?i.pathname=`_root.${t}`:e&&ga(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${t}`,i}async function Kw(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Zw(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Jw(n,e,t){let i=await Promise.all(n.map(async r=>{let s=e.routes[r.route.id];if(s){let l=await Kw(s,t);return l.links?l.links():[]}return[]}));return nE(i.flat(1).filter(Zw).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function Wv(n,e,t,i,r,s){let l=(f,m)=>t[m]?f.route.id!==t[m].route.id:!0,u=(f,m)=>t[m].pathname!==f.pathname||t[m].route.path?.endsWith("*")&&t[m].params["*"]!==f.params["*"];return s==="assets"?e.filter((f,m)=>l(f,m)||u(f,m)):s==="data"?e.filter((f,m)=>{let p=i.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,m)||u(f,m))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Qw(n,e,{includeHydrateFallback:t}={}){return eE(n.map(i=>{let r=e.routes[i.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function eE(n){return[...new Set(n)]}function tE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function nE(n,e){let t=new Set;return new Set(e),n.reduce((i,r)=>{let s=JSON.stringify(tE(r));return t.has(s)||(t.add(s),i.push({key:s,link:r})),i},[])}function ub(){let n=H.useContext(nl);return _p(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function iE(){let n=H.useContext(df);return _p(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Tp=H.createContext(void 0);Tp.displayName="FrameworkContext";function db(){let n=H.useContext(Tp);return _p(n,"You must render this element inside a <HydratedRouter> element"),n}function rE(n,e){let t=H.useContext(Tp),[i,r]=H.useState(!1),[s,l]=H.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:m,onMouseLeave:p,onTouchStart:v}=e,y=H.useRef(null);H.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let b=E=>{E.forEach(w=>{l(w.isIntersecting)})},T=new IntersectionObserver(b,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[n]),H.useEffect(()=>{if(i){let b=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(b)}}},[i]);let S=()=>{r(!0)},_=()=>{r(!1),l(!1)};return t?n!=="intent"?[s,y,{}]:[s,y,{onFocus:oc(u,S),onBlur:oc(f,_),onMouseEnter:oc(m,S),onMouseLeave:oc(p,_),onTouchStart:oc(v,S)}]:[!1,y,{}]}function oc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function aE({page:n,...e}){let{router:t}=ub(),i=H.useMemo(()=>eb(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?H.createElement(oE,{page:n,matches:i,...e}):null}function sE(n){let{manifest:e,routeModules:t}=db(),[i,r]=H.useState([]);return H.useEffect(()=>{let s=!1;return Jw(n,e,t).then(l=>{s||r(l)}),()=>{s=!0}},[n,e,t]),i}function oE({page:n,matches:e,...t}){let i=Wr(),{manifest:r,routeModules:s}=db(),{basename:l}=ub(),{loaderData:u,matches:f}=iE(),m=H.useMemo(()=>Wv(n,e,f,r,i,"data"),[n,e,f,r,i]),p=H.useMemo(()=>Wv(n,e,f,r,i,"assets"),[n,e,f,r,i]),v=H.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let _=new Set,b=!1;if(e.forEach(E=>{let w=r.routes[E.route.id];!w||!w.hasLoader||(!m.some(C=>C.route.id===E.route.id)&&E.route.id in u&&s[E.route.id]?.shouldRevalidate||w.hasClientLoader?b=!0:_.add(E.route.id))}),_.size===0)return[];let T=qw(n,l,"data");return b&&_.size>0&&T.searchParams.set("_routes",e.filter(E=>_.has(E.route.id)).map(E=>E.route.id).join(",")),[T.pathname+T.search]},[l,u,i,r,m,e,n,s]),y=H.useMemo(()=>Qw(p,r),[p,r]),S=sE(p);return H.createElement(H.Fragment,null,v.map(_=>H.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...t})),y.map(_=>H.createElement("link",{key:_,rel:"modulepreload",href:_,...t})),S.map(({key:_,link:b})=>H.createElement("link",{key:_,...b})))}function lE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var fb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{fb&&(window.__reactRouterVersion="7.7.0")}catch{}function cE({basename:n,children:e,window:t}){let i=H.useRef();i.current==null&&(i.current=ZT({window:t,v5Compat:!0}));let r=i.current,[s,l]=H.useState({action:r.action,location:r.location}),u=H.useCallback(f=>{H.startTransition(()=>l(f))},[l]);return H.useLayoutEffect(()=>r.listen(u),[r,u]),H.createElement(Fw,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:r})}var hb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mb=H.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:s,replace:l,state:u,target:f,to:m,preventScrollReset:p,viewTransition:v,...y},S){let{basename:_}=H.useContext(Sr),b=typeof m=="string"&&hb.test(m),T,E=!1;if(typeof m=="string"&&b&&(T=m,fb))try{let R=new URL(window.location.href),W=m.startsWith("//")?new URL(R.protocol+m):new URL(m),q=ga(W.pathname,_);W.origin===R.origin&&q!=null?m=q+W.search+W.hash:E=!0}catch{br(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=ww(m,{relative:r}),[C,j,k]=rE(i,y),P=hE(m,{replace:l,state:u,target:f,preventScrollReset:p,relative:r,viewTransition:v});function D(R){e&&e(R),R.defaultPrevented||P(R)}let z=H.createElement("a",{...y,...k,href:T||w,onClick:E||s?e:D,ref:lE(S,j),target:f,"data-discover":!b&&t==="render"?"true":void 0});return C&&!b?H.createElement(H.Fragment,null,z,H.createElement(aE,{page:w})):z});mb.displayName="Link";var uE=H.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:s,to:l,viewTransition:u,children:f,...m},p){let v=$c(l,{relative:m.relative}),y=Wr(),S=H.useContext(df),{navigator:_,basename:b}=H.useContext(Sr),T=S!=null&&yE(v)&&u===!0,E=_.encodeLocation?_.encodeLocation(v).pathname:v.pathname,w=y.pathname,C=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(w=w.toLowerCase(),C=C?C.toLowerCase():null,E=E.toLowerCase()),C&&b&&(C=ga(C,b)||C);const j=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let k=w===E||!r&&w.startsWith(E)&&w.charAt(j)==="/",P=C!=null&&(C===E||!r&&C.startsWith(E)&&C.charAt(E.length)==="/"),D={isActive:k,isPending:P,isTransitioning:T},z=k?e:void 0,R;typeof i=="function"?R=i(D):R=[i,k?"active":null,P?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let W=typeof s=="function"?s(D):s;return H.createElement(mb,{...m,"aria-current":z,className:R,ref:p,style:W,to:l,viewTransition:u},typeof f=="function"?f(D):f)});uE.displayName="NavLink";var dE=H.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:s,method:l=Pd,action:u,onSubmit:f,relative:m,preventScrollReset:p,viewTransition:v,...y},S)=>{let _=gE(),b=vE(u,{relative:m}),T=l.toLowerCase()==="get"?"get":"post",E=typeof u=="string"&&hb.test(u),w=C=>{if(f&&f(C),C.defaultPrevented)return;C.preventDefault();let j=C.nativeEvent.submitter,k=j?.getAttribute("formmethod")||l;_(j||C.currentTarget,{fetcherKey:e,method:k,navigate:t,replace:r,state:s,relative:m,preventScrollReset:p,viewTransition:v})};return H.createElement("form",{ref:S,method:T,action:b,onSubmit:i?f:w,...y,"data-discover":!E&&n==="render"?"true":void 0})});dE.displayName="Form";function fE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pb(n){let e=H.useContext(nl);return qt(e,fE(n)),e}function hE(n,{target:e,replace:t,state:i,preventScrollReset:r,relative:s,viewTransition:l}={}){let u=ff(),f=Wr(),m=$c(n,{relative:s});return H.useCallback(p=>{if(Gw(p,e)){p.preventDefault();let v=t!==void 0?t:Nc(f)===Nc(m);u(n,{replace:v,state:i,preventScrollReset:r,relative:s,viewTransition:l})}},[f,u,m,t,i,e,n,r,s,l])}var mE=0,pE=()=>`__${String(++mE)}__`;function gE(){let{router:n}=pb("useSubmit"),{basename:e}=H.useContext(Sr),t=Lw();return H.useCallback(async(i,r={})=>{let{action:s,method:l,encType:u,formData:f,body:m}=Xw(i,e);if(r.navigate===!1){let p=r.fetcherKey||pE();await n.fetch(p,t,r.action||s,{preventScrollReset:r.preventScrollReset,formData:f,body:m,formMethod:r.method||l,formEncType:r.encType||u,flushSync:r.flushSync})}else await n.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:f,body:m,formMethod:r.method||l,formEncType:r.encType||u,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function vE(n,{relative:e}={}){let{basename:t}=H.useContext(Sr),i=H.useContext(Hr);qt(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...$c(n||".",{relative:e})},l=Wr();if(n==null){s.search=l.search;let u=new URLSearchParams(s.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(v=>v).forEach(v=>u.append("index",v));let p=u.toString();s.search=p?`?${p}`:""}}return(!n||n===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:fa([t,s.pathname])),Nc(s)}function yE(n,e={}){let t=H.useContext(rb);qt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=pb("useViewTransitionState"),r=$c(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=ga(t.currentLocation.pathname,i)||t.currentLocation.pathname,l=ga(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ud(r.pathname,l)!=null||Ud(r.pathname,s)!=null}const gb=H.createContext(void 0),xE=()=>{const n=H.useContext(gb);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},bE=({children:n})=>{const[e,t]=H.useState(()=>localStorage.getItem("timebeacon-theme")||"light"),[i,r]=H.useState("light");H.useEffect(()=>{const l=()=>{if(e==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";r(u)}else r(e)};if(l(),e==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)");return u.addEventListener("change",l),()=>u.removeEventListener("change",l)}},[e]),H.useEffect(()=>{localStorage.setItem("timebeacon-theme",e),document.documentElement.setAttribute("data-theme",i)},[e,i]);const s={theme:e,effectiveTheme:i,setTheme:t};return d.jsx(gb.Provider,{value:s,children:n})},Po={owner:{level:100,title:"Owner",description:"Full system access including billing and company management"},admin:{level:90,title:"Administrator",description:"User and project management, settings control"},manager:{level:70,title:"Manager",description:"Team oversight with scoped permissions for team members"},individual_contributor:{level:50,title:"Individual Contributor",description:"Senior employee with project leadership and limited team visibility"},employee:{level:30,title:"Employee",description:"Self-service time tracking and basic project access"},viewer:{level:10,title:"Viewer",description:"Read-only access to own data"}},vb={owner:[{id:"owner-company",resource:"company",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-users",resource:"users",actions:["create","read","update","delete","invite","manage"],scope:{all:!0}},{id:"owner-projects",resource:"projects",actions:["create","read","update","delete","assign","manage"],scope:{all:!0}},{id:"owner-timeEntries",resource:"timeEntries",actions:["create","read","update","delete","approve"],scope:{all:!0}},{id:"owner-reports",resource:"reports",actions:["create","read","export"],scope:{all:!0}},{id:"owner-analytics",resource:"analytics",actions:["read","export"],scope:{all:!0}},{id:"owner-billing",resource:"billing",actions:["read","update","manage"],scope:{all:!0}},{id:"owner-settings",resource:"settings",actions:["read","update","manage"],scope:{all:!0}},{id:"owner-integrations",resource:"integrations",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-teams",resource:"teams",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-clients",resource:"clients",actions:["create","read","update","delete","manage"],scope:{all:!0}}],admin:[{id:"admin-company",resource:"company",actions:["read","update"],scope:{all:!0}},{id:"admin-users",resource:"users",actions:["create","read","update","invite","manage"],scope:{all:!0}},{id:"admin-projects",resource:"projects",actions:["create","read","update","delete","assign","manage"],scope:{all:!0}},{id:"admin-timeEntries",resource:"timeEntries",actions:["read","update","approve"],scope:{all:!0}},{id:"admin-reports",resource:"reports",actions:["create","read","export"],scope:{all:!0}},{id:"admin-analytics",resource:"analytics",actions:["read","export"],scope:{all:!0}},{id:"admin-settings",resource:"settings",actions:["read","update"],scope:{all:!0}},{id:"admin-integrations",resource:"integrations",actions:["create","read","update","delete"],scope:{all:!0}},{id:"admin-teams",resource:"teams",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"admin-clients",resource:"clients",actions:["create","read","update","delete"],scope:{all:!0}}],manager:[{id:"manager-users",resource:"users",actions:["read"],scope:{team:[],department:[]}},{id:"manager-projects",resource:"projects",actions:["create","read","update","assign"],scope:{team:[],own:!0}},{id:"manager-timeEntries",resource:"timeEntries",actions:["read","approve","review"],scope:{team:[],own:!0}},{id:"manager-reports",resource:"reports",actions:["read","export"],scope:{team:[],own:!0}},{id:"manager-analytics",resource:"analytics",actions:["read"],scope:{team:[],own:!0}},{id:"manager-teams",resource:"teams",actions:["read","manage"],scope:{team:[]}},{id:"manager-clients",resource:"clients",actions:["read","update"],scope:{team:[],own:!0}},{id:"manager-own",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}}],individual_contributor:[{id:"ic-projects",resource:"projects",actions:["create","read","update"],scope:{own:!0}},{id:"ic-timeEntries",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}},{id:"ic-reports",resource:"reports",actions:["read","export"],scope:{own:!0}},{id:"ic-analytics",resource:"analytics",actions:["read"],scope:{own:!0}},{id:"ic-clients",resource:"clients",actions:["read","update"],scope:{own:!0}},{id:"ic-team-visibility",resource:"users",actions:["read"],scope:{team:[]}},{id:"ic-project-lead",resource:"projects",actions:["assign","review"],scope:{own:!0}}],employee:[{id:"employee-timeEntries",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}},{id:"employee-projects",resource:"projects",actions:["read"],scope:{own:!0}},{id:"employee-reports",resource:"reports",actions:["read"],scope:{own:!0}},{id:"employee-clients",resource:"clients",actions:["read"],scope:{own:!0}},{id:"employee-profile",resource:"users",actions:["read","update"],scope:{own:!0}}],viewer:[{id:"viewer-timeEntries",resource:"timeEntries",actions:["read"],scope:{own:!0}},{id:"viewer-projects",resource:"projects",actions:["read"],scope:{own:!0}},{id:"viewer-profile",resource:"users",actions:["read"],scope:{own:!0}}]};class SE{API_BASE="http://localhost:3003/api";TOKEN_KEY="timebeacon_access_token";REFRESH_KEY="timebeacon_refresh_token";USER_KEY="timebeacon_user";COMPANY_KEY="timebeacon_company";async login(e){if(!e.email||!e.password)throw new Error("Email and password are required");if(!this.isValidEmail(e.email))throw new Error("Invalid email format");if(e.password.length<8)throw new Error("Password must be at least 8 characters");try{this.checkRateLimit(e.email)}catch(t){if(!e.email.includes("@demo.com"))throw t;console.warn("Rate limit reached for demo account, but allowing attempt")}try{const t=await fetch(`${this.API_BASE}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Login failed")}const i=await t.json();return localStorage.setItem(this.TOKEN_KEY,i.accessToken),localStorage.setItem(this.REFRESH_KEY,i.refreshToken),localStorage.setItem(this.USER_KEY,JSON.stringify(i.user)),localStorage.setItem(this.COMPANY_KEY,JSON.stringify(i.company)),i}catch(t){throw console.error("Login error:",t),t}}async signup(e){if(!e.email||!e.password||!e.companyName)throw new Error("Email, password, and company name are required");if(!this.isValidEmail(e.email))throw new Error("Invalid email format");if(!this.isValidPassword(e.password))throw new Error("Password must be at least 8 characters with uppercase, lowercase, and numbers");return this.productionSignup(e)}async refreshToken(){const e=localStorage.getItem(this.REFRESH_KEY);if(!e)throw new Error("No refresh token available");try{const t=await fetch(`${this.API_BASE}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)throw new Error("Token refresh failed");const i=await t.json();return localStorage.setItem(this.TOKEN_KEY,i.accessToken),i.accessToken}catch(t){throw console.error("Token refresh error:",t),this.logout(),t}}async logout(){const e=localStorage.getItem(this.TOKEN_KEY);if(localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.REFRESH_KEY),localStorage.removeItem(this.USER_KEY),localStorage.removeItem(this.COMPANY_KEY),e)try{await fetch(`${this.API_BASE}/auth/logout`,{method:"POST",headers:{Authorization:`Bearer ${e}`}})}catch(t){console.warn("Failed to notify server of logout:",t)}}getAuthState(){const e=localStorage.getItem(this.TOKEN_KEY),t=localStorage.getItem(this.USER_KEY),i=localStorage.getItem(this.COMPANY_KEY);if(!e||!t||!i)return{user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]};try{const r=JSON.parse(t),s=JSON.parse(i),l=this.getUserPermissions(r.role,r.permissions);return{user:r,company:s,isAuthenticated:!0,isLoading:!1,permissions:l}}catch(r){return console.error("Error parsing auth state:",r),this.logout(),{user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]}}}hasPermission(e,t,i,r){return e.some(s=>s.resource!==t||!s.actions.includes(i)?!1:(s.scope&&(s.scope.own&&r||s.scope.all),!0))}getUserPermissions(e,t){return[...vb[e]||[],...t]}async inviteUser(e){const t=localStorage.getItem(this.TOKEN_KEY);if(!t)throw new Error("Not authenticated");try{const i=await fetch(`${this.API_BASE}/users/invite`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)});if(!i.ok){const r=await i.json();throw new Error(r.message||"Failed to invite user")}}catch(i){throw console.error("Invite user error:",i),i}}async getTeamMembers(){return this.mockTeamMembers()}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPassword(e){const i=/[A-Z]/.test(e),r=/[a-z]/.test(e),s=/\d/.test(e);return e.length>=8&&i&&r&&s}checkRateLimit(e){const t=`auth_attempts_${e}`,i=JSON.parse(localStorage.getItem(t)||"[]"),s=Date.now()-5*60*1e3,l=i.filter(m=>m>s),f=e.includes("@demo.com")?20:5;if(l.length>=f)throw new Error("Too many login attempts. Please try again in 5 minutes.")}clearRateLimit(e){const t=`auth_attempts_${e}`;localStorage.removeItem(t)}recordFailedAttempt(e){const t=`auth_attempts_${e}`,i=JSON.parse(localStorage.getItem(t)||"[]");i.push(Date.now()),localStorage.setItem(t,JSON.stringify(i))}async secureLogin(e){await new Promise(r=>setTimeout(r,300));const i=[{email:"admin@demo.com",password:"Admin123!",role:"owner"},{email:"manager@demo.com",password:"Manager123!",role:"manager"},{email:"employee@demo.com",password:"Employee123!",role:"employee"},{email:e.email,password:"Demo123!",role:"employee"}].find(r=>r.email===e.email&&r.password===e.password);if(!i)throw this.recordFailedAttempt(e.email),new Error("Invalid email or password. Try: admin@demo.com/Admin123!, manager@demo.com/Manager123!, or employee@demo.com/Employee123!");return this.clearRateLimit(e.email),this.createAuthResponse(e,i.role)}async productionLogin(e){try{const t=await fetch(`${this.API_BASE}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Login failed")}const i=await t.json();return this.storeAuthData(i),i}catch(t){throw console.error("Login error:",t),t}}async secureSignup(e){return await new Promise(t=>setTimeout(t,1e3)),this.createAuthResponse({email:e.email,password:e.password},"owner")}async productionSignup(e){try{const t=await fetch(`${this.API_BASE}/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Signup failed")}const i=await t.json();return this.storeAuthData(i),i}catch(t){throw console.error("Signup error:",t),t}}storeAuthData(e){localStorage.setItem(this.TOKEN_KEY,e.accessToken),localStorage.setItem(this.REFRESH_KEY,e.refreshToken),localStorage.setItem(this.USER_KEY,JSON.stringify(e.user)),localStorage.setItem(this.COMPANY_KEY,JSON.stringify(e.company))}generateSecureToken(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")}createAuthResponse(e,t){const i=crypto.randomUUID(),r=crypto.randomUUID(),s=this.generateSecureToken(),l={id:i,visitorId:this.generateVisitorId(),email:e.email,name:e.email.split("@")[0],companyId:r,role:t,permissions:[],profile:{firstName:e.email.split("@")[0],lastName:"User",jobTitle:"CEO",department:"Executive"},settings:{theme:"system",timezone:"America/New_York",workingHours:{start:"09:00",end:"17:00",workingDays:[1,2,3,4,5]},notifications:{enableDesktop:!0,reminderInterval:30,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:{}},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},u={id:r,accountId:this.generateAccountId(),name:"TimeBeacon Demo",slug:"demo",subscription:{id:crypto.randomUUID(),companyId:r,plan:"professional",status:"active",currentPeriodStart:new Date().toISOString(),currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString(),pricePerUser:15,features:{maxUsers:50,aiInsights:!0,advancedReports:!0,integrations:["google-calendar","slack","zoom"],dataRetentionMonths:24,apiAccess:!0,ssoEnabled:!1,customBranding:!0,prioritySupport:!0}},settings:{workingHours:{start:"09:00",end:"17:00",timezone:"America/New_York",workingDays:[1,2,3,4,5]},billing:{currency:"USD",invoiceEmail:e.email},security:{requireMfa:!1,sessionTimeout:480,passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSymbols:!1}}},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),ownerId:l.id,activeUsers:1,maxUsers:50};return{user:l,company:u,accessToken:s,refreshToken:this.generateSecureToken(),expiresIn:3600}}generateAccountId(){return Math.floor(1e4+Math.random()*9e4).toString()}generateVisitorId(){return Math.floor(1e4+Math.random()*9e4).toString()}mockTeamMembers(){return[{id:"user-1",visitorId:"10002",email:"john.doe@demo.com",name:"John Doe",companyId:"mock-company-id",role:"manager",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Engineering Manager",department:"Engineering",hourlyRate:75},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10003",email:"jane.smith@demo.com",name:"Jane Smith",companyId:"mock-company-id",role:"employee",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Senior Developer",department:"Engineering",hourlyRate:65},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!0}]}}const Vv=new SE;class _E{SESSION_KEY="timebeacon_session";SESSION_TIMEOUT=30*60*1e3;MAX_IDLE_TIME=15*60*1e3;activityTimer=null;setSession(e){const t={token:e.accessToken,refreshToken:e.refreshToken,user:e.user,company:e.company,expiresAt:Date.now()+e.expiresIn*1e3,lastActivity:Date.now()},i=this.encryptSession(t);localStorage.setItem(this.SESSION_KEY,i),this.startActivityMonitoring()}getSession(){try{const e=localStorage.getItem(this.SESSION_KEY);if(!e)return null;const t=this.decryptSession(e);return t?this.isSessionExpired(t)?(this.clearSession(),null):(t.lastActivity=Date.now(),this.setSession({accessToken:t.token,refreshToken:t.refreshToken,user:t.user,company:t.company,expiresIn:Math.floor((t.expiresAt-Date.now())/1e3)}),t):null}catch(e){return console.error("Error getting session:",e),this.clearSession(),null}}clearSession(){localStorage.removeItem(this.SESSION_KEY),this.activityTimer&&(clearTimeout(this.activityTimer),this.activityTimer=null)}isSessionValid(){const e=this.getSession();return e!==null&&!this.isSessionExpired(e)}refreshActivity(){const e=this.getSession();e&&(e.lastActivity=Date.now(),this.setSession({accessToken:e.token,refreshToken:e.refreshToken,user:e.user,company:e.company,expiresIn:Math.floor((e.expiresAt-Date.now())/1e3)}))}isSessionExpired(e){const t=Date.now(),i=t>e.expiresAt,r=t-e.lastActivity>this.MAX_IDLE_TIME;return i||r}encryptSession(e){const t=JSON.stringify(e),i=this.getEncryptionKey();let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t.charCodeAt(s)^i.charCodeAt(s%i.length));return btoa(r)}decryptSession(e){try{const t=atob(e),i=this.getEncryptionKey();let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t.charCodeAt(s)^i.charCodeAt(s%i.length));return JSON.parse(r)}catch(t){return console.error("Failed to decrypt session:",t),null}}getEncryptionKey(){return"timebeacon-session-key-2024"}startActivityMonitoring(){this.activityTimer&&clearTimeout(this.activityTimer);const e=["mousedown","mousemove","keypress","scroll","touchstart"],t=()=>this.refreshActivity();e.forEach(i=>{document.addEventListener(i,t,{passive:!0})}),this.activityTimer=setTimeout(()=>{this.clearSession(),window.location.href="/login?reason=idle"},this.MAX_IDLE_TIME)}}const Ns=new _E;class TE{BASE_URL="https://app.timebeacon.io";extractRouteParams(){const t=window.location.pathname.split("/").filter(Boolean);if(t.length>=2){const[i,r]=t;if(this.isNumericId(i)&&this.isNumericId(r))return{accountId:i,visitorId:r}}return null}generateUserUrl(e,t,i=""){const r=`/${e.accountId}/${t.visitorId}`,s=i?`${r}/${i.replace(/^\//,"")}`:r;return`${this.BASE_URL}${s}`}navigateToRoute(e,t,i){const r=this.generateUserUrl(e,t,i);window.history.pushState({},"",r)}validateCurrentRoute(e,t){const i=this.extractRouteParams();return i?i.accountId===e.accountId&&i.visitorId===t.visitorId:!1}redirectToUserContext(e,t){if(!this.validateCurrentRoute(e,t)){const i=this.generateUserUrl(e,t,"dashboard");window.location.href=i}}getAppRoutes(e,t){const i={accountId:e.accountId,visitorId:t.visitorId};return[{...i,path:"dashboard"},{...i,path:"reports"},{...i,path:"ai-insights"},{...i,path:"projects"},{...i,path:"team"},{...i,path:"settings"},{...i,path:"privacy"}]}generateAccountId(){return Math.floor(1e4+Math.random()*9e4).toString()}generateVisitorId(){return Math.floor(1e4+Math.random()*9e4).toString()}formatId(e,t=5){return e.toString().padStart(t,"0")}parseId(e){return parseInt(e,10)}isNumericId(e){return/^\d{4,6}$/.test(e)}generateSharingUrl(e,t,i,r,s){const l=this.generateUserUrl(e,t),u=new URLSearchParams({type:i,id:r,...s?.readonly&&{readonly:"true"},...s?.expires&&{expires:s.expires.toISOString()}});return`${l}/share?${u.toString()}`}generateCompanyUrl(e){return`${this.BASE_URL}/company/${e.slug}`}generateLoginUrl(e,t){const i=new URLSearchParams;e&&i.set("account",e),t&&i.set("visitor",t);const r=i.toString();return`${this.BASE_URL}/login${r?`?${r}`:""}`}handleDeepLink(e,t,i){return!t||!i?`/login?${new URLSearchParams({return:e}).toString()}`:e.startsWith(`/${t.accountId}/${i.visitorId}`)?e:this.generateUserUrl(t,i,e)}encodeForUrl(e){return btoa(JSON.stringify(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}decodeFromUrl(e){try{const t=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"=");return JSON.parse(atob(t))}catch(t){return console.error("Failed to decode URL data:",t),null}}}const wE=new TE,Or="http://localhost:3003/api";let ci=localStorage.getItem("auth_token");const Yo={async signup(n){const e=await fetch(`${Or}/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),t=await e.json();return e.ok&&(ci=t.token,localStorage.setItem("auth_token",t.token),localStorage.setItem("user_data",JSON.stringify(t.user)),localStorage.setItem("company_data",JSON.stringify(t.company)),localStorage.setItem("subscription_data",JSON.stringify(t.subscription))),t},async login(n,e,t){console.log("Attempting login to:",`${Or}/auth/login`),console.log("With credentials:",{email:n,password:"***"});const i=await fetch(`${Or}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:e,companySlug:t})});console.log("Login response status:",i.status);const r=await i.json();if(i.ok)return ci=r.token,localStorage.setItem("auth_token",r.token),localStorage.setItem("user_data",JSON.stringify(r.user)),{accessToken:r.token,refreshToken:r.token,user:r.user,company:{id:r.user.companyId,name:r.user.companyName,slug:r.user.companySlug},expiresIn:"7d"};throw i.status===401?new Error("Invalid email or password"):new Error(r.error||r.message||"Login failed")},async logout(){ci&&await fetch(`${Or}/auth/logout`,{method:"POST",headers:{Authorization:`Bearer ${ci}`}}),ci=null,localStorage.removeItem("auth_token"),localStorage.removeItem("user_data")},async getCurrentUser(){if(!ci)throw new Error("Not authenticated");return await(await fetch(`${Or}/auth/me`,{headers:{Authorization:`Bearer ${ci}`}})).json()},async getPlans(){return await(await fetch(`${Or}/auth/plans`)).json()},async getAIControlSettings(){if(!ci)throw new Error("Not authenticated");return await(await fetch(`${Or}/ai-control/settings`,{headers:{Authorization:`Bearer ${ci}`}})).json()},async updateAIControlSettings(n){if(!ci)throw new Error("Not authenticated");return await(await fetch(`${Or}/ai-control/settings`,{method:"PUT",headers:{Authorization:`Bearer ${ci}`,"Content-Type":"application/json"},body:JSON.stringify(n)})).json()},async getAIStatus(){if(!ci)throw new Error("Not authenticated");return await(await fetch(`${Or}/ai-control/status`,{headers:{Authorization:`Bearer ${ci}`}})).json()},async testAI(){if(!ci)throw new Error("Not authenticated");return await(await fetch(`${Or}/ai-control/test`,{method:"POST",headers:{Authorization:`Bearer ${ci}`}})).json()}},yb=H.createContext(void 0),Xc=()=>{const n=H.useContext(yb);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},EE=({children:n})=>{const[e,t]=H.useState({user:null,company:null,isAuthenticated:!1,isLoading:!0,permissions:[]}),[i,r]=H.useState(null);H.useEffect(()=>{s()},[]),H.useEffect(()=>{const v=wE.extractRouteParams();r(v)},[window.location.pathname]);const s=()=>{try{const v=Ns.getSession();if(v&&Ns.isSessionValid()){const y=v.user.permissions||[];t({user:v.user,company:v.company,isAuthenticated:!0,isLoading:!1,permissions:y})}else Ns.clearSession(),t(y=>({...y,isLoading:!1}))}catch(v){console.error("Auth initialization failed:",v),Ns.clearSession(),t(y=>({...y,isLoading:!1}))}},p={...e,login:async(v,y)=>{t(S=>({...S,isLoading:!0}));try{const S=await Yo.login(v,y);Ns.setSession({accessToken:S.accessToken,refreshToken:S.refreshToken,user:S.user,company:S.company,expiresIn:S.expiresIn});const _=S.user.permissions||[],b={user:S.user,company:S.company,isAuthenticated:!0,isLoading:!1,permissions:_};return t(b),!0}catch(S){return console.error("Login failed:",S),t(_=>({..._,isLoading:!1})),!1}},logout:async()=>{try{await Vv.logout()}catch(v){console.error("Logout error:",v)}Ns.clearSession(),t({user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]}),r(null),window.location.href="/login"},checkPermission:(v,y)=>e.user?Vv.hasPermission(e.permissions,v,y,e.user.id):!1,currentRoute:i,refreshSession:()=>{Ns.refreshActivity()}};return d.jsx(yb.Provider,{value:p,children:n})};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */var Cm,Gv;function Yv(){if(Gv)return Cm;Gv=1;const{entries:n,setPrototypeOf:e,isFrozen:t,getPrototypeOf:i,getOwnPropertyDescriptor:r}=Object;let{freeze:s,seal:l,create:u}=Object,{apply:f,construct:m}=typeof Reflect<"u"&&Reflect;s||(s=function(ze){return ze}),l||(l=function(ze){return ze}),f||(f=function(ze,Ye,Ze){return ze.apply(Ye,Ze)}),m||(m=function(ze,Ye){return new ze(...Ye)});const p=z(Array.prototype.forEach),v=z(Array.prototype.lastIndexOf),y=z(Array.prototype.pop),S=z(Array.prototype.push),_=z(Array.prototype.splice),b=z(String.prototype.toLowerCase),T=z(String.prototype.toString),E=z(String.prototype.match),w=z(String.prototype.replace),C=z(String.prototype.indexOf),j=z(String.prototype.trim),k=z(Object.prototype.hasOwnProperty),P=z(RegExp.prototype.test),D=R(TypeError);function z(Qe){return function(ze){ze instanceof RegExp&&(ze.lastIndex=0);for(var Ye=arguments.length,Ze=new Array(Ye>1?Ye-1:0),Rt=1;Rt<Ye;Rt++)Ze[Rt-1]=arguments[Rt];return f(Qe,ze,Ze)}}function R(Qe){return function(){for(var ze=arguments.length,Ye=new Array(ze),Ze=0;Ze<ze;Ze++)Ye[Ze]=arguments[Ze];return m(Qe,Ye)}}function W(Qe,ze){let Ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b;e&&e(Qe,null);let Ze=ze.length;for(;Ze--;){let Rt=ze[Ze];if(typeof Rt=="string"){const Et=Ye(Rt);Et!==Rt&&(t(ze)||(ze[Ze]=Et),Rt=Et)}Qe[Rt]=!0}return Qe}function q(Qe){for(let ze=0;ze<Qe.length;ze++)k(Qe,ze)||(Qe[ze]=null);return Qe}function J(Qe){const ze=u(null);for(const[Ye,Ze]of n(Qe))k(Qe,Ye)&&(Array.isArray(Ze)?ze[Ye]=q(Ze):Ze&&typeof Ze=="object"&&Ze.constructor===Object?ze[Ye]=J(Ze):ze[Ye]=Ze);return ze}function me(Qe,ze){for(;Qe!==null;){const Ze=r(Qe,ze);if(Ze){if(Ze.get)return z(Ze.get);if(typeof Ze.value=="function")return z(Ze.value)}Qe=i(Qe)}function Ye(){return null}return Ye}const Ce=s(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ve=s(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ne=s(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Z=s(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),be=s(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ne=s(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),V=s(["#text"]),he=s(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),I=s(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Y=s(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),G=s(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),K=l(/\{\{[\w\W]*|[\w\W]*\}\}/gm),se=l(/<%[\w\W]*|[\w\W]*%>/gm),Le=l(/\$\{[\w\W]*/gm),Oe=l(/^data-[\-\w.\u00B7-\uFFFF]+$/),we=l(/^aria-[\-\w]+$/),ke=l(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),dt=l(/^(?:\w+script|data):/i),et=l(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Yt=l(/^html$/i),at=l(/^[a-z][.\w]*(-[.\w]+)+$/i);var Yn=Object.freeze({__proto__:null,ARIA_ATTR:we,ATTR_WHITESPACE:et,CUSTOM_ELEMENT:at,DATA_ATTR:Oe,DOCTYPE_NAME:Yt,ERB_EXPR:se,IS_ALLOWED_URI:ke,IS_SCRIPT_OR_DATA:dt,MUSTACHE_EXPR:K,TMPLIT_EXPR:Le});const vt={element:1,text:3,progressingInstruction:7,comment:8,document:9},Pe=function(){return typeof window>"u"?null:window},An=function(ze,Ye){if(typeof ze!="object"||typeof ze.createPolicy!="function")return null;let Ze=null;const Rt="data-tt-policy-suffix";Ye&&Ye.hasAttribute(Rt)&&(Ze=Ye.getAttribute(Rt));const Et="dompurify"+(Ze?"#"+Ze:"");try{return ze.createPolicy(Et,{createHTML(Wt){return Wt},createScriptURL(Wt){return Wt}})}catch{return console.warn("TrustedTypes policy "+Et+" could not be created."),null}},Mn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ni(){let Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pe();const ze=Fe=>ni(Fe);if(ze.version="3.2.6",ze.removed=[],!Qe||!Qe.document||Qe.document.nodeType!==vt.document||!Qe.Element)return ze.isSupported=!1,ze;let{document:Ye}=Qe;const Ze=Ye,Rt=Ze.currentScript,{DocumentFragment:Et,HTMLTemplateElement:Wt,Node:te,Element:Ee,NodeFilter:Ke,NamedNodeMap:We=Qe.NamedNodeMap||Qe.MozNamedAttrMap,HTMLFormElement:st,DOMParser:ft,trustedTypes:Vt}=Qe,ri=Ee.prototype,tt=me(ri,"cloneNode"),ai=me(ri,"remove"),$n=me(ri,"nextSibling"),ji=me(ri,"childNodes"),_r=me(ri,"parentNode");if(typeof Wt=="function"){const Fe=Ye.createElement("template");Fe.content&&Fe.content.ownerDocument&&(Ye=Fe.content.ownerDocument)}let Kt,Gi="";const{implementation:Sa,createNodeIterator:eo,createDocumentFragment:cs,getElementsByTagName:us}=Ye,{importNode:to}=Ze;let xn=Mn();ze.isSupported=typeof n=="function"&&typeof _r=="function"&&Sa&&Sa.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:hi,ERB_EXPR:en,TMPLIT_EXPR:tn,DATA_ATTR:Tr,ARIA_ATTR:ds,IS_SCRIPT_OR_DATA:cl,ATTR_WHITESPACE:N,CUSTOM_ELEMENT:U}=Yn;let{IS_ALLOWED_URI:M}=Yn,L=null;const F=W({},[...Ce,...ve,...ne,...be,...V]);let B=null;const oe=W({},[...he,...I,...Y,...G]);let de=Object.seal(u(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ie=null,ce=null,fe=!0,Te=!0,De=!1,Be=!0,Ae=!1,Ie=!0,Ge=!1,yt=!1,xt=!1,mt=!1,mi=!1,Di=!1,si=!0,pi=!1;const Vr="user-content-";let oi=!0,_a=!1,bn={},Gr=null;const iu=W({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let fs=null;const ul=W({},["audio","video","img","source","image","track"]);let Ta=null;const ru=W({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ln="http://www.w3.org/1998/Math/MathML",wa="http://www.w3.org/2000/svg",Yi="http://www.w3.org/1999/xhtml";let wr=Yi,Er=!1,no=null;const au=W({},[Ln,wa,Yi],T);let or=W({},["mi","mo","mn","ms","mtext"]),io=W({},["annotation-xml"]);const su=W({},["title","style","font","a","script"]);let Ea=null;const dl=["application/xhtml+xml","text/html"],kf="text/html";let dn=null,lr=null;const fl=Ye.createElement("form"),ro=function(Q){return Q instanceof RegExp||Q instanceof Function},Ar=function(){let Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(lr&&lr===Q)){if((!Q||typeof Q!="object")&&(Q={}),Q=J(Q),Ea=dl.indexOf(Q.PARSER_MEDIA_TYPE)===-1?kf:Q.PARSER_MEDIA_TYPE,dn=Ea==="application/xhtml+xml"?T:b,L=k(Q,"ALLOWED_TAGS")?W({},Q.ALLOWED_TAGS,dn):F,B=k(Q,"ALLOWED_ATTR")?W({},Q.ALLOWED_ATTR,dn):oe,no=k(Q,"ALLOWED_NAMESPACES")?W({},Q.ALLOWED_NAMESPACES,T):au,Ta=k(Q,"ADD_URI_SAFE_ATTR")?W(J(ru),Q.ADD_URI_SAFE_ATTR,dn):ru,fs=k(Q,"ADD_DATA_URI_TAGS")?W(J(ul),Q.ADD_DATA_URI_TAGS,dn):ul,Gr=k(Q,"FORBID_CONTENTS")?W({},Q.FORBID_CONTENTS,dn):iu,ie=k(Q,"FORBID_TAGS")?W({},Q.FORBID_TAGS,dn):J({}),ce=k(Q,"FORBID_ATTR")?W({},Q.FORBID_ATTR,dn):J({}),bn=k(Q,"USE_PROFILES")?Q.USE_PROFILES:!1,fe=Q.ALLOW_ARIA_ATTR!==!1,Te=Q.ALLOW_DATA_ATTR!==!1,De=Q.ALLOW_UNKNOWN_PROTOCOLS||!1,Be=Q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ae=Q.SAFE_FOR_TEMPLATES||!1,Ie=Q.SAFE_FOR_XML!==!1,Ge=Q.WHOLE_DOCUMENT||!1,mt=Q.RETURN_DOM||!1,mi=Q.RETURN_DOM_FRAGMENT||!1,Di=Q.RETURN_TRUSTED_TYPE||!1,xt=Q.FORCE_BODY||!1,si=Q.SANITIZE_DOM!==!1,pi=Q.SANITIZE_NAMED_PROPS||!1,oi=Q.KEEP_CONTENT!==!1,_a=Q.IN_PLACE||!1,M=Q.ALLOWED_URI_REGEXP||ke,wr=Q.NAMESPACE||Yi,or=Q.MATHML_TEXT_INTEGRATION_POINTS||or,io=Q.HTML_INTEGRATION_POINTS||io,de=Q.CUSTOM_ELEMENT_HANDLING||{},Q.CUSTOM_ELEMENT_HANDLING&&ro(Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(de.tagNameCheck=Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&ro(Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(de.attributeNameCheck=Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&typeof Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(de.allowCustomizedBuiltInElements=Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ae&&(Te=!1),mi&&(mt=!0),bn&&(L=W({},V),B=[],bn.html===!0&&(W(L,Ce),W(B,he)),bn.svg===!0&&(W(L,ve),W(B,I),W(B,G)),bn.svgFilters===!0&&(W(L,ne),W(B,I),W(B,G)),bn.mathMl===!0&&(W(L,be),W(B,Y),W(B,G))),Q.ADD_TAGS&&(L===F&&(L=J(L)),W(L,Q.ADD_TAGS,dn)),Q.ADD_ATTR&&(B===oe&&(B=J(B)),W(B,Q.ADD_ATTR,dn)),Q.ADD_URI_SAFE_ATTR&&W(Ta,Q.ADD_URI_SAFE_ATTR,dn),Q.FORBID_CONTENTS&&(Gr===iu&&(Gr=J(Gr)),W(Gr,Q.FORBID_CONTENTS,dn)),oi&&(L["#text"]=!0),Ge&&W(L,["html","head","body"]),L.table&&(W(L,["tbody"]),delete ie.tbody),Q.TRUSTED_TYPES_POLICY){if(typeof Q.TRUSTED_TYPES_POLICY.createHTML!="function")throw D('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw D('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');Kt=Q.TRUSTED_TYPES_POLICY,Gi=Kt.createHTML("")}else Kt===void 0&&(Kt=An(Vt,Rt)),Kt!==null&&typeof Gi=="string"&&(Gi=Kt.createHTML(""));s&&s(Q),lr=Q}},Yr=W({},[...ve,...ne,...Z]),hl=W({},[...be,...Ne]),ml=function(Q){let je=_r(Q);(!je||!je.tagName)&&(je={namespaceURI:wr,tagName:"template"});const Ue=b(Q.tagName),zt=b(je.tagName);return no[Q.namespaceURI]?Q.namespaceURI===wa?je.namespaceURI===Yi?Ue==="svg":je.namespaceURI===Ln?Ue==="svg"&&(zt==="annotation-xml"||or[zt]):!!Yr[Ue]:Q.namespaceURI===Ln?je.namespaceURI===Yi?Ue==="math":je.namespaceURI===wa?Ue==="math"&&io[zt]:!!hl[Ue]:Q.namespaceURI===Yi?je.namespaceURI===wa&&!io[zt]||je.namespaceURI===Ln&&!or[zt]?!1:!hl[Ue]&&(su[Ue]||!Yr[Ue]):!!(Ea==="application/xhtml+xml"&&no[Q.namespaceURI]):!1},Ni=function(Q){S(ze.removed,{element:Q});try{_r(Q).removeChild(Q)}catch{ai(Q)}},$i=function(Q,je){try{S(ze.removed,{attribute:je.getAttributeNode(Q),from:je})}catch{S(ze.removed,{attribute:null,from:je})}if(je.removeAttribute(Q),Q==="is")if(mt||mi)try{Ni(je)}catch{}else try{je.setAttribute(Q,"")}catch{}},Xi=function(Q){let je=null,Ue=null;if(xt)Q="<remove></remove>"+Q;else{const Zt=E(Q,/^[\r\n\t ]+/);Ue=Zt&&Zt[0]}Ea==="application/xhtml+xml"&&wr===Yi&&(Q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Q+"</body></html>");const zt=Kt?Kt.createHTML(Q):Q;if(wr===Yi)try{je=new ft().parseFromString(zt,Ea)}catch{}if(!je||!je.documentElement){je=Sa.createDocument(wr,"template",null);try{je.documentElement.innerHTML=Er?Gi:zt}catch{}}const fn=je.body||je.documentElement;return Q&&Ue&&fn.insertBefore(Ye.createTextNode(Ue),fn.childNodes[0]||null),wr===Yi?us.call(je,Ge?"html":"body")[0]:Ge?je.documentElement:fn},ao=function(Q){return eo.call(Q.ownerDocument||Q,Q,Ke.SHOW_ELEMENT|Ke.SHOW_COMMENT|Ke.SHOW_TEXT|Ke.SHOW_PROCESSING_INSTRUCTION|Ke.SHOW_CDATA_SECTION,null)},$r=function(Q){return Q instanceof st&&(typeof Q.nodeName!="string"||typeof Q.textContent!="string"||typeof Q.removeChild!="function"||!(Q.attributes instanceof We)||typeof Q.removeAttribute!="function"||typeof Q.setAttribute!="function"||typeof Q.namespaceURI!="string"||typeof Q.insertBefore!="function"||typeof Q.hasChildNodes!="function")},cr=function(Q){return typeof te=="function"&&Q instanceof te};function Oi(Fe,Q,je){p(Fe,Ue=>{Ue.call(ze,Q,je,lr)})}const hs=function(Q){let je=null;if(Oi(xn.beforeSanitizeElements,Q,null),$r(Q))return Ni(Q),!0;const Ue=dn(Q.nodeName);if(Oi(xn.uponSanitizeElement,Q,{tagName:Ue,allowedTags:L}),Ie&&Q.hasChildNodes()&&!cr(Q.firstElementChild)&&P(/<[/\w!]/g,Q.innerHTML)&&P(/<[/\w!]/g,Q.textContent)||Q.nodeType===vt.progressingInstruction||Ie&&Q.nodeType===vt.comment&&P(/<[/\w]/g,Q.data))return Ni(Q),!0;if(!L[Ue]||ie[Ue]){if(!ie[Ue]&&ms(Ue)&&(de.tagNameCheck instanceof RegExp&&P(de.tagNameCheck,Ue)||de.tagNameCheck instanceof Function&&de.tagNameCheck(Ue)))return!1;if(oi&&!Gr[Ue]){const zt=_r(Q)||Q.parentNode,fn=ji(Q)||Q.childNodes;if(fn&&zt){const Zt=fn.length;for(let hn=Zt-1;hn>=0;--hn){const gi=tt(fn[hn],!0);gi.__removalCount=(Q.__removalCount||0)+1,zt.insertBefore(gi,$n(Q))}}}return Ni(Q),!0}return Q instanceof Ee&&!ml(Q)||(Ue==="noscript"||Ue==="noembed"||Ue==="noframes")&&P(/<\/no(script|embed|frames)/i,Q.innerHTML)?(Ni(Q),!0):(Ae&&Q.nodeType===vt.text&&(je=Q.textContent,p([hi,en,tn],zt=>{je=w(je,zt," ")}),Q.textContent!==je&&(S(ze.removed,{element:Q.cloneNode()}),Q.textContent=je)),Oi(xn.afterSanitizeElements,Q,null),!1)},pl=function(Q,je,Ue){if(si&&(je==="id"||je==="name")&&(Ue in Ye||Ue in fl))return!1;if(!(Te&&!ce[je]&&P(Tr,je))){if(!(fe&&P(ds,je))){if(!B[je]||ce[je]){if(!(ms(Q)&&(de.tagNameCheck instanceof RegExp&&P(de.tagNameCheck,Q)||de.tagNameCheck instanceof Function&&de.tagNameCheck(Q))&&(de.attributeNameCheck instanceof RegExp&&P(de.attributeNameCheck,je)||de.attributeNameCheck instanceof Function&&de.attributeNameCheck(je))||je==="is"&&de.allowCustomizedBuiltInElements&&(de.tagNameCheck instanceof RegExp&&P(de.tagNameCheck,Ue)||de.tagNameCheck instanceof Function&&de.tagNameCheck(Ue))))return!1}else if(!Ta[je]){if(!P(M,w(Ue,N,""))){if(!((je==="src"||je==="xlink:href"||je==="href")&&Q!=="script"&&C(Ue,"data:")===0&&fs[Q])){if(!(De&&!P(cl,w(Ue,N,"")))){if(Ue)return!1}}}}}}return!0},ms=function(Q){return Q!=="annotation-xml"&&E(Q,U)},ps=function(Q){Oi(xn.beforeSanitizeAttributes,Q,null);const{attributes:je}=Q;if(!je||$r(Q))return;const Ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let zt=je.length;for(;zt--;){const fn=je[zt],{name:Zt,namespaceURI:hn,value:gi}=fn,Aa=dn(Zt),gl=gi;let kn=Zt==="value"?gl:j(gl);if(Ue.attrName=Aa,Ue.attrValue=kn,Ue.keepAttr=!0,Ue.forceKeepAttr=void 0,Oi(xn.uponSanitizeAttribute,Q,Ue),kn=Ue.attrValue,pi&&(Aa==="id"||Aa==="name")&&($i(Zt,Q),kn=Vr+kn),Ie&&P(/((--!?|])>)|<\/(style|title)/i,kn)){$i(Zt,Q);continue}if(Ue.forceKeepAttr)continue;if(!Ue.keepAttr){$i(Zt,Q);continue}if(!Be&&P(/\/>/i,kn)){$i(Zt,Q);continue}Ae&&p([hi,en,tn],so=>{kn=w(kn,so," ")});const lu=dn(Q.nodeName);if(!pl(lu,Aa,kn)){$i(Zt,Q);continue}if(Kt&&typeof Vt=="object"&&typeof Vt.getAttributeType=="function"&&!hn)switch(Vt.getAttributeType(lu,Aa)){case"TrustedHTML":{kn=Kt.createHTML(kn);break}case"TrustedScriptURL":{kn=Kt.createScriptURL(kn);break}}if(kn!==gl)try{hn?Q.setAttributeNS(hn,Zt,kn):Q.setAttribute(Zt,kn),$r(Q)?Ni(Q):y(ze.removed)}catch{$i(Zt,Q)}}Oi(xn.afterSanitizeAttributes,Q,null)},ou=function Fe(Q){let je=null;const Ue=ao(Q);for(Oi(xn.beforeSanitizeShadowDOM,Q,null);je=Ue.nextNode();)Oi(xn.uponSanitizeShadowNode,je,null),hs(je),ps(je),je.content instanceof Et&&Fe(je.content);Oi(xn.afterSanitizeShadowDOM,Q,null)};return ze.sanitize=function(Fe){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},je=null,Ue=null,zt=null,fn=null;if(Er=!Fe,Er&&(Fe="<!-->"),typeof Fe!="string"&&!cr(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw D("dirty is not a string, aborting")}else throw D("toString is not a function");if(!ze.isSupported)return Fe;if(yt||Ar(Q),ze.removed=[],typeof Fe=="string"&&(_a=!1),_a){if(Fe.nodeName){const gi=dn(Fe.nodeName);if(!L[gi]||ie[gi])throw D("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof te)je=Xi("<!---->"),Ue=je.ownerDocument.importNode(Fe,!0),Ue.nodeType===vt.element&&Ue.nodeName==="BODY"||Ue.nodeName==="HTML"?je=Ue:je.appendChild(Ue);else{if(!mt&&!Ae&&!Ge&&Fe.indexOf("<")===-1)return Kt&&Di?Kt.createHTML(Fe):Fe;if(je=Xi(Fe),!je)return mt?null:Di?Gi:""}je&&xt&&Ni(je.firstChild);const Zt=ao(_a?Fe:je);for(;zt=Zt.nextNode();)hs(zt),ps(zt),zt.content instanceof Et&&ou(zt.content);if(_a)return Fe;if(mt){if(mi)for(fn=cs.call(je.ownerDocument);je.firstChild;)fn.appendChild(je.firstChild);else fn=je;return(B.shadowroot||B.shadowrootmode)&&(fn=to.call(Ze,fn,!0)),fn}let hn=Ge?je.outerHTML:je.innerHTML;return Ge&&L["!doctype"]&&je.ownerDocument&&je.ownerDocument.doctype&&je.ownerDocument.doctype.name&&P(Yt,je.ownerDocument.doctype.name)&&(hn="<!DOCTYPE "+je.ownerDocument.doctype.name+`>
`+hn),Ae&&p([hi,en,tn],gi=>{hn=w(hn,gi," ")}),Kt&&Di?Kt.createHTML(hn):hn},ze.setConfig=function(){let Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ar(Fe),yt=!0},ze.clearConfig=function(){lr=null,yt=!1},ze.isValidAttribute=function(Fe,Q,je){lr||Ar({});const Ue=dn(Fe),zt=dn(Q);return pl(Ue,zt,je)},ze.addHook=function(Fe,Q){typeof Q=="function"&&S(xn[Fe],Q)},ze.removeHook=function(Fe,Q){if(Q!==void 0){const je=v(xn[Fe],Q);return je===-1?void 0:_(xn[Fe],je,1)[0]}return y(xn[Fe])},ze.removeHooks=function(Fe){xn[Fe]=[]},ze.removeAllHooks=function(){xn=Mn()},ze}var ii=ni();return Cm=ii,Cm}var jm,$v;function AE(){return $v||($v=1,jm=window.DOMPurify||(window.DOMPurify=Yv().default||Yv())),jm}var kE=AE();const CE=pp(kE);class jE{validateField(e,t){const i=[];let r=e;if(t.required&&this.isEmpty(e))return i.push(t.errorMessage||"This field is required"),{isValid:!1,errors:i};if(this.isEmpty(e)&&!t.required)return{isValid:!0,errors:[],sanitizedValue:""};if(t.type){const s=this.validateType(e,t.type);s.isValid||i.push(...s.errors),r=s.sanitizedValue||e}return t.minLength&&e.length<t.minLength&&i.push(`Must be at least ${t.minLength} characters long`),t.maxLength&&e.length>t.maxLength&&i.push(`Must be no more than ${t.maxLength} characters long`),t.pattern&&!t.pattern.test(e)&&i.push(t.errorMessage||"Invalid format"),t.customValidator&&!t.customValidator(e)&&i.push(t.errorMessage||"Invalid value"),{isValid:i.length===0,errors:i,sanitizedValue:r}}validateForm(e,t){const i={},r={};let s=!0;for(const[l,u]of Object.entries(t)){const f=this.validateField(e[l],u);f.isValid||(i[l]=f.errors,s=!1),r[l]=f.sanitizedValue}return{isValid:s,errors:i,sanitizedData:r}}sanitizeHtml(e){return CE.sanitize(e,{ALLOWED_TAGS:["p","br","strong","em","u","ol","ul","li"],ALLOWED_ATTR:[]})}sanitizeText(e){return e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}sanitizeSql(e){const t=[/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE)\b)/gi,/(--|\/\*|\*\/)/g,/(\bOR\b.*=.*\b)|(\bAND\b.*=.*\b)/gi,/(\bunion\b.*\bselect\b)/gi];let i=e;return t.forEach(r=>{i=i.replace(r,"")}),i.trim()}validateType(e,t){let i=e;const r=[];switch(t){case"email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||r.push("Please enter a valid email address"),i=this.sanitizeText(e);break;case"password":e.length<8&&r.push("Password must be at least 8 characters long"),/[A-Z]/.test(e)||r.push("Password must contain at least one uppercase letter"),/[a-z]/.test(e)||r.push("Password must contain at least one lowercase letter"),/\d/.test(e)||r.push("Password must contain at least one number"),i=e;break;case"text":i=this.sanitizeText(e);break;case"number":const l=Number(e);isNaN(l)&&r.push("Please enter a valid number"),i=l;break;case"url":try{new URL(e),i=this.sanitizeText(e)}catch{r.push("Please enter a valid URL")}break;case"phone":/^\+?[\d\s\-\(\)]+$/.test(e)||r.push("Please enter a valid phone number"),i=e.replace(/[^\d\+\-\(\)\s]/g,"");break;default:i=this.sanitizeText(e)}return{isValid:r.length===0,errors:r,sanitizedValue:i}}isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||typeof e=="object"&&Object.keys(e).length===0}validateTimeEntry(e){const t={description:{required:!0,type:"text",maxLength:500,errorMessage:"Description is required and must be less than 500 characters"},duration:{required:!0,type:"number",customValidator:i=>i>0&&i<=1440,errorMessage:"Duration must be between 1 minute and 24 hours"},projectId:{required:!0,errorMessage:"Project is required"},clientId:{required:!1}};return this.validateForm(e,t)}validateProject(e){const t={name:{required:!0,type:"text",maxLength:100,errorMessage:"Project name is required and must be less than 100 characters"},description:{required:!1,type:"text",maxLength:1e3},budget:{required:!1,type:"number",customValidator:i=>i>=0,errorMessage:"Budget must be a positive number"},hourlyRate:{required:!1,type:"number",customValidator:i=>i>=0,errorMessage:"Hourly rate must be a positive number"}};return this.validateForm(e,t)}validateClient(e){const t={name:{required:!0,type:"text",maxLength:100,errorMessage:"Client name is required and must be less than 100 characters"},email:{required:!1,type:"email"},phone:{required:!1,type:"phone"},website:{required:!1,type:"url"}};return this.validateForm(e,t)}}const Xv=new jE,DE=()=>{const[n,e]=H.useState(""),[t,i]=H.useState(""),[r,s]=H.useState(""),[l,u]=H.useState(!1),{login:f,isLoading:m}=Xc(),p=ff(),v=async S=>{S.preventDefault(),s("");const _=Xv.validateField(n,{required:!0,type:"email",errorMessage:"Please enter a valid email address"}),b=Xv.validateField(t,{required:!0,minLength:8,errorMessage:"Password must be at least 8 characters"});if(!_.isValid){s(_.errors[0]);return}if(!b.isValid){s(b.errors[0]);return}try{await f(n,t)?p("/dashboard"):s("Invalid email or password")}catch(T){s(T.message||"Login failed. Please try again.")}},y=S=>{const _={admin:{email:"sarah.manager@acmecrm.com",password:"TempPass123!"},manager:{email:"sarah.manager@acmecrm.com",password:"TempPass123!"},employee:{email:"mike.developer@acmecrm.com",password:"TempPass123!"}};e(_[S].email),i(_[S].password),u(!1)};return d.jsx("div",{className:"login-page",children:d.jsxs("div",{className:"login-container",children:[d.jsxs("div",{className:"login-header",children:[d.jsx("h1",{children:"TimeBeacon"}),d.jsx("p",{children:"Sign in to your account"})]}),d.jsxs("form",{onSubmit:v,className:"login-form",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"email",children:"Email"}),d.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),placeholder:"Enter your email",disabled:m})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"password",children:"Password"}),d.jsx("input",{type:"password",id:"password",value:t,onChange:S=>i(S.target.value),placeholder:"Enter your password",disabled:m})]}),r&&d.jsx("div",{className:"error-message",children:r}),d.jsx("button",{type:"submit",className:"login-button",disabled:m,children:m?"Signing in...":"Sign In"}),d.jsxs("div",{className:"demo-section",children:[d.jsxs("button",{type:"button",className:"demo-toggle-button",onClick:()=>u(!l),children:[l?"Hide":"Show"," Demo Credentials"]}),l&&d.jsxs("div",{className:"demo-credentials",children:[d.jsx("p",{children:"Try these demo accounts:"}),d.jsxs("div",{className:"demo-options",children:[d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>y("admin"),children:"Admin (Owner)"}),d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>y("manager"),children:"Manager"}),d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>y("employee"),children:"Employee"})]})]})]})]}),d.jsxs("div",{className:"security-notice",children:[d.jsx("p",{children:" This demo uses enhanced security features including:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Input validation and sanitization"}),d.jsx("li",{children:"Rate limiting protection"}),d.jsx("li",{children:"Secure session management"}),d.jsx("li",{children:"CSRF protection"})]})]})]})})},Je={container:{minHeight:"100vh",background:"var(--background)",display:"flex",flexDirection:"column",justifyContent:"center",padding:"2rem 1rem",fontFamily:"var(--font-sans)"},header:{textAlign:"center",marginBottom:"2rem"},title:{fontSize:"2rem",fontWeight:"bold",color:"var(--text-primary)",marginBottom:"0.5rem"},subtitle:{fontSize:"1rem",color:"var(--text-secondary)"},form:{maxWidth:"500px",margin:"0 auto",background:"var(--surface)",padding:"2rem",borderRadius:"12px",boxShadow:"var(--shadow-lg)",border:"1px solid var(--border-subtle)"},section:{marginBottom:"2rem"},sectionTitle:{fontSize:"1.2rem",fontWeight:"600",color:"var(--text-primary)",marginBottom:"1rem"},formGroup:{marginBottom:"1rem"},label:{display:"block",fontSize:"0.9rem",fontWeight:"500",color:"var(--text-primary)",marginBottom:"0.5rem"},input:{width:"100%",padding:"0.75rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"1rem",background:"var(--surface)",color:"var(--text-primary)",boxSizing:"border-box"},select:{width:"100%",padding:"0.75rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"1rem",background:"var(--surface)",color:"var(--text-primary)",boxSizing:"border-box"},button:{width:"100%",padding:"0.75rem 1rem",background:"var(--brand-primary)",color:"white",border:"none",borderRadius:"6px",fontSize:"1rem",fontWeight:"500",cursor:"pointer",marginTop:"1rem"},buttonDisabled:{opacity:.6,cursor:"not-allowed"},error:{background:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"0.75rem",borderRadius:"6px",fontSize:"0.9rem",marginBottom:"1rem"},planDetails:{background:"var(--background-secondary)",padding:"1rem",borderRadius:"8px",marginTop:"1rem"},grid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},link:{width:"100%",padding:"0.75rem 1rem",background:"var(--surface)",color:"var(--text-primary)",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"1rem",textDecoration:"none",textAlign:"center",display:"block",marginTop:"1rem"}},NE=()=>{const[n,e]=H.useState({companyName:"",companySlug:"",companyEmail:"",companyDomain:"",ownerEmail:"",ownerPassword:"",ownerFirstName:"",ownerLastName:"",plan:"starter",billingInterval:"monthly"}),[t,i]=H.useState({}),[r,s]=H.useState(!1),[l,u]=H.useState(""),[f,m]=H.useState(!1);H.useEffect(()=>{p()},[]);const p=async()=>{try{const T=await Yo.getPlans();i(T.plans)}catch(T){console.error("Failed to load plans:",T)}},v=T=>T.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),y=T=>{const{name:E,value:w}=T.target;e(C=>{const j={...C,[E]:w};return E==="companyName"&&(j.companySlug=v(w)),j})},S=async T=>{T.preventDefault(),s(!0),u("");try{const E=await Yo.signup(n);if(E.token)m(!0),setTimeout(()=>{window.location.href="/dashboard"},2e3);else throw new Error(E.error||"Signup failed")}catch(E){u(E.message||"Signup failed. Please try again.")}finally{s(!1)}},_=t[n.plan],b=_?.[n.billingInterval];return f?d.jsx("div",{style:Je.container,children:d.jsxs("div",{style:{textAlign:"center",maxWidth:"400px",margin:"0 auto"},children:[d.jsx("div",{style:{fontSize:"4rem",color:"var(--success)",marginBottom:"1rem"},children:""}),d.jsx("h2",{style:Je.title,children:"Welcome to TimeBeacon!"}),d.jsx("p",{style:Je.subtitle,children:"Your account has been created successfully. Redirecting to dashboard..."})]})}):d.jsxs("div",{style:Je.container,children:[d.jsxs("div",{style:Je.header,children:[d.jsx("h2",{style:Je.title,children:"Create Your TimeBeacon Account"}),d.jsx("p",{style:Je.subtitle,children:"Start your 14-day free trial today"})]}),d.jsx("div",{style:Je.form,children:d.jsxs("form",{onSubmit:S,children:[l&&d.jsx("div",{style:Je.error,children:l}),d.jsxs("div",{style:Je.section,children:[d.jsx("h3",{style:Je.sectionTitle,children:"Company Information"}),d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"companyName",children:"Company Name"}),d.jsx("input",{style:Je.input,id:"companyName",name:"companyName",type:"text",required:!0,value:n.companyName,onChange:y,placeholder:"Acme Corp"})]}),d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"companySlug",children:"Company URL"}),d.jsx("input",{style:Je.input,id:"companySlug",name:"companySlug",type:"text",required:!0,value:n.companySlug,onChange:y,placeholder:"acme-corp"}),d.jsxs("small",{style:{color:"var(--text-secondary)",fontSize:"0.8rem"},children:["timebeacon.app/",n.companySlug||"your-company"]})]}),d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"companyEmail",children:"Company Email"}),d.jsx("input",{style:Je.input,id:"companyEmail",name:"companyEmail",type:"email",required:!0,value:n.companyEmail,onChange:y,placeholder:"admin@acme.com"})]})]}),d.jsxs("div",{style:Je.section,children:[d.jsx("h3",{style:Je.sectionTitle,children:"Owner Account"}),d.jsxs("div",{style:Je.grid,children:[d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"ownerFirstName",children:"First Name"}),d.jsx("input",{style:Je.input,id:"ownerFirstName",name:"ownerFirstName",type:"text",required:!0,value:n.ownerFirstName,onChange:y})]}),d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"ownerLastName",children:"Last Name"}),d.jsx("input",{style:Je.input,id:"ownerLastName",name:"ownerLastName",type:"text",required:!0,value:n.ownerLastName,onChange:y})]})]}),d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"ownerEmail",children:"Email Address"}),d.jsx("input",{style:Je.input,id:"ownerEmail",name:"ownerEmail",type:"email",required:!0,value:n.ownerEmail,onChange:y})]}),d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"ownerPassword",children:"Password"}),d.jsx("input",{style:Je.input,id:"ownerPassword",name:"ownerPassword",type:"password",required:!0,minLength:6,value:n.ownerPassword,onChange:y})]})]}),d.jsxs("div",{style:Je.section,children:[d.jsx("h3",{style:Je.sectionTitle,children:"Choose Your Plan"}),d.jsxs("div",{style:Je.formGroup,children:[d.jsx("label",{style:Je.label,htmlFor:"plan",children:"Plan"}),d.jsx("select",{style:Je.select,id:"plan",name:"plan",value:n.plan,onChange:y,children:Object.entries(t).map(([T,E])=>d.jsxs("option",{value:T,children:[T.charAt(0).toUpperCase()+T.slice(1)," - $",E[n.billingInterval],"/",n.billingInterval]},T))})]}),_&&d.jsxs("div",{style:Je.planDetails,children:[d.jsx("h4",{style:{fontWeight:"600",marginBottom:"0.5rem"},children:"Plan Details"}),d.jsxs("ul",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:[d.jsxs("li",{children:[" ",_.limits.users===-1?"Unlimited":_.limits.users," users"]}),d.jsxs("li",{children:[" ",_.limits.projects===-1?"Unlimited":_.limits.projects," projects"]}),d.jsxs("li",{children:[" ",_.limits.storage,"GB storage"]})]}),d.jsxs("div",{style:{marginTop:"0.5rem",fontWeight:"600",color:"var(--text-primary)"},children:["$",b,"/",n.billingInterval," + 14-day free trial"]})]})]}),d.jsx("button",{type:"submit",disabled:r,style:{...Je.button,...r?Je.buttonDisabled:{}},children:r?"Creating Account...":"Start Free Trial"}),d.jsx("a",{href:"/login",style:Je.link,children:"Already have an account? Sign in"})]})})]})},bi=({children:n})=>{const{user:e,isLoading:t}=Xc();return t?d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"var(--text-secondary)"},children:"Loading..."}):!e&&!localStorage.getItem("timebeacon_user")?d.jsx(cb,{to:"/login",replace:!0}):d.jsx(d.Fragment,{children:n})},OE=n=>{const e=[{id:"dashboard",label:"Dashboard",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),d.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),d.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),d.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})},{id:"reports",label:"Analytics & Reports",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M3 3v18h18"}),d.jsx("path",{d:"M18 17V9"}),d.jsx("path",{d:"M13 17V5"}),d.jsx("path",{d:"M8 17v-3"})]})},{id:"ai-insights",label:"AI Control Center",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})},{id:"privacy",label:"Privacy & Data",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),d.jsx("path",{d:"M9 12l2 2 4-4"})]})},{id:"integrations",label:"Integrations",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),d.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}],t=[];n&&["owner","admin","manager"].includes(n)&&t.push({id:"permissions",label:"Team & Permissions",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),d.jsx("circle",{cx:"9",cy:"7",r:"4"}),d.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),d.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),d.jsx("line",{x1:"15",y1:"11",x2:"21",y2:"5"}),d.jsx("circle",{cx:"18",cy:"8",r:"3"})]})});const i={id:"settings",label:"Settings",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return[...e,...t,i]},RE=({activeItem:n,onItemClick:e})=>{const{theme:t,setTheme:i}=xE(),{logout:r,user:s}=Xc(),[l,u]=H.useState(!1),f=()=>{const p=["light","dark","system"],y=(p.indexOf(t)+1)%p.length;i(p[y])},m=()=>{switch(t){case"light":return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]});case"dark":return d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})});case"system":return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",ry:"2"}),d.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),d.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]});default:return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]})}};return d.jsxs("div",{className:`sidebar ${l?"collapsed":""}`,children:[d.jsxs("div",{className:"sidebar-header",children:[d.jsxs("div",{className:"logo-container",children:[d.jsx("div",{className:"logo-icon",children:d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"drop-shadow(0 2px 4px rgba(99, 102, 241, 0.3))"},children:[d.jsx("defs",{children:d.jsxs("linearGradient",{id:"lightning-logo",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:1}}),d.jsx("stop",{offset:"50%",style:{stopColor:"#6366f1",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#3b82f6",stopOpacity:1}})]})}),d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",fill:"url(#lightning-logo)",stroke:"url(#lightning-logo)"})]})}),!l&&d.jsxs("div",{children:[d.jsx("h1",{className:"sidebar-title",children:"TimeBeacon"}),d.jsx("p",{className:"sidebar-subtitle",children:"AI-Powered Privacy-First"})]})]}),d.jsx("button",{className:"collapse-toggle",onClick:()=>u(!l),title:l?"Expand sidebar":"Collapse sidebar",children:l?d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"9,18 15,12 9,6"})}):d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"15,18 9,12 15,6"})})})]}),d.jsxs("nav",{className:"nav-menu",children:[OE(s?.role).map(p=>d.jsxs("a",{href:"#",className:`nav-item ${n===p.id?"active":""}`,onClick:v=>{v.preventDefault(),e(p.id)},title:l?p.label:"",children:[d.jsx("span",{className:"nav-icon",children:p.icon}),!l&&d.jsx("span",{className:"nav-label",children:p.label})]},p.id)),d.jsxs("div",{className:"nav-footer",children:[d.jsxs("button",{className:"theme-toggle",onClick:f,title:l?`Theme: ${t}`:`Current theme: ${t}`,children:[d.jsx("span",{className:"nav-icon",children:m()}),!l&&d.jsx("span",{className:"theme-label",children:t.charAt(0).toUpperCase()+t.slice(1)})]}),!l&&s&&d.jsx("div",{className:"user-info",children:d.jsxs("div",{className:"user-details",children:[d.jsx("span",{className:"user-name",children:s.name}),d.jsx("span",{className:"user-email",children:s.email})]})}),d.jsxs("button",{className:"logout-button",onClick:r,title:l?"Logout":"Sign out",children:[d.jsx("span",{className:"nav-icon",children:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),d.jsx("polyline",{points:"16,17 21,12 16,7"}),d.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})}),!l&&d.jsx("span",{className:"logout-label",children:"Sign Out"})]})]})]})]})},Dm=(n,e)=>{const t=i=>{const[r,s]=i.split(":"),l=parseInt(r),u=l>=12?"PM":"AM";return`${l===0?12:l>12?l-12:l}:${s} ${u}`};return`${t(n)} - ${t(e)}`};class ME{config={ollamaBaseUrl:"http://localhost:11434",model:"llama3.2:latest",maxTokens:512,temperature:.1,confidenceThreshold:.7,enabled:!1};isAvailable=!1;constructor(){this.checkOllamaAvailability()}async checkOllamaAvailability(){try{const e=await fetch(`${this.config.ollamaBaseUrl}/api/tags`);if(e.ok){const i=(await e.json()).models?.some(r=>r.name.includes(this.config.model.split(":")[0]));return this.isAvailable=i,this.config.enabled=i,i?console.log(" Ollama AI service available with model:",this.config.model):console.log(" Ollama available but model not found. Install with:",`ollama pull ${this.config.model}`),this.isAvailable}}catch{console.log(" Ollama not available. Install from https://ollama.com for AI features."),this.isAvailable=!1,this.config.enabled=!1}return!1}async analyzeContent(e){if(!this.isAvailable||!this.config.enabled)return this.fallbackAnalysis(e);try{const t=this.buildAnalysisPrompt(e),i=await this.callOllama(t);return this.parseAnalysisResponse(i,e)}catch(t){return console.error("AI analysis failed:",t),this.fallbackAnalysis(e)}}buildAnalysisPrompt(e){const{title:t,description:i,participants:r,location:s,source:l,context:u}=e,f=u?.projects.map(p=>`${p.name} (${p.client})`).join(", ")||"No projects available",m=u?.clients.map(p=>p.name).join(", ")||"No clients available";return`You are an AI assistant helping categorize work activities for time tracking. Analyze the following activity and suggest appropriate categorization.

ACTIVITY TO ANALYZE:
Title: ${t}
Description: ${i||"No description"}
Participants: ${r?.join(", ")||"Not specified"}
Location: ${s||"Not specified"}
Source: ${l}

AVAILABLE CONTEXT:
Projects: ${f}
Clients: ${m}

INSTRUCTIONS:
1. Suggest the most appropriate project and client from the available options
2. Determine if this is billable work (client work = billable, internal = non-billable)
3. Categorize as: client, internal, admin, sales, or marketing
4. If it's a meeting, classify type: kickoff, discovery, implementation, support, training, check-in, or escalation
5. Extract relevant tags or keywords
6. Provide your confidence level (0.0 to 1.0)
7. Explain your reasoning briefly

RESPOND IN THIS EXACT JSON FORMAT:
{
  "confidence": 0.85,
  "suggestedProject": "Project Name",
  "suggestedClient": "Client Name",
  "suggestedDescription": "Enhanced description if needed",
  "suggestedCategory": "client",
  "suggestedBillable": true,
  "meetingType": "implementation",
  "tags": ["keyword1", "keyword2"],
  "reasoning": "Brief explanation of categorization logic"
}

Only respond with valid JSON. If uncertain, lower the confidence score.`}async callOllama(e){const t=await fetch(`${this.config.ollamaBaseUrl}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.config.model,prompt:e,stream:!1,options:{temperature:this.config.temperature,num_predict:this.config.maxTokens}})});if(!t.ok)throw new Error(`Ollama API error: ${t.status}`);return(await t.json()).response}parseAnalysisResponse(e,t){try{const i=e.match(/\{[\s\S]*\}/);if(!i)throw new Error("No JSON found in response");const r=JSON.parse(i[0]);return{confidence:Math.max(0,Math.min(1,r.confidence||.5)),suggestedProject:this.validateProject(r.suggestedProject,t.context?.projects),suggestedClient:this.validateClient(r.suggestedClient,t.context?.clients),suggestedDescription:r.suggestedDescription||t.title,suggestedCategory:this.validateCategory(r.suggestedCategory),suggestedBillable:!!r.suggestedBillable,meetingType:this.validateMeetingType(r.meetingType),tags:Array.isArray(r.tags)?r.tags.slice(0,5):[],reasoning:r.reasoning||"AI analysis completed"}}catch(i){return console.error("Failed to parse AI response:",i),this.fallbackAnalysis(t)}}validateProject(e,t){if(!e||!t)return;const i=t.find(s=>s.name.toLowerCase()===e.toLowerCase());return i?i.name:t.find(s=>s.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(s.name.toLowerCase()))?.name}validateClient(e,t){if(!e||!t)return;const i=t.find(s=>s.name.toLowerCase()===e.toLowerCase());return i?i.name:t.find(s=>s.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(s.name.toLowerCase()))?.name}validateCategory(e){return["client","internal","admin","meeting"].includes(e)?e:"client"}validateMeetingType(e){return e&&["kickoff","discovery","implementation","support","training","check-in","escalation"].includes(e)?e:void 0}fallbackAnalysis(e){const t=e.title.toLowerCase(),i=e.description?.toLowerCase()||"";let r="client",s=!0,l;t.includes("internal")||t.includes("team")||t.includes("standup")?(r="internal",s=!1):t.includes("meeting")||t.includes("demo")?r="meeting":(t.includes("admin")||t.includes("setup")||t.includes("configuration"))&&(r="admin",s=!1),t.includes("kickoff")?l="kickoff":t.includes("discovery")?l="discovery":t.includes("implementation")?l="implementation":t.includes("support")?l="support":t.includes("training")?l="training":(t.includes("check-in")||t.includes("checkin"))&&(l="check-in");const u=this.findClientByKeywords(t+" "+i,e.context?.clients);return{confidence:.6,suggestedProject:this.findProjectByKeywords(t+" "+i,e.context?.projects),suggestedClient:u,suggestedDescription:e.title,suggestedCategory:r,suggestedBillable:s,meetingType:l,tags:this.extractKeywords(t+" "+i),reasoning:"Rule-based analysis (AI not available)"}}findClientByKeywords(e,t){if(t)return t.find(i=>e.toLowerCase().includes(i.name.toLowerCase()))?.name}findProjectByKeywords(e,t){if(t)return t.find(i=>e.toLowerCase().includes(i.name.toLowerCase())||e.toLowerCase().includes(i.client.toLowerCase()))?.name}extractKeywords(e){const t=e.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(i=>i.length>3).filter(i=>!["with","from","this","that","will","have","been","they","them","were"].includes(i));return[...new Set(t)].slice(0,5)}updateConfig(e){this.config={...this.config,...e},(e.ollamaBaseUrl||e.model)&&this.checkOllamaAvailability()}getStatus(){return{available:this.isAvailable,model:this.config.model,enabled:this.config.enabled}}async testService(){const e=Date.now();try{const t={title:"Team standup meeting",description:"Daily team sync with engineering",source:"calendar",timestamp:new Date().toISOString(),context:{projects:[{id:"1",name:"Internal Tools",client:"Internal",color:"#000",active:!0,createdAt:""}],clients:[{id:"1",name:"Internal",color:"#000",active:!0,createdAt:"",updatedAt:""}],recentEntries:[]}},i=await this.analyzeContent(t),r=Date.now()-e;return{success:i.confidence>0,latency:r}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown error"}}}}const bc=new ME;class LE{db=null;dbName="TimeBeaconDB";version=1;stores=["timeEntries","projects","clients","settings","syncMetadata"];constructor(){this.init()}async init(){return typeof indexedDB>"u"?(console.warn("IndexedDB not available (likely in test environment)"),Promise.resolve()):new Promise((e,t)=>{const i=indexedDB.open(this.dbName,this.version);i.onerror=r=>{console.error("Database failed to open:",r),console.log(" Database issue detected. Please refresh the page or clear browser cache."),t(new Error("Failed to open database"))},i.onsuccess=()=>{this.db=i.result,console.log(" TimeBeacon Database initialized"),e()},i.onupgradeneeded=r=>{const s=r.target.result;if(!s.objectStoreNames.contains("timeEntries")){const l=s.createObjectStore("timeEntries",{keyPath:"id"});l.createIndex("date","date",{unique:!1}),l.createIndex("project","project",{unique:!1}),l.createIndex("client","client",{unique:!1}),l.createIndex("status","status",{unique:!1})}if(!s.objectStoreNames.contains("projects")){const l=s.createObjectStore("projects",{keyPath:"id"});l.createIndex("name","name",{unique:!0}),l.createIndex("client","client",{unique:!1})}s.objectStoreNames.contains("clients")||s.createObjectStore("clients",{keyPath:"id"}).createIndex("name","name",{unique:!0}),s.objectStoreNames.contains("settings")||s.createObjectStore("settings",{keyPath:"key"}),s.objectStoreNames.contains("syncMetadata")||s.createObjectStore("syncMetadata",{keyPath:"id"}),console.log(" Database schema created")}})}async performOperation(e,t,i="readonly"){return this.db||await this.init(),this.db?new Promise((r,s)=>{const u=this.db.transaction([e],i).objectStore(e),f=t(u);f.onsuccess=()=>r(f.result),f.onerror=()=>s(f.error)}):i==="readwrite"?Promise.resolve():Promise.resolve(null)}async addTimeEntry(e){await this.performOperation("timeEntries",t=>t.add(e),"readwrite"),console.log(" Time entry added:",e.id)}async updateTimeEntry(e,t){const i=await this.getTimeEntry(e);if(!i)throw new Error(`Time entry ${e} not found`);const r={...i,...t};await this.performOperation("timeEntries",s=>s.put(r),"readwrite"),console.log(" Time entry updated:",e)}async deleteTimeEntry(e){await this.performOperation("timeEntries",t=>t.delete(e),"readwrite"),console.log(" Time entry deleted:",e)}async getTimeEntry(e){return await this.performOperation("timeEntries",i=>i.get(e))||null}async getAllTimeEntries(){return await this.performOperation("timeEntries",t=>t.getAll())||[]}async getTimeEntriesByDateRange(e,t){return(await this.getAllTimeEntries()).filter(r=>r.date>=e&&r.date<=t)}async addProject(e){await this.performOperation("projects",t=>t.add(e),"readwrite"),console.log(" Project added:",e.name)}async updateProject(e,t){const i=await this.getProject(e);if(!i)throw new Error(`Project ${e} not found`);const r={...i,...t};await this.performOperation("projects",s=>s.put(r),"readwrite"),console.log(" Project updated:",e)}async deleteProject(e){await this.performOperation("projects",t=>t.delete(e),"readwrite"),console.log(" Project deleted:",e)}async getProject(e){return await this.performOperation("projects",i=>i.get(e))||null}async getAllProjects(){return await this.performOperation("projects",t=>t.getAll())||[]}async addClient(e){await this.performOperation("clients",t=>t.add(e),"readwrite"),console.log(" Client added:",e.name)}async updateClient(e,t){const i=await this.getClient(e);if(!i)throw new Error(`Client ${e} not found`);const r={...i,...t};await this.performOperation("clients",s=>s.put(r),"readwrite"),console.log(" Client updated:",e)}async deleteClient(e){await this.performOperation("clients",t=>t.delete(e),"readwrite"),console.log(" Client deleted:",e)}async getClient(e){return await this.performOperation("clients",i=>i.get(e))||null}async getAllClients(){return await this.performOperation("clients",t=>t.getAll())||[]}async updateSettings(e){await this.performOperation("settings",t=>t.put({key:"userSettings",value:e}),"readwrite"),console.log(" Settings updated")}async getSettings(){return(await this.performOperation("settings",t=>t.get("userSettings")))?.value||null}async updateSyncMetadata(e){await this.performOperation("syncMetadata",t=>t.put({id:"sync",...e}),"readwrite")}async getSyncMetadata(){return await this.performOperation("syncMetadata",t=>t.get("sync"))||null}async exportAllData(){const[e,t,i,r,s]=await Promise.all([this.getAllTimeEntries(),this.getAllProjects(),this.getAllClients(),this.getSettings(),this.getSyncMetadata()]);return{timeEntries:e,projects:t,clients:i,settings:r||{},syncMetadata:s||{lastSync:"",version:1,deviceId:crypto.randomUUID()}}}async importData(e){const t=this.db.transaction(this.stores,"readwrite");try{if(e.timeEntries){const i=t.objectStore("timeEntries");for(const r of e.timeEntries)await new Promise((s,l)=>{const u=i.put(r);u.onsuccess=()=>s(void 0),u.onerror=()=>l(u.error)})}if(e.projects){const i=t.objectStore("projects");for(const r of e.projects)await new Promise((s,l)=>{const u=i.put(r);u.onsuccess=()=>s(void 0),u.onerror=()=>l(u.error)})}if(e.clients){const i=t.objectStore("clients");for(const r of e.clients)await new Promise((s,l)=>{const u=i.put(r);u.onsuccess=()=>s(void 0),u.onerror=()=>l(u.error)})}console.log(" Data import completed")}catch(i){throw console.error(" Data import failed:",i),i}}async clearAllData(){const e=this.db.transaction(this.stores,"readwrite");for(const t of this.stores){const i=e.objectStore(t);await new Promise((r,s)=>{const l=i.clear();l.onsuccess=()=>r(void 0),l.onerror=()=>s(l.error)})}console.log(" All data cleared")}async getStats(){const[e,t,i]=await Promise.all([this.getAllTimeEntries(),this.getAllProjects(),this.getAllClients()]),s=`${(JSON.stringify({timeEntries:e,projects:t,clients:i}).length/1024).toFixed(2)} KB`;return{timeEntries:e.length,projects:t.length,clients:i.length,dbSize:s}}}const Pt=new LE;class IE{processingQueue=[];isProcessing=!1;analysisCache=new Map;constructor(){setInterval(()=>this.processQueue(),3e4)}async addActivity(e){this.processingQueue.push(e),console.log(` Added activity for analysis: ${e.title}`),(this.processingQueue.length>=5||this.isHighPriority(e))&&await this.processQueue()}async processQueue(){if(!(this.isProcessing||this.processingQueue.length===0)){this.isProcessing=!0,console.log(` Processing ${this.processingQueue.length} activities...`);try{const e=await this.buildAnalysisContext(),t=[...this.processingQueue];this.processingQueue=[];for(const i of t)await this.analyzeActivity(i,e)}catch(e){console.error("Content analysis failed:",e)}finally{this.isProcessing=!1}}}async analyzeActivity(e,t){try{const i=this.getCacheKey(e);let r=this.analysisCache.get(i);if(!r){const s={title:e.title,description:e.description,participants:e.participants,location:e.location,source:e.source,timestamp:e.timestamp,context:{projects:t.projects,clients:t.clients,recentEntries:t.recentEntries.slice(0,10)}};r=await bc.analyzeContent(s),this.analysisCache.set(i,r),setTimeout(()=>this.analysisCache.delete(i),36e5)}r.confidence>=.5?await this.createSuggestion(e,r,t):console.log(` Low confidence (${r.confidence}) for activity: ${e.title}`)}catch(i){console.error(`Failed to analyze activity ${e.id}:`,i)}}async createSuggestion(e,t,i){const r={id:`suggestion-${e.id}-${Date.now()}`,analysisId:`analysis-${e.id}`,source:e.source,suggestedDate:e.startTime.split("T")[0],suggestedStartTime:this.extractTime(e.startTime),suggestedDuration:this.calculateDuration(e,t),suggestedProject:t.suggestedProject||"Unknown Project",suggestedClient:t.suggestedClient||"Unknown Client",suggestedDescription:t.suggestedDescription||e.title,suggestedTags:t.tags||[],confidence:t.confidence,basedOnDataFrom:[e.source],generatedAt:new Date().toISOString(),status:"pending"};await this.storeSuggestion(r),console.log(` Created suggestion: ${r.suggestedProject} - ${r.suggestedDescription} (${Math.round(r.confidence*100)}% confidence)`),t.confidence>=i.userPreferences.autoApproveThreshold&&await this.autoApproveSuggestion(r)}calculateDuration(e,t){if(e.duration)return e.duration;if(e.startTime&&e.endTime){const r=new Date(e.startTime);return(new Date(e.endTime).getTime()-r.getTime())/(1e3*60*60)}const i=e.title.toLowerCase();return i.includes("standup")||i.includes("daily")?.25:i.includes("check-in")||i.includes("quick")?.5:i.includes("kickoff")||i.includes("discovery")?2:i.includes("training")||i.includes("workshop")?4:1}extractTime(e){return new Date(e).toTimeString().slice(0,5)}async buildAnalysisContext(){const[e,t,i]=await Promise.all([Pt.getAllProjects(),Pt.getAllClients(),Pt.getAllTimeEntries()]),r=new Date;r.setDate(r.getDate()-30);const s=i.filter(l=>new Date(l.date)>=r).sort((l,u)=>new Date(u.date).getTime()-new Date(l.date).getTime());return{projects:e.filter(l=>l.active),clients:t.filter(l=>l.active),recentEntries:s.slice(0,50),userPreferences:{defaultDuration:1,autoApproveThreshold:.85,preferredCategories:["client","implementation"]}}}async storeSuggestion(e){const t=this.getStoredSuggestions();t.push(e),localStorage.setItem("timebeacon_suggestions",JSON.stringify(t))}getStoredSuggestions(){try{const e=localStorage.getItem("timebeacon_suggestions");return e?JSON.parse(e):[]}catch{return[]}}async updateSuggestion(e,t){const i=this.getStoredSuggestions(),r=i.findIndex(s=>s.id===e);r>=0&&(i[r]={...i[r],...t},localStorage.setItem("timebeacon_suggestions",JSON.stringify(i)))}async approveSuggestion(e,t){const r=this.getStoredSuggestions().find(l=>l.id===e);if(!r)throw new Error("Suggestion not found");const s={date:r.suggestedDate,startTime:r.suggestedStartTime,endTime:this.calculateEndTime(r.suggestedStartTime,r.suggestedDuration),duration:r.suggestedDuration,client:r.suggestedClient,project:r.suggestedProject,description:r.suggestedDescription,category:"client",status:"pending",automated:!0,source:"ai_suggested",billable:!0,tags:r.suggestedTags,generatedFromSuggestion:r.id,aiConfidence:r.confidence,dataSourcesUsed:r.basedOnDataFrom,...t};await Pt.addTimeEntry({...s,id:crypto.randomUUID()}),await this.updateSuggestion(e,{status:"approved",approvedAt:new Date().toISOString()}),console.log(` Approved suggestion and created time entry: ${r.suggestedProject}`)}async rejectSuggestion(e,t){await this.updateSuggestion(e,{status:"rejected",rejectedAt:new Date().toISOString(),rejectionReason:t}),console.log(` Rejected suggestion: ${t}`)}async autoApproveSuggestion(e){try{await this.approveSuggestion(e.id),console.log(` Auto-approved high confidence suggestion: ${e.suggestedProject}`)}catch(t){console.error("Auto-approval failed:",t)}}calculateEndTime(e,t){const[i,r]=e.split(":").map(Number),s=i*60+r+t*60,l=Math.floor(s/60)%24,u=s%60;return`${l.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}isHighPriority(e){const t=e.title.toLowerCase();return t.includes("urgent")||t.includes("escalation")||t.includes("emergency")}getCacheKey(e){return`${e.source}-${e.title}-${e.startTime}`}async clearOldSuggestions(e=30){const t=this.getStoredSuggestions(),i=new Date;i.setDate(i.getDate()-e);const r=t.filter(s=>new Date(s.generatedAt)>i||s.status==="pending");localStorage.setItem("timebeacon_suggestions",JSON.stringify(r)),console.log(` Cleaned up ${t.length-r.length} old suggestions`)}getStats(){const e=this.getStoredSuggestions(),t=e.filter(i=>i.status==="pending");return{queueLength:this.processingQueue.length,isProcessing:this.isProcessing,cacheSize:this.analysisCache.size,totalSuggestions:e.length,pendingSuggestions:t.length}}}const Fs=new IE,qv={};class PE{oauth2Client;config;STORAGE_KEY="timebeacon_google_auth";constructor(){this.config={clientId:qv?.VITE_GOOGLE_CLIENT_ID||"",clientSecret:qv?.VITE_GOOGLE_CLIENT_SECRET||"",redirectUri:`${typeof window<"u"?window.location?.origin:"http://localhost:3000"}/auth/google/callback`,scopes:["https://www.googleapis.com/auth/calendar.readonly","https://www.googleapis.com/auth/userinfo.email"]},this.initializeOAuth2Client()}initializeOAuth2Client(){console.log("Google Calendar auth disabled for production")}getAuthUrl(){return this.oauth2Client.generateAuthUrl({access_type:"offline",scope:this.config.scopes,prompt:"consent"})}async exchangeCodeForTokens(e){try{const{tokens:t}=await this.oauth2Client.getToken(e);return this.oauth2Client.setCredentials(t),this.storeTokens(t),console.log(" Google Calendar authentication successful"),{success:!0}}catch(t){return console.error("Google Calendar auth failed:",t),{success:!1,error:t instanceof Error?t.message:"Authentication failed"}}}isAuthenticated(){const e=this.getStoredTokens();return!!(e&&e.access_token)}getCalendarClient(){return console.warn("Google Calendar disabled in production"),null}async refreshAccessToken(){try{const e=this.getStoredTokens();if(!e||!e.refresh_token)return console.log("No refresh token available, need to re-authenticate"),!1;this.oauth2Client.setCredentials(e);const{credentials:t}=await this.oauth2Client.refreshAccessToken(),i={...e,...t};return this.storeTokens(i),this.oauth2Client.setCredentials(i),console.log(" Google Calendar token refreshed"),!0}catch(e){return console.error("Failed to refresh token:",e),this.clearStoredTokens(),!1}}async testConnection(){try{if(!this.isAuthenticated())return{success:!1,error:"Not authenticated"};const e=this.getStoredTokens();return e&&e.expiry_date&&e.expiry_date<Date.now()&&!await this.refreshAccessToken()?{success:!1,error:"Token refresh failed"}:{success:!0,userEmail:{data:{email:"disabled@example.com"}}.data.email||void 0}}catch(e){return console.error("Google Calendar connection test failed:",e),{success:!1,error:e instanceof Error?e.message:"Connection test failed"}}}signOut(){this.clearStoredTokens(),this.oauth2Client.setCredentials({}),console.log(" Signed out from Google Calendar")}async getUserInfo(){try{if(!this.isAuthenticated())return null;const e={data:{email:"disabled@example.com",name:"Google Auth Disabled"}};return{email:e.data.email||void 0,name:e.data.name||void 0}}catch(e){return console.error("Failed to get user info:",e),null}}storeTokens(e){try{typeof window<"u"&&window.localStorage&&localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){console.error("Failed to store auth tokens:",t)}}getStoredTokens(){try{if(typeof window<"u"&&window.localStorage){const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):null}return null}catch(e){return console.error("Failed to load stored tokens:",e),null}}clearStoredTokens(){try{typeof window<"u"&&window.localStorage&&localStorage.removeItem(this.STORAGE_KEY)}catch(e){console.error("Failed to clear stored tokens:",e)}}isConfigured(){return!!(this.config.clientId&&this.config.clientSecret)}getOAuth2Client(){return this.oauth2Client}}const Nm=new PE;class BE{config={enabled:!1,autoTrackMeetings:!0,minimumDuration:15,excludeAllDay:!0,excludePersonal:!0,excludeCalendars:[],includeCalendars:[],trackingKeywords:["meeting","call","sync","review","demo","training"],excludeKeywords:["personal","lunch","break","vacation","holiday","blocked"]};lastSyncTimestamp=null;processedEvents=new Set;constructor(){this.loadConfig(),this.config.enabled&&this.startBackgroundSync()}async initialize(){try{return await this.checkCalendarAccess()?(this.config.enabled=!0,this.saveConfig(),this.startBackgroundSync(),console.log(" Calendar integration initialized"),{success:!0}):{success:!1,error:"Calendar access not available. Please enable calendar integration in settings."}}catch(e){return console.error("Calendar initialization failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async checkCalendarAccess(){return!0}startBackgroundSync(){setInterval(()=>{this.syncCalendarEvents()},5*60*1e3),this.syncCalendarEvents()}async syncCalendarEvents(){if(this.config.enabled)try{console.log(" Syncing calendar events...");const t=(await this.fetchCalendarEvents()).filter(i=>!this.processedEvents.has(i.id));console.log(`Found ${t.length} new calendar events to process`);for(const i of t)this.shouldProcessEvent(i)&&(await this.processCalendarEvent(i),this.processedEvents.add(i.id));this.lastSyncTimestamp=new Date().toISOString(),this.saveConfig()}catch(e){console.error("Calendar sync failed:",e)}}async fetchCalendarEvents(){try{if(!Nm.isAuthenticated())return console.log("Not authenticated with Google Calendar, using mock data"),this.getMockEvents();const e=await Nm.testConnection();if(!e.success)return console.log("Google Calendar connection failed, using mock data:",e.error),this.getMockEvents();let t;try{t=Nm.getCalendarClient()}catch(f){return console.warn("Calendar client not available:",f),[]}if(!t)return console.warn("Calendar client not available"),[];const i=new Date;i.setHours(i.getHours()-24);const r=new Date,s=await t.events.list({calendarId:"primary",timeMin:i.toISOString(),timeMax:r.toISOString(),maxResults:50,singleEvents:!0,orderBy:"startTime"});if(!s||!s.data)return console.warn("No response data from Google Calendar API"),[];const u=(s.data.items||[]).map(f=>({id:f.id||"",title:f.summary||"Untitled Event",description:f.description||void 0,start:f.start?.dateTime||f.start?.date||new Date().toISOString(),end:f.end?.dateTime||f.end?.date||new Date().toISOString(),attendees:f.attendees?.map(m=>m.email||"")||[],location:f.location||void 0,organizer:f.organizer?.email||void 0,status:this.mapEventStatus(f.status||void 0),isAllDay:!!f.start?.date,recurrence:f.recurrence?.join(", ")||void 0,calendarId:"primary",calendarName:"Google Calendar"})).filter(f=>f.start&&f.end);return console.log(` Fetched ${u.length} events from Google Calendar`),u}catch(e){return console.error("Failed to fetch Google Calendar events:",e),console.log("Falling back to mock data"),this.getMockEvents()}}getMockEvents(){return[{id:"event-1",title:"Client Discovery Call - Acme Corp",description:"Initial discovery session to understand requirements",start:new Date(Date.now()-72e5).toISOString(),end:new Date(Date.now()-36e5).toISOString(),attendees:["john@acme.com","sarah@acme.com"],location:"Zoom",status:"confirmed",calendarId:"primary",calendarName:"Work Calendar"},{id:"event-2",title:"Team Standup",description:"Daily team sync",start:new Date(Date.now()-18e5).toISOString(),end:new Date(Date.now()-9e5).toISOString(),attendees:["team@company.com"],status:"confirmed",calendarId:"primary",calendarName:"Work Calendar"}].filter(t=>new Date(t.end)<new Date)}mapEventStatus(e){switch(e){case"confirmed":return"confirmed";case"tentative":return"tentative";case"cancelled":return"cancelled";default:return"confirmed"}}shouldProcessEvent(e){if(this.processedEvents.has(e.id)||e.status==="cancelled"||e.isAllDay&&this.config.excludeAllDay||(new Date(e.end).getTime()-new Date(e.start).getTime())/(1e3*60)<this.config.minimumDuration||this.config.includeCalendars.length>0&&!this.config.includeCalendars.includes(e.calendarId)||this.config.excludeCalendars.includes(e.calendarId))return!1;const i=`${e.title} ${e.description||""}`.toLowerCase();return this.config.excludeKeywords.some(r=>i.includes(r))?!1:this.config.trackingKeywords.length>0?this.config.trackingKeywords.some(r=>i.includes(r)):!0}async processCalendarEvent(e){try{const t={id:`calendar-${e.id}`,title:e.title,description:e.description,startTime:e.start,endTime:e.end,duration:this.calculateDuration(e.start,e.end),participants:e.attendees,location:e.location,source:"calendar",sourceId:e.id,timestamp:e.start,rawData:e};await Fs.addActivity(t),console.log(` Processed calendar event: ${e.title}`)}catch(t){console.error(`Failed to process calendar event ${e.id}:`,t)}}calculateDuration(e,t){const i=new Date(e);return(new Date(t).getTime()-i.getTime())/(1e3*60*60)}updateConfig(e){this.config={...this.config,...e},this.saveConfig(),e.enabled!==void 0&&e.enabled&&!this.config.enabled&&this.startBackgroundSync()}getConfig(){return{...this.config}}getStatus(){return{enabled:this.config.enabled,lastSync:this.lastSyncTimestamp,processedEventsCount:this.processedEvents.size,isConnected:this.config.enabled}}async forceSync(){try{const e=this.processedEvents.size;return await this.syncCalendarEvents(),{success:!0,eventsProcessed:this.processedEvents.size-e}}catch(e){return{success:!1,eventsProcessed:0,error:e instanceof Error?e.message:"Sync failed"}}}clearHistory(){this.processedEvents.clear(),this.lastSyncTimestamp=null,this.saveConfig(),console.log(" Cleared calendar sync history")}loadConfig(){try{const e=localStorage.getItem("timebeacon_calendar_config");if(e){const t=JSON.parse(e);this.config={...this.config,...t};const i=localStorage.getItem("timebeacon_processed_events");i&&(this.processedEvents=new Set(JSON.parse(i))),this.lastSyncTimestamp=localStorage.getItem("timebeacon_last_sync")}}catch(e){console.error("Failed to load calendar config:",e)}}saveConfig(){try{localStorage.setItem("timebeacon_calendar_config",JSON.stringify(this.config)),localStorage.setItem("timebeacon_processed_events",JSON.stringify([...this.processedEvents])),this.lastSyncTimestamp&&localStorage.setItem("timebeacon_last_sync",this.lastSyncTimestamp)}catch(e){console.error("Failed to save calendar config:",e)}}async testConnection(){try{return{success:!0,eventsFound:(await this.fetchCalendarEvents()).length}}catch(e){return{success:!1,eventsFound:0,error:e instanceof Error?e.message:"Connection test failed"}}}}const Ps=new BE,FE=()=>{const[n,e]=H.useState([]),[t,i]=H.useState(!1),[r,s]=H.useState(null),l=async()=>{i(!0),s(null);try{const m=await Ps.forceSync();m.success?(console.log(`Calendar sync completed. Processed ${m.eventsProcessed} new events.`),e([])):s(m.error||"Failed to sync calendar events")}catch(m){s(m instanceof Error?m.message:"Failed to fetch calendar events")}finally{i(!1)}},u=m=>n.filter(p=>new Date(p.start).toISOString().split("T")[0]===m),f=()=>Ps.getStatus();return H.useEffect(()=>{l();const m=setInterval(l,5*60*1e3);return()=>clearInterval(m)},[]),{events:n,isLoading:t,error:r,fetchEvents:l,getEventsForDate:u,getIntegrationStatus:f}},ep=[{id:"1",name:"Enterprise CRM Implementation",client:"Salesforce",clientId:"1",color:"#00a1e0",rate:285,description:"Full Salesforce deployment for global enterprise sales team",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-01-15",expectedEndDate:"2025-05-30",createdAt:"2025-01-15"},{id:"2",name:"Marketing Automation Platform",client:"HubSpot",clientId:"2",color:"#ff7a59",rate:265,description:"HubSpot marketing automation setup for lead nurturing campaigns",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-02-01",expectedEndDate:"2025-06-15",createdAt:"2025-02-01"},{id:"3",name:"Customer Support Portal Migration",client:"Zendesk",clientId:"3",color:"#03363d",rate:225,description:"Migrate legacy support system to Zendesk with custom workflows",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-12-01",expectedEndDate:"2025-04-15",createdAt:"2025-12-01"},{id:"4",name:"Project Management Rollout",client:"Monday.com",clientId:"4",color:"#ff3d57",rate:195,description:"Monday.com deployment across 15 departments with custom workflows",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-03-15",expectedEndDate:"2025-04-30",createdAt:"2025-03-05"},{id:"5",name:"Identity & Access Management",client:"Okta",clientId:"5",color:"#007dc1",rate:295,description:"Okta SSO implementation with multi-factor authentication",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-08-12",expectedEndDate:"2025-02-28",createdAt:"2025-08-12"},{id:"6",name:"Enterprise Communication Platform",client:"Slack",clientId:"6",color:"#4a154b",rate:275,description:"Slack Enterprise Grid setup for 5,000+ employees",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-09-18",expectedEndDate:"2025-03-31",createdAt:"2025-09-18"},{id:"7",name:"Digital Signature Workflow",client:"DocuSign",clientId:"7",color:"#ffb900",rate:215,description:"DocuSign integration with existing contract management system",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-01-25",expectedEndDate:"2025-05-15",createdAt:"2025-01-25"},{id:"8",name:"Video Communications Platform",client:"Zoom",clientId:"8",color:"#2d8cff",rate:255,description:"Zoom Enterprise deployment with webinar and phone integration",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-12-08",expectedEndDate:"2025-04-30",createdAt:"2025-12-08"},{id:"9",name:"Developer Toolchain Modernization",client:"Atlassian",clientId:"9",color:"#0052cc",rate:270,description:"Atlassian suite implementation: Jira, Confluence, Bitbucket",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-10-14",expectedEndDate:"2025-03-31",createdAt:"2025-10-14"},{id:"10",name:"Communication API Integration",client:"Twilio",clientId:"10",color:"#f22f46",rate:235,description:"Twilio API integration for SMS/voice notifications",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-02-12",expectedEndDate:"2025-05-30",createdAt:"2025-02-12"},{id:"11",name:"Internal Operations",client:"Internal",clientId:"11",color:"#6b7280",rate:0,description:"Internal meetings, team development, and administrative tasks",category:"ongoing-support",status:"active",active:!0,billable:!1,startDate:"2025-01-01",createdAt:"2025-01-01"}],zE=[{id:"1",name:"google-calendar",enabled:!0,connectedAt:"2024-01-10T10:00:00Z",lastSync:"2024-06-28T14:30:00Z",settings:{autoCreateEntries:!0,defaultCategory:"client",syncCalendars:["primary","work@company.com"]}},{id:"2",name:"slack",enabled:!0,connectedAt:"2024-01-10T10:00:00Z",lastSync:"2024-06-28T14:25:00Z",settings:{trackDMs:!0,trackChannels:["#customer-success","#implementations"],minimumDuration:5}},{id:"3",name:"zoom",enabled:!0,connectedAt:"2024-01-12T09:00:00Z",lastSync:"2024-06-28T13:45:00Z",settings:{autoTrackMeetings:!0,excludePersonalMeetings:!0}},{id:"4",name:"teams",enabled:!1,settings:{}},{id:"5",name:"salesforce",enabled:!0,connectedAt:"2024-02-01T11:00:00Z",lastSync:"2024-06-28T15:00:00Z",settings:{syncOpportunities:!0,autoCreateProjects:!0}}],tp=[{id:"1",date:"2025-07-13",startTime:"09:00",endTime:"10:30",duration:1.5,client:"Salesforce",project:"Enterprise CRM Implementation",description:"Project kickoff with Salesforce stakeholders - scope and timeline review",category:"client",status:"pending",automated:!0,source:"calendar",meetingType:"kickoff",billable:!0,rate:285,tags:["kickoff","stakeholders","planning"]},{id:"2",date:"2025-07-13",startTime:"10:45",endTime:"11:15",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"1:1 with manager Jessica - quarterly goal alignment and feedback",category:"internal",status:"pending",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["1:1","manager","goals","feedback"]},{id:"3",date:"2025-07-13",startTime:"13:00",endTime:"14:00",duration:1,client:"HubSpot",project:"Marketing Automation Platform",description:"Discovery session with HubSpot marketing team for lead scoring workflows",category:"client",status:"pending",automated:!0,source:"zoom",meetingType:"discovery",billable:!0,rate:265,tags:["discovery","marketing","lead-scoring"]},{id:"4",date:"2025-07-13",startTime:"15:30",endTime:"16:30",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"All-hands company meeting - Q2 results and new product roadmap",category:"internal",status:"pending",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["all-hands","q2-results","roadmap"]},{id:"5",date:"2025-07-12",startTime:"09:00",endTime:"10:00",duration:1,client:"Zendesk",project:"Customer Support Portal Migration",description:"Technical requirements review with Zendesk integration team",category:"client",status:"submitted",automated:!0,source:"calendar",meetingType:"discovery",billable:!0,rate:225,tags:["technical","requirements","integration"]},{id:"6",date:"2025-07-12",startTime:"10:30",endTime:"11:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Daily standup - sprint retrospective and planning for next iteration",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["standup","sprint","retrospective"]},{id:"7",date:"2025-07-12",startTime:"14:00",endTime:"15:30",duration:1.5,client:"Monday.com",project:"Project Management Rollout",description:"Training session for department heads on Monday.com workflows",category:"client",status:"submitted",automated:!0,source:"zoom",meetingType:"training",billable:!0,rate:195,tags:["training","workflows","department-heads"]},{id:"8",date:"2025-07-11",startTime:"16:00",endTime:"16:45",duration:.75,client:"Okta",project:"Identity & Access Management",description:"Slack discussion thread - troubleshooting SSO configuration issues",category:"client",status:"submitted",automated:!0,source:"slack",billable:!0,rate:295,tags:["support","sso","troubleshooting"]},{id:"9",date:"2025-07-10",startTime:"09:00",endTime:"10:30",duration:1.5,client:"Slack Technologies",project:"Enterprise Communication Platform",description:"Monthly business review with Slack executive team",category:"client",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!0,rate:275,tags:["mbr","executive","monthly-review"]},{id:"10",date:"2025-07-10",startTime:"11:00",endTime:"12:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Customer Success team standup - pipeline review and account updates",category:"internal",status:"approved",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["cs-team","pipeline","accounts"]},{id:"11",date:"2025-07-10",startTime:"13:30",endTime:"14:30",duration:1,client:"DocuSign",project:"Digital Signature Workflow",description:"Implementation planning session with DocuSign product team",category:"client",status:"approved",automated:!0,source:"zoom",meetingType:"implementation",billable:!0,rate:215,tags:["implementation","planning","product-team"]},{id:"12",date:"2025-07-10",startTime:"15:30",endTime:"16:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Expense report submission and timesheet review",category:"admin",status:"approved",automated:!1,billable:!1,tags:["admin","expenses","timesheet"]},{id:"13",date:"2025-07-09",startTime:"10:00",endTime:"11:30",duration:1.5,client:"Zoom Video Communications",project:"Video Communications Platform",description:"Training session with Zoom admins on enterprise features and webinars",category:"client",status:"approved",automated:!0,source:"zoom",meetingType:"training",billable:!0,rate:255,tags:["training","enterprise","webinars"]},{id:"14",date:"2025-07-09",startTime:"14:00",endTime:"15:00",duration:1,client:"Atlassian",project:"Developer Toolchain Modernization",description:"Escalation call with Atlassian CTO - critical integration blockers",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"escalation",billable:!0,rate:270,tags:["escalation","cto","blockers"]},{id:"15",date:"2025-07-09",startTime:"16:30",endTime:"17:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"1:1 with direct report Alex - career development and project assignments",category:"internal",status:"approved",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["1:1","direct-report","career-development"]},{id:"16",date:"2025-07-08",startTime:"09:00",endTime:"09:30",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Daily team standup - sprint planning and impediment review",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["standup","sprint","impediments"]},{id:"17",date:"2025-07-08",startTime:"11:00",endTime:"12:00",duration:1,client:"Twilio",project:"Communication API Integration",description:"Discovery session for SMS and voice notification requirements",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"discovery",billable:!0,rate:235,tags:["discovery","sms","voice","notifications"]},{id:"18",date:"2025-07-08",startTime:"15:00",endTime:"16:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Engineering sync - technical debt review and architecture decisions",category:"internal",status:"approved",automated:!0,source:"slack",meetingType:"check-in",billable:!1,tags:["engineering","tech-debt","architecture"]},{id:"19",date:"2025-07-07",startTime:"09:30",endTime:"10:30",duration:1,client:"HubSpot",project:"Marketing Automation Platform",description:"Support escalation - campaign automation not triggering properly",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"support",billable:!0,rate:265,tags:["support","automation","campaigns"]},{id:"20",date:"2025-07-07",startTime:"13:00",endTime:"14:30",duration:1.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Quarterly all-hands - company strategy and new hiring initiatives",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["quarterly","all-hands","strategy","hiring"]},{id:"21",date:"2025-07-06",startTime:"10:00",endTime:"11:00",duration:1,client:"Salesforce",project:"Enterprise CRM Implementation",description:"Weekly implementation status meeting with project stakeholders",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"implementation",billable:!0,rate:285,tags:["weekly","status","stakeholders"]},{id:"22",date:"2025-07-06",startTime:"14:00",endTime:"15:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Team retrospective - process improvements and workflow optimization",category:"internal",status:"approved",automated:!0,source:"zoom",meetingType:"check-in",billable:!1,tags:["retrospective","process","optimization"]}],gr={defaultProjects:["Enterprise CRM Implementation","Marketing Automation Platform","Customer Support Portal Migration"],workingHours:{start:"09:00",end:"17:00",timezone:"America/New_York"},billableByDefault:!0,autoTrackMeetings:!0,autoTrackSlack:!0,minimumSessionLength:15,notifications:!0,autoBreaks:!0,theme:"light",emailNotifications:{enabled:!0,dailyReviewTime:"17:30",approvalReminders:!0,weeklyDigest:!0,email:"sarah.johnson@timebeacon.io"},integrations:zE},Rr={TIME_ENTRIES:"timebeacon_entries_v6",PROJECTS:"timebeacon_projects_v6",CLIENTS:"timebeacon_clients_v6",SETTINGS:"timebeacon_settings_v6",ACTIVE_TIMER:"timebeacon_active_timer_v6"},xb=()=>{const[n,e]=H.useState([]),[t,i]=H.useState([]),[r,s]=H.useState([]),[l,u]=H.useState(gr),[f,m]=H.useState(null),[p,v]=H.useState(new Date);return H.useEffect(()=>{const J=localStorage.getItem(Rr.TIME_ENTRIES),me=localStorage.getItem(Rr.PROJECTS),Ce=localStorage.getItem(Rr.CLIENTS),ve=localStorage.getItem(Rr.SETTINGS),ne=localStorage.getItem(Rr.ACTIVE_TIMER),Z=J?JSON.parse(J):tp,be=me?JSON.parse(me):ep,Ne=Ce?JSON.parse(Ce):[];let V=gr;if(ve){const he=JSON.parse(ve);V={...gr,...he,emailNotifications:{...gr.emailNotifications,...he.emailNotifications||{}},defaultClients:he.defaultClients||[he.defaultClient].filter(Boolean)||gr.defaultClients,defaultProjects:he.defaultProjects||[he.defaultProject].filter(Boolean)||gr.defaultProjects}}e(Z),i(be),s(Ne),u(V),m(ne?JSON.parse(ne):null)},[]),H.useEffect(()=>{const J=setInterval(()=>{v(new Date)},1e3);return()=>clearInterval(J)},[]),H.useEffect(()=>{localStorage.setItem(Rr.TIME_ENTRIES,JSON.stringify(n))},[n]),H.useEffect(()=>{localStorage.setItem(Rr.PROJECTS,JSON.stringify(t))},[t]),H.useEffect(()=>{localStorage.setItem(Rr.CLIENTS,JSON.stringify(r))},[r]),H.useEffect(()=>{localStorage.setItem(Rr.SETTINGS,JSON.stringify(l))},[l]),H.useEffect(()=>{localStorage.setItem(Rr.ACTIVE_TIMER,JSON.stringify(f))},[f]),{timeEntries:n,projects:t,clients:r,settings:l,activeTimer:f,currentTime:p,startTimer:(J,me,Ce)=>{const ve={id:Date.now().toString(),client:J,project:me,description:Ce,startTime:new Date().toISOString(),isRunning:!0};m(ve)},stopTimer:()=>{if(!f)return null;const J=new Date,me=new Date(f.startTime),Ce=(J.getTime()-me.getTime())/(1e3*60*60),ve=t.find(be=>be.name===f.project),ne=ve?r.find(be=>be.id===ve.clientId):null,Z={id:Date.now().toString(),date:J.toISOString().split("T")[0],startTime:me.toTimeString().slice(0,5),endTime:J.toTimeString().slice(0,5),duration:Math.round(Ce*100)/100,client:ne?.name||"Unknown Client",project:f.project,description:f.description,category:"client",status:"pending",automated:!1,billable:l.billableByDefault};return e(be=>[Z,...be]),m(null),Z},pauseTimer:()=>{f&&m({...f,isRunning:!1})},resumeTimer:()=>{f&&m({...f,isRunning:!0})},getActiveTimerDuration:()=>{if(!f||!f.isRunning)return 0;const J=new Date(f.startTime),me=(p.getTime()-J.getTime())/(1e3*60*60);return Math.max(0,me)},addTimeEntry:J=>{const me={...J,id:Date.now().toString(),automated:!1,billable:J.billable??l.billableByDefault};return e(Ce=>[me,...Ce]),me},updateTimeEntry:(J,me)=>{e(Ce=>Ce.map(ve=>ve.id===J?{...ve,...me}:ve))},deleteTimeEntry:J=>{e(me=>me.filter(Ce=>Ce.id!==J))},addClient:J=>{const me={...J,id:Date.now().toString(),createdAt:new Date().toISOString().split("T")[0]};return s(Ce=>[me,...Ce]),me},updateClient:(J,me)=>{s(Ce=>Ce.map(ve=>ve.id===J?{...ve,...me}:ve))},deleteClient:J=>{s(me=>me.filter(Ce=>Ce.id!==J))},addProject:J=>{const me={...J,id:Date.now().toString(),createdAt:new Date().toISOString().split("T")[0]};return i(Ce=>[me,...Ce]),me},updateProject:(J,me)=>{i(Ce=>Ce.map(ve=>ve.id===J?{...ve,...me}:ve))},deleteProject:J=>{i(me=>me.filter(Ce=>Ce.id!==J))},setSettings:u,toggleIntegration:J=>{u(me=>({...me,integrations:me.integrations.map(Ce=>Ce.id===J?{...Ce,enabled:!Ce.enabled}:Ce)}))},getDashboardStats:()=>{const J=new Date().toISOString().split("T")[0],me=new Date(Date.now()-7*24*60*60*1e3).toISOString().split("T")[0],Ce=new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],ve=n.filter(we=>we.date===J),ne=n.filter(we=>we.date>=me),Z=n.filter(we=>we.date>=Ce),be=ve.reduce((we,ke)=>we+ke.duration,0),Ne=ne.reduce((we,ke)=>we+ke.duration,0),V=Z.reduce((we,ke)=>we+ke.duration,0),he=Z.filter(we=>we.billable).reduce((we,ke)=>we+ke.duration,0),I=V-he,Y=n.filter(we=>we.status==="pending").length,G=r.filter(we=>we.active).length,K=t.filter(we=>we.active).length,se=n.filter(we=>we.automated).length,Le=0,Oe=V>0?he/V*100:0;return{todayHours:Math.round(be*100)/100,weekHours:Math.round(Ne*100)/100,monthHours:Math.round(V*100)/100,billableHours:Math.round(he*100)/100,nonBillableHours:Math.round(I*100)/100,pendingEntries:Y,totalClients:G,activeProjects:K,totalEarnings:Math.round(Le*100)/100,utilizationRate:Math.round(Oe*100)/100,automatedEntries:se}}}},UE=()=>{const[n,e]=H.useState(!1),[t,i]=H.useState(!1),[r,s]=H.useState([]),[l,u]=H.useState(null),{addTimeEntry:f}=xb();H.useEffect(()=>{const v=window.location.hash.substring(1),y=new URLSearchParams(v),S=y.get("access_token"),_=y.get("state");if(console.log(" Checking for OAuth callback...",{hash:v,token:S?"present":"missing",state:_}),S&&_==="calendar_auth")console.log(" Got access token from redirect:",S.substring(0,20)+"..."),u(S),e(!0),localStorage.setItem("google_calendar_token",S),window.location.hash="";else{const b=localStorage.getItem("google_calendar_token");b&&(console.log(" Found stored token"),u(b),e(!0))}},[]);const m=async()=>{if(!l){alert("Please connect to Google Calendar first");return}i(!0);try{const v=new Date,y=new Date(v.getFullYear(),v.getMonth(),v.getDate()),S=new Date(v.getFullYear(),v.getMonth(),v.getDate()+1),_=await fetch(`https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=${y.toISOString()}&timeMax=${S.toISOString()}&singleEvents=true&orderBy=startTime`,{headers:{Authorization:`Bearer ${l}`,Accept:"application/json"}});if(!_.ok)throw new Error(`API Error: ${_.status} ${_.statusText}`);const T=(await _.json()).items||[];console.log(` Found ${T.length} calendar events`);const E=T.filter(w=>w.start?.dateTime&&w.end?.dateTime);if(s(E),E.length===0){alert("No meetings found for today. Try adding some calendar events and try again."),i(!1);return}await p(E)}catch(v){console.error(" Calendar API error:",v),alert(`Failed to get calendar events: ${v instanceof Error?v.message:"Unknown error"}`)}i(!1)},p=async v=>{console.log(" Converting calendar events to time entries...");for(const y of v){const S=new Date(y.start.dateTime),_=new Date(y.end.dateTime),b=(_.getTime()-S.getTime())/(1e3*60*60);let T="Unknown Client",E="Meeting";const w=(y.summary||"").toLowerCase(),C=y.attendees||[];w.includes("salesforce")||C.some(k=>k.email?.includes("salesforce.com"))?(T="Salesforce",E="Salesforce Implementation"):w.includes("monday")||C.some(k=>k.email?.includes("monday.com"))?(T="Monday.com",E="Monday.com Rollout"):w.includes("zendesk")||C.some(k=>k.email?.includes("zendesk.com"))?(T="Zendesk",E="Zendesk Integration"):w.includes("internal")||w.includes("standup")||w.includes("team")?(T="Internal",E="Internal Operations"):C.filter(P=>P.email&&!P.email.includes("@timebeacon.io")).length>0&&(T="External Client",E="Client Meeting");const j={date:S.toISOString().split("T")[0],startTime:S.toTimeString().slice(0,5),endTime:_.toTimeString().slice(0,5),duration:b,client:T,project:E,description:y.summary||"Calendar Event",category:T==="Internal"?"internal":"client",status:"pending",automated:!0,source:"calendar",meetingType:"check-in",billable:T!=="Internal",tags:["google-calendar","real-calendar"]};await f(j),console.log(` Created time entry: ${y.summary} (${b.toFixed(1)}h)`)}alert(` Success! Created ${v.length} time entries from your Google Calendar.`)};return d.jsxs("div",{style:{padding:"20px",border:"2px solid #4285F4",borderRadius:"8px",margin:"20px 0",backgroundColor:"#f8fbff"},children:[d.jsx("h3",{children:" Google Calendar Integration"}),n?d.jsxs("div",{children:[d.jsxs("div",{style:{color:"green",backgroundColor:"#e6ffe6",padding:"10px",borderRadius:"4px",marginBottom:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:" Connected to Google Calendar!"}),d.jsx("button",{onClick:()=>{localStorage.removeItem("google_calendar_token"),u(null),e(!1),s([])},style:{padding:"4px 8px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",fontSize:"12px"},children:"Disconnect"})]}),d.jsx("button",{onClick:m,disabled:t,style:{padding:"12px 24px",backgroundColor:t?"#ccc":"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:t?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold",marginBottom:"15px"},children:t?" Processing...":" Import Today's Meetings"}),r.length>0&&d.jsxs("div",{children:[d.jsx("h4",{children:"Imported Events:"}),r.map((v,y)=>d.jsxs("div",{style:{padding:"10px",margin:"5px 0",backgroundColor:"white",border:"1px solid #ddd",borderRadius:"4px"},children:[d.jsx("strong",{children:v.summary}),d.jsx("br",{}),d.jsxs("small",{children:[new Date(v.start.dateTime).toLocaleTimeString()," -",new Date(v.end.dateTime).toLocaleTimeString()]})]},y))]})]}):d.jsx("div",{children:d.jsx("p",{style:{marginBottom:"15px"},children:"Use the main integrations page to connect your Google Calendar."})})]})},HE=n=>{const e=["Monday","Tuesday","Wednesday","Thursday","Friday"],i=new Date(n+"T00:00:00").getDay(),s={1:0,2:1,3:2,4:3,5:4}[i];return s!==void 0?e[s]:null},WE=n=>{const e=[],t=new Date(n);t.setHours(0,0,0,0);const i=t.getDay();let r;i===0?r=6:r=i-1;const s=new Date(t);s.setDate(t.getDate()-r);for(let l=0;l<5;l++){const u=new Date(s);u.setDate(s.getDate()+l);const f=u.getFullYear(),m=String(u.getMonth()+1).padStart(2,"0"),p=String(u.getDate()).padStart(2,"0");e.push(`${f}-${m}-${p}`)}return e},VE=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"}),Kv=({entries:n,projects:e,onUpdateEntry:t,onDeleteEntry:i,onAddEntry:r})=>{const[s,l]=H.useState(new Date),[u,f]=H.useState(null),[m,p]=H.useState(!1),[v,y]=H.useState(0),[S,_]=H.useState(""),[b,T]=H.useState(!1),[E,w]=H.useState(new Set),[C,j]=H.useState(!1),[k,P]=H.useState(null),[D,z]=H.useState({frequency:"weekly",count:4,skipWeekends:!1}),[R,W]=H.useState(!1),[q,J]=H.useState({date:new Date().toISOString().split("T")[0],startTime:"09:00",duration:1,client:"",project:"",description:"",billable:!0,createSeries:!1,frequency:"weekly",repeatCount:4,skipWeekends:!1}),me=Go.useCallback(te=>{J(Ee=>({...Ee,...te}))},[]),Ce=Go.useCallback(()=>{T(!1)},[]),ve=Go.useCallback(()=>{R||(j(!1),P(null))},[R]),{getEventsForDate:ne}=FE(),Z=WE(s),be=te=>{const Ee=new Date(s);Ee.setDate(Ee.getDate()+(te==="next"?7:-7)),l(Ee)},Ne=()=>{l(new Date)},V=()=>{const Ee=new Date().toISOString().split("T")[0];return Z.includes(Ee)},he=te=>n.filter(Ee=>Ee.date===te).sort((Ee,Ke)=>Ee.startTime.localeCompare(Ke.startTime)),I=te=>{const Ee=new Date(te.start).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),Ke=new Date(te.end).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),We=(new Date(te.end).getTime()-new Date(te.start).getTime())/(1e3*60*60);return d.jsxs("div",{className:"calendar-event-card",children:[d.jsxs("div",{className:"entry-header",children:[d.jsxs("div",{className:"entry-time",children:[Ee," - ",Ke]}),d.jsx("div",{className:"entry-duration",children:Y(We)})]}),d.jsxs("div",{className:"entry-content",children:[d.jsxs("div",{className:"entry-source",children:[d.jsx("div",{className:"source-dot",style:{backgroundColor:"#4285F4"}}),d.jsxs("span",{className:"source-name",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Calendar Event"]})]}),d.jsx("div",{className:"entry-project",children:te.title}),te.description&&d.jsx("div",{className:"entry-description",children:te.description}),d.jsxs("div",{className:"entry-meta",children:[d.jsxs("div",{className:"source-badge",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),d.jsx("span",{children:"Google Calendar"})]}),te.attendees&&te.attendees.length>0&&d.jsxs("span",{className:"meeting-attendees",children:[te.attendees.length," attendees"]}),te.location&&d.jsxs("span",{className:"meeting-location",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),d.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),te.location]})]})]}),d.jsx("div",{className:"entry-actions",children:d.jsxs("button",{className:"btn btn-small btn-primary",onClick:()=>An(te),title:"Convert to time entry",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),d.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Track Time"]})})]},`calendar-${te.id}`)},Y=te=>{const Ee=Math.floor(te),Ke=Math.round((te-Ee)*60);return`${Ee}h ${Ke}m`},G=te=>he(te).reduce((Ee,Ke)=>Ee+Ke.duration,0),K=()=>Z.reduce((te,Ee)=>te+G(Ee),0),se=(te,Ee)=>{t(te,{status:Ee})},Le=te=>{f(te),y(te.duration),_(te.description),p(!0)},Oe=()=>{if(u&&S.trim()&&v>0){const te=we(u.startTime,v);t(u.id,{description:S.trim(),duration:v,endTime:te}),p(!1),f(null),_(""),y(0)}},we=(te,Ee)=>{const[Ke,We]=te.split(":").map(Number),st=Ke*60+We+Ee*60,ft=Math.floor(st/60)%24,Vt=st%60;return`${ft.toString().padStart(2,"0")}:${Vt.toString().padStart(2,"0")}`},ke=te=>{const Ee=Math.max(.25,v+te);y(Math.round(Ee*4)/4)},dt=(te,Ee)=>{const Ke=[],We=new Date(te.date);for(let st=0;st<Ee.count;st++){const ft=new Date(We);switch(Ee.frequency){case"daily":ft.setDate(We.getDate()+st);break;case"weekly":ft.setDate(We.getDate()+st*7);break;case"monthly":ft.setMonth(We.getMonth()+st);break}if(Ee.skipWeekends&&(ft.getDay()===0||ft.getDay()===6)){const Vt=ft.getDay()===0?1:2;ft.setDate(ft.getDate()+Vt)}Ke.push({...te,date:ft.toISOString().split("T")[0]})}return Ke},et=te=>{if(te.preventDefault(),!r)return;const Ee=we(q.startTime,q.duration);q.createSeries?dt({date:q.date,startTime:q.startTime,endTime:Ee,duration:q.duration,client:q.client,project:q.project,description:q.description,category:"client",status:"pending",automated:!1,billable:q.billable},{frequency:q.frequency,count:q.repeatCount,skipWeekends:q.skipWeekends}).forEach(We=>r(We)):r({date:q.date,startTime:q.startTime,endTime:Ee,duration:q.duration,client:q.client,project:q.project,description:q.description,category:"client",status:"pending",automated:!1,billable:q.billable}),J({date:new Date().toISOString().split("T")[0],startTime:"09:00",duration:1,client:"",project:"",description:"",billable:!0,createSeries:!1,frequency:"weekly",repeatCount:4,skipWeekends:!1}),T(!1)},Yt=(te,Ee)=>{const Ke=new Set(E);Ee?Ke.add(te):Ke.delete(te),w(Ke)},at=te=>{E.forEach(Ee=>{t(Ee,{status:te})}),w(new Set)},Yn=te=>{P(te),z({frequency:"weekly",count:4,skipWeekends:!1}),j(!0)},vt=async()=>{if(!(!k||!r)){W(!0);try{const te=[],Ee=new Date(k.date);let Ke=0;for(let We=1;We<=D.count&&Ke<D.count;We++){const st=new Date(Ee);switch(D.frequency){case"daily":st.setDate(Ee.getDate()+We);break;case"weekly":st.setDate(Ee.getDate()+We*7);break;case"monthly":st.setMonth(Ee.getMonth()+We);break}if(D.skipWeekends){const ft=st.getDay();if(ft===0||ft===6)continue}te.push({...k,date:st.toISOString().split("T")[0],status:"pending"}),Ke++}for(const We of te)r(We),await new Promise(st=>setTimeout(st,50));setTimeout(()=>{j(!1),P(null),W(!1)},200)}catch(te){console.error("Error generating duplicates:",te),W(!1)}}},Pe=()=>{if(!k)return[];const te=new Date(k.date),Ee=[];let Ke=0;for(let We=1;We<=D.count&&Ke<Math.min(D.count,5);We++){const st=new Date(te);switch(D.frequency){case"daily":st.setDate(te.getDate()+We);break;case"weekly":st.setDate(te.getDate()+We*7);break;case"monthly":st.setMonth(te.getMonth()+We);break}if(D.skipWeekends){const ft=st.getDay();if(ft===0||ft===6)continue}Ee.push(st),Ke++}return Ee},An=te=>{if(!r){console.warn("onAddEntry prop not provided, cannot convert calendar event");return}const Ee=new Date(te.start),Ke=new Date(te.end),We=(Ke.getTime()-Ee.getTime())/(1e3*60*60),{client:st,project:ft}=Mn(te),Vt={date:Ee.toISOString().split("T")[0],startTime:Ee.toTimeString().slice(0,5),endTime:Ke.toTimeString().slice(0,5),duration:We,client:st,project:ft,description:te.description||te.title,category:"meeting",status:"pending",automated:!0,source:"calendar",meetingType:ni(te),billable:!0,tags:te.attendees?[`${te.attendees.length} attendees`]:void 0};r(Vt),console.log(" Converted calendar event to time entry:",te.title)},Mn=te=>{const Ee=te.title.toLowerCase(),Ke=e.find(We=>Ee.includes(We.name.toLowerCase()));if(Ke)return{client:"",project:Ke.name};if(te.attendees&&te.attendees.length>0)for(const We of te.attendees){const st=We.split("@")[1];if(st){const ft=st.split(".")[0];return{client:"",project:`${ft.charAt(0).toUpperCase()+ft.slice(1)} - Meeting`}}}return{client:"",project:"Calendar Meeting"}},ni=te=>{const Ee=te.title.toLowerCase(),Ke=(te.description||"").toLowerCase(),We=`${Ee} ${Ke}`;return We.includes("kickoff")||We.includes("kick-off")?"kickoff":We.includes("discovery")||We.includes("discovery")?"discovery":We.includes("implementation")||We.includes("implement")?"implementation":We.includes("support")||We.includes("help")?"support":We.includes("training")||We.includes("onboarding")?"training":We.includes("check-in")||We.includes("checkin")||We.includes("status")?"check-in":We.includes("escalation")||We.includes("urgent")?"escalation":"check-in"},ii=te=>{const Ee=Math.floor(te),Ke=Math.round((te-Ee)*60);return`${Ee}h ${Ke}m`},Qe=te=>{switch(te){case"pending":return"#f59e0b";case"submitted":return"#3b82f6";case"approved":return"#10b981";case"rejected":return"#ef4444";default:return"#6b7280"}},ze=()=>n.filter(te=>Z.includes(te.date)&&te.status==="pending").length,Ye=()=>{const te=n.filter(Ee=>Z.includes(Ee.date));return te.length>0&&te.every(Ee=>Ee.status==="approved")},Ze=()=>{n.filter(Ee=>Z.includes(Ee.date)&&Ee.status==="approved").forEach(Ee=>{t(Ee.id,{status:"submitted"})})},Rt=new Date(Z[0]),Et=new Date(Z[4]),Wt=`${Rt.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${Et.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`;return d.jsxs("div",{children:[d.jsx("div",{className:"dashboard-header",children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",width:"100%"},children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Dashboard"}),d.jsx("p",{className:"dashboard-subtitle",children:"Your weekly time tracking overview with smart automation"})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>be("prev"),children:"Previous Week"}),d.jsx("span",{style:{fontWeight:"600",fontSize:"16px",minWidth:"200px",textAlign:"center"},children:Wt}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>be("next"),children:"Next Week"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[d.jsx("button",{className:"btn btn-primary",onClick:()=>T(!0),children:"Add Entry"}),!V()&&d.jsx("button",{className:"btn btn-secondary",onClick:Ne,children:"Current Week"})]})]})]})}),E.size>0&&d.jsx("div",{className:"content-card",style:{marginBottom:"24px",background:"var(--brand-primary-light)",border:"2px solid var(--brand-primary)"},children:d.jsxs("div",{style:{padding:"16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},children:[d.jsxs("span",{style:{fontWeight:"600",color:"var(--brand-primary)"},children:[E.size," entries selected"]}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>at("pending"),children:"Mark as Pending"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>at("approved"),children:"Mark as Approved"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>w(new Set),children:"Clear Selection"})]})}),d.jsx(UE,{}),d.jsxs("div",{className:"week-summary",children:[d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Total Hours This Week"}),d.jsx("div",{className:"summary-value",children:Y(K())})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Customer-Focused Hours"}),d.jsx("div",{className:"summary-value",children:Y(n.filter(te=>Z.includes(te.date)&&te.billable).reduce((te,Ee)=>te+Ee.duration,0))})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Utilization Rate"}),d.jsxs("div",{className:"summary-value",children:[K()>0?(n.filter(te=>Z.includes(te.date)&&te.billable).reduce((te,Ee)=>te+Ee.duration,0)/K()*100).toFixed(1):0,"%"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Automated Entries"}),d.jsx("div",{className:"summary-value",children:n.filter(te=>Z.includes(te.date)&&te.automated).length})]}),d.jsx("div",{className:"submit-actions",children:V()?d.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[d.jsx("button",{className:`btn ${Ye()?"btn-primary":"btn-secondary"}`,onClick:Ye()?Ze:void 0,disabled:!Ye(),title:Ye()?"Submit all approved entries for manager review":`You have ${ze()} pending entries. Please approve all entries before submitting.`,children:Ye()?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M9 11l3 3 8-8"}),d.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.18 0 2.3.23 3.32.64"})]}),"Submit Week for Review"]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("polyline",{points:"12,6 12,12 16,14"})]}),ze()," Pending Entries"]})}),!Ye()&&ze()>0&&d.jsx("div",{className:"tooltip-warning",style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"var(--warning)",color:"white",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",whiteSpace:"nowrap",marginBottom:"8px",opacity:0,animation:"fadeIn 0.3s ease-in-out 2s forwards"},children:"Please approve all entries before submitting"})]}):d.jsx("button",{className:"btn btn-secondary",disabled:!0,children:Z[0]>new Date().toISOString().split("T")[0]?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Future Week"]}):n.filter(te=>Z.includes(te.date)&&te.status==="submitted").length>0?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M9 11l3 3 8-8"}),d.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.18 0 2.3.23 3.32.64"})]}),"Submitted"]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),d.jsx("polyline",{points:"22,4 12,14.01 9,11.01"})]}),"Past Week"]})})})]}),d.jsx("div",{className:"weekly-grid",children:Z.map(te=>{const Ee=he(te),Ke=ne(te),We=G(te),st=te===new Date().toISOString().split("T")[0],ft=te<new Date().toISOString().split("T")[0],Vt=te>new Date().toISOString().split("T")[0],ri=HE(te);return ri?d.jsxs("div",{className:`day-column ${st?"today":""} ${ft?"past":""} ${Vt?"future":""}`,children:[d.jsxs("div",{className:"day-header",children:[d.jsxs("div",{className:"day-info",children:[d.jsx("div",{className:"day-name",children:ri}),d.jsx("div",{className:"day-date",children:VE(te)})]}),d.jsxs("div",{className:"day-total",children:[Ee.length>0&&d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"12px",marginBottom:"4px"},children:[d.jsx("input",{type:"checkbox",checked:Ee.length>0&&Ee.every(tt=>E.has(tt.id)),ref:tt=>{if(tt){const ai=Ee.filter($n=>E.has($n.id)).length;tt.indeterminate=ai>0&&ai<Ee.length}},onChange:tt=>{const ai=new Set(E);Ee.every(ji=>E.has(ji.id))?Ee.forEach(ji=>{ai.delete(ji.id)}):Ee.forEach(ji=>{ai.add(ji.id)}),w(ai)},style:{margin:0}}),"All"]}),We>0&&d.jsx("span",{className:"hours-badge",children:Y(We)}),Vt&&We===0&&d.jsx("span",{className:"future-indicator",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})]})]}),d.jsxs("div",{className:"day-entries",children:[Ke.map(tt=>I(tt)),Ee.length===0&&Ke.length===0?d.jsx("div",{className:"no-entries",children:Vt?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),d.jsx("p",{children:"Upcoming - no meetings scheduled"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",ry:"2"}),d.jsx("circle",{cx:"12",cy:"5",r:"2"}),d.jsx("path",{d:"m12 7-3 4 3 4 3-4-3-4z"}),d.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"16"}),d.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"16"})]}),d.jsx("p",{children:"No automated entries detected"})]})}):Ee.map(tt=>{const ai=e.find($n=>$n.name===tt.project);return d.jsxs("div",{className:"time-entry-card",children:[d.jsxs("div",{className:"entry-header",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("input",{type:"checkbox",checked:E.has(tt.id),onChange:$n=>Yt(tt.id,$n.target.checked),style:{margin:0}}),d.jsx("div",{className:"entry-time",children:Dm(tt.startTime,tt.endTime)})]}),d.jsx("div",{className:"entry-duration",children:Y(tt.duration)})]}),d.jsxs("div",{className:"entry-content",children:[d.jsxs("div",{className:"entry-project-info",children:[d.jsx("div",{className:"project-dot",style:{backgroundColor:ai?.color||"#6366f1"}}),d.jsx("span",{className:"project-name",children:tt.project})]}),d.jsx("div",{className:"entry-description",children:tt.description}),d.jsxs("div",{className:"entry-meta",children:[tt.automated&&d.jsxs("div",{className:"source-badge",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",ry:"2"}),d.jsx("circle",{cx:"12",cy:"5",r:"2"}),d.jsx("path",{d:"m12 7-3 4 3 4 3-4-3-4z"}),d.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"16"}),d.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"16"})]}),d.jsx("span",{children:tt.source||"Auto"})]}),tt.meetingType&&d.jsx("span",{className:"meeting-type",children:tt.meetingType.replace("-"," ")}),d.jsx("span",{className:`billable-badge ${tt.billable?"billable":"non-billable"}`,children:tt.billable?"Billable":"Non-billable"})]})]}),d.jsxs("div",{className:"entry-actions",children:[d.jsxs("select",{value:tt.status==="submitted"||tt.status==="rejected"?"approved":tt.status,onChange:$n=>se(tt.id,$n.target.value),className:"status-select",style:{borderColor:Qe(tt.status)},children:[d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"approved",children:"Approved"})]}),d.jsx("button",{className:"btn btn-small btn-secondary",onClick:()=>Le(tt),title:"Edit entry",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),d.jsx("path",{d:"m15 5 4 4"})]})}),d.jsx("button",{className:"btn btn-small btn-secondary",onClick:()=>Yn(tt),title:"Duplicate for recurring meetings",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),d.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"})]})}),d.jsx("button",{className:"btn btn-small btn-danger",onClick:()=>{confirm("Delete this entry?")&&i(tt.id)},children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3,6 5,6 21,6"}),d.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]},tt.id)})]})]},te):null})}),m&&u&&d.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:d.jsxs("div",{className:"modal-content",onClick:te=>te.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"8px"},children:[d.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),d.jsx("path",{d:"m15 5 4 4"})]}),"Edit Time Entry"]}),d.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:""})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{background:"var(--background-secondary)",padding:"16px",borderRadius:"8px",marginBottom:"24px"},children:[d.jsxs("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",color:"var(--text-primary)"},children:[u.project,"  ",u.client]}),d.jsxs("div",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:[new Date(u.date).toLocaleDateString(),"  ",Dm(u.startTime,u.endTime)]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"24px"},children:[d.jsx("label",{style:{fontWeight:"600",marginBottom:"8px",display:"block"},children:"Description:"}),d.jsx("textarea",{value:S,onChange:te=>_(te.target.value),className:"form-input",rows:3,placeholder:"Describe what you worked on...",style:{width:"100%",resize:"vertical"}})]}),d.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:"24px"},children:[d.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",color:"var(--text-primary)"},children:"Duration"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--brand-primary)",marginBottom:"16px",textAlign:"center"},children:ii(v)}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsxs("div",{style:{marginBottom:"12px"},children:[d.jsx("label",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",display:"block",textAlign:"center"},children:"Subtract Time"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>ke(-.25),disabled:v<=.25,style:{fontSize:"12px",padding:"8px 4px"},children:" 15min"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>ke(-.5),disabled:v<=.5,style:{fontSize:"12px",padding:"8px 4px"},children:" 30min"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>ke(-1),disabled:v<=1,style:{fontSize:"12px",padding:"8px 4px"},children:" 1hr"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",display:"block",textAlign:"center"},children:"Add Time"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>ke(.25),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 15min"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>ke(.5),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 30min"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>ke(1),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 1hr"})]})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{fontWeight:"600",marginBottom:"8px",display:"block"},children:"Exact duration (hours):"}),d.jsx("input",{type:"number",min:"0.25",max:"24",step:"0.25",value:v,onChange:te=>{const Ee=parseFloat(te.target.value)||.25;y(Math.max(.25,Math.round(Ee*4)/4))},className:"form-input",style:{textAlign:"center"}})]}),d.jsx("div",{style:{background:"var(--info-light)",padding:"12px",borderRadius:"8px",marginTop:"12px"},children:d.jsxs("p",{style:{fontSize:"14px",color:"var(--info-dark)",margin:0,textAlign:"center"},children:[d.jsx("strong",{children:"New time:"})," ",u.startTime," - ",we(u.startTime,v)]})})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>p(!1),children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:Oe,disabled:!S.trim()||v<=0,children:"Save Changes"})]})]})}),b&&d.jsx("div",{className:"modal-overlay",onClick:Ce,children:d.jsxs("div",{className:"modal-content",onClick:te=>te.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"8px",filter:"drop-shadow(0 2px 4px rgba(99, 102, 241, 0.3))"},children:[d.jsx("defs",{children:d.jsxs("linearGradient",{id:"lightning-dashboard",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:1}}),d.jsx("stop",{offset:"50%",style:{stopColor:"#6366f1",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#3b82f6",stopOpacity:1}})]})}),d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",fill:"url(#lightning-dashboard)",stroke:"url(#lightning-dashboard)"})]}),"Quick Time Entry"]}),d.jsx("button",{className:"modal-close",onClick:Ce,children:""})]}),d.jsx("div",{className:"modal-body",children:d.jsxs("form",{onSubmit:et,children:[d.jsxs("div",{className:"form-group",style:{marginBottom:"24px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",display:"block"},children:"How long did you work?"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px",marginBottom:"16px"},children:[.5,1,2,4].map(te=>d.jsx("button",{type:"button",className:`btn ${q.duration===te?"btn-primary":"btn-secondary"}`,onClick:()=>J({...q,duration:te}),style:{padding:"12px 8px",fontSize:"14px",fontWeight:"600"},children:te===.5?"30min":`${te}h`},te))}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[6,8,"custom"].map(te=>d.jsx("button",{type:"button",className:`btn ${te==="custom"?[.5,1,2,4,6,8].includes(q.duration)?"btn-secondary":"btn-primary":q.duration===te?"btn-primary":"btn-secondary"}`,onClick:()=>{if(te==="custom"){const Ee=prompt("Enter duration in hours (e.g., 1.5):");Ee&&!isNaN(parseFloat(Ee))&&J({...q,duration:parseFloat(Ee)})}else J({...q,duration:te})},style:{padding:"12px 8px",fontSize:"14px",fontWeight:"600"},children:te==="custom"?"Other":`${te}h`},te))}),![.5,1,2,4,6,8].includes(q.duration)&&d.jsxs("div",{style:{marginTop:"12px",padding:"8px 12px",background:"var(--brand-primary-light)",borderRadius:"6px",textAlign:"center",fontSize:"14px",fontWeight:"600",color:"var(--brand-primary)"},children:[q.duration,"h selected"]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"Project"}),d.jsxs("select",{value:q.project,onChange:te=>J({...q,project:te.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"},children:[d.jsx("option",{value:"",children:"Select project..."}),e.filter(te=>te.active).map(te=>d.jsx("option",{value:te.name,children:te.name},te.id))]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"When did this happen?"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Date"}),d.jsx("input",{type:"date",value:q.date,onChange:te=>me({date:te.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Start Time"}),d.jsx("input",{type:"time",value:q.startTime,onChange:te=>J({...q,startTime:te.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"}})]})]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"What did you work on?"}),d.jsx("textarea",{value:q.description,onChange:te=>J({...q,description:te.target.value}),className:"form-input",rows:2,placeholder:"Brief description of work completed...",required:!0,style:{fontSize:"14px"}})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"600",marginBottom:"12px"},children:[d.jsx("input",{type:"checkbox",checked:q.createSeries||!1,onChange:te=>J({...q,createSeries:te.target.checked})}),d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("polyline",{points:"23,4 23,10 17,10"}),d.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),"Create recurring entries"]}),q.createSeries&&d.jsxs("div",{style:{padding:"16px",background:"var(--brand-primary-light)",borderRadius:"8px",border:"1px solid var(--brand-primary)"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Frequency"}),d.jsxs("select",{value:q.frequency||"weekly",onChange:te=>J({...q,frequency:te.target.value}),className:"form-input",style:{fontSize:"14px"},children:[d.jsx("option",{value:"daily",children:"Daily"}),d.jsx("option",{value:"weekly",children:"Weekly"}),d.jsx("option",{value:"monthly",children:"Monthly"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Count"}),d.jsx("input",{type:"number",min:"2",max:"52",value:q.repeatCount||4,onChange:te=>J({...q,repeatCount:parseInt(te.target.value)||4}),className:"form-input",style:{fontSize:"14px"}})]}),d.jsx("div",{style:{display:"flex",alignItems:"end"},children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:q.skipWeekends||!0,onChange:te=>J({...q,skipWeekends:te.target.checked})}),"Skip weekends"]})})]}),d.jsxs("div",{style:{fontSize:"13px",color:"var(--brand-primary)",fontWeight:"500",textAlign:"center"},children:["Will create ",q.repeatCount||4," entries ",q.frequency==="daily"?"daily":q.frequency==="weekly"?"weekly":"monthly",q.skipWeekends?", skipping weekends":""]})]})]}),d.jsxs("details",{style:{marginBottom:"20px"},children:[d.jsxs("summary",{style:{cursor:"pointer",fontSize:"14px",color:"var(--text-secondary)",marginBottom:"12px"},children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),"Additional Options"]}),d.jsx("div",{style:{padding:"12px",background:"var(--background-secondary)",borderRadius:"8px"},children:d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:q.billable,onChange:te=>J({...q,billable:te.target.checked})}),"Billable to client"]})})})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Ce,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"btn btn-primary",style:{fontSize:"16px",padding:"12px 24px"},children:[d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:d.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Create Entry"]})]})]})})]})}),C&&k&&d.jsx("div",{className:"modal-overlay",onClick:ve,children:d.jsxs("div",{className:"modal-content duplicate-modal",onClick:te=>te.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:" Create Recurring Time Entries"}),d.jsx("button",{className:"modal-close",onClick:ve,disabled:R,children:""})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{className:"duplicate-preview-card",children:[d.jsxs("div",{className:"preview-header",children:[d.jsx("span",{className:"preview-icon",children:""}),d.jsxs("div",{children:[d.jsxs("h4",{className:"preview-title",children:[k.project,"  ",k.client]}),d.jsxs("div",{className:"preview-details",children:[new Date(k.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"}),"  ",Dm(k.startTime,k.endTime),"  ",Y(k.duration)]})]})]}),d.jsx("div",{className:"preview-description",children:k.description})]}),d.jsxs("div",{className:"duplicate-settings",children:[d.jsxs("div",{className:"settings-grid",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:" Frequency"}),d.jsxs("select",{value:D.frequency,onChange:te=>z({...D,frequency:te.target.value}),className:"form-input",disabled:R,children:[d.jsx("option",{value:"daily",children:" Daily"}),d.jsx("option",{value:"weekly",children:" Weekly"}),d.jsx("option",{value:"monthly",children:" Monthly"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:" Count"}),d.jsxs("div",{className:"count-input-wrapper",children:[d.jsx("input",{type:"number",min:"1",max:"52",value:D.count,onChange:te=>z({...D,count:parseInt(te.target.value)||1}),className:"form-input",disabled:R}),d.jsx("span",{className:"count-label",children:"occurrences"})]})]})]}),d.jsx("div",{className:"form-group",children:d.jsxs("label",{className:"checkbox-label",children:[d.jsx("input",{type:"checkbox",checked:D.skipWeekends,onChange:te=>z({...D,skipWeekends:te.target.checked}),disabled:R}),d.jsx("span",{className:"checkbox-text",children:" Skip weekends (Saturday & Sunday)"})]})})]}),d.jsxs("div",{className:"dates-preview",children:[d.jsx("h4",{className:"preview-section-title",children:" Upcoming dates preview:"}),d.jsxs("div",{className:"dates-list",children:[Pe().map((te,Ee)=>d.jsxs("div",{className:"date-item",children:[d.jsx("span",{className:"date-number",children:Ee+1}),d.jsx("span",{className:"date-text",children:te.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]},Ee)),D.count>5&&d.jsxs("div",{className:"date-item more-dates",children:[d.jsx("span",{className:"date-number",children:"..."}),d.jsxs("span",{className:"date-text",children:["+",D.count-5," more dates"]})]})]})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:ve,disabled:R,children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:vt,disabled:R,children:R?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"spinner",children:""}),"Creating..."]}):d.jsxs(d.Fragment,{children:[" Create ",D.count," Duplicates"]})})]})]})})]})},hr=n=>{const e=Math.floor(n),t=Math.round((n-e)*60);return`${e}h ${t}m`},lc=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),GE=({entries:n,projects:e})=>{const[t,i]=H.useState("thisWeek"),[r,s]=H.useState(""),[l,u]=H.useState(""),[f,m]=H.useState([]),[p,v]=H.useState("overview"),y=()=>{const w=new Date;let C,j;switch(t){case"today":C=j=new Date(w);break;case"yesterday":C=j=new Date(w.getTime()-24*60*60*1e3);break;case"thisWeek":const k=new Date(w);k.setDate(w.getDate()-w.getDay()+1),C=k,j=new Date(k.getTime()+4*24*60*60*1e3);break;case"lastWeek":const P=new Date(w);P.setDate(w.getDate()-w.getDay()-6),C=P,j=new Date(P.getTime()+4*24*60*60*1e3);break;case"thisMonth":C=new Date(w.getFullYear(),w.getMonth(),1),j=new Date(w.getFullYear(),w.getMonth()+1,0);break;case"lastMonth":C=new Date(w.getFullYear(),w.getMonth()-1,1),j=new Date(w.getFullYear(),w.getMonth(),0);break;case"custom":C=r?new Date(r):new Date,j=l?new Date(l):new Date;break;default:C=j=w}return{start:C.toISOString().split("T")[0],end:j.toISOString().split("T")[0]}},S=H.useMemo(()=>{const w=y();return n.filter(C=>{const j=C.date,k=j>=w.start&&j<=w.end,P=f.length===0||f.includes(C.project);return k&&P})},[n,t,r,l,f]),_=H.useMemo(()=>{const w=S.reduce((R,W)=>R+W.duration,0),C=S.filter(R=>R.billable).reduce((R,W)=>R+W.duration,0),j=S.filter(R=>R.status==="approved"&&R.billable).reduce((R,W)=>{const q=e.find(me=>me.name===W.project),J=W.rate||q?.rate||0;return R+W.duration*J},0),k=w>0?C/w*100:0,P=w/Math.max(1,new Set(S.map(R=>R.date)).size),D=S.reduce((R,W)=>{if(R[W.project]||(R[W.project]={hours:0,earnings:0,count:0}),R[W.project].hours+=W.duration,R[W.project].count+=1,W.status==="approved"&&W.billable){const q=e.find(me=>me.name===W.project),J=W.rate||q?.rate||0;R[W.project].earnings+=W.duration*J}return R},{}),z=S.reduce((R,W)=>(R[W.status]=(R[W.status]||0)+W.duration,R),{});return{totalHours:w,billableHours:C,totalEarnings:j,utilizationRate:k,avgHoursPerDay:P,projectStats:D,statusStats:z,totalEntries:S.length,automatedEntries:S.filter(R=>R.automated).length}},[S,e]),b=()=>{const w=["Date","Start","End","Duration","Client","Project","Description","Status","Billable","Earnings"],C=S.map(D=>{const z=e.find(q=>q.name===D.project),R=D.rate||z?.rate||0,W=D.status==="approved"&&D.billable?D.duration*R:0;return[D.date,D.startTime,D.endTime,D.duration,D.client,D.project,`"${D.description.replace(/"/g,'""')}"`,D.status,D.billable?"Yes":"No",W.toFixed(2)]}),j=[w.join(","),...C.map(D=>D.join(","))].join(`
`),k=new Blob([j],{type:"text/csv"}),P=document.createElement("a");P.href=URL.createObjectURL(k),P.download=`timebeacon-report-${y().start}-to-${y().end}.csv`,P.click()},T=({data:w,title:C,total:j})=>{const k=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];let P=0;return d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{className:"chart-title",children:C}),d.jsxs("div",{className:"donut-chart-wrapper",children:[d.jsxs("svg",{width:"200",height:"200",viewBox:"0 0 200 200",children:[Object.entries(w).sort(([,D],[,z])=>z-D).slice(0,6).map(([D,z],R)=>{const q=z/j*100/100*360,J=q>180?1:0,me=P*Math.PI/180,Ce=(P+q)*Math.PI/180,ve=100+70*Math.cos(me),ne=100+70*Math.sin(me),Z=100+70*Math.cos(Ce),be=100+70*Math.sin(Ce),Ne=["M 100 100",`L ${ve} ${ne}`,`A 70 70 0 ${J} 1 ${Z} ${be}`,"Z"].join(" ");return P+=q,d.jsx("path",{d:Ne,fill:k[R%k.length],stroke:"white",strokeWidth:"2"},D)}),d.jsx("circle",{cx:"100",cy:"100",r:"35",fill:"white"}),d.jsx("text",{x:"100",y:"95",textAnchor:"middle",fontSize:"14",fontWeight:"bold",children:hr(j)}),d.jsx("text",{x:"100",y:"110",textAnchor:"middle",fontSize:"12",fill:"#666",children:"Total"})]}),d.jsx("div",{className:"chart-legend",children:Object.entries(w).sort(([,D],[,z])=>z-D).slice(0,6).map(([D,z],R)=>d.jsxs("div",{className:"legend-item",children:[d.jsx("div",{className:"legend-color",style:{backgroundColor:k[R%k.length]}}),d.jsx("span",{className:"legend-label",children:D}),d.jsxs("span",{className:"legend-value",children:[hr(z)," (",(z/j*100).toFixed(1),"%)"]})]},D))})]})]})},E=({data:w,title:C,type:j="hours"})=>{const k=Math.max(...Object.values(w).map(D=>j==="hours"?D.hours||D:D.earnings||D)),P=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];return d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{className:"chart-title",children:C}),d.jsx("div",{className:"bar-chart",children:Object.entries(w).sort(([,D],[,z])=>{const R=j==="hours"?D.hours||D:D.earnings||D;return(j==="hours"?z.hours||z:z.earnings||z)-R}).slice(0,8).map(([D,z],R)=>{const W=j==="hours"?z.hours||z:z.earnings||z,q=W/k*150;return d.jsxs("div",{className:"bar-item",children:[d.jsx("div",{className:"bar-label",children:D.length>12?D.substring(0,12)+"...":D}),d.jsx("div",{className:"bar-container",children:d.jsx("div",{className:"bar-fill",style:{height:`${q}px`,backgroundColor:P[R%P.length]}})}),d.jsx("div",{className:"bar-value",children:j==="hours"?hr(W):lc(W)})]},D)})})]})};return d.jsxs("div",{className:"reports-page",children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Reports & Analytics"}),d.jsx("p",{className:"dashboard-subtitle",children:"Comprehensive insights into your time tracking"})]}),d.jsx("div",{className:"header-actions",children:d.jsx("button",{className:"btn btn-secondary",onClick:b,children:" Export CSV"})})]}),d.jsxs("div",{className:"content-card filters-card",children:[d.jsx("div",{className:"card-header",children:d.jsx("h2",{className:"card-title",children:"Filters & Date Range"})}),d.jsxs("div",{className:"filters-content",children:[d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:"Time Period"}),d.jsx("div",{className:"date-range-buttons",children:[{key:"today",label:"Today"},{key:"yesterday",label:"Yesterday"},{key:"thisWeek",label:"This Week"},{key:"lastWeek",label:"Last Week"},{key:"thisMonth",label:"This Month"},{key:"lastMonth",label:"Last Month"},{key:"custom",label:"Custom"}].map(w=>d.jsx("button",{className:`btn ${t===w.key?"btn-primary":"btn-secondary"}`,onClick:()=>i(w.key),children:w.label},w.key))}),t==="custom"&&d.jsxs("div",{className:"custom-date-inputs",children:[d.jsx("input",{type:"date",value:r,onChange:w=>s(w.target.value),className:"form-input"}),d.jsx("span",{children:"to"}),d.jsx("input",{type:"date",value:l,onChange:w=>u(w.target.value),className:"form-input"})]})]}),d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:"Projects"}),d.jsxs("select",{multiple:!0,value:f,onChange:w=>m(Array.from(w.target.selectedOptions,C=>C.value)),className:"form-input projects-select",children:[d.jsx("option",{value:"",children:"All Projects"}),e.map(w=>d.jsxs("option",{value:w.name,children:[w.name," (",w.client,")"]},w.name))]}),d.jsx("small",{children:"Hold Ctrl/Cmd to select multiple projects"})]})]})]}),d.jsxs("div",{className:"metrics-grid",children:[d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:hr(_.totalHours)}),d.jsx("div",{className:"metric-label",children:"Total Hours"}),d.jsxs("div",{className:"metric-detail",children:[_.totalEntries," entries"]})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:lc(_.totalEarnings)}),d.jsx("div",{className:"metric-label",children:"Total Earnings"}),d.jsxs("div",{className:"metric-detail",children:[hr(_.billableHours)," billable"]})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsxs("div",{className:"metric-value",children:[_.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"metric-label",children:"Utilization Rate"}),d.jsx("div",{className:"metric-detail",children:"Billable vs total time"})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:hr(_.avgHoursPerDay)}),d.jsx("div",{className:"metric-label",children:"Avg. Hours/Day"}),d.jsxs("div",{className:"metric-detail",children:[_.automatedEntries," automated"]})]})]})]}),d.jsx("div",{className:"chart-navigation",children:[{key:"overview",label:" Overview",desc:"Key metrics and summaries"},{key:"projects",label:" Projects",desc:"Time breakdown by project"},{key:"status",label:" Status",desc:"Entry status analysis"},{key:"trends",label:" Trends",desc:"Daily and weekly patterns"},{key:"utilization",label:" Utilization",desc:"Billable vs non-billable"}].map(w=>d.jsxs("button",{className:`chart-nav-btn ${p===w.key?"active":""}`,onClick:()=>v(w.key),children:[d.jsx("div",{className:"chart-nav-label",children:w.label}),d.jsx("div",{className:"chart-nav-desc",children:w.desc})]},w.key))}),d.jsxs("div",{className:"chart-display-area",children:[p==="overview"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(T,{data:Object.fromEntries(Object.entries(_.projectStats).map(([w,C])=>[w,C.hours])),title:"Hours by Project",total:_.totalHours}),d.jsx(E,{data:_.projectStats,title:"Earnings by Project",type:"currency"})]}),p==="projects"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(E,{data:_.projectStats,title:"Hours by Project",type:"hours"}),d.jsxs("div",{className:"project-details-table",children:[d.jsx("h3",{children:"Project Details"}),d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Hours"}),d.jsx("th",{children:"Entries"}),d.jsx("th",{children:"Earnings"}),d.jsx("th",{children:"Avg Rate"})]})}),d.jsx("tbody",{children:Object.entries(_.projectStats).sort(([,w],[,C])=>C.hours-w.hours).map(([w,C])=>d.jsxs("tr",{children:[d.jsx("td",{children:w}),d.jsx("td",{children:hr(C.hours)}),d.jsx("td",{children:C.count}),d.jsx("td",{children:lc(C.earnings)}),d.jsx("td",{children:C.hours>0?lc(C.earnings/C.hours):"$0"})]},w))})]})]})]}),p==="status"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(T,{data:_.statusStats,title:"Hours by Status",total:_.totalHours}),d.jsxs("div",{className:"status-details",children:[d.jsx("h3",{children:"Status Breakdown"}),d.jsx("div",{className:"status-cards",children:Object.entries(_.statusStats).sort(([,w],[,C])=>C-w).map(([w,C])=>d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-name",children:w.charAt(0).toUpperCase()+w.slice(1)}),d.jsx("div",{className:"status-hours",children:hr(C)}),d.jsxs("div",{className:"status-percentage",children:[(C/_.totalHours*100).toFixed(1),"%"]})]},w))})]})]}),p==="utilization"&&d.jsxs("div",{className:"utilization-analysis",children:[d.jsxs("div",{className:"utilization-overview",children:[d.jsx("div",{className:"utilization-gauge",children:d.jsx("div",{className:"gauge-container",children:d.jsx("div",{className:"gauge-fill",style:{background:`conic-gradient(#3b82f6 0deg ${_.utilizationRate/100*360}deg, #e5e7eb ${_.utilizationRate/100*360}deg 360deg)`},children:d.jsxs("div",{className:"gauge-center",children:[d.jsxs("div",{className:"gauge-value",children:[_.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"gauge-label",children:"Utilization"})]})})})}),d.jsxs("div",{className:"utilization-breakdown",children:[d.jsxs("div",{className:"breakdown-item billable",children:[d.jsx("div",{className:"breakdown-color"}),d.jsx("div",{className:"breakdown-label",children:"Billable Hours"}),d.jsx("div",{className:"breakdown-value",children:hr(_.billableHours)})]}),d.jsxs("div",{className:"breakdown-item non-billable",children:[d.jsx("div",{className:"breakdown-color"}),d.jsx("div",{className:"breakdown-label",children:"Non-billable Hours"}),d.jsx("div",{className:"breakdown-value",children:hr(_.totalHours-_.billableHours)})]})]})]}),d.jsxs("div",{className:"utilization-tips",children:[d.jsx("h4",{children:" Optimization Tips"}),d.jsxs("div",{className:"tips-list",children:[_.utilizationRate<60&&d.jsx("div",{className:"tip warning",children:" Low utilization rate. Consider focusing more time on billable client work."}),_.utilizationRate>=80&&d.jsx("div",{className:"tip success",children:" Excellent utilization rate! You're maximizing billable time."}),_.automatedEntries/_.totalEntries>.7&&d.jsxs("div",{className:"tip info",children:[" Great automation usage! ",(_.automatedEntries/_.totalEntries*100).toFixed(0),"% of entries are automated."]})]})]})]})]}),d.jsxs("div",{className:"content-card data-table-card",children:[d.jsx("div",{className:"card-header",children:d.jsxs("h2",{className:"card-title",children:["Time Entries (",S.length,")"]})}),d.jsxs("div",{className:"table-container",children:[d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Time"}),d.jsx("th",{children:"Duration"}),d.jsx("th",{children:"Client"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Billable"}),d.jsx("th",{children:"Earnings"})]})}),d.jsx("tbody",{children:S.sort((w,C)=>new Date(C.date+" "+C.startTime).getTime()-new Date(w.date+" "+w.startTime).getTime()).slice(0,100).map((w,C)=>{const j=e.find(D=>D.name===w.project),k=w.rate||j?.rate||0,P=w.status==="approved"&&w.billable?w.duration*k:0;return d.jsxs("tr",{children:[d.jsx("td",{children:new Date(w.date).toLocaleDateString()}),d.jsxs("td",{className:"time-cell",children:[w.startTime," - ",w.endTime]}),d.jsx("td",{children:hr(w.duration)}),d.jsx("td",{children:w.client}),d.jsx("td",{children:w.project}),d.jsx("td",{className:"description-cell",children:w.description}),d.jsx("td",{children:d.jsx("span",{className:`status-badge status-${w.status}`,children:w.status})}),d.jsx("td",{children:d.jsx("span",{className:`billable-badge ${w.billable?"billable":"non-billable"}`,children:w.billable?"Yes":"No"})}),d.jsx("td",{children:lc(P)})]},w.id||C)})})]}),S.length>100&&d.jsxs("div",{className:"table-footer",children:["Showing first 100 of ",S.length," entries. Export to CSV for complete data."]})]})]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function qc(n){return n+.5|0}const Ka=(n,e,t)=>Math.max(Math.min(n,t),e);function gc(n){return Ka(qc(n*2.55),0,255)}function ts(n){return Ka(qc(n*255),0,255)}function ua(n){return Ka(qc(n/2.55)/100,0,1)}function Zv(n){return Ka(qc(n*100),0,100)}const nr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},np=[..."0123456789ABCDEF"],YE=n=>np[n&15],$E=n=>np[(n&240)>>4]+np[n&15],ud=n=>(n&240)>>4===(n&15),XE=n=>ud(n.r)&&ud(n.g)&&ud(n.b)&&ud(n.a);function qE(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&nr[n[1]]*17,g:255&nr[n[2]]*17,b:255&nr[n[3]]*17,a:e===5?nr[n[4]]*17:255}:(e===7||e===9)&&(t={r:nr[n[1]]<<4|nr[n[2]],g:nr[n[3]]<<4|nr[n[4]],b:nr[n[5]]<<4|nr[n[6]],a:e===9?nr[n[7]]<<4|nr[n[8]]:255})),t}const KE=(n,e)=>n<255?e(n):"";function ZE(n){var e=XE(n)?YE:$E;return n?"#"+e(n.r)+e(n.g)+e(n.b)+KE(n.a,e):void 0}const JE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function bb(n,e,t){const i=e*Math.min(t,1-t),r=(s,l=(s+n/30)%12)=>t-i*Math.max(Math.min(l-3,9-l,1),-1);return[r(0),r(8),r(4)]}function QE(n,e,t){const i=(r,s=(r+n/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function e4(n,e,t){const i=bb(n,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)i[r]*=1-e-t,i[r]+=e;return i}function t4(n,e,t,i,r){return n===r?(e-t)/i+(e<t?6:0):e===r?(t-n)/i+2:(n-e)/i+4}function wp(n){const t=n.r/255,i=n.g/255,r=n.b/255,s=Math.max(t,i,r),l=Math.min(t,i,r),u=(s+l)/2;let f,m,p;return s!==l&&(p=s-l,m=u>.5?p/(2-s-l):p/(s+l),f=t4(t,i,r,p,s),f=f*60+.5),[f|0,m||0,u]}function Ep(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(ts)}function Ap(n,e,t){return Ep(bb,n,e,t)}function n4(n,e,t){return Ep(e4,n,e,t)}function i4(n,e,t){return Ep(QE,n,e,t)}function Sb(n){return(n%360+360)%360}function r4(n){const e=JE.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?gc(+e[5]):ts(+e[5]));const r=Sb(+e[2]),s=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?i=n4(r,s,l):e[1]==="hsv"?i=i4(r,s,l):i=Ap(r,s,l),{r:i[0],g:i[1],b:i[2],a:t}}function a4(n,e){var t=wp(n);t[0]=Sb(t[0]+e),t=Ap(t),n.r=t[0],n.g=t[1],n.b=t[2]}function s4(n){if(!n)return;const e=wp(n),t=e[0],i=Zv(e[1]),r=Zv(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${r}%, ${ua(n.a)})`:`hsl(${t}, ${i}%, ${r}%)`}const Jv={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Qv={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function o4(){const n={},e=Object.keys(Qv),t=Object.keys(Jv);let i,r,s,l,u;for(i=0;i<e.length;i++){for(l=u=e[i],r=0;r<t.length;r++)s=t[r],u=u.replace(s,Jv[s]);s=parseInt(Qv[l],16),n[u]=[s>>16&255,s>>8&255,s&255]}return n}let dd;function l4(n){dd||(dd=o4(),dd.transparent=[0,0,0,0]);const e=dd[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const c4=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function u4(n){const e=c4.exec(n);let t=255,i,r,s;if(e){if(e[7]!==i){const l=+e[7];t=e[8]?gc(l):Ka(l*255,0,255)}return i=+e[1],r=+e[3],s=+e[5],i=255&(e[2]?gc(i):Ka(i,0,255)),r=255&(e[4]?gc(r):Ka(r,0,255)),s=255&(e[6]?gc(s):Ka(s,0,255)),{r:i,g:r,b:s,a:t}}}function d4(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${ua(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Om=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Bo=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function f4(n,e,t){const i=Bo(ua(n.r)),r=Bo(ua(n.g)),s=Bo(ua(n.b));return{r:ts(Om(i+t*(Bo(ua(e.r))-i))),g:ts(Om(r+t*(Bo(ua(e.g))-r))),b:ts(Om(s+t*(Bo(ua(e.b))-s))),a:n.a+t*(e.a-n.a)}}function fd(n,e,t){if(n){let i=wp(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=Ap(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function _b(n,e){return n&&Object.assign(e||{},n)}function ey(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=ts(n[3]))):(e=_b(n,{r:0,g:0,b:0,a:1}),e.a=ts(e.a)),e}function h4(n){return n.charAt(0)==="r"?u4(n):r4(n)}class Oc{constructor(e){if(e instanceof Oc)return e;const t=typeof e;let i;t==="object"?i=ey(e):t==="string"&&(i=qE(e)||l4(e)||h4(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=_b(this._rgb);return e&&(e.a=ua(e.a)),e}set rgb(e){this._rgb=ey(e)}rgbString(){return this._valid?d4(this._rgb):void 0}hexString(){return this._valid?ZE(this._rgb):void 0}hslString(){return this._valid?s4(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,r=e.rgb;let s;const l=t===s?.5:t,u=2*l-1,f=i.a-r.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;s=1-m,i.r=255&m*i.r+s*r.r+.5,i.g=255&m*i.g+s*r.g+.5,i.b=255&m*i.b+s*r.b+.5,i.a=l*i.a+(1-l)*r.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=f4(this._rgb,e._rgb,t)),this}clone(){return new Oc(this.rgb)}alpha(e){return this._rgb.a=ts(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=qc(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return fd(this._rgb,2,e),this}darken(e){return fd(this._rgb,2,-e),this}saturate(e){return fd(this._rgb,1,e),this}desaturate(e){return fd(this._rgb,1,-e),this}rotate(e){return a4(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function oa(){}const m4=(()=>{let n=0;return()=>n++})();function pt(n){return n==null}function Qt(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function gt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Ai(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Mr(n,e){return Ai(n)?n:e}function rt(n,e){return typeof n>"u"?e:n}const p4=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,Tb=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Ht(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function Dt(n,e,t,i){let r,s,l;if(Qt(n))for(s=n.length,r=0;r<s;r++)e.call(t,n[r],r);else if(gt(n))for(l=Object.keys(n),s=l.length,r=0;r<s;r++)e.call(t,n[l[r]],l[r])}function Hd(n,e){let t,i,r,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(r=n[t],s=e[t],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Wd(n){if(Qt(n))return n.map(Wd);if(gt(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let r=0;for(;r<i;++r)e[t[r]]=Wd(n[t[r]]);return e}return n}function wb(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function g4(n,e,t,i){if(!wb(n))return;const r=e[n],s=t[n];gt(r)&&gt(s)?Rc(r,s,i):e[n]=Wd(s)}function Rc(n,e,t){const i=Qt(e)?e:[e],r=i.length;if(!gt(n))return n;t=t||{};const s=t.merger||g4;let l;for(let u=0;u<r;++u){if(l=i[u],!gt(l))continue;const f=Object.keys(l);for(let m=0,p=f.length;m<p;++m)s(f[m],n,l,t)}return n}function Sc(n,e){return Rc(n,e,{merger:v4})}function v4(n,e,t){if(!wb(n))return;const i=e[n],r=t[n];gt(i)&&gt(r)?Sc(i,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Wd(r))}const ty={"":n=>n,x:n=>n.x,y:n=>n.y};function y4(n){const e=n.split("."),t=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function x4(n){const e=y4(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function ns(n,e){return(ty[e]||(ty[e]=x4(e)))(n)}function kp(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Mc=n=>typeof n<"u",is=n=>typeof n=="function",ny=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function b4(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const wt=Math.PI,Xt=2*wt,S4=Xt+wt,Vd=Number.POSITIVE_INFINITY,_4=wt/180,un=wt/2,Os=wt/4,iy=wt*2/3,Eb=Math.log10,zr=Math.sign;function _c(n,e,t){return Math.abs(n-e)<t}function ry(n){const e=Math.round(n);n=_c(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(Eb(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function T4(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((r,s)=>r-s).pop(),e}function w4(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Lc(n){return!w4(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function E4(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function A4(n,e,t){let i,r,s;for(i=0,r=n.length;i<r;i++)s=n[i][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function Fr(n){return n*(wt/180)}function Cp(n){return n*(180/wt)}function ay(n){if(!Ai(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function Ab(n,e){const t=e.x-n.x,i=e.y-n.y,r=Math.sqrt(t*t+i*i);let s=Math.atan2(i,t);return s<-.5*wt&&(s+=Xt),{angle:s,distance:r}}function ip(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function k4(n,e){return(n-e+S4)%Xt-wt}function Ti(n){return(n%Xt+Xt)%Xt}function Ic(n,e,t,i){const r=Ti(n),s=Ti(e),l=Ti(t),u=Ti(s-r),f=Ti(l-r),m=Ti(r-s),p=Ti(r-l);return r===s||r===l||i&&s===l||u>f&&m<p}function Jn(n,e,t){return Math.max(e,Math.min(t,n))}function C4(n){return Jn(n,-32768,32767)}function Za(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function jp(n,e,t){t=t||(l=>n[l]<e);let i=n.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,t(s)?r=s:i=s;return{lo:r,hi:i}}const zs=(n,e,t,i)=>jp(n,t,i?r=>{const s=n[r][e];return s<t||s===t&&n[r+1][e]===t}:r=>n[r][e]<t),j4=(n,e,t)=>jp(n,t,i=>n[i][e]>=t);function D4(n,e,t){let i=0,r=n.length;for(;i<r&&n[i]<e;)i++;for(;r>i&&n[r-1]>t;)r--;return i>0||r<n.length?n.slice(i,r):n}const kb=["push","pop","shift","splice","unshift"];function N4(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),kb.forEach(t=>{const i="_onData"+kp(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){const l=r.apply(this,s);return n._chartjs.listeners.forEach(u=>{typeof u[i]=="function"&&u[i](...s)}),l}})})}function sy(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(kb.forEach(s=>{delete n[s]}),delete n._chartjs)}function Cb(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const jb=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Db(n,e){let t=[],i=!1;return function(...r){t=r,i||(i=!0,jb.call(window,()=>{i=!1,n.apply(e,t)}))}}function O4(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const Dp=n=>n==="start"?"left":n==="end"?"right":"center",Zn=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,R4=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function M4(n,e,t){const i=e.length;let r=0,s=i;if(n._sorted){const{iScale:l,vScale:u,_parsed:f}=n,m=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,p=l.axis,{min:v,max:y,minDefined:S,maxDefined:_}=l.getUserBounds();if(S){if(r=Math.min(zs(f,p,v).lo,t?i:zs(e,p,l.getPixelForValue(v)).lo),m){const b=f.slice(0,r+1).reverse().findIndex(T=>!pt(T[u.axis]));r-=Math.max(0,b)}r=Jn(r,0,i-1)}if(_){let b=Math.max(zs(f,l.axis,y,!0).hi+1,t?0:zs(e,p,l.getPixelForValue(y),!0).hi+1);if(m){const T=f.slice(b-1).findIndex(E=>!pt(E[u.axis]));b+=Math.max(0,T)}s=Jn(b,r,i)-r}else s=i-r}return{start:r,count:s}}function L4(n){const{xScale:e,yScale:t,_scaleRanges:i}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=r,!0;const s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,r),s}const hd=n=>n===0||n===1,oy=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Xt/t)),ly=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Xt/t)+1,Tc={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*un)+1,easeOutSine:n=>Math.sin(n*un),easeInOutSine:n=>-.5*(Math.cos(wt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>hd(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>hd(n)?n:oy(n,.075,.3),easeOutElastic:n=>hd(n)?n:ly(n,.075,.3),easeInOutElastic(n){return hd(n)?n:n<.5?.5*oy(n*2,.1125,.45):.5+.5*ly(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Tc.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Tc.easeInBounce(n*2)*.5:Tc.easeOutBounce(n*2-1)*.5+.5};function Np(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function cy(n){return Np(n)?n:new Oc(n)}function Rm(n){return Np(n)?n:new Oc(n).saturate(.5).darken(.1).hexString()}const I4=["x","y","borderWidth","radius","tension"],P4=["color","borderColor","backgroundColor"];function B4(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:P4},numbers:{type:"number",properties:I4}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function F4(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const uy=new Map;function z4(n,e){e=e||{};const t=n+JSON.stringify(e);let i=uy.get(t);return i||(i=new Intl.NumberFormat(n,e),uy.set(t,i)),i}function Op(n,e,t){return z4(e,t).format(n)}const U4={values(n){return Qt(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let r,s=n;if(t.length>1){const m=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(m<1e-4||m>1e15)&&(r="scientific"),s=H4(n,t)}const l=Eb(Math.abs(s)),u=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),f={notation:r,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),Op(n,i,f)}};function H4(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var Rp={formatters:U4};function W4(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Rp.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Vs=Object.create(null),rp=Object.create(null);function wc(n,e){if(!e)return n;const t=e.split(".");for(let i=0,r=t.length;i<r;++i){const s=t[i];n=n[s]||(n[s]=Object.create(null))}return n}function Mm(n,e,t){return typeof e=="string"?Rc(wc(n,e),t):Rc(wc(n,""),e)}class V4{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>Rm(r.backgroundColor),this.hoverBorderColor=(i,r)=>Rm(r.borderColor),this.hoverColor=(i,r)=>Rm(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Mm(this,e,t)}get(e){return wc(this,e)}describe(e,t){return Mm(rp,e,t)}override(e,t){return Mm(Vs,e,t)}route(e,t,i,r){const s=wc(this,e),l=wc(this,i),u="_"+t;Object.defineProperties(s,{[u]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const f=this[u],m=l[r];return gt(f)?Object.assign({},m,f):rt(f,m)},set(f){this[u]=f}}})}apply(e){e.forEach(t=>t(this))}}var sn=new V4({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[B4,F4,W4]);function G4(n){return!n||pt(n.size)||pt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Gd(n,e,t,i,r){let s=e[r];return s||(s=e[r]=n.measureText(r).width,t.push(r)),s>i&&(i=s),i}function Y4(n,e,t,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},s=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let l=0;const u=t.length;let f,m,p,v,y;for(f=0;f<u;f++)if(v=t[f],v!=null&&!Qt(v))l=Gd(n,r,s,l,v);else if(Qt(v))for(m=0,p=v.length;m<p;m++)y=v[m],y!=null&&!Qt(y)&&(l=Gd(n,r,s,l,y));n.restore();const S=s.length/2;if(S>t.length){for(f=0;f<S;f++)delete r[s[f]];s.splice(0,S)}return l}function Rs(n,e,t){const i=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*i)/i+r}function dy(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function ap(n,e,t,i){Nb(n,e,t,i,null)}function Nb(n,e,t,i,r){let s,l,u,f,m,p,v,y;const S=e.pointStyle,_=e.rotation,b=e.radius;let T=(_||0)*_4;if(S&&typeof S=="object"&&(s=S.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(T),n.drawImage(S,-S.width/2,-S.height/2,S.width,S.height),n.restore();return}if(!(isNaN(b)||b<=0)){switch(n.beginPath(),S){default:r?n.ellipse(t,i,r/2,b,0,0,Xt):n.arc(t,i,b,0,Xt),n.closePath();break;case"triangle":p=r?r/2:b,n.moveTo(t+Math.sin(T)*p,i-Math.cos(T)*b),T+=iy,n.lineTo(t+Math.sin(T)*p,i-Math.cos(T)*b),T+=iy,n.lineTo(t+Math.sin(T)*p,i-Math.cos(T)*b),n.closePath();break;case"rectRounded":m=b*.516,f=b-m,l=Math.cos(T+Os)*f,v=Math.cos(T+Os)*(r?r/2-m:f),u=Math.sin(T+Os)*f,y=Math.sin(T+Os)*(r?r/2-m:f),n.arc(t-v,i-u,m,T-wt,T-un),n.arc(t+y,i-l,m,T-un,T),n.arc(t+v,i+u,m,T,T+un),n.arc(t-y,i+l,m,T+un,T+wt),n.closePath();break;case"rect":if(!_){f=Math.SQRT1_2*b,p=r?r/2:f,n.rect(t-p,i-f,2*p,2*f);break}T+=Os;case"rectRot":v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+y,i-l),n.lineTo(t+v,i+u),n.lineTo(t-y,i+l),n.closePath();break;case"crossRot":T+=Os;case"cross":v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+y,i-l),n.lineTo(t-y,i+l);break;case"star":v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+y,i-l),n.lineTo(t-y,i+l),T+=Os,v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+y,i-l),n.lineTo(t-y,i+l);break;case"line":l=r?r/2:Math.cos(T)*b,u=Math.sin(T)*b,n.moveTo(t-l,i-u),n.lineTo(t+l,i+u);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(T)*(r?r/2:b),i+Math.sin(T)*b);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function da(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Mp(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Lp(n){n.restore()}function $4(n,e,t,i,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){const s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else r==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function X4(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function q4(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),pt(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function K4(n,e,t,i,r){if(r.strikethrough||r.underline){const s=n.measureText(i),l=e-s.actualBoundingBoxLeft,u=e+s.actualBoundingBoxRight,f=t-s.actualBoundingBoxAscent,m=t+s.actualBoundingBoxDescent,p=r.strikethrough?(f+m)/2:m;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(l,p),n.lineTo(u,p),n.stroke()}}function Z4(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Gs(n,e,t,i,r,s={}){const l=Qt(e)?e:[e],u=s.strokeWidth>0&&s.strokeColor!=="";let f,m;for(n.save(),n.font=r.string,q4(n,s),f=0;f<l.length;++f)m=l[f],s.backdrop&&Z4(n,s.backdrop),u&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),pt(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(m,t,i,s.maxWidth)),n.fillText(m,t,i,s.maxWidth),K4(n,t,i,m,s),i+=Number(r.lineHeight);n.restore()}function Pc(n,e){const{x:t,y:i,w:r,h:s,radius:l}=e;n.arc(t+l.topLeft,i+l.topLeft,l.topLeft,1.5*wt,wt,!0),n.lineTo(t,i+s-l.bottomLeft),n.arc(t+l.bottomLeft,i+s-l.bottomLeft,l.bottomLeft,wt,un,!0),n.lineTo(t+r-l.bottomRight,i+s),n.arc(t+r-l.bottomRight,i+s-l.bottomRight,l.bottomRight,un,0,!0),n.lineTo(t+r,i+l.topRight),n.arc(t+r-l.topRight,i+l.topRight,l.topRight,0,-un,!0),n.lineTo(t+l.topLeft,i)}const J4=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Q4=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function eA(n,e){const t=(""+n).match(J4);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const tA=n=>+n||0;function Ip(n,e){const t={},i=gt(e),r=i?Object.keys(e):e,s=gt(n)?i?l=>rt(n[l],n[e[l]]):l=>n[l]:()=>n;for(const l of r)t[l]=tA(s(l));return t}function Ob(n){return Ip(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Us(n){return Ip(n,["topLeft","topRight","bottomLeft","bottomRight"])}function ti(n){const e=Ob(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function En(n,e){n=n||{},e=e||sn.font;let t=rt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=rt(n.style,e.style);i&&!(""+i).match(Q4)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:rt(n.family,e.family),lineHeight:eA(rt(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:rt(n.weight,e.weight),string:""};return r.string=G4(r),r}function md(n,e,t,i){let r,s,l;for(r=0,s=n.length;r<s;++r)if(l=n[r],l!==void 0&&l!==void 0)return l}function nA(n,e,t){const{min:i,max:r}=n,s=Tb(e,(r-i)/2),l=(u,f)=>t&&u===0?0:u+f;return{min:l(i,-Math.abs(s)),max:l(r,s)}}function os(n,e){return Object.assign(Object.create(n),e)}function Pp(n,e=[""],t,i,r=()=>n[0]){const s=t||n;typeof i>"u"&&(i=Ib("_fallback",n));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:i,_getTarget:r,override:u=>Pp([u,...n],e,s,i)};return new Proxy(l,{deleteProperty(u,f){return delete u[f],delete u._keys,delete n[0][f],!0},get(u,f){return Mb(u,f,()=>uA(f,e,n,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(u,f){return hy(u).includes(f)},ownKeys(u){return hy(u)},set(u,f,m){const p=u._storage||(u._storage=r());return u[f]=p[f]=m,delete u._keys,!0}})}function Jo(n,e,t,i){const r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:Rb(n,i),setContext:s=>Jo(n,s,t,i),override:s=>Jo(n.override(s),e,t,i)};return new Proxy(r,{deleteProperty(s,l){return delete s[l],delete n[l],!0},get(s,l,u){return Mb(s,l,()=>rA(s,l,u))},getOwnPropertyDescriptor(s,l){return s._descriptors.allKeys?Reflect.has(n,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,l)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,l){return Reflect.has(n,l)},ownKeys(){return Reflect.ownKeys(n)},set(s,l,u){return n[l]=u,delete s[l],!0}})}function Rb(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:i,isScriptable:is(t)?t:()=>t,isIndexable:is(i)?i:()=>i}}const iA=(n,e)=>n?n+kp(e):e,Bp=(n,e)=>gt(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Mb(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const i=t();return n[e]=i,i}function rA(n,e,t){const{_proxy:i,_context:r,_subProxy:s,_descriptors:l}=n;let u=i[e];return is(u)&&l.isScriptable(e)&&(u=aA(e,u,n,t)),Qt(u)&&u.length&&(u=sA(e,u,n,l.isIndexable)),Bp(e,u)&&(u=Jo(u,r,s&&s[e],l)),u}function aA(n,e,t,i){const{_proxy:r,_context:s,_subProxy:l,_stack:u}=t;if(u.has(n))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+n);u.add(n);let f=e(s,l||i);return u.delete(n),Bp(n,f)&&(f=Fp(r._scopes,r,n,f)),f}function sA(n,e,t,i){const{_proxy:r,_context:s,_subProxy:l,_descriptors:u}=t;if(typeof s.index<"u"&&i(n))return e[s.index%e.length];if(gt(e[0])){const f=e,m=r._scopes.filter(p=>p!==f);e=[];for(const p of f){const v=Fp(m,r,n,p);e.push(Jo(v,s,l&&l[n],u))}}return e}function Lb(n,e,t){return is(n)?n(e,t):n}const oA=(n,e)=>n===!0?e:typeof n=="string"?ns(e,n):void 0;function lA(n,e,t,i,r){for(const s of e){const l=oA(t,s);if(l){n.add(l);const u=Lb(l._fallback,t,r);if(typeof u<"u"&&u!==t&&u!==i)return u}else if(l===!1&&typeof i<"u"&&t!==i)return null}return!1}function Fp(n,e,t,i){const r=e._rootScopes,s=Lb(e._fallback,t,i),l=[...n,...r],u=new Set;u.add(i);let f=fy(u,l,t,s||t,i);return f===null||typeof s<"u"&&s!==t&&(f=fy(u,l,s,f,i),f===null)?!1:Pp(Array.from(u),[""],r,s,()=>cA(e,t,i))}function fy(n,e,t,i,r){for(;t;)t=lA(n,e,t,i,r);return t}function cA(n,e,t){const i=n._getTarget();e in i||(i[e]={});const r=i[e];return Qt(r)&&gt(t)?t:r||{}}function uA(n,e,t,i){let r;for(const s of e)if(r=Ib(iA(s,n),t),typeof r<"u")return Bp(n,r)?Fp(t,i,n,r):r}function Ib(n,e){for(const t of e){if(!t)continue;const i=t[n];if(typeof i<"u")return i}}function hy(n){let e=n._keys;return e||(e=n._keys=dA(n._scopes)),e}function dA(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}function fA(n,e,t,i){const{iScale:r}=n,{key:s="r"}=this._parsing,l=new Array(i);let u,f,m,p;for(u=0,f=i;u<f;++u)m=u+t,p=e[m],l[u]={r:r.parse(ns(p,s),m)};return l}const hA=Number.EPSILON||1e-14,Qo=(n,e)=>e<n.length&&!n[e].skip&&n[e],Pb=n=>n==="x"?"y":"x";function mA(n,e,t,i){const r=n.skip?e:n,s=e,l=t.skip?e:t,u=ip(s,r),f=ip(l,s);let m=u/(u+f),p=f/(u+f);m=isNaN(m)?0:m,p=isNaN(p)?0:p;const v=i*m,y=i*p;return{previous:{x:s.x-v*(l.x-r.x),y:s.y-v*(l.y-r.y)},next:{x:s.x+y*(l.x-r.x),y:s.y+y*(l.y-r.y)}}}function pA(n,e,t){const i=n.length;let r,s,l,u,f,m=Qo(n,0);for(let p=0;p<i-1;++p)if(f=m,m=Qo(n,p+1),!(!f||!m)){if(_c(e[p],0,hA)){t[p]=t[p+1]=0;continue}r=t[p]/e[p],s=t[p+1]/e[p],u=Math.pow(r,2)+Math.pow(s,2),!(u<=9)&&(l=3/Math.sqrt(u),t[p]=r*l*e[p],t[p+1]=s*l*e[p])}}function gA(n,e,t="x"){const i=Pb(t),r=n.length;let s,l,u,f=Qo(n,0);for(let m=0;m<r;++m){if(l=u,u=f,f=Qo(n,m+1),!u)continue;const p=u[t],v=u[i];l&&(s=(p-l[t])/3,u[`cp1${t}`]=p-s,u[`cp1${i}`]=v-s*e[m]),f&&(s=(f[t]-p)/3,u[`cp2${t}`]=p+s,u[`cp2${i}`]=v+s*e[m])}}function vA(n,e="x"){const t=Pb(e),i=n.length,r=Array(i).fill(0),s=Array(i);let l,u,f,m=Qo(n,0);for(l=0;l<i;++l)if(u=f,f=m,m=Qo(n,l+1),!!f){if(m){const p=m[e]-f[e];r[l]=p!==0?(m[t]-f[t])/p:0}s[l]=u?m?zr(r[l-1])!==zr(r[l])?0:(r[l-1]+r[l])/2:r[l-1]:r[l]}pA(n,r,s),gA(n,s,e)}function pd(n,e,t){return Math.max(Math.min(n,t),e)}function yA(n,e){let t,i,r,s,l,u=da(n[0],e);for(t=0,i=n.length;t<i;++t)l=s,s=u,u=t<i-1&&da(n[t+1],e),s&&(r=n[t],l&&(r.cp1x=pd(r.cp1x,e.left,e.right),r.cp1y=pd(r.cp1y,e.top,e.bottom)),u&&(r.cp2x=pd(r.cp2x,e.left,e.right),r.cp2y=pd(r.cp2y,e.top,e.bottom)))}function xA(n,e,t,i,r){let s,l,u,f;if(e.spanGaps&&(n=n.filter(m=>!m.skip)),e.cubicInterpolationMode==="monotone")vA(n,r);else{let m=i?n[n.length-1]:n[0];for(s=0,l=n.length;s<l;++s)u=n[s],f=mA(m,u,n[Math.min(s+1,l-(i?0:1))%l],e.tension),u.cp1x=f.previous.x,u.cp1y=f.previous.y,u.cp2x=f.next.x,u.cp2y=f.next.y,m=u}e.capBezierPoints&&yA(n,t)}function zp(){return typeof window<"u"&&typeof document<"u"}function Up(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Yd(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const mf=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function bA(n,e){return mf(n).getPropertyValue(e)}const SA=["top","right","bottom","left"];function Hs(n,e,t){const i={};t=t?"-"+t:"";for(let r=0;r<4;r++){const s=SA[r];i[s]=parseFloat(n[e+"-"+s+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const _A=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function TA(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:r,offsetY:s}=i;let l=!1,u,f;if(_A(r,s,n.target))u=r,f=s;else{const m=e.getBoundingClientRect();u=i.clientX-m.left,f=i.clientY-m.top,l=!0}return{x:u,y:f,box:l}}function Ls(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,r=mf(t),s=r.boxSizing==="border-box",l=Hs(r,"padding"),u=Hs(r,"border","width"),{x:f,y:m,box:p}=TA(n,t),v=l.left+(p&&u.left),y=l.top+(p&&u.top);let{width:S,height:_}=e;return s&&(S-=l.width+u.width,_-=l.height+u.height),{x:Math.round((f-v)/S*t.width/i),y:Math.round((m-y)/_*t.height/i)}}function wA(n,e,t){let i,r;if(e===void 0||t===void 0){const s=n&&Up(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{const l=s.getBoundingClientRect(),u=mf(s),f=Hs(u,"border","width"),m=Hs(u,"padding");e=l.width-m.width-f.width,t=l.height-m.height-f.height,i=Yd(u.maxWidth,s,"clientWidth"),r=Yd(u.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:i||Vd,maxHeight:r||Vd}}const gd=n=>Math.round(n*10)/10;function EA(n,e,t,i){const r=mf(n),s=Hs(r,"margin"),l=Yd(r.maxWidth,n,"clientWidth")||Vd,u=Yd(r.maxHeight,n,"clientHeight")||Vd,f=wA(n,e,t);let{width:m,height:p}=f;if(r.boxSizing==="content-box"){const y=Hs(r,"border","width"),S=Hs(r,"padding");m-=S.width+y.width,p-=S.height+y.height}return m=Math.max(0,m-s.width),p=Math.max(0,i?m/i:p-s.height),m=gd(Math.min(m,l,f.maxWidth)),p=gd(Math.min(p,u,f.maxHeight)),m&&!p&&(p=gd(m/2)),(e!==void 0||t!==void 0)&&i&&f.height&&p>f.height&&(p=f.height,m=gd(Math.floor(p*i))),{width:m,height:p}}function my(n,e,t){const i=e||1,r=Math.floor(n.height*i),s=Math.floor(n.width*i);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const l=n.canvas;return l.style&&(t||!l.style.height&&!l.style.width)&&(l.style.height=`${n.height}px`,l.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||l.height!==r||l.width!==s?(n.currentDevicePixelRatio=i,l.height=r,l.width=s,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const AA=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};zp()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function py(n,e){const t=bA(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Is(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function kA(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function CA(n,e,t,i){const r={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},l=Is(n,r,t),u=Is(r,s,t),f=Is(s,e,t),m=Is(l,u,t),p=Is(u,f,t);return Is(m,p,t)}const jA=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},DA=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function $o(n,e,t){return n?jA(e,t):DA()}function Bb(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function Fb(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function zb(n){return n==="angle"?{between:Ic,compare:k4,normalize:Ti}:{between:Za,compare:(e,t)=>e-t,normalize:e=>e}}function gy({start:n,end:e,count:t,loop:i,style:r}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:r}}function NA(n,e,t){const{property:i,start:r,end:s}=t,{between:l,normalize:u}=zb(i),f=e.length;let{start:m,end:p,loop:v}=n,y,S;if(v){for(m+=f,p+=f,y=0,S=f;y<S&&l(u(e[m%f][i]),r,s);++y)m--,p--;m%=f,p%=f}return p<m&&(p+=f),{start:m,end:p,loop:v,style:n.style}}function OA(n,e,t){if(!t)return[n];const{property:i,start:r,end:s}=t,l=e.length,{compare:u,between:f,normalize:m}=zb(i),{start:p,end:v,loop:y,style:S}=NA(n,e,t),_=[];let b=!1,T=null,E,w,C;const j=()=>f(r,C,E)&&u(r,C)!==0,k=()=>u(s,E)===0||f(s,C,E),P=()=>b||j(),D=()=>!b||k();for(let z=p,R=p;z<=v;++z)w=e[z%l],!w.skip&&(E=m(w[i]),E!==C&&(b=f(E,r,s),T===null&&P()&&(T=u(E,r)===0?z:R),T!==null&&D()&&(_.push(gy({start:T,end:z,loop:y,count:l,style:S})),T=null),R=z,C=E));return T!==null&&_.push(gy({start:T,end:v,loop:y,count:l,style:S})),_}function RA(n,e){const t=[],i=n.segments;for(let r=0;r<i.length;r++){const s=OA(i[r],n.points,e);s.length&&t.push(...s)}return t}function MA(n,e,t,i){let r=0,s=e-1;if(t&&!i)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(s+=r);s>r&&n[s%e].skip;)s--;return s%=e,{start:r,end:s}}function LA(n,e,t,i){const r=n.length,s=[];let l=e,u=n[e],f;for(f=e+1;f<=t;++f){const m=n[f%r];m.skip||m.stop?u.skip||(i=!1,s.push({start:e%r,end:(f-1)%r,loop:i}),e=l=m.stop?f:null):(l=f,u.skip&&(e=f)),u=m}return l!==null&&s.push({start:e%r,end:l%r,loop:i}),s}function IA(n,e){const t=n.points,i=n.options.spanGaps,r=t.length;if(!r)return[];const s=!!n._loop,{start:l,end:u}=MA(t,r,s,i);if(i===!0)return vy(n,[{start:l,end:u,loop:s}],t,e);const f=u<l?u+r:u,m=!!n._fullLoop&&l===0&&u===r-1;return vy(n,LA(t,l,f,m),t,e)}function vy(n,e,t,i){return!i||!i.setContext||!t?e:PA(n,e,t,i)}function PA(n,e,t,i){const r=n._chart.getContext(),s=yy(n.options),{_datasetIndex:l,options:{spanGaps:u}}=n,f=t.length,m=[];let p=s,v=e[0].start,y=v;function S(_,b,T,E){const w=u?-1:1;if(_!==b){for(_+=f;t[_%f].skip;)_-=w;for(;t[b%f].skip;)b+=w;_%f!==b%f&&(m.push({start:_%f,end:b%f,loop:T,style:E}),p=E,v=b%f)}}for(const _ of e){v=u?v:_.start;let b=t[v%f],T;for(y=v+1;y<=_.end;y++){const E=t[y%f];T=yy(i.setContext(os(r,{type:"segment",p0:b,p1:E,p0DataIndex:(y-1)%f,p1DataIndex:y%f,datasetIndex:l}))),BA(T,p)&&S(v,y-1,_.loop,p),b=E,p=T}v<y-1&&S(v,y-1,_.loop,p)}return m}function yy(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function BA(n,e){if(!e)return!1;const t=[],i=function(r,s){return Np(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(n,i)!==JSON.stringify(e,i)}function vd(n,e,t){return n.options.clip?n[t]:e[t]}function FA(n,e){const{xScale:t,yScale:i}=n;return t&&i?{left:vd(t,e,"left"),right:vd(t,e,"right"),top:vd(i,e,"top"),bottom:vd(i,e,"bottom")}:e}function zA(n,e){const t=e._clip;if(t.disabled)return!1;const i=FA(e,n.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:i.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class UA{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,r){const s=t.listeners[r],l=t.duration;s.forEach(u=>u({chart:e,initial:t.initial,numSteps:l,currentStep:Math.min(i-t.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=jb.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let l=s.length-1,u=!1,f;for(;l>=0;--l)f=s[l],f._active?(f._total>i.duration&&(i.duration=f._total),f.tick(e),u=!0):(s[l]=s[s.length-1],s.pop());u&&(r.draw(),this._notify(r,i,e,"progress")),s.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var la=new UA;const xy="transparent",HA={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=cy(n||xy),r=i.valid&&cy(e||xy);return r&&r.valid?r.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class WA{constructor(e,t,i,r){const s=t[i];r=md([e.to,r,s,e.from]);const l=md([e.from,s,r]);this._active=!0,this._fn=e.fn||HA[e.type||typeof l],this._easing=Tc[e.easing]||Tc.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=l,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,l=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=md([e.to,t,r,e.from]),this._from=md([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,r=this._prop,s=this._from,l=this._loop,u=this._to;let f;if(this._active=s!==u&&(l||t<i),!this._active){this._target[r]=u,this._notify(!0);return}if(t<0){this._target[r]=s;return}f=t/i%2,f=l&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[r]=this._fn(s,u,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][t]()}}class Ub{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!gt(e))return;const t=Object.keys(sn.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const s=e[r];if(!gt(s))return;const l={};for(const u of t)l[u]=s[u];(Qt(s.properties)&&s.properties||[r]).forEach(u=>{(u===r||!i.has(u))&&i.set(u,l)})})}_animateOptions(e,t){const i=t.options,r=GA(e,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&VA(e.options.$animations,i).then(()=>{e.options=i},()=>{}),s}_createAnimations(e,t){const i=this._properties,r=[],s=e.$animations||(e.$animations={}),l=Object.keys(t),u=Date.now();let f;for(f=l.length-1;f>=0;--f){const m=l[f];if(m.charAt(0)==="$")continue;if(m==="options"){r.push(...this._animateOptions(e,t));continue}const p=t[m];let v=s[m];const y=i.get(m);if(v)if(y&&v.active()){v.update(y,p,u);continue}else v.cancel();if(!y||!y.duration){e[m]=p;continue}s[m]=v=new WA(y,e,m,p),r.push(v)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return la.add(this._chart,i),!0}}function VA(n,e){const t=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const s=n[i[r]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function GA(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function by(n,e){const t=n&&n.options||{},i=t.reverse,r=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:i?s:r,end:i?r:s}}function YA(n,e,t){if(t===!1)return!1;const i=by(n,t),r=by(e,t);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function $A(n){let e,t,i,r;return gt(n)?(e=n.top,t=n.right,i=n.bottom,r=n.left):e=t=i=r=n,{top:e,right:t,bottom:i,left:r,disabled:n===!1}}function Hb(n,e){const t=[],i=n._getSortedDatasetMetas(e);let r,s;for(r=0,s=i.length;r<s;++r)t.push(i[r].index);return t}function Sy(n,e,t,i={}){const r=n.keys,s=i.mode==="single";let l,u,f,m;if(e===null)return;let p=!1;for(l=0,u=r.length;l<u;++l){if(f=+r[l],f===t){if(p=!0,i.all)continue;break}m=n.values[f],Ai(m)&&(s||e===0||zr(e)===zr(m))&&(e+=m)}return!p&&!i.all?0:e}function XA(n,e){const{iScale:t,vScale:i}=e,r=t.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",l=Object.keys(n),u=new Array(l.length);let f,m,p;for(f=0,m=l.length;f<m;++f)p=l[f],u[f]={[r]:p,[s]:n[p]};return u}function Lm(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function qA(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function KA(n){const{min:e,max:t,minDefined:i,maxDefined:r}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function ZA(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function _y(n,e,t,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const s=n[r.index];if(t&&s>0||!t&&s<0)return r.index}return null}function Ty(n,e){const{chart:t,_cachedMeta:i}=n,r=t._stacks||(t._stacks={}),{iScale:s,vScale:l,index:u}=i,f=s.axis,m=l.axis,p=qA(s,l,i),v=e.length;let y;for(let S=0;S<v;++S){const _=e[S],{[f]:b,[m]:T}=_,E=_._stacks||(_._stacks={});y=E[m]=ZA(r,p,b),y[u]=T,y._top=_y(y,l,!0,i.type),y._bottom=_y(y,l,!1,i.type);const w=y._visualValues||(y._visualValues={});w[u]=T}}function Im(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function JA(n,e){return os(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function QA(n,e,t){return os(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function cc(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const r of e){const s=r._stacks;if(!s||s[i]===void 0||s[i][t]===void 0)return;delete s[i][t],s[i]._visualValues!==void 0&&s[i]._visualValues[t]!==void 0&&delete s[i]._visualValues[t]}}}const Pm=n=>n==="reset"||n==="none",wy=(n,e)=>e?n:Object.assign({},n),e3=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:Hb(t,!0),values:null};class Kc{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Lm(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&cc(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),r=(v,y,S,_)=>v==="x"?y:v==="r"?_:S,s=t.xAxisID=rt(i.xAxisID,Im(e,"x")),l=t.yAxisID=rt(i.yAxisID,Im(e,"y")),u=t.rAxisID=rt(i.rAxisID,Im(e,"r")),f=t.indexAxis,m=t.iAxisID=r(f,s,l,u),p=t.vAxisID=r(f,l,s,u);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(l),t.rScale=this.getScaleForId(u),t.iScale=this.getScaleForId(m),t.vScale=this.getScaleForId(p)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&sy(this._data,this),e._stacked&&cc(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(gt(t)){const r=this._cachedMeta;this._data=XA(t,r)}else if(i!==t){if(i){sy(i,this);const r=this._cachedMeta;cc(r),r._parsed=[]}t&&Object.isExtensible(t)&&N4(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=t._stacked;t._stacked=Lm(t.vScale,t),t.stack!==i.stack&&(r=!0,cc(t),t.stack=i.stack),this._resyncElements(e),(r||s!==t._stacked)&&(Ty(this,t._parsed),t._stacked=Lm(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:l}=i,u=s.axis;let f=e===0&&t===r.length?!0:i._sorted,m=e>0&&i._parsed[e-1],p,v,y;if(this._parsing===!1)i._parsed=r,i._sorted=!0,y=r;else{Qt(r[e])?y=this.parseArrayData(i,r,e,t):gt(r[e])?y=this.parseObjectData(i,r,e,t):y=this.parsePrimitiveData(i,r,e,t);const S=()=>v[u]===null||m&&v[u]<m[u];for(p=0;p<t;++p)i._parsed[p+e]=v=y[p],f&&(S()&&(f=!1),m=v);i._sorted=f}l&&Ty(this,y)}parsePrimitiveData(e,t,i,r){const{iScale:s,vScale:l}=e,u=s.axis,f=l.axis,m=s.getLabels(),p=s===l,v=new Array(r);let y,S,_;for(y=0,S=r;y<S;++y)_=y+i,v[y]={[u]:p||s.parse(m[_],_),[f]:l.parse(t[_],_)};return v}parseArrayData(e,t,i,r){const{xScale:s,yScale:l}=e,u=new Array(r);let f,m,p,v;for(f=0,m=r;f<m;++f)p=f+i,v=t[p],u[f]={x:s.parse(v[0],p),y:l.parse(v[1],p)};return u}parseObjectData(e,t,i,r){const{xScale:s,yScale:l}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(r);let p,v,y,S;for(p=0,v=r;p<v;++p)y=p+i,S=t[y],m[p]={x:s.parse(ns(S,u),y),y:l.parse(ns(S,f),y)};return m}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const r=this.chart,s=this._cachedMeta,l=t[e.axis],u={keys:Hb(r,!0),values:t._stacks[e.axis]._visualValues};return Sy(u,l,s.index,{mode:i})}updateRangeFromParsed(e,t,i,r){const s=i[t.axis];let l=s===null?NaN:s;const u=r&&i._stacks[t.axis];r&&u&&(r.values=u,l=Sy(r,s,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,t){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&e===i.iScale,l=r.length,u=this._getOtherScale(e),f=e3(t,i,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:p,max:v}=KA(u);let y,S;function _(){S=r[y];const b=S[u.axis];return!Ai(S[e.axis])||p>b||v<b}for(y=0;y<l&&!(!_()&&(this.updateRangeFromParsed(m,e,S,f),s));++y);if(s){for(y=l-1;y>=0;--y)if(!_()){this.updateRangeFromParsed(m,e,S,f);break}}return m}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let r,s,l;for(r=0,s=t.length;r<s;++r)l=t[r][e.axis],Ai(l)&&i.push(l);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,r=t.vScale,s=this.getParsed(e);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=$A(rt(this.options.clip,YA(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,r=i.data||[],s=t.chartArea,l=[],u=this._drawStart||0,f=this._drawCount||r.length-u,m=this.options.drawActiveElementsOnTop;let p;for(i.dataset&&i.dataset.draw(e,s,u,f),p=u;p<u+f;++p){const v=r[p];v.hidden||(v.active&&m?l.push(v):v.draw(e,s))}for(p=0;p<l.length;++p)l[p].draw(e,s)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const r=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];s=l.$context||(l.$context=QA(this.getContext(),e,l)),s.parsed=this.getParsed(e),s.raw=r.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=JA(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=i,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const r=t==="active",s=this._cachedDataOpts,l=e+"-"+t,u=s[l],f=this.enableOptionSharing&&Mc(i);if(u)return wy(u,f);const m=this.chart.config,p=m.datasetElementScopeKeys(this._type,e),v=r?[`${e}Hover`,"hover",e,""]:[e,""],y=m.getOptionScopes(this.getDataset(),p),S=Object.keys(sn.elements[e]),_=()=>this.getContext(i,r,t),b=m.resolveNamedOptions(y,S,_,v);return b.$shared&&(b.$shared=f,s[l]=Object.freeze(wy(b,f))),b}_resolveAnimations(e,t,i){const r=this.chart,s=this._cachedDataOpts,l=`animation-${t}`,u=s[l];if(u)return u;let f;if(r.options.animation!==!1){const p=this.chart.config,v=p.datasetAnimationScopeKeys(this._type,t),y=p.getOptionScopes(this.getDataset(),v);f=p.createResolver(y,this.getContext(e,i,t))}const m=new Ub(r,f&&f.animations);return f&&f._cacheable&&(s[l]=Object.freeze(m)),m}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Pm(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),r=this._sharedOptions,s=this.getSharedOptions(i),l=this.includeOptions(t,s)||s!==r;return this.updateSharedOptions(s,t,i),{sharedOptions:s,includeOptions:l}}updateElement(e,t,i,r){Pm(r)?Object.assign(e,i):this._resolveAnimations(t,r).update(e,i)}updateSharedOptions(e,t,i){e&&!Pm(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,r){e.active=r;const s=this.getStyle(t,r);this._resolveAnimations(t,i,r).update(e,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];const r=i.length,s=t.length,l=Math.min(s,r);l&&this.parse(0,l),s>r?this._insertElements(r,s-r,e):s<r&&this._removeElements(s,r-s)}_insertElements(e,t,i=!0){const r=this._cachedMeta,s=r.data,l=e+t;let u;const f=m=>{for(m.length+=t,u=m.length-1;u>=l;u--)m[u]=m[u-t]};for(f(s),u=e;u<l;++u)s[u]=new this.dataElementType;this._parsing&&f(r._parsed),this.parse(e,t),i&&this.updateElements(s,e,t,"reset")}updateElements(e,t,i,r){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,t);i._stacked&&cc(i,r)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,r]=e;this[t](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function t3(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let r=0,s=t.length;r<s;r++)i=i.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=Cb(i.sort((r,s)=>r-s))}return n._cache.$bar}function n3(n){const e=n.iScale,t=t3(e,n.type);let i=e._length,r,s,l,u;const f=()=>{l===32767||l===-32768||(Mc(u)&&(i=Math.min(i,Math.abs(l-u)||i)),u=l)};for(r=0,s=t.length;r<s;++r)l=e.getPixelForValue(t[r]),f();for(u=void 0,r=0,s=e.ticks.length;r<s;++r)l=e.getPixelForTick(r),f();return i}function i3(n,e,t,i){const r=t.barThickness;let s,l;return pt(r)?(s=e.min*t.categoryPercentage,l=t.barPercentage):(s=r*i,l=1),{chunk:s/i,ratio:l,start:e.pixels[n]-s/2}}function r3(n,e,t,i){const r=e.pixels,s=r[n];let l=n>0?r[n-1]:null,u=n<r.length-1?r[n+1]:null;const f=t.categoryPercentage;l===null&&(l=s-(u===null?e.end-e.start:u-s)),u===null&&(u=s+s-l);const m=s-(s-Math.min(l,u))/2*f;return{chunk:Math.abs(u-l)/2*f/i,ratio:t.barPercentage,start:m}}function a3(n,e,t,i){const r=t.parse(n[0],i),s=t.parse(n[1],i),l=Math.min(r,s),u=Math.max(r,s);let f=l,m=u;Math.abs(l)>Math.abs(u)&&(f=u,m=l),e[t.axis]=m,e._custom={barStart:f,barEnd:m,start:r,end:s,min:l,max:u}}function Wb(n,e,t,i){return Qt(n)?a3(n,e,t,i):e[t.axis]=t.parse(n,i),e}function Ey(n,e,t,i){const r=n.iScale,s=n.vScale,l=r.getLabels(),u=r===s,f=[];let m,p,v,y;for(m=t,p=t+i;m<p;++m)y=e[m],v={},v[r.axis]=u||r.parse(l[m],m),f.push(Wb(y,v,s,m));return f}function Bm(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function s3(n,e,t){return n!==0?zr(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function o3(n){let e,t,i,r,s;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(r="end",s="start"):(r="start",s="end"),{start:t,end:i,reverse:e,top:r,bottom:s}}function l3(n,e,t,i){let r=e.borderSkipped;const s={};if(!r){n.borderSkipped=s;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:u,reverse:f,top:m,bottom:p}=o3(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?r=m:(t._bottom||0)===i?r=p:(s[Ay(p,l,u,f)]=!0,r=m)),s[Ay(r,l,u,f)]=!0,n.borderSkipped=s}function Ay(n,e,t,i){return i?(n=c3(n,e,t),n=ky(n,t,e)):n=ky(n,e,t),n}function c3(n,e,t){return n===e?t:n===t?e:n}function ky(n,e,t){return n==="start"?e:n==="end"?t:n}function u3(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class d3 extends Kc{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,i,r){return Ey(e,t,i,r)}parseArrayData(e,t,i,r){return Ey(e,t,i,r)}parseObjectData(e,t,i,r){const{iScale:s,vScale:l}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=s.axis==="x"?u:f,p=l.axis==="x"?u:f,v=[];let y,S,_,b;for(y=i,S=i+r;y<S;++y)b=t[y],_={},_[s.axis]=s.parse(ns(b,m),y),v.push(Wb(ns(b,p),_,l,y));return v}updateRangeFromParsed(e,t,i,r){super.updateRangeFromParsed(e,t,i,r);const s=i._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:r}=t,s=this.getParsed(e),l=s._custom,u=Bm(l)?"["+l.start+", "+l.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,r){const s=r==="reset",{index:l,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),p=this._getRuler(),{sharedOptions:v,includeOptions:y}=this._getSharedOptions(t,r);for(let S=t;S<t+i;S++){const _=this.getParsed(S),b=s||pt(_[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(S),T=this._calculateBarIndexPixels(S,p),E=(_._stacks||{})[u.axis],w={horizontal:m,base:b.base,enableBorderRadius:!E||Bm(_._custom)||l===E._top||l===E._bottom,x:m?b.head:T.center,y:m?T.center:b.head,height:m?T.size:Math.abs(b.size),width:m?Math.abs(b.size):T.size};y&&(w.options=v||this.resolveDataElementOptions(S,e[S].active?"active":r));const C=w.options||e[S].options;l3(w,C,E,l),u3(w,C,p.ratio),this.updateElement(e[S],S,w,r)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(p=>p.controller.options.grouped),s=i.options.stacked,l=[],u=this._cachedMeta.controller.getParsed(t),f=u&&u[i.axis],m=p=>{const v=p._parsed.find(S=>S[i.axis]===f),y=v&&v[p.vScale.axis];if(pt(y)||isNaN(y))return!0};for(const p of r)if(!(t!==void 0&&m(p))&&((s===!1||l.indexOf(p.stack)===-1||s===void 0&&p.stack===void 0)&&l.push(p.stack),p.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(i=>e[i].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)e[rt(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,i){const r=this._getStacks(e,i),s=t!==void 0?r.indexOf(t):-1;return s===-1?r.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,r=[];let s,l;for(s=0,l=t.data.length;s<l;++s)r.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const u=e.barThickness;return{min:u||n3(t),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:r},options:{base:s,minBarLength:l}}=this,u=s||0,f=this.getParsed(e),m=f._custom,p=Bm(m);let v=f[t.axis],y=0,S=i?this.applyStack(t,f,i):v,_,b;S!==v&&(y=S-v,S=v),p&&(v=m.barStart,S=m.barEnd-m.barStart,v!==0&&zr(v)!==zr(m.barEnd)&&(y=0),y+=v);const T=!pt(s)&&!p?s:y;let E=t.getPixelForValue(T);if(this.chart.getDataVisibility(e)?_=t.getPixelForValue(y+S):_=E,b=_-E,Math.abs(b)<l){b=s3(b,t,u)*l,v===u&&(E-=b/2);const w=t.getPixelForDecimal(0),C=t.getPixelForDecimal(1),j=Math.min(w,C),k=Math.max(w,C);E=Math.max(Math.min(E,k),j),_=E+b,i&&!p&&(f._stacks[t.axis]._visualValues[r]=t.getValueForPixel(_)-t.getValueForPixel(E))}if(E===t.getPixelForValue(u)){const w=zr(b)*t.getLineWidthForValue(u)/2;E+=w,b-=w}return{size:b,base:E,head:_,center:_+b/2}}_calculateBarIndexPixels(e,t){const i=t.scale,r=this.options,s=r.skipNull,l=rt(r.maxBarThickness,1/0);let u,f;const m=this._getAxisCount();if(t.grouped){const p=s?this._getStackCount(e):t.stackCount,v=r.barThickness==="flex"?r3(e,t,r,p*m):i3(e,t,r,p*m),y=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,S=this._getAxis().indexOf(rt(y,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+S;u=v.start+v.chunk*_+v.chunk/2,f=Math.min(l,v.chunk*v.ratio)}else u=i.getPixelForValue(this.getParsed(e)[i.axis],e),f=Math.min(l,t.min*t.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,r=i.length;let s=0;for(;s<r;++s)this.getParsed(s)[t.axis]!==null&&!i[s].hidden&&i[s].draw(this._ctx)}}function f3(n,e,t){let i=1,r=1,s=0,l=0;if(e<Xt){const u=n,f=u+e,m=Math.cos(u),p=Math.sin(u),v=Math.cos(f),y=Math.sin(f),S=(C,j,k)=>Ic(C,u,f,!0)?1:Math.max(j,j*t,k,k*t),_=(C,j,k)=>Ic(C,u,f,!0)?-1:Math.min(j,j*t,k,k*t),b=S(0,m,v),T=S(un,p,y),E=_(wt,m,v),w=_(wt+un,p,y);i=(b-E)/2,r=(T-w)/2,s=-(b+E)/2,l=-(T+w)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:l}}class h3 extends Kc{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:r}}=e.legend.options;return t.labels.map((s,l)=>{const f=e.getDatasetMeta(0).controller.getStyle(l);return{text:s,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:r,lineWidth:f.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let s=f=>+i[f];if(gt(i[e])){const{key:f="value"}=this._parsing;s=m=>+ns(i[m],f)}let l,u;for(l=e,u=e+t;l<u;++l)r._parsed[l]=s(l)}}_getRotation(){return Fr(this.options.rotation-90)}_getCircumference(){return Fr(this.options.circumference)}_getRotationExtents(){let e=Xt,t=-Xt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),l=r._getCircumference();e=Math.min(e,s),t=Math.max(t,s+l)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,r=this._cachedMeta,s=r.data,l=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,u=Math.max((Math.min(i.width,i.height)-l)/2,0),f=Math.min(p4(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:p,rotation:v}=this._getRotationExtents(),{ratioX:y,ratioY:S,offsetX:_,offsetY:b}=f3(v,p,f),T=(i.width-l)/y,E=(i.height-l)/S,w=Math.max(Math.min(T,E)/2,0),C=Tb(this.options.radius,w),j=Math.max(C*f,0),k=(C-j)/this._getVisibleDatasetWeightTotal();this.offsetX=_*C,this.offsetY=b*C,r.total=this.calculateTotal(),this.outerRadius=C-k*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-k*m,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*s/Xt)}updateElements(e,t,i,r){const s=r==="reset",l=this.chart,u=l.chartArea,m=l.options.animation,p=(u.left+u.right)/2,v=(u.top+u.bottom)/2,y=s&&m.animateScale,S=y?0:this.innerRadius,_=y?0:this.outerRadius,{sharedOptions:b,includeOptions:T}=this._getSharedOptions(t,r);let E=this._getRotation(),w;for(w=0;w<t;++w)E+=this._circumference(w,s);for(w=t;w<t+i;++w){const C=this._circumference(w,s),j=e[w],k={x:p+this.offsetX,y:v+this.offsetY,startAngle:E,endAngle:E+C,circumference:C,outerRadius:_,innerRadius:S};T&&(k.options=b||this.resolveDataElementOptions(w,j.active?"active":r)),E+=C,this.updateElement(j,w,k,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,r;for(r=0;r<t.length;r++){const s=e._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Xt*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=Op(t._parsed[e],i.options.locale);return{label:r[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const i=this.chart;let r,s,l,u,f;if(!e){for(r=0,s=i.data.datasets.length;r<s;++r)if(i.isDatasetVisible(r)){l=i.getDatasetMeta(r),e=l.data,u=l.controller;break}}if(!e)return 0;for(r=0,s=e.length;r<s;++r)f=u.resolveDataElementOptions(r),f.borderAlign!=="inner"&&(t=Math.max(t,f.borderWidth||0,f.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,r=e.length;i<r;++i){const s=this.resolveDataElementOptions(i);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(rt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class m3 extends Kc{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=t,l=this.chart._animationsDisabled;let{start:u,count:f}=M4(t,r,l);this._drawStart=u,this._drawCount=f,L4(t)&&(u=0,f=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const m=this.resolveDatasetElementOptions(e);this.options.showLine||(m.borderWidth=0),m.segment=this.options.segment,this.updateElement(i,void 0,{animated:!l,options:m},e),this.updateElements(r,u,f,e)}updateElements(e,t,i,r){const s=r==="reset",{iScale:l,vScale:u,_stacked:f,_dataset:m}=this._cachedMeta,{sharedOptions:p,includeOptions:v}=this._getSharedOptions(t,r),y=l.axis,S=u.axis,{spanGaps:_,segment:b}=this.options,T=Lc(_)?_:Number.POSITIVE_INFINITY,E=this.chart._animationsDisabled||s||r==="none",w=t+i,C=e.length;let j=t>0&&this.getParsed(t-1);for(let k=0;k<C;++k){const P=e[k],D=E?P:{};if(k<t||k>=w){D.skip=!0;continue}const z=this.getParsed(k),R=pt(z[S]),W=D[y]=l.getPixelForValue(z[y],k),q=D[S]=s||R?u.getBasePixel():u.getPixelForValue(f?this.applyStack(u,z,f):z[S],k);D.skip=isNaN(W)||isNaN(q)||R,D.stop=k>0&&Math.abs(z[y]-j[y])>T,b&&(D.parsed=z,D.raw=m.data[k]),v&&(D.options=p||this.resolveDataElementOptions(k,P.active?"active":r)),E||this.updateElement(P,k,D,r),j=z}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),l=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class p3 extends Kc{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,r){return fA.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta,i=t.dataset,r=t.data||[],s=t.iScale.getLabels();if(i.points=r,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const u={_loop:!0,_fullLoop:s.length===r.length,options:l};this.updateElement(i,void 0,u,e)}this.updateElements(r,0,r.length,e)}updateElements(e,t,i,r){const s=this._cachedMeta.rScale,l=r==="reset";for(let u=t;u<t+i;u++){const f=e[u],m=this.resolveDataElementOptions(u,f.active?"active":r),p=s.getPointPositionForValue(u,this.getParsed(u).r),v=l?s.xCenter:p.x,y=l?s.yCenter:p.y,S={x:v,y,angle:p.angle,skip:isNaN(v)||isNaN(y),options:m};this.updateElement(f,u,S,r)}}}function Ms(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Hp{static override(e){Object.assign(Hp.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Ms()}parse(){return Ms()}format(){return Ms()}add(){return Ms()}diff(){return Ms()}startOf(){return Ms()}endOf(){return Ms()}}var g3={_date:Hp};function v3(n,e,t,i){const{controller:r,data:s,_sorted:l}=n,u=r._cachedMeta.iScale,f=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(u&&e===u.axis&&e!=="r"&&l&&s.length){const m=u._reversePixels?j4:zs;if(i){if(r._sharedOptions){const p=s[0],v=typeof p.getRange=="function"&&p.getRange(e);if(v){const y=m(s,e,t-v),S=m(s,e,t+v);return{lo:y.lo,hi:S.hi}}}}else{const p=m(s,e,t);if(f){const{vScale:v}=r._cachedMeta,{_parsed:y}=n,S=y.slice(0,p.lo+1).reverse().findIndex(b=>!pt(b[v.axis]));p.lo-=Math.max(0,S);const _=y.slice(p.hi).findIndex(b=>!pt(b[v.axis]));p.hi+=Math.max(0,_)}return p}}return{lo:0,hi:s.length-1}}function pf(n,e,t,i,r){const s=n.getSortedVisibleDatasetMetas(),l=t[e];for(let u=0,f=s.length;u<f;++u){const{index:m,data:p}=s[u],{lo:v,hi:y}=v3(s[u],e,l,r);for(let S=v;S<=y;++S){const _=p[S];_.skip||i(_,m,S)}}}function y3(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,r){const s=e?Math.abs(i.x-r.x):0,l=t?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(l,2))}}function Fm(n,e,t,i,r){const s=[];return!r&&!n.isPointInArea(e)||pf(n,t,e,function(u,f,m){!r&&!da(u,n.chartArea,0)||u.inRange(e.x,e.y,i)&&s.push({element:u,datasetIndex:f,index:m})},!0),s}function x3(n,e,t,i){let r=[];function s(l,u,f){const{startAngle:m,endAngle:p}=l.getProps(["startAngle","endAngle"],i),{angle:v}=Ab(l,{x:e.x,y:e.y});Ic(v,m,p)&&r.push({element:l,datasetIndex:u,index:f})}return pf(n,t,e,s),r}function b3(n,e,t,i,r,s){let l=[];const u=y3(t);let f=Number.POSITIVE_INFINITY;function m(p,v,y){const S=p.inRange(e.x,e.y,r);if(i&&!S)return;const _=p.getCenterPoint(r);if(!(!!s||n.isPointInArea(_))&&!S)return;const T=u(e,_);T<f?(l=[{element:p,datasetIndex:v,index:y}],f=T):T===f&&l.push({element:p,datasetIndex:v,index:y})}return pf(n,t,e,m),l}function zm(n,e,t,i,r,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!i?x3(n,e,t,r):b3(n,e,t,i,r,s)}function Cy(n,e,t,i,r){const s=[],l=t==="x"?"inXRange":"inYRange";let u=!1;return pf(n,t,e,(f,m,p)=>{f[l]&&f[l](e[t],r)&&(s.push({element:f,datasetIndex:m,index:p}),u=u||f.inRange(e.x,e.y,r))}),i&&!u?[]:s}var S3={modes:{index(n,e,t,i){const r=Ls(e,n),s=t.axis||"x",l=t.includeInvisible||!1,u=t.intersect?Fm(n,r,s,i,l):zm(n,r,s,!1,i,l),f=[];return u.length?(n.getSortedVisibleDatasetMetas().forEach(m=>{const p=u[0].index,v=m.data[p];v&&!v.skip&&f.push({element:v,datasetIndex:m.index,index:p})}),f):[]},dataset(n,e,t,i){const r=Ls(e,n),s=t.axis||"xy",l=t.includeInvisible||!1;let u=t.intersect?Fm(n,r,s,i,l):zm(n,r,s,!1,i,l);if(u.length>0){const f=u[0].datasetIndex,m=n.getDatasetMeta(f).data;u=[];for(let p=0;p<m.length;++p)u.push({element:m[p],datasetIndex:f,index:p})}return u},point(n,e,t,i){const r=Ls(e,n),s=t.axis||"xy",l=t.includeInvisible||!1;return Fm(n,r,s,i,l)},nearest(n,e,t,i){const r=Ls(e,n),s=t.axis||"xy",l=t.includeInvisible||!1;return zm(n,r,s,t.intersect,i,l)},x(n,e,t,i){const r=Ls(e,n);return Cy(n,r,"x",t.intersect,i)},y(n,e,t,i){const r=Ls(e,n);return Cy(n,r,"y",t.intersect,i)}}};const Vb=["left","top","right","bottom"];function uc(n,e){return n.filter(t=>t.pos===e)}function jy(n,e){return n.filter(t=>Vb.indexOf(t.pos)===-1&&t.box.axis===e)}function dc(n,e){return n.sort((t,i)=>{const r=e?i:t,s=e?t:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function _3(n){const e=[];let t,i,r,s,l,u;for(t=0,i=(n||[]).length;t<i;++t)r=n[t],{position:s,options:{stack:l,stackWeight:u=1}}=r,e.push({index:t,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:l&&s+l,stackWeight:u});return e}function T3(n){const e={};for(const t of n){const{stack:i,pos:r,stackWeight:s}=t;if(!i||!Vb.includes(r))continue;const l=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=s}return e}function w3(n,e){const t=T3(n),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let s,l,u;for(s=0,l=n.length;s<l;++s){u=n[s];const{fullSize:f}=u.box,m=t[u.stack],p=m&&u.stackWeight/m.weight;u.horizontal?(u.width=p?p*i:f&&e.availableWidth,u.height=r):(u.width=i,u.height=p?p*r:f&&e.availableHeight)}return t}function E3(n){const e=_3(n),t=dc(e.filter(m=>m.box.fullSize),!0),i=dc(uc(e,"left"),!0),r=dc(uc(e,"right")),s=dc(uc(e,"top"),!0),l=dc(uc(e,"bottom")),u=jy(e,"x"),f=jy(e,"y");return{fullSize:t,leftAndTop:i.concat(s),rightAndBottom:r.concat(f).concat(l).concat(u),chartArea:uc(e,"chartArea"),vertical:i.concat(r).concat(f),horizontal:s.concat(l).concat(u)}}function Dy(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function Gb(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function A3(n,e,t,i){const{pos:r,box:s}=t,l=n.maxPadding;if(!gt(r)){t.size&&(n[r]-=t.size);const v=i[t.stack]||{size:0,count:1};v.size=Math.max(v.size,t.horizontal?s.height:s.width),t.size=v.size/v.count,n[r]+=t.size}s.getPadding&&Gb(l,s.getPadding());const u=Math.max(0,e.outerWidth-Dy(l,n,"left","right")),f=Math.max(0,e.outerHeight-Dy(l,n,"top","bottom")),m=u!==n.w,p=f!==n.h;return n.w=u,n.h=f,t.horizontal?{same:m,other:p}:{same:p,other:m}}function k3(n){const e=n.maxPadding;function t(i){const r=Math.max(e[i]-n[i],0);return n[i]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function C3(n,e){const t=e.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(l=>{s[l]=Math.max(e[l],t[l])}),s}return i(n?["left","right"]:["top","bottom"])}function vc(n,e,t,i){const r=[];let s,l,u,f,m,p;for(s=0,l=n.length,m=0;s<l;++s){u=n[s],f=u.box,f.update(u.width||e.w,u.height||e.h,C3(u.horizontal,e));const{same:v,other:y}=A3(e,t,u,i);m|=v&&r.length,p=p||y,f.fullSize||r.push(u)}return m&&vc(r,e,t,i)||p}function yd(n,e,t,i,r){n.top=t,n.left=e,n.right=e+i,n.bottom=t+r,n.width=i,n.height=r}function Ny(n,e,t,i){const r=t.padding;let{x:s,y:l}=e;for(const u of n){const f=u.box,m=i[u.stack]||{placed:0,weight:1},p=u.stackWeight/m.weight||1;if(u.horizontal){const v=e.w*p,y=m.size||f.height;Mc(m.start)&&(l=m.start),f.fullSize?yd(f,r.left,l,t.outerWidth-r.right-r.left,y):yd(f,e.left+m.placed,l,v,y),m.start=l,m.placed+=v,l=f.bottom}else{const v=e.h*p,y=m.size||f.width;Mc(m.start)&&(s=m.start),f.fullSize?yd(f,s,r.top,y,t.outerHeight-r.bottom-r.top):yd(f,s,e.top+m.placed,y,v),m.start=s,m.placed+=v,s=f.right}}e.x=s,e.y=l}var ar={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const r=ti(n.options.layout.padding),s=Math.max(e-r.width,0),l=Math.max(t-r.height,0),u=E3(n.boxes),f=u.vertical,m=u.horizontal;Dt(n.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const p=f.reduce((b,T)=>T.box.options&&T.box.options.display===!1?b:b+1,0)||1,v=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:s,availableHeight:l,vBoxMaxWidth:s/2/p,hBoxMaxHeight:l/2}),y=Object.assign({},r);Gb(y,ti(i));const S=Object.assign({maxPadding:y,w:s,h:l,x:r.left,y:r.top},r),_=w3(f.concat(m),v);vc(u.fullSize,S,v,_),vc(f,S,v,_),vc(m,S,v,_)&&vc(f,S,v,_),k3(S),Ny(u.leftAndTop,S,v,_),S.x+=S.w,S.y+=S.h,Ny(u.rightAndBottom,S,v,_),n.chartArea={left:S.left,top:S.top,right:S.left+S.w,bottom:S.top+S.h,height:S.h,width:S.w},Dt(u.chartArea,b=>{const T=b.box;Object.assign(T,n.chartArea),T.update(S.w,S.h,{left:0,top:0,right:0,bottom:0})})}};class Yb{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,r){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):i)}}isAttached(e){return!0}updateConfig(e){}}class j3 extends Yb{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Fd="$chartjs",D3={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Oy=n=>n===null||n==="";function N3(n,e){const t=n.style,i=n.getAttribute("height"),r=n.getAttribute("width");if(n[Fd]={initial:{height:i,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Oy(r)){const s=py(n,"width");s!==void 0&&(n.width=s)}if(Oy(i))if(n.style.height==="")n.height=n.width/(e||2);else{const s=py(n,"height");s!==void 0&&(n.height=s)}return n}const $b=AA?{passive:!0}:!1;function O3(n,e,t){n&&n.addEventListener(e,t,$b)}function R3(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,$b)}function M3(n,e){const t=D3[n.type]||n.type,{x:i,y:r}=Ls(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:r!==void 0?r:null}}function $d(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function L3(n,e,t){const i=n.canvas,r=new MutationObserver(s=>{let l=!1;for(const u of s)l=l||$d(u.addedNodes,i),l=l&&!$d(u.removedNodes,i);l&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function I3(n,e,t){const i=n.canvas,r=new MutationObserver(s=>{let l=!1;for(const u of s)l=l||$d(u.removedNodes,i),l=l&&!$d(u.addedNodes,i);l&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const Bc=new Map;let Ry=0;function Xb(){const n=window.devicePixelRatio;n!==Ry&&(Ry=n,Bc.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function P3(n,e){Bc.size||window.addEventListener("resize",Xb),Bc.set(n,e)}function B3(n){Bc.delete(n),Bc.size||window.removeEventListener("resize",Xb)}function F3(n,e,t){const i=n.canvas,r=i&&Up(i);if(!r)return;const s=Db((u,f)=>{const m=r.clientWidth;t(u,f),m<r.clientWidth&&t()},window),l=new ResizeObserver(u=>{const f=u[0],m=f.contentRect.width,p=f.contentRect.height;m===0&&p===0||s(m,p)});return l.observe(r),P3(n,s),l}function Um(n,e,t){t&&t.disconnect(),e==="resize"&&B3(n)}function z3(n,e,t){const i=n.canvas,r=Db(s=>{n.ctx!==null&&t(M3(s,n))},n);return O3(i,e,r),r}class U3 extends Yb{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(N3(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[Fd])return!1;const i=t[Fd].initial;["height","width"].forEach(s=>{const l=i[s];pt(l)?t.removeAttribute(s):t.setAttribute(s,l)});const r=i.style||{};return Object.keys(r).forEach(s=>{t.style[s]=r[s]}),t.width=t.width,delete t[Fd],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),l={attach:L3,detach:I3,resize:F3}[t]||z3;r[t]=l(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),r=i[t];if(!r)return;({attach:Um,detach:Um,resize:Um}[t]||R3)(e,t,r),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,r){return EA(e,t,i,r)}isAttached(e){const t=e&&Up(e);return!!(t&&t.isConnected)}}function H3(n){return!zp()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?j3:U3}class xa{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return Lc(this.x)&&Lc(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const r={};return e.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}}function W3(n,e){const t=n.options.ticks,i=V3(n),r=Math.min(t.maxTicksLimit||i,i),s=t.major.enabled?Y3(e):[],l=s.length,u=s[0],f=s[l-1],m=[];if(l>r)return $3(e,m,s,l/r),m;const p=G3(s,e,r);if(l>0){let v,y;const S=l>1?Math.round((f-u)/(l-1)):null;for(xd(e,m,p,pt(S)?0:u-S,u),v=0,y=l-1;v<y;v++)xd(e,m,p,s[v],s[v+1]);return xd(e,m,p,f,pt(S)?e.length:f+S),m}return xd(e,m,p),m}function V3(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(i,r))}function G3(n,e,t){const i=X3(n),r=e.length/t;if(!i)return Math.max(r,1);const s=T4(i);for(let l=0,u=s.length-1;l<u;l++){const f=s[l];if(f>r)return f}return Math.max(r,1)}function Y3(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function $3(n,e,t,i){let r=0,s=t[0],l;for(i=Math.ceil(i),l=0;l<n.length;l++)l===s&&(e.push(n[l]),r++,s=t[r*i])}function xd(n,e,t,i,r){const s=rt(i,0),l=Math.min(rt(r,n.length),n.length);let u=0,f,m,p;for(t=Math.ceil(t),r&&(f=r-i,t=f/Math.floor(f/t)),p=s;p<0;)u++,p=Math.round(s+u*t);for(m=Math.max(s,0);m<l;m++)m===p&&(e.push(n[m]),u++,p=Math.round(s+u*t))}function X3(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const q3=n=>n==="left"?"right":n==="right"?"left":n,My=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,Ly=(n,e)=>Math.min(e||n,n);function Iy(n,e){const t=[],i=n.length/e,r=n.length;let s=0;for(;s<r;s+=i)t.push(n[Math.floor(s)]);return t}function K3(n,e,t){const i=n.ticks.length,r=Math.min(e,i-1),s=n._startPixel,l=n._endPixel,u=1e-6;let f=n.getPixelForTick(r),m;if(!(t&&(i===1?m=Math.max(f-s,l-f):e===0?m=(n.getPixelForTick(1)-f)/2:m=(f-n.getPixelForTick(r-1))/2,f+=r<e?m:-m,f<s-u||f>l+u)))return f}function Z3(n,e){Dt(n,t=>{const i=t.gc,r=i.length/2;let s;if(r>e){for(s=0;s<r;++s)delete t.data[i[s]];i.splice(0,r)}})}function fc(n){return n.drawTicks?n.tickLength:0}function Py(n,e){if(!n.display)return 0;const t=En(n.font,e),i=ti(n.padding);return(Qt(n.text)?n.text.length:1)*t.lineHeight+i.height}function J3(n,e){return os(n,{scale:e,type:"scale"})}function Q3(n,e,t){return os(n,{tick:t,index:e,type:"tick"})}function e5(n,e,t){let i=Dp(n);return(t&&e!=="right"||!t&&e==="right")&&(i=q3(i)),i}function t5(n,e,t,i){const{top:r,left:s,bottom:l,right:u,chart:f}=n,{chartArea:m,scales:p}=f;let v=0,y,S,_;const b=l-r,T=u-s;if(n.isHorizontal()){if(S=Zn(i,s,u),gt(t)){const E=Object.keys(t)[0],w=t[E];_=p[E].getPixelForValue(w)+b-e}else t==="center"?_=(m.bottom+m.top)/2+b-e:_=My(n,t,e);y=u-s}else{if(gt(t)){const E=Object.keys(t)[0],w=t[E];S=p[E].getPixelForValue(w)-T+e}else t==="center"?S=(m.left+m.right)/2-T+e:S=My(n,t,e);_=Zn(i,l,r),v=t==="left"?-un:un}return{titleX:S,titleY:_,maxWidth:y,rotation:v}}class rl extends xa{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:r}=this;return e=Mr(e,Number.POSITIVE_INFINITY),t=Mr(t,Number.NEGATIVE_INFINITY),i=Mr(i,Number.POSITIVE_INFINITY),r=Mr(r,Number.NEGATIVE_INFINITY),{min:Mr(e,i),max:Mr(t,r),minDefined:Ai(e),maxDefined:Ai(t)}}getMinMax(e){let{min:t,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),l;if(r&&s)return{min:t,max:i};const u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)l=u[f].controller.getMinMax(this,e),r||(t=Math.min(t,l.min)),s||(i=Math.max(i,l.max));return t=s&&t>i?i:t,i=r&&t>i?t:i,{min:Mr(t,Mr(i,t)),max:Mr(i,Mr(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ht(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:r,grace:s,ticks:l}=this.options,u=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=nA(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?Iy(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=W3(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ht(this.options.afterUpdate,[this])}beforeSetDimensions(){Ht(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ht(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ht(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ht(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i],s.label=Ht(t.callback,[s.value,i,e],this)}afterTickToLabelConversion(){Ht(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ht(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=Ly(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,s=t.maxRotation;let l=r,u,f,m;if(!this._isVisible()||!t.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const p=this._getLabelSizes(),v=p.widest.width,y=p.highest.height,S=Jn(this.chart.width-v,0,this.maxWidth);u=e.offset?this.maxWidth/i:S/(i-1),v+6>u&&(u=S/(i-(e.offset?.5:1)),f=this.maxHeight-fc(e.grid)-t.padding-Py(e.title,this.chart.options.font),m=Math.sqrt(v*v+y*y),l=Cp(Math.min(Math.asin(Jn((p.highest.height+6)/u,-1,1)),Math.asin(Jn(f/m,-1,1))-Math.asin(Jn(y/m,-1,1)))),l=Math.max(r,Math.min(s,l))),this.labelRotation=l}afterCalculateLabelRotation(){Ht(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ht(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:r,grid:s}}=this,l=this._isVisible(),u=this.isHorizontal();if(l){const f=Py(r,t.options.font);if(u?(e.width=this.maxWidth,e.height=fc(s)+f):(e.height=this.maxHeight,e.width=fc(s)+f),i.display&&this.ticks.length){const{first:m,last:p,widest:v,highest:y}=this._getLabelSizes(),S=i.padding*2,_=Fr(this.labelRotation),b=Math.cos(_),T=Math.sin(_);if(u){const E=i.mirror?0:T*v.width+b*y.height;e.height=Math.min(this.maxHeight,e.height+E+S)}else{const E=i.mirror?0:b*v.width+T*y.height;e.width=Math.min(this.maxWidth,e.width+E+S)}this._calculatePadding(m,p,T,b)}}this._handleMargins(),u?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,r){const{ticks:{align:s,padding:l},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const p=this.getPixelForTick(0)-this.left,v=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,S=0;f?m?(y=r*e.width,S=i*t.height):(y=i*e.height,S=r*t.width):s==="start"?S=t.width:s==="end"?y=e.width:s!=="inner"&&(y=e.width/2,S=t.width/2),this.paddingLeft=Math.max((y-p+l)*this.width/(this.width-p),0),this.paddingRight=Math.max((S-v+l)*this.width/(this.width-v),0)}else{let p=t.height/2,v=e.height/2;s==="start"?(p=0,v=e.height):s==="end"&&(p=t.height,v=0),this.paddingTop=p+l,this.paddingBottom=v+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ht(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)pt(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=Iy(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){const{ctx:r,_longestTextCache:s}=this,l=[],u=[],f=Math.floor(t/Ly(t,i));let m=0,p=0,v,y,S,_,b,T,E,w,C,j,k;for(v=0;v<t;v+=f){if(_=e[v].label,b=this._resolveTickFontOptions(v),r.font=T=b.string,E=s[T]=s[T]||{data:{},gc:[]},w=b.lineHeight,C=j=0,!pt(_)&&!Qt(_))C=Gd(r,E.data,E.gc,C,_),j=w;else if(Qt(_))for(y=0,S=_.length;y<S;++y)k=_[y],!pt(k)&&!Qt(k)&&(C=Gd(r,E.data,E.gc,C,k),j+=w);l.push(C),u.push(j),m=Math.max(C,m),p=Math.max(j,p)}Z3(s,t);const P=l.indexOf(m),D=u.indexOf(p),z=R=>({width:l[R]||0,height:u[R]||0});return{first:z(0),last:z(t-1),widest:z(P),highest:z(D),widths:l,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return C4(this._alignToPixels?Rs(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=Q3(this.getContext(),e,i))}return this.$context||(this.$context=J3(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Fr(this.labelRotation),i=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),s=this._getLabelSizes(),l=e.autoSkipPadding||0,u=s?s.widest.width+l:0,f=s?s.highest.height+l:0;return this.isHorizontal()?f*i>u*r?u/i:f/r:f*r<u*i?f/i:u/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,r=this.options,{grid:s,position:l,border:u}=r,f=s.offset,m=this.isHorizontal(),v=this.ticks.length+(f?1:0),y=fc(s),S=[],_=u.setContext(this.getContext()),b=_.display?_.width:0,T=b/2,E=function(ne){return Rs(i,ne,b)};let w,C,j,k,P,D,z,R,W,q,J,me;if(l==="top")w=E(this.bottom),D=this.bottom-y,R=w-T,q=E(e.top)+T,me=e.bottom;else if(l==="bottom")w=E(this.top),q=e.top,me=E(e.bottom)-T,D=w+T,R=this.top+y;else if(l==="left")w=E(this.right),P=this.right-y,z=w-T,W=E(e.left)+T,J=e.right;else if(l==="right")w=E(this.left),W=e.left,J=E(e.right)-T,P=w+T,z=this.left+y;else if(t==="x"){if(l==="center")w=E((e.top+e.bottom)/2+.5);else if(gt(l)){const ne=Object.keys(l)[0],Z=l[ne];w=E(this.chart.scales[ne].getPixelForValue(Z))}q=e.top,me=e.bottom,D=w+T,R=D+y}else if(t==="y"){if(l==="center")w=E((e.left+e.right)/2);else if(gt(l)){const ne=Object.keys(l)[0],Z=l[ne];w=E(this.chart.scales[ne].getPixelForValue(Z))}P=w-T,z=P-y,W=e.left,J=e.right}const Ce=rt(r.ticks.maxTicksLimit,v),ve=Math.max(1,Math.ceil(v/Ce));for(C=0;C<v;C+=ve){const ne=this.getContext(C),Z=s.setContext(ne),be=u.setContext(ne),Ne=Z.lineWidth,V=Z.color,he=be.dash||[],I=be.dashOffset,Y=Z.tickWidth,G=Z.tickColor,K=Z.tickBorderDash||[],se=Z.tickBorderDashOffset;j=K3(this,C,f),j!==void 0&&(k=Rs(i,j,Ne),m?P=z=W=J=k:D=R=q=me=k,S.push({tx1:P,ty1:D,tx2:z,ty2:R,x1:W,y1:q,x2:J,y2:me,width:Ne,color:V,borderDash:he,borderDashOffset:I,tickWidth:Y,tickColor:G,tickBorderDash:K,tickBorderDashOffset:se}))}return this._ticksLength=v,this._borderValue=w,S}_computeLabelItems(e){const t=this.axis,i=this.options,{position:r,ticks:s}=i,l=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:p,mirror:v}=s,y=fc(i.grid),S=y+p,_=v?-p:S,b=-Fr(this.labelRotation),T=[];let E,w,C,j,k,P,D,z,R,W,q,J,me="middle";if(r==="top")P=this.bottom-_,D=this._getXAxisLabelAlignment();else if(r==="bottom")P=this.top+_,D=this._getXAxisLabelAlignment();else if(r==="left"){const ve=this._getYAxisLabelAlignment(y);D=ve.textAlign,k=ve.x}else if(r==="right"){const ve=this._getYAxisLabelAlignment(y);D=ve.textAlign,k=ve.x}else if(t==="x"){if(r==="center")P=(e.top+e.bottom)/2+S;else if(gt(r)){const ve=Object.keys(r)[0],ne=r[ve];P=this.chart.scales[ve].getPixelForValue(ne)+S}D=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")k=(e.left+e.right)/2-S;else if(gt(r)){const ve=Object.keys(r)[0],ne=r[ve];k=this.chart.scales[ve].getPixelForValue(ne)}D=this._getYAxisLabelAlignment(y).textAlign}t==="y"&&(f==="start"?me="top":f==="end"&&(me="bottom"));const Ce=this._getLabelSizes();for(E=0,w=u.length;E<w;++E){C=u[E],j=C.label;const ve=s.setContext(this.getContext(E));z=this.getPixelForTick(E)+s.labelOffset,R=this._resolveTickFontOptions(E),W=R.lineHeight,q=Qt(j)?j.length:1;const ne=q/2,Z=ve.color,be=ve.textStrokeColor,Ne=ve.textStrokeWidth;let V=D;l?(k=z,D==="inner"&&(E===w-1?V=this.options.reverse?"left":"right":E===0?V=this.options.reverse?"right":"left":V="center"),r==="top"?m==="near"||b!==0?J=-q*W+W/2:m==="center"?J=-Ce.highest.height/2-ne*W+W:J=-Ce.highest.height+W/2:m==="near"||b!==0?J=W/2:m==="center"?J=Ce.highest.height/2-ne*W:J=Ce.highest.height-q*W,v&&(J*=-1),b!==0&&!ve.showLabelBackdrop&&(k+=W/2*Math.sin(b))):(P=z,J=(1-q)*W/2);let he;if(ve.showLabelBackdrop){const I=ti(ve.backdropPadding),Y=Ce.heights[E],G=Ce.widths[E];let K=J-I.top,se=0-I.left;switch(me){case"middle":K-=Y/2;break;case"bottom":K-=Y;break}switch(D){case"center":se-=G/2;break;case"right":se-=G;break;case"inner":E===w-1?se-=G:E>0&&(se-=G/2);break}he={left:se,top:K,width:G+I.width,height:Y+I.height,color:ve.backdropColor}}T.push({label:j,font:R,textOffset:J,options:{rotation:b,color:Z,strokeColor:be,strokeWidth:Ne,textAlign:V,textBaseline:me,translation:[k,P],backdrop:he}})}return T}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Fr(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,l=this._getLabelSizes(),u=e+s,f=l.widest.width;let m,p;return t==="left"?r?(p=this.right+s,i==="near"?m="left":i==="center"?(m="center",p+=f/2):(m="right",p+=f)):(p=this.right-u,i==="near"?m="right":i==="center"?(m="center",p-=f/2):(m="left",p=this.left)):t==="right"?r?(p=this.left+s,i==="near"?m="right":i==="center"?(m="center",p-=f/2):(m="left",p-=f)):(p=this.left+u,i==="near"?m="left":i==="center"?(m="center",p+=f/2):(m="right",p=this.right)):m="right",{textAlign:m,x:p}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:r,width:s,height:l}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,r,s,l),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(s=>s.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,l;const u=(f,m,p)=>{!p.width||!p.color||(i.save(),i.lineWidth=p.width,i.strokeStyle=p.color,i.setLineDash(p.borderDash||[]),i.lineDashOffset=p.borderDashOffset,i.beginPath(),i.moveTo(f.x,f.y),i.lineTo(m.x,m.y),i.stroke(),i.restore())};if(t.display)for(s=0,l=r.length;s<l;++s){const f=r[s];t.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),t.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),l=i.display?s.width:0;if(!l)return;const u=r.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,p,v,y;this.isHorizontal()?(m=Rs(e,this.left,l)-l/2,p=Rs(e,this.right,u)+u/2,v=y=f):(v=Rs(e,this.top,l)-l/2,y=Rs(e,this.bottom,u)+u/2,m=p=f),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(m,v),t.lineTo(p,y),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&Mp(i,r);const s=this.getLabelItems(e);for(const l of s){const u=l.options,f=l.font,m=l.label,p=l.textOffset;Gs(i,m,0,p,f,u)}r&&Lp(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:r}}=this;if(!i.display)return;const s=En(i.font),l=ti(i.padding),u=i.align;let f=s.lineHeight/2;t==="bottom"||t==="center"||gt(t)?(f+=l.bottom,Qt(i.text)&&(f+=s.lineHeight*(i.text.length-1))):f+=l.top;const{titleX:m,titleY:p,maxWidth:v,rotation:y}=t5(this,f,t,u);Gs(e,i.text,0,0,s,{color:i.color,maxWidth:v,rotation:y,textAlign:e5(u,t,r),textBaseline:"middle",translation:[m,p]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=rt(e.grid&&e.grid.z,-1),r=rt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==rl.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,l;for(s=0,l=t.length;s<l;++s){const u=t[s];u[i]===this.id&&(!e||u.type===e)&&r.push(u)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return En(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class bd{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;r5(t)&&(i=this.register(t));const r=this.items,s=e.id,l=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,n5(e,l,i),this.override&&sn.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,r=this.scope;i in t&&delete t[i],r&&i in sn[r]&&(delete sn[r][i],this.override&&delete Vs[i])}}function n5(n,e,t){const i=Rc(Object.create(null),[t?sn.get(t):{},sn.get(e),n.defaults]);sn.set(e,i),n.defaultRoutes&&i5(e,n.defaultRoutes),n.descriptors&&sn.describe(e,n.descriptors)}function i5(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),r=i.pop(),s=[n].concat(i).join("."),l=e[t].split("."),u=l.pop(),f=l.join(".");sn.route(s,r,f,u)})}function r5(n){return"id"in n&&"defaults"in n}class a5{constructor(){this.controllers=new bd(Kc,"datasets",!0),this.elements=new bd(xa,"elements"),this.plugins=new bd(Object,"plugins"),this.scales=new bd(rl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(e,s,r):Dt(r,l=>{const u=i||this._getRegistryForType(l);this._exec(e,u,l)})})}_exec(e,t,i){const r=kp(e);Ht(i["before"+r],[],i),t[e](i),Ht(i["after"+r],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}}var Br=new a5;class s5{constructor(){this._init=[]}notify(e,t,i,r){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=r?this._descriptors(e).filter(r):this._descriptors(e),l=this._notify(s,e,t,i);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),l}_notify(e,t,i,r){r=r||{};for(const s of e){const l=s.plugin,u=l[i],f=[t,r,s.options];if(Ht(u,f,l)===!1&&r.cancelable)return!1}return!0}invalidate(){pt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,r=rt(i.options&&i.options.plugins,{}),s=o5(i);return r===!1&&!t?[]:c5(e,s,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,r=(s,l)=>s.filter(u=>!l.some(f=>u.plugin.id===f.plugin.id));this._notify(r(t,i),e,"stop"),this._notify(r(i,t),e,"start")}}function o5(n){const e={},t=[],i=Object.keys(Br.plugins.items);for(let s=0;s<i.length;s++)t.push(Br.getPlugin(i[s]));const r=n.plugins||[];for(let s=0;s<r.length;s++){const l=r[s];t.indexOf(l)===-1&&(t.push(l),e[l.id]=!0)}return{plugins:t,localIds:e}}function l5(n,e){return!e&&n===!1?null:n===!0?{}:n}function c5(n,{plugins:e,localIds:t},i,r){const s=[],l=n.getContext();for(const u of e){const f=u.id,m=l5(i[f],r);m!==null&&s.push({plugin:u,options:u5(n.config,{plugin:u,local:t[f]},m,l)})}return s}function u5(n,{plugin:e,local:t},i,r){const s=n.pluginScopeKeys(e),l=n.getOptionScopes(i,s);return t&&e.defaults&&l.push(e.defaults),n.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function sp(n,e){const t=sn.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function d5(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function f5(n,e){return n===e?"_index_":"_value_"}function By(n){if(n==="x"||n==="y"||n==="r")return n}function h5(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function op(n,...e){if(By(n))return n;for(const t of e){const i=t.axis||h5(t.position)||n.length>1&&By(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function Fy(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function m5(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(t.length)return Fy(n,"x",t[0])||Fy(n,"y",t[0])}return{}}function p5(n,e){const t=Vs[n.type]||{scales:{}},i=e.scales||{},r=sp(n.type,e),s=Object.create(null);return Object.keys(i).forEach(l=>{const u=i[l];if(!gt(u))return console.error(`Invalid scale configuration for scale: ${l}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const f=op(l,u,m5(l,n),sn.scales[u.type]),m=f5(f,r),p=t.scales||{};s[l]=Sc(Object.create(null),[{axis:f},u,p[f],p[m]])}),n.data.datasets.forEach(l=>{const u=l.type||n.type,f=l.indexAxis||sp(u,e),p=(Vs[u]||{}).scales||{};Object.keys(p).forEach(v=>{const y=d5(v,f),S=l[y+"AxisID"]||y;s[S]=s[S]||Object.create(null),Sc(s[S],[{axis:y},i[S],p[v]])})}),Object.keys(s).forEach(l=>{const u=s[l];Sc(u,[sn.scales[u.type],sn.scale])}),s}function qb(n){const e=n.options||(n.options={});e.plugins=rt(e.plugins,{}),e.scales=p5(n,e)}function Kb(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function g5(n){return n=n||{},n.data=Kb(n.data),qb(n),n}const zy=new Map,Zb=new Set;function Sd(n,e){let t=zy.get(n);return t||(t=e(),zy.set(n,t),Zb.add(t)),t}const hc=(n,e,t)=>{const i=ns(e,t);i!==void 0&&n.add(i)};class v5{constructor(e){this._config=g5(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Kb(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),qb(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Sd(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Sd(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Sd(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return Sd(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let r=i.get(e);return(!r||t)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,t,i){const{options:r,type:s}=this,l=this._cachedScopes(e,i),u=l.get(t);if(u)return u;const f=new Set;t.forEach(p=>{e&&(f.add(e),p.forEach(v=>hc(f,e,v))),p.forEach(v=>hc(f,r,v)),p.forEach(v=>hc(f,Vs[s]||{},v)),p.forEach(v=>hc(f,sn,v)),p.forEach(v=>hc(f,rp,v))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),Zb.has(t)&&l.set(t,m),m}chartOptionScopes(){const{options:e,type:t}=this;return[e,Vs[t]||{},sn.datasets[t]||{},{type:t},sn,rp]}resolveNamedOptions(e,t,i,r=[""]){const s={$shared:!0},{resolver:l,subPrefixes:u}=Uy(this._resolverCache,e,r);let f=l;if(x5(l,t)){s.$shared=!1,i=is(i)?i():i;const m=this.createResolver(e,i,u);f=Jo(l,i,m)}for(const m of t)s[m]=f[m];return s}createResolver(e,t,i=[""],r){const{resolver:s}=Uy(this._resolverCache,e,i);return gt(t)?Jo(s,t,void 0,r):s}}function Uy(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const r=t.join();let s=i.get(r);return s||(s={resolver:Pp(e,t),subPrefixes:t.filter(u=>!u.toLowerCase().includes("hover"))},i.set(r,s)),s}const y5=n=>gt(n)&&Object.getOwnPropertyNames(n).some(e=>is(n[e]));function x5(n,e){const{isScriptable:t,isIndexable:i}=Rb(n);for(const r of e){const s=t(r),l=i(r),u=(l||s)&&n[r];if(s&&(is(u)||y5(u))||l&&Qt(u))return!0}return!1}var b5="4.5.0";const S5=["top","bottom","left","right","chartArea"];function Hy(n,e){return n==="top"||n==="bottom"||S5.indexOf(n)===-1&&e==="x"}function Wy(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function Vy(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Ht(t&&t.onComplete,[n],e)}function _5(n){const e=n.chart,t=e.options.animation;Ht(t&&t.onProgress,[n],e)}function Jb(n){return zp()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const zd={},Gy=n=>{const e=Jb(n);return Object.values(zd).filter(t=>t.canvas===e).pop()};function T5(n,e,t){const i=Object.keys(n);for(const r of i){const s=+r;if(s>=e){const l=n[r];delete n[r],(t>0||s>e)&&(n[s+t]=l)}}}function w5(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}let gf=class{static defaults=sn;static instances=zd;static overrides=Vs;static registry=Br;static version=b5;static getChart=Gy;static register(...e){Br.add(...e),Yy()}static unregister(...e){Br.remove(...e),Yy()}constructor(e,t){const i=this.config=new v5(t),r=Jb(e),s=Gy(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const l=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||H3(r)),this.platform.updateConfig(i);const u=this.platform.acquireContext(r,l.aspectRatio),f=u&&u.canvas,m=f&&f.height,p=f&&f.width;if(this.id=m4(),this.ctx=u,this.canvas=f,this.width=p,this.height=m,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new s5,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=O4(v=>this.update(v),l.resizeDelay||0),this._dataChanges=[],zd[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}la.listen(this,"complete",Vy),la.listen(this,"progress",_5),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:r,_aspectRatio:s}=this;return pt(e)?t&&s?s:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Br}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():my(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return dy(this.canvas,this.ctx),this}stop(){return la.stop(this),this}resize(e,t){la.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(r,e,t,s),u=i.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,my(this,u,!0)&&(this.notifyPlugins("resize",{size:l}),Ht(i.onResize,[this,l],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Dt(t,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,r=Object.keys(i).reduce((l,u)=>(l[u]=!1,l),{});let s=[];t&&(s=s.concat(Object.keys(t).map(l=>{const u=t[l],f=op(l,u),m=f==="r",p=f==="x";return{options:u,dposition:m?"chartArea":p?"bottom":"left",dtype:m?"radialLinear":p?"category":"linear"}}))),Dt(s,l=>{const u=l.options,f=u.id,m=op(f,u),p=rt(u.type,l.dtype);(u.position===void 0||Hy(u.position,m)!==Hy(l.dposition))&&(u.position=l.dposition),r[f]=!0;let v=null;if(f in i&&i[f].type===p)v=i[f];else{const y=Br.getScale(p);v=new y({id:f,type:p,ctx:this.ctx,chart:this}),i[v.id]=v}v.init(u,e)}),Dt(r,(l,u)=>{l||delete i[u]}),Dt(i,l=>{ar.configure(this,l,l.options),ar.addBox(this,l)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((r,s)=>r.index-s.index),i>t){for(let r=t;r<i;++r)this._destroyDatasetMeta(r);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(Wy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,r)=>{t.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=t.length;i<r;i++){const s=t[i];let l=this.getDatasetMeta(i);const u=s.type||this.config.type;if(l.type&&l.type!==u&&(this._destroyDatasetMeta(i),l=this.getDatasetMeta(i)),l.type=u,l.indexAxis=s.indexAxis||sp(u,this.options),l.order=s.order||0,l.index=i,l.label=""+s.label,l.visible=this.isDatasetVisible(i),l.controller)l.controller.updateIndex(i),l.controller.linkScales();else{const f=Br.getController(u),{datasetElementType:m,dataElementType:p}=sn.datasets[u];Object.assign(f,{dataElementType:Br.getElement(p),datasetElementType:m&&Br.getElement(m)}),l.controller=new f(this,i),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){Dt(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let m=0,p=this.data.datasets.length;m<p;m++){const{controller:v}=this.getDatasetMeta(m),y=!r&&s.indexOf(v)===-1;v.buildOrUpdateElements(y),l=Math.max(+v.getMaxOverflow(),l)}l=this._minPadding=i.layout.autoPadding?l:0,this._updateLayout(l),r||Dt(s,m=>{m.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Wy("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){Dt(this.scales,e=>{ar.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!ny(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of t){const l=i==="_removeElements"?-s:s;T5(e,r,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=s=>new Set(e.filter(l=>l[0]===s).map((l,u)=>u+","+l.splice(1).join(","))),r=i(0);for(let s=1;s<t;s++)if(!ny(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ar.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],Dt(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,is(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(la.has(this)?this.attached&&!la.running(this)&&la.start(this):(this.draw(),Vy({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let r,s;for(r=0,s=t.length;r<s;++r){const l=t[r];(!e||l.visible)&&i.push(l)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i={meta:e,index:e.index,cancelable:!0},r=zA(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&Mp(t,r),e.controller.draw(),r&&Lp(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return da(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,r){const s=S3.modes[t];return typeof s=="function"?s(this,e,i,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let r=i.filter(s=>s&&s._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=os(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const r=i?"show":"hide",s=this.getDatasetMeta(e),l=s.controller._resolveAnimations(void 0,r);Mc(t)?(s.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),l.update(s,{visible:i}),this.update(u=>u.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),la.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),dy(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete zd[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(s,l)=>{t.addEventListener(this,s,l),e[s]=l},r=(s,l,u)=>{s.offsetX=l,s.offsetY=u,this._eventHandler(s)};Dt(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(f,m)=>{t.addEventListener(this,f,m),e[f]=m},r=(f,m)=>{e[f]&&(t.removeEventListener(this,f,m),delete e[f])},s=(f,m)=>{this.canvas&&this.resize(f,m)};let l;const u=()=>{r("attach",u),this.attached=!0,this.resize(),i("resize",s),i("detach",l)};l=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",u)},t.isAttached(this.canvas)?u():l()}unbindEvents(){Dt(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Dt(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const r=i?"set":"remove";let s,l,u,f;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),u=0,f=e.length;u<f;++u){l=e[u];const m=l&&this.getDatasetMeta(l.datasetIndex).controller;m&&m[r+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:s,index:l})=>{const u=this.getDatasetMeta(s);if(!u)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:u.data[l],index:l}});!Hd(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const r=this.options.hover,s=(f,m)=>f.filter(p=>!m.some(v=>p.datasetIndex===v.datasetIndex&&p.index===v.index)),l=s(t,e),u=i?e:s(e,t);l.length&&this.updateHoverStyle(l,r.mode,!1),u.length&&r.mode&&this.updateHoverStyle(u,r.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:r=[],options:s}=this,l=t,u=this._getActiveElements(e,r,i,l),f=b4(e),m=w5(e,this._lastEvent,i,f);i&&(this._lastEvent=null,Ht(s.onHover,[e,u,this],this),f&&Ht(s.onClick,[e,u,this],this));const p=!Hd(u,r);return(p||t)&&(this._active=u,this._updateHoverStyles(u,r,t)),this._lastEvent=m,p}_getActiveElements(e,t,i,r){if(e.type==="mouseout")return[];if(!i)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,r)}};function Yy(){return Dt(gf.instances,n=>n._plugins.invalidate())}function E5(n,e,t){const{startAngle:i,x:r,y:s,outerRadius:l,innerRadius:u,options:f}=e,{borderWidth:m,borderJoinStyle:p}=f,v=Math.min(m/l,Ti(i-t));if(n.beginPath(),n.arc(r,s,l-m/2,i+v/2,t-v/2),u>0){const y=Math.min(m/u,Ti(i-t));n.arc(r,s,u+m/2,t-y/2,i+y/2,!0)}else{const y=Math.min(m/2,l*Ti(i-t));if(p==="round")n.arc(r,s,y,t-wt/2,i+wt/2,!0);else if(p==="bevel"){const S=2*y*y,_=-S*Math.cos(t+wt/2)+r,b=-S*Math.sin(t+wt/2)+s,T=S*Math.cos(i+wt/2)+r,E=S*Math.sin(i+wt/2)+s;n.lineTo(_,b),n.lineTo(T,E)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function A5(n,e,t){const{startAngle:i,pixelMargin:r,x:s,y:l,outerRadius:u,innerRadius:f}=e;let m=r/u;n.beginPath(),n.arc(s,l,u,i-m,t+m),f>r?(m=r/f,n.arc(s,l,f,t+m,i-m,!0)):n.arc(s,l,r,t+un,i-un),n.closePath(),n.clip()}function k5(n){return Ip(n,["outerStart","outerEnd","innerStart","innerEnd"])}function C5(n,e,t,i){const r=k5(n.options.borderRadius),s=(t-e)/2,l=Math.min(s,i*e/2),u=f=>{const m=(t-Math.min(s,f))*i/2;return Jn(f,0,Math.min(s,m))};return{outerStart:u(r.outerStart),outerEnd:u(r.outerEnd),innerStart:Jn(r.innerStart,0,l),innerEnd:Jn(r.innerEnd,0,l)}}function Fo(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function Xd(n,e,t,i,r,s){const{x:l,y:u,startAngle:f,pixelMargin:m,innerRadius:p}=e,v=Math.max(e.outerRadius+i+t-m,0),y=p>0?p+i+t+m:0;let S=0;const _=r-f;if(i){const ve=p>0?p-i:0,ne=v>0?v-i:0,Z=(ve+ne)/2,be=Z!==0?_*Z/(Z+i):_;S=(_-be)/2}const b=Math.max(.001,_*v-t/wt)/v,T=(_-b)/2,E=f+T+S,w=r-T-S,{outerStart:C,outerEnd:j,innerStart:k,innerEnd:P}=C5(e,y,v,w-E),D=v-C,z=v-j,R=E+C/D,W=w-j/z,q=y+k,J=y+P,me=E+k/q,Ce=w-P/J;if(n.beginPath(),s){const ve=(R+W)/2;if(n.arc(l,u,v,R,ve),n.arc(l,u,v,ve,W),j>0){const Ne=Fo(z,W,l,u);n.arc(Ne.x,Ne.y,j,W,w+un)}const ne=Fo(J,w,l,u);if(n.lineTo(ne.x,ne.y),P>0){const Ne=Fo(J,Ce,l,u);n.arc(Ne.x,Ne.y,P,w+un,Ce+Math.PI)}const Z=(w-P/y+(E+k/y))/2;if(n.arc(l,u,y,w-P/y,Z,!0),n.arc(l,u,y,Z,E+k/y,!0),k>0){const Ne=Fo(q,me,l,u);n.arc(Ne.x,Ne.y,k,me+Math.PI,E-un)}const be=Fo(D,E,l,u);if(n.lineTo(be.x,be.y),C>0){const Ne=Fo(D,R,l,u);n.arc(Ne.x,Ne.y,C,E-un,R)}}else{n.moveTo(l,u);const ve=Math.cos(R)*v+l,ne=Math.sin(R)*v+u;n.lineTo(ve,ne);const Z=Math.cos(W)*v+l,be=Math.sin(W)*v+u;n.lineTo(Z,be)}n.closePath()}function j5(n,e,t,i,r){const{fullCircles:s,startAngle:l,circumference:u}=e;let f=e.endAngle;if(s){Xd(n,e,t,i,f,r);for(let m=0;m<s;++m)n.fill();isNaN(u)||(f=l+(u%Xt||Xt))}return Xd(n,e,t,i,f,r),n.fill(),f}function D5(n,e,t,i,r){const{fullCircles:s,startAngle:l,circumference:u,options:f}=e,{borderWidth:m,borderJoinStyle:p,borderDash:v,borderDashOffset:y,borderRadius:S}=f,_=f.borderAlign==="inner";if(!m)return;n.setLineDash(v||[]),n.lineDashOffset=y,_?(n.lineWidth=m*2,n.lineJoin=p||"round"):(n.lineWidth=m,n.lineJoin=p||"bevel");let b=e.endAngle;if(s){Xd(n,e,t,i,b,r);for(let T=0;T<s;++T)n.stroke();isNaN(u)||(b=l+(u%Xt||Xt))}_&&A5(n,e,b),f.selfJoin&&b-l>=wt&&S===0&&p!=="miter"&&E5(n,e,b),s||(Xd(n,e,t,i,b,r),n.stroke())}class N5 extends xa{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.getProps(["x","y"],i),{angle:s,distance:l}=Ab(r,{x:e,y:t}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:p,circumference:v}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),y=(this.options.spacing+this.options.borderWidth)/2,S=rt(v,f-u),_=Ic(s,u,f)&&u!==f,b=S>=Xt||_,T=Za(l,m+y,p+y);return b&&T}getCenterPoint(e){const{x:t,y:i,startAngle:r,endAngle:s,innerRadius:l,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,p=(r+s)/2,v=(l+u+m+f)/2;return{x:t+Math.cos(p)*v,y:i+Math.sin(p)*v}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,r=(t.offset||0)/4,s=(t.spacing||0)/2,l=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=i>Xt?Math.floor(i/Xt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const u=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(u)*r,Math.sin(u)*r);const f=1-Math.sin(Math.min(wt,i||0)),m=r*f;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,j5(e,this,m,s,l),D5(e,this,m,s,l),e.restore()}}function Qb(n,e,t=e){n.lineCap=rt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(rt(t.borderDash,e.borderDash)),n.lineDashOffset=rt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=rt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=rt(t.borderWidth,e.borderWidth),n.strokeStyle=rt(t.borderColor,e.borderColor)}function O5(n,e,t){n.lineTo(t.x,t.y)}function R5(n){return n.stepped?$4:n.tension||n.cubicInterpolationMode==="monotone"?X4:O5}function eS(n,e,t={}){const i=n.length,{start:r=0,end:s=i-1}=t,{start:l,end:u}=e,f=Math.max(r,l),m=Math.min(s,u),p=r<l&&s<l||r>u&&s>u;return{count:i,start:f,loop:e.loop,ilen:m<f&&!p?i+m-f:m-f}}function M5(n,e,t,i){const{points:r,options:s}=e,{count:l,start:u,loop:f,ilen:m}=eS(r,t,i),p=R5(s);let{move:v=!0,reverse:y}=i||{},S,_,b;for(S=0;S<=m;++S)_=r[(u+(y?m-S:S))%l],!_.skip&&(v?(n.moveTo(_.x,_.y),v=!1):p(n,b,_,y,s.stepped),b=_);return f&&(_=r[(u+(y?m:0))%l],p(n,b,_,y,s.stepped)),!!f}function L5(n,e,t,i){const r=e.points,{count:s,start:l,ilen:u}=eS(r,t,i),{move:f=!0,reverse:m}=i||{};let p=0,v=0,y,S,_,b,T,E;const w=j=>(l+(m?u-j:j))%s,C=()=>{b!==T&&(n.lineTo(p,T),n.lineTo(p,b),n.lineTo(p,E))};for(f&&(S=r[w(0)],n.moveTo(S.x,S.y)),y=0;y<=u;++y){if(S=r[w(y)],S.skip)continue;const j=S.x,k=S.y,P=j|0;P===_?(k<b?b=k:k>T&&(T=k),p=(v*p+j)/++v):(C(),n.lineTo(j,k),_=P,v=0,b=T=k),E=k}C()}function lp(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?L5:M5}function I5(n){return n.stepped?kA:n.tension||n.cubicInterpolationMode==="monotone"?CA:Is}function P5(n,e,t,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,i)&&r.closePath()),Qb(n,e.options),n.stroke(r)}function B5(n,e,t,i){const{segments:r,options:s}=e,l=lp(e);for(const u of r)Qb(n,s,u.style),n.beginPath(),l(n,e,u,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const F5=typeof Path2D=="function";function z5(n,e,t,i){F5&&!e.options.segment?P5(n,e,t,i):B5(n,e,t,i)}class U5 extends xa{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;xA(this._points,i,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=IA(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,r=e[t],s=this.points,l=RA(this,{property:t,start:r,end:r});if(!l.length)return;const u=[],f=I5(i);let m,p;for(m=0,p=l.length;m<p;++m){const{start:v,end:y}=l[m],S=s[v],_=s[y];if(S===_){u.push(S);continue}const b=Math.abs((r-S[t])/(_[t]-S[t])),T=f(S,_,b,i.stepped);T[t]=e[t],u.push(T)}return u.length===1?u[0]:u}pathSegment(e,t,i){return lp(this)(e,this,t,i)}path(e,t,i){const r=this.segments,s=lp(this);let l=this._loop;t=t||0,i=i||this.points.length-t;for(const u of r)l&=s(e,this,u,{start:t,end:t+i-1});return!!l}draw(e,t,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),z5(e,this,i,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function $y(n,e,t,i){const r=n.options,{[t]:s}=n.getProps([t],i);return Math.abs(e-s)<r.radius+r.hitRadius}class H5 extends xa{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.options,{x:s,y:l}=this.getProps(["x","y"],i);return Math.pow(e-s,2)+Math.pow(t-l,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return $y(this,e,"x",t)}inYRange(e,t){return $y(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const i=t&&e.borderWidth||0;return(t+i)*2}draw(e,t){const i=this.options;this.skip||i.radius<.1||!da(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,ap(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function tS(n,e){const{x:t,y:i,base:r,width:s,height:l}=n.getProps(["x","y","base","width","height"],e);let u,f,m,p,v;return n.horizontal?(v=l/2,u=Math.min(t,r),f=Math.max(t,r),m=i-v,p=i+v):(v=s/2,u=t-v,f=t+v,m=Math.min(i,r),p=Math.max(i,r)),{left:u,top:m,right:f,bottom:p}}function Ja(n,e,t,i){return n?0:Jn(e,t,i)}function W5(n,e,t){const i=n.options.borderWidth,r=n.borderSkipped,s=Ob(i);return{t:Ja(r.top,s.top,0,t),r:Ja(r.right,s.right,0,e),b:Ja(r.bottom,s.bottom,0,t),l:Ja(r.left,s.left,0,e)}}function V5(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,s=Us(r),l=Math.min(e,t),u=n.borderSkipped,f=i||gt(r);return{topLeft:Ja(!f||u.top||u.left,s.topLeft,0,l),topRight:Ja(!f||u.top||u.right,s.topRight,0,l),bottomLeft:Ja(!f||u.bottom||u.left,s.bottomLeft,0,l),bottomRight:Ja(!f||u.bottom||u.right,s.bottomRight,0,l)}}function G5(n){const e=tS(n),t=e.right-e.left,i=e.bottom-e.top,r=W5(n,t/2,i/2),s=V5(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function Hm(n,e,t,i){const r=e===null,s=t===null,u=n&&!(r&&s)&&tS(n,i);return u&&(r||Za(e,u.left,u.right))&&(s||Za(t,u.top,u.bottom))}function Y5(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function $5(n,e){n.rect(e.x,e.y,e.w,e.h)}function Wm(n,e,t={}){const i=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-i,l=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+i,y:n.y+r,w:n.w+s,h:n.h+l,radius:n.radius}}class X5 extends xa{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:l}=G5(this),u=Y5(l.radius)?Pc:$5;e.save(),(l.w!==s.w||l.h!==s.h)&&(e.beginPath(),u(e,Wm(l,t,s)),e.clip(),u(e,Wm(s,-t,l)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),u(e,Wm(s,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,i){return Hm(this,e,t,i)}inXRange(e,t){return Hm(this,e,null,t)}inYRange(e,t){return Hm(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+r)/2:t,y:s?i:(i+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const Xy=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},q5=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class qy extends xa{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Ht(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,r=En(i.font),s=r.size,l=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Xy(i,s);let m,p;t.font=r.string,this.isHorizontal()?(m=this.maxWidth,p=this._fitRows(l,s,u,f)+10):(p=this.maxHeight,m=this._fitCols(l,r,u,f)+10),this.width=Math.min(m,e.maxWidth||this.maxWidth),this.height=Math.min(p,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,r){const{ctx:s,maxWidth:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],p=r+u;let v=e;s.textAlign="left",s.textBaseline="middle";let y=-1,S=-p;return this.legendItems.forEach((_,b)=>{const T=i+t/2+s.measureText(_.text).width;(b===0||m[m.length-1]+T+2*u>l)&&(v+=p,m[m.length-(b>0?0:1)]=0,S+=p,y++),f[b]={left:0,top:S,row:y,width:T,height:r},m[m.length-1]+=T+u}),v}_fitCols(e,t,i,r){const{ctx:s,maxHeight:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],p=l-e;let v=u,y=0,S=0,_=0,b=0;return this.legendItems.forEach((T,E)=>{const{itemWidth:w,itemHeight:C}=K5(i,t,s,T,r);E>0&&S+C+2*u>p&&(v+=y+u,m.push({width:y,height:S}),_+=y+u,b++,y=S=0),f[E]={left:_,top:S,col:b,width:w,height:C},y=Math.max(y,w),S+=C+u}),v+=y,m.push({width:y,height:S}),v}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:r},rtl:s}}=this,l=$o(s,this.left,this.width);if(this.isHorizontal()){let u=0,f=Zn(i,this.left+r,this.right-this.lineWidths[u]);for(const m of t)u!==m.row&&(u=m.row,f=Zn(i,this.left+r,this.right-this.lineWidths[u])),m.top+=this.top+e+r,m.left=l.leftForLtr(l.x(f),m.width),f+=m.width+r}else{let u=0,f=Zn(i,this.top+e+r,this.bottom-this.columnSizes[u].height);for(const m of t)m.col!==u&&(u=m.col,f=Zn(i,this.top+e+r,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+r,m.left=l.leftForLtr(l.x(m.left),m.width),f+=m.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Mp(e,this),this._draw(),Lp(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:r}=this,{align:s,labels:l}=e,u=sn.color,f=$o(e.rtl,this.left,this.width),m=En(l.font),{padding:p}=l,v=m.size,y=v/2;let S;this.drawTitle(),r.textAlign=f.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=m.string;const{boxWidth:_,boxHeight:b,itemHeight:T}=Xy(l,v),E=function(P,D,z){if(isNaN(_)||_<=0||isNaN(b)||b<0)return;r.save();const R=rt(z.lineWidth,1);if(r.fillStyle=rt(z.fillStyle,u),r.lineCap=rt(z.lineCap,"butt"),r.lineDashOffset=rt(z.lineDashOffset,0),r.lineJoin=rt(z.lineJoin,"miter"),r.lineWidth=R,r.strokeStyle=rt(z.strokeStyle,u),r.setLineDash(rt(z.lineDash,[])),l.usePointStyle){const W={radius:b*Math.SQRT2/2,pointStyle:z.pointStyle,rotation:z.rotation,borderWidth:R},q=f.xPlus(P,_/2),J=D+y;Nb(r,W,q,J,l.pointStyleWidth&&_)}else{const W=D+Math.max((v-b)/2,0),q=f.leftForLtr(P,_),J=Us(z.borderRadius);r.beginPath(),Object.values(J).some(me=>me!==0)?Pc(r,{x:q,y:W,w:_,h:b,radius:J}):r.rect(q,W,_,b),r.fill(),R!==0&&r.stroke()}r.restore()},w=function(P,D,z){Gs(r,z.text,P,D+T/2,m,{strikethrough:z.hidden,textAlign:f.textAlign(z.textAlign)})},C=this.isHorizontal(),j=this._computeTitleHeight();C?S={x:Zn(s,this.left+p,this.right-i[0]),y:this.top+p+j,line:0}:S={x:this.left+p,y:Zn(s,this.top+j+p,this.bottom-t[0].height),line:0},Bb(this.ctx,e.textDirection);const k=T+p;this.legendItems.forEach((P,D)=>{r.strokeStyle=P.fontColor,r.fillStyle=P.fontColor;const z=r.measureText(P.text).width,R=f.textAlign(P.textAlign||(P.textAlign=l.textAlign)),W=_+y+z;let q=S.x,J=S.y;f.setWidth(this.width),C?D>0&&q+W+p>this.right&&(J=S.y+=k,S.line++,q=S.x=Zn(s,this.left+p,this.right-i[S.line])):D>0&&J+k>this.bottom&&(q=S.x=q+t[S.line].width+p,S.line++,J=S.y=Zn(s,this.top+j+p,this.bottom-t[S.line].height));const me=f.x(q);if(E(me,J,P),q=R4(R,q+_+y,C?q+W:this.right,e.rtl),w(f.x(q),J,P),C)S.x+=W+p;else if(typeof P.text!="string"){const Ce=m.lineHeight;S.y+=nS(P,Ce)+p}else S.y+=k}),Fb(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=En(t.font),r=ti(t.padding);if(!t.display)return;const s=$o(e.rtl,this.left,this.width),l=this.ctx,u=t.position,f=i.size/2,m=r.top+f;let p,v=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),p=this.top+m,v=Zn(e.align,v,this.right-y);else{const _=this.columnSizes.reduce((b,T)=>Math.max(b,T.height),0);p=m+Zn(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const S=Zn(u,v,v+y);l.textAlign=s.textAlign(Dp(u)),l.textBaseline="middle",l.strokeStyle=t.color,l.fillStyle=t.color,l.font=i.string,Gs(l,t.text,S,p,i)}_computeTitleHeight(){const e=this.options.title,t=En(e.font),i=ti(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,r,s;if(Za(e,this.left,this.right)&&Za(t,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],Za(e,r.left,r.left+r.width)&&Za(t,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!Q5(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,s=q5(r,i);r&&!s&&Ht(t.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!s&&Ht(t.onHover,[e,i,this],this)}else i&&Ht(t.onClick,[e,i,this],this)}}function K5(n,e,t,i,r){const s=Z5(i,n,e,t),l=J5(r,i,e.lineHeight);return{itemWidth:s,itemHeight:l}}function Z5(n,e,t,i){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((s,l)=>s.length>l.length?s:l)),e+t.size/2+i.measureText(r).width}function J5(n,e,t){let i=n;return typeof e.text!="string"&&(i=nS(e,t)),i}function nS(n,e){const t=n.text?n.text.length:0;return e*t}function Q5(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var ek={id:"legend",_element:qy,start(n,e,t){const i=n.legend=new qy({ctx:n.ctx,options:t,chart:n});ar.configure(n,i,t),ar.addBox(n,i)},stop(n){ar.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;ar.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,r=t.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:r,color:s,useBorderRadius:l,borderRadius:u}}=n.legend.options;return n._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(t?0:void 0),p=ti(m.borderWidth);return{text:e[f.index].label,fillStyle:m.backgroundColor,fontColor:s,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:m.borderColor,pointStyle:i||m.pointStyle,rotation:m.rotation,textAlign:r||m.textAlign,borderRadius:l&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class iS extends xa{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const r=Qt(i.text)?i.text.length:1;this._padding=ti(i.padding);const s=r*En(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:r,right:s,options:l}=this,u=l.align;let f=0,m,p,v;return this.isHorizontal()?(p=Zn(u,i,s),v=t+e,m=s-i):(l.position==="left"?(p=i+e,v=Zn(u,r,t),f=wt*-.5):(p=s-e,v=Zn(u,t,r),f=wt*.5),m=r-t),{titleX:p,titleY:v,maxWidth:m,rotation:f}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=En(t.font),s=i.lineHeight/2+this._padding.top,{titleX:l,titleY:u,maxWidth:f,rotation:m}=this._drawArgs(s);Gs(e,t.text,0,0,i,{color:t.color,maxWidth:f,rotation:m,textAlign:Dp(t.align),textBaseline:"middle",translation:[l,u]})}}function tk(n,e){const t=new iS({ctx:n.ctx,options:e,chart:n});ar.configure(n,t,e),ar.addBox(n,t),n.titleBlock=t}var nk={id:"title",_element:iS,start(n,e,t){tk(n,t)},stop(n){const e=n.titleBlock;ar.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;ar.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const yc={average(n){if(!n.length)return!1;let e,t,i=new Set,r=0,s=0;for(e=0,t=n.length;e<t;++e){const u=n[e].element;if(u&&u.hasValue()){const f=u.tooltipPosition();i.add(f.x),r+=f.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((u,f)=>u+f)/i.size,y:r/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,r=Number.POSITIVE_INFINITY,s,l,u;for(s=0,l=n.length;s<l;++s){const f=n[s].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),p=ip(e,m);p<r&&(r=p,u=f)}}if(u){const f=u.tooltipPosition();t=f.x,i=f.y}return{x:t,y:i}}};function Lr(n,e){return e&&(Qt(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function ca(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function ik(n,e){const{element:t,datasetIndex:i,index:r}=e,s=n.getDatasetMeta(i).controller,{label:l,value:u}=s.getLabelAndValue(r);return{chart:n,label:l,parsed:s.getParsed(r),raw:n.data.datasets[i].data[r],formattedValue:u,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:t}}function Ky(n,e){const t=n.chart.ctx,{body:i,footer:r,title:s}=n,{boxWidth:l,boxHeight:u}=e,f=En(e.bodyFont),m=En(e.titleFont),p=En(e.footerFont),v=s.length,y=r.length,S=i.length,_=ti(e.padding);let b=_.height,T=0,E=i.reduce((j,k)=>j+k.before.length+k.lines.length+k.after.length,0);if(E+=n.beforeBody.length+n.afterBody.length,v&&(b+=v*m.lineHeight+(v-1)*e.titleSpacing+e.titleMarginBottom),E){const j=e.displayColors?Math.max(u,f.lineHeight):f.lineHeight;b+=S*j+(E-S)*f.lineHeight+(E-1)*e.bodySpacing}y&&(b+=e.footerMarginTop+y*p.lineHeight+(y-1)*e.footerSpacing);let w=0;const C=function(j){T=Math.max(T,t.measureText(j).width+w)};return t.save(),t.font=m.string,Dt(n.title,C),t.font=f.string,Dt(n.beforeBody.concat(n.afterBody),C),w=e.displayColors?l+2+e.boxPadding:0,Dt(i,j=>{Dt(j.before,C),Dt(j.lines,C),Dt(j.after,C)}),w=0,t.font=p.string,Dt(n.footer,C),t.restore(),T+=_.width,{width:T,height:b}}function rk(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function ak(n,e,t,i){const{x:r,width:s}=i,l=t.caretSize+t.caretPadding;if(n==="left"&&r+s+l>e.width||n==="right"&&r-s-l<0)return!0}function sk(n,e,t,i){const{x:r,width:s}=t,{width:l,chartArea:{left:u,right:f}}=n;let m="center";return i==="center"?m=r<=(u+f)/2?"left":"right":r<=s/2?m="left":r>=l-s/2&&(m="right"),ak(m,n,e,t)&&(m="center"),m}function Zy(n,e,t){const i=t.yAlign||e.yAlign||rk(n,t);return{xAlign:t.xAlign||e.xAlign||sk(n,e,t,i),yAlign:i}}function ok(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function lk(n,e,t){let{y:i,height:r}=n;return e==="top"?i+=t:e==="bottom"?i-=r+t:i-=r/2,i}function Jy(n,e,t,i){const{caretSize:r,caretPadding:s,cornerRadius:l}=n,{xAlign:u,yAlign:f}=t,m=r+s,{topLeft:p,topRight:v,bottomLeft:y,bottomRight:S}=Us(l);let _=ok(e,u);const b=lk(e,f,m);return f==="center"?u==="left"?_+=m:u==="right"&&(_-=m):u==="left"?_-=Math.max(p,y)+r:u==="right"&&(_+=Math.max(v,S)+r),{x:Jn(_,0,i.width-e.width),y:Jn(b,0,i.height-e.height)}}function _d(n,e,t){const i=ti(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function Qy(n){return Lr([],ca(n))}function ck(n,e,t){return os(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function ex(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const rS={beforeTitle:oa,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:oa,beforeBody:oa,beforeLabel:oa,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return pt(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:oa,afterBody:oa,beforeFooter:oa,footer:oa,afterFooter:oa};function Si(n,e,t,i){const r=n[e].call(t,i);return typeof r>"u"?rS[e].call(t,i):r}class tx extends xa{static positioners=yc;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&t.options.animation&&i.animations,s=new Ub(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=ck(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,r=Si(i,"beforeTitle",this,e),s=Si(i,"title",this,e),l=Si(i,"afterTitle",this,e);let u=[];return u=Lr(u,ca(r)),u=Lr(u,ca(s)),u=Lr(u,ca(l)),u}getBeforeBody(e,t){return Qy(Si(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:i}=t,r=[];return Dt(e,s=>{const l={before:[],lines:[],after:[]},u=ex(i,s);Lr(l.before,ca(Si(u,"beforeLabel",this,s))),Lr(l.lines,Si(u,"label",this,s)),Lr(l.after,ca(Si(u,"afterLabel",this,s))),r.push(l)}),r}getAfterBody(e,t){return Qy(Si(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,r=Si(i,"beforeFooter",this,e),s=Si(i,"footer",this,e),l=Si(i,"afterFooter",this,e);let u=[];return u=Lr(u,ca(r)),u=Lr(u,ca(s)),u=Lr(u,ca(l)),u}_createItems(e){const t=this._active,i=this.chart.data,r=[],s=[],l=[];let u=[],f,m;for(f=0,m=t.length;f<m;++f)u.push(ik(this.chart,t[f]));return e.filter&&(u=u.filter((p,v,y)=>e.filter(p,v,y,i))),e.itemSort&&(u=u.sort((p,v)=>e.itemSort(p,v,i))),Dt(u,p=>{const v=ex(e.callbacks,p);r.push(Si(v,"labelColor",this,p)),s.push(Si(v,"labelPointStyle",this,p)),l.push(Si(v,"labelTextColor",this,p))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=l,this.dataPoints=u,u}update(e,t){const i=this.options.setContext(this.getContext()),r=this._active;let s,l=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const u=yc[i.position].call(this,r,this._eventPosition);l=this._createItems(i),this.title=this.getTitle(l,i),this.beforeBody=this.getBeforeBody(l,i),this.body=this.getBody(l,i),this.afterBody=this.getAfterBody(l,i),this.footer=this.getFooter(l,i);const f=this._size=Ky(this,i),m=Object.assign({},u,f),p=Zy(this.chart,i,m),v=Jy(i,m,p,this.chart);this.xAlign=p.xAlign,this.yAlign=p.yAlign,s={opacity:1,x:v.x,y:v.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=l,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,r){const s=this.getCaretPosition(e,i,r);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,i){const{xAlign:r,yAlign:s}=this,{caretSize:l,cornerRadius:u}=i,{topLeft:f,topRight:m,bottomLeft:p,bottomRight:v}=Us(u),{x:y,y:S}=e,{width:_,height:b}=t;let T,E,w,C,j,k;return s==="center"?(j=S+b/2,r==="left"?(T=y,E=T-l,C=j+l,k=j-l):(T=y+_,E=T+l,C=j-l,k=j+l),w=T):(r==="left"?E=y+Math.max(f,p)+l:r==="right"?E=y+_-Math.max(m,v)-l:E=this.caretX,s==="top"?(C=S,j=C-l,T=E-l,w=E+l):(C=S+b,j=C+l,T=E+l,w=E-l),k=C),{x1:T,x2:E,x3:w,y1:C,y2:j,y3:k}}drawTitle(e,t,i){const r=this.title,s=r.length;let l,u,f;if(s){const m=$o(i.rtl,this.x,this.width);for(e.x=_d(this,i.titleAlign,i),t.textAlign=m.textAlign(i.titleAlign),t.textBaseline="middle",l=En(i.titleFont),u=i.titleSpacing,t.fillStyle=i.titleColor,t.font=l.string,f=0;f<s;++f)t.fillText(r[f],m.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+u,f+1===s&&(e.y+=i.titleMarginBottom-u)}}_drawColorBox(e,t,i,r,s){const l=this.labelColors[i],u=this.labelPointStyles[i],{boxHeight:f,boxWidth:m}=s,p=En(s.bodyFont),v=_d(this,"left",s),y=r.x(v),S=f<p.lineHeight?(p.lineHeight-f)/2:0,_=t.y+S;if(s.usePointStyle){const b={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},T=r.leftForLtr(y,m)+m/2,E=_+f/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,ap(e,b,T,E),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,ap(e,b,T,E)}else{e.lineWidth=gt(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const b=r.leftForLtr(y,m),T=r.leftForLtr(r.xPlus(y,1),m-2),E=Us(l.borderRadius);Object.values(E).some(w=>w!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,Pc(e,{x:b,y:_,w:m,h:f,radius:E}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),Pc(e,{x:T,y:_+1,w:m-2,h:f-2,radius:E}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(b,_,m,f),e.strokeRect(b,_,m,f),e.fillStyle=l.backgroundColor,e.fillRect(T,_+1,m-2,f-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:r}=this,{bodySpacing:s,bodyAlign:l,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:p}=i,v=En(i.bodyFont);let y=v.lineHeight,S=0;const _=$o(i.rtl,this.x,this.width),b=function(z){t.fillText(z,_.x(e.x+S),e.y+y/2),e.y+=y+s},T=_.textAlign(l);let E,w,C,j,k,P,D;for(t.textAlign=l,t.textBaseline="middle",t.font=v.string,e.x=_d(this,T,i),t.fillStyle=i.bodyColor,Dt(this.beforeBody,b),S=u&&T!=="right"?l==="center"?m/2+p:m+2+p:0,j=0,P=r.length;j<P;++j){for(E=r[j],w=this.labelTextColors[j],t.fillStyle=w,Dt(E.before,b),C=E.lines,u&&C.length&&(this._drawColorBox(t,e,j,_,i),y=Math.max(v.lineHeight,f)),k=0,D=C.length;k<D;++k)b(C[k]),y=v.lineHeight;Dt(E.after,b)}S=0,y=v.lineHeight,Dt(this.afterBody,b),e.y-=s}drawFooter(e,t,i){const r=this.footer,s=r.length;let l,u;if(s){const f=$o(i.rtl,this.x,this.width);for(e.x=_d(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=f.textAlign(i.footerAlign),t.textBaseline="middle",l=En(i.footerFont),t.fillStyle=i.footerColor,t.font=l.string,u=0;u<s;++u)t.fillText(r[u],f.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+i.footerSpacing}}drawBackground(e,t,i,r){const{xAlign:s,yAlign:l}=this,{x:u,y:f}=e,{width:m,height:p}=i,{topLeft:v,topRight:y,bottomLeft:S,bottomRight:_}=Us(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(u+v,f),l==="top"&&this.drawCaret(e,t,i,r),t.lineTo(u+m-y,f),t.quadraticCurveTo(u+m,f,u+m,f+y),l==="center"&&s==="right"&&this.drawCaret(e,t,i,r),t.lineTo(u+m,f+p-_),t.quadraticCurveTo(u+m,f+p,u+m-_,f+p),l==="bottom"&&this.drawCaret(e,t,i,r),t.lineTo(u+S,f+p),t.quadraticCurveTo(u,f+p,u,f+p-S),l==="center"&&s==="left"&&this.drawCaret(e,t,i,r),t.lineTo(u,f+v),t.quadraticCurveTo(u,f,u+v,f),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){const l=yc[e.position].call(this,this._active,this._eventPosition);if(!l)return;const u=this._size=Ky(this,e),f=Object.assign({},l,this._size),m=Zy(t,e,f),p=Jy(e,f,m,t);(r._to!==p.x||s._to!==p.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,p))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const l=ti(t.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&u&&(e.save(),e.globalAlpha=i,this.drawBackground(s,e,r,t),Bb(e,t.textDirection),s.y+=l.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),Fb(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,r=e.map(({datasetIndex:u,index:f})=>{const m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),s=!Hd(i,r),l=this._positionChanged(r,t);(s||l)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],l=this._getActiveElements(e,s,t,i),u=this._positionChanged(l,e),f=t||!Hd(l,s)||u;return f&&(this._active=l,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),f}_getActiveElements(e,t,i,r){const s=this.options;if(e.type==="mouseout")return[];if(!r)return t.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,s.mode,s,i);return s.reverse&&l.reverse(),l}_positionChanged(e,t){const{caretX:i,caretY:r,options:s}=this,l=yc[s.position].call(this,e,t);return l!==!1&&(i!==l.x||r!==l.y)}}var uk={id:"tooltip",_element:tx,positioners:yc,afterInit(n,e,t){t&&(n.tooltip=new tx({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:rS},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const dk=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function fk(n,e,t,i){const r=n.indexOf(e);if(r===-1)return dk(n,e,t,i);const s=n.lastIndexOf(e);return r!==s?t:r}const hk=(n,e)=>n===null?null:Jn(Math.round(n),0,e);function nx(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class mk extends rl{static id="category";static defaults={ticks:{callback:nx}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:r,label:s}of t)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(pt(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:fk(i,e,rt(t,e),this._addedLabels),hk(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let l=e;l<=t;l++)r.push({value:l});return r}getLabelForValue(e){return nx.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function pk(n,e){const t=[],{bounds:r,step:s,min:l,max:u,precision:f,count:m,maxTicks:p,maxDigits:v,includeBounds:y}=n,S=s||1,_=p-1,{min:b,max:T}=e,E=!pt(l),w=!pt(u),C=!pt(m),j=(T-b)/(v+1);let k=ry((T-b)/_/S)*S,P,D,z,R;if(k<1e-14&&!E&&!w)return[{value:b},{value:T}];R=Math.ceil(T/k)-Math.floor(b/k),R>_&&(k=ry(R*k/_/S)*S),pt(f)||(P=Math.pow(10,f),k=Math.ceil(k*P)/P),r==="ticks"?(D=Math.floor(b/k)*k,z=Math.ceil(T/k)*k):(D=b,z=T),E&&w&&s&&E4((u-l)/s,k/1e3)?(R=Math.round(Math.min((u-l)/k,p)),k=(u-l)/R,D=l,z=u):C?(D=E?l:D,z=w?u:z,R=m-1,k=(z-D)/R):(R=(z-D)/k,_c(R,Math.round(R),k/1e3)?R=Math.round(R):R=Math.ceil(R));const W=Math.max(ay(k),ay(D));P=Math.pow(10,pt(f)?W:f),D=Math.round(D*P)/P,z=Math.round(z*P)/P;let q=0;for(E&&(y&&D!==l?(t.push({value:l}),D<l&&q++,_c(Math.round((D+q*k)*P)/P,l,ix(l,j,n))&&q++):D<l&&q++);q<R;++q){const J=Math.round((D+q*k)*P)/P;if(w&&J>u)break;t.push({value:J})}return w&&y&&z!==u?t.length&&_c(t[t.length-1].value,u,ix(u,j,n))?t[t.length-1].value=u:t.push({value:u}):(!w||z===u)&&t.push({value:z}),t}function ix(n,e,{horizontal:t,minRotation:i}){const r=Fr(i),s=(t?Math.sin(r):Math.cos(r))||.001,l=.75*e*(""+n).length;return Math.min(e/s,l)}class cp extends rl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return pt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const l=f=>r=t?r:f,u=f=>s=i?s:f;if(e){const f=zr(r),m=zr(s);f<0&&m<0?u(0):f>0&&m>0&&l(0)}if(r===s){let f=s===0?1:Math.abs(s*.05);u(s+f),e||l(r-f)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,l=pk(r,s);return e.bounds==="ticks"&&A4(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-t)/Math.max(e.length-1,1)/2;t-=r,i+=r}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return Op(e,this.chart.options.locale,this.options.ticks.format)}}class gk extends cp{static id="linear";static defaults={ticks:{callback:Rp.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Ai(e)?e:0,this.max=Ai(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=Fr(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}function up(n){const e=n.ticks;if(e.display&&n.display){const t=ti(e.backdropPadding);return rt(e.font&&e.font.size,sn.font.size)+t.height}return 0}function vk(n,e,t){return t=Qt(t)?t:[t],{w:Y4(n,e.string,t),h:t.length*e.lineHeight}}function rx(n,e,t,i,r){return n===i||n===r?{start:e-t/2,end:e+t/2}:n<i||n>r?{start:e-t,end:e}:{start:e,end:e+t}}function yk(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],r=[],s=n._pointLabels.length,l=n.options.pointLabels,u=l.centerPointLabels?wt/s:0;for(let f=0;f<s;f++){const m=l.setContext(n.getPointLabelContext(f));r[f]=m.padding;const p=n.getPointPosition(f,n.drawingArea+r[f],u),v=En(m.font),y=vk(n.ctx,v,n._pointLabels[f]);i[f]=y;const S=Ti(n.getIndexAngle(f)+u),_=Math.round(Cp(S)),b=rx(_,p.x,y.w,0,180),T=rx(_,p.y,y.h,90,270);xk(t,e,S,b,T)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=_k(n,i,r)}function xk(n,e,t,i,r){const s=Math.abs(Math.sin(t)),l=Math.abs(Math.cos(t));let u=0,f=0;i.start<e.l?(u=(e.l-i.start)/s,n.l=Math.min(n.l,e.l-u)):i.end>e.r&&(u=(i.end-e.r)/s,n.r=Math.max(n.r,e.r+u)),r.start<e.t?(f=(e.t-r.start)/l,n.t=Math.min(n.t,e.t-f)):r.end>e.b&&(f=(r.end-e.b)/l,n.b=Math.max(n.b,e.b+f))}function bk(n,e,t){const i=n.drawingArea,{extra:r,additionalAngle:s,padding:l,size:u}=t,f=n.getPointPosition(e,i+r+l,s),m=Math.round(Cp(Ti(f.angle+un))),p=Ek(f.y,u.h,m),v=Tk(m),y=wk(f.x,u.w,v);return{visible:!0,x:f.x,y:p,textAlign:v,left:y,top:p,right:y+u.w,bottom:p+u.h}}function Sk(n,e){if(!e)return!0;const{left:t,top:i,right:r,bottom:s}=n;return!(da({x:t,y:i},e)||da({x:t,y:s},e)||da({x:r,y:i},e)||da({x:r,y:s},e))}function _k(n,e,t){const i=[],r=n._pointLabels.length,s=n.options,{centerPointLabels:l,display:u}=s.pointLabels,f={extra:up(s)/2,additionalAngle:l?wt/r:0};let m;for(let p=0;p<r;p++){f.padding=t[p],f.size=e[p];const v=bk(n,p,f);i.push(v),u==="auto"&&(v.visible=Sk(v,m),v.visible&&(m=v))}return i}function Tk(n){return n===0||n===180?"center":n<180?"left":"right"}function wk(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function Ek(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function Ak(n,e,t){const{left:i,top:r,right:s,bottom:l}=t,{backdropColor:u}=e;if(!pt(u)){const f=Us(e.borderRadius),m=ti(e.backdropPadding);n.fillStyle=u;const p=i-m.left,v=r-m.top,y=s-i+m.width,S=l-r+m.height;Object.values(f).some(_=>_!==0)?(n.beginPath(),Pc(n,{x:p,y:v,w:y,h:S,radius:f}),n.fill()):n.fillRect(p,v,y,S)}}function kk(n,e){const{ctx:t,options:{pointLabels:i}}=n;for(let r=e-1;r>=0;r--){const s=n._pointLabelItems[r];if(!s.visible)continue;const l=i.setContext(n.getPointLabelContext(r));Ak(t,l,s);const u=En(l.font),{x:f,y:m,textAlign:p}=s;Gs(t,n._pointLabels[r],f,m+u.lineHeight/2,u,{color:l.color,textAlign:p,textBaseline:"middle"})}}function aS(n,e,t,i){const{ctx:r}=n;if(t)r.arc(n.xCenter,n.yCenter,e,0,Xt);else{let s=n.getPointPosition(0,e);r.moveTo(s.x,s.y);for(let l=1;l<i;l++)s=n.getPointPosition(l,e),r.lineTo(s.x,s.y)}}function Ck(n,e,t,i,r){const s=n.ctx,l=e.circular,{color:u,lineWidth:f}=e;!l&&!i||!u||!f||t<0||(s.save(),s.strokeStyle=u,s.lineWidth=f,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),aS(n,t,l,i),s.closePath(),s.stroke(),s.restore())}function jk(n,e,t){return os(n,{label:t,index:e,type:"pointLabel"})}class Dk extends cp{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Rp.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ti(up(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Ai(e)&&!isNaN(e)?e:0,this.max=Ai(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/up(this.options))}generateTickLabels(e){cp.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const r=Ht(this.options.pointLabels.callback,[t,i],this);return r||r===0?r:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?yk(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,r))}getIndexAngle(e){const t=Xt/(this._pointLabels.length||1),i=this.options.startAngle||0;return Ti(e*t+Fr(i))}getDistanceFromCenterForValue(e){if(pt(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(pt(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return jk(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const r=this.getIndexAngle(e)-un+i;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:r,bottom:s}=this._pointLabelItems[e];return{left:t,top:i,right:r,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),aS(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:r,border:s}=t,l=this._pointLabels.length;let u,f,m;if(t.pointLabels.display&&kk(this,l),r.display&&this.ticks.forEach((p,v)=>{if(v!==0||v===0&&this.min<0){f=this.getDistanceFromCenterForValue(p.value);const y=this.getContext(v),S=r.setContext(y),_=s.setContext(y);Ck(this,S,f,l,_)}}),i.display){for(e.save(),u=l-1;u>=0;u--){const p=i.setContext(this.getPointLabelContext(u)),{color:v,lineWidth:y}=p;!y||!v||(e.lineWidth=y,e.strokeStyle=v,e.setLineDash(p.borderDash),e.lineDashOffset=p.borderDashOffset,f=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),m=this.getPointPosition(u,f),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(m.x,m.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((u,f)=>{if(f===0&&this.min>=0&&!t.reverse)return;const m=i.setContext(this.getContext(f)),p=En(m.font);if(s=this.getDistanceFromCenterForValue(this.ticks[f].value),m.showLabelBackdrop){e.font=p.string,l=e.measureText(u.label).width,e.fillStyle=m.backdropColor;const v=ti(m.backdropPadding);e.fillRect(-l/2-v.left,-s-p.size/2-v.top,l+v.width,p.size+v.height)}Gs(e,u.label,0,-s,p,{color:m.color,strokeColor:m.textStrokeColor,strokeWidth:m.textStrokeWidth})}),e.restore()}drawTitle(){}}const vf={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},wi=Object.keys(vf);function ax(n,e){return n-e}function sx(n,e){if(pt(e))return null;const t=n._adapter,{parser:i,round:r,isoWeekday:s}=n._parseOpts;let l=e;return typeof i=="function"&&(l=i(l)),Ai(l)||(l=typeof i=="string"?t.parse(l,i):t.parse(l)),l===null?null:(r&&(l=r==="week"&&(Lc(s)||s===!0)?t.startOf(l,"isoWeek",s):t.startOf(l,r)),+l)}function ox(n,e,t,i){const r=wi.length;for(let s=wi.indexOf(n);s<r-1;++s){const l=vf[wi[s]],u=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((t-e)/(u*l.size))<=i)return wi[s]}return wi[r-1]}function Nk(n,e,t,i,r){for(let s=wi.length-1;s>=wi.indexOf(t);s--){const l=wi[s];if(vf[l].common&&n._adapter.diff(r,i,l)>=e-1)return l}return wi[t?wi.indexOf(t):0]}function Ok(n){for(let e=wi.indexOf(n)+1,t=wi.length;e<t;++e)if(vf[wi[e]].common)return wi[e]}function lx(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:r}=jp(t,e),s=t[i]>=e?t[i]:t[r];n[s]=!0}}function Rk(n,e,t,i){const r=n._adapter,s=+r.startOf(e[0].value,i),l=e[e.length-1].value;let u,f;for(u=s;u<=l;u=+r.add(u,1,i))f=t[u],f>=0&&(e[f].major=!0);return e}function cx(n,e,t){const i=[],r={},s=e.length;let l,u;for(l=0;l<s;++l)u=e[l],r[u]=l,i.push({value:u,major:!1});return s===0||!t?i:Rk(n,i,r,t)}class ux extends rl{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),r=this._adapter=new g3._date(e.adapters.date);r.init(t),Sc(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:sx(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:r,max:s,minDefined:l,maxDefined:u}=this.getUserBounds();function f(m){!l&&!isNaN(m.min)&&(r=Math.min(r,m.min)),!u&&!isNaN(m.max)&&(s=Math.max(s,m.max))}(!l||!u)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),r=Ai(r)&&!isNaN(r)?r:+t.startOf(Date.now(),i),s=Ai(s)&&!isNaN(s)?s:+t.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,l=this.max,u=D4(r,s,l);return this._unit=t.unit||(i.autoSkip?ox(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):Nk(this,u.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:Ok(this._unit),this.initOffsets(r),e.reverse&&u.reverse(),cx(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,r,s;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?i=s:i=(s-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;t=Jn(t,0,l),i=Jn(i,0,l),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,r=this.options,s=r.time,l=s.unit||ox(s.minUnit,t,i,this._getLabelCapacity(t)),u=rt(r.ticks.stepSize,1),f=l==="week"?s.isoWeekday:!1,m=Lc(f)||f===!0,p={};let v=t,y,S;if(m&&(v=+e.startOf(v,"isoWeek",f)),v=+e.startOf(v,m?"day":l),e.diff(i,t,l)>1e5*u)throw new Error(t+" and "+i+" are too far apart with stepSize of "+u+" "+l);const _=r.ticks.source==="data"&&this.getDataTimestamps();for(y=v,S=0;y<i;y=+e.add(y,u,l),S++)lx(p,y,_);return(y===i||r.bounds==="ticks"||S===1)&&lx(p,y,_),Object.keys(p).sort(ax).map(b=>+b)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,s=this._unit,l=t||r[s];return this._adapter.format(e,l)}_tickFormatFunction(e,t,i,r){const s=this.options,l=s.ticks.callback;if(l)return Ht(l,[e,t,i],this);const u=s.time.displayFormats,f=this._unit,m=this._majorUnit,p=f&&u[f],v=m&&u[m],y=i[t],S=m&&v&&y&&y.major;return this._adapter.format(e,r||(S?v:p))}generateTickLabels(e){let t,i,r;for(t=0,i=e.length;t<i;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,r=Fr(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(r),l=Math.sin(r),u=this._resolveTickFontOptions(0).size;return{w:i*s+u*l,h:i*l+u*s}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,r=i[t.unit]||i.millisecond,s=this._tickFormatFunction(e,0,cx(this,[e],this._majorUnit),r),l=this._getLabelSize(s),u=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,i=r.length;t<i;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const r=this.getLabels();for(t=0,i=r.length;t<i;++t)e.push(sx(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Cb(e.sort(ax))}}function Td(n,e,t){let i=0,r=n.length-1,s,l,u,f;t?(e>=n[i].pos&&e<=n[r].pos&&({lo:i,hi:r}=zs(n,"pos",e)),{pos:s,time:u}=n[i],{pos:l,time:f}=n[r]):(e>=n[i].time&&e<=n[r].time&&({lo:i,hi:r}=zs(n,"time",e)),{time:s,pos:u}=n[i],{time:l,pos:f}=n[r]);const m=l-s;return m?u+(f-u)*(e-s)/m:u}class qM extends ux{static id="timeseries";static defaults=ux.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Td(t,this.min),this._tableRange=Td(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,r=[],s=[];let l,u,f,m,p;for(l=0,u=e.length;l<u;++l)m=e[l],m>=t&&m<=i&&r.push(m);if(r.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(l=0,u=r.length;l<u;++l)p=r[l+1],f=r[l-1],m=r[l],Math.round((p+f)/2)!==m&&s.push({time:m,pos:l/(u-1)});return s}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(Td(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return Td(this._table,i*this._tableRange+this._minPos,!0)}}const sS="label";function dx(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function Mk(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function oS(n,e){n.labels=e}function lS(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sS;const i=[];n.datasets=e.map(r=>{const s=n.datasets.find(l=>l[t]===r[t]);return!s||!r.data||i.includes(s)?{...r}:(i.push(s),Object.assign(s,r),s)})}function Lk(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sS;const t={labels:[],datasets:[]};return oS(t,n.labels),lS(t,n.datasets,e),t}function Ik(n,e){const{height:t=150,width:i=300,redraw:r=!1,datasetIdKey:s,type:l,data:u,options:f,plugins:m=[],fallbackContent:p,updateMode:v,...y}=n,S=H.useRef(null),_=H.useRef(null),b=()=>{S.current&&(_.current=new gf(S.current,{type:l,data:Lk(u,s),options:f&&{...f},plugins:m}),dx(e,_.current))},T=()=>{dx(e,null),_.current&&(_.current.destroy(),_.current=null)};return H.useEffect(()=>{!r&&_.current&&f&&Mk(_.current,f)},[r,f]),H.useEffect(()=>{!r&&_.current&&oS(_.current.config.data,u.labels)},[r,u.labels]),H.useEffect(()=>{!r&&_.current&&u.datasets&&lS(_.current.config.data,u.datasets,s)},[r,u.datasets]),H.useEffect(()=>{_.current&&(r?(T(),setTimeout(b)):_.current.update(v))},[r,f,u.labels,u.datasets,v]),H.useEffect(()=>{_.current&&(T(),setTimeout(b))},[l]),H.useEffect(()=>(b(),()=>T()),[]),Go.createElement("canvas",{ref:S,role:"img",height:t,width:i,...y},p)}const Pk=H.forwardRef(Ik);function yf(n,e){return gf.register(e),H.forwardRef((t,i)=>Go.createElement(Pk,{...t,ref:i,type:n}))}const Bk=yf("line",m3),Fk=yf("bar",d3),zk=yf("radar",p3),Uk=yf("doughnut",h3),wd={theme:"light",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,workingHours:{start:"09:00",end:"17:00",workingDays:[1,2,3,4,5]},notifications:{enableDesktop:!0,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:{}},cS=()=>{const[n,e]=H.useState({timeEntries:[],projects:[],clients:[],settings:wd,isLoading:!0,error:null});H.useEffect(()=>{(async()=>{try{e(k=>({...k,isLoading:!0,error:null})),await Pt.init();const[E,w,C,j]=await Promise.all([Pt.getAllTimeEntries(),Pt.getAllProjects(),Pt.getAllClients(),Pt.getSettings()]);if(E.length===0){console.log(" No time entries found. Loading mock data..."),await Pt.clearAllData(),await t();const[k,P,D]=await Promise.all([Pt.getAllTimeEntries(),Pt.getAllProjects(),Pt.getAllClients()]);e({timeEntries:k,projects:P,clients:D,settings:j||wd,isLoading:!1,error:null})}else e({timeEntries:E,projects:w,clients:C,settings:j||wd,isLoading:!1,error:null});console.log(" Data loaded from database")}catch(E){console.error(" Failed to load data:",E),e(w=>({...w,isLoading:!1,error:E instanceof Error?E.message:"Failed to load data"}))}})()},[]);const t=async()=>{console.log(" Creating initial data with mock entries...");for(const E of ep)await Pt.addProject(E);for(const E of tp)await Pt.addTimeEntry(E);const T={theme:gr.theme,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,workingHours:{start:gr.workingHours.start,end:gr.workingHours.end,workingDays:[1,2,3,4,5]},notifications:{enableDesktop:gr.notifications,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:gr.integrations.reduce((E,w)=>(E[w.name]={enabled:w.enabled,lastSync:w.lastSync,connectedAt:w.connectedAt,settings:w.settings},E),{})};await Pt.updateSettings(T),console.log(" Initial data created with",tp.length,"time entries and",ep.length,"projects")},i=H.useCallback(async T=>{try{const E={...T,id:crypto.randomUUID()};return await Pt.addTimeEntry(E),e(w=>({...w,timeEntries:[...w.timeEntries,E]})),E}catch(E){throw console.error(" Failed to add time entry:",E),E}},[]),r=H.useCallback(async(T,E)=>{try{await Pt.updateTimeEntry(T,E),e(w=>({...w,timeEntries:w.timeEntries.map(C=>C.id===T?{...C,...E}:C)}))}catch(w){throw console.error(" Failed to update time entry:",w),w}},[]),s=H.useCallback(async T=>{try{await Pt.deleteTimeEntry(T),e(E=>({...E,timeEntries:E.timeEntries.filter(w=>w.id!==T)}))}catch(E){throw console.error(" Failed to delete time entry:",E),E}},[]),l=H.useCallback(async T=>{try{const E={...T,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return await Pt.addProject(E),e(w=>({...w,projects:[...w.projects,E]})),E}catch(E){throw console.error(" Failed to add project:",E),E}},[]),u=H.useCallback(async(T,E)=>{try{await Pt.updateProject(T,E),e(w=>({...w,projects:w.projects.map(C=>C.id===T?{...C,...E}:C)}))}catch(w){throw console.error(" Failed to update project:",w),w}},[]),f=H.useCallback(async T=>{try{await Pt.deleteProject(T),e(E=>({...E,projects:E.projects.filter(w=>w.id!==T)}))}catch(E){throw console.error(" Failed to delete project:",E),E}},[]),m=H.useCallback(async T=>{try{const E={...T,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return await Pt.addClient(E),e(w=>({...w,clients:[...w.clients,E]})),E}catch(E){throw console.error(" Failed to add client:",E),E}},[]),p=H.useCallback(async(T,E)=>{try{await Pt.updateClient(T,E),e(w=>({...w,clients:w.clients.map(C=>C.id===T?{...C,...E}:C)}))}catch(w){throw console.error(" Failed to update client:",w),w}},[]),v=H.useCallback(async T=>{try{await Pt.deleteClient(T),e(E=>({...E,clients:E.clients.filter(w=>w.id!==T)}))}catch(E){throw console.error(" Failed to delete client:",E),E}},[]),y=H.useCallback(async T=>{try{await Pt.updateSettings(T),e(E=>({...E,settings:T}))}catch(E){throw console.error(" Failed to update settings:",E),E}},[]),S=H.useCallback(T=>{console.log(" Toggle integration:",T),e(E=>({...E,settings:{...E.settings,integrations:{...E.settings.integrations,[T]:{enabled:!E.settings.integrations[T]?.enabled,lastSync:new Date().toISOString()}}}}))},[]),_=H.useCallback(async T=>{try{const E=await Pt.exportAllData();if(T==="json"){const w=new Blob([JSON.stringify(E,null,2)],{type:"application/json"}),C=URL.createObjectURL(w),j=document.createElement("a");j.href=C,j.download=`timebeacon-backup-${new Date().toISOString().split("T")[0]}.json`,j.click(),URL.revokeObjectURL(C)}else{const w=["Date,Start Time,End Time,Duration,Client,Project,Description,Status,Billable",...E.timeEntries.map(P=>[P.date,P.startTime,P.endTime,P.duration,P.client,P.project,`"${P.description.replace(/"/g,'""')}"`,P.status,P.billable?"Yes":"No"].join(","))].join(`
`),C=new Blob([w],{type:"text/csv"}),j=URL.createObjectURL(C),k=document.createElement("a");k.href=j,k.download=`timebeacon-entries-${new Date().toISOString().split("T")[0]}.csv`,k.click(),URL.revokeObjectURL(j)}console.log(" Data exported successfully")}catch(E){throw console.error(" Failed to export data:",E),E}},[]),b=H.useCallback(async()=>{try{await Pt.clearAllData(),e({timeEntries:[],projects:[],clients:[],settings:wd,isLoading:!1,error:null}),console.log(" All data cleared")}catch(T){throw console.error(" Failed to clear data:",T),T}},[]);return{timeEntries:n.timeEntries,projects:n.projects,clients:n.clients,settings:n.settings,isLoading:n.isLoading,error:n.error,addTimeEntry:i,updateTimeEntry:r,deleteTimeEntry:s,addProject:l,updateProject:u,deleteProject:f,addClient:m,updateClient:p,deleteClient:v,setSettings:y,toggleIntegration:S,exportData:_,clearAllData:b}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var qd={};qd.version="0.18.5";var uS=1252,Hk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dS=function(n){Hk.indexOf(n)!=-1&&(uS=n)};function Wk(){dS(1252)}var Fc=function(n){dS(n)};function Vk(){Fc(1200),Wk()}var Ed=function(e){return String.fromCharCode(e)},fx=function(e){return String.fromCharCode(e)},Kd,Qa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zc(n){for(var e="",t=0,i=0,r=0,s=0,l=0,u=0,f=0,m=0;m<n.length;)t=n.charCodeAt(m++),s=t>>2,i=n.charCodeAt(m++),l=(t&3)<<4|i>>4,r=n.charCodeAt(m++),u=(i&15)<<2|r>>6,f=r&63,isNaN(i)?u=f=64:isNaN(r)&&(f=64),e+=Qa.charAt(s)+Qa.charAt(l)+Qa.charAt(u)+Qa.charAt(f);return e}function va(n){var e="",t=0,i=0,r=0,s=0,l=0,u=0,f=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<n.length;)s=Qa.indexOf(n.charAt(m++)),l=Qa.indexOf(n.charAt(m++)),t=s<<2|l>>4,e+=String.fromCharCode(t),u=Qa.indexOf(n.charAt(m++)),i=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(i)),f=Qa.indexOf(n.charAt(m++)),r=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(r));return e}var Tt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ba=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ys(n){return Tt?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function hx(n){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var vr=function(e){return Tt?ba(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function xf(n){if(typeof ArrayBuffer>"u")return vr(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),i=0;i!=n.length;++i)t[i]=n.charCodeAt(i)&255;return e}function Zc(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function Gk(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Hn=Tt?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:ba(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var i=new Uint8Array(t),r=0;for(e=0,t=0;e<n.length;t+=r,++e)if(r=n[e].length,n[e]instanceof Uint8Array)i.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";i.set(new Uint8Array(n[e]),t)}return i}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Yk(n){for(var e=[],t=0,i=n.length+250,r=Ys(n.length+255),s=0;s<n.length;++s){var l=n.charCodeAt(s);if(l<128)r[t++]=l;else if(l<2048)r[t++]=192|l>>6&31,r[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=n.charCodeAt(++s)&1023;r[t++]=240|l>>8&7,r[t++]=128|l>>2&63,r[t++]=128|u>>6&15|(l&3)<<4,r[t++]=128|u&63}else r[t++]=224|l>>12&15,r[t++]=128|l>>6&63,r[t++]=128|l&63;t>i&&(e.push(r.slice(0,t)),t=0,r=Ys(65535),i=65530)}return e.push(r.slice(0,t)),Hn(e)}var Ec=/\u0000/g,Ad=/[\u0001-\u0006]/g;function Xo(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function yr(n,e){var t=""+n;return t.length>=e?t:an("0",e-t.length)+t}function Wp(n,e){var t=""+n;return t.length>=e?t:an(" ",e-t.length)+t}function Zd(n,e){var t=""+n;return t.length>=e?t:t+an(" ",e-t.length)}function $k(n,e){var t=""+Math.round(n);return t.length>=e?t:an("0",e-t.length)+t}function Xk(n,e){var t=""+n;return t.length>=e?t:an("0",e-t.length)+t}var mx=Math.pow(2,32);function zo(n,e){if(n>mx||n<-mx)return $k(n,e);var t=Math.round(n);return Xk(t,e)}function Jd(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var px=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Vm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function qk(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var on={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},gx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Kk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qd(n,e,t){for(var i=n<0?-1:1,r=n*i,s=0,l=1,u=0,f=1,m=0,p=0,v=Math.floor(r);m<e&&(v=Math.floor(r),u=v*l+s,p=v*m+f,!(r-v<5e-8));)r=1/(r-v),s=l,l=u,f=m,m=p;if(p>e&&(m>e?(p=f,u=s):(p=m,u=l)),!t)return[0,i*u,p];var y=Math.floor(i*u/p);return[y,i*u-y*p,p]}function kd(n,e,t){if(n>2958465||n<0)return null;var i=n|0,r=Math.floor(86400*(n-i)),s=0,l=[],u={D:i,T:r,u:86400*(n-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(i+=1462),u.u>.9999&&(u.u=0,++r==86400&&(u.T=r=0,++i,++u.D)),i===60)l=t?[1317,10,29]:[1900,2,29],s=3;else if(i===0)l=t?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var f=new Date(1900,0,1);f.setDate(f.getDate()+i-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),i<60&&(s=(s+6)%7),t&&(s=iC(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=r%60,r=Math.floor(r/60),u.M=r%60,r=Math.floor(r/60),u.H=r,u.q=s,u}var fS=new Date(1899,11,31,0,0,0),Zk=fS.getTime(),Jk=new Date(1900,2,1,0,0,0);function hS(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=Jk&&(t+=24*60*60*1e3),(t-(Zk+(n.getTimezoneOffset()-fS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Vp(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qk(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function eC(n){var e=n<0?12:11,t=Vp(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function tC(n){var e=Vp(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function nC(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=eC(n):e===10?t=n.toFixed(10).substr(0,12):t=tC(n),Vp(Qk(t.toUpperCase()))}function dp(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):nC(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return rs(14,hS(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function iC(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function rC(n,e,t,i){var r="",s=0,l=0,u=t.y,f,m=0;switch(n){case 98:u=t.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,m=2;break;default:f=u%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:f=t.m,m=e.length;break;case 3:return Vm[t.m-1][1];case 5:return Vm[t.m-1][0];default:return Vm[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=t.d,m=e.length;break;case 3:return px[t.q][0];default:return px[t.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(t.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=t.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=t.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?yr(t.S,e.length):(i>=2?l=i===3?1e3:100:l=i===1?10:1,s=Math.round(l*(t.S+t.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(r=yr(s,2+i),e==="ss"?r.substr(0,2):"."+r.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:f=u,m=1;break}var p=m>0?yr(f,m):"";return p}function es(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,i=n.substr(0,t);t!=n.length;t+=e)i+=(i.length>0?",":"")+n.substr(t,e);return i}var mS=/%/g;function aC(n,e,t){var i=e.replace(mS,""),r=e.length-i.length;return ha(n,i,t*Math.pow(10,2*r))+an("%",r)}function sC(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ha(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function pS(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+pS(n,-e);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%r;if(s<0&&(s+=r),t=(e/Math.pow(10,s)).toPrecision(i+1+(r+s)%r),t.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,r)+"."+t.substr(2+r),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(r+s)%r)+"."+p.substr(s)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var gS=/# (\?+)( ?)\/( ?)(\d+)/;function oC(n,e,t){var i=parseInt(n[4],10),r=Math.round(e*i),s=Math.floor(r/i),l=r-s*i,u=i;return t+(s===0?"":""+s)+" "+(l===0?an(" ",n[1].length+1+n[4].length):Wp(l,n[1].length)+n[2]+"/"+n[3]+yr(u,n[4].length))}function lC(n,e,t){return t+(e===0?"":""+e)+an(" ",n[1].length+2+n[4].length)}var vS=/^#*0*\.([0#]+)/,yS=/\).*[0#]/,xS=/\(###\) ###\\?-####/;function ui(n){for(var e="",t,i=0;i!=n.length;++i)switch(t=n.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function vx(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function yx(n,e){var t=n-Math.floor(n),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function cC(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function uC(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function ir(n,e,t){if(n.charCodeAt(0)===40&&!e.match(yS)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ir("n",i,t):"("+ir("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return sC(n,e,t);if(e.indexOf("%")!==-1)return aC(n,e,t);if(e.indexOf("E")!==-1)return pS(e,t);if(e.charCodeAt(0)===36)return"$"+ir(n,e.substr(e.charAt(1)==" "?2:1),t);var r,s,l,u,f=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+zo(f,e.length);if(e.match(/^[#?]+$/))return r=zo(t,0),r==="0"&&(r=""),r.length>e.length?r:ui(e.substr(0,e.length-r.length))+r;if(s=e.match(gS))return oC(s,f,m);if(e.match(/^#+0+$/))return m+zo(f,e.length-e.indexOf("0"));if(s=e.match(vS))return r=vx(t,s[1].length).replace(/^([^\.]+)$/,"$1."+ui(s[1])).replace(/\.$/,"."+ui(s[1])).replace(/\.(\d*)$/,function(_,b){return"."+b+an("0",ui(s[1]).length-b.length)}),e.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return m+vx(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return m+es(zo(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ir(n,e,-t):es(""+(Math.floor(t)+cC(t,s[1].length)))+"."+yr(yx(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ir(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Xo(ir(n,e.replace(/[\\-]/g,""),t)),l=0,Xo(Xo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return l<r.length?r.charAt(l++):_==="0"?"0":""}));if(e.match(xS))return r=ir(n,"##########",t),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=Qd(f,Math.pow(10,l)-1,!1),r=""+m,p=ha("n",s[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+s[2]+"/"+s[3],p=Zd(u[2],l),p.length<s[4].length&&(p=ui(s[4].substr(s[4].length-p.length))+p),r+=p,r;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=Qd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Wp(u[1],l)+s[2]+"/"+s[3]+Zd(u[2],l):an(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return r=zo(t,0),e.length<=r.length?r:ui(e.substr(0,e.length-r.length))+r;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var v=e.indexOf(".")-l,y=e.length-r.length-v;return ui(e.substr(0,v)+r+e.substr(e.length-y))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=yx(t,s[1].length),t<0?"-"+ir(n,e,-t):es(uC(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?yr(0,3-_.length):"")+_})+"."+yr(l,s[1].length);switch(e){case"###,##0.00":return ir(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var S=es(zo(f,0));return S!=="0"?m+S:"";case"###,###.00":return ir(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ir(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function dC(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ha(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function fC(n,e,t){var i=e.replace(mS,""),r=e.length-i.length;return ha(n,i,t*Math.pow(10,2*r))+an("%",r)}function bS(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+bS(n,-e);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%r;if(s<0&&(s+=r),t=(e/Math.pow(10,s)).toPrecision(i+1+(r+s)%r),!t.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(r+s)%r)+"."+p.substr(s)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ir(n,e,t){if(n.charCodeAt(0)===40&&!e.match(yS)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ir("n",i,t):"("+Ir("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return dC(n,e,t);if(e.indexOf("%")!==-1)return fC(n,e,t);if(e.indexOf("E")!==-1)return bS(e,t);if(e.charCodeAt(0)===36)return"$"+Ir(n,e.substr(e.charAt(1)==" "?2:1),t);var r,s,l,u,f=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+yr(f,e.length);if(e.match(/^[#?]+$/))return r=""+t,t===0&&(r=""),r.length>e.length?r:ui(e.substr(0,e.length-r.length))+r;if(s=e.match(gS))return lC(s,f,m);if(e.match(/^#+0+$/))return m+yr(f,e.length-e.indexOf("0"));if(s=e.match(vS))return r=(""+t).replace(/^([^\.]+)$/,"$1."+ui(s[1])).replace(/\.$/,"."+ui(s[1])),r=r.replace(/\.(\d*)$/,function(_,b){return"."+b+an("0",ui(s[1]).length-b.length)}),e.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return m+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return m+es(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ir(n,e,-t):es(""+t)+"."+an("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ir(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Xo(Ir(n,e.replace(/[\\-]/g,""),t)),l=0,Xo(Xo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return l<r.length?r.charAt(l++):_==="0"?"0":""}));if(e.match(xS))return r=Ir(n,"##########",t),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=Qd(f,Math.pow(10,l)-1,!1),r=""+m,p=ha("n",s[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+s[2]+"/"+s[3],p=Zd(u[2],l),p.length<s[4].length&&(p=ui(s[4].substr(s[4].length-p.length))+p),r+=p,r;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=Qd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Wp(u[1],l)+s[2]+"/"+s[3]+Zd(u[2],l):an(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return r=""+t,e.length<=r.length?r:ui(e.substr(0,e.length-r.length))+r;if(s=e.match(/^([#0]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var v=e.indexOf(".")-l,y=e.length-r.length-v;return ui(e.substr(0,v)+r+e.substr(e.length-y))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ir(n,e,-t):es(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?yr(0,3-_.length):"")+_})+"."+yr(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var S=es(""+f);return S!=="0"?m+S:"";default:if(e.match(/\.[0#?]*$/))return Ir(n,e.slice(0,e.lastIndexOf(".")),t)+ui(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ha(n,e,t){return(t|0)===t?Ir(n,e,t):ir(n,e,t)}function hC(n){for(var e=[],t=!1,i=0,r=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=n.substr(r,i-r),r=i+1}if(e[e.length]=n.substr(r),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var SS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _S(n){for(var e=0,t="",i="";e<n.length;)switch(t=n.charAt(e)){case"G":Jd(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=t;n.charAt(e++)!=="]"&&e<n.length;)i+=n.charAt(e);if(i.match(SS))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function mC(n,e,t,i){for(var r=[],s="",l=0,u="",f="t",m,p,v,y="H";l<n.length;)switch(u=n.charAt(l)){case"G":if(!Jd(n,l))throw new Error("unrecognized character "+u+" in "+n);r[r.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(v=n.charCodeAt(++l))!==34&&l<n.length;)s+=String.fromCharCode(v);r[r.length]={t:"t",v:s},++l;break;case"\\":var S=n.charAt(++l),_=S==="("||S===")"?S:"t";r[r.length]={t:_,v:S},++l;break;case"_":r[r.length]={t:"t",v:" "},l+=2;break;case"@":r[r.length]={t:"T",v:e},++l;break;case"B":case"b":if(n.charAt(l+1)==="1"||n.charAt(l+1)==="2"){if(m==null&&(m=kd(e,t,n.charAt(l+1)==="2"),m==null))return"";r[r.length]={t:"X",v:n.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=kd(e,t),m==null))return"";for(s=u;++l<n.length&&n.charAt(l).toLowerCase()===u;)s+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),r[r.length]={t:u,v:s},f=u;break;case"A":case"a":case"":var b={t:u,v:u};if(m==null&&(m=kd(e,t)),n.substr(l,3).toUpperCase()==="A/P"?(m!=null&&(b.v=m.H>=12?"P":"A"),b.t="T",y="h",l+=3):n.substr(l,5).toUpperCase()==="AM/PM"?(m!=null&&(b.v=m.H>=12?"PM":"AM"),b.t="T",l+=5,y="h"):n.substr(l,5).toUpperCase()==="/"?(m!=null&&(b.v=m.H>=12?"":""),b.t="T",l+=5,y="h"):(b.t="t",++l),m==null&&b.t==="T")return"";r[r.length]=b,f=u;break;case"[":for(s=u;n.charAt(l++)!=="]"&&l<n.length;)s+=n.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(SS)){if(m==null&&(m=kd(e,t),m==null))return"";r[r.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",_S(n)||(r[r.length]={t:"t",v:s}));break;case".":if(m!=null){for(s=u;++l<n.length&&(u=n.charAt(l))==="0";)s+=u;r[r.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++l<n.length&&"0#?.,E+-%".indexOf(u=n.charAt(l))>-1;)s+=u;r[r.length]={t:"n",v:s};break;case"?":for(s=u;n.charAt(++l)===u;)s+=u;r[r.length]={t:u,v:s},f=u;break;case"*":++l,(n.charAt(l)==" "||n.charAt(l)=="*")&&++l;break;case"(":case")":r[r.length]={t:i===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;l<n.length&&"0123456789".indexOf(n.charAt(++l))>-1;)s+=n.charAt(l);r[r.length]={t:"D",v:s};break;case" ":r[r.length]={t:u,v:u},++l;break;case"$":r[r.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+n);r[r.length]={t:"t",v:u},++l;break}var T=0,E=0,w;for(l=r.length-1,f="t";l>=0;--l)switch(r[l].t){case"h":case"H":r[l].t=y,f="h",T<1&&(T=1);break;case"s":(w=r[l].v.match(/\.0+$/))&&(E=Math.max(E,w[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=r[l].t;break;case"m":f==="s"&&(r[l].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&r[l].v.match(/[Hh]/)&&(T=1),T<2&&r[l].v.match(/[Mm]/)&&(T=2),T<3&&r[l].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var C="",j;for(l=0;l<r.length;++l)switch(r[l].t){case"t":case"T":case" ":case"D":break;case"X":r[l].v="",r[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[l].v=rC(r[l].t.charCodeAt(0),r[l].v,m,E),r[l].t="t";break;case"n":case"?":for(j=l+1;r[j]!=null&&((u=r[j].t)==="?"||u==="D"||(u===" "||u==="t")&&r[j+1]!=null&&(r[j+1].t==="?"||r[j+1].t==="t"&&r[j+1].v==="/")||r[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(r[j].v==="/"||r[j].v===" "&&r[j+1]!=null&&r[j+1].t=="?"));)r[l].v+=r[j].v,r[j]={v:"",t:";"},++j;C+=r[l].v,l=j-1;break;case"G":r[l].t="t",r[l].v=dp(e,t);break}var k="",P,D;if(C.length>0){C.charCodeAt(0)==40?(P=e<0&&C.charCodeAt(0)===45?-e:e,D=ha("n",C,P)):(P=e<0&&i>1?-e:e,D=ha("n",C,P),P<0&&r[0]&&r[0].t=="t"&&(D=D.substr(1),r[0].v="-"+r[0].v)),j=D.length-1;var z=r.length;for(l=0;l<r.length;++l)if(r[l]!=null&&r[l].t!="t"&&r[l].v.indexOf(".")>-1){z=l;break}var R=r.length;if(z===r.length&&D.indexOf("E")===-1){for(l=r.length-1;l>=0;--l)r[l]==null||"n?".indexOf(r[l].t)===-1||(j>=r[l].v.length-1?(j-=r[l].v.length,r[l].v=D.substr(j+1,r[l].v.length)):j<0?r[l].v="":(r[l].v=D.substr(0,j+1),j=-1),r[l].t="t",R=l);j>=0&&R<r.length&&(r[R].v=D.substr(0,j+1)+r[R].v)}else if(z!==r.length&&D.indexOf("E")===-1){for(j=D.indexOf(".")-1,l=z;l>=0;--l)if(!(r[l]==null||"n?".indexOf(r[l].t)===-1)){for(p=r[l].v.indexOf(".")>-1&&l===z?r[l].v.indexOf(".")-1:r[l].v.length-1,k=r[l].v.substr(p+1);p>=0;--p)j>=0&&(r[l].v.charAt(p)==="0"||r[l].v.charAt(p)==="#")&&(k=D.charAt(j--)+k);r[l].v=k,r[l].t="t",R=l}for(j>=0&&R<r.length&&(r[R].v=D.substr(0,j+1)+r[R].v),j=D.indexOf(".")+1,l=z;l<r.length;++l)if(!(r[l]==null||"n?(".indexOf(r[l].t)===-1&&l!==z)){for(p=r[l].v.indexOf(".")>-1&&l===z?r[l].v.indexOf(".")+1:0,k=r[l].v.substr(0,p);p<r[l].v.length;++p)j<D.length&&(k+=D.charAt(j++));r[l].v=k,r[l].t="t",R=l}}}for(l=0;l<r.length;++l)r[l]!=null&&"n?".indexOf(r[l].t)>-1&&(P=i>1&&e<0&&l>0&&r[l-1].v==="-"?-e:e,r[l].v=ha(r[l].t,r[l].v,P),r[l].t="t");var W="";for(l=0;l!==r.length;++l)r[l]!=null&&(W+=r[l].v);return W}var xx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bx(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function pC(n,e){var t=hC(n),i=t.length,r=t[i-1].indexOf("@");if(i<4&&r>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||r>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=r>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=r>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=r>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(xx),u=t[1].match(xx);return bx(e,l)?[i,t[0]]:bx(e,u)?[i,t[1]]:[i,t[l!=null&&u!=null?2:1]]}return[i,s]}function rs(n,e,t){t==null&&(t={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?i=t.dateNF:i=n;break;case"number":n==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:on)[n],i==null&&(i=t.table&&t.table[gx[n]]||on[gx[n]]),i==null&&(i=Kk[n]||"General");break}if(Jd(i,0))return dp(e,t);e instanceof Date&&(e=hS(e,t.date1904));var r=pC(i,e);if(Jd(r[1]))return dp(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return mC(r[1],e,t,r[0])}function TS(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(on[t]==null){e<0&&(e=t);continue}if(on[t]==n){e=t;break}}e<0&&(e=391)}return on[e]=n,e}function bf(n){for(var e=0;e!=392;++e)n[e]!==void 0&&TS(n[e],e)}function Sf(){on=qk()}var wS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function gC(n){var e=typeof n=="number"?on[n]:n;return e=e.replace(wS,"(\\d+)"),new RegExp("^"+e+"$")}function vC(n,e,t){var i=-1,r=-1,s=-1,l=-1,u=-1,f=-1;(e.match(wS)||[]).forEach(function(v,y){var S=parseInt(t[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":i=S;break;case"d":s=S;break;case"h":l=S;break;case"s":f=S;break;case"m":l>=0?u=S:r=S;break}}),f>=0&&u==-1&&r>=0&&(u=r,r=-1);var m=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?m:i==-1&&r==-1&&s==-1?p:m+"T"+p}var yC=function(){var n={};n.version="1.2.0";function e(){for(var D=0,z=new Array(256),R=0;R!=256;++R)D=R,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,z[R]=D;return typeof Int32Array<"u"?new Int32Array(z):z}var t=e();function i(D){var z=0,R=0,W=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)q[W]=D[W];for(W=0;W!=256;++W)for(R=D[W],z=256+W;z<4096;z+=256)R=q[z]=R>>>8^D[R&255];var J=[];for(W=1;W!=16;++W)J[W-1]=typeof Int32Array<"u"?q.subarray(W*256,W*256+256):q.slice(W*256,W*256+256);return J}var r=i(t),s=r[0],l=r[1],u=r[2],f=r[3],m=r[4],p=r[5],v=r[6],y=r[7],S=r[8],_=r[9],b=r[10],T=r[11],E=r[12],w=r[13],C=r[14];function j(D,z){for(var R=z^-1,W=0,q=D.length;W<q;)R=R>>>8^t[(R^D.charCodeAt(W++))&255];return~R}function k(D,z){for(var R=z^-1,W=D.length-15,q=0;q<W;)R=C[D[q++]^R&255]^w[D[q++]^R>>8&255]^E[D[q++]^R>>16&255]^T[D[q++]^R>>>24]^b[D[q++]]^_[D[q++]]^S[D[q++]]^y[D[q++]]^v[D[q++]]^p[D[q++]]^m[D[q++]]^f[D[q++]]^u[D[q++]]^l[D[q++]]^s[D[q++]]^t[D[q++]];for(W+=15;q<W;)R=R>>>8^t[(R^D[q++])&255];return~R}function P(D,z){for(var R=z^-1,W=0,q=D.length,J=0,me=0;W<q;)J=D.charCodeAt(W++),J<128?R=R>>>8^t[(R^J)&255]:J<2048?(R=R>>>8^t[(R^(192|J>>6&31))&255],R=R>>>8^t[(R^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,me=D.charCodeAt(W++)&1023,R=R>>>8^t[(R^(240|J>>8&7))&255],R=R>>>8^t[(R^(128|J>>2&63))&255],R=R>>>8^t[(R^(128|me>>6&15|(J&3)<<4))&255],R=R>>>8^t[(R^(128|me&63))&255]):(R=R>>>8^t[(R^(224|J>>12&15))&255],R=R>>>8^t[(R^(128|J>>6&63))&255],R=R>>>8^t[(R^(128|J&63))&255]);return~R}return n.table=t,n.bstr=j,n.buf=k,n.str=P,n}(),Bt=function(){var e={};e.version="1.2.1";function t(N,U){for(var M=N.split("/"),L=U.split("/"),F=0,B=0,oe=Math.min(M.length,L.length);F<oe;++F){if(B=M[F].length-L[F].length)return B;if(M[F]!=L[F])return M[F]<L[F]?-1:1}return M.length-L.length}function i(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:i(N.slice(0,-1));var U=N.lastIndexOf("/");return U===-1?N:N.slice(0,U+1)}function r(N){if(N.charAt(N.length-1)=="/")return r(N.slice(0,-1));var U=N.lastIndexOf("/");return U===-1?N:N.slice(U+1)}function s(N,U){typeof U=="string"&&(U=new Date(U));var M=U.getHours();M=M<<6|U.getMinutes(),M=M<<5|U.getSeconds()>>>1,N.write_shift(2,M);var L=U.getFullYear()-1980;L=L<<4|U.getMonth()+1,L=L<<5|U.getDate(),N.write_shift(2,L)}function l(N){var U=N.read_shift(2)&65535,M=N.read_shift(2)&65535,L=new Date,F=M&31;M>>>=5;var B=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(B-1),L.setDate(F);var oe=U&31;U>>>=5;var de=U&63;return U>>>=6,L.setHours(U),L.setMinutes(de),L.setSeconds(oe<<1),L}function u(N){Ui(N,0);for(var U={},M=0;N.l<=N.length-4;){var L=N.read_shift(2),F=N.read_shift(2),B=N.l+F,oe={};switch(L){case 21589:M=N.read_shift(1),M&1&&(oe.mtime=N.read_shift(4)),F>5&&(M&2&&(oe.atime=N.read_shift(4)),M&4&&(oe.ctime=N.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}N.l=B,U[L]=oe}return U}var f;function m(){return f||(f={})}function p(N,U){if(N[0]==80&&N[1]==75)return ji(N,U);if((N[0]|32)==109&&(N[1]|32)==105)return xn(N,U);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var M=3,L=512,F=0,B=0,oe=0,de=0,ie=0,ce=[],fe=N.slice(0,512);Ui(fe,0);var Te=v(fe);switch(M=Te[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(Te[1]==0)return ji(N,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(fe=N.slice(0,L),Ui(fe,28));var De=N.slice(0,L);y(fe,M);var Be=fe.read_shift(4,"i");if(M===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);fe.l+=4,oe=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),de=fe.read_shift(4,"i"),F=fe.read_shift(4,"i"),ie=fe.read_shift(4,"i"),B=fe.read_shift(4,"i");for(var Ae=-1,Ie=0;Ie<109&&(Ae=fe.read_shift(4,"i"),!(Ae<0));++Ie)ce[Ie]=Ae;var Ge=S(N,L);T(ie,B,Ge,L,ce);var yt=w(Ge,oe,ce,L);yt[oe].name="!Directory",F>0&&de!==me&&(yt[de].name="!MiniFAT"),yt[ce[0]].name="!FAT",yt.fat_addrs=ce,yt.ssz=L;var xt={},mt=[],mi=[],Di=[];C(oe,yt,Ge,mt,F,xt,mi,de),_(mi,Di,mt),mt.shift();var si={FileIndex:mi,FullPaths:Di};return U&&U.raw&&(si.raw={header:De,sectors:Ge}),si}function v(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Ce,"Header Signature: "),N.l+=16;var U=N.read_shift(2,"u");return[N.read_shift(2,"u"),U]}function y(N,U){var M=9;switch(N.l+=2,M=N.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function S(N,U){for(var M=Math.ceil(N.length/U)-1,L=[],F=1;F<M;++F)L[F-1]=N.slice(F*U,(F+1)*U);return L[M-1]=N.slice(M*U),L}function _(N,U,M){for(var L=0,F=0,B=0,oe=0,de=0,ie=M.length,ce=[],fe=[];L<ie;++L)ce[L]=fe[L]=L,U[L]=M[L];for(;de<fe.length;++de)L=fe[de],F=N[L].L,B=N[L].R,oe=N[L].C,ce[L]===L&&(F!==-1&&ce[F]!==F&&(ce[L]=ce[F]),B!==-1&&ce[B]!==B&&(ce[L]=ce[B])),oe!==-1&&(ce[oe]=L),F!==-1&&L!=ce[L]&&(ce[F]=ce[L],fe.lastIndexOf(F)<de&&fe.push(F)),B!==-1&&L!=ce[L]&&(ce[B]=ce[L],fe.lastIndexOf(B)<de&&fe.push(B));for(L=1;L<ie;++L)ce[L]===L&&(B!==-1&&ce[B]!==B?ce[L]=ce[B]:F!==-1&&ce[F]!==F&&(ce[L]=ce[F]));for(L=1;L<ie;++L)if(N[L].type!==0){if(de=L,de!=ce[de])do de=ce[de],U[L]=U[de]+"/"+U[L];while(de!==0&&ce[de]!==-1&&de!=ce[de]);ce[L]=-1}for(U[0]+="/",L=1;L<ie;++L)N[L].type!==2&&(U[L]+="/")}function b(N,U,M){for(var L=N.start,F=N.size,B=[],oe=L;M&&F>0&&oe>=0;)B.push(U.slice(oe*J,oe*J+J)),F-=J,oe=Bs(M,oe*4);return B.length===0?ge(0):Hn(B).slice(0,N.size)}function T(N,U,M,L,F){var B=me;if(N===me){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var oe=M[N],de=(L>>>2)-1;if(!oe)return;for(var ie=0;ie<de&&(B=Bs(oe,ie*4))!==me;++ie)F.push(B);T(Bs(oe,L-4),U-1,M,L,F)}}function E(N,U,M,L,F){var B=[],oe=[];F||(F=[]);var de=L-1,ie=0,ce=0;for(ie=U;ie>=0;){F[ie]=!0,B[B.length]=ie,oe.push(N[ie]);var fe=M[Math.floor(ie*4/L)];if(ce=ie*4&de,L<4+ce)throw new Error("FAT boundary crossed: "+ie+" 4 "+L);if(!N[fe])break;ie=Bs(N[fe],ce)}return{nodes:B,data:Cx([oe])}}function w(N,U,M,L){var F=N.length,B=[],oe=[],de=[],ie=[],ce=L-1,fe=0,Te=0,De=0,Be=0;for(fe=0;fe<F;++fe)if(de=[],De=fe+U,De>=F&&(De-=F),!oe[De]){ie=[];var Ae=[];for(Te=De;Te>=0;){Ae[Te]=!0,oe[Te]=!0,de[de.length]=Te,ie.push(N[Te]);var Ie=M[Math.floor(Te*4/L)];if(Be=Te*4&ce,L<4+Be)throw new Error("FAT boundary crossed: "+Te+" 4 "+L);if(!N[Ie]||(Te=Bs(N[Ie],Be),Ae[Te]))break}B[De]={nodes:de,data:Cx([ie])}}return B}function C(N,U,M,L,F,B,oe,de){for(var ie=0,ce=L.length?2:0,fe=U[N].data,Te=0,De=0,Be;Te<fe.length;Te+=128){var Ae=fe.slice(Te,Te+128);Ui(Ae,64),De=Ae.read_shift(2),Be=qp(Ae,0,De-ce),L.push(Be);var Ie={name:Be,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},Ge=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Ge!==0&&(Ie.ct=j(Ae,Ae.l-8));var yt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);yt!==0&&(Ie.mt=j(Ae,Ae.l-8)),Ie.start=Ae.read_shift(4,"i"),Ie.size=Ae.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=me,Ie.name=""),Ie.type===5?(ie=Ie.start,F>0&&ie!==me&&(U[ie].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",U[Ie.start]===void 0&&(U[Ie.start]=E(M,Ie.start,U.fat_addrs,U.ssz)),U[Ie.start].name=Ie.name,Ie.content=U[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:ie!==me&&Ie.start!==me&&U[ie]&&(Ie.content=b(Ie,U[ie].data,(U[de]||{}).data))),Ie.content&&Ui(Ie.content,0),B[Be]=Ie,oe.push(Ie)}}function j(N,U){return new Date((Wi(N,U+4)/1e7*Math.pow(2,32)+Wi(N,U)/1e7-11644473600)*1e3)}function k(N,U){return m(),p(f.readFileSync(N),U)}function P(N,U){var M=U&&U.type;switch(M||Tt&&Buffer.isBuffer(N)&&(M="buffer"),M||"base64"){case"file":return k(N,U);case"base64":return p(vr(va(N)),U);case"binary":return p(vr(N),U)}return p(N,U)}function D(N,U){var M=U||{},L=M.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=L+"/",N.FileIndex[0]={name:L,type:5}),M.CLSID&&(N.FileIndex[0].clsid=M.CLSID),z(N)}function z(N){var U="Sh33tJ5";if(!Bt.find(N,"/"+U)){var M=ge(4);M[0]=55,M[1]=M[3]=50,M[2]=54,N.FileIndex.push({name:U,type:2,content:M,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+U),R(N)}}function R(N,U){D(N);for(var M=!1,L=!1,F=N.FullPaths.length-1;F>=0;--F){var B=N.FileIndex[F];switch(B.type){case 0:L?M=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(B.R*B.L*B.C)&&(M=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!U)){var oe=new Date(1987,1,19),de=0,ie=Object.create?Object.create(null):{},ce=[];for(F=0;F<N.FullPaths.length;++F)ie[N.FullPaths[F]]=!0,N.FileIndex[F].type!==0&&ce.push([N.FullPaths[F],N.FileIndex[F]]);for(F=0;F<ce.length;++F){var fe=i(ce[F][0]);L=ie[fe],L||(ce.push([fe,{name:r(fe).replace("/",""),type:1,clsid:ne,ct:oe,mt:oe,content:null}]),ie[fe]=!0)}for(ce.sort(function(Be,Ae){return t(Be[0],Ae[0])}),N.FullPaths=[],N.FileIndex=[],F=0;F<ce.length;++F)N.FullPaths[F]=ce[F][0],N.FileIndex[F]=ce[F][1];for(F=0;F<ce.length;++F){var Te=N.FileIndex[F],De=N.FullPaths[F];if(Te.name=r(De).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||ne,F===0)Te.C=ce.length>1?1:-1,Te.size=0,Te.type=5;else if(De.slice(-1)=="/"){for(de=F+1;de<ce.length&&i(N.FullPaths[de])!=De;++de);for(Te.C=de>=ce.length?-1:de,de=F+1;de<ce.length&&i(N.FullPaths[de])!=i(De);++de);Te.R=de>=ce.length?-1:de,Te.type=1}else i(N.FullPaths[F+1]||"")==i(De)&&(Te.R=F+1),Te.type=2}}}function W(N,U){var M=U||{};if(M.fileType=="mad")return hi(N,M);switch(R(N),M.fileType){case"zip":return Kt(N,M)}var L=function(Be){for(var Ae=0,Ie=0,Ge=0;Ge<Be.FileIndex.length;++Ge){var yt=Be.FileIndex[Ge];if(yt.content){var xt=yt.content.length;xt>0&&(xt<4096?Ae+=xt+63>>6:Ie+=xt+511>>9)}}for(var mt=Be.FullPaths.length+3>>2,mi=Ae+7>>3,Di=Ae+127>>7,si=mi+Ie+mt+Di,pi=si+127>>7,Vr=pi<=109?0:Math.ceil((pi-109)/127);si+pi+Vr+127>>7>pi;)Vr=++pi<=109?0:Math.ceil((pi-109)/127);var oi=[1,Vr,pi,Di,mt,Ie,Ae,0];return Be.FileIndex[0].size=Ae<<6,oi[7]=(Be.FileIndex[0].start=oi[0]+oi[1]+oi[2]+oi[3]+oi[4]+oi[5])+(oi[6]+7>>3),oi}(N),F=ge(L[7]<<9),B=0,oe=0;{for(B=0;B<8;++B)F.write_shift(1,ve[B]);for(B=0;B<8;++B)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),B=0;B<3;++B)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,L[2]),F.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:me),F.write_shift(4,L[3]),F.write_shift(-4,L[1]?L[0]-1:me),F.write_shift(4,L[1]),B=0;B<109;++B)F.write_shift(-4,B<L[2]?L[1]+B:-1)}if(L[1])for(oe=0;oe<L[1];++oe){for(;B<236+oe*127;++B)F.write_shift(-4,B<L[2]?L[1]+B:-1);F.write_shift(-4,oe===L[1]-1?me:oe+1)}var de=function(Be){for(oe+=Be;B<oe-1;++B)F.write_shift(-4,B+1);Be&&(++B,F.write_shift(-4,me))};for(oe=B=0,oe+=L[1];B<oe;++B)F.write_shift(-4,Z.DIFSECT);for(oe+=L[2];B<oe;++B)F.write_shift(-4,Z.FATSECT);de(L[3]),de(L[4]);for(var ie=0,ce=0,fe=N.FileIndex[0];ie<N.FileIndex.length;++ie)fe=N.FileIndex[ie],fe.content&&(ce=fe.content.length,!(ce<4096)&&(fe.start=oe,de(ce+511>>9)));for(de(L[6]+7>>3);F.l&511;)F.write_shift(-4,Z.ENDOFCHAIN);for(oe=B=0,ie=0;ie<N.FileIndex.length;++ie)fe=N.FileIndex[ie],fe.content&&(ce=fe.content.length,!(!ce||ce>=4096)&&(fe.start=oe,de(ce+63>>6)));for(;F.l&511;)F.write_shift(-4,Z.ENDOFCHAIN);for(B=0;B<L[4]<<2;++B){var Te=N.FullPaths[B];if(!Te||Te.length===0){for(ie=0;ie<17;++ie)F.write_shift(4,0);for(ie=0;ie<3;++ie)F.write_shift(4,-1);for(ie=0;ie<12;++ie)F.write_shift(4,0);continue}fe=N.FileIndex[B],B===0&&(fe.start=fe.size?fe.start-1:me);var De=B===0&&M.root||fe.name;if(ce=2*(De.length+1),F.write_shift(64,De,"utf16le"),F.write_shift(2,ce),F.write_shift(1,fe.type),F.write_shift(1,fe.color),F.write_shift(-4,fe.L),F.write_shift(-4,fe.R),F.write_shift(-4,fe.C),fe.clsid)F.write_shift(16,fe.clsid,"hex");else for(ie=0;ie<4;++ie)F.write_shift(4,0);F.write_shift(4,fe.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,fe.start),F.write_shift(4,fe.size),F.write_shift(4,0)}for(B=1;B<N.FileIndex.length;++B)if(fe=N.FileIndex[B],fe.size>=4096)if(F.l=fe.start+1<<9,Tt&&Buffer.isBuffer(fe.content))fe.content.copy(F,F.l,0,fe.size),F.l+=fe.size+511&-512;else{for(ie=0;ie<fe.size;++ie)F.write_shift(1,fe.content[ie]);for(;ie&511;++ie)F.write_shift(1,0)}for(B=1;B<N.FileIndex.length;++B)if(fe=N.FileIndex[B],fe.size>0&&fe.size<4096)if(Tt&&Buffer.isBuffer(fe.content))fe.content.copy(F,F.l,0,fe.size),F.l+=fe.size+63&-64;else{for(ie=0;ie<fe.size;++ie)F.write_shift(1,fe.content[ie]);for(;ie&63;++ie)F.write_shift(1,0)}if(Tt)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function q(N,U){var M=N.FullPaths.map(function(ie){return ie.toUpperCase()}),L=M.map(function(ie){var ce=ie.split("/");return ce[ce.length-(ie.slice(-1)=="/"?2:1)]}),F=!1;U.charCodeAt(0)===47?(F=!0,U=M[0].slice(0,-1)+U):F=U.indexOf("/")!==-1;var B=U.toUpperCase(),oe=F===!0?M.indexOf(B):L.indexOf(B);if(oe!==-1)return N.FileIndex[oe];var de=!B.match(Ad);for(B=B.replace(Ec,""),de&&(B=B.replace(Ad,"!")),oe=0;oe<M.length;++oe)if((de?M[oe].replace(Ad,"!"):M[oe]).replace(Ec,"")==B||(de?L[oe].replace(Ad,"!"):L[oe]).replace(Ec,"")==B)return N.FileIndex[oe];return null}var J=64,me=-2,Ce="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function be(N,U,M){m();var L=W(N,M);f.writeFileSync(U,L)}function Ne(N){for(var U=new Array(N.length),M=0;M<N.length;++M)U[M]=String.fromCharCode(N[M]);return U.join("")}function V(N,U){var M=W(N,U);switch(U&&U.type||"buffer"){case"file":return m(),f.writeFileSync(U.filename,M),M;case"binary":return typeof M=="string"?M:Ne(M);case"base64":return zc(typeof M=="string"?M:Ne(M));case"buffer":if(Tt)return Buffer.isBuffer(M)?M:ba(M);case"array":return typeof M=="string"?vr(M):M}return M}var he;function I(N){try{var U=N.InflateRaw,M=new U;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)he=N;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function Y(N,U){if(!he)return ai(N,U);var M=he.InflateRaw,L=new M,F=L._processChunk(N.slice(N.l),L._finishFlushFlag);return N.l+=L.bytesRead,F}function G(N){return he?he.deflateRawSync(N):Ee(N)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Oe(N){var U=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(U>>16|U>>8|U)&255}for(var we=typeof Uint8Array<"u",ke=we?new Uint8Array(256):[],dt=0;dt<256;++dt)ke[dt]=Oe(dt);function et(N,U){var M=ke[N&255];return U<=8?M>>>8-U:(M=M<<8|ke[N>>8&255],U<=16?M>>>16-U:(M=M<<8|ke[N>>16&255],M>>>24-U))}function Yt(N,U){var M=U&7,L=U>>>3;return(N[L]|(M<=6?0:N[L+1]<<8))>>>M&3}function at(N,U){var M=U&7,L=U>>>3;return(N[L]|(M<=5?0:N[L+1]<<8))>>>M&7}function Yn(N,U){var M=U&7,L=U>>>3;return(N[L]|(M<=4?0:N[L+1]<<8))>>>M&15}function vt(N,U){var M=U&7,L=U>>>3;return(N[L]|(M<=3?0:N[L+1]<<8))>>>M&31}function Pe(N,U){var M=U&7,L=U>>>3;return(N[L]|(M<=1?0:N[L+1]<<8))>>>M&127}function An(N,U,M){var L=U&7,F=U>>>3,B=(1<<M)-1,oe=N[F]>>>L;return M<8-L||(oe|=N[F+1]<<8-L,M<16-L)||(oe|=N[F+2]<<16-L,M<24-L)||(oe|=N[F+3]<<24-L),oe&B}function Mn(N,U,M){var L=U&7,F=U>>>3;return L<=5?N[F]|=(M&7)<<L:(N[F]|=M<<L&255,N[F+1]=(M&7)>>8-L),U+3}function ni(N,U,M){var L=U&7,F=U>>>3;return M=(M&1)<<L,N[F]|=M,U+1}function ii(N,U,M){var L=U&7,F=U>>>3;return M<<=L,N[F]|=M&255,M>>>=8,N[F+1]=M,U+8}function Qe(N,U,M){var L=U&7,F=U>>>3;return M<<=L,N[F]|=M&255,M>>>=8,N[F+1]=M&255,N[F+2]=M>>>8,U+16}function ze(N,U){var M=N.length,L=2*M>U?2*M:U+5,F=0;if(M>=U)return N;if(Tt){var B=hx(L);if(N.copy)N.copy(B);else for(;F<N.length;++F)B[F]=N[F];return B}else if(we){var oe=new Uint8Array(L);if(oe.set)oe.set(N);else for(;F<M;++F)oe[F]=N[F];return oe}return N.length=L,N}function Ye(N){for(var U=new Array(N),M=0;M<N;++M)U[M]=0;return U}function Ze(N,U,M){var L=1,F=0,B=0,oe=0,de=0,ie=N.length,ce=we?new Uint16Array(32):Ye(32);for(B=0;B<32;++B)ce[B]=0;for(B=ie;B<M;++B)N[B]=0;ie=N.length;var fe=we?new Uint16Array(ie):Ye(ie);for(B=0;B<ie;++B)ce[F=N[B]]++,L<F&&(L=F),fe[B]=0;for(ce[0]=0,B=1;B<=L;++B)ce[B+16]=de=de+ce[B-1]<<1;for(B=0;B<ie;++B)de=N[B],de!=0&&(fe[B]=ce[de+16]++);var Te=0;for(B=0;B<ie;++B)if(Te=N[B],Te!=0)for(de=et(fe[B],L)>>L-Te,oe=(1<<L+4-Te)-1;oe>=0;--oe)U[de|oe<<Te]=Te&15|B<<4;return L}var Rt=we?new Uint16Array(512):Ye(512),Et=we?new Uint16Array(32):Ye(32);if(!we){for(var Wt=0;Wt<512;++Wt)Rt[Wt]=0;for(Wt=0;Wt<32;++Wt)Et[Wt]=0}(function(){for(var N=[],U=0;U<32;U++)N.push(5);Ze(N,Et,32);var M=[];for(U=0;U<=143;U++)M.push(8);for(;U<=255;U++)M.push(9);for(;U<=279;U++)M.push(7);for(;U<=287;U++)M.push(8);Ze(M,Rt,288)})();var te=function(){for(var U=we?new Uint8Array(32768):[],M=0,L=0;M<Le.length-1;++M)for(;L<Le[M+1];++L)U[L]=M;for(;L<32768;++L)U[L]=29;var F=we?new Uint8Array(259):[];for(M=0,L=0;M<se.length-1;++M)for(;L<se[M+1];++L)F[L]=M;function B(de,ie){for(var ce=0;ce<de.length;){var fe=Math.min(65535,de.length-ce),Te=ce+fe==de.length;for(ie.write_shift(1,+Te),ie.write_shift(2,fe),ie.write_shift(2,~fe&65535);fe-- >0;)ie[ie.l++]=de[ce++]}return ie.l}function oe(de,ie){for(var ce=0,fe=0,Te=we?new Uint16Array(32768):[];fe<de.length;){var De=Math.min(65535,de.length-fe);if(De<10){for(ce=Mn(ie,ce,+(fe+De==de.length)),ce&7&&(ce+=8-(ce&7)),ie.l=ce/8|0,ie.write_shift(2,De),ie.write_shift(2,~De&65535);De-- >0;)ie[ie.l++]=de[fe++];ce=ie.l*8;continue}ce=Mn(ie,ce,+(fe+De==de.length)+2);for(var Be=0;De-- >0;){var Ae=de[fe];Be=(Be<<5^Ae)&32767;var Ie=-1,Ge=0;if((Ie=Te[Be])&&(Ie|=fe&-32768,Ie>fe&&(Ie-=32768),Ie<fe))for(;de[Ie+Ge]==de[fe+Ge]&&Ge<250;)++Ge;if(Ge>2){Ae=F[Ge],Ae<=22?ce=ii(ie,ce,ke[Ae+1]>>1)-1:(ii(ie,ce,3),ce+=5,ii(ie,ce,ke[Ae-23]>>5),ce+=3);var yt=Ae<8?0:Ae-4>>2;yt>0&&(Qe(ie,ce,Ge-se[Ae]),ce+=yt),Ae=U[fe-Ie],ce=ii(ie,ce,ke[Ae]>>3),ce-=3;var xt=Ae<4?0:Ae-2>>1;xt>0&&(Qe(ie,ce,fe-Ie-Le[Ae]),ce+=xt);for(var mt=0;mt<Ge;++mt)Te[Be]=fe&32767,Be=(Be<<5^de[fe])&32767,++fe;De-=Ge-1}else Ae<=143?Ae=Ae+48:ce=ni(ie,ce,1),ce=ii(ie,ce,ke[Ae]),Te[Be]=fe&32767,++fe}ce=ii(ie,ce,0)-1}return ie.l=(ce+7)/8|0,ie.l}return function(ie,ce){return ie.length<8?B(ie,ce):oe(ie,ce)}}();function Ee(N){var U=ge(50+Math.floor(N.length*1.1)),M=te(N,U);return U.slice(0,M)}var Ke=we?new Uint16Array(32768):Ye(32768),We=we?new Uint16Array(32768):Ye(32768),st=we?new Uint16Array(128):Ye(128),ft=1,Vt=1;function ri(N,U){var M=vt(N,U)+257;U+=5;var L=vt(N,U)+1;U+=5;var F=Yn(N,U)+4;U+=4;for(var B=0,oe=we?new Uint8Array(19):Ye(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ce=we?new Uint8Array(8):Ye(8),fe=we?new Uint8Array(8):Ye(8),Te=oe.length,De=0;De<F;++De)oe[K[De]]=B=at(N,U),ie<B&&(ie=B),ce[B]++,U+=3;var Be=0;for(ce[0]=0,De=1;De<=ie;++De)fe[De]=Be=Be+ce[De-1]<<1;for(De=0;De<Te;++De)(Be=oe[De])!=0&&(de[De]=fe[Be]++);var Ae=0;for(De=0;De<Te;++De)if(Ae=oe[De],Ae!=0){Be=ke[de[De]]>>8-Ae;for(var Ie=(1<<7-Ae)-1;Ie>=0;--Ie)st[Be|Ie<<Ae]=Ae&7|De<<3}var Ge=[];for(ie=1;Ge.length<M+L;)switch(Be=st[Pe(N,U)],U+=Be&7,Be>>>=3){case 16:for(B=3+Yt(N,U),U+=2,Be=Ge[Ge.length-1];B-- >0;)Ge.push(Be);break;case 17:for(B=3+at(N,U),U+=3;B-- >0;)Ge.push(0);break;case 18:for(B=11+Pe(N,U),U+=7;B-- >0;)Ge.push(0);break;default:Ge.push(Be),ie<Be&&(ie=Be);break}var yt=Ge.slice(0,M),xt=Ge.slice(M);for(De=M;De<286;++De)yt[De]=0;for(De=L;De<30;++De)xt[De]=0;return ft=Ze(yt,Ke,286),Vt=Ze(xt,We,30),U}function tt(N,U){if(N[0]==3&&!(N[1]&3))return[Ys(U),2];for(var M=0,L=0,F=hx(U||1<<18),B=0,oe=F.length>>>0,de=0,ie=0;(L&1)==0;){if(L=at(N,M),M+=3,L>>>1)L>>1==1?(de=9,ie=5):(M=ri(N,M),de=ft,ie=Vt);else{M&7&&(M+=8-(M&7));var ce=N[M>>>3]|N[(M>>>3)+1]<<8;if(M+=32,ce>0)for(!U&&oe<B+ce&&(F=ze(F,B+ce),oe=F.length);ce-- >0;)F[B++]=N[M>>>3],M+=8;continue}for(;;){!U&&oe<B+32767&&(F=ze(F,B+32767),oe=F.length);var fe=An(N,M,de),Te=L>>>1==1?Rt[fe]:Ke[fe];if(M+=Te&15,Te>>>=4,(Te>>>8&255)===0)F[B++]=Te;else{if(Te==256)break;Te-=257;var De=Te<8?0:Te-4>>2;De>5&&(De=0);var Be=B+se[Te];De>0&&(Be+=An(N,M,De),M+=De),fe=An(N,M,ie),Te=L>>>1==1?Et[fe]:We[fe],M+=Te&15,Te>>>=4;var Ae=Te<4?0:Te-2>>1,Ie=Le[Te];for(Ae>0&&(Ie+=An(N,M,Ae),M+=Ae),!U&&oe<Be&&(F=ze(F,Be+100),oe=F.length);B<Be;)F[B]=F[B-Ie],++B}}}return U?[F,M+7>>>3]:[F.slice(0,B),M+7>>>3]}function ai(N,U){var M=N.slice(N.l||0),L=tt(M,U);return N.l+=L[1],L[0]}function $n(N,U){if(N)typeof console<"u"&&console.error(U);else throw new Error(U)}function ji(N,U){var M=N;Ui(M,0);var L=[],F=[],B={FileIndex:L,FullPaths:F};D(B,{root:U.root});for(var oe=M.length-4;(M[oe]!=80||M[oe+1]!=75||M[oe+2]!=5||M[oe+3]!=6)&&oe>=0;)--oe;M.l=oe+4,M.l+=4;var de=M.read_shift(2);M.l+=6;var ie=M.read_shift(4);for(M.l=ie,oe=0;oe<de;++oe){M.l+=20;var ce=M.read_shift(4),fe=M.read_shift(4),Te=M.read_shift(2),De=M.read_shift(2),Be=M.read_shift(2);M.l+=8;var Ae=M.read_shift(4),Ie=u(M.slice(M.l+Te,M.l+Te+De));M.l+=Te+De+Be;var Ge=M.l;M.l=Ae+4,_r(M,ce,fe,B,Ie),M.l=Ge}return B}function _r(N,U,M,L,F){N.l+=2;var B=N.read_shift(2),oe=N.read_shift(2),de=l(N);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var ie=N.read_shift(4),ce=N.read_shift(4),fe=N.read_shift(4),Te=N.read_shift(2),De=N.read_shift(2),Be="",Ae=0;Ae<Te;++Ae)Be+=String.fromCharCode(N[N.l++]);if(De){var Ie=u(N.slice(N.l,N.l+De));(Ie[21589]||{}).mt&&(de=Ie[21589].mt),((F||{})[21589]||{}).mt&&(de=F[21589].mt)}N.l+=De;var Ge=N.slice(N.l,N.l+ce);switch(oe){case 8:Ge=Y(N,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var yt=!1;B&8&&(ie=N.read_shift(4),ie==134695760&&(ie=N.read_shift(4),yt=!0),ce=N.read_shift(4),fe=N.read_shift(4)),ce!=U&&$n(yt,"Bad compressed size: "+U+" != "+ce),fe!=M&&$n(yt,"Bad uncompressed size: "+M+" != "+fe),tn(L,Be,Ge,{unsafe:!0,mt:de})}function Kt(N,U){var M=U||{},L=[],F=[],B=ge(1),oe=M.compression?8:0,de=0,ie=0,ce=0,fe=0,Te=0,De=N.FullPaths[0],Be=De,Ae=N.FileIndex[0],Ie=[],Ge=0;for(ie=1;ie<N.FullPaths.length;++ie)if(Be=N.FullPaths[ie].slice(De.length),Ae=N.FileIndex[ie],!(!Ae.size||!Ae.content||Be=="Sh33tJ5")){var yt=fe,xt=ge(Be.length);for(ce=0;ce<Be.length;++ce)xt.write_shift(1,Be.charCodeAt(ce)&127);xt=xt.slice(0,xt.l),Ie[Te]=yC.buf(Ae.content,0);var mt=Ae.content;oe==8&&(mt=G(mt)),B=ge(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,de),B.write_shift(2,oe),Ae.mt?s(B,Ae.mt):B.write_shift(4,0),B.write_shift(-4,Ie[Te]),B.write_shift(4,mt.length),B.write_shift(4,Ae.content.length),B.write_shift(2,xt.length),B.write_shift(2,0),fe+=B.length,L.push(B),fe+=xt.length,L.push(xt),fe+=mt.length,L.push(mt),B=ge(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,de),B.write_shift(2,oe),B.write_shift(4,0),B.write_shift(-4,Ie[Te]),B.write_shift(4,mt.length),B.write_shift(4,Ae.content.length),B.write_shift(2,xt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,yt),Ge+=B.l,F.push(B),Ge+=xt.length,F.push(xt),++Te}return B=ge(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,Te),B.write_shift(2,Te),B.write_shift(4,Ge),B.write_shift(4,fe),B.write_shift(2,0),Hn([Hn(L),Hn(F),B])}var Gi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Sa(N,U){if(N.ctype)return N.ctype;var M=N.name||"",L=M.match(/\.([^\.]+)$/);return L&&Gi[L[1]]||U&&(L=(M=U).match(/[\.\\]([^\.\\])+$/),L&&Gi[L[1]])?Gi[L[1]]:"application/octet-stream"}function eo(N){for(var U=zc(N),M=[],L=0;L<U.length;L+=76)M.push(U.slice(L,L+76));return M.join(`\r
`)+`\r
`}function cs(N){var U=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var fe=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=U.split(`\r
`),F=0;F<L.length;++F){var B=L[F];if(B.length==0){M.push("");continue}for(var oe=0;oe<B.length;){var de=76,ie=B.slice(oe,oe+de);ie.charAt(de-1)=="="?de--:ie.charAt(de-2)=="="?de-=2:ie.charAt(de-3)=="="&&(de-=3),ie=B.slice(oe,oe+de),oe+=de,oe<B.length&&(ie+="="),M.push(ie)}}return M.join(`\r
`)}function us(N){for(var U=[],M=0;M<N.length;++M){for(var L=N[M];M<=N.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+N[++M];U.push(L)}for(var F=0;F<U.length;++F)U[F]=U[F].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return vr(U.join(`\r
`))}function to(N,U,M){for(var L="",F="",B="",oe,de=0;de<10;++de){var ie=U[de];if(!ie||ie.match(/^\s*$/))break;var ce=ie.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":L=ce[2].trim();break;case"content-type":B=ce[2].trim();break;case"content-transfer-encoding":F=ce[2].trim();break}}switch(++de,F.toLowerCase()){case"base64":oe=vr(va(U.slice(de).join("")));break;case"quoted-printable":oe=us(U.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var fe=tn(N,L.slice(M.length),oe,{unsafe:!0});B&&(fe.ctype=B)}function xn(N,U){if(Ne(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=U&&U.root||"",L=(Tt&&Buffer.isBuffer(N)?N.toString("binary"):Ne(N)).split(`\r
`),F=0,B="";for(F=0;F<L.length;++F)if(B=L[F],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),M||(M=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),B.slice(0,M.length)!=M););var oe=(L[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var de="--"+(oe[1]||""),ie=[],ce=[],fe={FileIndex:ie,FullPaths:ce};D(fe);var Te,De=0;for(F=0;F<L.length;++F){var Be=L[F];Be!==de&&Be!==de+"--"||(De++&&to(fe,L.slice(Te,F),M),Te=F)}return fe}function hi(N,U){var M=U||{},L=M.boundary||"SheetJS";L="------="+L;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],B=N.FullPaths[0],oe=B,de=N.FileIndex[0],ie=1;ie<N.FullPaths.length;++ie)if(oe=N.FullPaths[ie].slice(B.length),de=N.FileIndex[ie],!(!de.size||!de.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var ce=de.content,fe=Tt&&Buffer.isBuffer(ce)?ce.toString("binary"):Ne(ce),Te=0,De=Math.min(1024,fe.length),Be=0,Ae=0;Ae<=De;++Ae)(Be=fe.charCodeAt(Ae))>=32&&Be<128&&++Te;var Ie=Te>=De*4/5;F.push(L),F.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+oe),F.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),F.push("Content-Type: "+Sa(de,oe)),F.push(""),F.push(Ie?cs(fe):eo(fe))}return F.push(L+`--\r
`),F.join(`\r
`)}function en(N){var U={};return D(U,N),U}function tn(N,U,M,L){var F=L&&L.unsafe;F||D(N);var B=!F&&Bt.find(N,U);if(!B){var oe=N.FullPaths[0];U.slice(0,oe.length)==oe?oe=U:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+U).replace("//","/")),B={name:r(U),type:2},N.FileIndex.push(B),N.FullPaths.push(oe),F||Bt.utils.cfb_gc(N)}return B.content=M,B.size=M?M.length:0,L&&(L.CLSID&&(B.clsid=L.CLSID),L.mt&&(B.mt=L.mt),L.ct&&(B.ct=L.ct)),B}function Tr(N,U){D(N);var M=Bt.find(N,U);if(M){for(var L=0;L<N.FileIndex.length;++L)if(N.FileIndex[L]==M)return N.FileIndex.splice(L,1),N.FullPaths.splice(L,1),!0}return!1}function ds(N,U,M){D(N);var L=Bt.find(N,U);if(L){for(var F=0;F<N.FileIndex.length;++F)if(N.FileIndex[F]==L)return N.FileIndex[F].name=r(M),N.FullPaths[F]=M,!0}return!1}function cl(N){R(N,!0)}return e.find=q,e.read=P,e.parse=p,e.write=V,e.writeFile=be,e.utils={cfb_new:en,cfb_add:tn,cfb_del:Tr,cfb_mov:ds,cfb_gc:cl,ReadShift:kc,CheckField:HS,prep_blob:Ui,bconcat:Hn,use_zlib:I,_deflateRaw:Ee,_inflateRaw:ai,consts:Z},e}();function xC(n){return typeof n=="string"?xf(n):Array.isArray(n)?Gk(n):n}function Jc(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=xf(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var i=t=="utf8"?Hc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var r=new Blob([xC(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,n);if(typeof saveAs<"u")return saveAs(r,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=n,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=Zc(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+n)}function Gn(n){for(var e=Object.keys(n),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(n,e[i])&&t.push(e[i]);return t}function Sx(n,e){for(var t=[],i=Gn(n),r=0;r!==i.length;++r)t[n[i[r]][e]]==null&&(t[n[i[r]][e]]=i[r]);return t}function Gp(n){for(var e=[],t=Gn(n),i=0;i!==t.length;++i)e[n[t[i]]]=t[i];return e}function _f(n){for(var e=[],t=Gn(n),i=0;i!==t.length;++i)e[n[t[i]]]=parseInt(t[i],10);return e}function bC(n){for(var e=[],t=Gn(n),i=0;i!==t.length;++i)e[n[t[i]]]==null&&(e[n[t[i]]]=[]),e[n[t[i]]].push(t[i]);return e}var ef=new Date(1899,11,30,0,0,0);function ki(n,e){var t=n.getTime(),i=ef.getTime()+(n.getTimezoneOffset()-ef.getTimezoneOffset())*6e4;return(t-i)/(24*60*60*1e3)}var ES=new Date,SC=ef.getTime()+(ES.getTimezoneOffset()-ef.getTimezoneOffset())*6e4,_x=ES.getTimezoneOffset();function AS(n){var e=new Date;return e.setTime(n*24*60*60*1e3+SC),e.getTimezoneOffset()!==_x&&e.setTime(e.getTime()+(e.getTimezoneOffset()-_x)*6e4),e}var Tx=new Date("2017-02-19T19:06:09.000Z"),kS=isNaN(Tx.getFullYear())?new Date("2/19/17"):Tx,_C=kS.getFullYear()==2017;function fi(n,e){var t=new Date(n);if(_C)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(kS.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return n.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var r=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Tf(n,e){if(Tt&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var i=[],r=0;r!=n.length;++r)i.push(String.fromCharCode(n[r]));return i.join("")}function Ci(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ci(n[t]));return e}function an(n,e){for(var t="";t.length<e;)t+=n;return t}function ma(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(r,s){return t=-t,s}),!isNaN(e=Number(i)))?e/t:e}var TC=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uc(n){var e=new Date(n),t=new Date(NaN),i=e.getYear(),r=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var l=n.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&TC.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return i<0||i>8099?t:(r>0||s>1)&&i!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function it(n,e,t){if(n.FullPaths){if(typeof t=="string"){var i;return Tt?i=ba(t):i=Yk(t),Bt.utils.cfb_add(n,e,i)}Bt.utils.cfb_add(n,e,t)}else n.file(e,t)}function Yp(){return Bt.utils.cfb_new()}var yn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,wC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$p=Gp(wC),Xp=/[&<>'"]/g,EC=/[\u0000-\u0008\u000b-\u001f]/g;function Nt(n){var e=n+"";return e.replace(Xp,function(t){return $p[t]}).replace(EC,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function wx(n){return Nt(n).replace(/ /g,"_x0020_")}var CS=/[\u0000-\u001f]/g;function AC(n){var e=n+"";return e.replace(Xp,function(t){return $p[t]}).replace(/\n/g,"<br/>").replace(CS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function kC(n){var e=n+"";return e.replace(Xp,function(t){return $p[t]}).replace(CS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function CC(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function jC(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gm(n){for(var e="",t=0,i=0,r=0,s=0,l=0,u=0;t<n.length;){if(i=n.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(r=n.charCodeAt(t++),i>191&&i<224){l=(i&31)<<6,l|=r&63,e+=String.fromCharCode(l);continue}if(s=n.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(r&63)<<6|s&63);continue}l=n.charCodeAt(t++),u=((i&7)<<18|(r&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function Ex(n){var e=Ys(2*n.length),t,i,r=1,s=0,l=0,u;for(i=0;i<n.length;i+=r)r=1,(u=n.charCodeAt(i))<128?t=u:u<224?(t=(u&31)*64+(n.charCodeAt(i+1)&63),r=2):u<240?(t=(u&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),r=3):(r=4,t=(u&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function Ax(n){return ba(n,"binary").toString("utf8")}var Cd="foo bar baz",Ac=Tt&&(Ax(Cd)==Gm(Cd)&&Ax||Ex(Cd)==Gm(Cd)&&Ex)||Gm,Hc=Tt?function(n){return ba(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,i=0,r=0;t<n.length;)switch(i=n.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=n.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(r>>18&7))),e.push(String.fromCharCode(144+(r>>12&63))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},DC=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<n.length;++r)i=i.replace(n[r][0],n[r][1]);return i}}(),jS=/(^\s|\s$|\n)/;function Wn(n,e){return"<"+n+(e.match(jS)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Wc(n){return Gn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function Re(n,e,t){return"<"+n+(t!=null?Wc(t):"")+(e!=null?(e.match(jS)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function fp(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function NC(n,e){switch(typeof n){case"string":var t=Re("vt:lpwstr",Nt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Re((n|0)==n?"vt:i4":"vt:r8",Nt(String(n)));case"boolean":return Re("vt:bool",n?"true":"false")}if(n instanceof Date)return Re("vt:filetime",fp(n));throw new Error("Unable to serialize "+n)}var Nn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},al=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Hi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function OC(n,e){for(var t=1-2*(n[e+7]>>>7),i=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),r=n[e+6]&15,s=5;s>=0;--s)r=r*256+n[e+s];return i==2047?r==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),t*Math.pow(2,i-52)*r)}function RC(n,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,r=0,s=0,l=i?-e:e;isFinite(l)?l==0?r=s=0:(r=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-r),r<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?r=-1022:(s-=Math.pow(2,52),r+=1023)):(r=2047,s=isNaN(e)?26985:0);for(var u=0;u<=5;++u,s/=256)n[t+u]=s&255;n[t+6]=(r&15)<<4|s&15,n[t+7]=r>>4|i}var kx=function(n){for(var e=[],t=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var r=0,s=n[0][i].length;r<s;r+=t)e.push.apply(e,n[0][i].slice(r,r+t));return e},Cx=Tt?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:ba(e)})):kx(n)}:kx,jx=function(n,e,t){for(var i=[],r=e;r<t;r+=2)i.push(String.fromCharCode(xc(n,r)));return i.join("").replace(Ec,"")},qp=Tt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Ec,""):jx(n,e,t)}:jx,Dx=function(n,e,t){for(var i=[],r=e;r<e+t;++r)i.push(("0"+n[r].toString(16)).slice(-2));return i.join("")},DS=Tt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):Dx(n,e,t)}:Dx,Nx=function(n,e,t){for(var i=[],r=e;r<t;r++)i.push(String.fromCharCode(Wo(n,r)));return i.join("")},Qc=Tt?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):Nx(e,t,i)}:Nx,NS=function(n,e){var t=Wi(n,e);return t>0?Qc(n,e+4,e+4+t-1):""},OS=NS,RS=function(n,e){var t=Wi(n,e);return t>0?Qc(n,e+4,e+4+t-1):""},MS=RS,LS=function(n,e){var t=2*Wi(n,e);return t>0?Qc(n,e+4,e+4+t-1):""},IS=LS,PS=function(e,t){var i=Wi(e,t);return i>0?qp(e,t+4,t+4+i):""},BS=PS,FS=function(n,e){var t=Wi(n,e);return t>0?Qc(n,e+4,e+4+t):""},zS=FS,US=function(n,e){return OC(n,e)},tf=US,Kp=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Tt&&(OS=function(e,t){if(!Buffer.isBuffer(e))return NS(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},MS=function(e,t){if(!Buffer.isBuffer(e))return RS(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},IS=function(e,t){if(!Buffer.isBuffer(e))return LS(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},BS=function(e,t){if(!Buffer.isBuffer(e))return PS(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},zS=function(e,t){if(!Buffer.isBuffer(e))return FS(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},tf=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):US(e,t)},Kp=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Wo=function(n,e){return n[e]},xc=function(n,e){return n[e+1]*256+n[e]},MC=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Wi=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Bs=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},LC=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function kc(n,e){var t="",i,r,s=[],l,u,f,m;switch(e){case"dbcs":if(m=this.l,Tt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(f=0;f<n;++f)t+=String.fromCharCode(xc(this,m)),m+=2;n*=2;break;case"utf8":t=Qc(this,this.l,this.l+n);break;case"utf16le":n*=2,t=qp(this,this.l,this.l+n);break;case"wstr":return kc.call(this,n,"dbcs");case"lpstr-ansi":t=OS(this,this.l),n=4+Wi(this,this.l);break;case"lpstr-cp":t=MS(this,this.l),n=4+Wi(this,this.l);break;case"lpwstr":t=IS(this,this.l),n=4+2*Wi(this,this.l);break;case"lpp4":n=4+Wi(this,this.l),t=BS(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Wi(this,this.l),t=zS(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(l=Wo(this,this.l+n++))!==0;)s.push(Ed(l));t=s.join("");break;case"_wstr":for(n=0,t="";(l=xc(this,this.l+n))!==0;)s.push(Ed(l)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",m=this.l,f=0;f<n;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Wo(this,m),this.l=m+1,u=kc.call(this,n-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Ed(xc(this,m))),m+=2}t=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,f=0;f!=n;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Wo(this,m),this.l=m+1,u=kc.call(this,n-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Ed(Wo(this,m))),m+=1}t=s.join("");break;default:switch(n){case 1:return i=Wo(this,this.l),this.l++,i;case 2:return i=(e==="i"?MC:xc)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(i=(n>0?Bs:LC)(this,this.l),this.l+=4,i):(r=Wi(this,this.l),this.l+=4,r);case 8:case-8:if(e==="f")return n==8?r=tf(this,this.l):r=tf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;n=8;case 16:t=DS(this,this.l,n);break}}return this.l+=n,t}var IC=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},PC=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},BC=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function FC(n,e,t){var i=0,r=0;if(t==="dbcs"){for(r=0;r!=e.length;++r)BC(this,e.charCodeAt(r),this.l+2*r);i=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=e.length;++r)this[this.l+r]=e.charCodeAt(r)&255;i=e.length}else if(t==="hex"){for(;r<n;++r)this[this.l++]=parseInt(e.slice(2*r,2*r+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+n,this.length);for(r=0;r<Math.min(e.length,n);++r){var l=e.charCodeAt(r);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,IC(this,e,this.l);break;case 8:if(i=8,t==="f"){RC(this,e,this.l);break}case 16:break;case-4:i=4,PC(this,e,this.l);break}return this.l+=i,this}function HS(n,e){var t=DS(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Ui(n,e){n.l=e,n.read_shift=kc,n.chk=HS,n.write_shift=FC}function Ur(n,e){n.l+=e}function ge(n){var e=Ys(n);return Ui(e,0),e}function Ei(){var n=[],e=Tt?256:2048,t=function(m){var p=ge(m);return Ui(p,0),p},i=t(e),r=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i),i=null)},s=function(m){return i&&m<i.length-i.l?i:(r(),i=t(Math.max(m+1,e)))},l=function(){return r(),Hn(n)},u=function(m){r(),i=m,i.l==null&&(i.l=i.length),s(e)};return{next:s,push:u,end:l,_bufs:n}}function _e(n,e,t,i){var r=+e,s;if(!isNaN(r)){i||(i=OR[r].p||(t||[]).length||0),s=1+(r>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var l=n.next(s);r<=127?l.write_shift(1,r):(l.write_shift(1,(r&127)+128),l.write_shift(1,r>>7));for(var u=0;u!=4;++u)if(i>=128)l.write_shift(1,(i&127)+128),i>>=7;else{l.write_shift(1,i);break}i>0&&Kp(t)&&n.push(t)}}function Cc(n,e,t){var i=Ci(n);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Ox(n,e,t){var i=Ci(n);return i.s=Cc(i.s,e.s,t),i.e=Cc(i.e,e.s,t),i}function jc(n,e){if(n.cRel&&n.c<0)for(n=Ci(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ci(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Ot(n);return!n.cRel&&n.cRel!=null&&(t=HC(t)),!n.rRel&&n.rRel!=null&&(t=zC(t)),t}function Ym(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Qn(n.s.c)+":"+(n.e.cRel?"":"$")+Qn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Vn(n.s.r)+":"+(n.e.rRel?"":"$")+Vn(n.e.r):jc(n.s,e.biff)+":"+jc(n.e,e.biff)}function Zp(n){return parseInt(UC(n),10)-1}function Vn(n){return""+(n+1)}function zC(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function UC(n){return n.replace(/\$(\d+)$/,"$1")}function Jp(n){for(var e=WC(n),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function Qn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function HC(n){return n.replace(/^([A-Z])/,"$$$1")}function WC(n){return n.replace(/^\$([A-Z])/,"$1")}function VC(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function On(n){for(var e=0,t=0,i=0;i<n.length;++i){var r=n.charCodeAt(i);r>=48&&r<=57?e=10*e+(r-48):r>=65&&r<=90&&(t=26*t+(r-64))}return{c:t-1,r:e-1}}function Ot(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Vi(n){var e=n.indexOf(":");return e==-1?{s:On(n),e:On(n)}:{s:On(n.slice(0,e)),e:On(n.slice(e+1))}}function vn(n,e){return typeof e>"u"||typeof e=="number"?vn(n.s,n.e):(typeof n!="string"&&(n=Ot(n)),typeof e!="string"&&(e=Ot(e)),n==e?n:n+":"+e)}function Gt(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,r=0,s=n.length;for(t=0;i<s&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)t=26*t+r;for(e.s.c=--t,t=0;i<s&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)t=10*t+r;if(e.s.r=--t,i===s||r!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=s&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)t=26*t+r;for(e.e.c=--t,t=0;i!=s&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)t=10*t+r;return e.e.r=--t,e}function Rx(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=rs(n.z,t?ki(e):e)}catch{}try{return n.w=rs((n.XF||{}).numFmtId||(t?14:0),t?ki(e):e)}catch{return""+e}}function ya(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?eu[n.v]||n.v:e==null?Rx(n,n.v):Rx(n,e))}function qs(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=n,{SheetNames:[t],Sheets:i}}function WS(n,e,t){var i=t||{},r=n?Array.isArray(n):i.dense,s=n||(r?[]:{}),l=0,u=0;if(s&&i.origin!=null){if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?On(i.origin):i.origin;l=f.r,u=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var p=Gt(s["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(m.e.r=l=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[v].length;++y)if(!(typeof e[v][y]>"u")){var S={v:e[v][y]},_=l+v,b=u+y;if(m.s.r>_&&(m.s.r=_),m.s.c>b&&(m.s.c=b),m.e.r<_&&(m.e.r=_),m.e.c<b&&(m.e.c=b),e[v][y]&&typeof e[v][y]=="object"&&!Array.isArray(e[v][y])&&!(e[v][y]instanceof Date))S=e[v][y];else if(Array.isArray(S.v)&&(S.f=e[v][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(i.nullError)S.t="e",S.v=0;else if(i.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=i.dateNF||on[14],i.cellDates?(S.t="d",S.w=rs(S.z,ki(S.v))):(S.t="n",S.v=ki(S.v),S.w=rs(S.z,S.v))):S.t="s";if(r)s[_]||(s[_]=[]),s[_][b]&&s[_][b].z&&(S.z=s[_][b].z),s[_][b]=S;else{var T=Ot({c:b,r:_});s[T]&&s[T].z&&(S.z=s[T].z),s[T]=S}}}return m.s.c<1e7&&(s["!ref"]=vn(m)),s}function sl(n,e){return WS(null,n,e)}function GC(n){return n.read_shift(4,"i")}function xr(n,e){return e||(e=ge(4)),e.write_shift(4,n),e}function ei(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function Rn(n,e){var t=!1;return e==null&&(t=!0,e=ge(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function YC(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function $C(n,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Qp(n,e){var t=n.l,i=n.read_shift(1),r=ei(n),s=[],l={t:r,h:r};if((i&1)!==0){for(var u=n.read_shift(4),f=0;f!=u;++f)s.push(YC(n));l.r=s}else l.r=[{ich:0,ifnt:0}];return n.l=t+e,l}function XC(n,e){var t=!1;return e==null&&(t=!0,e=ge(15+4*n.t.length)),e.write_shift(1,0),Rn(n.t,e),t?e.slice(0,e.l):e}var qC=Qp;function KC(n,e){var t=!1;return e==null&&(t=!0,e=ge(23+4*n.t.length)),e.write_shift(1,1),Rn(n.t,e),e.write_shift(4,1),$C({},e),t?e.slice(0,e.l):e}function sr(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Ks(n,e){return e==null&&(e=ge(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Zs(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Js(n,e){return e==null&&(e=ge(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var ZC=ei,VS=Rn;function eg(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function nf(n,e){var t=!1;return e==null&&(t=!0,e=ge(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var JC=ei,hp=eg,tg=nf;function GS(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,i=e[0]&2;n.l+=4;var r=i===0?tf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Bs(e,0)>>2;return t?r/100:r}function YS(n,e){e==null&&(e=ge(4));var t=0,i=0,r=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(i=1,t=1),i)e.write_shift(-4,((t?r:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function $S(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function QC(n,e){return e||(e=ge(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Qs=$S,ol=QC;function ll(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function $s(n,e){return(e||ge(8)).write_shift(8,n,"f")}function e6(n){var e={},t=n.read_shift(1),i=t>>>1,r=n.read_shift(1),s=n.read_shift(2,"i"),l=n.read_shift(1),u=n.read_shift(1),f=n.read_shift(1);switch(n.l++,i){case 0:e.auto=1;break;case 1:e.index=r;var m=c6[r];m&&(e.rgb=Vx(m));break;case 2:e.rgb=Vx([l,u,f]);break;case 3:e.theme=r;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function rf(n,e){if(e||(e=ge(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function t6(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function n6(n,e){e||(e=ge(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var XS=2,zi=3,jd=11,af=19,Dd=64,i6=65,r6=71,a6=4108,s6=4126,Un=80,Mx={1:{n:"CodePage",t:XS},2:{n:"Category",t:Un},3:{n:"PresentationFormat",t:Un},4:{n:"ByteCount",t:zi},5:{n:"LineCount",t:zi},6:{n:"ParagraphCount",t:zi},7:{n:"SlideCount",t:zi},8:{n:"NoteCount",t:zi},9:{n:"HiddenCount",t:zi},10:{n:"MultimediaClipCount",t:zi},11:{n:"ScaleCrop",t:jd},12:{n:"HeadingPairs",t:a6},13:{n:"TitlesOfParts",t:s6},14:{n:"Manager",t:Un},15:{n:"Company",t:Un},16:{n:"LinksUpToDate",t:jd},17:{n:"CharacterCount",t:zi},19:{n:"SharedDoc",t:jd},22:{n:"HyperlinksChanged",t:jd},23:{n:"AppVersion",t:zi,p:"version"},24:{n:"DigSig",t:i6},26:{n:"ContentType",t:Un},27:{n:"ContentStatus",t:Un},28:{n:"Language",t:Un},29:{n:"Version",t:Un},255:{},2147483648:{n:"Locale",t:af},2147483651:{n:"Behavior",t:af},1919054434:{}},Lx={1:{n:"CodePage",t:XS},2:{n:"Title",t:Un},3:{n:"Subject",t:Un},4:{n:"Author",t:Un},5:{n:"Keywords",t:Un},6:{n:"Comments",t:Un},7:{n:"Template",t:Un},8:{n:"LastAuthor",t:Un},9:{n:"RevNumber",t:Un},10:{n:"EditTime",t:Dd},11:{n:"LastPrinted",t:Dd},12:{n:"CreatedDate",t:Dd},13:{n:"ModifiedDate",t:Dd},14:{n:"PageCount",t:zi},15:{n:"WordCount",t:zi},16:{n:"CharCount",t:zi},17:{n:"Thumbnail",t:r6},18:{n:"Application",t:Un},19:{n:"DocSecurity",t:zi},255:{},2147483648:{n:"Locale",t:af},2147483651:{n:"Behavior",t:af},1919054434:{}};function o6(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var l6=o6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),c6=Ci(l6),eu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},u6={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function qS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function KS(n,e){var t=bC(u6),i=[],r;i[i.length]=yn,i[i.length]=Re("Types",null,{xmlns:Nn.CT,"xmlns:xsd":Nn.xsd,"xmlns:xsi":Nn.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Re("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){n[f]&&n[f].length>0&&(r=n[f][0],i[i.length]=Re("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:Nd[f][e.bookType]||Nd[f].xlsx}))},l=function(f){(n[f]||[]).forEach(function(m){i[i.length]=Re("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:Nd[f][e.bookType]||Nd[f].xlsx})})},u=function(f){(n[f]||[]).forEach(function(m){i[i.length]=Re("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ZS(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function qo(n){var e=[yn,Re("Relationships",null,{xmlns:Nn.RELS})];return Gn(n["!id"]).forEach(function(t){e[e.length]=Re("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function jt(n,e,t,i,r,s){if(r||(r={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,r.Id="rId"+e,r.Type=i,r.Target=t,[St.HLINK,St.XPATH,St.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),n["!id"][r.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][r.Id]=r,n[("/"+r.Target).replace("//","/")]=r,e}function d6(n){var e=[yn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Ix(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function f6(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function h6(n){var e=[yn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(Ix(n[t][0],n[t][1])),e.push(f6("",n[t][0]));return e.push(Ix("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function JS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+qd.version+"</meta:generator></office:meta></office:document-meta>"}var Ws=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function $m(n,e,t,i,r){r[n]!=null||e==null||e===""||(r[n]=e,e=Nt(e),i[i.length]=t?Re(n,e,t):Wn(n,e))}function QS(n,e){var t=e||{},i=[yn,Re("cp:coreProperties",null,{"xmlns:cp":Nn.CORE_PROPS,"xmlns:dc":Nn.dc,"xmlns:dcterms":Nn.dcterms,"xmlns:dcmitype":Nn.dcmitype,"xmlns:xsi":Nn.xsi})],r={};if(!n&&!t.Props)return i.join("");n&&(n.CreatedDate!=null&&$m("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:fp(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),n.ModifiedDate!=null&&$m("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:fp(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var s=0;s!=Ws.length;++s){var l=Ws[s],u=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:n?n[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&$m(l[0],u,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Ko=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],e2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function t2(n){var e=[],t=Re;return n||(n={}),n.Application="SheetJS",e[e.length]=yn,e[e.length]=Re("Properties",null,{xmlns:Nn.EXT_PROPS,"xmlns:vt":Nn.vt}),Ko.forEach(function(i){if(n[i[1]]!==void 0){var r;switch(i[2]){case"string":r=Nt(String(n[i[1]]));break;case"bool":r=n[i[1]]?"true":"false";break}r!==void 0&&(e[e.length]=t(i[0],r))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+Nt(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function n2(n){var e=[yn,Re("Properties",null,{xmlns:Nn.CUST_PROPS,"xmlns:vt":Nn.vt})];if(!n)return e.join("");var t=1;return Gn(n).forEach(function(r){++t,e[e.length]=Re("property",NC(n[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Nt(r)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Px={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function m6(n,e){var t=[];return Gn(Px).map(function(i){for(var r=0;r<Ws.length;++r)if(Ws[r][1]==i)return Ws[r];for(r=0;r<Ko.length;++r)if(Ko[r][1]==i)return Ko[r];throw i}).forEach(function(i){if(n[i[1]]!=null){var r=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:n[i[1]];switch(i[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),t.push(Wn(Px[i[1]]||i[1],r))}}),Re("DocumentProperties",t.join(""),{xmlns:Hi.o})}function p6(n,e){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return n&&Gn(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var l=0;l<Ws.length;++l)if(s==Ws[l][1])return;for(l=0;l<Ko.length;++l)if(s==Ko[l][1])return;for(l=0;l<t.length;++l)if(s==t[l])return;var u=n[s],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),r.push(Re(wx(s),u,{"dt:dt":f}))}}),e&&Gn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var l=e[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),r.push(Re(wx(s),l,{"dt:dt":u}))}}),"<"+i+' xmlns="'+Hi.o+'">'+r.join("")+"</"+i+">"}function g6(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,i=t%Math.pow(2,32),r=(t-i)/Math.pow(2,32);i*=1e7,r*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),r+=s);var l=ge(8);return l.write_shift(4,i),l.write_shift(4,r),l}function Bx(n,e){var t=ge(4),i=ge(4);switch(t.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,e);break;case 5:i=ge(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=g6(e);break;case 31:case 80:for(i=ge(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return Hn([t,i])}var i2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function v6(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function Fx(n,e,t){var i=ge(8),r=[],s=[],l=8,u=0,f=ge(8),m=ge(8);if(f.write_shift(4,2),f.write_shift(4,1200),m.write_shift(4,1),s.push(f),r.push(m),l+=8+f.length,!e){m=ge(8),m.write_shift(4,0),r.unshift(m);var p=[ge(4)];for(p[0].write_shift(4,n.length),u=0;u<n.length;++u){var v=n[u][0];for(f=ge(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);p.push(f)}f=Hn(p),s.unshift(f),l+=8+f.length}for(u=0;u<n.length;++u)if(!(e&&!e[n[u][0]])&&!(i2.indexOf(n[u][0])>-1||e2.indexOf(n[u][0])>-1)&&n[u][1]!=null){var y=n[u][1],S=0;if(e){S=+e[n[u][0]];var _=t[S];if(_.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}f=Bx(_.t,y)}else{var T=v6(y);T==-1&&(T=31,y=String(y)),f=Bx(T,y)}s.push(f),m=ge(8),m.write_shift(4,e?S:2+u),r.push(m),l+=8+f.length}var E=8*(s.length+1);for(u=0;u<s.length;++u)r[u].write_shift(4,E),E+=s[u].length;return i.write_shift(4,l),i.write_shift(4,s.length),Hn([i].concat(r).concat(s))}function zx(n,e,t,i,r,s){var l=ge(r?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Bt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,r?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,r?68:48);var f=Fx(n,t,i);if(u.push(f),r){var m=Fx(r,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),u.push(m)}return Hn(u)}function y6(n,e){e||(e=ge(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function x6(n,e){return n.read_shift(e)===1}function di(n,e){return e||(e=ge(2)),e.write_shift(2,+!!n),e}function r2(n){return n.read_shift(2,"u")}function rr(n,e){return e||(e=ge(2)),e.write_shift(2,n),e}function a2(n,e,t){return t||(t=ge(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function s2(n,e,t){var i=n.read_shift(t&&t.biff>=12?2:1),r="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=n.read_shift(1);s&&(r="dbcs-cont")}else t.biff==12&&(r="wstr");t.biff>=2&&t.biff<=5&&(r="cpstr");var l=i?n.read_shift(i,r):"";return l}function b6(n){var e=n.t||"",t=ge(3);t.write_shift(2,e.length),t.write_shift(1,1);var i=ge(2*e.length);i.write_shift(2*e.length,e,"utf16le");var r=[t,i];return Hn(r)}function S6(n,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var r=n.read_shift(1);return r===0?i=n.read_shift(e,"sbcs-cont"):i=n.read_shift(e,"dbcs-cont"),i}function _6(n,e,t){var i=n.read_shift(t&&t.biff==2?1:2);return i===0?(n.l++,""):S6(n,i,t)}function T6(n,e,t){if(t.biff>5)return _6(n,e,t);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function o2(n,e,t){return t||(t=ge(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function Ux(n,e){e||(e=ge(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function w6(n){var e=ge(512),t=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),s=r>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)e.write_shift(4,l[t]);if(s==28)i=i.slice(1),Ux(i,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));var u=r>-1?i.slice(0,r):i;for(e.write_shift(4,2*(u.length+1)),t=0;t<u.length;++t)e.write_shift(2,u.charCodeAt(t));e.write_shift(2,0),s&8&&Ux(r>-1?i.slice(r+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));for(var f=0;i.slice(f*3,f*3+3)=="../"||i.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,i.length-3*f+1),t=0;t<i.length-3*f;++t)e.write_shift(1,i.charCodeAt(t+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Xs(n,e,t,i){return i||(i=ge(6)),i.write_shift(2,n),i.write_shift(2,e),i.write_shift(2,t||0),i}function E6(n,e,t){var i=t.biff>8?4:2,r=n.read_shift(i),s=n.read_shift(i,"i"),l=n.read_shift(i,"i");return[r,s,l]}function A6(n){var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(2),r=n.read_shift(2);return{s:{c:i,r:e},e:{c:r,r:t}}}function l2(n,e){return e||(e=ge(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function ng(n,e,t){var i=1536,r=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ge(r);return s.write_shift(2,i),s.write_shift(2,e),r>4&&s.write_shift(2,29282),r>6&&s.write_shift(2,1997),r>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function k6(n,e){var t=!e||e.biff==8,i=ge(t?112:54);for(i.write_shift(e.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function C6(n,e){var t=!e||e.biff>=8?2:1,i=ge(8+t*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function j6(n,e){var t=ge(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var i=[],r=0;r<n.length;++r)i[r]=b6(n[r]);var s=Hn([t].concat(i));return s.parts=[t.length].concat(i.map(function(l){return l.length})),s}function D6(){var n=ge(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function N6(n){var e=ge(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function O6(n,e){var t=n.name||"Arial",i=e&&e.biff==5,r=i?15+t.length:16+2*t.length,s=ge(r);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),s}function R6(n,e,t,i){var r=ge(10);return Xs(n,e,i,r),r.write_shift(4,t),r}function M6(n,e,t,i,r){var s=!r||r.biff==8,l=ge(8+ +s+(1+s)*t.length);return Xs(n,e,i,l),l.write_shift(2,t.length),s&&l.write_shift(1,1),l.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),l}function L6(n,e,t,i){var r=t&&t.biff==5;i||(i=ge(r?3+e.length:5+2*e.length)),i.write_shift(2,n),i.write_shift(r?1:2,e.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}function I6(n,e){var t=e.biff==8||!e.biff?4:2,i=ge(2*t+6);return i.write_shift(t,n.s.r),i.write_shift(t,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function Hx(n,e,t,i){var r=t&&t.biff==5;i||(i=ge(r?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,e<<4));var s=0;return n.numFmtId>0&&r&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function P6(n){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function B6(n,e,t,i,r,s){var l=ge(8);return Xs(n,e,i,l),a2(t,s,l),l}function F6(n,e,t,i){var r=ge(14);return Xs(n,e,i,r),$s(t,r),r}function z6(n,e,t){if(t.biff<8)return U6(n,e,t);for(var i=[],r=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)i.push(E6(n,t.biff>8?12:6,t));if(n.l!=r)throw new Error("Bad ExternSheet: "+n.l+" != "+r);return i}function U6(n,e,t){n[n.l+1]==3&&n[n.l]++;var i=s2(n,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function H6(n){var e=ge(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)l2(n[t],e);return e}function W6(n){var e=ge(24),t=On(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)e.write_shift(1,parseInt(i[r],16));return Hn([e,w6(n[1])])}function V6(n){var e=n[1].Tooltip,t=ge(10+2*(e.length+1));t.write_shift(2,2048);var i=On(n[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function G6(n){return n||(n=ge(4)),n.write_shift(2,1),n.write_shift(2,1),n}function Y6(n,e,t){if(!t.cellStyles)return Ur(n,e);var i=t&&t.biff>=12?4:2,r=n.read_shift(i),s=n.read_shift(i),l=n.read_shift(i),u=n.read_shift(i),f=n.read_shift(2);i==2&&(n.l+=2);var m={s:r,e:s,w:l,ixfe:u,flags:f};return(t.biff>=5||!t.biff)&&(m.level=f>>8&7),m}function $6(n,e){var t=ge(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var i=0;return n.hidden&&(i|=1),t.write_shift(1,i),i=n.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function X6(n){for(var e=ge(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function q6(n,e,t){var i=ge(15);return nu(i,n,e),i.write_shift(8,t,"f"),i}function K6(n,e,t){var i=ge(9);return nu(i,n,e),i.write_shift(2,t),i}var Z6=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Gp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,f){var m=[],p=Ys(1);switch(f.type){case"base64":p=vr(va(u));break;case"binary":p=vr(u);break;case"buffer":case"array":p=u;break}Ui(p,0);var v=p.read_shift(1),y=!!(v&136),S=!1,_=!1;switch(v){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var b=0,T=521;v==2&&(b=p.read_shift(2)),p.l+=3,v!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),v!=2&&(T=p.read_shift(2));var E=p.read_shift(2),w=f.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(w=n[p[p.l]]),p.l+=1,p.l+=2),_&&(p.l+=36);for(var C=[],j={},k=Math.min(p.length,v==2?521:T-10-(S?264:0)),P=_?32:11;p.l<k&&p[p.l]!=13;)switch(j={},j.name=Kd.utils.decode(w,p.slice(p.l,p.l+P)).replace(/[\u0000\r\n].*$/g,""),p.l+=P,j.type=String.fromCharCode(p.read_shift(1)),v!=2&&!_&&(j.offset=p.read_shift(4)),j.len=p.read_shift(1),v==2&&(j.offset=p.read_shift(2)),j.dec=p.read_shift(1),j.name.length&&C.push(j),v!=2&&(p.l+=_?13:14),j.type){case"B":(!S||j.len!=8)&&f.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(p[p.l]!==13&&(p.l=T-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=T;var D=0,z=0;for(m[0]=[],z=0;z!=C.length;++z)m[0][z]=C[z].name;for(;b-- >0;){if(p[p.l]===42){p.l+=E;continue}for(++p.l,m[++D]=[],z=0,z=0;z!=C.length;++z){var R=p.slice(p.l,p.l+C[z].len);p.l+=C[z].len,Ui(R,0);var W=Kd.utils.decode(w,R);switch(C[z].type){case"C":W.trim().length&&(m[D][z]=W.replace(/\s+$/,""));break;case"D":W.length===8?m[D][z]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):m[D][z]=W;break;case"F":m[D][z]=parseFloat(W.trim());break;case"+":case"I":m[D][z]=_?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":m[D][z]=!0;break;case"N":case"F":m[D][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[D][z]="##MEMO##"+(_?parseInt(W.trim(),10):R.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(m[D][z]=+W||0);break;case"@":m[D][z]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":m[D][z]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":m[D][z]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[D][z]=-R.read_shift(-8,"f");break;case"B":if(S&&C[z].len==8){m[D][z]=R.read_shift(8,"f");break}case"G":case"P":R.l+=C[z].len;break;case"0":if(C[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[z].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(m=m.slice(0,f.sheetRows)),f.DBF=C,m}function i(u,f){var m=f||{};m.dateNF||(m.dateNF="yyyymmdd");var p=sl(t(u,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function r(u,f){try{return qs(i(u,f),f)}catch(m){if(f&&f.WTF)throw m}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var m=f||{};if(+m.codepage>=0&&Fc(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ei(),v=uf(u,{header:1,raw:!0,cellDates:!0}),y=v[0],S=v.slice(1),_=u["!cols"]||[],b=0,T=0,E=0,w=1;for(b=0;b<y.length;++b){if(((_[b]||{}).DBF||{}).name){y[b]=_[b].DBF.name,++E;continue}if(y[b]!=null){if(++E,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(T=0;T<1024;++T)if(y.indexOf(y[b]+"_"+T)==-1){y[b]+="_"+T;break}}}}var C=Gt(u["!ref"]),j=[],k=[],P=[];for(b=0;b<=C.e.c-C.s.c;++b){var D="",z="",R=0,W=[];for(T=0;T<S.length;++T)S[T][b]!=null&&W.push(S[T][b]);if(W.length==0||y[b]==null){j[b]="?";continue}for(T=0;T<W.length;++T){switch(typeof W[T]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=W[T]instanceof Date?"D":"C";break;default:z="C"}R=Math.max(R,String(W[T]).length),D=D&&D!=z?"C":z}R>250&&(R=250),z=((_[b]||{}).DBF||{}).type,z=="C"&&_[b].DBF.len>R&&(R=_[b].DBF.len),D=="B"&&z=="N"&&(D="N",P[b]=_[b].DBF.dec,R=_[b].DBF.len),k[b]=D=="C"||z=="N"?R:s[D]||0,w+=k[b],j[b]=D}var q=p.next(32);for(q.write_shift(4,318902576),q.write_shift(4,S.length),q.write_shift(2,296+32*E),q.write_shift(2,w),b=0;b<4;++b)q.write_shift(4,0);for(q.write_shift(4,0|(+e[uS]||3)<<8),b=0,T=0;b<y.length;++b)if(y[b]!=null){var J=p.next(32),me=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);J.write_shift(1,me,"sbcs"),J.write_shift(1,j[b]=="?"?"C":j[b],"sbcs"),J.write_shift(4,T),J.write_shift(1,k[b]||s[j[b]]||0),J.write_shift(1,P[b]||0),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(4,0),T+=k[b]||s[j[b]]||0}var Ce=p.next(264);for(Ce.write_shift(4,13),b=0;b<65;++b)Ce.write_shift(4,0);for(b=0;b<S.length;++b){var ve=p.next(w);for(ve.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(j[T]){case"L":ve.write_shift(1,S[b][T]==null?63:S[b][T]?84:70);break;case"B":ve.write_shift(8,S[b][T]||0,"f");break;case"N":var ne="0";for(typeof S[b][T]=="number"&&(ne=S[b][T].toFixed(P[T]||0)),E=0;E<k[T]-ne.length;++E)ve.write_shift(1,32);ve.write_shift(1,ne,"sbcs");break;case"D":S[b][T]?(ve.write_shift(4,("0000"+S[b][T].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(S[b][T].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+S[b][T].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(S[b][T]!=null?S[b][T]:"").slice(0,k[T]);for(ve.write_shift(1,Z,"sbcs"),E=0;E<k[T]-Z.length;++E)ve.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:r,to_sheet:i,from_sheet:l}}(),J6=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Gn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,S){var _=n[S];return typeof _=="number"?fx(_):_},i=function(y,S,_){var b=S.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return b==59?y:fx(b)};n["|"]=254;function r(y,S){switch(S.type){case"base64":return s(va(y),S);case"binary":return s(y,S);case"buffer":return s(Tt&&Buffer.isBuffer(y)?y.toString("binary"):Zc(y),S);case"array":return s(Tf(y),S)}throw new Error("Unrecognized type "+S.type)}function s(y,S){var _=y.split(/[\n\r]+/),b=-1,T=-1,E=0,w=0,C=[],j=[],k=null,P={},D=[],z=[],R=[],W=0,q;for(+S.codepage>=0&&Fc(+S.codepage);E!==_.length;++E){W=0;var J=_[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),me=J.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),Ce=me[0],ve;if(J.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&j.push(J.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,Z=!1,be=!1,Ne=!1,V=-1,he=-1;for(w=1;w<me.length;++w)switch(me[w].charAt(0)){case"A":break;case"X":T=parseInt(me[w].slice(1))-1,Z=!0;break;case"Y":for(b=parseInt(me[w].slice(1))-1,Z||(T=0),q=C.length;q<=b;++q)C[q]=[];break;case"K":ve=me[w].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(ma(ve))?isNaN(Uc(ve).getDate())||(ve=fi(ve)):(ve=ma(ve),k!==null&&_S(k)&&(ve=AS(ve))),ne=!0;break;case"E":Ne=!0;var I=Kj(me[w].slice(1),{r:b,c:T});C[b][T]=[C[b][T],I];break;case"S":be=!0,C[b][T]=[C[b][T],"S5S"];break;case"G":break;case"R":V=parseInt(me[w].slice(1))-1;break;case"C":he=parseInt(me[w].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+J)}if(ne&&(C[b][T]&&C[b][T].length==2?C[b][T][0]=ve:C[b][T]=ve,k=null),be){if(Ne)throw new Error("SYLK shared formula cannot have own formula");var Y=V>-1&&C[V][he];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");C[b][T][1]=Zj(Y[1],{r:b-V,c:T-he})}break;case"F":var G=0;for(w=1;w<me.length;++w)switch(me[w].charAt(0)){case"X":T=parseInt(me[w].slice(1))-1,++G;break;case"Y":for(b=parseInt(me[w].slice(1))-1,q=C.length;q<=b;++q)C[q]=[];break;case"M":W=parseInt(me[w].slice(1))/20;break;case"F":break;case"G":break;case"P":k=j[parseInt(me[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=me[w].slice(1).split(" "),q=parseInt(R[0],10);q<=parseInt(R[1],10);++q)W=parseInt(R[2],10),z[q-1]=W===0?{hidden:!0}:{wch:W},ig(z[q-1]);break;case"C":T=parseInt(me[w].slice(1))-1,z[T]||(z[T]={});break;case"R":b=parseInt(me[w].slice(1))-1,D[b]||(D[b]={}),W>0?(D[b].hpt=W,D[b].hpx=h2(W)):W===0&&(D[b].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+J)}G<1&&(k=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+J)}}return D.length>0&&(P["!rows"]=D),z.length>0&&(P["!cols"]=z),S&&S.sheetRows&&(C=C.slice(0,S.sheetRows)),[C,P]}function l(y,S){var _=r(y,S),b=_[0],T=_[1],E=sl(b,S);return Gn(T).forEach(function(w){E[w]=T[w]}),E}function u(y,S){return qs(l(y,S),S)}function f(y,S,_,b){var T="C;Y"+(_+1)+";X"+(b+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+ag(y.f,{r:_,c:b}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function m(y,S){S.forEach(function(_,b){var T="F;W"+(b+1)+" "+(b+1)+" ";_.hidden?T+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=sf(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=of(_.wpx)),typeof _.wch=="number"&&(T+=Math.round(_.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function p(y,S){S.forEach(function(_,b){var T="F;";_.hidden?T+="M0;":_.hpt?T+="M"+20*_.hpt+";":_.hpx&&(T+="M"+20*lf(_.hpx)+";"),T.length>2&&y.push(T+"R"+(b+1))})}function v(y,S){var _=["ID;PWXL;N;E"],b=[],T=Gt(y["!ref"]),E,w=Array.isArray(y),C=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),y["!cols"]&&m(_,y["!cols"]),y["!rows"]&&p(_,y["!rows"]),_.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var j=T.s.r;j<=T.e.r;++j)for(var k=T.s.c;k<=T.e.c;++k){var P=Ot({r:j,c:k});E=w?(y[j]||[])[k]:y[P],!(!E||E.v==null&&(!E.f||E.F))&&b.push(f(E,y,j,k))}return _.join(C)+C+b.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:l,from_sheet:v}}(),Q6=function(){function n(s,l){switch(l.type){case"base64":return e(va(s),l);case"binary":return e(s,l);case"buffer":return e(Tt&&Buffer.isBuffer(s)?s.toString("binary"):Zc(s),l);case"array":return e(Tf(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var u=s.split(`
`),f=-1,m=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++f]=[],m=0;continue}if(!(f<0)){var y=u[p].trim().split(","),S=y[0],_=y[1];++p;for(var b=u[p]||"";(b.match(/["]/g)||[]).length&1&&p<u.length-1;)b+=`
`+u[++p];switch(b=b.trim(),+S){case-1:if(b==="BOT"){v[++f]=[],m=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?v[f][m]=!0:b==="FALSE"?v[f][m]=!1:isNaN(ma(_))?isNaN(Uc(_).getDate())?v[f][m]=_:v[f][m]=fi(_):v[f][m]=ma(_),++m;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),v[f][m++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function t(s,l){return sl(n(s,l),l)}function i(s,l){return qs(t(s,l),l)}var r=function(){var s=function(f,m,p,v,y){f.push(m),f.push(p+","+v),f.push('"'+y.replace(/"/g,'""')+'"')},l=function(f,m,p,v){f.push(m+","+p),f.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var m=[],p=Gt(f["!ref"]),v,y=Array.isArray(f);s(m,"TABLE",0,1,"sheetjs"),s(m,"VECTORS",0,p.e.r-p.s.r+1,""),s(m,"TUPLES",0,p.e.c-p.s.c+1,""),s(m,"DATA",0,0,"");for(var S=p.s.r;S<=p.e.r;++S){l(m,-1,0,"BOT");for(var _=p.s.c;_<=p.e.c;++_){var b=Ot({r:S,c:_});if(v=y?(f[S]||[])[_]:f[b],!v){l(m,1,0,"");continue}switch(v.t){case"n":var T=v.w;!T&&v.v!=null&&(T=v.v),T==null?v.f&&!v.F?l(m,1,0,"="+v.f):l(m,1,0,""):l(m,0,T,"V");break;case"b":l(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=rs(v.z||on[14],ki(fi(v.v)))),l(m,0,v.w,"V");break;default:l(m,1,0,"")}}}l(m,-1,0,"EOD");var E=`\r
`,w=m.join(E);return w}}();return{to_workbook:i,to_sheet:t,from_sheet:r}}(),c2=function(){function n(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,y){for(var S=v.split(`
`),_=-1,b=-1,T=0,E=[];T!==S.length;++T){var w=S[T].trim().split(":");if(w[0]==="cell"){var C=On(w[1]);if(E.length<=C.r)for(_=E.length;_<=C.r;++_)E[_]||(E[_]=[]);switch(_=C.r,b=C.c,w[2]){case"t":E[_][b]=n(w[3]);break;case"v":E[_][b]=+w[3];break;case"vtf":var j=w[w.length-1];case"vtc":switch(w[3]){case"nl":E[_][b]=!!+w[4];break;default:E[_][b]=+w[4];break}w[2]=="vtf"&&(E[_][b]=[E[_][b],j])}}}return y&&y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}function i(v,y){return sl(t(v,y),y)}function r(v,y){return qs(i(v,y),y)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var y=[],S=[],_,b="",T=Vi(v["!ref"]),E=Array.isArray(v),w=T.s.r;w<=T.e.r;++w)for(var C=T.s.c;C<=T.e.c;++C)if(b=Ot({r:w,c:C}),_=E?(v[w]||[])[C]:v[b],!(!_||_.v==null||_.t==="z")){switch(S=["cell",b,"t"],_.t){case"s":case"str":S.push(e(_.v));break;case"n":_.f?(S[2]="vtf",S[3]="n",S[4]=_.v,S[5]=e(_.f)):(S[2]="v",S[3]=_.v);break;case"b":S[2]="vt"+(_.f?"f":"c"),S[3]="nl",S[4]=_.v?"1":"0",S[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var j=ki(fi(_.v));S[2]="vtc",S[3]="nd",S[4]=""+j,S[5]=_.w||rs(_.z||on[14],j);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(v){return[s,l,u,l,m(v),f].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:p}}(),ej=function(){function n(p,v,y,S,_){_.raw?v[y][S]=p:p===""||(p==="TRUE"?v[y][S]=!0:p==="FALSE"?v[y][S]=!1:isNaN(ma(p))?isNaN(Uc(p).getDate())?v[y][S]=p:v[y][S]=fi(p):v[y][S]=ma(p))}function e(p,v){var y=v||{},S=[];if(!p||p.length===0)return S;for(var _=p.split(/[\r\n]/),b=_.length-1;b>=0&&_[b].length===0;)--b;for(var T=10,E=0,w=0;w<=b;++w)E=_[w].indexOf(" "),E==-1?E=_[w].length:E++,T=Math.max(T,E);for(w=0;w<=b;++w){S[w]=[];var C=0;for(n(_[w].slice(0,T).trim(),S,w,C,y),C=1;C<=(_[w].length-T)/10+1;++C)n(_[w].slice(T+(C-1)*10,T+C*10).trim(),S,w,C,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(p){for(var v={},y=!1,S=0,_=0;S<p.length;++S)(_=p.charCodeAt(S))==34?y=!y:!y&&_ in t&&(v[_]=(v[_]||0)+1);_=[];for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&_.push([v[S],S]);if(!_.length){v=i;for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&_.push([v[S],S])}return _.sort(function(b,T){return b[0]-T[0]||i[b[1]]-i[T[1]]}),t[_.pop()[1]]||44}function s(p,v){var y=v||{},S="",_=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(S=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(S=p.charAt(4),p=p.slice(6)):S=r(p.slice(0,1024)):y&&y.FS?S=y.FS:S=r(p.slice(0,1024));var T=0,E=0,w=0,C=0,j=0,k=S.charCodeAt(0),P=!1,D=0,z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var R=y.dateNF!=null?gC(y.dateNF):null;function W(){var q=p.slice(C,j),J={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)J.t="z";else if(y.raw)J.t="s",J.v=q;else if(q.trim().length===0)J.t="s",J.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(J.t="s",J.v=q.slice(2,-1).replace(/""/g,'"')):Jj(q)?(J.t="n",J.f=q.slice(1)):(J.t="s",J.v=q);else if(q=="TRUE")J.t="b",J.v=!0;else if(q=="FALSE")J.t="b",J.v=!1;else if(!isNaN(w=ma(q)))J.t="n",y.cellText!==!1&&(J.w=q),J.v=w;else if(!isNaN(Uc(q).getDate())||R&&q.match(R)){J.z=y.dateNF||on[14];var me=0;R&&q.match(R)&&(q=vC(q,y.dateNF,q.match(R)||[]),me=1),y.cellDates?(J.t="d",J.v=fi(q,me)):(J.t="n",J.v=ki(fi(q,me))),y.cellText!==!1&&(J.w=rs(J.z,J.v instanceof Date?ki(J.v):J.v)),y.cellNF||delete J.z}else J.t="s",J.v=q;if(J.t=="z"||(y.dense?(_[T]||(_[T]=[]),_[T][E]=J):_[Ot({c:E,r:T})]=J),C=j+1,z=p.charCodeAt(C),b.e.c<E&&(b.e.c=E),b.e.r<T&&(b.e.r=T),D==k)++E;else if(E=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;j<p.length;++j)switch(D=p.charCodeAt(j)){case 34:z===34&&(P=!P);break;case k:case 10:case 13:if(!P&&W())break e;break}return j-C>0&&W(),_["!ref"]=vn(b),_}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?s(p,v):sl(e(p,v),v)}function u(p,v){var y="",S=v.type=="string"?[0,0,0,0]:fM(p,v);switch(v.type){case"base64":y=va(p);break;case"binary":y=p;break;case"buffer":v.codepage==65001?y=p.toString("utf8"):v.codepage&&typeof Kd<"u"||(y=Tt&&Buffer.isBuffer(p)?p.toString("binary"):Zc(p));break;case"array":y=Tf(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+v.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=Ac(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=Ac(y):v.type=="binary"&&typeof Kd<"u",y.slice(0,19)=="socialcalc:version:"?c2.to_sheet(v.type=="string"?y:Ac(y),v):l(y,v)}function f(p,v){return qs(u(p,v),v)}function m(p){for(var v=[],y=Gt(p["!ref"]),S,_=Array.isArray(p),b=y.s.r;b<=y.e.r;++b){for(var T=[],E=y.s.c;E<=y.e.c;++E){var w=Ot({r:b,c:E});if(S=_?(p[b]||[])[E]:p[w],!S||S.v==null){T.push("          ");continue}for(var C=(S.w||(ya(S),S.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(E===0?" ":""))}v.push(T.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:m}}(),Wx=function(){function n(I,Y,G){if(I){Ui(I,I.l||0);for(var K=G.Enum||V;I.l<I.length;){var se=I.read_shift(2),Le=K[se]||K[65535],Oe=I.read_shift(2),we=I.l+Oe,ke=Le.f&&Le.f(I,Oe,G);if(I.l=we,Y(ke,Le,se))return}}}function e(I,Y){switch(Y.type){case"base64":return t(vr(va(I)),Y);case"binary":return t(vr(I),Y);case"buffer":case"array":return t(I,Y)}throw"Unsupported type "+Y.type}function t(I,Y){if(!I)return I;var G=Y||{},K=G.dense?[]:{},se="Sheet1",Le="",Oe=0,we={},ke=[],dt=[],et={s:{r:0,c:0},e:{r:0,c:0}},Yt=G.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)G.Enum=V,n(I,function(Pe,An,Mn){switch(Mn){case 0:G.vers=Pe,Pe>=4096&&(G.qpro=!0);break;case 6:et=Pe;break;case 204:Pe&&(Le=Pe);break;case 222:Le=Pe;break;case 15:case 51:G.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:Mn==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=G.dateNF||on[14],G.cellDates&&(Pe[1].t="d",Pe[1].v=AS(Pe[1].v))),G.qpro&&Pe[3]>Oe&&(K["!ref"]=vn(et),we[se]=K,ke.push(se),K=G.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Oe=Pe[3],se=Le||"Sheet"+(Oe+1),Le="");var ni=G.dense?(K[Pe[0].r]||[])[Pe[0].c]:K[Ot(Pe[0])];if(ni){ni.t=Pe[1].t,ni.v=Pe[1].v,Pe[1].z!=null&&(ni.z=Pe[1].z),Pe[1].f!=null&&(ni.f=Pe[1].f);break}G.dense?(K[Pe[0].r]||(K[Pe[0].r]=[]),K[Pe[0].r][Pe[0].c]=Pe[1]):K[Ot(Pe[0])]=Pe[1];break}},G);else if(I[2]==26||I[2]==14)G.Enum=he,I[2]==14&&(G.qpro=!0,I.l=0),n(I,function(Pe,An,Mn){switch(Mn){case 204:se=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>Oe&&(K["!ref"]=vn(et),we[se]=K,ke.push(se),K=G.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Oe=Pe[3],se="Sheet"+(Oe+1)),Yt>0&&Pe[0].r>=Yt)break;G.dense?(K[Pe[0].r]||(K[Pe[0].r]=[]),K[Pe[0].r][Pe[0].c]=Pe[1]):K[Ot(Pe[0])]=Pe[1],et.e.c<Pe[0].c&&(et.e.c=Pe[0].c),et.e.r<Pe[0].r&&(et.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(dt[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:dt[Pe[0]]=Pe[1],Pe[0]==Oe&&(se=Pe[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(K["!ref"]=vn(et),we[Le||se]=K,ke.push(Le||se),!dt.length)return{SheetNames:ke,Sheets:we};for(var at={},Yn=[],vt=0;vt<dt.length;++vt)we[ke[vt]]?(Yn.push(dt[vt]||ke[vt]),at[dt[vt]]=we[dt[vt]]||we[ke[vt]]):(Yn.push(dt[vt]),at[dt[vt]]={"!ref":"A1"});return{SheetNames:Yn,Sheets:at}}function i(I,Y){var G=Y||{};if(+G.codepage>=0&&Fc(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Ei(),se=Gt(I["!ref"]),Le=Array.isArray(I),Oe=[];Me(K,0,s(1030)),Me(K,6,f(se));for(var we=Math.min(se.e.r,8191),ke=se.s.r;ke<=we;++ke)for(var dt=Vn(ke),et=se.s.c;et<=se.e.c;++et){ke===se.s.r&&(Oe[et]=Qn(et));var Yt=Oe[et]+dt,at=Le?(I[ke]||[])[et]:I[Yt];if(!(!at||at.t=="z"))if(at.t=="n")(at.v|0)==at.v&&at.v>=-32768&&at.v<=32767?Me(K,13,S(ke,et,at.v)):Me(K,14,b(ke,et,at.v));else{var Yn=ya(at);Me(K,15,v(ke,et,Yn.slice(0,239)))}}return Me(K,1),K.end()}function r(I,Y){var G=Y||{};if(+G.codepage>=0&&Fc(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Ei();Me(K,0,l(I));for(var se=0,Le=0;se<I.SheetNames.length;++se)(I.Sheets[I.SheetNames[se]]||{})["!ref"]&&Me(K,27,Ne(I.SheetNames[se],Le++));var Oe=0;for(se=0;se<I.SheetNames.length;++se){var we=I.Sheets[I.SheetNames[se]];if(!(!we||!we["!ref"])){for(var ke=Gt(we["!ref"]),dt=Array.isArray(we),et=[],Yt=Math.min(ke.e.r,8191),at=ke.s.r;at<=Yt;++at)for(var Yn=Vn(at),vt=ke.s.c;vt<=ke.e.c;++vt){at===ke.s.r&&(et[vt]=Qn(vt));var Pe=et[vt]+Yn,An=dt?(we[at]||[])[vt]:we[Pe];if(!(!An||An.t=="z"))if(An.t=="n")Me(K,23,W(at,vt,Oe,An.v));else{var Mn=ya(An);Me(K,22,D(at,vt,Oe,Mn.slice(0,239)))}}++Oe}}return Me(K,1),K.end()}function s(I){var Y=ge(2);return Y.write_shift(2,I),Y}function l(I){var Y=ge(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var G=0,K=0,se=0,Le=0;Le<I.SheetNames.length;++Le){var Oe=I.SheetNames[Le],we=I.Sheets[Oe];if(!(!we||!we["!ref"])){++se;var ke=Vi(we["!ref"]);G<ke.e.r&&(G=ke.e.r),K<ke.e.c&&(K=ke.e.c)}}return G>8191&&(G=8191),Y.write_shift(2,G),Y.write_shift(1,se),Y.write_shift(1,K),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function u(I,Y,G){var K={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&G.qpro?(K.s.c=I.read_shift(1),I.l++,K.s.r=I.read_shift(2),K.e.c=I.read_shift(1),I.l++,K.e.r=I.read_shift(2),K):(K.s.c=I.read_shift(2),K.s.r=I.read_shift(2),Y==12&&G.qpro&&(I.l+=2),K.e.c=I.read_shift(2),K.e.r=I.read_shift(2),Y==12&&G.qpro&&(I.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function f(I){var Y=ge(8);return Y.write_shift(2,I.s.c),Y.write_shift(2,I.s.r),Y.write_shift(2,I.e.c),Y.write_shift(2,I.e.r),Y}function m(I,Y,G){var K=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(K[0].c=I.read_shift(1),K[3]=I.read_shift(1),K[0].r=I.read_shift(2),I.l+=2):(K[2]=I.read_shift(1),K[0].c=I.read_shift(2),K[0].r=I.read_shift(2)),K}function p(I,Y,G){var K=I.l+Y,se=m(I,Y,G);if(se[1].t="s",G.vers==20768){I.l++;var Le=I.read_shift(1);return se[1].v=I.read_shift(Le,"utf8"),se}return G.qpro&&I.l++,se[1].v=I.read_shift(K-I.l,"cstr"),se}function v(I,Y,G){var K=ge(7+G.length);K.write_shift(1,255),K.write_shift(2,Y),K.write_shift(2,I),K.write_shift(1,39);for(var se=0;se<K.length;++se){var Le=G.charCodeAt(se);K.write_shift(1,Le>=128?95:Le)}return K.write_shift(1,0),K}function y(I,Y,G){var K=m(I,Y,G);return K[1].v=I.read_shift(2,"i"),K}function S(I,Y,G){var K=ge(7);return K.write_shift(1,255),K.write_shift(2,Y),K.write_shift(2,I),K.write_shift(2,G,"i"),K}function _(I,Y,G){var K=m(I,Y,G);return K[1].v=I.read_shift(8,"f"),K}function b(I,Y,G){var K=ge(13);return K.write_shift(1,255),K.write_shift(2,Y),K.write_shift(2,I),K.write_shift(8,G,"f"),K}function T(I,Y,G){var K=I.l+Y,se=m(I,Y,G);if(se[1].v=I.read_shift(8,"f"),G.qpro)I.l=K;else{var Le=I.read_shift(2);j(I.slice(I.l,I.l+Le),se),I.l+=Le}return se}function E(I,Y,G){var K=Y&32768;return Y&=-32769,Y=(K?I:0)+(Y>=8192?Y-16384:Y),(K?"":"$")+(G?Qn(Y):Vn(Y))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(I,Y){Ui(I,0);for(var G=[],K=0,se="",Le="",Oe="",we="";I.l<I.length;){var ke=I[I.l++];switch(ke){case 0:G.push(I.read_shift(8,"f"));break;case 1:Le=E(Y[0].c,I.read_shift(2),!0),se=E(Y[0].r,I.read_shift(2),!1),G.push(Le+se);break;case 2:{var dt=E(Y[0].c,I.read_shift(2),!0),et=E(Y[0].r,I.read_shift(2),!1);Le=E(Y[0].c,I.read_shift(2),!0),se=E(Y[0].r,I.read_shift(2),!1),G.push(dt+et+":"+Le+se)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(I.read_shift(2));break;case 6:{for(var Yt="";ke=I[I.l++];)Yt+=String.fromCharCode(ke);G.push('"'+Yt.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:we=G.pop(),Oe=G.pop(),G.push(["AND","OR"][ke-20]+"("+Oe+","+we+")");break;default:if(ke<32&&C[ke])we=G.pop(),Oe=G.pop(),G.push(Oe+C[ke]+we);else if(w[ke]){if(K=w[ke][1],K==69&&(K=I[I.l++]),K>G.length){console.error("WK1 bad formula parse 0x"+ke.toString(16)+":|"+G.join("|")+"|");return}var at=G.slice(-K);G.length-=K,G.push(w[ke][0]+"("+at.join(",")+")")}else return ke<=7?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=24?console.error("WK1 unsupported op "+ke.toString(16)):ke<=30?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=115?console.error("WK1 unsupported function opcode "+ke.toString(16)):console.error("WK1 unrecognized opcode "+ke.toString(16))}}G.length==1?Y[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function k(I){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=I.read_shift(2),Y[3]=I[I.l++],Y[0].c=I[I.l++],Y}function P(I,Y){var G=k(I);return G[1].t="s",G[1].v=I.read_shift(Y-4,"cstr"),G}function D(I,Y,G,K){var se=ge(6+K.length);se.write_shift(2,I),se.write_shift(1,G),se.write_shift(1,Y),se.write_shift(1,39);for(var Le=0;Le<K.length;++Le){var Oe=K.charCodeAt(Le);se.write_shift(1,Oe>=128?95:Oe)}return se.write_shift(1,0),se}function z(I,Y){var G=k(I);G[1].v=I.read_shift(2);var K=G[1].v>>1;if(G[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return G[1].v=K,G}function R(I,Y){var G=k(I),K=I.read_shift(4),se=I.read_shift(4),Le=I.read_shift(2);if(Le==65535)return K===0&&se===3221225472?(G[1].t="e",G[1].v=15):K===0&&se===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Oe=Le&32768;return Le=(Le&32767)-16446,G[1].v=(1-Oe*2)*(se*Math.pow(2,Le+32)+K*Math.pow(2,Le)),G}function W(I,Y,G,K){var se=ge(14);if(se.write_shift(2,I),se.write_shift(1,G),se.write_shift(1,Y),K==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var Le=0,Oe=0,we=0,ke=0;return K<0&&(Le=1,K=-K),Oe=Math.log2(K)|0,K/=Math.pow(2,Oe-31),ke=K>>>0,(ke&2147483648)==0&&(K/=2,++Oe,ke=K>>>0),K-=ke,ke|=2147483648,ke>>>=0,K*=Math.pow(2,32),we=K>>>0,se.write_shift(4,we),se.write_shift(4,ke),Oe+=16383+(Le?32768:0),se.write_shift(2,Oe),se}function q(I,Y){var G=R(I);return I.l+=Y-14,G}function J(I,Y){var G=k(I),K=I.read_shift(4);return G[1].v=K>>6,G}function me(I,Y){var G=k(I),K=I.read_shift(8,"f");return G[1].v=K,G}function Ce(I,Y){var G=me(I);return I.l+=Y-10,G}function ve(I,Y){return I[I.l+Y-1]==0?I.read_shift(Y,"cstr"):""}function ne(I,Y){var G=I[I.l++];G>Y-1&&(G=Y-1);for(var K="";K.length<G;)K+=String.fromCharCode(I[I.l++]);return K}function Z(I,Y,G){if(!(!G.qpro||Y<21)){var K=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var se=I.read_shift(Y-21,"cstr");return[K,se]}}function be(I,Y){for(var G={},K=I.l+Y;I.l<K;){var se=I.read_shift(2);if(se==14e3){for(G[se]=[0,""],G[se][0]=I.read_shift(2);I[I.l];)G[se][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return G}function Ne(I,Y){var G=ge(5+I.length);G.write_shift(2,14e3),G.write_shift(2,Y);for(var K=0;K<I.length;++K){var se=I.charCodeAt(K);G[G.l++]=se>127?95:se}return G[G.l++]=0,G}var V={0:{n:"BOF",f:r2},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:be},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:J},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:r,to_workbook:e}}(),tj=/^\s|\s$|[\t\n\r]/;function u2(n,e){if(!e.bookSST)return"";var t=[yn];t[t.length]=Re("sst",null,{xmlns:al[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var r=n[i],s="<si>";r.r?s+=r.r:(s+="<t",r.t||(r.t=""),r.t.match(tj)&&(s+=' xml:space="preserve"'),s+=">"+Nt(r.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function nj(n){return[n.read_shift(4),n.read_shift(4)]}function ij(n,e){return e||(e=ge(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var rj=XC;function aj(n){var e=Ei();_e(e,159,ij(n));for(var t=0;t<n.length;++t)_e(e,19,rj(n[t]));return _e(e,160),e.end()}function sj(n){for(var e=[],t=n.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function d2(n){var e=0,t,i=sj(n),r=i.length+1,s,l,u,f,m;for(t=Ys(r),t[0]=i.length,s=1;s!=r;++s)t[s]=i[s-1];for(s=r-1;s>=0;--s)l=t[s],u=(e&16384)===0?0:1,f=e<<1&32767,m=u|f,e=m^l;return e^52811}var oj=function(){function n(r,s){switch(s.type){case"base64":return e(va(r),s);case"binary":return e(r,s);case"buffer":return e(Tt&&Buffer.isBuffer(r)?r.toString("binary"):Zc(r),s);case"array":return e(Tf(r),s)}throw new Error("Unrecognized type "+s.type)}function e(r,s){var l=s||{},u=l.dense?[]:{},f=r.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var y=/\\\w+\b/g,S=0,_,b=-1;_=y.exec(p);){switch(_[0]){case"\\cell":var T=p.slice(S,y.lastIndex-_[0].length);if(T[0]==" "&&(T=T.slice(1)),++b,T.length){var E={v:T,t:"s"};Array.isArray(u)?u[v][b]=E:u[Ot({r:v,c:b})]=E}break}S=y.lastIndex}b>m.e.c&&(m.e.c=b)}),u["!ref"]=vn(m),u}function t(r,s){return qs(n(r,s),s)}function i(r){for(var s=["{\\rtf1\\ansi"],l=Gt(r["!ref"]),u,f=Array.isArray(r),m=l.s.r;m<=l.e.r;++m){s.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)s.push("\\cellx"+(p+1));for(s.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=Ot({r:m,c:p});u=f?(r[m]||[])[p]:r[v],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(ya(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:i}}();function Vx(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var lj=6,pa=lj;function sf(n){return Math.floor((n+Math.round(128/pa)/256)*pa)}function of(n){return Math.floor((n-5)/pa*100+.5)/100}function mp(n){return Math.round((n*pa+5)/pa*256)/256}function ig(n){n.width?(n.wpx=sf(n.width),n.wch=of(n.wpx),n.MDW=pa):n.wpx?(n.wch=of(n.wpx),n.width=mp(n.wch),n.MDW=pa):typeof n.wch=="number"&&(n.width=mp(n.wch),n.wpx=sf(n.width),n.MDW=pa),n.customWidth&&delete n.customWidth}var cj=96,f2=cj;function lf(n){return n*96/f2}function h2(n){return n*f2/96}function uj(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)n[i]!=null&&(e[e.length]=Re("numFmt",null,{numFmtId:i,formatCode:Nt(n[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Re("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function dj(n){var e=[];return e[e.length]=Re("cellXfs",null),n.forEach(function(t){e[e.length]=Re("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Re("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function m2(n,e){var t=[yn,Re("styleSheet",null,{xmlns:al[0],"xmlns:vt":Nn.vt})],i;return n.SSF&&(i=uj(n.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=dj(e.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function fj(n,e){var t=n.read_shift(2),i=ei(n);return[t,i]}function hj(n,e,t){t||(t=ge(6+4*e.length)),t.write_shift(2,n),Rn(e,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function mj(n,e,t){var i={};i.sz=n.read_shift(2)/20;var r=t6(n);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var s=n.read_shift(2);switch(s===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var l=n.read_shift(1);l!=0&&(i.underline=l);var u=n.read_shift(1);u>0&&(i.family=u);var f=n.read_shift(1);switch(f>0&&(i.charset=f),n.l++,i.color=e6(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=ei(n),i}function pj(n,e){e||(e=ge(25+4*32)),e.write_shift(2,n.sz*20),n6(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),rf(n.color,e);var i=0;return i=2,e.write_shift(1,i),Rn(n.name,e),e.length>e.l?e.slice(0,e.l):e}var gj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Xm,vj=Ur;function Gx(n,e){e||(e=ge(4*3+8*7+16*1)),Xm||(Xm=Gp(gj));var t=Xm[n.patternType];t==null&&(t=40),e.write_shift(4,t);var i=0;if(t!=40)for(rf({auto:1},e),rf({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function yj(n,e){var t=n.l+e,i=n.read_shift(2),r=n.read_shift(2);return n.l=t,{ixfe:i,numFmtId:r}}function p2(n,e,t){t||(t=ge(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function mc(n,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var xj=Ur;function bj(n,e){return e||(e=ge(51)),e.write_shift(1,0),mc(null,e),mc(null,e),mc(null,e),mc(null,e),mc(null,e),e.length>e.l?e.slice(0,e.l):e}function Sj(n,e){return e||(e=ge(12+4*10)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),nf(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function _j(n,e,t){var i=ge(2052);return i.write_shift(4,n),nf(e,i),nf(t,i),i.length>i.l?i.slice(0,i.l):i}function Tj(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&++t}),t!=0&&(_e(n,615,xr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&_e(n,44,hj(r,e[r]))}),_e(n,616))}}function wj(n){var e=1;_e(n,611,xr(e)),_e(n,43,pj({sz:12,color:{theme:1},name:"Calibri",family:2})),_e(n,612)}function Ej(n){var e=2;_e(n,603,xr(e)),_e(n,45,Gx({patternType:"none"})),_e(n,45,Gx({patternType:"gray125"})),_e(n,604)}function Aj(n){var e=1;_e(n,613,xr(e)),_e(n,46,bj()),_e(n,614)}function kj(n){var e=1;_e(n,626,xr(e)),_e(n,47,p2({numFmtId:0},65535)),_e(n,627)}function Cj(n,e){_e(n,617,xr(e.length)),e.forEach(function(t){_e(n,47,p2(t,0))}),_e(n,618)}function jj(n){var e=1;_e(n,619,xr(e)),_e(n,48,Sj({xfId:0,name:"Normal"})),_e(n,620)}function Dj(n){var e=0;_e(n,505,xr(e)),_e(n,506)}function Nj(n){var e=0;_e(n,508,_j(e,"TableStyleMedium9","PivotStyleMedium4")),_e(n,509)}function Oj(n,e){var t=Ei();return _e(t,278),Tj(t,n.SSF),wj(t),Ej(t),Aj(t),kj(t),Cj(t,e.cellXfs),jj(t),Dj(t),Nj(t),_e(t,279),t.end()}function g2(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[yn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Rj(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:ei(n)}}function Mj(n){var e=ge(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),Rn(n.name,e),e.slice(0,e.l)}function Lj(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function Ij(n){var e=ge(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function Pj(n,e){var t=ge(8+2*e.length);return t.write_shift(4,n),Rn(e,t),t.slice(0,t.l)}function Bj(n){return n.l+=4,n.read_shift(4)!=0}function Fj(n,e){var t=ge(8);return t.write_shift(4,n),t.write_shift(4,1),t}function zj(){var n=Ei();return _e(n,332),_e(n,334,xr(1)),_e(n,335,Mj({name:"XLDAPR",version:12e4,flags:3496657072})),_e(n,336),_e(n,339,Pj(1,"XLDAPR")),_e(n,52),_e(n,35,xr(514)),_e(n,4096,xr(0)),_e(n,4097,rr(1)),_e(n,36),_e(n,53),_e(n,340),_e(n,337,Fj(1)),_e(n,51,Ij([[1,0]])),_e(n,338),_e(n,333),n.end()}function v2(){var n=[yn];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function Uj(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Ot(t);var i=n.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}var Vo=1024;function y2(n,e){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),r=[Re("xml",null,{"xmlns:v":Hi.v,"xmlns:o":Hi.o,"xmlns:x":Hi.x,"xmlns:mv":Hi.mv}).replace(/\/>/,">"),Re("o:shapelayout",Re("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),Re("v:shapetype",[Re("v:stroke",null,{joinstyle:"miter"}),Re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Vo<n*1e3;)Vo+=1e3;return e.forEach(function(s){var l=On(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=Re("v:fill",f,u),p={on:"t",obscured:"t"};++Vo,r=r.concat(["<v:shape"+Wc({id:"_x0000_s"+Vo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,Re("v:shadow",null,p),Re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Wn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Wn("x:AutoFill","False"),Wn("x:Row",String(l.r)),Wn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function x2(n){var e=[yn,Re("comments",null,{xmlns:al[0]})],t=[];return e.push("<authors>"),n.forEach(function(i){i[1].forEach(function(r){var s=Nt(r.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),r.T&&r.ID&&t.indexOf("tc="+r.ID)==-1&&(t.push("tc="+r.ID),e.push("<author>tc="+r.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(i){var r=0,s=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?r=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(f){f.a&&(r=t.indexOf(Nt(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>'),s.length<=1)e.push(Wn("t",Nt(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;e.push(Wn("t",Nt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Hj(n,e,t){var i=[yn,Re("ThreadedComments",null,{xmlns:Nn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(r){var s="";(r[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};u==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),i.push(Re("threadedComment",Wn("text",l.t||""),f))})}),i.push("</ThreadedComments>"),i.join("")}function Wj(n){var e=[yn,Re("personList",null,{xmlns:Nn.TCMNT,"xmlns:x":al[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,i){e.push(Re("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Vj(n){var e={};e.iauthor=n.read_shift(4);var t=Qs(n);return e.rfx=t.s,e.ref=Ot(t.s),n.l+=16,e}function Gj(n,e){return e==null&&(e=ge(36)),e.write_shift(4,n[1].iauthor),ol(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Yj=ei;function $j(n){return Rn(n.slice(0,54))}function Xj(n){var e=Ei(),t=[];return _e(e,628),_e(e,630),n.forEach(function(i){i[1].forEach(function(r){t.indexOf(r.a)>-1||(t.push(r.a.slice(0,54)),_e(e,632,$j(r.a)))})}),_e(e,631),_e(e,633),n.forEach(function(i){i[1].forEach(function(r){r.iauthor=t.indexOf(r.a);var s={s:On(i[0]),e:On(i[0])};_e(e,635,Gj([s,r])),r.t&&r.t.length>0&&_e(e,637,KC(r)),_e(e,636),delete r.iauthor})}),_e(e,634),_e(e,629),e.end()}function qj(n,e){e.FullPaths.forEach(function(t,i){if(i!=0){var r=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Bt.utils.cfb_add(n,r,e.FileIndex[i].content)}})}var b2=["xlsb","xlsm","xlam","biff8","xla"],Kj=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,r,s,l){var u=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var m=s.length>0?parseInt(s,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=e.c:--p,f?m+=e.r:--m,r+(u?"":"$")+Qn(p)+(f?"":"$")+Vn(m)}return function(r,s){return e=s,r.replace(n,t)}}(),rg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ag=function(){return function(e,t){return e.replace(rg,function(i,r,s,l,u,f){var m=Jp(l)-(s?0:t.c),p=Zp(f)-(u?0:t.r),v=p==0?"":u?p+1:"["+p+"]",y=m==0?"":s?m+1:"["+m+"]";return r+"R"+v+"C"+y})}}();function Zj(n,e){return n.replace(rg,function(t,i,r,s,l,u){return i+(r=="$"?r+s:Qn(Jp(s)+e.c))+(l=="$"?l+u:Vn(Zp(u)+e.r))})}function Jj(n){return n.length!=1}function gn(n){n.l+=1}function as(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function S2(n,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return _2(n);t.biff==12&&(i=4)}var r=n.read_shift(i),s=n.read_shift(i),l=as(n),u=as(n);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function _2(n){var e=as(n),t=as(n),i=n.read_shift(1),r=n.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:r,cRel:t[1],rRel:t[2]}}}function Qj(n,e,t){if(t.biff<8)return _2(n);var i=n.read_shift(t.biff==12?4:2),r=n.read_shift(t.biff==12?4:2),s=as(n),l=as(n);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r,c:l[0],cRel:l[1],rRel:l[2]}}}function T2(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return eD(n);var i=n.read_shift(t&&t.biff==12?4:2),r=as(n);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function eD(n){var e=as(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function tD(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function nD(n,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return iD(n);var r=n.read_shift(i>=12?4:2),s=n.read_shift(2),l=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;r>524287;)r-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r,c:s,cRel:l,rRel:u}}function iD(n){var e=n.read_shift(2),t=n.read_shift(1),i=(e&32768)>>15,r=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),r==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:r,rRel:i}}function rD(n,e,t){var i=(n[n.l++]&96)>>5,r=S2(n,t.biff>=2&&t.biff<=5?6:8,t);return[i,r]}function aD(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var l=S2(n,s,t);return[i,r,l]}function sD(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function oD(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[i,r]}function lD(n,e,t){var i=(n[n.l++]&96)>>5,r=Qj(n,e-1,t);return[i,r]}function cD(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[i]}function Yx(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function uD(n,e,t){n.l+=2;for(var i=n.read_shift(t&&t.biff==2?1:2),r=[],s=0;s<=i;++s)r.push(n.read_shift(t&&t.biff==2?1:2));return r}function dD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function fD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function hD(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function mD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[i]}function w2(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function pD(n){return n.read_shift(2),w2(n)}function gD(n){return n.read_shift(2),w2(n)}function vD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=T2(n,0,t);return[i,r]}function yD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=nD(n,0,t);return[i,r]}function xD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=T2(n,0,t);return[i,r,s]}function bD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(t&&t.biff<=3?1:2);return[bN[r],k2[r],i]}function SD(n,e,t){var i=n[n.l++],r=n.read_shift(1),s=t&&t.biff<=3?[i==88?-1:0,n.read_shift(1)]:_D(n);return[r,(s[0]===0?k2:xN)[s[1]]]}function _D(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function TD(n,e,t){n.l+=t&&t.biff==2?3:4}function wD(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function ED(n){return n.l++,eu[n.read_shift(1)]}function AD(n){return n.l++,n.read_shift(2)}function kD(n){return n.l++,n.read_shift(1)!==0}function CD(n){return n.l++,ll(n)}function jD(n,e,t){return n.l++,s2(n,e-1,t)}function DD(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=x6(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=eu[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=ll(n);break;case 2:t[1]=T6(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function ND(n,e,t){for(var i=n.read_shift(t.biff==12?4:2),r=[],s=0;s!=i;++s)r.push((t.biff==12?Qs:A6)(n));return r}function OD(n,e,t){var i=0,r=0;t.biff==12?(i=n.read_shift(4),r=n.read_shift(4)):(r=1+n.read_shift(1),i=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--r==0&&(r=256));for(var s=0,l=[];s!=i&&(l[s]=[]);++s)for(var u=0;u!=r;++u)l[s][u]=DD(n,t.biff);return l}function RD(n,e,t){var i=n.read_shift(1)>>>5&3,r=!t||t.biff>=8?4:2,s=n.read_shift(r);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,s]}function MD(n,e,t){if(t.biff==5)return LD(n);var i=n.read_shift(1)>>>5&3,r=n.read_shift(2),s=n.read_shift(4);return[i,r,s]}function LD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[e,t,i]}function ID(n,e,t){var i=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function PD(n,e,t){var i=n.read_shift(1)>>>5&3,r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function BD(n,e,t){var i=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[i]}function FD(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[i,r]}var zD=Ur,UD=Ur,HD=Ur;function tu(n,e,t){return n.l+=2,[tD(n)]}function sg(n){return n.l+=6,[]}var WD=tu,VD=sg,GD=sg,YD=tu;function E2(n){return n.l+=2,[r2(n),n.read_shift(2)&1]}var $D=tu,XD=E2,qD=sg,KD=tu,ZD=tu,JD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QD(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(4),r=n.read_shift(2),s=n.read_shift(2),l=JD[t>>2&31];return{ixti:e,coltype:t&3,rt:l,idx:i,c:r,C:s}}function eN(n){return n.l+=2,[n.read_shift(4)]}function tN(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function nN(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function iN(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function rN(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function aN(n){return n.l+=4,[0,0]}var $x={1:{n:"PtgExp",f:wD},2:{n:"PtgTbl",f:HD},3:{n:"PtgAdd",f:gn},4:{n:"PtgSub",f:gn},5:{n:"PtgMul",f:gn},6:{n:"PtgDiv",f:gn},7:{n:"PtgPower",f:gn},8:{n:"PtgConcat",f:gn},9:{n:"PtgLt",f:gn},10:{n:"PtgLe",f:gn},11:{n:"PtgEq",f:gn},12:{n:"PtgGe",f:gn},13:{n:"PtgGt",f:gn},14:{n:"PtgNe",f:gn},15:{n:"PtgIsect",f:gn},16:{n:"PtgUnion",f:gn},17:{n:"PtgRange",f:gn},18:{n:"PtgUplus",f:gn},19:{n:"PtgUminus",f:gn},20:{n:"PtgPercent",f:gn},21:{n:"PtgParen",f:gn},22:{n:"PtgMissArg",f:gn},23:{n:"PtgStr",f:jD},26:{n:"PtgSheet",f:tN},27:{n:"PtgEndSheet",f:nN},28:{n:"PtgErr",f:ED},29:{n:"PtgBool",f:kD},30:{n:"PtgInt",f:AD},31:{n:"PtgNum",f:CD},32:{n:"PtgArray",f:cD},33:{n:"PtgFunc",f:bD},34:{n:"PtgFuncVar",f:SD},35:{n:"PtgName",f:RD},36:{n:"PtgRef",f:vD},37:{n:"PtgArea",f:rD},38:{n:"PtgMemArea",f:ID},39:{n:"PtgMemErr",f:zD},40:{n:"PtgMemNoMem",f:UD},41:{n:"PtgMemFunc",f:PD},42:{n:"PtgRefErr",f:BD},43:{n:"PtgAreaErr",f:sD},44:{n:"PtgRefN",f:yD},45:{n:"PtgAreaN",f:lD},46:{n:"PtgMemAreaN",f:iN},47:{n:"PtgMemNoMemN",f:rN},57:{n:"PtgNameX",f:MD},58:{n:"PtgRef3d",f:xD},59:{n:"PtgArea3d",f:aD},60:{n:"PtgRefErr3d",f:FD},61:{n:"PtgAreaErr3d",f:oD},255:{}},sN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oN={1:{n:"PtgElfLel",f:E2},2:{n:"PtgElfRw",f:KD},3:{n:"PtgElfCol",f:WD},6:{n:"PtgElfRwV",f:ZD},7:{n:"PtgElfColV",f:YD},10:{n:"PtgElfRadical",f:$D},11:{n:"PtgElfRadicalS",f:qD},13:{n:"PtgElfColS",f:VD},15:{n:"PtgElfColSV",f:GD},16:{n:"PtgElfRadicalLel",f:XD},25:{n:"PtgList",f:QD},29:{n:"PtgSxName",f:eN},255:{}},lN={0:{n:"PtgAttrNoop",f:aN},1:{n:"PtgAttrSemi",f:mD},2:{n:"PtgAttrIf",f:fD},4:{n:"PtgAttrChoose",f:uD},8:{n:"PtgAttrGoto",f:dD},16:{n:"PtgAttrSum",f:TD},32:{n:"PtgAttrBaxcel",f:Yx},33:{n:"PtgAttrBaxcel",f:Yx},64:{n:"PtgAttrSpace",f:pD},65:{n:"PtgAttrSpaceSemi",f:gD},128:{n:"PtgAttrIfError",f:hD},255:{}};function cN(n,e,t,i){if(i.biff<8)return Ur(n,e);for(var r=n.l+e,s=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=OD(n,0,i),s.push(t[l][1]);break;case"PtgMemArea":t[l][2]=ND(n,t[l][1],i),s.push(t[l][2]);break;case"PtgExp":i&&i.biff==12&&(t[l][1][1]=n.read_shift(4),s.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return e=r-n.l,e!==0&&s.push(Ur(n,e)),s}function uN(n,e,t){for(var i=n.l+e,r,s,l=[];i!=n.l;)e=i-n.l,s=n[n.l],r=$x[s]||$x[sN[s]],(s===24||s===25)&&(r=(s===24?oN:lN)[n[n.l+1]]),!r||!r.f?Ur(n,e):l.push([r.n,r.f(n,e,t)]);return l}function dN(n){for(var e=[],t=0;t<n.length;++t){for(var i=n[t],r=[],s=0;s<i.length;++s){var l=i[s];if(l)switch(l[0]){case 2:r.push('"'+l[1].replace(/"/g,'""')+'"');break;default:r.push(l[1])}else r.push("")}e.push(r.join(","))}return e.join(";")}var fN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hN(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function A2(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!i)return"SH33TJSERR1";var r="";if(t.biff>8)switch(n[i[0]][0]){case 357:return r=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[i[0]][0];case 355:default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[i[0]][0][3]?(r=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Xx(n,e,t){var i=A2(n,e,t);return i=="#REF"?i:hN(i,t)}function el(n,e,t,i,r){var s=r&&r.biff||8,l={s:{c:0,r:0}},u=[],f,m,p,v=0,y=0,S,_="";if(!n[0]||!n[0][0])return"";for(var b=-1,T="",E=0,w=n[0].length;E<w;++E){var C=n[0][E];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),m=u.pop(),b>=0){switch(n[0][b][1][0]){case 0:T=an(" ",n[0][b][1][1]);break;case 1:T=an("\r",n[0][b][1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][b][1][0])}m=m+T,b=-1}u.push(m+fN[C[0]]+f);break;case"PtgIsect":f=u.pop(),m=u.pop(),u.push(m+" "+f);break;case"PtgUnion":f=u.pop(),m=u.pop(),u.push(m+","+f);break;case"PtgRange":f=u.pop(),m=u.pop(),u.push(m+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Cc(C[1][1],l,r),u.push(jc(p,s));break;case"PtgRefN":p=t?Cc(C[1][1],t,r):C[1][1],u.push(jc(p,s));break;case"PtgRef3d":v=C[1][1],p=Cc(C[1][2],l,r),_=Xx(i,v,r),u.push(_+"!"+jc(p,s));break;case"PtgFunc":case"PtgFuncVar":var j=C[1][0],k=C[1][1];j||(j=0),j&=127;var P=j==0?[]:u.slice(-j);u.length-=j,k==="User"&&(k=P.shift()),u.push(k+"("+P.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":S=Ox(C[1][1],t?{s:t}:l,r),u.push(Ym(S,r));break;case"PtgArea":S=Ox(C[1][1],l,r),u.push(Ym(S,r));break;case"PtgArea3d":v=C[1][1],S=C[1][2],_=Xx(i,v,r),u.push(_+"!"+Ym(S,r));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var D=(i.names||[])[y-1]||(i[0]||[])[y],z=D?D.Name:"SH33TJSNAME"+String(y);z&&z.slice(0,6)=="_xlfn."&&!r.xlfn&&(z=z.slice(6)),u.push(z);break;case"PtgNameX":var R=C[1][1];y=C[1][2];var W;if(r.biff<=5)R<0&&(R=-R),i[R]&&(W=i[R][y]);else{var q="";if(((i[R]||[])[0]||[])[0]==14849||(((i[R]||[])[0]||[])[0]==1025?i[R][y]&&i[R][y].itab>0&&(q=i.SheetNames[i[R][y].itab-1]+"!"):q=i.SheetNames[y-1]+"!"),i[R]&&i[R][y])q+=i[R][y].Name;else if(i[0]&&i[0][y])q+=i[0][y].Name;else{var J=(A2(i,R,r)||"").split(";;");J[y-1]?q=J[y-1]:q+="SH33TJSERRX"}u.push(q);break}W||(W={Name:"SH33TJSERRY"}),u.push(W.Name);break;case"PtgParen":var me="(",Ce=")";if(b>=0){switch(T="",n[0][b][1][0]){case 2:me=an(" ",n[0][b][1][1])+me;break;case 3:me=an("\r",n[0][b][1][1])+me;break;case 4:Ce=an(" ",n[0][b][1][1])+Ce;break;case 5:Ce=an("\r",n[0][b][1][1])+Ce;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][b][1][0])}b=-1}u.push(me+u.pop()+Ce);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var ve={c:t.c,r:t.r};if(i.sharedf[Ot(p)]){var ne=i.sharedf[Ot(p)];u.push(el(ne,l,ve,i,r))}else{var Z=!1;for(f=0;f!=i.arrayf.length;++f)if(m=i.arrayf[f],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(el(m[1],l,ve,i,r)),Z=!0;break}Z||u.push(C[1])}break;case"PtgArray":u.push("{"+dN(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&b>=0&&be.indexOf(n[0][E][0])==-1){C=n[0][b];var Ne=!0;switch(C[1][0]){case 4:Ne=!1;case 0:T=an(" ",C[1][1]);break;case 5:Ne=!1;case 1:T=an("\r",C[1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((Ne?T:"")+u.pop()+(Ne?"":T)),b=-1}}if(u.length>1&&r.WTF)throw new Error("bad formula stack");return u[0]}function mN(n){if(n==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return $s(n);return $s(0)}function pN(n,e,t,i,r){var s=Xs(e,t,r),l=mN(n.v),u=ge(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var m=ge(n.bf.length),p=0;p<n.bf.length;++p)m[p]=n.bf[p];var v=Hn([s,l,u,m]);return v}function wf(n,e,t){var i=n.read_shift(4),r=uN(n,i,t),s=n.read_shift(4),l=s>0?cN(n,s,r,t):null;return[r,l]}var gN=wf,Ef=wf,vN=wf,yN=wf,xN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},k2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function SN(n){var e="of:="+n.replace(rg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function _N(n){return n.replace(/\./,"!")}var Dc=typeof Map<"u";function og(n,e,t){var i=0,r=n.length;if(t){if(Dc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Dc?t.get(e):t[e];i<s.length;++i)if(n[s[i]].t===e)return n.Count++,s[i]}}else for(;i<r;++i)if(n[i].t===e)return n.Count++,i;return n[r]={t:e},n.Count++,n.Unique++,t&&(Dc?(t.has(e)||t.set(e,[]),t.get(e).push(r)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(r))),r}function Af(n,e){var t={min:n+1,max:n+1},i=-1;return e.MDW&&(pa=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?i=of(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(t.width=mp(i),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function C2(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function ls(n,e,t){var i=t.revssf[e.z!=null?e.z:"General"],r=60,s=n.length;if(i==null&&t.ssf){for(;r<392;++r)if(t.ssf[r]==null){TS(e.z,r),t.ssf[r]=e.z,t.revssf[e.z]=i=r;break}}for(r=0;r!=s;++r)if(n[r].numFmtId===i)return r;return n[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function TN(n,e,t){if(n&&n["!ref"]){var i=Gt(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function wN(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+vn(n[t])+'"/>';return e+"</mergeCells>"}function EN(n,e,t,i,r){var s=!1,l={},u=null;if(i.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[t];try{e.Workbook&&(f=e.Workbook.Sheets[t].CodeName||f)}catch{}s=!0,l.codeName=Hc(Nt(f))}if(n&&n["!outline"]){var m={summaryBelow:1,summaryRight:1};n["!outline"].above&&(m.summaryBelow=0),n["!outline"].left&&(m.summaryRight=0),u=(u||"")+Re("outlinePr",null,m)}!s&&!u||(r[r.length]=Re("sheetPr",u,l))}var AN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],kN=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function CN(n){var e={sheet:1};return AN.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),kN.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=d2(n.password).toString(16).toUpperCase()),Re("sheetProtection",null,e)}function jN(n){return C2(n),Re("pageMargins",null,n)}function DN(n,e){for(var t=["<cols>"],i,r=0;r!=e.length;++r)(i=e[r])&&(t[t.length]=Re("col",null,Af(r,i)));return t[t.length]="</cols>",t.join("")}function NN(n,e,t,i){var r=typeof n.ref=="string"?n.ref:vn(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,l=Vi(r);l.s.r==l.e.r&&(l.e.r=Vi(e["!ref"]).e.r,r=vn(l));for(var u=0;u<s.length;++u){var f=s[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref="'"+t.SheetNames[i]+"'!"+r;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+r}),Re("autoFilter",null,{ref:r})}function ON(n,e,t,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Re("sheetViews",Re("sheetView",null,r),{})}function RN(n,e,t,i){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var r="",s=n.t,l=n.v;if(n.t!=="z")switch(n.t){case"b":r=n.v?"1":"0";break;case"n":r=""+n.v;break;case"e":r=eu[n.v];break;case"d":i&&i.cellDates?r=fi(n.v,-1).toISOString():(n=Ci(n),n.t="n",r=""+(n.v=ki(fi(n.v)))),typeof n.z>"u"&&(n.z=on[14]);break;default:r=n.v;break}var u=Wn("v",Nt(r)),f={r:e},m=ls(i.cellXfs,n,i);switch(m!==0&&(f.s=m),n.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){u=Wn("v",""+og(i.Strings,n.v,i.revStrings)),f.t="s";break}f.t="str";break}if(n.t!=s&&(n.t=s,n.v=l),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;u=Re("f",Nt(n.f),p)+(n.v!=null?u:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(f.cm=1),Re("c",u,f)}function MN(n,e,t,i){var r=[],s=[],l=Gt(n["!ref"]),u="",f,m="",p=[],v=0,y=0,S=n["!rows"],_=Array.isArray(n),b={r:m},T,E=-1;for(y=l.s.c;y<=l.e.c;++y)p[y]=Qn(y);for(v=l.s.r;v<=l.e.r;++v){for(s=[],m=Vn(v),y=l.s.c;y<=l.e.c;++y){f=p[y]+m;var w=_?(n[v]||[])[y]:n[f];w!==void 0&&(u=RN(w,f,n,e))!=null&&s.push(u)}(s.length>0||S&&S[v])&&(b={r:m},S&&S[v]&&(T=S[v],T.hidden&&(b.hidden=1),E=-1,T.hpx?E=lf(T.hpx):T.hpt&&(E=T.hpt),E>-1&&(b.ht=E,b.customHeight=1),T.level&&(b.outlineLevel=T.level)),r[r.length]=Re("row",s.join(""),b))}if(S)for(;v<S.length;++v)S&&S[v]&&(b={r:v+1},T=S[v],T.hidden&&(b.hidden=1),E=-1,T.hpx?E=lf(T.hpx):T.hpt&&(E=T.hpt),E>-1&&(b.ht=E,b.customHeight=1),T.level&&(b.outlineLevel=T.level),r[r.length]=Re("row","",b));return r.join("")}function j2(n,e,t,i){var r=[yn,Re("worksheet",null,{xmlns:al[0],"xmlns:r":Nn.r})],s=t.SheetNames[n],l=0,u="",f=t.Sheets[s];f==null&&(f={});var m=f["!ref"]||"A1",p=Gt(m);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),m=vn(p)}i||(i={}),f["!comments"]=[];var v=[];EN(f,t,n,e,r),r[r.length]=Re("dimension",null,{ref:m}),r[r.length]=ON(f,e,n,t),e.sheetFormat&&(r[r.length]=Re("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(r[r.length]=DN(f,f["!cols"])),r[l=r.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=MN(f,e),u.length>0&&(r[r.length]=u)),r.length>l+1&&(r[r.length]="</sheetData>",r[l]=r[l].replace("/>",">")),f["!protect"]&&(r[r.length]=CN(f["!protect"])),f["!autofilter"]!=null&&(r[r.length]=NN(f["!autofilter"],f,t,n)),f["!merges"]!=null&&f["!merges"].length>0&&(r[r.length]=wN(f["!merges"]));var y=-1,S,_=-1;return f["!links"].length>0&&(r[r.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(S={ref:b[0]},b[1].Target.charAt(0)!="#"&&(_=jt(i,-1,Nt(b[1].Target).replace(/#.*$/,""),St.HLINK),S["r:id"]="rId"+_),(y=b[1].Target.indexOf("#"))>-1&&(S.location=Nt(b[1].Target.slice(y+1))),b[1].Tooltip&&(S.tooltip=Nt(b[1].Tooltip)),r[r.length]=Re("hyperlink",null,S))}),r[r.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(r[r.length]=jN(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(r[r.length]=Wn("ignoredErrors",Re("ignoredError",null,{numberStoredAsText:1,sqref:m}))),v.length>0&&(_=jt(i,-1,"../drawings/drawing"+(n+1)+".xml",St.DRAW),r[r.length]=Re("drawing",null,{"r:id":"rId"+_}),f["!drawing"]=v),f["!comments"].length>0&&(_=jt(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",St.VML),r[r.length]=Re("legacyDrawing",null,{"r:id":"rId"+_}),f["!legacy"]=_),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function LN(n,e){var t={},i=n.l+e;t.r=n.read_shift(4),n.l+=4;var r=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=i,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=r/20),t}function IN(n,e,t){var i=ge(145),r=(t["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var s=320;r.hpx?s=lf(r.hpx)*20:r.hpt&&(s=r.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var l=0;r.level&&(l|=r.level),r.hidden&&(l|=16),(r.hpx||r.hpt)&&(l|=32),i.write_shift(1,l),i.write_shift(1,0);var u=0,f=i.l;i.l+=4;for(var m={r:n,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,y=-1,S=p<<10;S<p+1<<10;++S){m.c=S;var _=Array.isArray(t)?(t[m.r]||[])[m.c]:t[Ot(m)];_&&(v<0&&(v=S),y=S)}v<0||(++u,i.write_shift(4,v),i.write_shift(4,y))}var b=i.l;return i.l=f,i.write_shift(4,u),i.l=b,i.length>i.l?i.slice(0,i.l):i}function PN(n,e,t,i){var r=IN(i,t,e);(r.length>17||(e["!rows"]||[])[i])&&_e(n,0,r)}var BN=Qs,FN=ol;function zN(){}function UN(n,e){var t={},i=n[n.l];return++n.l,t.above=!(i&64),t.left=!(i&128),n.l+=18,t.name=ZC(n),t}function HN(n,e,t){t==null&&(t=ge(84+4*n.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),t.write_shift(1,i);for(var r=1;r<3;++r)t.write_shift(1,0);return rf({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),VS(n,t),t.slice(0,t.l)}function WN(n){var e=sr(n);return[e]}function VN(n,e,t){return t==null&&(t=ge(8)),Ks(e,t)}function GN(n){var e=Zs(n);return[e]}function YN(n,e,t){return t==null&&(t=ge(4)),Js(e,t)}function $N(n){var e=sr(n),t=n.read_shift(1);return[e,t,"b"]}function XN(n,e,t){return t==null&&(t=ge(9)),Ks(e,t),t.write_shift(1,n.v?1:0),t}function qN(n){var e=Zs(n),t=n.read_shift(1);return[e,t,"b"]}function KN(n,e,t){return t==null&&(t=ge(5)),Js(e,t),t.write_shift(1,n.v?1:0),t}function ZN(n){var e=sr(n),t=n.read_shift(1);return[e,t,"e"]}function JN(n,e,t){return t==null&&(t=ge(9)),Ks(e,t),t.write_shift(1,n.v),t}function QN(n){var e=Zs(n),t=n.read_shift(1);return[e,t,"e"]}function eO(n,e,t){return t==null&&(t=ge(8)),Js(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function tO(n){var e=sr(n),t=n.read_shift(4);return[e,t,"s"]}function nO(n,e,t){return t==null&&(t=ge(12)),Ks(e,t),t.write_shift(4,e.v),t}function iO(n){var e=Zs(n),t=n.read_shift(4);return[e,t,"s"]}function rO(n,e,t){return t==null&&(t=ge(8)),Js(e,t),t.write_shift(4,e.v),t}function aO(n){var e=sr(n),t=ll(n);return[e,t,"n"]}function sO(n,e,t){return t==null&&(t=ge(16)),Ks(e,t),$s(n.v,t),t}function oO(n){var e=Zs(n),t=ll(n);return[e,t,"n"]}function lO(n,e,t){return t==null&&(t=ge(12)),Js(e,t),$s(n.v,t),t}function cO(n){var e=sr(n),t=GS(n);return[e,t,"n"]}function uO(n,e,t){return t==null&&(t=ge(12)),Ks(e,t),YS(n.v,t),t}function dO(n){var e=Zs(n),t=GS(n);return[e,t,"n"]}function fO(n,e,t){return t==null&&(t=ge(8)),Js(e,t),YS(n.v,t),t}function hO(n){var e=sr(n),t=Qp(n);return[e,t,"is"]}function mO(n){var e=sr(n),t=ei(n);return[e,t,"str"]}function pO(n,e,t){return t==null&&(t=ge(12+4*n.v.length)),Ks(e,t),Rn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function gO(n){var e=Zs(n),t=ei(n);return[e,t,"str"]}function vO(n,e,t){return t==null&&(t=ge(8+4*n.v.length)),Js(e,t),Rn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function yO(n,e,t){var i=n.l+e,r=sr(n);r.r=t["!row"];var s=n.read_shift(1),l=[r,s,"b"];if(t.cellFormula){n.l+=2;var u=Ef(n,i-n.l,t);l[3]=el(u,null,r,t.supbooks,t)}else n.l=i;return l}function xO(n,e,t){var i=n.l+e,r=sr(n);r.r=t["!row"];var s=n.read_shift(1),l=[r,s,"e"];if(t.cellFormula){n.l+=2;var u=Ef(n,i-n.l,t);l[3]=el(u,null,r,t.supbooks,t)}else n.l=i;return l}function bO(n,e,t){var i=n.l+e,r=sr(n);r.r=t["!row"];var s=ll(n),l=[r,s,"n"];if(t.cellFormula){n.l+=2;var u=Ef(n,i-n.l,t);l[3]=el(u,null,r,t.supbooks,t)}else n.l=i;return l}function SO(n,e,t){var i=n.l+e,r=sr(n);r.r=t["!row"];var s=ei(n),l=[r,s,"str"];if(t.cellFormula){n.l+=2;var u=Ef(n,i-n.l,t);l[3]=el(u,null,r,t.supbooks,t)}else n.l=i;return l}var _O=Qs,TO=ol;function wO(n,e){return e==null&&(e=ge(4)),e.write_shift(4,n),e}function EO(n,e){var t=n.l+e,i=Qs(n),r=eg(n),s=ei(n),l=ei(n),u=ei(n);n.l=t;var f={rfx:i,relId:r,loc:s,display:u};return l&&(f.Tooltip=l),f}function AO(n,e){var t=ge(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));ol({s:On(n[0]),e:On(n[0])},t),tg("rId"+e,t);var i=n[1].Target.indexOf("#"),r=i==-1?"":n[1].Target.slice(i+1);return Rn(r||"",t),Rn(n[1].Tooltip||"",t),Rn("",t),t.slice(0,t.l)}function kO(){}function CO(n,e,t){var i=n.l+e,r=$S(n),s=n.read_shift(1),l=[r];if(l[2]=s,t.cellFormula){var u=gN(n,i-n.l,t);l[1]=u}else n.l=i;return l}function jO(n,e,t){var i=n.l+e,r=Qs(n),s=[r];if(t.cellFormula){var l=yN(n,i-n.l,t);s[1]=l,n.l=i}else n.l=i;return s}function DO(n,e,t){t==null&&(t=ge(18));var i=Af(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var r=0;return e.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),e.level&&(r|=e.level<<8),t.write_shift(2,r),t}var D2=["left","right","top","bottom","header","footer"];function NO(n){var e={};return D2.forEach(function(t){e[t]=ll(n)}),e}function OO(n,e){return e==null&&(e=ge(6*8)),C2(n),D2.forEach(function(t){$s(n[t],e)}),e}function RO(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function MO(n,e,t){t==null&&(t=ge(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function LO(n){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),ol(n,e),e}function IO(n,e){return e==null&&(e=ge(16*4+2)),e.write_shift(2,n.password?d2(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function PO(){}function BO(){}function FO(n,e,t,i,r,s,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=Ci(e),e.z=e.z||on[14],e.v=ki(fi(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r:t,c:i};switch(f.s=ls(r.cellXfs,e,r),e.l&&s["!links"].push([Ot(f),e.l]),e.c&&s["!comments"].push([Ot(f),e.c]),e.t){case"s":case"str":return r.bookSST?(u=og(r.Strings,e.v,r.revStrings),f.t="s",f.v=u,l?_e(n,18,rO(e,f)):_e(n,7,nO(e,f))):(f.t="str",l?_e(n,17,vO(e,f)):_e(n,6,pO(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?_e(n,13,fO(e,f)):_e(n,2,uO(e,f)):l?_e(n,16,lO(e,f)):_e(n,5,sO(e,f)),!0;case"b":return f.t="b",l?_e(n,15,KN(e,f)):_e(n,4,XN(e,f)),!0;case"e":return f.t="e",l?_e(n,14,eO(e,f)):_e(n,3,JN(e,f)),!0}return l?_e(n,12,YN(e,f)):_e(n,1,VN(e,f)),!0}function zO(n,e,t,i){var r=Gt(e["!ref"]||"A1"),s,l="",u=[];_e(n,145);var f=Array.isArray(e),m=r.e.r;e["!rows"]&&(m=Math.max(r.e.r,e["!rows"].length-1));for(var p=r.s.r;p<=m;++p){l=Vn(p),PN(n,e,r,p);var v=!1;if(p<=r.e.r)for(var y=r.s.c;y<=r.e.c;++y){p===r.s.r&&(u[y]=Qn(y)),s=u[y]+l;var S=f?(e[p]||[])[y]:e[s];if(!S){v=!1;continue}v=FO(n,S,p,y,i,e,v)}}_e(n,146)}function UO(n,e){!e||!e["!merges"]||(_e(n,177,wO(e["!merges"].length)),e["!merges"].forEach(function(t){_e(n,176,TO(t))}),_e(n,178))}function HO(n,e){!e||!e["!cols"]||(_e(n,390),e["!cols"].forEach(function(t,i){t&&_e(n,60,DO(i,t))}),_e(n,391))}function WO(n,e){!e||!e["!ref"]||(_e(n,648),_e(n,649,LO(Gt(e["!ref"]))),_e(n,650))}function VO(n,e,t){e["!links"].forEach(function(i){if(i[1].Target){var r=jt(t,-1,i[1].Target.replace(/#.*$/,""),St.HLINK);_e(n,494,AO(i,r))}}),delete e["!links"]}function GO(n,e,t,i){if(e["!comments"].length>0){var r=jt(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",St.VML);_e(n,551,tg("rId"+r)),e["!legacy"]=r}}function YO(n,e,t,i){if(e["!autofilter"]){var r=e["!autofilter"],s=typeof r.ref=="string"?r.ref:vn(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,u=Vi(s);u.s.r==u.e.r&&(u.e.r=Vi(e["!ref"]).e.r,s=vn(u));for(var f=0;f<l.length;++f){var m=l[f];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==i){m.Ref="'"+t.SheetNames[i]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+s}),_e(n,161,ol(Gt(s))),_e(n,162)}}function $O(n,e,t){_e(n,133),_e(n,137,MO(e,t)),_e(n,138),_e(n,134)}function XO(n,e){e["!protect"]&&_e(n,535,IO(e["!protect"]))}function qO(n,e,t,i){var r=Ei(),s=t.SheetNames[n],l=t.Sheets[s]||{},u=s;try{t&&t.Workbook&&(u=t.Workbook.Sheets[n].CodeName||u)}catch{}var f=Gt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],_e(r,129),(t.vbaraw||l["!outline"])&&_e(r,147,HN(u,l["!outline"])),_e(r,148,FN(f)),$O(r,l,t.Workbook),HO(r,l),zO(r,l,n,e),XO(r,l),YO(r,l,t,n),UO(r,l),VO(r,l,i),l["!margins"]&&_e(r,476,OO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&WO(r,l),GO(r,l,n,i),_e(r,130),r.end()}function KO(n,e){n.l+=10;var t=ei(n);return{name:t}}var ZO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function JO(n){return!n.Workbook||!n.Workbook.WBProps?"false":jC(n.Workbook.WBProps.date1904)?"true":"false"}var QO="][*?/\\".split("");function N2(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return QO.forEach(function(i){if(n.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function eR(n,e,t){n.forEach(function(i,r){N2(i);for(var s=0;s<r;++s)if(i==n[s])throw new Error("Duplicate Sheet Name: "+i);if(t){var l=e&&e[r]&&e[r].CodeName||i;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function tR(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];eR(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)TN(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function O2(n){var e=[yn];e[e.length]=Re("workbook",null,{xmlns:al[0],"xmlns:r":Nn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(ZO.forEach(function(u){n.Workbook.WBProps[u[0]]!=null&&n.Workbook.WBProps[u[0]]!=u[1]&&(i[u[0]]=n.Workbook.WBProps[u[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=Re("workbookPr",null,i);var r=n.Workbook&&n.Workbook.Sheets||[],s=0;if(r&&r[0]&&r[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!r[s]||!r[s].Hidden);++s);s==n.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var l={name:Nt(n.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),r[s])switch(r[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Re("sheet",null,l)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Re("definedName",Nt(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function nR(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=hp(n),t.name=ei(n),t}function iR(n,e){return e||(e=ge(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),tg(n.strRelID,e),Rn(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function rR(n,e){var t={},i=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var r=e>8?ei(n):"";return r.length>0&&(t.CodeName=r),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function aR(n,e){e||(e=ge(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),VS(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function sR(n,e,t){var i=n.l+e;n.l+=4,n.l+=1;var r=n.read_shift(4),s=JC(n),l=vN(n,0,t),u=eg(n);n.l=i;var f={Name:s,Ptg:l};return r<268435455&&(f.Sheet=r),u&&(f.Comment=u),f}function oR(n,e){_e(n,143);for(var t=0;t!=e.SheetNames.length;++t){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,r={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};_e(n,156,iR(r))}_e(n,144)}function lR(n,e){e||(e=ge(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Rn("SheetJS",e),Rn(qd.version,e),Rn(qd.version,e),Rn("7262",e),e.length>e.l?e.slice(0,e.l):e}function cR(n,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function uR(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,i=0,r=-1,s=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&r==-1?r=i:t[i].Hidden==1&&s==-1&&(s=i);s>r||(_e(n,135),_e(n,158,cR(r)),_e(n,136))}}function dR(n,e){var t=Ei();return _e(t,131),_e(t,128,lR()),_e(t,153,aR(n.Workbook&&n.Workbook.WBProps||null)),uR(t,n),oR(t,n),_e(t,132),t.end()}function fR(n,e,t){return(e.slice(-4)===".bin"?dR:O2)(n)}function hR(n,e,t,i,r){return(e.slice(-4)===".bin"?qO:j2)(n,t,i,r)}function mR(n,e,t){return(e.slice(-4)===".bin"?Oj:m2)(n,t)}function pR(n,e,t){return(e.slice(-4)===".bin"?aj:u2)(n,t)}function gR(n,e,t){return(e.slice(-4)===".bin"?Xj:x2)(n)}function vR(n){return(n.slice(-4)===".bin"?zj:v2)()}function yR(n,e){var t=[];return n.Props&&t.push(m6(n.Props,e)),n.Custprops&&t.push(p6(n.Props,n.Custprops)),t.join("")}function xR(){return""}function bR(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,r){var s=[];s.push(Re("NumberFormat",null,{"ss:Format":Nt(on[i.numFmtId])}));var l={"ss:ID":"s"+(21+r)};t.push(Re("Style",s.join(""),l))}),Re("Styles",t.join(""))}function R2(n){return Re("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+ag(n.Ref,{r:0,c:0})})}function SR(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],i=0;i<e.length;++i){var r=e[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||t.push(R2(r)))}return Re("Names",t.join(""))}function _R(n,e,t,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,s=[],l=0;l<r.length;++l){var u=r[l];u.Sheet==t&&(u.Name.match(/^_xlfn\./)||s.push(R2(u)))}return s.join("")}function TR(n,e,t,i){if(!n)return"";var r=[];if(n["!margins"]&&(r.push("<PageSetup>"),n["!margins"].header&&r.push(Re("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&r.push(Re("Footer",null,{"x:Margin":n["!margins"].footer})),r.push(Re("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)r.push(Re("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==t&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),n["!protect"]&&(r.push(Wn("ProtectContents","True")),n["!protect"].objects&&r.push(Wn("ProtectObjects","True")),n["!protect"].scenarios&&r.push(Wn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?r.push(Wn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&r.push(Wn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){n["!protect"][l[0]]&&r.push("<"+l[1]+"/>")})),r.length==0?"":Re("WorksheetOptions",r.join(""),{xmlns:Hi.x})}function wR(n){return n.map(function(e){var t=CC(e.t||""),i=Re("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Re("Comment",i,{"ss:Author":e.a})}).join("")}function ER(n,e,t,i,r,s,l){if(!n||n.v==null&&n.f==null)return"";var u={};if(n.f&&(u["ss:Formula"]="="+Nt(ag(n.f,l))),n.F&&n.F.slice(0,e.length)==e){var f=On(n.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(n.l&&n.l.Target&&(u["ss:HRef"]=Nt(n.l.Target),n.l.Tooltip&&(u["x:HRefScreenTip"]=Nt(n.l.Tooltip))),t["!merges"])for(var m=t["!merges"],p=0;p!=m.length;++p)m[p].s.c!=l.c||m[p].s.r!=l.r||(m[p].e.c>m[p].s.c&&(u["ss:MergeAcross"]=m[p].e.c-m[p].s.c),m[p].e.r>m[p].s.r&&(u["ss:MergeDown"]=m[p].e.r-m[p].s.r));var v="",y="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":v="Number",y=String(n.v);break;case"b":v="Boolean",y=n.v?"1":"0";break;case"e":v="Error",y=eu[n.v];break;case"d":v="DateTime",y=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||on[14]);break;case"s":v="String",y=kC(n.v||"");break}var S=ls(i.cellXfs,n,i);u["ss:StyleID"]="s"+(21+S),u["ss:Index"]=l.c+1;var _=n.v!=null?y:"",b=n.t=="z"?"":'<Data ss:Type="'+v+'">'+_+"</Data>";return(n.c||[]).length>0&&(b+=wR(n.c)),Re("Cell",b,u)}function AR(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=h2(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function kR(n,e,t,i){if(!n["!ref"])return"";var r=Gt(n["!ref"]),s=n["!merges"]||[],l=0,u=[];n["!cols"]&&n["!cols"].forEach(function(T,E){ig(T);var w=!!T.width,C=Af(E,T),j={"ss:Index":E+1};w&&(j["ss:Width"]=sf(C.width)),T.hidden&&(j["ss:Hidden"]="1"),u.push(Re("Column",null,j))});for(var f=Array.isArray(n),m=r.s.r;m<=r.e.r;++m){for(var p=[AR(m,(n["!rows"]||[])[m])],v=r.s.c;v<=r.e.c;++v){var y=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>v)&&!(s[l].s.r>m)&&!(s[l].e.c<v)&&!(s[l].e.r<m)){(s[l].s.c!=v||s[l].s.r!=m)&&(y=!0);break}if(!y){var S={r:m,c:v},_=Ot(S),b=f?(n[m]||[])[v]:n[_];p.push(ER(b,_,n,e,t,i,S))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function CR(n,e,t){var i=[],r=t.SheetNames[n],s=t.Sheets[r],l=s?_R(s,e,n,t):"";return l.length>0&&i.push("<Names>"+l+"</Names>"),l=s?kR(s,e,n,t):"",l.length>0&&i.push("<Table>"+l+"</Table>"),i.push(TR(s,e,n,t)),i.join("")}function jR(n,e){e||(e={}),n.SSF||(n.SSF=Ci(on)),n.SSF&&(Sf(),bf(n.SSF),e.revssf=_f(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],ls(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(yR(n,e)),t.push(xR()),t.push(""),t.push("");for(var i=0;i<n.SheetNames.length;++i)t.push(Re("Worksheet",CR(i,e,n),{"ss:Name":Nt(n.SheetNames[i])}));return t[2]=bR(n,e),t[3]=SR(n),yn+Re("Workbook",t.join(""),{xmlns:Hi.ss,"xmlns:o":Hi.o,"xmlns:x":Hi.x,"xmlns:ss":Hi.ss,"xmlns:dt":Hi.dt,"xmlns:html":Hi.html})}var qm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function DR(n,e){var t=[],i=[],r=[],s=0,l,u=Sx(Mx,"n"),f=Sx(Lx,"n");if(n.Props)for(l=Gn(n.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(u,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?i:r).push([l[s],n.Props[l[s]]]);if(n.Custprops)for(l=Gn(n.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(u,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?i:r).push([l[s],n.Custprops[l[s]]]);var m=[];for(s=0;s<r.length;++s)i2.indexOf(r[s][0])>-1||e2.indexOf(r[s][0])>-1||r[s][1]!=null&&m.push(r[s]);i.length&&Bt.utils.cfb_add(e,"/SummaryInformation",zx(i,qm.SI,f,Lx)),(t.length||m.length)&&Bt.utils.cfb_add(e,"/DocumentSummaryInformation",zx(t,qm.DSI,u,Mx,m.length?m:null,qm.UDI))}function NR(n,e){var t=e||{},i=Bt.utils.cfb_new({root:"R"}),r="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":r="/Workbook",t.biff=8;break;case"biff5":r="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Bt.utils.cfb_add(i,r,M2(n,t)),t.biff==8&&(n.Props||n.Custprops)&&DR(n,i),t.biff==8&&n.vbaraw&&qj(i,Bt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var OR={0:{f:LN},1:{f:WN},2:{f:cO},3:{f:ZN},4:{f:$N},5:{f:aO},6:{f:mO},7:{f:tO},8:{f:SO},9:{f:bO},10:{f:yO},11:{f:xO},12:{f:GN},13:{f:dO},14:{f:QN},15:{f:qN},16:{f:oO},17:{f:gO},18:{f:iO},19:{f:Qp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:sR},40:{},42:{},43:{f:mj},44:{f:fj},45:{f:vj},46:{f:xj},47:{f:yj},48:{},49:{f:GC},50:{},51:{f:Lj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Y6},62:{f:hO},63:{f:Uj},64:{f:PO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ur,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:UN},148:{f:BN,p:16},151:{f:kO},152:{},153:{f:rR},154:{},155:{},156:{f:nR},157:{},158:{},159:{T:1,f:nj},160:{T:-1},161:{T:1,f:Qs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_O},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Rj},336:{T:-1},337:{f:Bj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:z6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:CO},427:{f:jO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:NO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:EO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Yj},633:{T:1},634:{T:-1},635:{T:1,f:Vj},636:{T:-1},637:{f:qC},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:KO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:BO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Me(n,e,t,i){var r=e;if(!isNaN(r)){var s=i||(t||[]).length||0,l=n.next(4);l.write_shift(2,r),l.write_shift(2,s),s>0&&Kp(t)&&n.push(t)}}function RR(n,e,t,i){var r=(t||[]).length||0;if(r<=8224)return Me(n,e,t,r);var s=e;if(!isNaN(s)){for(var l=t.parts||[],u=0,f=0,m=0;m+(l[u]||8224)<=8224;)m+=l[u]||8224,u++;var p=n.next(4);for(p.write_shift(2,s),p.write_shift(2,m),n.push(t.slice(f,f+m)),f+=m;f<r;){for(p=n.next(4),p.write_shift(2,60),m=0;m+(l[u]||8224)<=8224;)m+=l[u]||8224,u++;p.write_shift(2,m),n.push(t.slice(f,f+m)),f+=m}}}function nu(n,e,t){return n||(n=ge(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function MR(n,e,t,i){var r=ge(9);return nu(r,n,e),a2(t,i||"b",r),r}function LR(n,e,t){var i=ge(8+2*t.length);return nu(i,n,e),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function IR(n,e,t,i){if(e.v!=null)switch(e.t){case"d":case"n":var r=e.t=="d"?ki(fi(e.v)):e.v;r==(r|0)&&r>=0&&r<65536?Me(n,2,K6(t,i,r)):Me(n,3,q6(t,i,r));return;case"b":case"e":Me(n,5,MR(t,i,e.v,e.t));return;case"s":case"str":Me(n,4,LR(t,i,(e.v||"").slice(0,255)));return}Me(n,1,nu(null,t,i))}function PR(n,e,t,i){var r=Array.isArray(e),s=Gt(e["!ref"]||"A1"),l,u="",f=[];if(s.e.c>255||s.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=vn(s)}for(var m=s.s.r;m<=s.e.r;++m){u=Vn(m);for(var p=s.s.c;p<=s.e.c;++p){m===s.s.r&&(f[p]=Qn(p)),l=f[p]+u;var v=r?(e[m]||[])[p]:e[l];v&&IR(n,v,m,p)}}}function BR(n,e){for(var t=e||{},i=Ei(),r=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==t.sheet&&(r=s);if(r==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Me(i,t.biff==4?1033:t.biff==3?521:9,ng(n,16,t)),PR(i,n.Sheets[n.SheetNames[r]],r,t),Me(i,10),i.end()}function FR(n,e,t){Me(n,49,O6({sz:12,name:"Arial"},t))}function zR(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&Me(n,1054,L6(r,e[r],t))})}function UR(n,e){var t=ge(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Me(n,2151,t),t=ge(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),l2(Gt(e["!ref"]||"A1"),t),t.write_shift(4,4),Me(n,2152,t)}function HR(n,e){for(var t=0;t<16;++t)Me(n,224,Hx({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){Me(n,224,Hx(i,0,e))})}function WR(n,e){for(var t=0;t<e["!links"].length;++t){var i=e["!links"][t];Me(n,440,W6(i)),i[1].Tooltip&&Me(n,2048,V6(i))}delete e["!links"]}function VR(n,e){if(e){var t=0;e.forEach(function(i,r){++t<=256&&i&&Me(n,125,$6(Af(r,i),r))})}}function GR(n,e,t,i,r){var s=16+ls(r.cellXfs,e,r);if(e.v==null&&!e.bf){Me(n,513,Xs(t,i,s));return}if(e.bf)Me(n,6,pN(e,t,i,r,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?ki(fi(e.v)):e.v;Me(n,515,F6(t,i,l,s));break;case"b":case"e":Me(n,517,B6(t,i,e.v,s,r,e.t));break;case"s":case"str":if(r.bookSST){var u=og(r.Strings,e.v,r.revStrings);Me(n,253,R6(t,i,u,s))}else Me(n,516,M6(t,i,(e.v||"").slice(0,255),s,r));break;default:Me(n,513,Xs(t,i,s))}}function YR(n,e,t){var i=Ei(),r=t.SheetNames[n],s=t.Sheets[r]||{},l=(t||{}).Workbook||{},u=(l.Sheets||[])[n]||{},f=Array.isArray(s),m=e.biff==8,p,v="",y=[],S=Gt(s["!ref"]||"A1"),_=m?65536:16384;if(S.e.c>255||S.e.r>=_){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,_-1)}Me(i,2057,ng(t,16,e)),Me(i,13,rr(1)),Me(i,12,rr(100)),Me(i,15,di(!0)),Me(i,17,di(!1)),Me(i,16,$s(.001)),Me(i,95,di(!0)),Me(i,42,di(!1)),Me(i,43,di(!1)),Me(i,130,rr(1)),Me(i,128,P6()),Me(i,131,di(!1)),Me(i,132,di(!1)),m&&VR(i,s["!cols"]),Me(i,512,I6(S,e)),m&&(s["!links"]=[]);for(var b=S.s.r;b<=S.e.r;++b){v=Vn(b);for(var T=S.s.c;T<=S.e.c;++T){b===S.s.r&&(y[T]=Qn(T)),p=y[T]+v;var E=f?(s[b]||[])[T]:s[p];E&&(GR(i,E,b,T,e),m&&E.l&&s["!links"].push([p,E.l]))}}var w=u.CodeName||u.name||r;return m&&Me(i,574,N6((l.Views||[])[0])),m&&(s["!merges"]||[]).length&&Me(i,229,H6(s["!merges"])),m&&WR(i,s),Me(i,442,o2(w)),m&&UR(i,s),Me(i,10),i.end()}function $R(n,e,t){var i=Ei(),r=(n||{}).Workbook||{},s=r.Sheets||[],l=r.WBProps||{},u=t.biff==8,f=t.biff==5;if(Me(i,2057,ng(n,5,t)),t.bookType=="xla"&&Me(i,135),Me(i,225,u?rr(1200):null),Me(i,193,y6(2)),f&&Me(i,191),f&&Me(i,192),Me(i,226),Me(i,92,k6("SheetJS",t)),Me(i,66,rr(u?1200:1252)),u&&Me(i,353,rr(0)),u&&Me(i,448),Me(i,317,X6(n.SheetNames.length)),u&&n.vbaraw&&Me(i,211),u&&n.vbaraw){var m=l.CodeName||"ThisWorkbook";Me(i,442,o2(m))}Me(i,156,rr(17)),Me(i,25,di(!1)),Me(i,18,di(!1)),Me(i,19,rr(0)),u&&Me(i,431,di(!1)),u&&Me(i,444,rr(0)),Me(i,61,D6()),Me(i,64,di(!1)),Me(i,141,rr(0)),Me(i,34,di(JO(n)=="true")),Me(i,14,di(!0)),u&&Me(i,439,di(!1)),Me(i,218,rr(0)),FR(i,n,t),zR(i,n.SSF,t),HR(i,t),u&&Me(i,352,di(!1));var p=i.end(),v=Ei();u&&Me(v,140,G6()),u&&t.Strings&&RR(v,252,j6(t.Strings)),Me(v,10);var y=v.end(),S=Ei(),_=0,b=0;for(b=0;b<n.SheetNames.length;++b)_+=(u?12:11)+(u?2:1)*n.SheetNames[b].length;var T=p.length+_+y.length;for(b=0;b<n.SheetNames.length;++b){var E=s[b]||{};Me(S,133,C6({pos:T,hs:E.Hidden||0,dt:0,name:n.SheetNames[b]},t)),T+=e[b].length}var w=S.end();if(_!=w.length)throw new Error("BS8 "+_+" != "+w.length);var C=[];return p.length&&C.push(p),w.length&&C.push(w),y.length&&C.push(y),Hn(C)}function XR(n,e){var t=e||{},i=[];n&&!n.SSF&&(n.SSF=Ci(on)),n&&n.SSF&&(Sf(),bf(n.SSF),t.revssf=_f(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,lg(t),t.cellXfs=[],ls(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var r=0;r<n.SheetNames.length;++r)i[i.length]=YR(r,t,n);return i.unshift($R(n,i,t)),Hn(i)}function M2(n,e){for(var t=0;t<=n.SheetNames.length;++t){var i=n.Sheets[n.SheetNames[t]];if(!(!i||!i["!ref"])){var r=Vi(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return XR(n,e);case 4:case 3:case 2:return BR(n,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function qR(n,e,t,i){for(var r=n["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,m=0;m<r.length;++m)if(!(r[m].s.r>t||r[m].s.c>l)&&!(r[m].e.r<t||r[m].e.c<l)){if(r[m].s.r<t||r[m].s.c<l){u=-1;break}u=r[m].e.r-r[m].s.r+1,f=r[m].e.c-r[m].s.c+1;break}if(!(u<0)){var p=Ot({r:t,c:l}),v=i.dense?(n[t]||[])[l]:n[p],y=v&&v.v!=null&&(v.h||AC(v.w||(ya(v),v.w)||""))||"",S={};u>1&&(S.rowspan=u),f>1&&(S.colspan=f),i.editable?y='<span contenteditable="true">'+y+"</span>":v&&(S["data-t"]=v&&v.t||"z",v.v!=null&&(S["data-v"]=v.v),v.z!=null&&(S["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),S.id=(i.id||"sjs")+"-"+p,s.push(Re("td",y,S))}}var _="<tr>";return _+s.join("")+"</tr>"}var KR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ZR="</body></html>";function JR(n,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function L2(n,e){var t=e||{},i=t.header!=null?t.header:KR,r=t.footer!=null?t.footer:ZR,s=[i],l=Vi(n["!ref"]);t.dense=Array.isArray(n),s.push(JR(n,l,t));for(var u=l.s.r;u<=l.e.r;++u)s.push(qR(n,l,u,t));return s.push("</table>"+r),s.join("")}function I2(n,e,t){var i=t||{},r=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")r=i.origin;else{var l=typeof i.origin=="string"?On(i.origin):i.origin;r=l.r,s=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(i.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r,c:s}};if(n["!ref"]){var p=Vi(n["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),r==-1&&(m.e.r=r=p.e.r+1)}var v=[],y=0,S=n["!rows"]||(n["!rows"]=[]),_=0,b=0,T=0,E=0,w=0,C=0;for(n["!cols"]||(n["!cols"]=[]);_<u.length&&b<f;++_){var j=u[_];if(qx(j)){if(i.display)continue;S[b]={hidden:!0}}var k=j.children;for(T=E=0;T<k.length;++T){var P=k[T];if(!(i.display&&qx(P))){var D=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):DC(P.innerHTML),z=P.getAttribute("data-z")||P.getAttribute("z");for(y=0;y<v.length;++y){var R=v[y];R.s.c==E+s&&R.s.r<b+r&&b+r<=R.e.r&&(E=R.e.c+1-s,y=-1)}C=+P.getAttribute("colspan")||1,((w=+P.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:b+r,c:E+s},e:{r:b+r+(w||1)-1,c:E+s+(C||1)-1}});var W={t:"s",v:D},q=P.getAttribute("data-t")||P.getAttribute("t")||"";D!=null&&(D.length==0?W.t=q||"z":i.raw||D.trim().length==0||q=="s"||(D==="TRUE"?W={t:"b",v:!0}:D==="FALSE"?W={t:"b",v:!1}:isNaN(ma(D))?isNaN(Uc(D).getDate())||(W={t:"d",v:fi(D)},i.cellDates||(W={t:"n",v:ki(W.v)}),W.z=i.dateNF||on[14]):W={t:"n",v:ma(D)})),W.z===void 0&&z!=null&&(W.z=z);var J="",me=P.getElementsByTagName("A");if(me&&me.length)for(var Ce=0;Ce<me.length&&!(me[Ce].hasAttribute("href")&&(J=me[Ce].getAttribute("href"),J.charAt(0)!="#"));++Ce);J&&J.charAt(0)!="#"&&(W.l={Target:J}),i.dense?(n[b+r]||(n[b+r]=[]),n[b+r][E+s]=W):n[Ot({c:E+s,r:b+r})]=W,m.e.c<E+s&&(m.e.c=E+s),E+=C}}++b}return v.length&&(n["!merges"]=(n["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,b-1+r),n["!ref"]=vn(m),b>=f&&(n["!fullref"]=vn((m.e.r=u.length-_+b-1+r,m))),n}function P2(n,e){var t=e||{},i=t.dense?[]:{};return I2(i,n,e)}function QR(n,e){return qs(P2(n,e),e)}function qx(n){var e="",t=eM(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function eM(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var tM=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Wc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return yn+e}}(),Kx=function(){var n=function(s){return Nt(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(s,l,u){var f=[];f.push('      <table:table table:name="'+Nt(l.SheetNames[u])+`" table:style-name="ta1">
`);var m=0,p=0,v=Vi(s["!ref"]||"A1"),y=s["!merges"]||[],S=0,_=Array.isArray(s);if(s["!cols"])for(p=0;p<=v.e.c;++p)f.push("        <table:table-column"+(s["!cols"][p]?' table:style-name="co'+s["!cols"][p].ods+'"':"")+`></table:table-column>
`);var b="",T=s["!rows"]||[];for(m=0;m<v.s.r;++m)b=T[m]?' table:style-name="ro'+T[m].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;m<=v.e.r;++m){for(b=T[m]?' table:style-name="ro'+T[m].ods+'"':"",f.push("        <table:table-row"+b+`>
`),p=0;p<v.s.c;++p)f.push(e);for(;p<=v.e.c;++p){var E=!1,w={},C="";for(S=0;S!=y.length;++S)if(!(y[S].s.c>p)&&!(y[S].s.r>m)&&!(y[S].e.c<p)&&!(y[S].e.r<m)){(y[S].s.c!=p||y[S].s.r!=m)&&(E=!0),w["table:number-columns-spanned"]=y[S].e.c-y[S].s.c+1,w["table:number-rows-spanned"]=y[S].e.r-y[S].s.r+1;break}if(E){f.push(t);continue}var j=Ot({r:m,c:p}),k=_?(s[m]||[])[p]:s[j];if(k&&k.f&&(w["table:formula"]=Nt(SN(k.f)),k.F&&k.F.slice(0,j.length)==j)){var P=Vi(k.F);w["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,w["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!k){f.push(e);continue}switch(k.t){case"b":C=k.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=k.v?"true":"false";break;case"n":C=k.w||String(k.v||0),w["office:value-type"]="float",w["office:value"]=k.v||0;break;case"s":case"str":C=k.v==null?"":k.v,w["office:value-type"]="string";break;case"d":C=k.w||fi(k.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=fi(k.v).toISOString(),w["table:style-name"]="ce1";break;default:f.push(e);continue}var D=n(C);if(k.l&&k.l.Target){var z=k.l.Target;z=z.charAt(0)=="#"?"#"+_N(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),D=Re("text:a",D,{"xlink:href":z.replace(/&/g,"&amp;")})}f.push("          "+Re("table:table-cell",Re("text:p",D,{}),w)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},r=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var p=0;p<m["!cols"].length;++p)if(m["!cols"][p]){var v=m["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;ig(v),v.ods=u;var y=m["!cols"][p].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),s.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var p=0;p<m["!rows"].length;++p)if(m["!rows"][p]){m["!rows"][p].ods=f;var v=m["!rows"][p].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,u){var f=[yn],m=Wc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Wc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+m+p+`>
`),f.push(JS().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+m+`>
`),r(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)f.push(i(l.Sheets[l.SheetNames[v]],l,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function B2(n,e){if(e.bookType=="fods")return Kx(n,e);var t=Yp(),i="",r=[],s=[];return i="mimetype",it(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",it(t,i,Kx(n,e)),r.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",it(t,i,tM(n,e)),r.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",it(t,i,yn+JS()),r.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",it(t,i,h6(s)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",it(t,i,d6(r)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function cf(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function nM(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):vr(Hc(n))}function iM(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var i=0;i<e.length;++i)if(n[t+i]!=e[i])continue e;return!0}return!1}function ss(n){var e=n.reduce(function(r,s){return r+s.length},0),t=new Uint8Array(e),i=0;return n.forEach(function(r){t.set(r,i),i+=r.length}),t}function rM(n,e,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,r=t/Math.pow(10,i-6176);n[e+15]|=i>>7,n[e+14]|=(i&127)<<1;for(var s=0;r>=1;++s,r/=256)n[e+s]=r&255;n[e+15]|=t>=0?0:128}function Vc(n,e){var t=e?e[0]:0,i=n[t]&127;e:if(n[t++]>=128&&(i|=(n[t]&127)<<7,n[t++]<128||(i|=(n[t]&127)<<14,n[t++]<128)||(i|=(n[t]&127)<<21,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),i}function Ct(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function Zo(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function wn(n){for(var e=[],t=[0];t[0]<n.length;){var i=t[0],r=Vc(n,t),s=r&7;r=Math.floor(r/8);var l=0,u;if(r==0)break;switch(s){case 0:{for(var f=t[0];n[t[0]++]>=128;);u=n.slice(f,t[0])}break;case 5:l=4,u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Vc(n,t),u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(r," at offset ").concat(i))}var m={data:u,type:s};e[r]==null?e[r]=[m]:e[r].push(m)}return e}function zn(n){var e=[];return n.forEach(function(t,i){t.forEach(function(r){r.data&&(e.push(Ct(i*8+r.type)),r.type==2&&e.push(Ct(r.data.length)),e.push(r.data))})}),ss(e)}function mr(n){for(var e,t=[],i=[0];i[0]<n.length;){var r=Vc(n,i),s=wn(n.slice(i[0],i[0]+r));i[0]+=r;var l={id:Zo(s[1][0].data),messages:[]};s[2].forEach(function(u){var f=wn(u.data),m=Zo(f[3][0].data);l.messages.push({meta:f,data:n.slice(i[0],i[0]+m)}),i[0]+=m}),(e=s[3])!=null&&e[0]&&(l.merge=Zo(s[3][0].data)>>>0>0),t.push(l)}return t}function Uo(n){var e=[];return n.forEach(function(t){var i=[];i[1]=[{data:Ct(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:Ct(+!!t.merge),type:0}]);var r=[];t.messages.forEach(function(l){r.push(l.data),l.meta[3]=[{type:0,data:Ct(l.data.length)}],i[2].push({data:zn(l.meta),type:2})});var s=zn(i);e.push(Ct(s.length)),e.push(s),r.forEach(function(l){return e.push(l)})}),ss(e)}function aM(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],i=Vc(e,t),r=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var l=e[t[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[t[0]],u>1&&(l|=e[t[0]+1]<<8),u>2&&(l|=e[t[0]+2]<<16),u>3&&(l|=e[t[0]+3]<<24),l>>>=0,l++,t[0]+=u}r.push(e.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,m=0;if(s==1?(m=(e[t[0]]>>2&7)+4,f=(e[t[0]++]&224)<<3,f|=e[t[0]++]):(m=(e[t[0]++]>>2)+1,s==2?(f=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(f=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),r=[ss(r)],f==0)throw new Error("Invalid offset 0");if(f>r[0].length)throw new Error("Invalid offset beyond length");if(m>=f)for(r.push(r[0].slice(-f)),m-=f;m>=r[r.length-1].length;)r.push(r[r.length-1]),m-=r[r.length-1].length;r.push(r[0].slice(-f,-f+m))}}var p=ss(r);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function pr(n){for(var e=[],t=0;t<n.length;){var i=n[t++],r=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(aM(i,n.slice(t,t+r))),t+=r}if(t!==n.length)throw new Error("data is not a valid framed stream!");return ss(e)}function Ho(n){for(var e=[],t=0;t<n.length;){var i=Math.min(n.length-t,268435455),r=new Uint8Array(4);e.push(r);var s=Ct(i),l=s.length;e.push(s),i<=60?(l++,e.push(new Uint8Array([i-1<<2]))):i<=256?(l+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(l+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(l+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(l+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(n.slice(t,t+i)),l+=i,r[0]=0,r[1]=l&255,r[2]=l>>8&255,r[3]=l>>16&255,t+=i}return ss(e)}function Km(n,e){var t=new Uint8Array(32),i=cf(t),r=12,s=0;switch(t[0]=5,n.t){case"n":t[1]=2,rM(t,r,n.v),s|=1,r+=16;break;case"b":t[1]=6,i.setFloat64(r,n.v?1:0,!0),s|=2,r+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,i.setUint32(r,e.indexOf(n.v),!0),s|=8,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,s,!0),t.slice(0,r)}function Zm(n,e){var t=new Uint8Array(32),i=cf(t),r=12,s=0;switch(t[0]=3,n.t){case"n":t[2]=2,i.setFloat64(r,n.v,!0),s|=32,r+=8;break;case"b":t[2]=6,i.setFloat64(r,n.v?1:0,!0),s|=32,r+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,i.setUint32(r,e.indexOf(n.v),!0),s|=16,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(4,s,!0),t.slice(0,r)}function Xa(n){var e=wn(n);return Vc(e[1][0].data)}function sM(n,e,t){var i,r,s,l;if(!((i=n[6])!=null&&i[0])||!((r=n[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(s=n[8])==null?void 0:s[0])==null?void 0:l.data)&&Zo(n[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,m=cf(n[7][0].data),p=0,v=[],y=cf(n[4][0].data),S=0,_=[],b=0;b<e.length;++b){if(e[b]==null){m.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}m.setUint16(b*2,p,!0),y.setUint16(b*2,S,!0);var T,E;switch(typeof e[b]){case"string":T=Km({t:"s",v:e[b]},t),E=Zm({t:"s",v:e[b]},t);break;case"number":T=Km({t:"n",v:e[b]},t),E=Zm({t:"n",v:e[b]},t);break;case"boolean":T=Km({t:"b",v:e[b]},t),E=Zm({t:"b",v:e[b]},t);break;default:throw new Error("Unsupported value "+e[b])}v.push(T),p+=T.length,_.push(E),S+=E.length,++f}for(n[2][0].data=Ct(f);b<n[7][0].data.length/2;++b)m.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return n[6][0].data=ss(v),n[3][0].data=ss(_),f}function oM(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Vi(t["!ref"]);i.s.r=i.s.c=0;var r=!1;i.e.c>9&&(r=!0,i.e.c=9),i.e.r>49&&(r=!0,i.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(vn(i)));var s=uf(t,{range:i,header:1}),l=["~Sh33tJ5~"];s.forEach(function(Y){return Y.forEach(function(G){typeof G=="string"&&l.push(G)})});var u={},f=[],m=Bt.read(e.numbers,{type:"base64"});m.FileIndex.map(function(Y,G){return[Y,m.FullPaths[G]]}).forEach(function(Y){var G=Y[0],K=Y[1];if(G.type==2&&G.name.match(/\.iwa/)){var se=G.content,Le=pr(se),Oe=mr(Le);Oe.forEach(function(we){f.push(we.id),u[we.id]={deps:[],location:K,type:Zo(we.messages[0].meta[1][0].data)}})}}),f.sort(function(Y,G){return Y-G});var p=f.filter(function(Y){return Y>1}).map(function(Y){return[Y,Ct(Y)]});m.FileIndex.map(function(Y,G){return[Y,m.FullPaths[G]]}).forEach(function(Y){var G=Y[0];if(Y[1],!!G.name.match(/\.iwa/)){var K=mr(pr(G.content));K.forEach(function(se){se.messages.forEach(function(Le){p.forEach(function(Oe){se.messages.some(function(we){return Zo(we.meta[1][0].data)!=11006&&iM(we.data,Oe[1])})&&u[Oe[0]].deps.push(se.id)})})})}});for(var v=Bt.find(m,u[1].location),y=mr(pr(v.content)),S,_=0;_<y.length;++_){var b=y[_];b.id==1&&(S=b)}var T=Xa(wn(S.messages[0].data)[1][0].data);for(v=Bt.find(m,u[T].location),y=mr(pr(v.content)),_=0;_<y.length;++_)b=y[_],b.id==T&&(S=b);for(T=Xa(wn(S.messages[0].data)[2][0].data),v=Bt.find(m,u[T].location),y=mr(pr(v.content)),_=0;_<y.length;++_)b=y[_],b.id==T&&(S=b);for(T=Xa(wn(S.messages[0].data)[2][0].data),v=Bt.find(m,u[T].location),y=mr(pr(v.content)),_=0;_<y.length;++_)b=y[_],b.id==T&&(S=b);var E=wn(S.messages[0].data);{E[6][0].data=Ct(i.e.r+1),E[7][0].data=Ct(i.e.c+1);var w=Xa(E[46][0].data),C=Bt.find(m,u[w].location),j=mr(pr(C.content));{for(var k=0;k<j.length&&j[k].id!=w;++k);if(j[k].id!=w)throw"Bad ColumnRowUIDMapArchive";var P=wn(j[k].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var D=0;D<=i.e.c;++D){var z=[];z[1]=z[2]=[{type:0,data:Ct(D+420690)}],P[1].push({type:2,data:zn(z)}),P[2].push({type:0,data:Ct(D)}),P[3].push({type:0,data:Ct(D)})}P[4]=[],P[5]=[],P[6]=[];for(var R=0;R<=i.e.r;++R)z=[],z[1]=z[2]=[{type:0,data:Ct(R+726270)}],P[4].push({type:2,data:zn(z)}),P[5].push({type:0,data:Ct(R)}),P[6].push({type:0,data:Ct(R)});j[k].messages[0].data=zn(P)}C.content=Ho(Uo(j)),C.size=C.content.length,delete E[46];var W=wn(E[4][0].data);{W[7][0].data=Ct(i.e.r+1);var q=wn(W[1][0].data),J=Xa(q[2][0].data);C=Bt.find(m,u[J].location),j=mr(pr(C.content));{if(j[0].id!=J)throw"Bad HeaderStorageBucket";var me=wn(j[0].messages[0].data);for(R=0;R<s.length;++R){var Ce=wn(me[2][0].data);Ce[1][0].data=Ct(R),Ce[4][0].data=Ct(s[R].length),me[2][R]={type:me[2][0].type,data:zn(Ce)}}j[0].messages[0].data=zn(me)}C.content=Ho(Uo(j)),C.size=C.content.length;var ve=Xa(W[2][0].data);C=Bt.find(m,u[ve].location),j=mr(pr(C.content));{if(j[0].id!=ve)throw"Bad HeaderStorageBucket";for(me=wn(j[0].messages[0].data),D=0;D<=i.e.c;++D)Ce=wn(me[2][0].data),Ce[1][0].data=Ct(D),Ce[4][0].data=Ct(i.e.r+1),me[2][D]={type:me[2][0].type,data:zn(Ce)};j[0].messages[0].data=zn(me)}C.content=Ho(Uo(j)),C.size=C.content.length;var ne=Xa(W[4][0].data);(function(){for(var Y=Bt.find(m,u[ne].location),G=mr(pr(Y.content)),K,se=0;se<G.length;++se){var Le=G[se];Le.id==ne&&(K=Le)}var Oe=wn(K.messages[0].data);{Oe[3]=[];var we=[];l.forEach(function(et,Yt){we[1]=[{type:0,data:Ct(Yt)}],we[2]=[{type:0,data:Ct(1)}],we[3]=[{type:2,data:nM(et)}],Oe[3].push({type:2,data:zn(we)})})}K.messages[0].data=zn(Oe);var ke=Uo(G),dt=Ho(ke);Y.content=dt,Y.size=Y.content.length})();var Z=wn(W[3][0].data);{var be=Z[1][0];delete Z[2];var Ne=wn(be.data);{var V=Xa(Ne[2][0].data);(function(){for(var Y=Bt.find(m,u[V].location),G=mr(pr(Y.content)),K,se=0;se<G.length;++se){var Le=G[se];Le.id==V&&(K=Le)}var Oe=wn(K.messages[0].data);{delete Oe[6],delete Z[7];var we=new Uint8Array(Oe[5][0].data);Oe[5]=[];for(var ke=0,dt=0;dt<=i.e.r;++dt){var et=wn(we);ke+=sM(et,s[dt],l),et[1][0].data=Ct(dt),Oe[5].push({data:zn(et),type:2})}Oe[1]=[{type:0,data:Ct(i.e.c+1)}],Oe[2]=[{type:0,data:Ct(i.e.r+1)}],Oe[3]=[{type:0,data:Ct(ke)}],Oe[4]=[{type:0,data:Ct(i.e.r+1)}]}K.messages[0].data=zn(Oe);var Yt=Uo(G),at=Ho(Yt);Y.content=at,Y.size=Y.content.length})()}be.data=zn(Ne)}W[3][0].data=zn(Z)}E[4][0].data=zn(W)}S.messages[0].data=zn(E);var he=Uo(y),I=Ho(he);return v.content=I,v.size=v.content.length,m}function lM(n){return function(t){for(var i=0;i!=n.length;++i){var r=n[i];t[r[0]]===void 0&&(t[r[0]]=r[1]),r[2]==="n"&&(t[r[0]]=Number(t[r[0]]))}}}function lg(n){lM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function cM(n,e){return e.bookType=="ods"?B2(n,e):e.bookType=="numbers"?oM(n,e):e.bookType=="xlsb"?uM(n,e):dM(n,e)}function uM(n,e){Vo=1024,n&&!n.SSF&&(n.SSF=Ci(on)),n&&n.SSF&&(Sf(),bf(n.SSF),e.revssf=_f(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Dc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",i=b2.indexOf(e.bookType)>-1,r=qS();lg(e=e||{});var s=Yp(),l="",u=0;if(e.cellXfs=[],ls(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",it(s,l,QS(n.Props,e)),r.coreprops.push(l),jt(e.rels,2,l,St.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],m=0;m<n.SheetNames.length;++m)(n.Workbook.Sheets[m]||{}).Hidden!=2&&f.push(n.SheetNames[m]);n.Props.SheetNames=f}for(n.Props.Worksheets=n.Props.SheetNames.length,it(s,l,t2(n.Props)),r.extprops.push(l),jt(e.rels,3,l,St.EXT_PROPS),n.Custprops!==n.Props&&Gn(n.Custprops||{}).length>0&&(l="docProps/custom.xml",it(s,l,n2(n.Custprops)),r.custprops.push(l),jt(e.rels,4,l,St.CUST_PROPS)),u=1;u<=n.SheetNames.length;++u){var p={"!id":{}},v=n.Sheets[n.SheetNames[u-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,it(s,l,hR(u-1,l,e,n,p)),r.sheets.push(l),jt(e.wbrels,-1,"worksheets/sheet"+u+"."+t,St.WS[0])}if(v){var S=v["!comments"],_=!1,b="";S&&S.length>0&&(b="xl/comments"+u+"."+t,it(s,b,gR(S,b)),r.comments.push(b),jt(p,-1,"../comments"+u+"."+t,St.CMNT),_=!0),v["!legacy"]&&_&&it(s,"xl/drawings/vmlDrawing"+u+".vml",y2(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&it(s,ZS(l),qo(p))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,it(s,l,pR(e.Strings,l,e)),r.strs.push(l),jt(e.wbrels,-1,"sharedStrings."+t,St.SST)),l="xl/workbook."+t,it(s,l,fR(n,l)),r.workbooks.push(l),jt(e.rels,1,l,St.WB),l="xl/theme/theme1.xml",it(s,l,g2(n.Themes,e)),r.themes.push(l),jt(e.wbrels,-1,"theme/theme1.xml",St.THEME),l="xl/styles."+t,it(s,l,mR(n,l,e)),r.styles.push(l),jt(e.wbrels,-1,"styles."+t,St.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",it(s,l,n.vbaraw),r.vba.push(l),jt(e.wbrels,-1,"vbaProject.bin",St.VBA)),l="xl/metadata."+t,it(s,l,vR(l)),r.metadata.push(l),jt(e.wbrels,-1,"metadata."+t,St.XLMETA),it(s,"[Content_Types].xml",KS(r,e)),it(s,"_rels/.rels",qo(e.rels)),it(s,"xl/_rels/workbook."+t+".rels",qo(e.wbrels)),delete e.revssf,delete e.ssf,s}function dM(n,e){Vo=1024,n&&!n.SSF&&(n.SSF=Ci(on)),n&&n.SSF&&(Sf(),bf(n.SSF),e.revssf=_f(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Dc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",i=b2.indexOf(e.bookType)>-1,r=qS();lg(e=e||{});var s=Yp(),l="",u=0;if(e.cellXfs=[],ls(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",it(s,l,QS(n.Props,e)),r.coreprops.push(l),jt(e.rels,2,l,St.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],m=0;m<n.SheetNames.length;++m)(n.Workbook.Sheets[m]||{}).Hidden!=2&&f.push(n.SheetNames[m]);n.Props.SheetNames=f}n.Props.Worksheets=n.Props.SheetNames.length,it(s,l,t2(n.Props)),r.extprops.push(l),jt(e.rels,3,l,St.EXT_PROPS),n.Custprops!==n.Props&&Gn(n.Custprops||{}).length>0&&(l="docProps/custom.xml",it(s,l,n2(n.Custprops)),r.custprops.push(l),jt(e.rels,4,l,St.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=n.SheetNames.length;++u){var v={"!id":{}},y=n.Sheets[n.SheetNames[u-1]],S=(y||{})["!type"]||"sheet";switch(S){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,it(s,l,j2(u-1,e,n,v)),r.sheets.push(l),jt(e.wbrels,-1,"worksheets/sheet"+u+"."+t,St.WS[0])}if(y){var _=y["!comments"],b=!1,T="";if(_&&_.length>0){var E=!1;_.forEach(function(w){w[1].forEach(function(C){C.T==!0&&(E=!0)})}),E&&(T="xl/threadedComments/threadedComment"+u+"."+t,it(s,T,Hj(_,p,e)),r.threadedcomments.push(T),jt(v,-1,"../threadedComments/threadedComment"+u+"."+t,St.TCMNT)),T="xl/comments"+u+"."+t,it(s,T,x2(_)),r.comments.push(T),jt(v,-1,"../comments"+u+"."+t,St.CMNT),b=!0}y["!legacy"]&&b&&it(s,"xl/drawings/vmlDrawing"+u+".vml",y2(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}v["!id"].rId1&&it(s,ZS(l),qo(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,it(s,l,u2(e.Strings,e)),r.strs.push(l),jt(e.wbrels,-1,"sharedStrings."+t,St.SST)),l="xl/workbook."+t,it(s,l,O2(n)),r.workbooks.push(l),jt(e.rels,1,l,St.WB),l="xl/theme/theme1.xml",it(s,l,g2(n.Themes,e)),r.themes.push(l),jt(e.wbrels,-1,"theme/theme1.xml",St.THEME),l="xl/styles."+t,it(s,l,m2(n,e)),r.styles.push(l),jt(e.wbrels,-1,"styles."+t,St.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",it(s,l,n.vbaraw),r.vba.push(l),jt(e.wbrels,-1,"vbaProject.bin",St.VBA)),l="xl/metadata."+t,it(s,l,v2()),r.metadata.push(l),jt(e.wbrels,-1,"metadata."+t,St.XLMETA),p.length>1&&(l="xl/persons/person.xml",it(s,l,Wj(p)),r.people.push(l),jt(e.wbrels,-1,"persons/person.xml",St.PEOPLE)),it(s,"[Content_Types].xml",KS(r,e)),it(s,"_rels/.rels",qo(e.rels)),it(s,"xl/_rels/workbook."+t+".rels",qo(e.wbrels)),delete e.revssf,delete e.ssf,s}function fM(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=va(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function F2(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Jc(e.file,Bt.write(n,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Bt.write(n,e)}function hM(n,e){var t=Ci(e||{}),i=cM(n,t);return mM(i,t)}function mM(n,e){var t={},i=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=i;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var r=n.FullPaths?Bt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof r=="string"){if(e.type=="binary"||e.type=="base64")return r;r=new Uint8Array(xf(r))}return e.password&&typeof encrypt_agile<"u"?F2(encrypt_agile(r,e.password),e):e.type==="file"?Jc(e.file,r):e.type=="string"?Ac(r):r}function pM(n,e){var t=e||{},i=NR(n,t);return F2(i,t)}function Pr(n,e,t){t||(t="");var i=t+n;switch(e.type){case"base64":return zc(Hc(i));case"binary":return Hc(i);case"string":return n;case"file":return Jc(e.file,i,"utf8");case"buffer":return Tt?ba(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Pr(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function gM(n,e){switch(e.type){case"base64":return zc(n);case"binary":return n;case"string":return n;case"file":return Jc(e.file,n,"binary");case"buffer":return Tt?ba(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Od(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",i=0;i<n.length;++i)t+=String.fromCharCode(n[i]);return e.type=="base64"?zc(t):e.type=="string"?Ac(t):t;case"file":return Jc(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function z2(n,e){Vk(),tR(n);var t=Ci(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=z2(n,t);return t.type="array",xf(i)}var r=0;if(t.sheet&&(typeof t.sheet=="number"?r=t.sheet:r=n.SheetNames.indexOf(t.sheet),!n.SheetNames[r]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Pr(jR(n,t),t);case"slk":case"sylk":return Pr(J6.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"htm":case"html":return Pr(L2(n.Sheets[n.SheetNames[r]],t),t);case"txt":return gM(U2(n.Sheets[n.SheetNames[r]],t),t);case"csv":return Pr(cg(n.Sheets[n.SheetNames[r]],t),t,"\uFEFF");case"dif":return Pr(Q6.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"dbf":return Od(Z6.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"prn":return Pr(ej.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"rtf":return Pr(oj.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"eth":return Pr(c2.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"fods":return Pr(B2(n,t),t);case"wk1":return Od(Wx.sheet_to_wk1(n.Sheets[n.SheetNames[r]],t),t);case"wk3":return Od(Wx.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Od(M2(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),pM(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hM(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function vM(n,e,t,i,r,s,l,u){var f=Vn(t),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,y=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!l||n[t])for(var S=e.s.c;S<=e.e.c;++S){var _=l?n[t][S]:n[i[S]+f];if(_===void 0||_.t===void 0){if(m===void 0)continue;s[S]!=null&&(y[s[S]]=m);continue}var b=_.v;switch(_.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(s[S]!=null){if(b==null)if(_.t=="e"&&b===null)y[s[S]]=null;else if(m!==void 0)y[s[S]]=m;else if(p&&b===null)y[s[S]]=null;else continue;else y[s[S]]=p&&(_.t!=="n"||_.t==="n"&&u.rawNumbers!==!1)?b:ya(_,b,u);b!=null&&(v=!1)}}return{row:y,isempty:v}}function uf(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},i=0,r=1,s=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},p=m.range!=null?m.range:n["!ref"];switch(m.header===1?i=1:m.header==="A"?i=2:Array.isArray(m.header)?i=3:m.header==null&&(i=0),typeof p){case"string":f=Gt(p);break;case"number":f=Gt(n["!ref"]),f.s.r=p;break;default:f=p}i>0&&(r=0);var v=Vn(f.s.r),y=[],S=[],_=0,b=0,T=Array.isArray(n),E=f.s.r,w=0,C={};T&&!n[E]&&(n[E]=[]);var j=m.skipHidden&&n["!cols"]||[],k=m.skipHidden&&n["!rows"]||[];for(w=f.s.c;w<=f.e.c;++w)if(!(j[w]||{}).hidden)switch(y[w]=Qn(w),t=T?n[E][w]:n[y[w]+v],i){case 1:s[w]=w-f.s.c;break;case 2:s[w]=y[w];break;case 3:s[w]=m.header[w-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=l=ya(t,null,m),b=C[l]||0,!b)C[l]=1;else{do u=l+"_"+b++;while(C[u]);C[l]=b,C[u]=1}s[w]=u}for(E=f.s.r+r;E<=f.e.r;++E)if(!(k[E]||{}).hidden){var P=vM(n,f,E,y,i,s,T,m);(P.isempty===!1||(i===1?m.blankrows!==!1:m.blankrows))&&(S[_++]=P.row)}return S.length=_,S}var Zx=/"/g;function yM(n,e,t,i,r,s,l,u){for(var f=!0,m=[],p="",v=Vn(t),y=e.s.c;y<=e.e.c;++y)if(i[y]){var S=u.dense?(n[t]||[])[y]:n[i[y]+v];if(S==null)p="";else if(S.v!=null){f=!1,p=""+(u.rawNumbers&&S.t=="n"?S.v:ya(S,null,u));for(var _=0,b=0;_!==p.length;++_)if((b=p.charCodeAt(_))===r||b===s||b===34||u.forceQuotes){p='"'+p.replace(Zx,'""')+'"';break}p=="ID"&&(p='"ID"')}else S.f!=null&&!S.F?(f=!1,p="="+S.f,p.indexOf(",")>=0&&(p='"'+p.replace(Zx,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&f?null:m.join(l)}function cg(n,e){var t=[],i=e??{};if(n==null||n["!ref"]==null)return"";var r=Gt(n["!ref"]),s=i.FS!==void 0?i.FS:",",l=s.charCodeAt(0),u=i.RS!==void 0?i.RS:`
`,f=u.charCodeAt(0),m=new RegExp((s=="|"?"\\|":s)+"+$"),p="",v=[];i.dense=Array.isArray(n);for(var y=i.skipHidden&&n["!cols"]||[],S=i.skipHidden&&n["!rows"]||[],_=r.s.c;_<=r.e.c;++_)(y[_]||{}).hidden||(v[_]=Qn(_));for(var b=0,T=r.s.r;T<=r.e.r;++T)(S[T]||{}).hidden||(p=yM(n,r,T,v,l,f,s,i),p!=null&&(i.strip&&(p=p.replace(m,"")),(p||i.blankrows!==!1)&&t.push((b++?u:"")+p)));return delete i.dense,t.join("")}function U2(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=cg(n,e);return t}function xM(n){var e="",t,i="";if(n==null||n["!ref"]==null)return[];var r=Gt(n["!ref"]),s="",l=[],u,f=[],m=Array.isArray(n);for(u=r.s.c;u<=r.e.c;++u)l[u]=Qn(u);for(var p=r.s.r;p<=r.e.r;++p)for(s=Vn(p),u=r.s.c;u<=r.e.c;++u)if(e=l[u]+s,t=m?(n[p]||[])[u]:n[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}f[f.length]=e+"="+i}return f}function H2(n,e,t){var i=t||{},r=+!i.skipHeader,s=n||{},l=0,u=0;if(s&&i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?On(i.origin):i.origin;l=f.r,u=f.c}var m,p={s:{c:0,r:0},e:{c:u,r:l+e.length-1+r}};if(s["!ref"]){var v=Gt(s["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+e.length-1+r)}else l==-1&&(l=0,p.e.r=e.length-1+r);var y=i.header||[],S=0;e.forEach(function(b,T){Gn(b).forEach(function(E){(S=y.indexOf(E))==-1&&(y[S=y.length]=E);var w=b[E],C="z",j="",k=Ot({c:u+S,r:l+T+r});m=Gc(s,k),w&&typeof w=="object"&&!(w instanceof Date)?s[k]=w:(typeof w=="number"?C="n":typeof w=="boolean"?C="b":typeof w=="string"?C="s":w instanceof Date?(C="d",i.cellDates||(C="n",w=ki(w)),j=i.dateNF||on[14]):w===null&&i.nullError&&(C="e",w=0),m?(m.t=C,m.v=w,delete m.w,delete m.R,j&&(m.z=j)):s[k]=m={t:C,v:w},j&&(m.z=j))})}),p.e.c=Math.max(p.e.c,u+y.length-1);var _=Vn(l);if(r)for(S=0;S<y.length;++S)s[Qn(S+u)+_]={t:"s",v:y[S]};return s["!ref"]=vn(p),s}function bM(n,e){return H2(null,n,e)}function Gc(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var i=On(e);return n[i.r]||(n[i.r]=[]),n[i.r][i.c]||(n[i.r][i.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Gc(n,Ot(e)):Gc(n,Ot({r:e,c:t||0}))}function SM(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function _M(){return{SheetNames:[],Sheets:{}}}function TM(n,e,t,i){var r=1;if(!t)for(;r<=65535&&n.SheetNames.indexOf(t="Sheet"+r)!=-1;++r,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);r=s&&+s[2]||0;var l=s&&s[1]||t;for(++r;r<=65535&&n.SheetNames.indexOf(t=l+r)!=-1;++r);}if(N2(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function wM(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=SM(n,e);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[i].Hidden=t}function EM(n,e){return n.z=e,n}function W2(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function AM(n,e,t){return W2(n,"#"+e,t)}function kM(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function CM(n,e,t,i){for(var r=typeof e!="string"?e:Gt(e),s=typeof e=="string"?e:vn(e),l=r.s.r;l<=r.e.r;++l)for(var u=r.s.c;u<=r.e.c;++u){var f=Gc(n,l,u);f.t="n",f.F=s,delete f.v,l==r.s.r&&u==r.s.c&&(f.f=t,i&&(f.D=!0))}return n}var Fn={encode_col:Qn,encode_row:Vn,encode_cell:Ot,encode_range:vn,decode_col:Jp,decode_row:Zp,split_cell:VC,decode_cell:On,decode_range:Vi,format_cell:ya,sheet_add_aoa:WS,sheet_add_json:H2,sheet_add_dom:I2,aoa_to_sheet:sl,json_to_sheet:bM,table_to_sheet:P2,table_to_book:QR,sheet_to_csv:cg,sheet_to_txt:U2,sheet_to_json:uf,sheet_to_html:L2,sheet_to_formulae:xM,sheet_to_row_object_array:uf,sheet_get_cell:Gc,book_new:_M,book_append_sheet:TM,book_set_sheet_visibility:wM,cell_set_number_format:EM,cell_set_hyperlink:W2,cell_set_internal_link:AM,cell_add_comment:kM,sheet_set_array_formula:CM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class jM{async exportReport(e,t,i,r,s){const l=Fn.book_new();if(s.includeSummary){const p=this.createSummarySheet(e,s);Fn.book_append_sheet(l,p,"Summary")}if(s.includeDetailedData){const p=this.createDetailedDataSheet(t,i,r);Fn.book_append_sheet(l,p,"Time Entries")}const u=this.createProjectsSheet(e,i);if(Fn.book_append_sheet(l,u,"Project Analysis"),s.includeTrends){const p=this.createTrendsSheet(e);Fn.book_append_sheet(l,p,"Daily Trends")}if(e.topClients&&e.topClients.length>0){const p=this.createClientsSheet(e);Fn.book_append_sheet(l,p,"Client Analysis")}const f=this.createEfficiencySheet(e);Fn.book_append_sheet(l,f,"Efficiency");const m=z2(l,{bookType:"xlsx",type:"array",cellStyles:!0});return new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}createSummarySheet(e,t){const i=[["TimeBeacon Analytics Report"],["Generated on:",new Date().toLocaleDateString()],["Report Period:",`${t.dateFormat||"Custom Range"}`],["Generated by:",t.generatedBy||"TimeBeacon User"],[],[" KEY METRICS"],["Metric","Value","Status"],["Total Hours Tracked",e.totalHours.toFixed(2),this.getStatusIndicator(e.totalHours,40,"hours")],["Billable Hours",e.billableHours.toFixed(2),this.getStatusIndicator(e.billableHours,30,"hours")],["Non-Billable Hours",e.nonBillableHours.toFixed(2),""],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`,this.getStatusIndicator(e.utilizationRate,75,"percentage")],["Productivity Score",`${e.productivityScore.toFixed(1)}%`,this.getStatusIndicator(e.productivityScore,80,"percentage")],["Average Session Length",`${e.averageSessionLength.toFixed(1)} min`,this.getStatusIndicator(e.averageSessionLength,120,"minutes")],["Total Sessions",e.totalSessions.toString(),""],[],[" TOP PROJECTS (by hours)"],["Rank","Project Name","Hours","Percentage"],...e.topProjects.slice(0,10).map((s,l)=>[l+1,s.name,s.hours.toFixed(2),`${s.percentage.toFixed(1)}%`]),[],[" PERFORMANCE INDICATORS"],["Indicator","Current","Target","Status"],["Daily Average Hours",(e.totalHours/30).toFixed(1),"8.0",this.getPerformanceStatus(e.totalHours/30,8)],["Consistency Score",(e.productivityScore/100).toFixed(2),"0.85",this.getPerformanceStatus(e.productivityScore/100,.85)],["Project Focus",e.topProjects.length>0?e.topProjects[0].percentage.toFixed(1)+"%":"0%","60%",""]],r=Fn.aoa_to_sheet(i);return this.applyBasicFormatting(r),r["!cols"]=[{width:25},{width:15},{width:12},{width:12}],r}createDetailedDataSheet(e,t,i){const r=["Date","Project","Client","Description","Start Time","End Time","Duration (hours)","Billable","Hourly Rate","Earnings","Status","Category","Tags"],s=[r,...e.map(u=>{const f=t.find(y=>y.id===u.projectId),m=i.find(y=>y.id===u.clientId),p=(u.duration||0)/60,v=p*(u.hourlyRate||0);return[new Date(u.date).toLocaleDateString(),f?.name||"Unknown Project",m?.name||"No Client",u.description||"",u.startTime||"",u.endTime||"",p.toFixed(2),u.billable?"Yes":"No",u.hourlyRate?.toFixed(2)||"0.00",v.toFixed(2),u.status||"Pending",f?.category||"",u.tags?.join(", ")||""]})],l=Fn.aoa_to_sheet(s);return this.applyTableFormatting(l,r.length),l["!cols"]=[{width:12},{width:20},{width:18},{width:30},{width:10},{width:10},{width:12},{width:10},{width:12},{width:12},{width:12},{width:15},{width:20}],l}createProjectsSheet(e,t){const i=[["Project Performance Analysis"],["Generated on:",new Date().toLocaleDateString()],[],[" PROJECT SUMMARY"],["Project Name","Hours Logged","Percentage","Status","Budget Used"],...e.topProjects.map(s=>{const l=t.find(f=>f.name===s.name),u=l?.budget?(s.hours*(l.hourlyRate||50)/l.budget*100).toFixed(1)+"%":"No Budget";return[s.name,s.hours.toFixed(2),`${s.percentage.toFixed(1)}%`,this.getProjectStatus(s.percentage),u]}),[],[" EFFICIENCY ANALYSIS"],["Project","Planned Hours","Actual Hours","Efficiency %","Variance"],...e.projectEfficiency.map(s=>[s.project,s.plannedHours.toFixed(1),s.actualHours.toFixed(1),`${s.efficiency.toFixed(1)}%`,(s.plannedHours-s.actualHours).toFixed(1)])],r=Fn.aoa_to_sheet(i);return this.applyBasicFormatting(r),r["!cols"]=[{width:25},{width:15},{width:12},{width:15},{width:15}],r}createTrendsSheet(e){const t=[["Daily Productivity Trends"],["Analysis Period:",`${e.dailyTrends.length} days`],[],["Date","Hours Tracked","Sessions","Avg Session Length","Productivity Index"],...e.dailyTrends.map(r=>{const s=r.sessions>0?r.hours*60/r.sessions:0,l=this.calculateDailyProductivityIndex(r.hours,r.sessions);return[r.date,r.hours.toFixed(2),r.sessions.toString(),`${s.toFixed(1)} min`,l.toFixed(1)]}),[],[" TREND SUMMARY"],["Metric","Average","Best Day","Lowest Day"],["Daily Hours",(e.dailyTrends.reduce((r,s)=>r+s.hours,0)/e.dailyTrends.length).toFixed(2),Math.max(...e.dailyTrends.map(r=>r.hours)).toFixed(2),Math.min(...e.dailyTrends.map(r=>r.hours)).toFixed(2)],["Daily Sessions",(e.dailyTrends.reduce((r,s)=>r+s.sessions,0)/e.dailyTrends.length).toFixed(1),Math.max(...e.dailyTrends.map(r=>r.sessions)).toString(),Math.min(...e.dailyTrends.map(r=>r.sessions)).toString()]],i=Fn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:12},{width:15},{width:12},{width:18},{width:16}],i}createClientsSheet(e){const t=[["Client Performance Analysis"],[],[" CLIENT METRICS"],["Client Name","Hours Logged","Revenue Generated","Avg Hourly Rate","Projects"],...e.topClients.map(r=>[r.name,r.hours.toFixed(2),`$${r.revenue.toFixed(2)}`,r.hours>0?`$${(r.revenue/r.hours).toFixed(2)}`:"$0.00","1"]),[],[" REVENUE BREAKDOWN"],["Revenue Tier","Client Count","Total Revenue","Percentage"],...this.analyzeRevenueDistribution(e.topClients)],i=Fn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:25},{width:15},{width:18},{width:16},{width:12}],i}createEfficiencySheet(e){const t=[["Efficiency & Performance Analysis"],[],[" EFFICIENCY METRICS"],["Project","Planned Hours","Actual Hours","Efficiency %","Time Variance","Status"],...e.projectEfficiency.map(r=>[r.project,r.plannedHours.toFixed(1),r.actualHours.toFixed(1),`${r.efficiency.toFixed(1)}%`,`${(r.plannedHours-r.actualHours).toFixed(1)}h`,this.getEfficiencyStatus(r.efficiency)]),[],[" PRODUCTIVITY RECOMMENDATIONS"],["Area","Current Score","Target","Action Required"],["Session Management",`${e.averageSessionLength.toFixed(0)} min avg`,"90-120 min",e.averageSessionLength<90?"Increase focus time":"Optimal"],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`,">75%",e.utilizationRate<75?"Increase billable work":"Excellent"],["Project Focus",`${e.topProjects.length} active`,"<5 active",e.topProjects.length>5?"Reduce project count":"Good focus"]],i=Fn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:20},{width:15},{width:15},{width:12},{width:15},{width:20}],i}getStatusIndicator(e,t,i){const r=e/t;return r>=1?" Excellent":r>=.8?" Good":r>=.6?" Fair":" Needs Improvement"}getPerformanceStatus(e,t){const i=e/t;return i>=1?" Target Met":i>=.9?" Close":" Below Target"}getProjectStatus(e){return e>=30?"Primary Focus":e>=15?"Active":e>=5?"Minor":"Minimal"}getEfficiencyStatus(e){return e>=100?" On/Under Budget":e>=80?" Slight Overrun":" Over Budget"}calculateDailyProductivityIndex(e,t){const i=Math.min(e/8*100,100),r=t>0?Math.min(e*60/t/120*100,100):0;return i*.6+r*.4}analyzeRevenueDistribution(e){const t=[{name:"High Value (>$1000)",min:1e3,count:0,revenue:0},{name:"Medium Value ($500-$1000)",min:500,count:0,revenue:0},{name:"Low Value (<$500)",min:0,count:0,revenue:0}],i=e.reduce((r,s)=>r+s.revenue,0);return e.forEach(r=>{r.revenue>=1e3?(t[0].count++,t[0].revenue+=r.revenue):r.revenue>=500?(t[1].count++,t[1].revenue+=r.revenue):(t[2].count++,t[2].revenue+=r.revenue)}),t.map(r=>[r.name,r.count.toString(),`$${r.revenue.toFixed(2)}`,i>0?`${(r.revenue/i*100).toFixed(1)}%`:"0%"])}applyBasicFormatting(e){if(!e["!ref"])return;const t=Fn.decode_range(e["!ref"]);for(let i=t.s.r;i<=Math.min(t.s.r+3,t.e.r);i++)for(let r=t.s.c;r<=t.e.c;r++){const s=e[Fn.encode_cell({r:i,c:r})];s&&(s.s={font:{bold:!0}})}}applyTableFormatting(e,t){if(!e["!ref"])return;const i=Fn.decode_range(e["!ref"]);for(let r=i.s.c;r<t;r++){const s=e[Fn.encode_cell({r:0,c:r})];s&&(s.s={font:{bold:!0},fill:{fgColor:{rgb:"E5E5E5"}}})}}}const DM=new jM;class NM{generateAdvancedMetrics(e,t,i,r){const s=this.filterEntriesByDateRange(e,r),l=this.calculateTotalHours(s),u=this.calculateBillableHours(s),f=l-u,m=l>0?u/l*100:0,p=this.calculateProductivityScore(s),v=this.calculateAverageSessionLength(s),y=this.countUniqueSessions(s),S=this.getTopProjects(s,t),_=this.getTopClients(s,i),b=this.getDailyTrends(s,r),T=this.getWeeklyComparison(e,r),E=this.getProjectEfficiency(s,t);return{totalHours:l,billableHours:u,nonBillableHours:f,utilizationRate:m,productivityScore:p,averageSessionLength:v,totalSessions:y,topProjects:S,topClients:_,dailyTrends:b,weeklyComparison:T,projectEfficiency:E}}generateAdvancedCharts(e){return[{type:"doughnut",title:"Time Distribution",interactive:!0,drilldown:!0,data:{labels:["Billable Hours","Non-Billable Hours"],datasets:[{data:[e.billableHours,e.nonBillableHours],backgroundColor:["#10B981","#F59E0B"],borderWidth:0,hoverBorderWidth:2}]},options:{responsive:!0,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:t=>{const i=(t.parsed/e.totalHours*100).toFixed(1);return`${t.label}: ${t.parsed.toFixed(1)}h (${i}%)`}}}}}},{type:"line",title:"Daily Productivity Trends",interactive:!0,data:{labels:e.dailyTrends.map(t=>t.date),datasets:[{label:"Hours Tracked",data:e.dailyTrends.map(t=>t.hours),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4},{label:"Sessions",data:e.dailyTrends.map(t=>t.sessions),borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!1,yAxisID:"y1"}]},options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Hours"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Sessions"},grid:{drawOnChartArea:!1}}},plugins:{zoom:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0}},pan:{enabled:!0}}}}},{type:"bar",title:"Top Projects by Hours",interactive:!0,drilldown:!0,data:{labels:e.topProjects.map(t=>t.name),datasets:[{label:"Hours",data:e.topProjects.map(t=>t.hours),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#6366F1"],borderRadius:4}]},options:{responsive:!0,plugins:{tooltip:{callbacks:{afterLabel:t=>`${e.topProjects[t.dataIndex].percentage.toFixed(1)}% of total time`}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}},{type:"radar",title:"Project Efficiency Analysis",interactive:!0,data:{labels:e.projectEfficiency.map(t=>t.project),datasets:[{label:"Efficiency Score",data:e.projectEfficiency.map(t=>t.efficiency),backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"#3B82F6",pointBackgroundColor:"#3B82F6",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"#3B82F6"}]},options:{responsive:!0,scales:{r:{beginAtZero:!0,max:120,ticks:{stepSize:20,callback:t=>`${t}%`}}}}},{type:"bar",title:"Year-over-Year Comparison",interactive:!0,data:{labels:e.weeklyComparison.map(t=>t.week),datasets:[{label:"Current Year",data:e.weeklyComparison.map(t=>t.currentYear),backgroundColor:"#10B981"},{label:"Previous Year",data:e.weeklyComparison.map(t=>t.previousYear),backgroundColor:"#6B7280"}]},options:{responsive:!0,plugins:{tooltip:{callbacks:{afterBody:t=>{const i=t[0]?.parsed?.y||0,r=t[1]?.parsed?.y||0;return[`Change: ${r>0?((i-r)/r*100).toFixed(1):"N/A"}%`]}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}}]}async exportToExcel(e,t,i,r,s){return DM.exportReport(e,t,i,r,{includeCharts:s.includeCharts,includeSummary:!0,includeDetailedData:!0,includeTrends:!0,dateFormat:s.dateFormat||"Custom Range",reportTitle:"TimeBeacon Analytics Report",generatedBy:"TimeBeacon User"})}async exportToPDF(e,t,i){const r=this.generatePDFContent(e,t,i);return new Blob([r],{type:"text/html"})}subscribeToRealtimeUpdates(e,t=6e4){const i=setInterval(()=>{e({})},t);return()=>clearInterval(i)}scheduleReport(e){const t=crypto.randomUUID(),i=JSON.parse(localStorage.getItem("report_schedules")||"[]");return i.push({id:t,...e,createdAt:new Date().toISOString(),lastRun:null,nextRun:this.calculateNextRun(e.frequency,e.time)}),localStorage.setItem("report_schedules",JSON.stringify(i)),t}filterEntriesByDateRange(e,t){return e.filter(i=>{const r=new Date(i.date);return r>=t.start&&r<=t.end})}calculateTotalHours(e){return e.reduce((t,i)=>t+(i.duration||0),0)/60}calculateBillableHours(e){return e.filter(t=>t.billable).reduce((t,i)=>t+(i.duration||0),0)/60}calculateProductivityScore(e){const t=this.countUniqueSessions(e),i=this.calculateAverageSessionLength(e),r=this.calculateConsistencyScore(e),s=Math.min(t/8*100,100),l=Math.min(i/120*100,100),u=r*100;return s*.3+l*.4+u*.3}calculateAverageSessionLength(e){return e.length===0?0:e.reduce((i,r)=>i+(r.duration||0),0)/e.length}countUniqueSessions(e){const t=new Set;return e.forEach(i=>{const r=`${i.date}-${i.projectId}`;t.add(r)}),t.size}calculateConsistencyScore(e){const t=new Map;e.forEach(u=>{const f=u.date.split("T")[0],m=(u.duration||0)/60;t.set(f,(t.get(f)||0)+m)});const i=Array.from(t.values());if(i.length<2)return 1;const r=i.reduce((u,f)=>u+f,0)/i.length,s=i.reduce((u,f)=>u+Math.pow(f-r,2),0)/i.length,l=Math.sqrt(s);return Math.max(0,1-l/r)}getTopProjects(e,t){const i=new Map,r=this.calculateTotalHours(e);return e.forEach(s=>{const l=(s.duration||0)/60;i.set(s.projectId,(i.get(s.projectId)||0)+l)}),Array.from(i.entries()).map(([s,l])=>({name:t.find(f=>f.id===s)?.name||"Unknown Project",hours:l,percentage:l/r*100})).sort((s,l)=>l.hours-s.hours).slice(0,10)}getTopClients(e,t){const i=new Map;return e.forEach(r=>{if(r.clientId){const s=(r.duration||0)/60,l=s*(r.hourlyRate||0),u=i.get(r.clientId)||{hours:0,revenue:0};i.set(r.clientId,{hours:u.hours+s,revenue:u.revenue+l})}}),Array.from(i.entries()).map(([r,s])=>({name:t.find(u=>u.id===r)?.name||"Unknown Client",...s})).sort((r,s)=>s.hours-r.hours).slice(0,10)}getDailyTrends(e,t){const i=new Map,r=new Date(t.start);for(;r<=t.end;){const s=r.toISOString().split("T")[0];i.set(s,{hours:0,sessions:new Set}),r.setDate(r.getDate()+1)}return e.forEach(s=>{const l=s.date.split("T")[0],u=i.get(l);u&&(u.hours+=(s.duration||0)/60,u.sessions.add(`${s.projectId}-${s.startTime}`))}),Array.from(i.entries()).map(([s,l])=>({date:s,hours:l.hours,sessions:l.sessions.size})).sort((s,l)=>s.date.localeCompare(l.date))}getWeeklyComparison(e,t){return[{week:"Week 1",currentYear:40,previousYear:35},{week:"Week 2",currentYear:42,previousYear:38},{week:"Week 3",currentYear:38,previousYear:40},{week:"Week 4",currentYear:45,previousYear:42}]}getProjectEfficiency(e,t){const i=new Map;return e.forEach(r=>{const s=(r.duration||0)/60;i.set(r.projectId,(i.get(r.projectId)||0)+s)}),Array.from(i.entries()).map(([r,s])=>{const l=t.find(m=>m.id===r),u=l?.estimatedHours||s*1.2,f=u>0?u/s*100:100;return{project:l?.name||"Unknown Project",plannedHours:u,actualHours:s,efficiency:Math.min(f,150)}}).slice(0,10)}generatePDFContent(e,t,i){return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>TimeBeacon Report</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; margin-bottom: 30px; }
          .metric { display: inline-block; margin: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
          .chart-container { margin: 20px 0; page-break-inside: avoid; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>TimeBeacon Analytics Report</h1>
          <p>Generated on ${new Date().toLocaleDateString()}</p>
        </div>
        
        <div class="metrics-summary">
          <div class="metric">
            <h3>Total Hours</h3>
            <p>${e.totalHours.toFixed(2)}</p>
          </div>
          <div class="metric">
            <h3>Utilization Rate</h3>
            <p>${e.utilizationRate.toFixed(1)}%</p>
          </div>
          <div class="metric">
            <h3>Productivity Score</h3>
            <p>${e.productivityScore.toFixed(1)}%</p>
          </div>
        </div>

        <div class="top-projects">
          <h2>Top Projects</h2>
          <table>
            <tr><th>Project</th><th>Hours</th><th>Percentage</th></tr>
            ${e.topProjects.map(r=>`<tr><td>${r.name}</td><td>${r.hours.toFixed(2)}</td><td>${r.percentage.toFixed(1)}%</td></tr>`).join("")}
          </table>
        </div>
      </body>
      </html>
    `}calculateNextRun(e,t){const i=new Date,r=new Date(i);switch(e){case"daily":r.setDate(i.getDate()+1);break;case"weekly":r.setDate(i.getDate()+7);break;case"monthly":r.setMonth(i.getMonth()+1);break}if(t){const[s,l]=t.split(":").map(Number);r.setHours(s,l,0,0)}return r}}const Rd=new NM;gf.register(mk,gk,X5,U5,H5,N5,Dk,nk,uk,ek);const OM=()=>{const{user:n,checkPermission:e}=Xc(),{timeEntries:t,projects:i,clients:r}=cS(),[s,l]=H.useState({dateRange:{start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0],preset:"month"},selectedProjects:[],selectedClients:[],selectedTeamMembers:[],reportType:"overview"}),[u,f]=H.useState([]),[m,p]=H.useState(!1),[v,y]=H.useState("pdf"),S=H.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||n.role==="manager"||e("reports","read")),[n,e]);H.useEffect(()=>{if(S){const k=[{id:"user-1",visitorId:"10001",email:"john.doe@company.com",name:"John Doe",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Developer",department:"Engineering"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10002",email:"jane.smith@company.com",name:"Jane Smith",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Designer",department:"Design"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1}];f(k)}},[S,n]);const _=H.useMemo(()=>{let k=t;const P=new Date(s.dateRange.start),D=new Date(s.dateRange.end);return k=k.filter(z=>{const R=new Date(z.date);return R>=P&&R<=D}),s.selectedProjects.length>0&&(k=k.filter(z=>s.selectedProjects.includes(z.project))),s.selectedClients.length>0&&(k=k.filter(z=>z.client&&s.selectedClients.includes(z.client))),S&&s.selectedTeamMembers.length>0?k=k.filter(z=>s.selectedTeamMembers.includes(z.userId||n?.id||"")):S||(k=k.filter(z=>z.userId===n?.id)),k},[t,s,S,n]),b=H.useMemo(()=>{const k={start:new Date(s.dateRange.start),end:new Date(s.dateRange.end)};return Rd.generateAdvancedMetrics(_,i,r,k)},[_,i,r,s.dateRange]),T=H.useMemo(()=>Rd.generateAdvancedCharts(b),[b]),E=k=>{const P=new Date;let D=new Date,z=new Date;switch(k){case"today":D=new Date(P),z=new Date(P);break;case"week":D=new Date(P.getTime()-7*24*60*60*1e3);break;case"month":D=new Date(P.getFullYear(),P.getMonth(),1);break;case"quarter":const R=Math.floor(P.getMonth()/3);D=new Date(P.getFullYear(),R*3,1);break;case"year":D=new Date(P.getFullYear(),0,1);break;default:return}l(R=>({...R,dateRange:{start:D.toISOString().split("T")[0],end:z.toISOString().split("T")[0],preset:k}}))},w=async k=>{p(!0);try{let P,D;switch(k){case"pdf":P=await Rd.exportToPDF(b,T,{format:"pdf",includeCharts:!0,template:"detailed"}),D=`timebeacon-report-${s.dateRange.start}-to-${s.dateRange.end}.pdf`;break;case"excel":P=await Rd.exportToExcel(b,_,i,r,{format:"xlsx",includeCharts:!0,template:"detailed"}),D=`timebeacon-report-${s.dateRange.start}-to-${s.dateRange.end}.xlsx`;break;case"png":P=await C(),D=`timebeacon-charts-${s.dateRange.start}-to-${s.dateRange.end}.zip`;break;default:throw new Error("Unsupported export format")}const z=URL.createObjectURL(P),R=document.createElement("a");R.href=z,R.download=D,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(z)}catch(P){console.error("Export failed:",P),alert("Export failed. Please try again.")}finally{p(!1)}},C=async()=>{const k=JSON.stringify({message:"Chart images would be here"});return new Blob([k],{type:"application/json"})},j=(k,P)=>{const D={data:k.data,options:{...k.options,responsive:!0,maintainAspectRatio:!1}};switch(k.type){case"doughnut":return d.jsx(Uk,{...D},P);case"line":return d.jsx(Bk,{...D},P);case"bar":return d.jsx(Fk,{...D},P);case"radar":return d.jsx(zk,{...D},P);default:return d.jsx("div",{children:"Unsupported chart type"},P)}};return d.jsxs("div",{className:"enhanced-reports",children:[d.jsxs("div",{className:"reports-header",children:[d.jsx("h1",{children:"Analytics & Reports"}),d.jsx("p",{children:"Comprehensive analytics and insights for your time tracking data"})]}),d.jsxs("div",{className:"reports-filters",children:[d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Date Range"}),d.jsx("div",{className:"date-presets",children:["today","week","month","quarter","year"].map(k=>d.jsx("button",{className:`preset-button ${s.dateRange.preset===k?"active":""}`,onClick:()=>E(k),children:k.charAt(0).toUpperCase()+k.slice(1)},k))}),d.jsxs("div",{className:"custom-date-range",children:[d.jsx("input",{type:"date",value:s.dateRange.start,onChange:k=>l(P=>({...P,dateRange:{...P.dateRange,start:k.target.value,preset:"custom"}}))}),d.jsx("span",{children:"to"}),d.jsx("input",{type:"date",value:s.dateRange.end,onChange:k=>l(P=>({...P,dateRange:{...P.dateRange,end:k.target.value,preset:"custom"}}))})]})]}),S&&u.length>0&&d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Team Members"}),d.jsxs("div",{className:"team-member-filters",children:[d.jsx("button",{className:`filter-button ${s.selectedTeamMembers.length===0?"active":""}`,onClick:()=>l(k=>({...k,selectedTeamMembers:[]})),children:"All Team Members"}),u.map(k=>d.jsxs("button",{className:`filter-button ${s.selectedTeamMembers.includes(k.id)?"active":""}`,onClick:()=>{l(P=>({...P,selectedTeamMembers:P.selectedTeamMembers.includes(k.id)?P.selectedTeamMembers.filter(D=>D!==k.id):[...P.selectedTeamMembers,k.id]}))},children:[k.name," (",k.profile?.jobTitle,")"]},k.id))]})]}),d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Projects"}),d.jsxs("div",{className:"project-filters",children:[d.jsx("button",{className:`filter-button ${s.selectedProjects.length===0?"active":""}`,onClick:()=>l(k=>({...k,selectedProjects:[]})),children:"All Projects"}),i.slice(0,8).map(k=>d.jsx("button",{className:`filter-button ${s.selectedProjects.includes(k.id)?"active":""}`,onClick:()=>{l(P=>({...P,selectedProjects:P.selectedProjects.includes(k.id)?P.selectedProjects.filter(D=>D!==k.id):[...P.selectedProjects,k.id]}))},children:k.name},k.id))]})]}),d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Export Reports"}),d.jsxs("div",{className:"export-controls",children:[d.jsxs("select",{value:v,onChange:k=>y(k.target.value),children:[d.jsx("option",{value:"pdf",children:"PDF Report"}),d.jsx("option",{value:"excel",children:"Excel Spreadsheet"}),d.jsx("option",{value:"png",children:"Chart Images"})]}),d.jsx("button",{className:"export-button",onClick:()=>w(v),disabled:m,children:m?"Exporting...":"Export"})]})]})]}),d.jsxs("div",{className:"summary-cards",children:[d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Total Hours"}),d.jsxs("div",{className:"metric-value",children:[b.totalHours.toFixed(1),"h"]}),d.jsxs("div",{className:"metric-subtitle",children:[b.billableHours.toFixed(1),"h billable"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Utilization"}),d.jsxs("div",{className:"metric-value",children:[b.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"metric-subtitle",children:b.utilizationRate>=75?"Excellent":b.utilizationRate>=50?"Good":"Needs Improvement"})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Productivity"}),d.jsxs("div",{className:"metric-value",children:[b.productivityScore.toFixed(1),"%"]}),d.jsxs("div",{className:"metric-subtitle",children:[b.totalSessions," sessions tracked"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Top Project"}),d.jsx("div",{className:"metric-value",children:b.topProjects[0]?.name||"No data"}),d.jsxs("div",{className:"metric-subtitle",children:[b.topProjects[0]?.hours.toFixed(1),"h logged"]})]})]}),d.jsx("div",{className:"charts-grid",children:T.map((k,P)=>d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{children:k.title}),d.jsx("div",{className:"chart-wrapper",children:j(k,P)})]},P))}),d.jsxs("div",{className:"data-table-section",children:[d.jsx("h3",{children:"Detailed Time Entries"}),d.jsxs("div",{className:"table-container",children:[d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Duration"}),d.jsx("th",{children:"Billable"}),S&&d.jsx("th",{children:"Team Member"}),d.jsx("th",{children:"Status"})]})}),d.jsx("tbody",{children:_.slice(0,50).map((k,P)=>d.jsxs("tr",{children:[d.jsx("td",{children:new Date(k.date).toLocaleDateString()}),d.jsx("td",{children:i.find(D=>D.name===k.project)?.name||"Unknown"}),d.jsx("td",{children:k.description}),d.jsxs("td",{children:[((k.duration||0)/60).toFixed(1),"h"]}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${k.billable?"billable":"non-billable"}`,children:k.billable?"Billable":"Non-billable"})}),S&&d.jsx("td",{children:u.find(D=>D.id===k.userId)?.name||"You"}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${k.status||"pending"}`,children:k.status||"pending"})})]},P))})]}),_.length>50&&d.jsx("div",{className:"table-footer",children:d.jsx("p",{children:"Showing first 50 entries. Export for complete data."})})]})]}),d.jsx("style",{children:`
        .enhanced-reports {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }

        .reports-header {
          text-align: center;
          margin-bottom: 30px;
        }

        .reports-header h1 {
          font-size: 2.5rem;
          margin-bottom: 10px;
          color: #1f2937;
        }

        .reports-filters {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 30px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .filter-section {
          margin-bottom: 20px;
        }

        .filter-section h3 {
          margin-bottom: 10px;
          color: #374151;
          font-size: 1.1rem;
        }

        .date-presets, .team-member-filters, .project-filters {
          display: flex;
          gap: 8px;
          flex-wrap: wrap;
          margin-bottom: 10px;
        }

        .preset-button, .filter-button {
          padding: 8px 16px;
          border: 2px solid #e5e7eb;
          border-radius: 8px;
          background: white;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 0.9rem;
        }

        .preset-button:hover, .filter-button:hover {
          border-color: #3b82f6;
          background: #eff6ff;
        }

        .preset-button.active, .filter-button.active {
          background: #3b82f6;
          color: white;
          border-color: #3b82f6;
        }

        .custom-date-range {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-top: 10px;
        }

        .custom-date-range input {
          padding: 8px 12px;
          border: 1px solid #d1d5db;
          border-radius: 6px;
        }

        .export-controls {
          display: flex;
          gap: 10px;
          align-items: center;
        }

        .export-controls select {
          padding: 8px 12px;
          border: 1px solid #d1d5db;
          border-radius: 6px;
          background: white;
        }

        .export-button {
          padding: 8px 16px;
          background: #10b981;
          color: white;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          transition: background 0.2s;
        }

        .export-button:hover:not(:disabled) {
          background: #059669;
        }

        .export-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .summary-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .summary-card {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
          text-align: center;
        }

        .summary-card h3 {
          margin-bottom: 10px;
          color: #6b7280;
          font-size: 1rem;
        }

        .metric-value {
          font-size: 2rem;
          font-weight: bold;
          color: #1f2937;
          margin-bottom: 5px;
        }

        .metric-subtitle {
          color: #6b7280;
          font-size: 0.9rem;
        }

        .charts-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .chart-container {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .chart-container h3 {
          margin-bottom: 15px;
          color: #374151;
          text-align: center;
        }

        .chart-wrapper {
          height: 300px;
          position: relative;
        }

        .data-table-section {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .table-container {
          overflow-x: auto;
        }

        .data-table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
        }

        .data-table th,
        .data-table td {
          padding: 12px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .data-table th {
          background: #f9fafb;
          font-weight: 600;
          color: #374151;
        }

        .data-table tr:hover {
          background: #f9fafb;
        }

        .status-badge {
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 0.8rem;
          font-weight: 500;
        }

        .status-badge.billable {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.non-billable {
          background: #fef3c7;
          color: #92400e;
        }

        .status-badge.pending {
          background: #e0e7ff;
          color: #3730a3;
        }

        .status-badge.approved {
          background: #d1fae5;
          color: #065f46;
        }

        .table-footer {
          text-align: center;
          margin-top: 15px;
          color: #6b7280;
          font-style: italic;
        }

        @media (max-width: 768px) {
          .charts-grid {
            grid-template-columns: 1fr;
          }
          
          .summary-cards {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          }
          
          .date-presets, .team-member-filters, .project-filters {
            flex-direction: column;
          }
        }
      `})]})},RM=()=>{const{user:n,checkPermission:e}=Xc(),[t,i]=H.useState([]),[r,s]=H.useState(null),[l,u]=H.useState([]),[f,m]=H.useState([]),[p,v]=H.useState(!0),[y,S]=H.useState("roles"),_=H.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||e("users","manage")),[n,e]),b=H.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||n.role==="manager"||e("teams","manage")),[n,e]);H.useEffect(()=>{(_||b)&&T()},[_,b]);const T=async()=>{v(!0);try{const j=[{id:"user-1",visitorId:"10001",email:"john.doe@company.com",name:"John Doe",companyId:n?.companyId||"",role:"individual_contributor",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Senior Developer",department:"Engineering",manager:n?.id,accessLevel:"senior"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10002",email:"jane.smith@company.com",name:"Jane Smith",companyId:n?.companyId||"",role:"manager",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Engineering Manager",department:"Engineering",directReports:["user-1","user-3"],accessLevel:"elevated"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!0},{id:"user-3",visitorId:"10003",email:"mike.wilson@company.com",name:"Mike Wilson",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"Mike",lastName:"Wilson",jobTitle:"Junior Developer",department:"Engineering",manager:"user-2",accessLevel:"basic"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1}];i(j);const k=[{userId:"user-1",managerId:n?.id||"",department:"Engineering",startDate:"2024-01-01"},{userId:"user-3",managerId:"user-2",department:"Engineering",startDate:"2024-02-01"}];u(k);const P=[{id:"1",userId:"user-1",action:"granted",permission:"Project Lead Access",grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:"Promoted to Senior Developer"},{id:"2",userId:"user-2",action:"granted",permission:"Team Management",grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:"Assigned as Engineering Manager"}];m(P)}catch(j){console.error("Failed to load permissions data:",j)}finally{v(!1)}},E=async(j,k,P)=>{if(_)try{const D=t.find(W=>W.id===j);if(!D)return;const z={...D,role:k};i(W=>W.map(q=>q.id===j?z:q));const R={id:Date.now().toString(),userId:j,action:"modified",permission:`Role changed to ${Po[k].title}`,grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:P};m(W=>[R,...W]),console.log(` Updated ${D.name} role to ${k}`)}catch(D){console.error("Failed to update user role:",D)}},w=j=>[...vb[j.role]||[],...j.permissions],C=H.useMemo(()=>n?n.role==="owner"||n.role==="admin"?t:n.role==="manager"?t.filter(j=>j.profile?.manager===n.id):[]:[],[t,n]);return!_&&!b?d.jsx("div",{className:"permissions-manager",children:d.jsxs("div",{className:"access-denied",children:[d.jsx("h2",{children:"Access Denied"}),d.jsx("p",{children:"You don't have permission to manage user roles and permissions."})]})}):p?d.jsxs("div",{className:"permissions-manager loading",children:[d.jsx("div",{className:"loading-spinner"}),d.jsx("p",{children:"Loading permissions data..."})]}):d.jsxs("div",{className:"permissions-manager",children:[d.jsxs("div",{className:"permissions-header",children:[d.jsx("h1",{children:"Permissions & Team Management"}),d.jsx("p",{children:"Manage user roles, permissions, and team assignments"})]}),d.jsxs("div",{className:"permissions-tabs",children:[d.jsx("button",{className:`tab ${y==="roles"?"active":""}`,onClick:()=>S("roles"),children:"Roles & Users"}),d.jsx("button",{className:`tab ${y==="permissions"?"active":""}`,onClick:()=>S("permissions"),children:"Permissions"}),b&&d.jsx("button",{className:`tab ${y==="teams"?"active":""}`,onClick:()=>S("teams"),children:"Team Management"}),d.jsx("button",{className:`tab ${y==="audit"?"active":""}`,onClick:()=>S("audit"),children:"Audit Log"})]}),y==="roles"&&d.jsxs("div",{className:"roles-section",children:[d.jsx("h2",{children:"User Roles"}),d.jsxs("div",{className:"role-hierarchy",children:[d.jsx("h3",{children:"Role Hierarchy"}),d.jsx("div",{className:"role-cards",children:Object.entries(Po).sort(([,j],[,k])=>k.level-j.level).map(([j,k])=>d.jsxs("div",{className:"role-card",children:[d.jsx("div",{className:"role-title",children:k.title}),d.jsxs("div",{className:"role-level",children:["Level ",k.level]}),d.jsx("div",{className:"role-description",children:k.description}),d.jsxs("div",{className:"role-count",children:[t.filter(P=>P.role===j).length," users"]})]},j))})]}),d.jsxs("div",{className:"users-list",children:[d.jsx("h3",{children:"Manage Users"}),d.jsx("div",{className:"users-table",children:d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Name"}),d.jsx("th",{children:"Email"}),d.jsx("th",{children:"Current Role"}),d.jsx("th",{children:"Department"}),d.jsx("th",{children:"Manager"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:C.map(j=>d.jsxs("tr",{children:[d.jsx("td",{children:d.jsxs("div",{className:"user-info",children:[d.jsx("strong",{children:j.name}),d.jsx("div",{className:"user-title",children:j.profile?.jobTitle})]})}),d.jsx("td",{children:j.email}),d.jsx("td",{children:d.jsx("span",{className:`role-badge ${j.role}`,children:Po[j.role].title})}),d.jsx("td",{children:j.profile?.department||"Unassigned"}),d.jsx("td",{children:j.profile?.manager?t.find(k=>k.id===j.profile?.manager)?.name||"Unknown":"None"}),d.jsx("td",{children:d.jsxs("div",{className:"user-actions",children:[d.jsx("select",{value:j.role,onChange:k=>E(j.id,k.target.value,"Role change via admin panel"),disabled:!_,children:Object.entries(Po).map(([k,P])=>d.jsx("option",{value:k,children:P.title},k))}),d.jsx("button",{className:"btn btn-sm",onClick:()=>s(j),children:"Details"})]})})]},j.id))})]})})]})]}),y==="permissions"&&d.jsxs("div",{className:"permissions-section",children:[d.jsx("h2",{children:"Detailed Permissions"}),r?d.jsxs("div",{className:"user-permissions",children:[d.jsxs("h3",{children:["Permissions for ",r.name]}),d.jsx("div",{className:"permission-categories",children:Object.entries(w(r).reduce((j,k)=>(j[k.resource]||(j[k.resource]=[]),j[k.resource].push(k),j),{})).map(([j,k])=>d.jsxs("div",{className:"permission-category",children:[d.jsx("h4",{children:j.charAt(0).toUpperCase()+j.slice(1)}),d.jsx("div",{className:"permission-actions",children:k.map((P,D)=>d.jsxs("div",{className:"permission-item",children:[d.jsx("div",{className:"permission-actions-list",children:P.actions.map(z=>d.jsx("span",{className:"action-badge",children:z},z))}),P.scope&&d.jsxs("div",{className:"permission-scope",children:["Scope: ",P.scope.all?"All":P.scope.own?"Own Data Only":P.scope.team?"Team Members":P.scope.department?"Department":"Limited"]})]},D))})]},j))}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>s(null),children:"Back to Users"})]}):d.jsx("div",{className:"select-user",children:d.jsx("p",{children:"Select a user from the Roles tab to view their detailed permissions."})})]}),y==="teams"&&b&&d.jsxs("div",{className:"teams-section",children:[d.jsx("h2",{children:"Team Assignments"}),d.jsxs("div",{className:"team-structure",children:[d.jsx("h3",{children:"Organizational Structure"}),d.jsx("div",{className:"org-chart",children:t.filter(j=>j.role==="manager"||j.role==="admin"||j.role==="owner").map(j=>d.jsxs("div",{className:"manager-group",children:[d.jsxs("div",{className:"manager-card",children:[d.jsx("h4",{children:j.name}),d.jsx("div",{className:"manager-role",children:Po[j.role].title}),d.jsx("div",{className:"manager-department",children:j.profile?.department})]}),d.jsx("div",{className:"direct-reports",children:t.filter(k=>k.profile?.manager===j.id).map(k=>d.jsxs("div",{className:"report-card",children:[d.jsx("div",{className:"report-name",children:k.name}),d.jsx("div",{className:"report-role",children:Po[k.role].title}),d.jsx("div",{className:"report-title",children:k.profile?.jobTitle})]},k.id))})]},j.id))})]}),d.jsxs("div",{className:"team-assignments",children:[d.jsx("h3",{children:"Team Assignments"}),d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Team Member"}),d.jsx("th",{children:"Manager"}),d.jsx("th",{children:"Department"}),d.jsx("th",{children:"Start Date"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:l.map(j=>{const k=t.find(D=>D.id===j.userId),P=t.find(D=>D.id===j.managerId);return d.jsxs("tr",{children:[d.jsx("td",{children:k?.name||"Unknown"}),d.jsx("td",{children:P?.name||"Unknown"}),d.jsx("td",{children:j.department}),d.jsx("td",{children:new Date(j.startDate).toLocaleDateString()}),d.jsx("td",{children:d.jsx("button",{className:"btn btn-sm btn-secondary",children:"Reassign"})})]},j.userId)})})]})]})]}),y==="audit"&&d.jsxs("div",{className:"audit-section",children:[d.jsx("h2",{children:"Permission Audit Log"}),d.jsx("div",{className:"audit-log",children:f.map(j=>d.jsxs("div",{className:"audit-entry",children:[d.jsxs("div",{className:"audit-header",children:[d.jsx("span",{className:`audit-action ${j.action}`,children:j.action.charAt(0).toUpperCase()+j.action.slice(1)}),d.jsx("span",{className:"audit-timestamp",children:new Date(j.timestamp).toLocaleString()})]}),d.jsxs("div",{className:"audit-details",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"User:"})," ",t.find(k=>k.id===j.userId)?.name||"Unknown"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Permission:"})," ",j.permission]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Changed by:"})," ",t.find(k=>k.id===j.grantedBy)?.name||"System"]}),j.reason&&d.jsxs("div",{children:[d.jsx("strong",{children:"Reason:"})," ",j.reason]})]})]},j.id))})]}),d.jsx("style",{children:`
        .permissions-manager {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }

        .permissions-header {
          text-align: center;
          margin-bottom: 30px;
        }

        .permissions-header h1 {
          font-size: 2.5rem;
          margin-bottom: 10px;
          color: #1f2937;
        }

        .permissions-tabs {
          display: flex;
          border-bottom: 2px solid #e5e7eb;
          margin-bottom: 30px;
        }

        .tab {
          padding: 12px 24px;
          border: none;
          background: none;
          cursor: pointer;
          border-bottom: 3px solid transparent;
          font-weight: 500;
          transition: all 0.2s;
        }

        .tab:hover {
          background: #f3f4f6;
        }

        .tab.active {
          border-bottom-color: #3b82f6;
          color: #3b82f6;
        }

        .role-hierarchy {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 30px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .role-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 15px;
        }

        .role-card {
          border: 2px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
          text-align: center;
          transition: all 0.2s;
        }

        .role-card:hover {
          border-color: #3b82f6;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }

        .role-title {
          font-size: 1.1rem;
          font-weight: 600;
          margin-bottom: 5px;
        }

        .role-level {
          font-size: 0.9rem;
          color: #6b7280;
          margin-bottom: 8px;
        }

        .role-description {
          font-size: 0.85rem;
          color: #374151;
          margin-bottom: 8px;
          line-height: 1.4;
        }

        .role-count {
          font-size: 0.8rem;
          color: #059669;
          font-weight: 500;
        }

        .users-list {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .users-table {
          overflow-x: auto;
        }

        .users-table table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
        }

        .users-table th,
        .users-table td {
          padding: 12px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f9fafb;
          font-weight: 600;
          color: #374151;
        }

        .user-info strong {
          display: block;
          margin-bottom: 4px;
        }

        .user-title {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 0.8rem;
          font-weight: 500;
        }

        .role-badge.owner { background: #fef3c7; color: #92400e; }
        .role-badge.admin { background: #ddd6fe; color: #5b21b6; }
        .role-badge.manager { background: #d1fae5; color: #065f46; }
        .role-badge.individual_contributor { background: #e0e7ff; color: #3730a3; }
        .role-badge.employee { background: #e5e7eb; color: #374151; }
        .role-badge.viewer { background: #f3f4f6; color: #6b7280; }

        .user-actions {
          display: flex;
          gap: 8px;
          align-items: center;
        }

        .user-actions select {
          padding: 4px 8px;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 0.8rem;
        }

        .btn {
          padding: 8px 16px;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          font-weight: 500;
          transition: all 0.2s;
        }

        .btn-sm {
          padding: 4px 8px;
          font-size: 0.8rem;
        }

        .btn-secondary {
          background: #6b7280;
          color: white;
        }

        .btn-secondary:hover {
          background: #4b5563;
        }

        .permission-categories {
          display: grid;
          gap: 20px;
        }

        .permission-category {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .permission-category h4 {
          margin-bottom: 10px;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
          padding-bottom: 5px;
        }

        .permission-item {
          margin-bottom: 10px;
        }

        .permission-actions-list {
          display: flex;
          gap: 6px;
          flex-wrap: wrap;
          margin-bottom: 5px;
        }

        .action-badge {
          padding: 2px 6px;
          background: #3b82f6;
          color: white;
          border-radius: 4px;
          font-size: 0.7rem;
        }

        .permission-scope {
          font-size: 0.8rem;
          color: #6b7280;
          font-style: italic;
        }

        .org-chart {
          display: flex;
          flex-direction: column;
          gap: 20px;
        }

        .manager-group {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .manager-card {
          background: #f8fafc;
          border-radius: 6px;
          padding: 12px;
          margin-bottom: 15px;
        }

        .manager-card h4 {
          margin-bottom: 5px;
        }

        .manager-role, .manager-department {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .direct-reports {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
          gap: 10px;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 10px;
        }

        .report-name {
          font-weight: 500;
          margin-bottom: 4px;
        }

        .report-role, .report-title {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .audit-log {
          display: flex;
          flex-direction: column;
          gap: 15px;
        }

        .audit-entry {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .audit-header {
          display: flex;
          justify-content: between;
          align-items: center;
          margin-bottom: 10px;
        }

        .audit-action {
          font-weight: 600;
          margin-right: 10px;
        }

        .audit-action.granted { color: #059669; }
        .audit-action.revoked { color: #dc2626; }
        .audit-action.modified { color: #d97706; }

        .audit-timestamp {
          font-size: 0.8rem;
          color: #6b7280;
          margin-left: auto;
        }

        .audit-details {
          display: grid;
          gap: 4px;
          font-size: 0.9rem;
        }

        .access-denied, .select-user {
          text-align: center;
          padding: 40px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .loading {
          text-align: center;
          padding: 40px;
        }

        .loading-spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top: 4px solid #3b82f6;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin: 0 auto 20px;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .role-cards {
            grid-template-columns: 1fr;
          }
          
          .permissions-tabs {
            flex-wrap: wrap;
          }
          
          .direct-reports {
            grid-template-columns: 1fr;
          }
        }
      `})]})},pc={name:"",email:"",company:"",jobTitle:"",phone:"",startTime:"09:00",endTime:"17:00",timezone:"America/New_York",browserNotifications:!1,emailNotifications:{enabled:!1,cadence:"daily",time:"17:00",weeklyDay:"friday"},slackNotifications:{enabled:!1,cadence:"realtime",channel:"",dailyTime:"17:00",weeklyDay:"friday",weeklyTime:"09:00"},autoBreaks:!1},MM=()=>{const[n,e]=H.useState(pc),[t,i]=H.useState(pc),[r,s]=H.useState(""),[l,u]=H.useState(!1);H.useEffect(()=>{try{const b=localStorage.getItem("timebeacon_settings_simplified");if(b){const T=JSON.parse(b),E={...pc,...T,emailNotifications:{...pc.emailNotifications,...T.emailNotifications||{}},slackNotifications:{...pc.slackNotifications,...T.slackNotifications||{}}};e(E),i(E)}}catch(b){console.error("Failed to load settings:",b)}},[]);const f=()=>{try{if(n.slackNotifications.enabled&&!n.slackNotifications.channel?.trim()){s("Error: Slack channel required!"),setTimeout(()=>s(""),4e3);return}s("Saving..."),localStorage.setItem("timebeacon_settings_simplified",JSON.stringify(n)),i(n),u(!1),s("Saved "),setTimeout(()=>s(""),3e3),console.log("Settings saved:",n)}catch(b){console.error("Save failed:",b),s("Save failed!"),setTimeout(()=>s(""),3e3)}},m=(b,T)=>{const E={...n,[b]:T};e(E),u(JSON.stringify(E)!==JSON.stringify(t))},p=()=>{try{const b=JSON.parse(localStorage.getItem("timebeacon_entries_v6")||"[]");if(b.length===0){alert("No time entries found");return}const T=["Date,Start Time,End Time,Duration,Project,Client,Description,Billable",...b.map(j=>`"${j.date}","${j.startTime}","${j.endTime}",${j.duration},"${j.project}","${j.client}","${j.description}",${j.billable?"Yes":"No"}`)].join("\\n"),E=new Blob([T],{type:"text/csv"}),w=URL.createObjectURL(E),C=document.createElement("a");C.href=w,C.download=`timebeacon-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(w),alert(`Exported ${b.length} entries!`)}catch{alert("Export failed!")}},v={width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px",backgroundColor:"white"},y={display:"block",marginBottom:"6px",fontWeight:"500",color:"#333"},S={backgroundColor:"white",border:"1px solid #e5e5e5",borderRadius:"8px",padding:"24px",marginBottom:"20px"},_={backgroundColor:l?"#3b82f6":"#94a3b8",color:"white",border:"none",borderRadius:"6px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:l?"pointer":"not-allowed",transition:"all 0.2s",minWidth:"120px"};return d.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"20px"},children:[d.jsxs("div",{style:{marginBottom:"32px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#111",marginBottom:"8px"},children:"Settings"}),d.jsx("p",{style:{color:"#666",fontSize:"16px"},children:"Configure your TimeBeacon preferences"})]}),d.jsx("button",{onClick:f,disabled:!l,style:_,children:r==="Saving..."?"Saving...":l?"Save Settings":"No Changes"})]}),l&&d.jsx("div",{style:{padding:"12px 16px",backgroundColor:"#fef3c7",color:"#92400e",borderRadius:"6px",fontSize:"14px",border:"1px solid #fcd34d",marginTop:"12px"},children:" You have unsaved changes"})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Profile Information"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Full Name"}),d.jsx("input",{type:"text",value:n.name,onChange:b=>m("name",b.target.value),placeholder:"Enter your name",style:v})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Email"}),d.jsx("input",{type:"email",value:n.email,onChange:b=>m("email",b.target.value),placeholder:"Enter your email",style:v})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Company"}),d.jsx("input",{type:"text",value:n.company,onChange:b=>m("company",b.target.value),placeholder:"Enter your company",style:v})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Job Title"}),d.jsx("input",{type:"text",value:n.jobTitle,onChange:b=>m("jobTitle",b.target.value),placeholder:"Enter your job title",style:v})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Phone"}),d.jsx("input",{type:"tel",value:n.phone,onChange:b=>m("phone",b.target.value),placeholder:"Enter your phone number",style:v})]})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Working Hours"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Start Time"}),d.jsx("input",{type:"time",value:n.startTime,onChange:b=>m("startTime",b.target.value),style:v})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"End Time"}),d.jsx("input",{type:"time",value:n.endTime,onChange:b=>m("endTime",b.target.value),style:v})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Timezone"}),d.jsxs("select",{value:n.timezone,onChange:b=>m("timezone",b.target.value),style:v,children:[d.jsx("option",{value:"America/New_York",children:"Eastern Time"}),d.jsx("option",{value:"America/Chicago",children:"Central Time"}),d.jsx("option",{value:"America/Denver",children:"Mountain Time"}),d.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),d.jsx("option",{value:"UTC",children:"UTC"})]})]})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Notifications"}),d.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"#f8fafc",borderRadius:"8px"},children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",marginBottom:"8px"},children:[d.jsx("input",{type:"checkbox",checked:n.browserNotifications,onChange:b=>m("browserNotifications",b.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"600",color:"#374151"},children:"Browser Notifications"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Get notified in your browser for time tracking reminders"})]})]})}),d.jsxs("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:n.emailNotifications.enabled?"#f0f9ff":"#f8fafc",borderRadius:"8px",border:n.emailNotifications.enabled?"2px solid #3b82f6":"1px solid #e2e8f0"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",marginBottom:"16px"},children:[d.jsx("input",{type:"checkbox",checked:n.emailNotifications.enabled,onChange:b=>m("emailNotifications",{...n.emailNotifications,enabled:b.target.checked}),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontWeight:"600",color:"#374151"},children:["Email Notifications",n.emailNotifications.enabled&&d.jsx("span",{style:{color:"#3b82f6",marginLeft:"8px"},children:" Enabled"})]}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Receive time tracking summaries and reminders via email"})]})]}),n.emailNotifications.enabled&&d.jsxs("div",{style:{marginTop:"16px"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Notification Frequency"}),d.jsxs("select",{value:n.emailNotifications.cadence,onChange:b=>m("emailNotifications",{...n.emailNotifications,cadence:b.target.value}),style:v,children:[d.jsx("option",{value:"realtime",children:"Real-time (immediate)"}),d.jsx("option",{value:"hourly",children:"Every hour"}),d.jsx("option",{value:"daily",children:"Daily digest"}),d.jsx("option",{value:"weekly",children:"Weekly summary"})]})]}),n.emailNotifications.cadence==="daily"&&d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Daily Email Time"}),d.jsx("input",{type:"time",value:n.emailNotifications.time||"17:00",onChange:b=>m("emailNotifications",{...n.emailNotifications,time:b.target.value}),style:v})]})]}),n.emailNotifications.cadence==="weekly"&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Day"}),d.jsxs("select",{value:n.emailNotifications.weeklyDay||"friday",onChange:b=>m("emailNotifications",{...n.emailNotifications,weeklyDay:b.target.value}),style:v,children:[d.jsx("option",{value:"monday",children:"Monday"}),d.jsx("option",{value:"tuesday",children:"Tuesday"}),d.jsx("option",{value:"wednesday",children:"Wednesday"}),d.jsx("option",{value:"thursday",children:"Thursday"}),d.jsx("option",{value:"friday",children:"Friday"}),d.jsx("option",{value:"saturday",children:"Saturday"}),d.jsx("option",{value:"sunday",children:"Sunday"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Email Time"}),d.jsx("input",{type:"time",value:n.emailNotifications.time||"17:00",onChange:b=>m("emailNotifications",{...n.emailNotifications,time:b.target.value}),style:v})]})]})]})]}),d.jsxs("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:n.slackNotifications.enabled?"#f0f9ff":"#f8fafc",borderRadius:"8px",border:n.slackNotifications.enabled?"2px solid #3b82f6":"1px solid #e2e8f0"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",marginBottom:"16px"},children:[d.jsx("input",{type:"checkbox",checked:n.slackNotifications.enabled,onChange:b=>m("slackNotifications",{...n.slackNotifications,enabled:b.target.checked}),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontWeight:"600",color:"#374151"},children:["Slack Notifications",n.slackNotifications.enabled&&d.jsx("span",{style:{color:"#3b82f6",marginLeft:"8px"},children:" Enabled"})]}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Send time tracking updates to a specific Slack channel or user"})]})]}),n.slackNotifications.enabled&&d.jsxs("div",{style:{marginTop:"16px"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Notification Frequency"}),d.jsxs("select",{value:n.slackNotifications.cadence,onChange:b=>m("slackNotifications",{...n.slackNotifications,cadence:b.target.value}),style:v,children:[d.jsx("option",{value:"realtime",children:"Real-time updates"}),d.jsx("option",{value:"hourly",children:"Hourly summaries"}),d.jsx("option",{value:"daily",children:"Daily reports"}),d.jsx("option",{value:"weekly",children:"Weekly summaries"})]})]}),d.jsxs("div",{children:[d.jsxs("label",{style:y,children:["Slack Channel/User ",d.jsx("span",{style:{color:"#ef4444",fontSize:"14px"},children:"*"})]}),d.jsx("input",{type:"text",value:n.slackNotifications.channel||"",onChange:b=>m("slackNotifications",{...n.slackNotifications,channel:b.target.value}),placeholder:"#general, #timebeacon, or @username",style:{...v,borderColor:n.slackNotifications.enabled&&!n.slackNotifications.channel?"#ef4444":"#ccc"},required:n.slackNotifications.enabled}),n.slackNotifications.enabled&&!n.slackNotifications.channel&&d.jsx("div",{style:{fontSize:"12px",color:"#ef4444",marginTop:"4px"},children:"Channel or user is required for Slack notifications"})]})]}),n.slackNotifications.cadence==="daily"&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Daily Slack Time"}),d.jsx("input",{type:"time",value:n.slackNotifications.dailyTime||"17:00",onChange:b=>m("slackNotifications",{...n.slackNotifications,dailyTime:b.target.value}),style:v})]}),d.jsx("div",{})," "]}),n.slackNotifications.cadence==="weekly"&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Day"}),d.jsxs("select",{value:n.slackNotifications.weeklyDay||"friday",onChange:b=>m("slackNotifications",{...n.slackNotifications,weeklyDay:b.target.value}),style:v,children:[d.jsx("option",{value:"monday",children:"Monday"}),d.jsx("option",{value:"tuesday",children:"Tuesday"}),d.jsx("option",{value:"wednesday",children:"Wednesday"}),d.jsx("option",{value:"thursday",children:"Thursday"}),d.jsx("option",{value:"friday",children:"Friday"}),d.jsx("option",{value:"saturday",children:"Saturday"}),d.jsx("option",{value:"sunday",children:"Sunday"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Slack Time"}),d.jsx("input",{type:"time",value:n.slackNotifications.weeklyTime||"09:00",onChange:b=>m("slackNotifications",{...n.slackNotifications,weeklyTime:b.target.value}),style:v})]})]})]})]}),d.jsx("div",{style:{marginBottom:"0",padding:"16px",backgroundColor:"#f8fafc",borderRadius:"8px"},children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[d.jsx("input",{type:"checkbox",checked:n.autoBreaks,onChange:b=>m("autoBreaks",b.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"600",color:"#374151"},children:"Automatic Break Detection"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Automatically detect and suggest breaks during long work sessions"})]})]})})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Export & Tools"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[d.jsx("button",{onClick:p,style:{padding:"16px",border:"1px solid #ccc",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",textAlign:"center",fontSize:"14px"},children:" Export to CSV"}),d.jsx("button",{onClick:()=>window.location.href="/integrations",style:{padding:"16px",border:"1px solid #ccc",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",textAlign:"center",fontSize:"14px"},children:" Integrations"})]})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"24px",backgroundColor:l?"#f8fafc":"transparent",border:l?"1px solid #e2e8f0":"none",borderRadius:"8px",textAlign:"center"},children:[d.jsx("button",{onClick:f,disabled:!l,style:{..._,fontSize:"18px",padding:"16px 32px",minWidth:"200px"},children:r==="Saving..."?"Saving Changes...":l?"Save All Settings":"All Settings Saved"}),l&&d.jsx("p",{style:{marginTop:"12px",color:"#64748b",fontSize:"14px",margin:"12px 0 0 0"},children:"Don't forget to save your changes before leaving this page"})]})]})},Md={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"http://localhost:3003/api",VITE_NODE_ENV:"development",VITE_USER_NODE_ENV:"production"},Ld={OAUTH:"https://accounts.google.com/o/oauth2/v2/auth",TOKEN:"https://oauth2.googleapis.com/token",DRIVE:"https://www.googleapis.com/drive/v3",GMAIL:"https://www.googleapis.com/gmail/v1",CALENDAR:"https://www.googleapis.com/calendar/v3"},Id={API_CALL:1e4,TOKEN_EXCHANGE:5e3};function LM(n){try{const e=new URL(n);return e.protocol==="https:"||e.hostname==="localhost"}catch{return!1}}function Kn(n,e,t,i){const r=new Date().toISOString();console.log(`[${r}] ${t?"INFO":"ERROR"}: Google ${n} API - ${e}`,{success:t,details:i?JSON.stringify(i,null,2):"No additional details"})}class IM{config;accessToken;refreshToken;tokenExpiry;constructor(){this.config=this.loadAndValidateConfig()}loadAndValidateConfig(){try{console.log(" Loading Google API configuration...");const e={clientId:Md?.VITE_GOOGLE_CLIENT_ID||"696202687856-c82e7prqdt00og14k6lp47hiutn7p9an.apps.googleusercontent.com",clientSecret:Md?.VITE_GOOGLE_CLIENT_SECRET||"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",redirectUri:Md?.VITE_GOOGLE_REDIRECT_URI||"http://localhost:3001/api/auth/google/callback",apiKey:Md?.VITE_GOOGLE_API_KEY};if(!e.clientId||!e.clientSecret||!e.redirectUri)throw new Error("Invalid Google API configuration");return console.log(" Configuration loaded successfully (PKCE mode)"),e}catch(e){throw console.error(" Failed to load configuration:",e),e}}async validateConfiguration(){const e={isValid:!0,errors:[],warnings:[]};console.log(" Validating Google API configuration...");try{this.config.clientId.match(/^\d+-[a-z0-9]+\.apps\.googleusercontent\.com$/)||(e.errors.push("Invalid Client ID format. Should end with .apps.googleusercontent.com"),e.isValid=!1),this.config.clientSecret.length<20&&(e.errors.push("Client Secret appears to be invalid (too short)"),e.isValid=!1),LM(this.config.redirectUri)||(e.errors.push(`Invalid redirect URI: ${this.config.redirectUri}. Must be HTTPS or localhost`),e.isValid=!1),[/^https:\/\/app\.timebeacon\.io/,/^http:\/\/localhost:\d+/,/^https:\/\/[^.]+\.vercel\.app/,/^https:\/\/[^.]+\.render\.com/].some(r=>r.test(this.config.redirectUri))||e.warnings.push("Redirect URI may not match Google Cloud Console configuration"),this.config.apiKey||e.warnings.push("No API key provided. Some features may require an API key for better rate limits"),console.log(e.isValid?" Configuration validation passed":" Configuration validation failed")}catch(t){e.errors.push(`Configuration validation error: ${t}`),e.isValid=!1}return e}async generateAuthUrl(){console.log(" Generating OAuth authorization URL via backend...");try{const e=await fetch("http://localhost:3001/api/auth/google/url",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Backend auth URL generation failed: ${e.status}`);const t=await e.json();if(!t.success||!t.authUrl||!t.state)throw new Error("Invalid response from backend");return console.log(" Authorization URL generated via backend"),console.log(" DEBUG - Using backend redirect URI"),Kn("OAuth","generateAuthUrl",!0,{state:t.state,backend:!0}),{url:t.authUrl,state:t.state,codeVerifier:"backend-handled"}}catch(e){throw console.error(" Backend auth URL generation failed:",e),e}}base64URLEncode(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}async exchangeCodeForTokens(e,t,i,r){if(console.log(" Using backend callback - no token exchange needed..."),t!==i){const l="Invalid state parameter. Possible CSRF attack.";throw Kn("OAuth","exchangeCodeForTokens",!1,{error:l}),new Error(l)}console.log(" Backend handles token exchange automatically via callback");const s={access_token:"backend-managed",refresh_token:"backend-managed",expires_in:3600,token_type:"Bearer",scope:"backend-managed"};return Kn("OAuth","exchangeCodeForTokens",!0,{backend:!0,note:"Tokens managed by backend"}),this.accessToken=s.access_token,this.refreshToken=s.refresh_token,this.tokenExpiry=new Date(Date.now()+s.expires_in*1e3),s}async refreshAccessToken(){if(!this.refreshToken)throw new Error("No refresh token available. Re-authentication required.");console.log(" Refreshing access token...");const e=Date.now();try{const t={client_id:this.config.clientId,client_secret:this.config.clientSecret,refresh_token:this.refreshToken,grant_type:"refresh_token"},i=await fetch(Ld.TOKEN,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":"TimeBeacon/1.0"},body:new URLSearchParams(t).toString(),signal:AbortSignal.timeout(Id.TOKEN_EXCHANGE)});if(!i.ok){const u=(await i.json().catch(()=>null))?.error_description||`HTTP ${i.status}`;throw Kn("OAuth","refreshAccessToken",!1,{status:i.status,error:u}),new Error(`Token refresh failed: ${u}`)}const r=await i.json();this.accessToken=r.access_token,this.tokenExpiry=new Date(Date.now()+r.expires_in*1e3);const s=Date.now()-e;return console.log(" Access token refreshed successfully"),Kn("OAuth","refreshAccessToken",!0,{executionTimeMs:s,expiresIn:r.expires_in}),r}catch(t){const i=Date.now()-e;throw Kn("OAuth","refreshAccessToken",!1,{error:t instanceof Error?t.message:String(t),executionTimeMs:i}),t}}async testDriveApi(){const e=Date.now();console.log(" Testing Google Drive API...");try{await this.ensureValidToken();const t=await fetch(`${Ld.DRIVE}/files?pageSize=5&fields=files(id,name,mimeType,modifiedTime)`,{headers:{Authorization:`Bearer ${this.accessToken}`,"User-Agent":"TimeBeacon/1.0"},signal:AbortSignal.timeout(Id.API_CALL)}),i=Date.now()-e;if(!t.ok){const u=await t.json().catch(()=>null);let f=`HTTP ${t.status}: ${t.statusText}`,m=[];switch(t.status){case 403:u?.error?.message?.includes("Drive API")?(f="Google Drive API is not enabled",m.push("Enable the Google Drive API in Google Cloud Console"),m.push("Visit: https://console.cloud.google.com/apis/library/drive.googleapis.com")):u?.error?.message?.includes("insufficient")&&(f="Insufficient permissions for Drive API",m.push("Ensure https://www.googleapis.com/auth/drive scope is requested"),m.push("Check OAuth consent screen configuration"));break;case 401:f="Invalid or expired access token",m.push("Token may have expired - try re-authenticating");break;case 429:f="Drive API rate limit exceeded",m.push("Implement exponential backoff retry logic"),m.push("Consider adding API key for higher quotas");break}const p={status:"error",service:"Drive",details:{error:f,suggestions:m,httpStatus:t.status,rawError:u},timestamp:new Date().toISOString(),executionTimeMs:i};return Kn("Drive","testDriveApi",!1,p.details),p}const s=(await t.json()).files||[],l={status:"success",service:"Drive",details:{message:"Successfully connected to Google Drive API",filesFound:s.length,sampleFiles:s.slice(0,3).map(u=>({name:u.name,type:u.mimeType,modified:u.modifiedTime}))},timestamp:new Date().toISOString(),executionTimeMs:i};return console.log(" Google Drive API test successful"),Kn("Drive","testDriveApi",!0,l.details),l}catch(t){const i=Date.now()-e,r={status:"error",service:"Drive",details:{error:`Drive API test failed: ${t instanceof Error?t.message:String(t)}`,suggestions:["Check internet connectivity","Verify Google Cloud Console project configuration","Ensure valid access token"]},timestamp:new Date().toISOString(),executionTimeMs:i};return Kn("Drive","testDriveApi",!1,r.details),r}}async testGmailApi(){const e=Date.now();console.log(" Testing Gmail API...");try{await this.ensureValidToken();const t=await fetch(`${Ld.GMAIL}/users/me/messages?maxResults=5&q=in:inbox`,{headers:{Authorization:`Bearer ${this.accessToken}`,"User-Agent":"TimeBeacon/1.0"},signal:AbortSignal.timeout(Id.API_CALL)}),i=Date.now()-e;if(!t.ok){const u=await t.json().catch(()=>null);let f=`HTTP ${t.status}: ${t.statusText}`,m=[];switch(t.status){case 403:u?.error?.message?.includes("Gmail API")?(f="Gmail API is not enabled",m.push("Enable the Gmail API in Google Cloud Console"),m.push("Visit: https://console.cloud.google.com/apis/library/gmail.googleapis.com")):(f="Insufficient permissions for Gmail API",m.push("Ensure https://www.googleapis.com/auth/gmail.readonly scope is requested"),m.push("Check OAuth consent screen scopes"));break;case 401:f="Invalid or expired access token",m.push("Re-authenticate to get fresh tokens");break;case 400:u?.error?.message?.includes("invalid query")&&(f="Invalid Gmail query format",m.push("Check Gmail API query syntax"));break}const p={status:"error",service:"Gmail",details:{error:f,suggestions:m,httpStatus:t.status,rawError:u},timestamp:new Date().toISOString(),executionTimeMs:i};return Kn("Gmail","testGmailApi",!1,p.details),p}const r=await t.json(),l={status:"success",service:"Gmail",details:{message:"Successfully connected to Gmail API",messagesFound:(r.messages||[]).length,resultCount:r.resultSizeEstimate||0},timestamp:new Date().toISOString(),executionTimeMs:i};return console.log(" Gmail API test successful"),Kn("Gmail","testGmailApi",!0,l.details),l}catch(t){const i=Date.now()-e,r={status:"error",service:"Gmail",details:{error:`Gmail API test failed: ${t instanceof Error?t.message:String(t)}`,suggestions:["Check internet connectivity","Verify Gmail API is enabled in Google Cloud Console","Ensure proper OAuth scopes are granted"]},timestamp:new Date().toISOString(),executionTimeMs:i};return Kn("Gmail","testGmailApi",!1,r.details),r}}async testCalendarApi(){const e=Date.now();console.log(" Testing Google Calendar API...");try{await this.ensureValidToken();const t=new Date().toISOString(),i=new Date(Date.now()+7*24*60*60*1e3).toISOString(),r=await fetch(`${Ld.CALENDAR}/calendars/primary/events?timeMin=${encodeURIComponent(t)}&timeMax=${encodeURIComponent(i)}&maxResults=5&singleEvents=true&orderBy=startTime`,{headers:{Authorization:`Bearer ${this.accessToken}`,"User-Agent":"TimeBeacon/1.0"},signal:AbortSignal.timeout(Id.API_CALL)}),s=Date.now()-e;if(!r.ok){const m=await r.json().catch(()=>null);let p=`HTTP ${r.status}: ${r.statusText}`,v=[];switch(r.status){case 403:m?.error?.message?.includes("Calendar API")?(p="Google Calendar API is not enabled",v.push("Enable the Google Calendar API in Google Cloud Console"),v.push("Visit: https://console.cloud.google.com/apis/library/calendar.googleapis.com")):(p="Insufficient permissions for Calendar API",v.push("Ensure https://www.googleapis.com/auth/calendar scope is requested"),v.push("Check OAuth consent screen configuration"));break;case 401:p="Invalid or expired access token",v.push("Token expired - re-authenticate required");break;case 404:p="Primary calendar not found",v.push("Ensure user has a primary Google Calendar"),v.push("Try accessing a specific calendar ID instead");break}const y={status:"error",service:"Calendar",details:{error:p,suggestions:v,httpStatus:r.status,rawError:m},timestamp:new Date().toISOString(),executionTimeMs:s};return Kn("Calendar","testCalendarApi",!1,y.details),y}const u=(await r.json()).items||[],f={status:"success",service:"Calendar",details:{message:"Successfully connected to Google Calendar API",eventsFound:u.length,sampleEvents:u.slice(0,3).map(m=>({summary:m.summary,start:m.start?.dateTime||m.start?.date,end:m.end?.dateTime||m.end?.date})),timeRange:{from:t,to:i}},timestamp:new Date().toISOString(),executionTimeMs:s};return console.log(" Google Calendar API test successful"),Kn("Calendar","testCalendarApi",!0,f.details),f}catch(t){const i=Date.now()-e,r={status:"error",service:"Calendar",details:{error:`Calendar API test failed: ${t instanceof Error?t.message:String(t)}`,suggestions:["Check internet connectivity","Verify Google Calendar API is enabled","Ensure user has access to Google Calendar"]},timestamp:new Date().toISOString(),executionTimeMs:i};return Kn("Calendar","testCalendarApi",!1,r.details),r}}async runAllTests(){console.log(" Starting comprehensive Google API tests...");const e=[];try{const t=await this.validateConfiguration();if(!t.isValid)return[{status:"error",service:"Drive",details:{error:"Configuration validation failed",validationErrors:t.errors,suggestions:["Check all environment variables are set correctly","Verify Google Cloud Console project configuration","Ensure redirect URIs match exactly"]},timestamp:new Date().toISOString(),executionTimeMs:0}];t.warnings.length>0&&console.warn(" Configuration warnings:",t.warnings);const[i,r,s]=await Promise.all([this.testDriveApi(),this.testGmailApi(),this.testCalendarApi()]);e.push(i,r,s);const l=e.filter(f=>f.status==="success").length,u=e.filter(f=>f.status==="error").length;return console.log(` API tests completed: ${l} successful, ${u} failed`),e}catch(t){return console.error(" Failed to run API tests:",t),[{status:"error",service:"Drive",details:{error:`Test execution failed: ${t instanceof Error?t.message:String(t)}`,suggestions:["Check authentication status","Verify internet connectivity","Review Google Cloud Console configuration"]},timestamp:new Date().toISOString(),executionTimeMs:0}]}}async ensureValidToken(){if(!this.accessToken)throw new Error("No access token available. Authentication required.");if(this.tokenExpiry&&this.tokenExpiry<=new Date)if(this.refreshToken)console.log(" Access token expired, refreshing..."),await this.refreshAccessToken();else throw new Error("Access token expired and no refresh token available. Re-authentication required.")}getAuthStatus(){return{isAuthenticated:!!this.accessToken,hasRefreshToken:!!this.refreshToken,tokenExpiry:this.tokenExpiry,config:{clientId:this.config.clientId,redirectUri:this.config.redirectUri,apiKey:this.config.apiKey}}}clearTokens(){console.log(" Clearing stored tokens..."),this.accessToken=void 0,this.refreshToken=void 0,this.tokenExpiry=void 0,Kn("OAuth","clearTokens",!0)}}function PM(){return new IM}const qa=PM();class BM{preferences;userCorrections=new Map;constructor(){this.preferences=this.loadPreferences(),this.loadUserCorrections(),this.setupExtensionBridge()}processEmailTime(e){console.log(` Processing email time for: ${e.subject}`);const t=this.getExtensionData(e.id);let i;return t?.focusTimeSeconds?i=this.processWithExtensionData(e,t):i=this.processWithEstimation(e),this.applyUserPreferences(i),this.storeForLearning(i),i}processWithEstimation(e){const t=this.calculateSmartEstimate(e);return{id:`email_time_${e.id}`,emailId:e.id,subject:e.subject,sender:e.sender,recipients:e.recipients,timestamp:e.timestamp,estimatedMinutes:t.minutes,finalMinutes:t.minutes,source:"estimated",confidence:t.confidence,needsReview:t.confidence<.7,wordCount:e.wordCount,threadLength:e.threadLength,hasAttachments:e.hasAttachments}}processWithExtensionData(e,t){const i=Math.round((t.focusTimeSeconds+t.composeTimeSeconds)/60);return{id:`email_time_${e.id}`,emailId:e.id,subject:e.subject,sender:e.sender,recipients:e.recipients,timestamp:e.timestamp,estimatedMinutes:this.calculateSmartEstimate(e).minutes,actualMinutes:i,finalMinutes:i,source:"extension",confidence:.95,needsReview:!1,wordCount:e.wordCount,threadLength:e.threadLength,hasAttachments:e.hasAttachments,realTimeData:{openedAt:t.openedAt,closedAt:t.closedAt,focusTimeSeconds:t.focusTimeSeconds,composeTimeSeconds:t.composeTimeSeconds,idleTimeSeconds:t.idleTimeSeconds}}}calculateSmartEstimate(e){let t=2,i=.6;if(e.wordCount){const u=Math.ceil(e.wordCount/200),f=Math.ceil(e.wordCount/100);t=Math.max(t,u+f),i+=.2}e.threadLength>1&&(t+=Math.min(e.threadLength*2,10),i+=.1),e.hasAttachments&&(t+=3,i+=.1);const r=e.sender.split("@")[1]?.toLowerCase(),s=this.getDomainTimeAdjustment(r);t=Math.round(t*s.multiplier),i=Math.min(i+s.confidenceBoost,.95);const l=this.getUserLearningAdjustment(e);return t=Math.round(t*l),t=Math.max(1,Math.min(t,60)),i=Math.max(.3,Math.min(i,.95)),{minutes:t,confidence:i}}confirmEmailTime(e,t){const i=this.getEmailTimeData(e);i&&(console.log(` User confirmed email time: ${t}min (was ${i.finalMinutes}min)`),i.userConfirmedMinutes=t,i.finalMinutes=t,i.source="confirmed",i.needsReview=!1,i.reviewedAt=new Date,this.learnFromUserCorrection(i,t),this.updateEmailTimeData(i),this.createOrUpdateTimeEntry(i))}getEmailsNeedingReview(){return this.getAllEmailTimeData().filter(e=>e.needsReview&&!e.reviewedAt)}setupExtensionBridge(){typeof window<"u"&&(window.addEventListener("message",e=>{e.source===window&&e.data.type==="TIMEBEACON_EMAIL_TRACKING"&&this.handleExtensionData(e.data)}),window.postMessage({type:"TIMEBEACON_READY",version:"1.0.0"},"*"))}handleExtensionData(e){console.log(" Received real-time email data from extension:",e);const t={emailId:e.emailId,openedAt:new Date(e.openedAt),closedAt:e.closedAt?new Date(e.closedAt):void 0,focusTimeSeconds:e.focusTimeSeconds,composeTimeSeconds:e.composeTimeSeconds,idleTimeSeconds:e.idleTimeSeconds};this.storeExtensionData(e.emailId,t),this.updateWithRealTimeData(e.emailId,t)}learnFromUserCorrection(e,t){const i=e.estimatedMinutes,r=t/i,s=e.sender.split("@")[1]?.toLowerCase();if(s){const l=`domain_${s}`,f=((this.userCorrections.get(l)||1)+r)/2;this.userCorrections.set(l,f)}if(e.wordCount){const u=`wordcount_${Math.floor(e.wordCount/100)*100}`,m=((this.userCorrections.get(u)||1)+r)/2;this.userCorrections.set(u,m)}this.saveUserCorrections(),console.log(` Learning: ${s} emails adjusted by ${Math.round((r-1)*100)}%`)}getDomainTimeAdjustment(e){return e?{"acmecorp.com":{multiplier:1.3,confidenceBoost:.2},"techstart.io":{multiplier:1.2,confidenceBoost:.2},"zendesk.com":{multiplier:1.4,confidenceBoost:.2},"timebeacon.io":{multiplier:.8,confidenceBoost:.1}}[e]||{multiplier:1,confidenceBoost:0}:{multiplier:1,confidenceBoost:0}}getUserLearningAdjustment(e){const t=e.sender.split("@")[1]?.toLowerCase();let i=1;if(t){const r=this.userCorrections.get(`domain_${t}`);r&&(i*=r)}if(e.wordCount){const r=Math.floor(e.wordCount/100)*100,s=this.userCorrections.get(`wordcount_${r}`);s&&(i*=s)}return i}applyUserPreferences(e){this.preferences.autoConfirmHighConfidence&&e.confidence>.9&&e.finalMinutes<=this.preferences.autoConfirmThreshold&&(e.needsReview=!1,e.source="confirmed"),this.preferences.reviewLowConfidence&&e.confidence<.7&&(e.needsReview=!0)}loadPreferences(){const e=localStorage.getItem("timebeacon_email_preferences");return e?JSON.parse(e):{autoConfirmHighConfidence:!0,autoConfirmThreshold:15,reviewLowConfidence:!0,extensionEnabled:!1,learningEnabled:!0}}loadUserCorrections(){const e=localStorage.getItem("timebeacon_email_corrections");e&&(this.userCorrections=new Map(JSON.parse(e)))}saveUserCorrections(){localStorage.setItem("timebeacon_email_corrections",JSON.stringify(Array.from(this.userCorrections.entries())))}getExtensionData(e){const t=localStorage.getItem(`timebeacon_ext_${e}`);return t?JSON.parse(t):null}storeExtensionData(e,t){localStorage.setItem(`timebeacon_ext_${e}`,JSON.stringify(t))}getEmailTimeData(e){const t=localStorage.getItem(`timebeacon_email_time_${e}`);return t?JSON.parse(t):null}updateEmailTimeData(e){localStorage.setItem(`timebeacon_email_time_${e.id}`,JSON.stringify(e))}getAllEmailTimeData(){return Object.keys(localStorage).filter(t=>t.startsWith("timebeacon_email_time_")).map(t=>JSON.parse(localStorage.getItem(t))).filter(Boolean)}storeForLearning(e){this.updateEmailTimeData(e)}updateWithRealTimeData(e,t){const r=this.getAllEmailTimeData().find(s=>s.emailId===e);if(r&&r.source==="estimated"){const s=Math.round((t.focusTimeSeconds+t.composeTimeSeconds)/60);r.actualMinutes=s,r.finalMinutes=s,r.source="extension",r.confidence=.95,r.needsReview=!1,r.realTimeData=t,this.updateEmailTimeData(r),this.createOrUpdateTimeEntry(r),console.log(` Updated email ${e} with real-time data: ${s}min`)}}createOrUpdateTimeEntry(e){const t={date:e.timestamp.toISOString().split("T")[0],startTime:e.timestamp.toTimeString().slice(0,5),duration:e.finalMinutes/60,client:this.inferClient(e.sender),project:this.inferProject(e.subject,e.sender),description:`Email: ${e.subject} (${e.finalMinutes}min${e.source==="extension"?" tracked":" estimated"})`,category:"client",source:"gmail",isAutomatic:!0,tags:["email",e.source]},i=JSON.parse(localStorage.getItem("pending_email_time_entries")||"[]"),r=i.findIndex(s=>s.originalEmailId===e.emailId);r>=0?i[r]={...t,originalEmailId:e.emailId}:i.push({...t,originalEmailId:e.emailId}),localStorage.setItem("pending_email_time_entries",JSON.stringify(i)),window.dispatchEvent(new CustomEvent("timebeacon-email-entry-ready",{detail:t}))}inferClient(e){const t=e.split("@")[1]?.toLowerCase();return t?.includes("acme")?"Acme Corp":t?.includes("techstart")?"TechStart Inc":t?.includes("zendesk")?"Zendesk Inc":t?.includes("timebeacon.io")?"Internal":"Email Client"}inferProject(e,t){const i=e.toLowerCase();return i.includes("salesforce")?"Salesforce Integration":i.includes("monday")?"Monday.com Implementation":i.includes("zendesk")?"Zendesk Integration":"Email Communication"}}const FM=new BM;class zM{backendUrl="http://localhost:3001";async importGmailData(e){try{console.log(" Starting Gmail data import...");const{startDate:t,endDate:i}=this.getWeekDateRange(),r=await fetch(`${this.backendUrl}/api/google/gmail/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tokens:JSON.stringify(e),startDate:t,endDate:i,maxResults:50})});if(!r.ok)throw new Error(`Gmail API error: ${r.statusText}`);const l=(await r.json()).messages||[];console.log(` Found ${l.length} emails to process`);const u=[],f=[];for(const m of l)try{const p=await this.processEmailToTimeEntry(m);p&&u.push(p)}catch(p){console.error(`Error processing email ${m.id}:`,p),f.push(`Email ${m.subject}: ${p instanceof Error?p.message:String(p)}`)}return console.log(` Gmail import completed: ${u.length} time entries created`),{success:!0,importedCount:u.length,errors:f,timeEntries:u}}catch(t){return console.error(" Gmail import failed:",t),{success:!1,importedCount:0,errors:[t instanceof Error?t.message:String(t)],timeEntries:[]}}}async importCalendarData(e){try{console.log(" Starting Calendar data import...");const{startDate:t,endDate:i}=this.getWeekDateRange(),r=await fetch(`${this.backendUrl}/api/google/calendar/events`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tokens:JSON.stringify(e),timeMin:t,timeMax:i,maxResults:50})});if(!r.ok)throw new Error(`Calendar API error: ${r.statusText}`);const u=((await r.json()).events||[]).filter(p=>p.start&&p.end&&!p.start.includes("T00:00:00"));console.log(` Found ${u.length} meetings to process`);const f=[],m=[];for(const p of u)try{const v=await this.processMeetingToTimeEntry(p);v&&f.push(v)}catch(v){console.error(`Error processing meeting ${p.id}:`,v),m.push(`Meeting ${p.summary}: ${v instanceof Error?v.message:String(v)}`)}return console.log(` Calendar import completed: ${f.length} time entries created`),{success:!0,importedCount:f.length,errors:m,timeEntries:f}}catch(t){return console.error(" Calendar import failed:",t),{success:!1,importedCount:0,errors:[t instanceof Error?t.message:String(t)],timeEntries:[]}}}async processEmailToTimeEntry(e){try{const t=FM.processEmailTime({id:e.id,subject:e.subject,sender:e.sender,recipients:e.recipients,timestamp:new Date(e.timestamp),wordCount:e.wordCount,threadLength:e.threadLength,hasAttachments:e.snippet?.includes("attachment")||!1});return{date:t.timestamp.toISOString().split("T")[0],startTime:t.timestamp.toTimeString().slice(0,5),duration:t.finalMinutes/60,client:this.inferClient(e.sender),project:this.inferProject(e.subject,e.sender),description:`Email: ${e.subject} (${t.finalMinutes}min, ${Math.round(t.confidence*100)}% confidence)`,category:this.determineEmailCategory(e),source:t.source==="extension"?"gmail-tracked":"gmail",isAutomatic:!0,needsReview:t.needsReview,tags:["email","imported",t.source,`confidence-${Math.round(t.confidence*100)}`]}}catch(t){return console.error("Error processing email to time entry:",t),null}}async processMeetingToTimeEntry(e){try{const t=new Date(e.start),r=(new Date(e.end).getTime()-t.getTime())/(1e3*60*60),{client:s,project:l}=this.matchMeetingToProject(e);return{date:e.start.split("T")[0],startTime:t.toTimeString().slice(0,5),duration:r,client:s,project:l,description:e.summary||"Meeting",category:this.determineMeetingCategory(e),source:"calendar",isAutomatic:!0,meetingType:this.determineMeetingType(e),tags:["meeting","imported","ai-processed"]}}catch(t){return console.error("Error processing meeting to time entry:",t),null}}matchMeetingToProject(e){const t=e.summary?.toLowerCase()||"",i=e.attendees.join(" ").toLowerCase();return t.includes("salesforce")||i.includes("acmecorp.com")?{client:"Acme Corp",project:"Salesforce Integration"}:t.includes("monday")||i.includes("techstart.io")?{client:"TechStart Inc",project:"Monday.com Implementation"}:t.includes("standup")||t.includes("internal")?{client:"Internal",project:"Internal Operations"}:i.includes("zendesk.com")?{client:"Zendesk Inc",project:"Zendesk Integration"}:e.attendees.filter(s=>!s.includes("timebeacon.io")).length>0?{client:"External Client",project:"Client Meeting"}:{client:"Internal",project:"Internal Operations"}}determineEmailCategory(e){return e.sender.split("@")[1]?.toLowerCase()?.includes("timebeacon.io")?"internal":"client"}determineMeetingCategory(e){return e.attendees.join(" ").toLowerCase(),e.attendees.some(i=>!i.includes("timebeacon.io"))?"client":"internal"}determineMeetingType(e){const t=e.summary?.toLowerCase()||"";return t.includes("standup")||t.includes("check-in")||t.includes("sync")?"check-in":t.includes("planning")||t.includes("roadmap")||t.includes("strategy")?"planning":t.includes("review")||t.includes("demo")||t.includes("retrospective")?"review":t.includes("workshop")||t.includes("training")||t.includes("deep dive")?"workshop":"check-in"}getWeekDateRange(){const e=new Date,t=e.getDay(),i=t===0?6:t-1,r=new Date(e);r.setDate(e.getDate()-i),r.setHours(0,0,0,0);const s=new Date(r);return s.setDate(r.getDate()+4),s.setHours(23,59,59,999),{startDate:r.toISOString(),endDate:s.toISOString()}}inferClient(e){const t=e.split("@")[1]?.toLowerCase();return t?.includes("acme")?"Acme Corp":t?.includes("techstart")?"TechStart Inc":t?.includes("zendesk")?"Zendesk Inc":t?.includes("timebeacon.io")?"Internal":"Email Client"}inferProject(e,t){const i=e.toLowerCase();return i.includes("salesforce")?"Salesforce Integration":i.includes("monday")?"Monday.com Implementation":i.includes("zendesk")?"Zendesk Integration":"Email Communication"}}const Jx=new zM,Qx=[{id:"gmail",name:"Gmail",description:"Track time spent on emails",icon:d.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",children:[d.jsx("path",{fill:"#EA4335",d:"M24 12.073c0-1.02-.086-2.009-.25-2.957H12.228v5.597h6.657a5.696 5.696 0 0 1-2.474 3.745v3.103h4.009C22.456 19.682 24 16.138 24 12.073z"}),d.jsx("path",{fill:"#34A853",d:"M12.228 24c3.35 0 6.16-1.11 8.21-3.014l-4.009-3.103c-1.11.744-2.533 1.183-4.201 1.183-3.23 0-5.963-2.18-6.937-5.111H1.202v3.205C3.241 21.495 7.51 24 12.228 24z"}),d.jsx("path",{fill:"#FBBC05",d:"M5.291 16.955a7.176 7.176 0 0 1-.375-2.282c0-.794.138-1.566.375-2.282V9.186H1.202A12.017 12.017 0 0 0 0 14.673c0 1.93.46 3.756 1.202 5.487l4.089-3.205z"}),d.jsx("path",{fill:"#EB4335",d:"M12.228 4.75c1.82 0 3.45.626 4.73 1.853l3.545-3.545C18.383 1.17 15.573 0 12.228 0 7.51 0 3.241 2.505 1.202 6.84l4.089 3.205c.974-2.931 3.707-5.11 6.937-5.11z"})]}),status:"available",category:"google"},{id:"google-calendar",name:"Google Calendar",description:"Auto-track meetings and events",icon:d.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",children:[d.jsx("path",{fill:"#4285F4",d:"M19.5 3h-1V1.5C18.5.7 17.8 0 17 0s-1.5.7-1.5 1.5V3h-7V1.5C8.5.7 7.8 0 7 0S5.5.7 5.5 1.5V3h-1C3.1 3 2 4.1 2 5.5v13C2 19.9 3.1 21 4.5 21h15c1.4 0 2.5-1.1 2.5-2.5v-13C22 4.1 20.9 3 19.5 3zM20 18.5c0 .3-.2.5-.5.5h-15c-.3 0-.5-.2-.5-.5V8h16v10.5zM20 6H4V5.5c0-.3.2-.5.5-.5h1v1.5C5.5 7.3 6.2 8 7 8s1.5-.7 1.5-1.5V5h7v1.5c0 .8.7 1.5 1.5 1.5s1.5-.7 1.5-1.5V5h1c.3 0 .5.2.5.5V6z"}),d.jsx("circle",{fill:"#34A853",cx:"7",cy:"12",r:"1"}),d.jsx("circle",{fill:"#EA4335",cx:"12",cy:"12",r:"1"}),d.jsx("circle",{fill:"#FBBC05",cx:"17",cy:"12",r:"1"}),d.jsx("circle",{fill:"#34A853",cx:"7",cy:"16",r:"1"}),d.jsx("circle",{fill:"#EA4335",cx:"12",cy:"16",r:"1"})]}),status:"available",category:"google"},{id:"google-drive",name:"Google Drive",description:"Track document work time",icon:d.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",children:[d.jsx("path",{fill:"#0F9D58",d:"m10 2 8 14H2l8-14z"}),d.jsx("path",{fill:"#F1C232",d:"M10 2 2 16h6L16 2h-6z"}),d.jsx("path",{fill:"#4285F4",d:"M16 2v14h6L16 2z"}),d.jsx("path",{fill:"#0F9D58",d:"M2 16h16l-3 6H5l-3-6z"})]}),status:"available",category:"google"},{id:"slack",name:"Slack",description:"Time tracking notifications",icon:d.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",children:[d.jsx("path",{fill:"#E01E5A",d:"M6 14.5a2.5 2.5 0 0 1-2.5 2.5A2.5 2.5 0 0 1 1 14.5 2.5 2.5 0 0 1 3.5 12H6v2.5z"}),d.jsx("path",{fill:"#E01E5A",d:"M6 9.5a2.5 2.5 0 0 1 5 0v5a2.5 2.5 0 0 1-5 0v-5z"}),d.jsx("path",{fill:"#36C5F0",d:"M14.5 6a2.5 2.5 0 0 1 2.5-2.5A2.5 2.5 0 0 1 19.5 6 2.5 2.5 0 0 1 17 8.5H14.5V6z"}),d.jsx("path",{fill:"#36C5F0",d:"M9.5 6a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5z"}),d.jsx("path",{fill:"#2EB67D",d:"M18 14.5a2.5 2.5 0 0 1 2.5 2.5A2.5 2.5 0 0 1 18 19.5 2.5 2.5 0 0 1 15.5 17V14.5H18z"}),d.jsx("path",{fill:"#2EB67D",d:"M14.5 18a2.5 2.5 0 0 1-5 0v-5a2.5 2.5 0 0 1 5 0v5z"}),d.jsx("path",{fill:"#ECB22E",d:"M9.5 18a2.5 2.5 0 0 1-2.5 2.5A2.5 2.5 0 0 1 4.5 18 2.5 2.5 0 0 1 7 15.5h2.5V18z"}),d.jsx("path",{fill:"#ECB22E",d:"M14.5 9.5a2.5 2.5 0 0 1 0 5 2.5 2.5 0 0 1 0-5z"})]}),status:"available",category:"communication"}],UM=()=>{const[n,e]=H.useState(new Set),[t,i]=H.useState(new Set),[r,s]=H.useState({}),[l,u]=H.useState(!1),[,f]=H.useState({isAuthenticated:!1}),{addTimeEntry:m}=xb();H.useEffect(()=>{const w=qa.getAuthStatus();f(w);const C=localStorage.getItem("google_oauth_tokens"),j=localStorage.getItem("google_user_info");if(C&&j||w.isAuthenticated){const k=["gmail","google-calendar","google-drive"];e(new Set(k)),console.log(" Found existing authentication, marking services as connected")}},[]);const p=async w=>{if(n.has(w)){v();return}i(C=>new Set([...C,w]));try{console.log(` Starting OAuth flow for ${w}...`);const{url:C,state:j,codeVerifier:k}=await qa.generateAuthUrl();sessionStorage.setItem("google_oauth_state",j),sessionStorage.setItem("google_oauth_code_verifier",k),sessionStorage.setItem("connecting_service",w);const P=window.open(C,"google-oauth","width=500,height=600,scrollbars=yes,resizable=yes");if(!P)throw new Error("Popup blocked. Please allow popups for this site.");const D=setInterval(()=>{P.closed&&(clearInterval(D),i(R=>{const W=new Set(R);return W.delete(w),W}))},1e3),z=R=>{if(R.origin===window.location.origin)if(R.data.type==="OAUTH_SUCCESS"){clearInterval(D),P.close(),console.log(" OAuth Success! Received tokens and user info:",R.data),R.data.tokens&&R.data.userInfo&&(localStorage.setItem("google_oauth_tokens",JSON.stringify(R.data.tokens)),localStorage.setItem("google_user_info",JSON.stringify(R.data.userInfo)),console.log(" Stored encrypted tokens and user info"));const W=["gmail","google-calendar","google-drive"];e(new Set(W));const q=qa.getAuthStatus();f(q),console.log(" Updated auth status:",q),y(),_(),window.removeEventListener("message",z)}else R.data.type==="OAUTH_ERROR"&&(clearInterval(D),P.close(),console.error("OAuth error:",R.data.error),alert(`Connection failed: ${R.data.error}`),window.removeEventListener("message",z))};window.addEventListener("message",z)}catch(C){console.error(`Failed to connect ${w}:`,C),alert(`Failed to connect: ${C instanceof Error?C.message:"Unknown error"}`)}finally{i(C=>{const j=new Set(C);return j.delete(w),j})}},v=w=>{qa.clearTokens(),localStorage.removeItem("google_oauth_tokens"),localStorage.removeItem("google_user_info"),e(new Set),f(qa.getAuthStatus()),s({}),console.log(" Disconnected from Google services and cleared all tokens")},y=async()=>{console.log(" Running API tests...");try{const w=await qa.runAllTests(),C={};w.forEach(j=>{const k=j.service.toLowerCase().replace(" ","-");k==="drive"?C["google-drive"]=j:k==="gmail"?C.gmail=j:k==="calendar"&&(C["google-calendar"]=j)}),s(C),w.forEach(j=>{j.status==="success"?console.log(` ${j.service} API: Connected successfully`):console.error(` ${j.service} API: ${j.details.error}`)})}catch(w){console.error("Failed to run API tests:",w)}},S=w=>{if(["gmail","google-calendar","google-drive"].includes(w))p(w);else if(n.has(w)){const j=new Set(n);j.delete(w),e(j),console.log(`Disconnected: ${w}`)}else e(new Set([...n,w])),console.log(`Connected: ${w}`)},_=async()=>{console.log(" Starting automatic data import..."),u(!0);try{const w=localStorage.getItem("google_oauth_tokens"),C=localStorage.getItem("google_user_info");if(!w||!C){console.log(" No tokens found for data import"),u(!1);return}const j=JSON.parse(w);console.log(" Found stored tokens, starting data import...");let k=0;const P=[],D=await Jx.importGmailData(j);D.success?(D.timeEntries.forEach(R=>{m(R),k++}),console.log(` Added ${D.timeEntries.length} email time entries`)):P.push(...D.errors);const z=await Jx.importCalendarData(j);z.success?(z.timeEntries.forEach(R=>{m(R),k++}),console.log(` Added ${z.timeEntries.length} calendar time entries`)):P.push(...z.errors),console.log(` Automatic data import completed! Total entries: ${k}`),k>0?alert(` Connected successfully! Imported ${k} time entries from your emails and calendar events this week. Check your dashboard to see them!`):alert(" Connected successfully! No new time entries found for this week. Try using the individual import buttons in the Gmail and Calendar components.")}catch(w){console.error(" Error during automatic data import:",w),alert(` Import failed: ${w instanceof Error?w.message:"Unknown error"}`)}finally{u(!1)}},b=Qx.filter(w=>w.category==="google"),T=Qx.filter(w=>w.category!=="google"),E=w=>{const C=n.has(w.id),j=t.has(w.id)||l,k=r[w.id],P=k?.status==="error";return d.jsxs("div",{style:{backgroundColor:"white",border:C?"2px solid #10b981":"1px solid #e5e7eb",borderRadius:"12px",padding:"24px",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",position:"relative"},onMouseEnter:D=>{D.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",D.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:D=>{D.currentTarget.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.1)",D.currentTarget.style.transform="translateY(0)"},children:[C&&d.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",backgroundColor:"#10b981",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},children:""}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",flex:1},children:[d.jsx("div",{style:{flexShrink:0},children:w.icon}),d.jsxs("div",{children:[d.jsx("h3",{style:{margin:"0 0 4px 0",fontSize:"18px",fontWeight:"600",color:"#111827"},children:w.name}),d.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280",lineHeight:"1.4"},children:w.description})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"8px"},children:[C&&k&&d.jsx("div",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"4px",backgroundColor:P?"#fef3f2":"#f0f9ff",color:P?"#b91c1c":"#0c4a6e",border:`1px solid ${P?"#fecaca":"#bae6fd"}`},children:P?" API Error":" API Active"}),d.jsx("button",{onClick:()=>S(w.id),disabled:j,style:{backgroundColor:j?"#9ca3af":C?"#10b981":"#3b82f6",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:"500",cursor:j?"not-allowed":"pointer",transition:"background-color 0.2s ease",minWidth:"120px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",opacity:j?.7:1},onMouseEnter:D=>{j||(D.currentTarget.style.backgroundColor=C?"#059669":"#2563eb")},onMouseLeave:D=>{j||(D.currentTarget.style.backgroundColor=j?"#9ca3af":C?"#10b981":"#3b82f6")},children:j?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{width:"12px",height:"12px",border:"2px solid #ffffff40",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 1s linear infinite"}}),l?"Importing...":"Connecting..."]}):C?d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{fontSize:"12px"},children:""}),"Connected"]}):d.jsx(d.Fragment,{children:" Connect"})})]})]},w.id)};return d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"40px 20px"},children:[d.jsxs("div",{style:{marginBottom:"48px",textAlign:"center"},children:[d.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#111827",marginBottom:"12px",margin:0},children:"Integrations"}),d.jsx("p",{style:{fontSize:"16px",color:"#6b7280",margin:0,maxWidth:"500px",marginLeft:"auto",marginRight:"auto",lineHeight:"1.5"},children:"Connect your favorite tools to automatically track time and boost productivity"})]}),d.jsxs("div",{style:{marginBottom:"48px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"24px"},children:[d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:[d.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),d.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),d.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),d.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",color:"#111827",margin:0},children:"Google Workspace"})]}),d.jsx("div",{style:{display:"grid",gap:"12px"},children:b.map(E)})]}),d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"24px"},children:[d.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z"})}),d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",color:"#111827",margin:0},children:"Communication & Productivity"})]}),d.jsx("div",{style:{display:"grid",gap:"12px"},children:T.map(E)})]}),n.size>0&&d.jsx("div",{style:{marginTop:"48px",backgroundColor:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"8px",padding:"16px",textAlign:"center"},children:d.jsxs("p",{style:{margin:0,color:"#0c4a6e",fontSize:"14px",fontWeight:"500"},children:[" ",n.size," integration",n.size!==1?"s":""," connected"]})})]})},HM=({privacySettings:n,dataSources:e,auditLogs:t,onUpdatePrivacySettings:i,onExportData:r,onDeleteAllData:s})=>{const[l,u]=H.useState(!1),[f,m]=H.useState(""),p=()=>{i({...n,masterPauseEnabled:!n.masterPauseEnabled,dataProcessingEnabled:!n.masterPauseEnabled})},v=()=>{f==="DELETE MY DATA"&&(s(),u(!1),m(""))},y=e.filter(b=>b.enabled),S=t.length,_=t[0]?.timestamp||"Never";return d.jsxs("div",{children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Privacy & Data Ownership"}),d.jsx("p",{className:"dashboard-subtitle",children:"Your data, your control, your choice. TimeBeacon is your personal assistant, not surveillance software."})]}),d.jsx("div",{style:{display:"flex",gap:"12px"},children:d.jsx("button",{className:`btn ${n.masterPauseEnabled?"btn-danger":"btn-secondary"}`,onClick:p,children:n.masterPauseEnabled?" Tracking Paused":" Pause All Tracking"})})]}),d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"linear-gradient(135deg, var(--brand-primary), var(--brand-accent))",color:"white",border:"none"},children:d.jsxs("div",{style:{padding:"48px 32px"},children:[d.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"24px",color:"white"},children:" Built for Employee Privacy & Empowerment"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"32px"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:" Your Data Stays Yours"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"All content processing happens locally on your machine. Zero raw emails, messages, or documents ever leave your device. You own and control every bit of your data."})]}),d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:" Personal Assistant, Not Surveillance"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"TimeBeacon helps you document your valuable work, not monitor you. Every feature is designed to empower you, not your employer. You control what gets tracked and shared."})]}),d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:" Effortless Exit"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"Want to leave? Export all your data or delete everything with one click. No hidden data, no retention policies, no questions asked. Your choice, your control."})]})]})]})}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:" Data Sources & Permissions"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"You explicitly control what TimeBeacon can access. Every connection requires your consent."})]}),d.jsx("div",{style:{padding:"32px"},children:e.length===0?d.jsxs("div",{style:{textAlign:"center",padding:"48px",color:"var(--text-secondary)"},children:[d.jsx("span",{style:{fontSize:"48px",marginBottom:"16px",display:"block"},children:""}),d.jsx("h3",{children:"No Data Sources Connected"}),d.jsx("p",{children:"TimeBeacon only accesses what you explicitly allow. Connect your tools when you're ready."})]}):d.jsx("div",{style:{display:"grid",gap:"24px"},children:e.map(b=>d.jsxs("div",{className:"integration-card",style:{border:b.enabled?"2px solid var(--success)":"1px solid var(--border)"},children:[d.jsx("div",{className:"integration-header",children:d.jsx("div",{className:"integration-info",children:d.jsxs("div",{className:"integration-icon-name",children:[d.jsxs("div",{className:"integration-icon",children:[b.type==="email"&&"",b.type==="calendar"&&"",b.type==="slack"&&"",b.type==="github"&&"",b.type==="notion"&&"",b.type==="jira"&&"",b.type==="linear"&&""]}),d.jsxs("div",{children:[d.jsx("h3",{className:"integration-name",children:b.name}),d.jsx("p",{className:"integration-description",children:b.enabled?` Active  Last accessed: ${b.lastAccessed?new Date(b.lastAccessed).toLocaleDateString():"Never"}`:" Paused"})]})]})})}),d.jsx("div",{className:"integration-status",children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Total Accesses"}),d.jsx("span",{className:"status-value",children:b.totalAccessCount})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Consent Granted"}),d.jsx("span",{className:"status-value",children:new Date(b.consentGrantedAt).toLocaleDateString()})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Projects Tracked"}),d.jsx("span",{className:"status-value",children:b.permissions.allowedProjects?.length||"All"})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Approval Required"}),d.jsx("span",{className:`status-value ${b.permissions.requireApproval?"enabled":"disabled"}`,children:b.permissions.requireApproval?"Yes":"No"})]})]})}),d.jsxs("div",{style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid var(--border-light)"},children:[d.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"Permissions Granted"}),d.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[b.permissions.canReadMetadata&&d.jsx("span",{className:"integration-badge",children:" Metadata"}),b.permissions.canReadContent&&d.jsx("span",{className:"integration-badge",children:" Content (Local Only)"}),b.permissions.canReadAttachments&&d.jsx("span",{className:"integration-badge",children:" Attachments"}),b.permissions.pausedUntil&&d.jsxs("span",{className:"integration-badge",style:{background:"var(--warning-light)",color:"var(--warning)"},children:[" Paused until ",new Date(b.permissions.pausedUntil).toLocaleDateString()]})]})]})]},b.id))})})]}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:" Transparency Dashboard"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"See exactly what TimeBeacon has accessed and analyzed. No hidden activity."})]}),d.jsxs("div",{style:{padding:"32px"},children:[d.jsxs("div",{className:"stats-grid",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Total Data Accesses"}),d.jsx("div",{className:"stat-value",children:S}),d.jsx("div",{className:"stat-change",children:"All logged and auditable"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Active Data Sources"}),d.jsx("div",{className:"stat-value",children:y.length}),d.jsx("div",{className:"stat-change",children:"You control each one"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Last Activity"}),d.jsx("div",{className:"stat-value",children:_==="Never"?"Never":new Date(_).toLocaleDateString()}),d.jsx("div",{className:"stat-change",children:"Real-time tracking"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Data Retention"}),d.jsxs("div",{className:"stat-value",children:[n.auditLogRetentionDays," days"]}),d.jsx("div",{className:"stat-change",children:n.autoDeleteOldData?" Auto-delete enabled":" Manual cleanup"})]})]}),t.length>0&&d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px"},children:"Recent Activity Log"}),d.jsx("div",{className:"table-container",children:d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Timestamp"}),d.jsx("th",{children:"Action"}),d.jsx("th",{children:"Source"}),d.jsx("th",{children:"Items Processed"}),d.jsx("th",{children:"Processing Time"})]})}),d.jsx("tbody",{children:t.slice(0,10).map(b=>d.jsxs("tr",{children:[d.jsxs("td",{className:"time-value",children:[new Date(b.timestamp).toLocaleDateString()," ",new Date(b.timestamp).toLocaleTimeString()]}),d.jsx("td",{style:{textTransform:"capitalize"},children:b.action.replace("_"," ")}),d.jsx("td",{children:d.jsx("span",{style:{textTransform:"capitalize"},children:b.source})}),d.jsx("td",{children:b.details.itemsAnalyzed||b.details.itemsAccessed||"-"}),d.jsx("td",{children:b.details.processingTimeMs?`${b.details.processingTimeMs}ms`:"-"})]},b.id))})]})})]})]})]}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:" Data Control Center"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Complete control over your data. Export, delete, or modify anything at any time."})]}),d.jsx("div",{style:{padding:"32px"},children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"24px"},children:[d.jsxs("div",{style:{padding:"24px",border:"1px solid var(--border)",borderRadius:"12px",background:"var(--surface)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:" Export Your Data"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"20px",fontSize:"14px"},children:"Download all your time entries, settings, and audit logs. Your data, your format."}),d.jsxs("div",{style:{display:"flex",gap:"8px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>r("json"),children:"Export JSON"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>r("csv"),children:"Export CSV"})]})]}),d.jsxs("div",{style:{padding:"24px",border:"1px solid var(--border)",borderRadius:"12px",background:"var(--surface)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:" Privacy Controls"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.requireManualApproval,onChange:b=>i({...n,requireManualApproval:b.target.checked})}),"Require approval for all AI suggestions"]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.showDetailedAuditLogs,onChange:b=>i({...n,showDetailedAuditLogs:b.target.checked})}),"Show detailed audit logs"]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.autoDeleteOldData,onChange:b=>i({...n,autoDeleteOldData:b.target.checked})}),"Auto-delete old audit logs"]})]})]}),d.jsxs("div",{style:{padding:"24px",border:"2px solid var(--error)",borderRadius:"12px",background:"var(--error-light)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:" Emergency Controls"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"20px",fontSize:"14px"},children:"Need to stop everything immediately? These controls give you instant control."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsx("button",{className:"btn btn-danger",onClick:p,children:n.masterPauseEnabled?" Resume All Tracking":" Pause All Tracking"}),d.jsx("button",{className:"btn btn-danger",onClick:()=>u(!0),children:" Delete All Data"})]})]})]})})]}),l&&d.jsx("div",{className:"modal-overlay",onClick:()=>u(!1),children:d.jsxs("div",{className:"modal-content",onClick:b=>b.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:" Delete All Data"}),d.jsx("button",{className:"modal-close",onClick:()=>u(!1),children:""})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{background:"var(--error-light)",padding:"16px",borderRadius:"8px",marginBottom:"24px"},children:[d.jsx("p",{style:{color:"var(--error)",fontWeight:"600",marginBottom:"8px"},children:"This action cannot be undone!"}),d.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"This will permanently delete:"}),d.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px",color:"var(--text-secondary)",fontSize:"14px"},children:[d.jsx("li",{children:"All time entries and projects"}),d.jsx("li",{children:"All data source connections"}),d.jsx("li",{children:"All audit logs and analysis data"}),d.jsx("li",{children:"All settings and preferences"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{fontWeight:"600"},children:'Type "DELETE MY DATA" to confirm:'}),d.jsx("input",{type:"text",value:f,onChange:b=>m(b.target.value),className:"form-input",placeholder:"DELETE MY DATA",style:{marginTop:"8px"}})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>{u(!1),m("")},children:"Cancel"}),d.jsx("button",{className:"btn btn-danger",onClick:v,disabled:f!=="DELETE MY DATA",children:"Delete Everything"})]})]})}),d.jsx("div",{className:"content-card",style:{background:"var(--surface)",border:"1px solid var(--success)"},children:d.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--success)"},children:" Our Privacy Commitment"}),d.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[d.jsx("p",{style:{fontSize:"16px",lineHeight:"1.6",color:"var(--text-secondary)",marginBottom:"24px"},children:"TimeBeacon exists to empower you, not monitor you. We've designed every feature with your privacy and autonomy in mind. Your work is valuable, and you deserve tools that respect that value."}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",fontSize:"14px"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:" Local Processing"}),d.jsx("br",{}),"Content never leaves your device"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Full Transparency"}),d.jsx("br",{}),"See exactly what we access"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Complete Control"}),d.jsx("br",{}),"Pause, export, or delete anytime"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" No Hidden Data"}),d.jsx("br",{}),"What you see is what we have"]})]})]})]})})]})},WM=({aiEnabled:n,onToggleAI:e})=>{const[t,i]=H.useState([]),[r,s]=H.useState("overview"),[l,u]=H.useState(bc.getStatus()),[f,m]=H.useState(Ps.getStatus()),[p,v]=H.useState(Fs.getStats()),[y,S]=H.useState(!1),[_,b]=H.useState(null),[T,E]=H.useState({confidenceThreshold:.8,descriptionLength:"standard",autoApprove:!1,gmailDomainFilter:{enabled:!0,companyDomain:"@timebeacon.io",excludeInternal:!0},slackChannelFilter:{enabled:!0,includedChannels:[],keywords:["client","project","meeting"]},slackParticipantFilter:{enabled:!1,includedParticipants:[]},retentionPolicy:{deleteRawDataAfterProcessing:!0,keepStructuredDataDays:1}});H.useEffect(()=>{(async()=>{try{const be=await Yo.getAIControlSettings();be.settings&&E(be.settings)}catch(be){console.error("Failed to load AI Control settings:",be);const Ne=localStorage.getItem("aiControlSettings");Ne&&E(JSON.parse(Ne))}})()},[]),H.useEffect(()=>{const Z=()=>{const Ne=Fs.getStoredSuggestions();i(Ne)};Z();const be=setInterval(Z,3e4);return()=>clearInterval(be)},[]),H.useEffect(()=>{const be=setInterval(()=>{u(bc.getStatus()),m(Ps.getStatus()),v(Fs.getStats())},5e3);return()=>clearInterval(be)},[]);const w=async Z=>{E(Z);try{await Yo.updateAIControlSettings(Z),console.log("AI Control settings saved to database")}catch(be){console.error("Failed to save AI Control settings:",be),localStorage.setItem("aiControlSettings",JSON.stringify(Z))}},C=(Z,be)=>{const Ne={...T},V=Z.split(".");let he=Ne;for(let I=0;I<V.length-1;I++)he=he[V[I]];he[V[V.length-1]]=be,w(Ne)},j=(Z,be)=>{const Ne={...T},V=Z.split(".");let he=Ne;for(let Y=0;Y<V.length-1;Y++)he=he[V[Y]];const I=he[V[V.length-1]];!I.includes(be)&&be.trim()&&(I.push(be.trim()),w(Ne))},k=(Z,be)=>{const Ne={...T},V=Z.split(".");let he=Ne;for(let G=0;G<V.length-1;G++)he=he[V[G]];const I=he[V[V.length-1]],Y=I.indexOf(be);Y>-1&&(I.splice(Y,1),w(Ne))},P=async()=>{S(!0),b(null);try{const Z=await Yo.testAI();b(Z.result||Z)}catch{b({success:!1,error:"Test failed"})}finally{S(!1)}},D=async()=>{try{const Z=await Ps.testConnection();console.log("Calendar test result:",Z)}catch(Z){console.error("Calendar test failed:",Z)}},z=async()=>{try{const Z=await Ps.forceSync();console.log("Force sync result:",Z)}catch(Z){console.error("Force sync failed:",Z)}},R=[{id:"overview",label:" Overview",icon:""},{id:"processing",label:" Processing",icon:""},{id:"gmail",label:" Gmail",icon:""},{id:"slack",label:" Slack",icon:""},{id:"privacy",label:" Privacy",icon:""},{id:"engine",label:" AI Engine",icon:""}];return d.jsxs("div",{className:"content-card",children:[d.jsxs("div",{className:"card-header",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[d.jsx("h2",{className:"card-title",children:" AI Control Center"}),d.jsx("div",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px",background:n&&l.available?"linear-gradient(135deg, #10b981, #34d399)":"linear-gradient(135deg, #6b7280, #9ca3af)",color:"white"},children:n&&l.available?"Active":"Inactive"})]}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Configure intelligent time tracking from workplace activity data"}),d.jsx("div",{className:"tab-navigation",style:{display:"flex",gap:"4px",marginTop:"20px",borderBottom:"1px solid var(--border)",paddingBottom:"0"},children:R.map(Z=>d.jsxs("button",{onClick:()=>s(Z.id),className:`tab-button ${r===Z.id?"active":""}`,style:{background:r===Z.id?"var(--brand-primary)":"transparent",color:r===Z.id?"white":"var(--text-secondary)",border:"none",padding:"12px 20px",borderRadius:"8px 8px 0 0",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",marginBottom:"-1px",borderBottom:r===Z.id?"2px solid var(--brand-primary)":"2px solid transparent"},children:[d.jsx("span",{children:Z.icon}),d.jsx("span",{children:Z.label.split(" ").slice(1).join(" ")})]},Z.id))})]}),d.jsx("div",{style:{padding:"32px"},children:d.jsx("div",{className:"ai-control-content",children:W()})})]});function W(){if(!n&&r!=="overview")return d.jsx("div",{className:"inactive-state",children:d.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",background:"var(--background-secondary)",borderRadius:"12px",border:"2px dashed var(--border)"},children:[d.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:""}),d.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"AI Control Center Disabled"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",maxWidth:"500px",margin:"0 auto 24px"},children:"Enable AI to configure intelligent time tracking from workplace activities."}),d.jsx("button",{className:"btn btn-primary",onClick:e,style:{fontSize:"16px",padding:"12px 24px"},children:" Enable AI Control Center"})]})});switch(r){case"overview":return q();case"processing":return J();case"gmail":return me();case"slack":return Ce();case"privacy":return ve();case"engine":return ne();default:return q()}}function q(){return n?d.jsxs("div",{children:[d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" System Overview"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"AI Processing"}),d.jsx("div",{className:`status-value ${l.available&&n?"status-success":"status-error"}`,children:l.available&&n?" Active":" Inactive"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Confidence Threshold"}),d.jsxs("div",{className:"status-value",children:[Math.round(T.confidenceThreshold*100),"%"]})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Pending Suggestions"}),d.jsx("div",{className:"status-value",children:t.length})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Description Style"}),d.jsx("div",{className:"status-value",style:{textTransform:"capitalize"},children:T.descriptionLength})]})]}),d.jsx("div",{style:{display:"flex",gap:"12px",marginBottom:"32px"},children:d.jsx("button",{className:`btn ${n?"btn-danger":"btn-primary"}`,onClick:e,style:{minWidth:"140px"},children:n?" Disable AI":" Enable AI"})})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Quick Settings"}),d.jsxs("div",{style:{display:"grid",gap:"20px"},children:[d.jsx("div",{className:"setting-item",children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:"Gmail Domain Filtering"}),d.jsx("div",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:"Only process emails with external participants"})]}),d.jsx("div",{className:`status-value ${T.gmailDomainFilter.enabled?"status-success":"status-warning"}`,children:T.gmailDomainFilter.enabled?"Enabled":"Disabled"})]})}),d.jsx("div",{className:"setting-item",children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:"Slack Channel Filtering"}),d.jsxs("div",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:[T.slackChannelFilter.keywords.length," keywords configured"]})]}),d.jsx("div",{className:`status-value ${T.slackChannelFilter.enabled?"status-success":"status-warning"}`,children:T.slackChannelFilter.enabled?"Enabled":"Disabled"})]})}),d.jsx("div",{className:"setting-item",children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:"Auto-Approval"}),d.jsxs("div",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:["Entries above ",Math.round(T.confidenceThreshold*100),"% confidence"]})]}),d.jsx("div",{className:`status-value ${T.autoApprove?"status-success":"status-warning"}`,children:T.autoApprove?"Enabled":"Manual Review"})]})})]})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Recent AI Activity"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{style:{background:"var(--success-light)",padding:"20px",borderRadius:"12px",border:"1px solid var(--success)",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--success-dark)",marginBottom:"4px"},children:t.length}),d.jsx("div",{style:{fontSize:"14px",color:"var(--success-dark)",fontWeight:"500"},children:"Pending Suggestions"})]}),d.jsxs("div",{style:{background:"var(--info-light)",padding:"20px",borderRadius:"12px",border:"1px solid var(--info)",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--info-dark)",marginBottom:"4px"},children:f.processedEventsCount||0}),d.jsx("div",{style:{fontSize:"14px",color:"var(--info-dark)",fontWeight:"500"},children:"Events Processed"})]}),d.jsxs("div",{style:{background:l.available?"var(--success-light)":"var(--warning-light)",padding:"20px",borderRadius:"12px",border:`1px solid ${l.available?"var(--success)":"var(--warning)"}`,textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:l.available?"var(--success-dark)":"var(--warning-dark)",marginBottom:"4px"},children:l.available?" Online":" Offline"}),d.jsx("div",{style:{fontSize:"14px",color:l.available?"var(--success-dark)":"var(--warning-dark)",fontWeight:"500"},children:"AI Engine Status"})]})]}),t.length>0?d.jsxs("div",{style:{marginTop:"20px"},children:[d.jsxs("h4",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:["Recent Suggestions (showing ",Math.min(3,t.length)," of ",t.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:t.slice(0,3).map(Z=>d.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border)",borderRadius:"8px",padding:"12px",fontSize:"14px"},children:[d.jsx("div",{style:{fontWeight:"500",marginBottom:"4px"},children:Z.activity||"Unknown Activity"}),d.jsxs("div",{style:{color:"var(--text-secondary)",fontSize:"12px"},children:[Z.source,"  Confidence: ",Math.round((Z.confidence||0)*100),"%"]})]},Z.id))}),t.length>3&&d.jsx("div",{style:{textAlign:"center",marginTop:"12px"},children:d.jsxs("span",{style:{color:"var(--text-secondary)",fontSize:"13px"},children:["+",t.length-3," more suggestions available"]})})]}):d.jsxs("div",{style:{textAlign:"center",padding:"20px",background:"var(--background-secondary)",borderRadius:"8px",border:"1px solid var(--border)",marginTop:"20px"},children:[d.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:""}),d.jsx("div",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:"No pending suggestions. AI is monitoring your activities."})]})]})]}):d.jsx("div",{className:"inactive-state",children:d.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",background:"var(--background-secondary)",borderRadius:"12px",border:"2px dashed var(--border)"},children:[d.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:""}),d.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"Welcome to AI Control Center"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",maxWidth:"600px",margin:"0 auto 24px"},children:"Configure intelligent time tracking from Gmail, Calendar, Zoom, and Slack activities. The AI agent will automatically filter, classify, and create time entries based on your preferences."}),d.jsxs("div",{style:{display:"flex",gap:"16px",justifyContent:"center",flexWrap:"wrap"},children:[d.jsx("button",{className:"btn btn-primary",onClick:e,style:{fontSize:"16px",padding:"12px 24px"},children:" Enable AI Processing"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>s("processing"),style:{fontSize:"16px",padding:"12px 24px"},children:" Configure Settings"})]})]})})}function J(){return d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Processing Configuration"}),d.jsxs("div",{style:{display:"grid",gap:"24px"},children:[d.jsxs("div",{className:"setting-item",children:[d.jsxs("label",{className:"setting-label",children:[" Confidence Threshold",d.jsx("span",{className:"setting-description",children:"Minimum AI confidence required for auto-approval (below this requires review)"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[d.jsx("input",{type:"range",min:"0.5",max:"0.95",step:"0.05",value:T.confidenceThreshold,onChange:Z=>C("confidenceThreshold",parseFloat(Z.target.value)),style:{flex:1}}),d.jsxs("span",{className:"confidence-value",children:[Math.round(T.confidenceThreshold*100),"%"]}),d.jsxs("label",{className:"checkbox-container",children:[d.jsx("input",{type:"checkbox",checked:T.autoApprove,onChange:Z=>C("autoApprove",Z.target.checked)}),"Auto-approve high confidence entries"]})]})]}),d.jsxs("div",{className:"setting-item",children:[d.jsxs("label",{className:"setting-label",children:[" Description Length",d.jsx("span",{className:"setting-description",children:"How detailed should AI-generated descriptions be?"})]}),d.jsx("div",{className:"radio-group",children:[{value:"brief",label:"Brief (1-20 words)",example:'"Client pricing discussion"'},{value:"standard",label:"Standard (20-40 words)",example:'"Exchanged emails with client about pricing adjustments and timeline estimates"'},{value:"detailed",label:"Detailed (40-100 words)",example:'"Extensive email thread with client Bob regarding pricing revisions to the proposal. Clarified cost structures, updated timeline estimates, and confirmed next steps for contract approval."'}].map(Z=>d.jsxs("label",{className:"radio-option",children:[d.jsx("input",{type:"radio",name:"descriptionLength",value:Z.value,checked:T.descriptionLength===Z.value,onChange:be=>C("descriptionLength",be.target.value)}),d.jsxs("div",{children:[d.jsx("strong",{children:Z.label}),d.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:["Example: ",Z.example]})]})]},Z.value))})]})]})]})}function me(){return d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Gmail Integration"}),d.jsxs("div",{style:{display:"grid",gap:"16px"},children:[d.jsxs("label",{className:"checkbox-container",children:[d.jsx("input",{type:"checkbox",checked:T.gmailDomainFilter.enabled,onChange:Z=>C("gmailDomainFilter.enabled",Z.target.checked)}),"Enable Gmail domain filtering"]}),T.gmailDomainFilter.enabled&&d.jsxs("div",{className:"filter-config",children:[d.jsxs("div",{className:"setting-item",children:[d.jsx("label",{className:"setting-label",children:"Company Domain"}),d.jsx("input",{type:"text",value:T.gmailDomainFilter.companyDomain,onChange:Z=>C("gmailDomainFilter.companyDomain",Z.target.value),placeholder:"@yourcompany.com",className:"setting-input"})]}),d.jsxs("label",{className:"checkbox-container",children:[d.jsx("input",{type:"checkbox",checked:T.gmailDomainFilter.excludeInternal,onChange:Z=>C("gmailDomainFilter.excludeInternal",Z.target.checked)}),"Only track emails with external participants (exclude internal company emails)"]}),d.jsx("div",{className:"info-box",children:d.jsxs("p",{children:[d.jsx("strong",{children:"How it works:"})," Only emails involving people outside your company domain will be processed for time tracking. Internal company discussions will be ignored."]})})]})]})]})}function Ce(){return d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Slack Integration"}),d.jsxs("div",{style:{display:"grid",gap:"24px"},children:[d.jsxs("div",{children:[d.jsxs("label",{className:"checkbox-container",children:[d.jsx("input",{type:"checkbox",checked:T.slackChannelFilter.enabled,onChange:Z=>C("slackChannelFilter.enabled",Z.target.checked)}),"Enable Slack channel filtering"]}),T.slackChannelFilter.enabled&&d.jsx("div",{className:"filter-config",children:d.jsxs("div",{className:"setting-item",children:[d.jsx("label",{className:"setting-label",children:"Channel Keywords"}),d.jsxs("div",{className:"tag-input-container",children:[d.jsx("div",{className:"tags",children:T.slackChannelFilter.keywords.map(Z=>d.jsxs("span",{className:"tag",children:[Z,d.jsx("button",{onClick:()=>k("slackChannelFilter.keywords",Z),className:"tag-remove",children:""})]},Z))}),d.jsx("input",{type:"text",placeholder:"Add keyword (e.g., 'client', 'project')...",onKeyDown:Z=>{Z.key==="Enter"&&(j("slackChannelFilter.keywords",Z.currentTarget.value),Z.currentTarget.value="")},className:"tag-input"})]}),d.jsx("div",{className:"info-box",children:d.jsx("p",{children:"Only process messages from channels containing these keywords in their name."})})]})})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"checkbox-container",children:[d.jsx("input",{type:"checkbox",checked:T.slackParticipantFilter.enabled,onChange:Z=>C("slackParticipantFilter.enabled",Z.target.checked)}),"Enable Slack participant filtering"]}),T.slackParticipantFilter.enabled&&d.jsx("div",{className:"filter-config",children:d.jsxs("div",{className:"setting-item",children:[d.jsx("label",{className:"setting-label",children:"Included Participants"}),d.jsxs("div",{className:"tag-input-container",children:[d.jsx("div",{className:"tags",children:T.slackParticipantFilter.includedParticipants.map(Z=>d.jsxs("span",{className:"tag",children:["@",Z,d.jsx("button",{onClick:()=>k("slackParticipantFilter.includedParticipants",Z),className:"tag-remove",children:""})]},Z))}),d.jsx("input",{type:"text",placeholder:"Add username (without @)...",onKeyDown:Z=>{Z.key==="Enter"&&(j("slackParticipantFilter.includedParticipants",Z.currentTarget.value),Z.currentTarget.value="")},className:"tag-input"})]}),d.jsx("div",{className:"info-box",children:d.jsx("p",{children:"Only process messages that include these specific participants."})})]})})]})]})]})}function ve(){return d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Data Retention & Privacy"}),d.jsxs("div",{style:{display:"grid",gap:"16px"},children:[d.jsxs("label",{className:"checkbox-container",children:[d.jsx("input",{type:"checkbox",checked:T.retentionPolicy.deleteRawDataAfterProcessing,onChange:Z=>C("retentionPolicy.deleteRawDataAfterProcessing",Z.target.checked)}),"Delete raw transcripts/emails/messages after processing (recommended)"]}),d.jsxs("div",{className:"setting-item",children:[d.jsxs("label",{className:"setting-label",children:["Keep structured time entries for",d.jsx("span",{className:"setting-description",children:"How long to retain processed time entries before cleanup"})]}),d.jsxs("select",{value:T.retentionPolicy.keepStructuredDataDays,onChange:Z=>C("retentionPolicy.keepStructuredDataDays",parseInt(Z.target.value)),className:"setting-select",children:[d.jsx("option",{value:0,children:"Immediate deletion"}),d.jsx("option",{value:1,children:"24 hours (recommended)"}),d.jsx("option",{value:7,children:"7 days"}),d.jsx("option",{value:30,children:"30 days"}),d.jsx("option",{value:90,children:"90 days"}),d.jsx("option",{value:365,children:"1 year"}),d.jsx("option",{value:-1,children:"Forever"})]})]}),d.jsxs("div",{className:"privacy-info",children:[d.jsx("h4",{children:" Privacy Protection"}),d.jsxs("ul",{children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Local Processing:"})," All AI analysis happens on your device"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"No External Transmission:"})," Raw workplace data never leaves your computer"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Selective Storage:"})," Only structured time entries are saved, not raw content"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"User Control:"})," Review and approve all AI-generated entries"]})]})]})]})]})}function ne(){return d.jsxs("div",{children:[d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Local AI Engine (Ollama)"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"AI Service"}),d.jsx("div",{className:`status-value ${l.available?"status-success":"status-error"}`,children:l.available?" Available":" Not Available"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Model"}),d.jsx("div",{className:"status-value",children:l.model})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Processing"}),d.jsx("div",{className:`status-value ${l.enabled?"status-success":"status-warning"}`,children:l.enabled?" Enabled":" Disabled"})]})]}),!l.available&&d.jsxs("div",{className:"alert alert-info",children:[d.jsx("h4",{children:" Ollama Setup Required"}),d.jsx("p",{children:"To enable local AI processing, install Ollama and the required model:"}),d.jsx("div",{className:"code-block",children:d.jsxs("code",{children:["# Install Ollama (macOS/Linux)",d.jsx("br",{}),"curl -fsSL https://ollama.com/install.sh | sh",d.jsx("br",{}),d.jsx("br",{}),"# Pull the model",d.jsx("br",{}),"ollama pull llama3.2:3b",d.jsx("br",{}),d.jsx("br",{}),"# Start Ollama service",d.jsx("br",{}),"ollama serve"]})}),d.jsxs("p",{style:{marginTop:"16px"},children:[d.jsx("strong",{children:"Privacy Note:"})," All AI processing happens locally on your machine. No data is sent to external servers."]})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"16px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:P,disabled:y,children:y?" Testing...":" Test AI Service"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>bc.checkOllamaAvailability(),children:" Refresh Status"})]}),_&&d.jsx("div",{className:`alert ${_.success?"alert-success":"alert-error"}`,style:{marginTop:"16px"},children:_.success?d.jsxs("p",{children:[" AI service test successful! Latency: ",_.latency,"ms"]}):d.jsxs("p",{children:[" AI service test failed: ",_.error]})})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Content Analyzer"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Queue Length"}),d.jsx("div",{className:"status-value",children:p.queueLength})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Processing"}),d.jsx("div",{className:`status-value ${p.isProcessing?"status-warning":"status-success"}`,children:p.isProcessing?" Active":" Idle"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Cache Size"}),d.jsx("div",{className:"status-value",children:p.cacheSize})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Total Suggestions"}),d.jsx("div",{className:"status-value",children:p.totalSuggestions})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Pending Review"}),d.jsx("div",{className:"status-value",children:p.pendingSuggestions})]})]}),d.jsx("div",{style:{display:"flex",gap:"12px"},children:d.jsx("button",{className:"btn btn-secondary",onClick:()=>Fs.clearOldSuggestions(7),children:" Clear Old Suggestions"})})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Calendar Integration"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Status"}),d.jsx("div",{className:`status-value ${f.enabled?"status-success":"status-warning"}`,children:f.enabled?" Connected":" Disconnected"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Last Sync"}),d.jsx("div",{className:"status-value",children:f.lastSync?new Date(f.lastSync).toLocaleString():"Never"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Events Processed"}),d.jsx("div",{className:"status-value",children:f.processedEventsCount})]})]}),d.jsxs("div",{style:{display:"flex",gap:"12px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:D,children:" Test Connection"}),d.jsx("button",{className:"btn btn-secondary",onClick:z,children:" Force Sync"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>Ps.clearHistory(),children:" Clear History"})]})]})]})}},VM=n=>({defaultClients:[],defaultProjects:[],workingHours:{start:n.workingHours?.start||"09:00",end:n.workingHours?.end||"17:00",timezone:n.timezone||"UTC"},billableByDefault:!0,autoTrackMeetings:!0,autoTrackSlack:!1,minimumSessionLength:15,notifications:n.notifications?.enableDesktop||!0,autoBreaks:!1,theme:n.theme||"light",emailNotifications:{enabled:!1,dailyReviewTime:"17:00",approvalReminders:!0,weeklyDigest:!0,email:""},integrations:Object.entries(n.integrations||{}).map(([e,t])=>({id:e,name:e,enabled:t.enabled||!1,lastSync:t.lastSync,settings:t.settings||{}}))}),GM=()=>{const n=cS(),e=H.useCallback(S=>{const _={...S,id:crypto.randomUUID()};return n.addTimeEntry(S).catch(b=>{console.error("Failed to persist time entry:",b)}),_},[n]),t=H.useCallback((S,_)=>{n.updateTimeEntry(S,_).catch(b=>{console.error("Failed to update time entry:",b)})},[n]),i=H.useCallback(S=>{n.deleteTimeEntry(S).catch(_=>{console.error("Failed to delete time entry:",_)})},[n]),r=H.useCallback(S=>{const _={...S,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return n.addProject(S).catch(b=>{console.error("Failed to persist project:",b)}),_},[n]),s=H.useCallback((S,_)=>{n.updateProject(S,_).catch(b=>{console.error("Failed to update project:",b)})},[n]),l=H.useCallback(S=>{n.deleteProject(S).catch(_=>{console.error("Failed to delete project:",_)})},[n]),u=H.useCallback(S=>{const _={...S,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return n.addClient(S).catch(b=>{console.error("Failed to persist client:",b)}),_},[n]),f=H.useCallback((S,_)=>{n.updateClient(S,_).catch(b=>{console.error("Failed to update client:",b)})},[n]),m=H.useCallback(S=>{n.deleteClient(S).catch(_=>{console.error("Failed to delete client:",_)})},[n]),p=H.useCallback(S=>{const _={theme:S.theme,timezone:S.workingHours.timezone,workingHours:{start:S.workingHours.start,end:S.workingHours.end,workingDays:[1,2,3,4,5]},notifications:{enableDesktop:S.notifications,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:S.integrations.reduce((b,T)=>(b[T.id]={enabled:T.enabled,lastSync:T.lastSync,settings:T.settings},b),{})};n.setSettings(_).catch(b=>{console.error("Failed to update settings:",b)})},[n]),v=H.useCallback(S=>{n.toggleIntegration(S)},[n]),y=H.useMemo(()=>{const S=new Date().toISOString().split("T")[0],_=new Date,b=new Date(_.getFullYear(),_.getMonth(),_.getDate()-_.getDay()),T=new Date(_.getFullYear(),_.getMonth(),1),E=n.timeEntries.filter(R=>R.date===S),w=n.timeEntries.filter(R=>new Date(R.date)>=b),C=n.timeEntries.filter(R=>new Date(R.date)>=T),j=E.reduce((R,W)=>R+W.duration,0),k=w.reduce((R,W)=>R+W.duration,0),P=C.reduce((R,W)=>R+W.duration,0),D=n.timeEntries.filter(R=>R.billable&&R.status==="approved"),z=D.reduce((R,W)=>R+W.duration*100,0);return{todayHours:j,weekHours:k,monthHours:P,billableHours:D.reduce((R,W)=>R+W.duration,0),nonBillableHours:n.timeEntries.filter(R=>!R.billable).reduce((R,W)=>R+W.duration,0),pendingEntries:n.timeEntries.filter(R=>R.status==="pending").length,totalClients:n.clients.length,activeProjects:n.projects.filter(R=>R.active).length,totalEarnings:z,utilizationRate:k>0?D.filter(R=>w.includes(R)).reduce((R,W)=>R+W.duration,0)/k*100:0,automatedEntries:C.filter(R=>R.automated).length}},[n.timeEntries,n.projects,n.clients]);return{timeEntries:n.timeEntries,projects:n.projects,clients:n.clients,settings:VM(n.settings),stats:y,isLoading:n.isLoading,error:n.error,addTimeEntry:e,updateTimeEntry:t,deleteTimeEntry:i,addProject:r,updateProject:s,deleteProject:l,addClient:u,updateClient:f,deleteClient:m,setSettings:p,toggleIntegration:v,exportData:n.exportData,clearAllData:n.clearAllData}};function _i(){const n=Wr(),e=ff(),[t,i]=H.useState(!1),[r]=H.useState(!0),s=GM(),l=()=>{const _=n.pathname;return _.includes("/reports")?"reports":_.includes("/ai-insights")?"ai-insights":_.includes("/permissions")?"permissions":_.includes("/settings")?"settings":_.includes("/privacy")?"privacy":_.includes("/integrations")?"integrations":"dashboard"},[u,f]=H.useState(l());H.useEffect(()=>{f(l())},[n.pathname]);const m=_=>{e(`/${_}`),f(_)},p=()=>{const _=!t;i(_),bc.updateConfig({enabled:_}),console.log(_?" AI analysis enabled":" AI analysis paused")},v=async(_,b)=>{try{await Fs.approveSuggestion(_,b),console.log(" Suggestion approved and time entry created")}catch(T){console.error("Failed to approve suggestion:",T)}},y=async(_,b)=>{try{await Fs.rejectSuggestion(_,b),console.log(" Suggestion rejected:",b)}catch(T){console.error("Failed to reject suggestion:",T)}},S=()=>{switch(u){case"dashboard":return d.jsx(Kv,{entries:s.timeEntries,projects:s.projects,onUpdateEntry:s.updateTimeEntry,onDeleteEntry:s.deleteTimeEntry,onAddEntry:s.addTimeEntry});case"reports":return r?d.jsx(OM,{}):d.jsx(GE,{entries:s.timeEntries,projects:s.projects});case"ai-insights":return d.jsx(WM,{onApproveSuggestion:v,onRejectSuggestion:y,aiEnabled:t,onToggleAI:p});case"integrations":return d.jsx(UM,{});case"permissions":return d.jsx(RM,{});case"settings":return d.jsx(MM,{});case"privacy":return d.jsx(HM,{privacySettings:{dataProcessingEnabled:!0,auditLogRetentionDays:30,contentAnalysisRetentionDays:7,autoDeleteOldData:!0,aiAnalysisEnabled:!0,maxConfidenceThreshold:.7,requireManualApproval:!0,showDetailedAuditLogs:!0,notifyOnDataAccess:!1,exportFormat:"json",masterPauseEnabled:!1,emergencyWipeEnabled:!0},dataSources:[],auditLogs:[],onUpdatePrivacySettings:()=>{},onExportData:s.exportData,onDeleteAllData:s.clearAllData});default:return d.jsx(Kv,{entries:s.timeEntries,projects:s.projects,onUpdateEntry:s.updateTimeEntry,onDeleteEntry:s.deleteTimeEntry,onAddEntry:s.addTimeEntry})}};return s.isLoading?d.jsx("div",{className:"app-container",children:d.jsxs("div",{className:"loading-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"24px",background:"var(--background)"},children:[d.jsx("div",{className:"loading-spinner",style:{width:"48px",height:"48px",border:"4px solid var(--border)",borderTop:"4px solid var(--brand-primary)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),d.jsxs("div",{style:{textAlign:"center",color:"var(--text-secondary)"},children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"8px",color:"var(--text-primary)"},children:" Initializing TimeBeacon"}),d.jsx("p",{children:"Setting up your local-first database..."})]})]})}):s.error?d.jsx("div",{className:"app-container",children:d.jsx("div",{className:"error-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"24px",background:"var(--background)",padding:"32px"},children:d.jsxs("div",{style:{textAlign:"center",maxWidth:"500px"},children:[d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--error)"},children:" Database Error"}),d.jsxs("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",lineHeight:"1.6"},children:["Failed to initialize the local database: ",s.error]}),d.jsx("button",{className:"btn btn-primary",onClick:()=>window.location.reload(),children:" Retry"})]})})}):d.jsxs("div",{className:"app-container",children:[d.jsx(RE,{activeItem:u,onItemClick:m}),d.jsx("main",{className:"main-content","data-testid":"main-content",children:S()})]})}const YM=()=>{const n=Wr(),[e,t]=H.useState({status:"loading",message:"Processing authorization..."});H.useEffect(()=>{(async()=>{try{console.log(" Processing OAuth callback...");const s=new URLSearchParams(n.search),l=s.get("code"),u=s.get("state"),f=s.get("error");if(f){const b=s.get("error_description")||"Unknown OAuth error";throw new Error(`OAuth Error: ${f} - ${b}`)}if(!l||!u)throw new Error("Missing required OAuth parameters (code or state)");const m=sessionStorage.getItem("google_oauth_state"),p=sessionStorage.getItem("google_oauth_code_verifier");if(!m)throw new Error("Missing OAuth state in session. Please try again.");if(!p)throw new Error("Missing PKCE code verifier in session. Please try again.");t({status:"loading",message:"Exchanging authorization code for access tokens..."});const v=await qa.exchangeCodeForTokens(l,u,m,p);console.log(" OAuth tokens received successfully"),t({status:"loading",message:"Testing API connections..."});const y=await qa.runAllTests(),S=y.filter(b=>b.status==="success").length,_=y.length;t({status:"success",message:`Successfully connected! ${S}/${_} APIs working properly.`,details:{tokenResponse:{hasAccessToken:!!v.access_token,hasRefreshToken:!!v.refresh_token,expiresIn:v.expires_in,scope:v.scope},apiTests:y.map(b=>({service:b.service,status:b.status,executionTime:b.executionTimeMs}))}}),sessionStorage.removeItem("google_oauth_state"),sessionStorage.removeItem("google_oauth_code_verifier"),sessionStorage.removeItem("connecting_service"),window.opener&&window.opener.postMessage({type:"OAUTH_SUCCESS",data:{tokenResponse:v,testResults:y}},window.location.origin),setTimeout(()=>{window.close()},2e3)}catch(s){console.error(" OAuth callback error:",s);const l=s instanceof Error?s.message:"Unknown error occurred";t({status:"error",message:l,details:{error:l,timestamp:new Date().toISOString(),url:n.search}}),window.opener&&window.opener.postMessage({type:"OAUTH_ERROR",error:l},window.location.origin),setTimeout(()=>{window.close()},5e3)}})()},[n.search]);const i=()=>{switch(e.status){case"loading":return d.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTop:"4px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"}});case"success":return d.jsx("div",{style:{width:"48px",height:"48px",backgroundColor:"#10b981",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",color:"white",fontSize:"24px"},children:""});case"error":return d.jsx("div",{style:{width:"48px",height:"48px",backgroundColor:"#ef4444",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",color:"white",fontSize:"24px"},children:""})}};return d.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9fafb",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',padding:"24px"},children:d.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"32px",maxWidth:"400px",width:"100%",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",textAlign:"center"},children:[i(),d.jsxs("h2",{style:{fontSize:"20px",fontWeight:"600",color:"#111827",marginBottom:"8px",margin:"0 0 8px 0"},children:[e.status==="loading"&&"Connecting to Google...",e.status==="success"&&"Connection Successful!",e.status==="error"&&"Connection Failed"]}),d.jsx("p",{style:{color:"#6b7280",fontSize:"14px",lineHeight:"1.5",marginBottom:"24px",margin:"0 0 24px 0"},children:e.message}),e.status==="success"&&e.details&&d.jsxs("div",{style:{backgroundColor:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:"8px",padding:"16px",marginBottom:"24px",textAlign:"left"},children:[d.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#0c4a6e",marginBottom:"12px",margin:"0 0 12px 0"},children:"Connection Details:"}),d.jsx("div",{style:{fontSize:"13px",color:"#0c4a6e"},children:e.details.apiTests.map((r,s)=>d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[d.jsxs("span",{children:[r.service," API"]}),d.jsx("span",{style:{color:r.status==="success"?"#059669":"#dc2626",fontWeight:"500"},children:r.status==="success"?" Connected":" Failed"})]},s))})]}),e.status==="error"&&d.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"16px",marginBottom:"24px",textAlign:"left"},children:[d.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#b91c1c",marginBottom:"8px",margin:"0 0 8px 0"},children:"What went wrong:"}),d.jsx("p",{style:{fontSize:"13px",color:"#b91c1c",margin:"0 0 12px 0",fontFamily:"monospace",backgroundColor:"rgba(239, 68, 68, 0.1)",padding:"8px",borderRadius:"4px"},children:e.details?.error}),d.jsx("h5",{style:{fontSize:"13px",fontWeight:"600",color:"#b91c1c",marginBottom:"6px",margin:"0 0 6px 0"},children:"Troubleshooting:"}),d.jsxs("ul",{style:{fontSize:"12px",color:"#b91c1c",paddingLeft:"16px",margin:0},children:[d.jsx("li",{children:"Check if popups are blocked"}),d.jsx("li",{children:"Verify Google Cloud Console setup"}),d.jsx("li",{children:"Ensure APIs are enabled"}),d.jsx("li",{children:"Check redirect URI configuration"})]})]}),d.jsxs("div",{style:{fontSize:"12px",color:"#9ca3af"},children:[e.status==="success"&&"This window will close automatically...",e.status==="error"&&"You can close this window and try again.",e.status==="loading"&&"Please wait while we connect..."]})]})})};function $M(){return d.jsx(bE,{children:d.jsx(EE,{children:d.jsx(cE,{children:d.jsxs(zw,{children:[d.jsx(Tn,{path:"/login",element:d.jsx(DE,{})}),d.jsx(Tn,{path:"/signup",element:d.jsx(NE,{})}),d.jsx(Tn,{path:"/auth/google/callback",element:d.jsx(YM,{})}),d.jsx(Tn,{path:"/:accountId/:visitorId/dashboard",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/:accountId/:visitorId/reports",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/:accountId/:visitorId/ai-insights",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/:accountId/:visitorId/permissions",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/:accountId/:visitorId/settings",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/:accountId/:visitorId/privacy",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/:accountId/:visitorId/integrations",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/dashboard",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/reports",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/ai-insights",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/permissions",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/settings",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/privacy",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/integrations",element:d.jsx(bi,{children:d.jsx(_i,{})})}),d.jsx(Tn,{path:"/",element:d.jsx(cb,{to:"/dashboard",replace:!0})})]})})})})}KT.createRoot(document.getElementById("root")).render(d.jsx(Go.StrictMode,{children:d.jsx($M,{})}));
