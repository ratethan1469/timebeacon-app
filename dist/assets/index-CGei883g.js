(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function sp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fm={exports:{}},tc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bv;function NT(){if(bv)return tc;bv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,o){var l=null;if(o!==void 0&&(l=""+o),r.key!==void 0&&(l=""+r.key),"key"in r){o={};for(var u in r)u!=="key"&&(o[u]=r[u])}else o=r;return r=o.ref,{$$typeof:n,type:i,key:l,ref:r!==void 0?r:null,props:o}}return tc.Fragment=e,tc.jsx=t,tc.jsxs=t,tc}var Sv;function OT(){return Sv||(Sv=1,fm.exports=NT()),fm.exports}var d=OT(),hm={exports:{}},tt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _v;function MT(){if(_v)return tt;_v=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function x(X){return X===null||typeof X!="object"?null:(X=v&&X[v]||X["@@iterator"],typeof X=="function"?X:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function T(X,pe,P){this.props=X,this.context=pe,this.refs=b,this.updater=P||S}T.prototype.isReactComponent={},T.prototype.setState=function(X,pe){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,pe,"setState")},T.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function w(){}w.prototype=T.prototype;function A(X,pe,P){this.props=X,this.context=pe,this.refs=b,this.updater=P||S}var C=A.prototype=new w;C.constructor=A,_(C,T.prototype),C.isPureReactComponent=!0;var N=Array.isArray,E={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function D(X,pe,P,Y,V,q){return P=q.ref,{$$typeof:n,type:X,key:pe,ref:P!==void 0?P:null,props:q}}function z(X,pe){return D(X.type,pe,void 0,void 0,void 0,X.props)}function L(X){return typeof X=="object"&&X!==null&&X.$$typeof===n}function H(X){var pe={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(P){return pe[P]})}var K=/\/+/g;function ne(X,pe){return typeof X=="object"&&X!==null&&X.key!=null?H(""+X.key):pe.toString(36)}function xe(){}function He(X){switch(X.status){case"fulfilled":return X.value;case"rejected":throw X.reason;default:switch(typeof X.status=="string"?X.then(xe,xe):(X.status="pending",X.then(function(pe){X.status==="pending"&&(X.status="fulfilled",X.value=pe)},function(pe){X.status==="pending"&&(X.status="rejected",X.reason=pe)})),X.status){case"fulfilled":return X.value;case"rejected":throw X.reason}}throw X}function _e(X,pe,P,Y,V){var q=typeof X;(q==="undefined"||q==="boolean")&&(X=null);var ae=!1;if(X===null)ae=!0;else switch(q){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(X.$$typeof){case n:case e:ae=!0;break;case p:return ae=X._init,_e(ae(X._payload),pe,P,Y,V)}}if(ae)return V=V(X),ae=Y===""?"."+ne(X,0):Y,N(V)?(P="",ae!=null&&(P=ae.replace(K,"$&/")+"/"),_e(V,pe,P,"",function(Le){return Le})):V!=null&&(L(V)&&(V=z(V,P+(V.key==null||X&&X.key===V.key?"":(""+V.key).replace(K,"$&/")+"/")+ae)),pe.push(V)),1;ae=0;var Re=Y===""?".":Y+":";if(N(X))for(var Ce=0;Ce<X.length;Ce++)Y=X[Ce],q=Re+ne(Y,Ce),ae+=_e(Y,pe,P,q,V);else if(Ce=x(X),typeof Ce=="function")for(X=Ce.call(X),Ce=0;!(Y=X.next()).done;)Y=Y.value,q=Re+ne(Y,Ce++),ae+=_e(Y,pe,P,q,V);else if(q==="object"){if(typeof X.then=="function")return _e(He(X),pe,P,Y,V);throw pe=String(X),Error("Objects are not valid as a React child (found: "+(pe==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":pe)+"). If you meant to render a collection of children, use an array instead.")}return ae}function ie(X,pe,P){if(X==null)return X;var Y=[],V=0;return _e(X,Y,"","",function(q){return pe.call(P,q,V++)}),Y}function he(X){if(X._status===-1){var pe=X._result;pe=pe(),pe.then(function(P){(X._status===0||X._status===-1)&&(X._status=1,X._result=P)},function(P){(X._status===0||X._status===-1)&&(X._status=2,X._result=P)}),X._status===-1&&(X._status=0,X._result=pe)}if(X._status===1)return X._result.default;throw X._result}var Ne=typeof reportError=="function"?reportError:function(X){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof X=="object"&&X!==null&&typeof X.message=="string"?String(X.message):String(X),error:X});if(!window.dispatchEvent(pe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",X);return}console.error(X)};function Be(){}return tt.Children={map:ie,forEach:function(X,pe,P){ie(X,function(){pe.apply(this,arguments)},P)},count:function(X){var pe=0;return ie(X,function(){pe++}),pe},toArray:function(X){return ie(X,function(pe){return pe})||[]},only:function(X){if(!L(X))throw Error("React.Children.only expected to receive a single React element child.");return X}},tt.Component=T,tt.Fragment=t,tt.Profiler=r,tt.PureComponent=A,tt.StrictMode=i,tt.Suspense=f,tt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,tt.__COMPILER_RUNTIME={__proto__:null,c:function(X){return E.H.useMemoCache(X)}},tt.cache=function(X){return function(){return X.apply(null,arguments)}},tt.cloneElement=function(X,pe,P){if(X==null)throw Error("The argument must be a React element, but you passed "+X+".");var Y=_({},X.props),V=X.key,q=void 0;if(pe!=null)for(ae in pe.ref!==void 0&&(q=void 0),pe.key!==void 0&&(V=""+pe.key),pe)!I.call(pe,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&pe.ref===void 0||(Y[ae]=pe[ae]);var ae=arguments.length-2;if(ae===1)Y.children=P;else if(1<ae){for(var Re=Array(ae),Ce=0;Ce<ae;Ce++)Re[Ce]=arguments[Ce+2];Y.children=Re}return D(X.type,V,void 0,void 0,q,Y)},tt.createContext=function(X){return X={$$typeof:l,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null},X.Provider=X,X.Consumer={$$typeof:o,_context:X},X},tt.createElement=function(X,pe,P){var Y,V={},q=null;if(pe!=null)for(Y in pe.key!==void 0&&(q=""+pe.key),pe)I.call(pe,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(V[Y]=pe[Y]);var ae=arguments.length-2;if(ae===1)V.children=P;else if(1<ae){for(var Re=Array(ae),Ce=0;Ce<ae;Ce++)Re[Ce]=arguments[Ce+2];V.children=Re}if(X&&X.defaultProps)for(Y in ae=X.defaultProps,ae)V[Y]===void 0&&(V[Y]=ae[Y]);return D(X,q,void 0,void 0,null,V)},tt.createRef=function(){return{current:null}},tt.forwardRef=function(X){return{$$typeof:u,render:X}},tt.isValidElement=L,tt.lazy=function(X){return{$$typeof:p,_payload:{_status:-1,_result:X},_init:he}},tt.memo=function(X,pe){return{$$typeof:m,type:X,compare:pe===void 0?null:pe}},tt.startTransition=function(X){var pe=E.T,P={};E.T=P;try{var Y=X(),V=E.S;V!==null&&V(P,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(Be,Ne)}catch(q){Ne(q)}finally{E.T=pe}},tt.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},tt.use=function(X){return E.H.use(X)},tt.useActionState=function(X,pe,P){return E.H.useActionState(X,pe,P)},tt.useCallback=function(X,pe){return E.H.useCallback(X,pe)},tt.useContext=function(X){return E.H.useContext(X)},tt.useDebugValue=function(){},tt.useDeferredValue=function(X,pe){return E.H.useDeferredValue(X,pe)},tt.useEffect=function(X,pe,P){var Y=E.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(X,pe)},tt.useId=function(){return E.H.useId()},tt.useImperativeHandle=function(X,pe,P){return E.H.useImperativeHandle(X,pe,P)},tt.useInsertionEffect=function(X,pe){return E.H.useInsertionEffect(X,pe)},tt.useLayoutEffect=function(X,pe){return E.H.useLayoutEffect(X,pe)},tt.useMemo=function(X,pe){return E.H.useMemo(X,pe)},tt.useOptimistic=function(X,pe){return E.H.useOptimistic(X,pe)},tt.useReducer=function(X,pe,P){return E.H.useReducer(X,pe,P)},tt.useRef=function(X){return E.H.useRef(X)},tt.useState=function(X){return E.H.useState(X)},tt.useSyncExternalStore=function(X,pe,P){return E.H.useSyncExternalStore(X,pe,P)},tt.useTransition=function(){return E.H.useTransition()},tt.version="19.1.0",tt}var Tv;function op(){return Tv||(Tv=1,hm.exports=MT()),hm.exports}var W=op();const zo=sp(W);var mm={exports:{}},nc={},pm={exports:{}},gm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wv;function RT(){return wv||(wv=1,function(n){function e(ie,he){var Ne=ie.length;ie.push(he);e:for(;0<Ne;){var Be=Ne-1>>>1,X=ie[Be];if(0<r(X,he))ie[Be]=he,ie[Ne]=X,Ne=Be;else break e}}function t(ie){return ie.length===0?null:ie[0]}function i(ie){if(ie.length===0)return null;var he=ie[0],Ne=ie.pop();if(Ne!==he){ie[0]=Ne;e:for(var Be=0,X=ie.length,pe=X>>>1;Be<pe;){var P=2*(Be+1)-1,Y=ie[P],V=P+1,q=ie[V];if(0>r(Y,Ne))V<X&&0>r(q,Y)?(ie[Be]=q,ie[V]=Ne,Be=V):(ie[Be]=Y,ie[P]=Ne,Be=P);else if(V<X&&0>r(q,Ne))ie[Be]=q,ie[V]=Ne,Be=V;else break e}}return he}function r(ie,he){var Ne=ie.sortIndex-he.sortIndex;return Ne!==0?Ne:ie.id-he.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var f=[],m=[],p=1,v=null,x=3,S=!1,_=!1,b=!1,T=!1,w=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function N(ie){for(var he=t(m);he!==null;){if(he.callback===null)i(m);else if(he.startTime<=ie)i(m),he.sortIndex=he.expirationTime,e(f,he);else break;he=t(m)}}function E(ie){if(b=!1,N(ie),!_)if(t(f)!==null)_=!0,I||(I=!0,ne());else{var he=t(m);he!==null&&_e(E,he.startTime-ie)}}var I=!1,D=-1,z=5,L=-1;function H(){return T?!0:!(n.unstable_now()-L<z)}function K(){if(T=!1,I){var ie=n.unstable_now();L=ie;var he=!0;try{e:{_=!1,b&&(b=!1,A(D),D=-1),S=!0;var Ne=x;try{t:{for(N(ie),v=t(f);v!==null&&!(v.expirationTime>ie&&H());){var Be=v.callback;if(typeof Be=="function"){v.callback=null,x=v.priorityLevel;var X=Be(v.expirationTime<=ie);if(ie=n.unstable_now(),typeof X=="function"){v.callback=X,N(ie),he=!0;break t}v===t(f)&&i(f),N(ie)}else i(f);v=t(f)}if(v!==null)he=!0;else{var pe=t(m);pe!==null&&_e(E,pe.startTime-ie),he=!1}}break e}finally{v=null,x=Ne,S=!1}he=void 0}}finally{he?ne():I=!1}}}var ne;if(typeof C=="function")ne=function(){C(K)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,He=xe.port2;xe.port1.onmessage=K,ne=function(){He.postMessage(null)}}else ne=function(){w(K,0)};function _e(ie,he){D=w(function(){ie(n.unstable_now())},he)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(ie){switch(x){case 1:case 2:case 3:var he=3;break;default:he=x}var Ne=x;x=he;try{return ie()}finally{x=Ne}},n.unstable_requestPaint=function(){T=!0},n.unstable_runWithPriority=function(ie,he){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Ne=x;x=ie;try{return he()}finally{x=Ne}},n.unstable_scheduleCallback=function(ie,he,Ne){var Be=n.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?Be+Ne:Be):Ne=Be,ie){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Ne+X,ie={id:p++,callback:he,priorityLevel:ie,startTime:Ne,expirationTime:X,sortIndex:-1},Ne>Be?(ie.sortIndex=Ne,e(m,ie),t(f)===null&&ie===t(m)&&(b?(A(D),D=-1):b=!0,_e(E,Ne-Be))):(ie.sortIndex=X,e(f,ie),_||S||(_=!0,I||(I=!0,ne()))),ie},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(ie){var he=x;return function(){var Ne=x;x=he;try{return ie.apply(this,arguments)}finally{x=Ne}}}}(gm)),gm}var Ev;function LT(){return Ev||(Ev=1,pm.exports=RT()),pm.exports}var vm={exports:{}},$n={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Av;function IT(){if(Av)return $n;Av=1;var n=op();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(f,m,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:v==null?null:""+v,children:f,containerInfo:m,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return $n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,$n.createPortal=function(f,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(f,m,null,p)},$n.flushSync=function(f){var m=l.T,p=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=m,i.p=p,i.d.f()}},$n.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(f,m))},$n.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},$n.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?i.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:S}):p==="script"&&i.d.X(f,{crossOrigin:v,integrity:x,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},$n.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(f)},$n.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin);i.d.L(f,p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},$n.preloadModule=function(f,m){if(typeof f=="string")if(m){var p=u(m.as,m.crossOrigin);i.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(f)},$n.requestFormReset=function(f){i.d.r(f)},$n.unstable_batchedUpdates=function(f,m){return f(m)},$n.useFormState=function(f,m,p){return l.H.useFormState(f,m,p)},$n.useFormStatus=function(){return l.H.useHostTransitionStatus()},$n.version="19.1.0",$n}var kv;function PT(){if(kv)return vm.exports;kv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vm.exports=IT(),vm.exports}var Cv;function BT(){if(Cv)return nc;Cv=1;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=LT(),e=op(),t=PT();function i(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var s=a,c=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(c=s.return),a=s.return;while(a)}return s.tag===3?c:null}function l(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(o(a)!==a)throw Error(i(188))}function f(a){var s=a.alternate;if(!s){if(s=o(a),s===null)throw Error(i(188));return s!==a?null:a}for(var c=a,h=s;;){var g=c.return;if(g===null)break;var y=g.alternate;if(y===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===c)return u(g),a;if(y===h)return u(g),s;y=y.sibling}throw Error(i(188))}if(c.return!==h.return)c=g,h=y;else{for(var k=!1,O=g.child;O;){if(O===c){k=!0,c=g,h=y;break}if(O===h){k=!0,h=g,c=y;break}O=O.sibling}if(!k){for(O=y.child;O;){if(O===c){k=!0,c=y,h=g;break}if(O===h){k=!0,h=y,c=g;break}O=O.sibling}if(!k)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?a:s}function m(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=m(a),s!==null)return s;a=a.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),A=Symbol.for("react.consumer"),C=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function ne(a){return a===null||typeof a!="object"?null:(a=K&&a[K]||a["@@iterator"],typeof a=="function"?a:null)}var xe=Symbol.for("react.client.reference");function He(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===xe?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case _:return"Fragment";case T:return"Profiler";case b:return"StrictMode";case E:return"Suspense";case I:return"SuspenseList";case L:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case S:return"Portal";case C:return(a.displayName||"Context")+".Provider";case A:return(a._context.displayName||"Context")+".Consumer";case N:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case D:return s=a.displayName||null,s!==null?s:He(a.type)||"Memo";case z:s=a._payload,a=a._init;try{return He(a(s))}catch{}}return null}var _e=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne={pending:!1,data:null,method:null,action:null},Be=[],X=-1;function pe(a){return{current:a}}function P(a){0>X||(a.current=Be[X],Be[X]=null,X--)}function Y(a,s){X++,Be[X]=a.current,a.current=s}var V=pe(null),q=pe(null),ae=pe(null),Re=pe(null);function Ce(a,s){switch(Y(ae,s),Y(q,a),Y(V,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?$1(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=$1(s),a=q1(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}P(V),Y(V,a)}function Le(){P(V),P(q),P(ae)}function ke(a){a.memoizedState!==null&&Y(Re,a);var s=V.current,c=q1(s,a.type);s!==c&&(Y(q,a),Y(V,c))}function ct(a){q.current===a&&(P(V),P(q)),Re.current===a&&(P(Re),Kl._currentValue=Ne)}var et=Object.prototype.hasOwnProperty,Ht=n.unstable_scheduleCallback,rt=n.unstable_cancelCallback,Gn=n.unstable_shouldYield,gt=n.unstable_requestPaint,Me=n.unstable_now,wn=n.unstable_getCurrentPriorityLevel,Mn=n.unstable_ImmediatePriority,ei=n.unstable_UserBlockingPriority,ti=n.unstable_NormalPriority,Qe=n.unstable_LowPriority,Fe=n.unstable_IdlePriority,Ye=n.log,Ze=n.unstable_setDisableYieldValue,Ot=null,wt=null;function Wt(a){if(typeof Ye=="function"&&Ze(a),wt&&typeof wt.setStrictMode=="function")try{wt.setStrictMode(Ot,a)}catch{}}var J=Math.clz32?Math.clz32:We,Ee=Math.log,Xe=Math.LN2;function We(a){return a>>>=0,a===0?32:31-(Ee(a)/Xe|0)|0}var Je=256,dt=4194304;function $t(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Yn(a,s,c){var h=a.pendingLanes;if(h===0)return 0;var g=0,y=a.suspendedLanes,k=a.pingedLanes;a=a.warmLanes;var O=h&134217727;return O!==0?(h=O&~y,h!==0?g=$t(h):(k&=O,k!==0?g=$t(k):c||(c=O&~a,c!==0&&(g=$t(c))))):(O=h&~y,O!==0?g=$t(O):k!==0?g=$t(k):c||(c=h&~a,c!==0&&(g=$t(c)))),g===0?0:s!==0&&s!==g&&(s&y)===0&&(y=g&-g,c=s&-s,y>=c||y===32&&(c&4194048)!==0)?s:g}function Ui(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function ut(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ar(){var a=Je;return Je<<=1,(Je&4194048)===0&&(Je=256),a}function wi(){var a=dt;return dt<<=1,(dt&62914560)===0&&(dt=4194304),a}function xr(a){for(var s=[],c=0;31>c;c++)s.push(a);return s}function qt(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function zi(a,s,c,h,g,y){var k=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var O=a.entanglements,G=a.expirationTimes,oe=a.hiddenUpdates;for(c=k&~c;0<c;){var ge=31-J(c),ye=1<<ge;O[ge]=0,G[ge]=-1;var ce=oe[ge];if(ce!==null)for(oe[ge]=null,ge=0;ge<ce.length;ge++){var fe=ce[ge];fe!==null&&(fe.lane&=-536870913)}c&=~ye}h!==0&&va(a,h,0),y!==0&&g===0&&a.tag!==0&&(a.suspendedLanes|=y&~(k&~s))}function va(a,s,c){a.pendingLanes|=s,a.suspendedLanes&=~s;var h=31-J(s);a.entangledLanes|=s,a.entanglements[h]=a.entanglements[h]|1073741824|c&4194090}function qs(a,s){var c=a.entangledLanes|=s;for(a=a.entanglements;c;){var h=31-J(c),g=1<<h;g&s|a[h]&s&&(a[h]|=s),c&=~g}}function as(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ss(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Ks(){var a=he.p;return a!==0?a:(a=window.event,a===void 0?32:mv(a.type))}function yn(a,s){var c=he.p;try{return he.p=a,s()}finally{he.p=c}}var li=Math.random().toString(36).slice(2),Jt="__reactFiber$"+li,en="__reactProps$"+li,br="__reactContainer$"+li,os="__reactEvents$"+li,al="__reactListeners$"+li,j="__reactHandles$"+li,U="__reactResources$"+li,M="__reactMarker$"+li;function R(a){delete a[Jt],delete a[en],delete a[os],delete a[al],delete a[j]}function F(a){var s=a[Jt];if(s)return s;for(var c=a.parentNode;c;){if(s=c[br]||c[Jt]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(a=J1(a);a!==null;){if(c=a[Jt])return c;a=J1(a)}return s}a=c,c=a.parentNode}return null}function B(a){if(a=a[Jt]||a[br]){var s=a.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return a}return null}function se(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(i(33))}function ue(a){var s=a[U];return s||(s=a[U]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ee(a){a[M]=!0}var le=new Set,de={};function Se(a,s){Ae(a,s),Ae(a+"Capture",s)}function Ae(a,s){for(de[a]=s,a=0;a<s.length;a++)le.add(s[a])}var Ie=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Te={},Oe={};function Ge(a){return et.call(Oe,a)?!0:et.call(Te,a)?!1:Ie.test(a)?Oe[a]=!0:(Te[a]=!0,!1)}function vt(a,s,c){if(Ge(s))if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+c)}}function yt(a,s,c){if(c===null)a.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+c)}}function ht(a,s,c,h){if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(s,c,""+h)}}var ci,Ei;function ni(a){if(ci===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);ci=s&&s[1]||"",Ei=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ci+a+Ei}var ui=!1;function Ur(a,s){if(!a||ui)return"";ui=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(fe){var ce=fe}Reflect.construct(a,[],ye)}else{try{ye.call()}catch(fe){ce=fe}a.call(ye.prototype)}}else{try{throw Error()}catch(fe){ce=fe}(ye=a())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(fe){if(fe&&ce&&typeof fe.stack=="string")return[fe.stack,ce.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=h.DetermineComponentFrameRoot(),k=y[0],O=y[1];if(k&&O){var G=k.split(`
`),oe=O.split(`
`);for(g=h=0;h<G.length&&!G[h].includes("DetermineComponentFrameRoot");)h++;for(;g<oe.length&&!oe[g].includes("DetermineComponentFrameRoot");)g++;if(h===G.length||g===oe.length)for(h=G.length-1,g=oe.length-1;1<=h&&0<=g&&G[h]!==oe[g];)g--;for(;1<=h&&0<=g;h--,g--)if(G[h]!==oe[g]){if(h!==1||g!==1)do if(h--,g--,0>g||G[h]!==oe[g]){var ge=`
`+G[h].replace(" at new "," at ");return a.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",a.displayName)),ge}while(1<=h&&0<=g);break}}}finally{ui=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?ni(c):""}function ii(a){switch(a.tag){case 26:case 27:case 5:return ni(a.type);case 16:return ni("Lazy");case 13:return ni("Suspense");case 19:return ni("SuspenseList");case 0:case 15:return Ur(a.type,!1);case 11:return Ur(a.type.render,!1);case 1:return Ur(a.type,!0);case 31:return ni("Activity");default:return""}}function ya(a){try{var s="";do s+=ii(a),a=a.return;while(a);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function xn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function zr(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Jc(a){var s=zr(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),h=""+a[s];if(!a.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,y=c.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return g.call(this)},set:function(k){h=""+k,y.call(this,k)}}),Object.defineProperty(a,s,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(k){h=""+k},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function ls(a){a._valueTracker||(a._valueTracker=Jc(a))}function sl(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var c=s.getValue(),h="";return a&&(h=zr(a)?a.checked?"true":"false":a.value),a=h,a!==c?(s.setValue(a),!0):!1}function xa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var eu=/[\n"\\]/g;function Rn(a){return a.replace(eu,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ba(a,s,c,h,g,y,k,O){a.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?a.type=k:a.removeAttribute("type"),s!=null?k==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+xn(s)):a.value!==""+xn(s)&&(a.value=""+xn(s)):k!=="submit"&&k!=="reset"||a.removeAttribute("value"),s!=null?Sr(a,k,xn(s)):c!=null?Sr(a,k,xn(c)):h!=null&&a.removeAttribute("value"),g==null&&y!=null&&(a.defaultChecked=!!y),g!=null&&(a.checked=g&&typeof g!="function"&&typeof g!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?a.name=""+xn(O):a.removeAttribute("name")}function Hi(a,s,c,h,g,y,k,O){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(a.type=y),s!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||s!=null))return;c=c!=null?""+xn(c):"",s=s!=null?""+xn(s):c,O||s===a.value||(a.value=s),a.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,a.checked=O?a.checked:!!h,a.defaultChecked=!!h,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(a.name=k)}function Sr(a,s,c){s==="number"&&xa(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function _r(a,s,c,h){if(a=a.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<a.length;c++)g=s.hasOwnProperty("$"+a[c].value),a[c].selected!==g&&(a[c].selected=g),g&&h&&(a[c].defaultSelected=!0)}else{for(c=""+xn(c),s=null,g=0;g<a.length;g++){if(a[g].value===c){a[g].selected=!0,h&&(a[g].defaultSelected=!0);return}s!==null||a[g].disabled||(s=a[g])}s!==null&&(s.selected=!0)}}function Zs(a,s,c){if(s!=null&&(s=""+xn(s),s!==a.value&&(a.value=s),c==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=c!=null?""+xn(c):""}function tu(a,s,c,h){if(s==null){if(h!=null){if(c!=null)throw Error(i(92));if(_e(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),s=c}c=xn(s),a.defaultValue=c,h=a.textContent,h===c&&h!==""&&h!==null&&(a.value=h)}function sr(a,s){if(s){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=s;return}}a.textContent=s}var Qs=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nu(a,s,c){var h=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":h?a.setProperty(s,c):typeof c!="number"||c===0||Qs.has(s)?s==="float"?a.cssFloat=c:a[s]=(""+c).trim():a[s]=c+"px"}function Sa(a,s,c){if(s!=null&&typeof s!="object")throw Error(i(62));if(a=a.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?a.setProperty(h,""):h==="float"?a.cssFloat="":a[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&c[g]!==h&&nu(a,g,h)}else for(var y in s)s.hasOwnProperty(y)&&nu(a,y,s[y])}function ol(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),un=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function or(a){return un.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var ll=null;function Js(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Tr=null,Hr=null;function cl(a){var s=B(a);if(s&&(a=s.stateNode)){var c=a[en]||null;e:switch(a=s.stateNode,s.type){case"input":if(ba(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Rn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var h=c[s];if(h!==a&&h.form===a.form){var g=h[en]||null;if(!g)throw Error(i(90));ba(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)h=c[s],h.form===a.form&&sl(h)}break e;case"textarea":Zs(a,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&_r(a,!!c.multiple,s,!1)}}}var ul=!1;function Ai(a,s,c){if(ul)return a(s,c);ul=!0;try{var h=a(s);return h}finally{if(ul=!1,(Tr!==null||Hr!==null)&&(Bu(),Tr&&(s=Tr,a=Hr,Hr=Tr=null,cl(s),a)))for(s=0;s<a.length;s++)cl(a[s])}}function Wi(a,s){var c=a.stateNode;if(c===null)return null;var h=c[en]||null;if(h===null)return null;c=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(a=a.type,h=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!h;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(i(231,s,typeof c));return c}var Vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eo=!1;if(Vi)try{var Wr={};Object.defineProperty(Wr,"passive",{get:function(){eo=!0}}),window.addEventListener("test",Wr,Wr),window.removeEventListener("test",Wr,Wr)}catch{eo=!1}var lr=null,ki=null,cs=null;function dl(){if(cs)return cs;var a,s=ki,c=s.length,h,g="value"in lr?lr.value:lr.textContent,y=g.length;for(a=0;a<c&&s[a]===g[a];a++);var k=c-a;for(h=1;h<=k&&s[c-h]===g[y-h];h++);return cs=g.slice(a,1<h?1-h:void 0)}function us(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function ds(){return!0}function iu(){return!1}function Pe(a){function s(c,h,g,y,k){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=y,this.target=k,this.currentTarget=null;for(var O in a)a.hasOwnProperty(O)&&(c=a[O],this[O]=c?c(y):y[O]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ds:iu,this.isPropagationStopped=iu,this}return p(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ds)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ds)},persist:function(){},isPersistent:ds}),s}var Z={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},we=Pe(Z),Ue=p({},Z,{view:0,detail:0}),Ft=Pe(Ue),dn,Kt,fn,di=p({},Ue,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==fn&&(fn&&a.type==="mousemove"?(dn=a.screenX-fn.screenX,Kt=a.screenY-fn.screenY):Kt=dn=0,fn=a),dn)},movementY:function(a){return"movementY"in a?a.movementY:Kt}}),_a=Pe(di),fl=p({},di,{dataTransfer:0}),En=Pe(fl),ru=p({},Ue,{relatedTarget:0}),to=Pe(ru),L_=p({},Z,{animationName:0,elapsedTime:0,pseudoElement:0}),I_=Pe(L_),P_=p({},Z,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),B_=Pe(P_),F_=p({},Z,{data:0}),tg=Pe(F_),U_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W_(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=H_[a])?!!s[a]:!1}function bf(){return W_}var V_=p({},Ue,{key:function(a){if(a.key){var s=U_[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=us(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?z_[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bf,charCode:function(a){return a.type==="keypress"?us(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?us(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),G_=Pe(V_),Y_=p({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ng=Pe(Y_),X_=p({},Ue,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bf}),$_=Pe(X_),q_=p({},Z,{propertyName:0,elapsedTime:0,pseudoElement:0}),K_=Pe(q_),Z_=p({},di,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Q_=Pe(Z_),J_=p({},Z,{newState:0,oldState:0}),e2=Pe(J_),t2=[9,13,27,32],Sf=Vi&&"CompositionEvent"in window,hl=null;Vi&&"documentMode"in document&&(hl=document.documentMode);var n2=Vi&&"TextEvent"in window&&!hl,ig=Vi&&(!Sf||hl&&8<hl&&11>=hl),rg=" ",ag=!1;function sg(a,s){switch(a){case"keyup":return t2.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function og(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var no=!1;function i2(a,s){switch(a){case"compositionend":return og(s);case"keypress":return s.which!==32?null:(ag=!0,rg);case"textInput":return a=s.data,a===rg&&ag?null:a;default:return null}}function r2(a,s){if(no)return a==="compositionend"||!Sf&&sg(a,s)?(a=dl(),cs=ki=lr=null,no=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ig&&s.locale!=="ko"?null:s.data;default:return null}}var a2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lg(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!a2[a.type]:s==="textarea"}function cg(a,s,c,h){Tr?Hr?Hr.push(h):Hr=[h]:Tr=h,s=Vu(s,"onChange"),0<s.length&&(c=new we("onChange","change",null,c,h),a.push({event:c,listeners:s}))}var ml=null,pl=null;function s2(a){W1(a,0)}function au(a){var s=se(a);if(sl(s))return a}function ug(a,s){if(a==="change")return s}var dg=!1;if(Vi){var _f;if(Vi){var Tf="oninput"in document;if(!Tf){var fg=document.createElement("div");fg.setAttribute("oninput","return;"),Tf=typeof fg.oninput=="function"}_f=Tf}else _f=!1;dg=_f&&(!document.documentMode||9<document.documentMode)}function hg(){ml&&(ml.detachEvent("onpropertychange",mg),pl=ml=null)}function mg(a){if(a.propertyName==="value"&&au(pl)){var s=[];cg(s,pl,a,Js(a)),Ai(s2,s)}}function o2(a,s,c){a==="focusin"?(hg(),ml=s,pl=c,ml.attachEvent("onpropertychange",mg)):a==="focusout"&&hg()}function l2(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return au(pl)}function c2(a,s){if(a==="click")return au(s)}function u2(a,s){if(a==="input"||a==="change")return au(s)}function d2(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Ci=typeof Object.is=="function"?Object.is:d2;function gl(a,s){if(Ci(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var c=Object.keys(a),h=Object.keys(s);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!et.call(s,g)||!Ci(a[g],s[g]))return!1}return!0}function pg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function gg(a,s){var c=pg(a);a=0;for(var h;c;){if(c.nodeType===3){if(h=a+c.textContent.length,a<=s&&h>=s)return{node:c,offset:s-a};a=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=pg(c)}}function vg(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?vg(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function yg(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=xa(a.document);s instanceof a.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)a=s.contentWindow;else break;s=xa(a.document)}return s}function wf(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var f2=Vi&&"documentMode"in document&&11>=document.documentMode,io=null,Ef=null,vl=null,Af=!1;function xg(a,s,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Af||io==null||io!==xa(h)||(h=io,"selectionStart"in h&&wf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),vl&&gl(vl,h)||(vl=h,h=Vu(Ef,"onSelect"),0<h.length&&(s=new we("onSelect","select",null,s,c),a.push({event:s,listeners:h}),s.target=io)))}function fs(a,s){var c={};return c[a.toLowerCase()]=s.toLowerCase(),c["Webkit"+a]="webkit"+s,c["Moz"+a]="moz"+s,c}var ro={animationend:fs("Animation","AnimationEnd"),animationiteration:fs("Animation","AnimationIteration"),animationstart:fs("Animation","AnimationStart"),transitionrun:fs("Transition","TransitionRun"),transitionstart:fs("Transition","TransitionStart"),transitioncancel:fs("Transition","TransitionCancel"),transitionend:fs("Transition","TransitionEnd")},kf={},bg={};Vi&&(bg=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function hs(a){if(kf[a])return kf[a];if(!ro[a])return a;var s=ro[a],c;for(c in s)if(s.hasOwnProperty(c)&&c in bg)return kf[a]=s[c];return a}var Sg=hs("animationend"),_g=hs("animationiteration"),Tg=hs("animationstart"),h2=hs("transitionrun"),m2=hs("transitionstart"),p2=hs("transitioncancel"),wg=hs("transitionend"),Eg=new Map,Cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cf.push("scrollEnd");function cr(a,s){Eg.set(a,s),Se(s,[a])}var Ag=new WeakMap;function Gi(a,s){if(typeof a=="object"&&a!==null){var c=Ag.get(a);return c!==void 0?c:(s={value:a,source:s,stack:ya(s)},Ag.set(a,s),s)}return{value:a,source:s,stack:ya(s)}}var Yi=[],ao=0,jf=0;function su(){for(var a=ao,s=jf=ao=0;s<a;){var c=Yi[s];Yi[s++]=null;var h=Yi[s];Yi[s++]=null;var g=Yi[s];Yi[s++]=null;var y=Yi[s];if(Yi[s++]=null,h!==null&&g!==null){var k=h.pending;k===null?g.next=g:(g.next=k.next,k.next=g),h.pending=g}y!==0&&kg(c,g,y)}}function ou(a,s,c,h){Yi[ao++]=a,Yi[ao++]=s,Yi[ao++]=c,Yi[ao++]=h,jf|=h,a.lanes|=h,a=a.alternate,a!==null&&(a.lanes|=h)}function Df(a,s,c,h){return ou(a,s,c,h),lu(a)}function so(a,s){return ou(a,null,null,s),lu(a)}function kg(a,s,c){a.lanes|=c;var h=a.alternate;h!==null&&(h.lanes|=c);for(var g=!1,y=a.return;y!==null;)y.childLanes|=c,h=y.alternate,h!==null&&(h.childLanes|=c),y.tag===22&&(a=y.stateNode,a===null||a._visibility&1||(g=!0)),a=y,y=y.return;return a.tag===3?(y=a.stateNode,g&&s!==null&&(g=31-J(c),a=y.hiddenUpdates,h=a[g],h===null?a[g]=[s]:h.push(s),s.lane=c|536870912),y):null}function lu(a){if(50<Hl)throw Hl=0,Ih=null,Error(i(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var oo={};function g2(a,s,c,h){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ji(a,s,c,h){return new g2(a,s,c,h)}function Nf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Vr(a,s){var c=a.alternate;return c===null?(c=ji(a.tag,s,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=s,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,s=a.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function Cg(a,s){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,s=c.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function cu(a,s,c,h,g,y){var k=0;if(h=a,typeof a=="function")Nf(a)&&(k=1);else if(typeof a=="string")k=yT(a,c,V.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case L:return a=ji(31,c,s,g),a.elementType=L,a.lanes=y,a;case _:return ms(c.children,g,y,s);case b:k=8,g|=24;break;case T:return a=ji(12,c,s,g|2),a.elementType=T,a.lanes=y,a;case E:return a=ji(13,c,s,g),a.elementType=E,a.lanes=y,a;case I:return a=ji(19,c,s,g),a.elementType=I,a.lanes=y,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case w:case C:k=10;break e;case A:k=9;break e;case N:k=11;break e;case D:k=14;break e;case z:k=16,h=null;break e}k=29,c=Error(i(130,a===null?"null":typeof a,"")),h=null}return s=ji(k,c,s,g),s.elementType=a,s.type=h,s.lanes=y,s}function ms(a,s,c,h){return a=ji(7,a,h,s),a.lanes=c,a}function Of(a,s,c){return a=ji(6,a,null,s),a.lanes=c,a}function Mf(a,s,c){return s=ji(4,a.children!==null?a.children:[],a.key,s),s.lanes=c,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var lo=[],co=0,uu=null,du=0,Xi=[],$i=0,ps=null,Gr=1,Yr="";function gs(a,s){lo[co++]=du,lo[co++]=uu,uu=a,du=s}function jg(a,s,c){Xi[$i++]=Gr,Xi[$i++]=Yr,Xi[$i++]=ps,ps=a;var h=Gr;a=Yr;var g=32-J(h)-1;h&=~(1<<g),c+=1;var y=32-J(s)+g;if(30<y){var k=g-g%5;y=(h&(1<<k)-1).toString(32),h>>=k,g-=k,Gr=1<<32-J(s)+g|c<<g|h,Yr=y+a}else Gr=1<<y|c<<g|h,Yr=a}function Rf(a){a.return!==null&&(gs(a,1),jg(a,1,0))}function Lf(a){for(;a===uu;)uu=lo[--co],lo[co]=null,du=lo[--co],lo[co]=null;for(;a===ps;)ps=Xi[--$i],Xi[$i]=null,Yr=Xi[--$i],Xi[$i]=null,Gr=Xi[--$i],Xi[$i]=null}var ri=null,tn=null,St=!1,vs=null,wr=!1,If=Error(i(519));function ys(a){var s=Error(i(418,""));throw bl(Gi(s,a)),If}function Dg(a){var s=a.stateNode,c=a.type,h=a.memoizedProps;switch(s[Jt]=a,s[en]=h,c){case"dialog":lt("cancel",s),lt("close",s);break;case"iframe":case"object":case"embed":lt("load",s);break;case"video":case"audio":for(c=0;c<Vl.length;c++)lt(Vl[c],s);break;case"source":lt("error",s);break;case"img":case"image":case"link":lt("error",s),lt("load",s);break;case"details":lt("toggle",s);break;case"input":lt("invalid",s),Hi(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),ls(s);break;case"select":lt("invalid",s);break;case"textarea":lt("invalid",s),tu(s,h.value,h.defaultValue,h.children),ls(s)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||h.suppressHydrationWarning===!0||X1(s.textContent,c)?(h.popover!=null&&(lt("beforetoggle",s),lt("toggle",s)),h.onScroll!=null&&lt("scroll",s),h.onScrollEnd!=null&&lt("scrollend",s),h.onClick!=null&&(s.onclick=Gu),s=!0):s=!1,s||ys(a)}function Ng(a){for(ri=a.return;ri;)switch(ri.tag){case 5:case 13:wr=!1;return;case 27:case 3:wr=!0;return;default:ri=ri.return}}function yl(a){if(a!==ri)return!1;if(!St)return Ng(a),St=!0,!1;var s=a.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||Qh(a.type,a.memoizedProps)),c=!c),c&&tn&&ys(a),Ng(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));e:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8)if(c=a.data,c==="/$"){if(s===0){tn=dr(a.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;a=a.nextSibling}tn=null}}else s===27?(s=tn,Ba(a.type)?(a=nm,nm=null,tn=a):tn=s):tn=ri?dr(a.stateNode.nextSibling):null;return!0}function xl(){tn=ri=null,St=!1}function Og(){var a=vs;return a!==null&&(mi===null?mi=a:mi.push.apply(mi,a),vs=null),a}function bl(a){vs===null?vs=[a]:vs.push(a)}var Pf=pe(null),xs=null,Xr=null;function Ta(a,s,c){Y(Pf,s._currentValue),s._currentValue=c}function $r(a){a._currentValue=Pf.current,P(Pf)}function Bf(a,s,c){for(;a!==null;){var h=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),a===c)break;a=a.return}}function Ff(a,s,c,h){var g=a.child;for(g!==null&&(g.return=a);g!==null;){var y=g.dependencies;if(y!==null){var k=g.child;y=y.firstContext;e:for(;y!==null;){var O=y;y=g;for(var G=0;G<s.length;G++)if(O.context===s[G]){y.lanes|=c,O=y.alternate,O!==null&&(O.lanes|=c),Bf(y.return,c,a),h||(k=null);break e}y=O.next}}else if(g.tag===18){if(k=g.return,k===null)throw Error(i(341));k.lanes|=c,y=k.alternate,y!==null&&(y.lanes|=c),Bf(k,c,a),k=null}else k=g.child;if(k!==null)k.return=g;else for(k=g;k!==null;){if(k===a){k=null;break}if(g=k.sibling,g!==null){g.return=k.return,k=g;break}k=k.return}g=k}}function Sl(a,s,c,h){a=null;for(var g=s,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var k=g.alternate;if(k===null)throw Error(i(387));if(k=k.memoizedProps,k!==null){var O=g.type;Ci(g.pendingProps.value,k.value)||(a!==null?a.push(O):a=[O])}}else if(g===Re.current){if(k=g.alternate,k===null)throw Error(i(387));k.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(a!==null?a.push(Kl):a=[Kl])}g=g.return}a!==null&&Ff(s,a,c,h),s.flags|=262144}function fu(a){for(a=a.firstContext;a!==null;){if(!Ci(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function bs(a){xs=a,Xr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Xn(a){return Mg(xs,a)}function hu(a,s){return xs===null&&bs(a),Mg(a,s)}function Mg(a,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Xr===null){if(a===null)throw Error(i(308));Xr=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else Xr=Xr.next=s;return c}var v2=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(c,h){a.push(h)}};this.abort=function(){s.aborted=!0,a.forEach(function(c){return c()})}},y2=n.unstable_scheduleCallback,x2=n.unstable_NormalPriority,bn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new v2,data:new Map,refCount:0}}function _l(a){a.refCount--,a.refCount===0&&y2(x2,function(){a.controller.abort()})}var Tl=null,zf=0,uo=0,fo=null;function b2(a,s){if(Tl===null){var c=Tl=[];zf=0,uo=Wh(),fo={status:"pending",value:void 0,then:function(h){c.push(h)}}}return zf++,s.then(Rg,Rg),s}function Rg(){if(--zf===0&&Tl!==null){fo!==null&&(fo.status="fulfilled");var a=Tl;Tl=null,uo=0,fo=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function S2(a,s){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return a.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var Lg=ie.S;ie.S=function(a,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&b2(a,s),Lg!==null&&Lg(a,s)};var Ss=pe(null);function Hf(){var a=Ss.current;return a!==null?a:Ut.pooledCache}function mu(a,s){s===null?Y(Ss,Ss.current):Y(Ss,s.pool)}function Ig(){var a=Hf();return a===null?null:{parent:bn._currentValue,pool:a}}var wl=Error(i(460)),Pg=Error(i(474)),pu=Error(i(542)),Wf={then:function(){}};function Bg(a){return a=a.status,a==="fulfilled"||a==="rejected"}function gu(){}function Fg(a,s,c){switch(c=a[c],c===void 0?a.push(s):c!==s&&(s.then(gu,gu),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,zg(a),a;default:if(typeof s.status=="string")s.then(gu,gu);else{if(a=Ut,a!==null&&100<a.shellSuspendCounter)throw Error(i(482));a=s,a.status="pending",a.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,zg(a),a}throw El=s,wl}}var El=null;function Ug(){if(El===null)throw Error(i(459));var a=El;return El=null,a}function zg(a){if(a===wl||a===pu)throw Error(i(483))}var wa=!1;function Vf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gf(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ea(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Aa(a,s,c){var h=a.updateQueue;if(h===null)return null;if(h=h.shared,(Et&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=lu(a),kg(a,null,c),s}return ou(a,h,s,c),lu(a)}function Al(a,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var h=s.lanes;h&=a.pendingLanes,c|=h,s.lanes=c,qs(a,c)}}function Yf(a,s){var c=a.updateQueue,h=a.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?g=y=k:y=y.next=k,c=c.next}while(c!==null);y===null?g=y=s:y=y.next=s}else g=y=s;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:h.shared,callbacks:h.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=s:a.next=s,c.lastBaseUpdate=s}var Xf=!1;function kl(){if(Xf){var a=fo;if(a!==null)throw a}}function Cl(a,s,c,h){Xf=!1;var g=a.updateQueue;wa=!1;var y=g.firstBaseUpdate,k=g.lastBaseUpdate,O=g.shared.pending;if(O!==null){g.shared.pending=null;var G=O,oe=G.next;G.next=null,k===null?y=oe:k.next=oe,k=G;var ge=a.alternate;ge!==null&&(ge=ge.updateQueue,O=ge.lastBaseUpdate,O!==k&&(O===null?ge.firstBaseUpdate=oe:O.next=oe,ge.lastBaseUpdate=G))}if(y!==null){var ye=g.baseState;k=0,ge=oe=G=null,O=y;do{var ce=O.lane&-536870913,fe=ce!==O.lane;if(fe?(ft&ce)===ce:(h&ce)===ce){ce!==0&&ce===uo&&(Xf=!0),ge!==null&&(ge=ge.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ke=a,$e=O;ce=s;var Lt=c;switch($e.tag){case 1:if(Ke=$e.payload,typeof Ke=="function"){ye=Ke.call(Lt,ye,ce);break e}ye=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=$e.payload,ce=typeof Ke=="function"?Ke.call(Lt,ye,ce):Ke,ce==null)break e;ye=p({},ye,ce);break e;case 2:wa=!0}}ce=O.callback,ce!==null&&(a.flags|=64,fe&&(a.flags|=8192),fe=g.callbacks,fe===null?g.callbacks=[ce]:fe.push(ce))}else fe={lane:ce,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ge===null?(oe=ge=fe,G=ye):ge=ge.next=fe,k|=ce;if(O=O.next,O===null){if(O=g.shared.pending,O===null)break;fe=O,O=fe.next,fe.next=null,g.lastBaseUpdate=fe,g.shared.pending=null}}while(!0);ge===null&&(G=ye),g.baseState=G,g.firstBaseUpdate=oe,g.lastBaseUpdate=ge,y===null&&(g.shared.lanes=0),Ra|=k,a.lanes=k,a.memoizedState=ye}}function Hg(a,s){if(typeof a!="function")throw Error(i(191,a));a.call(s)}function Wg(a,s){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)Hg(c[a],s)}var ho=pe(null),vu=pe(0);function Vg(a,s){a=ta,Y(vu,a),Y(ho,s),ta=a|s.baseLanes}function $f(){Y(vu,ta),Y(ho,ho.current)}function qf(){ta=vu.current,P(ho),P(vu)}var ka=0,at=null,Mt=null,hn=null,yu=!1,mo=!1,_s=!1,xu=0,jl=0,po=null,_2=0;function on(){throw Error(i(321))}function Kf(a,s){if(s===null)return!1;for(var c=0;c<s.length&&c<a.length;c++)if(!Ci(a[c],s[c]))return!1;return!0}function Zf(a,s,c,h,g,y){return ka=y,at=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ie.H=a===null||a.memoizedState===null?k0:C0,_s=!1,y=c(h,g),_s=!1,mo&&(y=Yg(s,c,h,g)),Gg(a),y}function Gg(a){ie.H=Eu;var s=Mt!==null&&Mt.next!==null;if(ka=0,hn=Mt=at=null,yu=!1,jl=0,po=null,s)throw Error(i(300));a===null||An||(a=a.dependencies,a!==null&&fu(a)&&(An=!0))}function Yg(a,s,c,h){at=a;var g=0;do{if(mo&&(po=null),jl=0,mo=!1,25<=g)throw Error(i(301));if(g+=1,hn=Mt=null,a.updateQueue!=null){var y=a.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}ie.H=j2,y=s(c,h)}while(mo);return y}function T2(){var a=ie.H,s=a.useState()[0];return s=typeof s.then=="function"?Dl(s):s,a=a.useState()[0],(Mt!==null?Mt.memoizedState:null)!==a&&(at.flags|=1024),s}function Qf(){var a=xu!==0;return xu=0,a}function Jf(a,s,c){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~c}function eh(a){if(yu){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}yu=!1}ka=0,hn=Mt=at=null,mo=!1,jl=xu=0,po=null}function fi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?at.memoizedState=hn=a:hn=hn.next=a,hn}function mn(){if(Mt===null){var a=at.alternate;a=a!==null?a.memoizedState:null}else a=Mt.next;var s=hn===null?at.memoizedState:hn.next;if(s!==null)hn=s,Mt=a;else{if(a===null)throw at.alternate===null?Error(i(467)):Error(i(310));Mt=a,a={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},hn===null?at.memoizedState=hn=a:hn=hn.next=a}return hn}function th(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dl(a){var s=jl;return jl+=1,po===null&&(po=[]),a=Fg(po,a,s),s=at,(hn===null?s.memoizedState:hn.next)===null&&(s=s.alternate,ie.H=s===null||s.memoizedState===null?k0:C0),a}function bu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Dl(a);if(a.$$typeof===C)return Xn(a)}throw Error(i(438,String(a)))}function nh(a){var s=null,c=at.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var h=at.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=th(),at.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(a),h=0;h<a;h++)c[h]=H;return s.index++,c}function qr(a,s){return typeof s=="function"?s(a):s}function Su(a){var s=mn();return ih(s,Mt,a)}function ih(a,s,c){var h=a.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var g=a.baseQueue,y=h.pending;if(y!==null){if(g!==null){var k=g.next;g.next=y.next,y.next=k}s.baseQueue=g=y,h.pending=null}if(y=a.baseState,g===null)a.memoizedState=y;else{s=g.next;var O=k=null,G=null,oe=s,ge=!1;do{var ye=oe.lane&-536870913;if(ye!==oe.lane?(ft&ye)===ye:(ka&ye)===ye){var ce=oe.revertLane;if(ce===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),ye===uo&&(ge=!0);else if((ka&ce)===ce){oe=oe.next,ce===uo&&(ge=!0);continue}else ye={lane:0,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},G===null?(O=G=ye,k=y):G=G.next=ye,at.lanes|=ce,Ra|=ce;ye=oe.action,_s&&c(y,ye),y=oe.hasEagerState?oe.eagerState:c(y,ye)}else ce={lane:ye,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},G===null?(O=G=ce,k=y):G=G.next=ce,at.lanes|=ye,Ra|=ye;oe=oe.next}while(oe!==null&&oe!==s);if(G===null?k=y:G.next=O,!Ci(y,a.memoizedState)&&(An=!0,ge&&(c=fo,c!==null)))throw c;a.memoizedState=y,a.baseState=k,a.baseQueue=G,h.lastRenderedState=y}return g===null&&(h.lanes=0),[a.memoizedState,h.dispatch]}function rh(a){var s=mn(),c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=a;var h=c.dispatch,g=c.pending,y=s.memoizedState;if(g!==null){c.pending=null;var k=g=g.next;do y=a(y,k.action),k=k.next;while(k!==g);Ci(y,s.memoizedState)||(An=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),c.lastRenderedState=y}return[y,h]}function Xg(a,s,c){var h=at,g=mn(),y=St;if(y){if(c===void 0)throw Error(i(407));c=c()}else c=s();var k=!Ci((Mt||g).memoizedState,c);k&&(g.memoizedState=c,An=!0),g=g.queue;var O=Kg.bind(null,h,g,a);if(Nl(2048,8,O,[a]),g.getSnapshot!==s||k||hn!==null&&hn.memoizedState.tag&1){if(h.flags|=2048,go(9,_u(),qg.bind(null,h,g,c,s),null),Ut===null)throw Error(i(349));y||(ka&124)!==0||$g(h,s,c)}return c}function $g(a,s,c){a.flags|=16384,a={getSnapshot:s,value:c},s=at.updateQueue,s===null?(s=th(),at.updateQueue=s,s.stores=[a]):(c=s.stores,c===null?s.stores=[a]:c.push(a))}function qg(a,s,c,h){s.value=c,s.getSnapshot=h,Zg(s)&&Qg(a)}function Kg(a,s,c){return c(function(){Zg(s)&&Qg(a)})}function Zg(a){var s=a.getSnapshot;a=a.value;try{var c=s();return!Ci(a,c)}catch{return!0}}function Qg(a){var s=so(a,2);s!==null&&Ri(s,a,2)}function ah(a){var s=fi();if(typeof a=="function"){var c=a;if(a=c(),_s){Wt(!0);try{c()}finally{Wt(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:a},s}function Jg(a,s,c,h){return a.baseState=c,ih(a,Mt,typeof h=="function"?h:qr)}function w2(a,s,c,h,g){if(wu(a))throw Error(i(485));if(a=s.action,a!==null){var y={payload:g,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){y.listeners.push(k)}};ie.T!==null?c(!0):y.isTransition=!1,h(y),c=s.pending,c===null?(y.next=s.pending=y,e0(s,y)):(y.next=c.next,s.pending=c.next=y)}}function e0(a,s){var c=s.action,h=s.payload,g=a.state;if(s.isTransition){var y=ie.T,k={};ie.T=k;try{var O=c(g,h),G=ie.S;G!==null&&G(k,O),t0(a,s,O)}catch(oe){sh(a,s,oe)}finally{ie.T=y}}else try{y=c(g,h),t0(a,s,y)}catch(oe){sh(a,s,oe)}}function t0(a,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){n0(a,s,h)},function(h){return sh(a,s,h)}):n0(a,s,c)}function n0(a,s,c){s.status="fulfilled",s.value=c,i0(s),a.state=c,s=a.pending,s!==null&&(c=s.next,c===s?a.pending=null:(c=c.next,s.next=c,e0(a,c)))}function sh(a,s,c){var h=a.pending;if(a.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=c,i0(s),s=s.next;while(s!==h)}a.action=null}function i0(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function r0(a,s){return s}function a0(a,s){if(St){var c=Ut.formState;if(c!==null){e:{var h=at;if(St){if(tn){t:{for(var g=tn,y=wr;g.nodeType!==8;){if(!y){g=null;break t}if(g=dr(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){tn=dr(g.nextSibling),h=g.data==="F!";break e}}ys(h)}h=!1}h&&(s=c[0])}}return c=fi(),c.memoizedState=c.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r0,lastRenderedState:s},c.queue=h,c=w0.bind(null,at,h),h.dispatch=c,h=ah(!1),y=dh.bind(null,at,!1,h.queue),h=fi(),g={state:s,dispatch:null,action:a,pending:null},h.queue=g,c=w2.bind(null,at,g,y,c),g.dispatch=c,h.memoizedState=a,[s,c,!1]}function s0(a){var s=mn();return o0(s,Mt,a)}function o0(a,s,c){if(s=ih(a,s,r0)[0],a=Su(qr)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Dl(s)}catch(k){throw k===wl?pu:k}else h=s;s=mn();var g=s.queue,y=g.dispatch;return c!==s.memoizedState&&(at.flags|=2048,go(9,_u(),E2.bind(null,g,c),null)),[h,y,a]}function E2(a,s){a.action=s}function l0(a){var s=mn(),c=Mt;if(c!==null)return o0(s,c,a);mn(),s=s.memoizedState,c=mn();var h=c.queue.dispatch;return c.memoizedState=a,[s,h,!1]}function go(a,s,c,h){return a={tag:a,create:c,deps:h,inst:s,next:null},s=at.updateQueue,s===null&&(s=th(),at.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=a.next=a:(h=c.next,c.next=a,a.next=h,s.lastEffect=a),a}function _u(){return{destroy:void 0,resource:void 0}}function c0(){return mn().memoizedState}function Tu(a,s,c,h){var g=fi();h=h===void 0?null:h,at.flags|=a,g.memoizedState=go(1|s,_u(),c,h)}function Nl(a,s,c,h){var g=mn();h=h===void 0?null:h;var y=g.memoizedState.inst;Mt!==null&&h!==null&&Kf(h,Mt.memoizedState.deps)?g.memoizedState=go(s,y,c,h):(at.flags|=a,g.memoizedState=go(1|s,y,c,h))}function u0(a,s){Tu(8390656,8,a,s)}function d0(a,s){Nl(2048,8,a,s)}function f0(a,s){return Nl(4,2,a,s)}function h0(a,s){return Nl(4,4,a,s)}function m0(a,s){if(typeof s=="function"){a=a();var c=s(a);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function p0(a,s,c){c=c!=null?c.concat([a]):null,Nl(4,4,m0.bind(null,s,a),c)}function oh(){}function g0(a,s){var c=mn();s=s===void 0?null:s;var h=c.memoizedState;return s!==null&&Kf(s,h[1])?h[0]:(c.memoizedState=[a,s],a)}function v0(a,s){var c=mn();s=s===void 0?null:s;var h=c.memoizedState;if(s!==null&&Kf(s,h[1]))return h[0];if(h=a(),_s){Wt(!0);try{a()}finally{Wt(!1)}}return c.memoizedState=[h,s],h}function lh(a,s,c){return c===void 0||(ka&1073741824)!==0?a.memoizedState=s:(a.memoizedState=c,a=b1(),at.lanes|=a,Ra|=a,c)}function y0(a,s,c,h){return Ci(c,s)?c:ho.current!==null?(a=lh(a,c,h),Ci(a,s)||(An=!0),a):(ka&42)===0?(An=!0,a.memoizedState=c):(a=b1(),at.lanes|=a,Ra|=a,s)}function x0(a,s,c,h,g){var y=he.p;he.p=y!==0&&8>y?y:8;var k=ie.T,O={};ie.T=O,dh(a,!1,s,c);try{var G=g(),oe=ie.S;if(oe!==null&&oe(O,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var ge=S2(G,h);Ol(a,s,ge,Mi(a))}else Ol(a,s,h,Mi(a))}catch(ye){Ol(a,s,{then:function(){},status:"rejected",reason:ye},Mi())}finally{he.p=y,ie.T=k}}function A2(){}function ch(a,s,c,h){if(a.tag!==5)throw Error(i(476));var g=b0(a).queue;x0(a,g,s,Ne,c===null?A2:function(){return S0(a),c(h)})}function b0(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:Ne,baseState:Ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:Ne},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:c},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function S0(a){var s=b0(a).next.queue;Ol(a,s,{},Mi())}function uh(){return Xn(Kl)}function _0(){return mn().memoizedState}function T0(){return mn().memoizedState}function k2(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var c=Mi();a=Ea(c);var h=Aa(s,a,c);h!==null&&(Ri(h,s,c),Al(h,s,c)),s={cache:Uf()},a.payload=s;return}s=s.return}}function C2(a,s,c){var h=Mi();c={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},wu(a)?E0(s,c):(c=Df(a,s,c,h),c!==null&&(Ri(c,a,h),A0(c,s,h)))}function w0(a,s,c){var h=Mi();Ol(a,s,c,h)}function Ol(a,s,c,h){var g={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(wu(a))E0(s,g);else{var y=a.alternate;if(a.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var k=s.lastRenderedState,O=y(k,c);if(g.hasEagerState=!0,g.eagerState=O,Ci(O,k))return ou(a,s,g,0),Ut===null&&su(),!1}catch{}finally{}if(c=Df(a,s,g,h),c!==null)return Ri(c,a,h),A0(c,s,h),!0}return!1}function dh(a,s,c,h){if(h={lane:2,revertLane:Wh(),action:h,hasEagerState:!1,eagerState:null,next:null},wu(a)){if(s)throw Error(i(479))}else s=Df(a,c,h,2),s!==null&&Ri(s,a,2)}function wu(a){var s=a.alternate;return a===at||s!==null&&s===at}function E0(a,s){mo=yu=!0;var c=a.pending;c===null?s.next=s:(s.next=c.next,c.next=s),a.pending=s}function A0(a,s,c){if((c&4194048)!==0){var h=s.lanes;h&=a.pendingLanes,c|=h,s.lanes=c,qs(a,c)}}var Eu={readContext:Xn,use:bu,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useLayoutEffect:on,useInsertionEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useSyncExternalStore:on,useId:on,useHostTransitionStatus:on,useFormState:on,useActionState:on,useOptimistic:on,useMemoCache:on,useCacheRefresh:on},k0={readContext:Xn,use:bu,useCallback:function(a,s){return fi().memoizedState=[a,s===void 0?null:s],a},useContext:Xn,useEffect:u0,useImperativeHandle:function(a,s,c){c=c!=null?c.concat([a]):null,Tu(4194308,4,m0.bind(null,s,a),c)},useLayoutEffect:function(a,s){return Tu(4194308,4,a,s)},useInsertionEffect:function(a,s){Tu(4,2,a,s)},useMemo:function(a,s){var c=fi();s=s===void 0?null:s;var h=a();if(_s){Wt(!0);try{a()}finally{Wt(!1)}}return c.memoizedState=[h,s],h},useReducer:function(a,s,c){var h=fi();if(c!==void 0){var g=c(s);if(_s){Wt(!0);try{c(s)}finally{Wt(!1)}}}else g=s;return h.memoizedState=h.baseState=g,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:g},h.queue=a,a=a.dispatch=C2.bind(null,at,a),[h.memoizedState,a]},useRef:function(a){var s=fi();return a={current:a},s.memoizedState=a},useState:function(a){a=ah(a);var s=a.queue,c=w0.bind(null,at,s);return s.dispatch=c,[a.memoizedState,c]},useDebugValue:oh,useDeferredValue:function(a,s){var c=fi();return lh(c,a,s)},useTransition:function(){var a=ah(!1);return a=x0.bind(null,at,a.queue,!0,!1),fi().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,c){var h=at,g=fi();if(St){if(c===void 0)throw Error(i(407));c=c()}else{if(c=s(),Ut===null)throw Error(i(349));(ft&124)!==0||$g(h,s,c)}g.memoizedState=c;var y={value:c,getSnapshot:s};return g.queue=y,u0(Kg.bind(null,h,y,a),[a]),h.flags|=2048,go(9,_u(),qg.bind(null,h,y,c,s),null),c},useId:function(){var a=fi(),s=Ut.identifierPrefix;if(St){var c=Yr,h=Gr;c=(h&~(1<<32-J(h)-1)).toString(32)+c,s="«"+s+"R"+c,c=xu++,0<c&&(s+="H"+c.toString(32)),s+="»"}else c=_2++,s="«"+s+"r"+c.toString(32)+"»";return a.memoizedState=s},useHostTransitionStatus:uh,useFormState:a0,useActionState:a0,useOptimistic:function(a){var s=fi();s.memoizedState=s.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=dh.bind(null,at,!0,c),c.dispatch=s,[a,s]},useMemoCache:nh,useCacheRefresh:function(){return fi().memoizedState=k2.bind(null,at)}},C0={readContext:Xn,use:bu,useCallback:g0,useContext:Xn,useEffect:d0,useImperativeHandle:p0,useInsertionEffect:f0,useLayoutEffect:h0,useMemo:v0,useReducer:Su,useRef:c0,useState:function(){return Su(qr)},useDebugValue:oh,useDeferredValue:function(a,s){var c=mn();return y0(c,Mt.memoizedState,a,s)},useTransition:function(){var a=Su(qr)[0],s=mn().memoizedState;return[typeof a=="boolean"?a:Dl(a),s]},useSyncExternalStore:Xg,useId:_0,useHostTransitionStatus:uh,useFormState:s0,useActionState:s0,useOptimistic:function(a,s){var c=mn();return Jg(c,Mt,a,s)},useMemoCache:nh,useCacheRefresh:T0},j2={readContext:Xn,use:bu,useCallback:g0,useContext:Xn,useEffect:d0,useImperativeHandle:p0,useInsertionEffect:f0,useLayoutEffect:h0,useMemo:v0,useReducer:rh,useRef:c0,useState:function(){return rh(qr)},useDebugValue:oh,useDeferredValue:function(a,s){var c=mn();return Mt===null?lh(c,a,s):y0(c,Mt.memoizedState,a,s)},useTransition:function(){var a=rh(qr)[0],s=mn().memoizedState;return[typeof a=="boolean"?a:Dl(a),s]},useSyncExternalStore:Xg,useId:_0,useHostTransitionStatus:uh,useFormState:l0,useActionState:l0,useOptimistic:function(a,s){var c=mn();return Mt!==null?Jg(c,Mt,a,s):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:nh,useCacheRefresh:T0},vo=null,Ml=0;function Au(a){var s=Ml;return Ml+=1,vo===null&&(vo=[]),Fg(vo,a,s)}function Rl(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function ku(a,s){throw s.$$typeof===v?Error(i(525)):(a=Object.prototype.toString.call(s),Error(i(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function j0(a){var s=a._init;return s(a._payload)}function D0(a){function s(te,Q){if(a){var re=te.deletions;re===null?(te.deletions=[Q],te.flags|=16):re.push(Q)}}function c(te,Q){if(!a)return null;for(;Q!==null;)s(te,Q),Q=Q.sibling;return null}function h(te){for(var Q=new Map;te!==null;)te.key!==null?Q.set(te.key,te):Q.set(te.index,te),te=te.sibling;return Q}function g(te,Q){return te=Vr(te,Q),te.index=0,te.sibling=null,te}function y(te,Q,re){return te.index=re,a?(re=te.alternate,re!==null?(re=re.index,re<Q?(te.flags|=67108866,Q):re):(te.flags|=67108866,Q)):(te.flags|=1048576,Q)}function k(te){return a&&te.alternate===null&&(te.flags|=67108866),te}function O(te,Q,re,ve){return Q===null||Q.tag!==6?(Q=Of(re,te.mode,ve),Q.return=te,Q):(Q=g(Q,re),Q.return=te,Q)}function G(te,Q,re,ve){var ze=re.type;return ze===_?ge(te,Q,re.props.children,ve,re.key):Q!==null&&(Q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===z&&j0(ze)===Q.type)?(Q=g(Q,re.props),Rl(Q,re),Q.return=te,Q):(Q=cu(re.type,re.key,re.props,null,te.mode,ve),Rl(Q,re),Q.return=te,Q)}function oe(te,Q,re,ve){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==re.containerInfo||Q.stateNode.implementation!==re.implementation?(Q=Mf(re,te.mode,ve),Q.return=te,Q):(Q=g(Q,re.children||[]),Q.return=te,Q)}function ge(te,Q,re,ve,ze){return Q===null||Q.tag!==7?(Q=ms(re,te.mode,ve,ze),Q.return=te,Q):(Q=g(Q,re),Q.return=te,Q)}function ye(te,Q,re){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Of(""+Q,te.mode,re),Q.return=te,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case x:return re=cu(Q.type,Q.key,Q.props,null,te.mode,re),Rl(re,Q),re.return=te,re;case S:return Q=Mf(Q,te.mode,re),Q.return=te,Q;case z:var ve=Q._init;return Q=ve(Q._payload),ye(te,Q,re)}if(_e(Q)||ne(Q))return Q=ms(Q,te.mode,re,null),Q.return=te,Q;if(typeof Q.then=="function")return ye(te,Au(Q),re);if(Q.$$typeof===C)return ye(te,hu(te,Q),re);ku(te,Q)}return null}function ce(te,Q,re,ve){var ze=Q!==null?Q.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return ze!==null?null:O(te,Q,""+re,ve);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case x:return re.key===ze?G(te,Q,re,ve):null;case S:return re.key===ze?oe(te,Q,re,ve):null;case z:return ze=re._init,re=ze(re._payload),ce(te,Q,re,ve)}if(_e(re)||ne(re))return ze!==null?null:ge(te,Q,re,ve,null);if(typeof re.then=="function")return ce(te,Q,Au(re),ve);if(re.$$typeof===C)return ce(te,Q,hu(te,re),ve);ku(te,re)}return null}function fe(te,Q,re,ve,ze){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return te=te.get(re)||null,O(Q,te,""+ve,ze);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case x:return te=te.get(ve.key===null?re:ve.key)||null,G(Q,te,ve,ze);case S:return te=te.get(ve.key===null?re:ve.key)||null,oe(Q,te,ve,ze);case z:var st=ve._init;return ve=st(ve._payload),fe(te,Q,re,ve,ze)}if(_e(ve)||ne(ve))return te=te.get(re)||null,ge(Q,te,ve,ze,null);if(typeof ve.then=="function")return fe(te,Q,re,Au(ve),ze);if(ve.$$typeof===C)return fe(te,Q,re,hu(Q,ve),ze);ku(Q,ve)}return null}function Ke(te,Q,re,ve){for(var ze=null,st=null,Ve=Q,qe=Q=0,Cn=null;Ve!==null&&qe<re.length;qe++){Ve.index>qe?(Cn=Ve,Ve=null):Cn=Ve.sibling;var xt=ce(te,Ve,re[qe],ve);if(xt===null){Ve===null&&(Ve=Cn);break}a&&Ve&&xt.alternate===null&&s(te,Ve),Q=y(xt,Q,qe),st===null?ze=xt:st.sibling=xt,st=xt,Ve=Cn}if(qe===re.length)return c(te,Ve),St&&gs(te,qe),ze;if(Ve===null){for(;qe<re.length;qe++)Ve=ye(te,re[qe],ve),Ve!==null&&(Q=y(Ve,Q,qe),st===null?ze=Ve:st.sibling=Ve,st=Ve);return St&&gs(te,qe),ze}for(Ve=h(Ve);qe<re.length;qe++)Cn=fe(Ve,te,qe,re[qe],ve),Cn!==null&&(a&&Cn.alternate!==null&&Ve.delete(Cn.key===null?qe:Cn.key),Q=y(Cn,Q,qe),st===null?ze=Cn:st.sibling=Cn,st=Cn);return a&&Ve.forEach(function(Wa){return s(te,Wa)}),St&&gs(te,qe),ze}function $e(te,Q,re,ve){if(re==null)throw Error(i(151));for(var ze=null,st=null,Ve=Q,qe=Q=0,Cn=null,xt=re.next();Ve!==null&&!xt.done;qe++,xt=re.next()){Ve.index>qe?(Cn=Ve,Ve=null):Cn=Ve.sibling;var Wa=ce(te,Ve,xt.value,ve);if(Wa===null){Ve===null&&(Ve=Cn);break}a&&Ve&&Wa.alternate===null&&s(te,Ve),Q=y(Wa,Q,qe),st===null?ze=Wa:st.sibling=Wa,st=Wa,Ve=Cn}if(xt.done)return c(te,Ve),St&&gs(te,qe),ze;if(Ve===null){for(;!xt.done;qe++,xt=re.next())xt=ye(te,xt.value,ve),xt!==null&&(Q=y(xt,Q,qe),st===null?ze=xt:st.sibling=xt,st=xt);return St&&gs(te,qe),ze}for(Ve=h(Ve);!xt.done;qe++,xt=re.next())xt=fe(Ve,te,qe,xt.value,ve),xt!==null&&(a&&xt.alternate!==null&&Ve.delete(xt.key===null?qe:xt.key),Q=y(xt,Q,qe),st===null?ze=xt:st.sibling=xt,st=xt);return a&&Ve.forEach(function(DT){return s(te,DT)}),St&&gs(te,qe),ze}function Lt(te,Q,re,ve){if(typeof re=="object"&&re!==null&&re.type===_&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case x:e:{for(var ze=re.key;Q!==null;){if(Q.key===ze){if(ze=re.type,ze===_){if(Q.tag===7){c(te,Q.sibling),ve=g(Q,re.props.children),ve.return=te,te=ve;break e}}else if(Q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===z&&j0(ze)===Q.type){c(te,Q.sibling),ve=g(Q,re.props),Rl(ve,re),ve.return=te,te=ve;break e}c(te,Q);break}else s(te,Q);Q=Q.sibling}re.type===_?(ve=ms(re.props.children,te.mode,ve,re.key),ve.return=te,te=ve):(ve=cu(re.type,re.key,re.props,null,te.mode,ve),Rl(ve,re),ve.return=te,te=ve)}return k(te);case S:e:{for(ze=re.key;Q!==null;){if(Q.key===ze)if(Q.tag===4&&Q.stateNode.containerInfo===re.containerInfo&&Q.stateNode.implementation===re.implementation){c(te,Q.sibling),ve=g(Q,re.children||[]),ve.return=te,te=ve;break e}else{c(te,Q);break}else s(te,Q);Q=Q.sibling}ve=Mf(re,te.mode,ve),ve.return=te,te=ve}return k(te);case z:return ze=re._init,re=ze(re._payload),Lt(te,Q,re,ve)}if(_e(re))return Ke(te,Q,re,ve);if(ne(re)){if(ze=ne(re),typeof ze!="function")throw Error(i(150));return re=ze.call(re),$e(te,Q,re,ve)}if(typeof re.then=="function")return Lt(te,Q,Au(re),ve);if(re.$$typeof===C)return Lt(te,Q,hu(te,re),ve);ku(te,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,Q!==null&&Q.tag===6?(c(te,Q.sibling),ve=g(Q,re),ve.return=te,te=ve):(c(te,Q),ve=Of(re,te.mode,ve),ve.return=te,te=ve),k(te)):c(te,Q)}return function(te,Q,re,ve){try{Ml=0;var ze=Lt(te,Q,re,ve);return vo=null,ze}catch(Ve){if(Ve===wl||Ve===pu)throw Ve;var st=ji(29,Ve,null,te.mode);return st.lanes=ve,st.return=te,st}finally{}}}var yo=D0(!0),N0=D0(!1),qi=pe(null),Er=null;function Ca(a){var s=a.alternate;Y(Sn,Sn.current&1),Y(qi,a),Er===null&&(s===null||ho.current!==null||s.memoizedState!==null)&&(Er=a)}function O0(a){if(a.tag===22){if(Y(Sn,Sn.current),Y(qi,a),Er===null){var s=a.alternate;s!==null&&s.memoizedState!==null&&(Er=a)}}else ja()}function ja(){Y(Sn,Sn.current),Y(qi,qi.current)}function Kr(a){P(qi),Er===a&&(Er=null),P(Sn)}var Sn=pe(0);function Cu(a){for(var s=a;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||tm(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function fh(a,s,c,h){s=a.memoizedState,c=c(h,s),c=c==null?s:p({},s,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var hh={enqueueSetState:function(a,s,c){a=a._reactInternals;var h=Mi(),g=Ea(h);g.payload=s,c!=null&&(g.callback=c),s=Aa(a,g,h),s!==null&&(Ri(s,a,h),Al(s,a,h))},enqueueReplaceState:function(a,s,c){a=a._reactInternals;var h=Mi(),g=Ea(h);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=Aa(a,g,h),s!==null&&(Ri(s,a,h),Al(s,a,h))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var c=Mi(),h=Ea(c);h.tag=2,s!=null&&(h.callback=s),s=Aa(a,h,c),s!==null&&(Ri(s,a,c),Al(s,a,c))}};function M0(a,s,c,h,g,y,k){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(h,y,k):s.prototype&&s.prototype.isPureReactComponent?!gl(c,h)||!gl(g,y):!0}function R0(a,s,c,h){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,h),s.state!==a&&hh.enqueueReplaceState(s,s.state,null)}function Ts(a,s){var c=s;if("ref"in s){c={};for(var h in s)h!=="ref"&&(c[h]=s[h])}if(a=a.defaultProps){c===s&&(c=p({},c));for(var g in a)c[g]===void 0&&(c[g]=a[g])}return c}var ju=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function L0(a){ju(a)}function I0(a){console.error(a)}function P0(a){ju(a)}function Du(a,s){try{var c=a.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function B0(a,s,c){try{var h=a.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function mh(a,s,c){return c=Ea(c),c.tag=3,c.payload={element:null},c.callback=function(){Du(a,s)},c}function F0(a){return a=Ea(a),a.tag=3,a}function U0(a,s,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var y=h.value;a.payload=function(){return g(y)},a.callback=function(){B0(s,c,h)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(a.callback=function(){B0(s,c,h),typeof g!="function"&&(La===null?La=new Set([this]):La.add(this));var O=h.stack;this.componentDidCatch(h.value,{componentStack:O!==null?O:""})})}function D2(a,s,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=c.alternate,s!==null&&Sl(s,c,g,!0),c=qi.current,c!==null){switch(c.tag){case 13:return Er===null?Bh():c.alternate===null&&nn===0&&(nn=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===Wf?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([h]):s.add(h),Uh(a,h,g)),!1;case 22:return c.flags|=65536,h===Wf?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([h]):c.add(h)),Uh(a,h,g)),!1}throw Error(i(435,c.tag))}return Uh(a,h,g),Bh(),!1}if(St)return s=qi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==If&&(a=Error(i(422),{cause:h}),bl(Gi(a,c)))):(h!==If&&(s=Error(i(423),{cause:h}),bl(Gi(s,c))),a=a.current.alternate,a.flags|=65536,g&=-g,a.lanes|=g,h=Gi(h,c),g=mh(a.stateNode,h,g),Yf(a,g),nn!==4&&(nn=2)),!1;var y=Error(i(520),{cause:h});if(y=Gi(y,c),zl===null?zl=[y]:zl.push(y),nn!==4&&(nn=2),s===null)return!0;h=Gi(h,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,a=g&-g,c.lanes|=a,a=mh(c.stateNode,h,a),Yf(c,a),!1;case 1:if(s=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(La===null||!La.has(y))))return c.flags|=65536,g&=-g,c.lanes|=g,g=F0(g),U0(g,a,c,h),Yf(c,g),!1}c=c.return}while(c!==null);return!1}var z0=Error(i(461)),An=!1;function Ln(a,s,c,h){s.child=a===null?N0(s,null,c,h):yo(s,a.child,c,h)}function H0(a,s,c,h,g){c=c.render;var y=s.ref;if("ref"in h){var k={};for(var O in h)O!=="ref"&&(k[O]=h[O])}else k=h;return bs(s),h=Zf(a,s,c,k,y,g),O=Qf(),a!==null&&!An?(Jf(a,s,g),Zr(a,s,g)):(St&&O&&Rf(s),s.flags|=1,Ln(a,s,h,g),s.child)}function W0(a,s,c,h,g){if(a===null){var y=c.type;return typeof y=="function"&&!Nf(y)&&y.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=y,V0(a,s,y,h,g)):(a=cu(c.type,null,h,s,s.mode,g),a.ref=s.ref,a.return=s,s.child=a)}if(y=a.child,!_h(a,g)){var k=y.memoizedProps;if(c=c.compare,c=c!==null?c:gl,c(k,h)&&a.ref===s.ref)return Zr(a,s,g)}return s.flags|=1,a=Vr(y,h),a.ref=s.ref,a.return=s,s.child=a}function V0(a,s,c,h,g){if(a!==null){var y=a.memoizedProps;if(gl(y,h)&&a.ref===s.ref)if(An=!1,s.pendingProps=h=y,_h(a,g))(a.flags&131072)!==0&&(An=!0);else return s.lanes=a.lanes,Zr(a,s,g)}return ph(a,s,c,h,g)}function G0(a,s,c){var h=s.pendingProps,g=h.children,y=a!==null?a.memoizedState:null;if(h.mode==="hidden"){if((s.flags&128)!==0){if(h=y!==null?y.baseLanes|c:c,a!==null){for(g=s.child=a.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;s.childLanes=y&~h}else s.childLanes=0,s.child=null;return Y0(a,s,h,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&mu(s,y!==null?y.cachePool:null),y!==null?Vg(s,y):$f(),O0(s);else return s.lanes=s.childLanes=536870912,Y0(a,s,y!==null?y.baseLanes|c:c,c)}else y!==null?(mu(s,y.cachePool),Vg(s,y),ja(),s.memoizedState=null):(a!==null&&mu(s,null),$f(),ja());return Ln(a,s,g,c),s.child}function Y0(a,s,c,h){var g=Hf();return g=g===null?null:{parent:bn._currentValue,pool:g},s.memoizedState={baseLanes:c,cachePool:g},a!==null&&mu(s,null),$f(),O0(s),a!==null&&Sl(a,s,h,!0),null}function Nu(a,s){var c=s.ref;if(c===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(a===null||a.ref!==c)&&(s.flags|=4194816)}}function ph(a,s,c,h,g){return bs(s),c=Zf(a,s,c,h,void 0,g),h=Qf(),a!==null&&!An?(Jf(a,s,g),Zr(a,s,g)):(St&&h&&Rf(s),s.flags|=1,Ln(a,s,c,g),s.child)}function X0(a,s,c,h,g,y){return bs(s),s.updateQueue=null,c=Yg(s,h,c,g),Gg(a),h=Qf(),a!==null&&!An?(Jf(a,s,y),Zr(a,s,y)):(St&&h&&Rf(s),s.flags|=1,Ln(a,s,c,y),s.child)}function $0(a,s,c,h,g){if(bs(s),s.stateNode===null){var y=oo,k=c.contextType;typeof k=="object"&&k!==null&&(y=Xn(k)),y=new c(h,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=hh,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=h,y.state=s.memoizedState,y.refs={},Vf(s),k=c.contextType,y.context=typeof k=="object"&&k!==null?Xn(k):oo,y.state=s.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(fh(s,c,k,h),y.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(k=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),k!==y.state&&hh.enqueueReplaceState(y,y.state,null),Cl(s,h,y,g),kl(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(a===null){y=s.stateNode;var O=s.memoizedProps,G=Ts(c,O);y.props=G;var oe=y.context,ge=c.contextType;k=oo,typeof ge=="object"&&ge!==null&&(k=Xn(ge));var ye=c.getDerivedStateFromProps;ge=typeof ye=="function"||typeof y.getSnapshotBeforeUpdate=="function",O=s.pendingProps!==O,ge||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(O||oe!==k)&&R0(s,y,h,k),wa=!1;var ce=s.memoizedState;y.state=ce,Cl(s,h,y,g),kl(),oe=s.memoizedState,O||ce!==oe||wa?(typeof ye=="function"&&(fh(s,c,ye,h),oe=s.memoizedState),(G=wa||M0(s,c,G,h,ce,oe,k))?(ge||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=oe),y.props=h,y.state=oe,y.context=k,h=G):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{y=s.stateNode,Gf(a,s),k=s.memoizedProps,ge=Ts(c,k),y.props=ge,ye=s.pendingProps,ce=y.context,oe=c.contextType,G=oo,typeof oe=="object"&&oe!==null&&(G=Xn(oe)),O=c.getDerivedStateFromProps,(oe=typeof O=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(k!==ye||ce!==G)&&R0(s,y,h,G),wa=!1,ce=s.memoizedState,y.state=ce,Cl(s,h,y,g),kl();var fe=s.memoizedState;k!==ye||ce!==fe||wa||a!==null&&a.dependencies!==null&&fu(a.dependencies)?(typeof O=="function"&&(fh(s,c,O,h),fe=s.memoizedState),(ge=wa||M0(s,c,ge,h,ce,fe,G)||a!==null&&a.dependencies!==null&&fu(a.dependencies))?(oe||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(h,fe,G),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(h,fe,G)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||k===a.memoizedProps&&ce===a.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&ce===a.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=fe),y.props=h,y.state=fe,y.context=G,h=ge):(typeof y.componentDidUpdate!="function"||k===a.memoizedProps&&ce===a.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&ce===a.memoizedState||(s.flags|=1024),h=!1)}return y=h,Nu(a,s),h=(s.flags&128)!==0,y||h?(y=s.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,a!==null&&h?(s.child=yo(s,a.child,null,g),s.child=yo(s,null,c,g)):Ln(a,s,c,g),s.memoizedState=y.state,a=s.child):a=Zr(a,s,g),a}function q0(a,s,c,h){return xl(),s.flags|=256,Ln(a,s,c,h),s.child}var gh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vh(a){return{baseLanes:a,cachePool:Ig()}}function yh(a,s,c){return a=a!==null?a.childLanes&~c:0,s&&(a|=Ki),a}function K0(a,s,c){var h=s.pendingProps,g=!1,y=(s.flags&128)!==0,k;if((k=y)||(k=a!==null&&a.memoizedState===null?!1:(Sn.current&2)!==0),k&&(g=!0,s.flags&=-129),k=(s.flags&32)!==0,s.flags&=-33,a===null){if(St){if(g?Ca(s):ja(),St){var O=tn,G;if(G=O){e:{for(G=O,O=wr;G.nodeType!==8;){if(!O){O=null;break e}if(G=dr(G.nextSibling),G===null){O=null;break e}}O=G}O!==null?(s.memoizedState={dehydrated:O,treeContext:ps!==null?{id:Gr,overflow:Yr}:null,retryLane:536870912,hydrationErrors:null},G=ji(18,null,null,0),G.stateNode=O,G.return=s,s.child=G,ri=s,tn=null,G=!0):G=!1}G||ys(s)}if(O=s.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return tm(O)?s.lanes=32:s.lanes=536870912,null;Kr(s)}return O=h.children,h=h.fallback,g?(ja(),g=s.mode,O=Ou({mode:"hidden",children:O},g),h=ms(h,g,c,null),O.return=s,h.return=s,O.sibling=h,s.child=O,g=s.child,g.memoizedState=vh(c),g.childLanes=yh(a,k,c),s.memoizedState=gh,h):(Ca(s),xh(s,O))}if(G=a.memoizedState,G!==null&&(O=G.dehydrated,O!==null)){if(y)s.flags&256?(Ca(s),s.flags&=-257,s=bh(a,s,c)):s.memoizedState!==null?(ja(),s.child=a.child,s.flags|=128,s=null):(ja(),g=h.fallback,O=s.mode,h=Ou({mode:"visible",children:h.children},O),g=ms(g,O,c,null),g.flags|=2,h.return=s,g.return=s,h.sibling=g,s.child=h,yo(s,a.child,null,c),h=s.child,h.memoizedState=vh(c),h.childLanes=yh(a,k,c),s.memoizedState=gh,s=g);else if(Ca(s),tm(O)){if(k=O.nextSibling&&O.nextSibling.dataset,k)var oe=k.dgst;k=oe,h=Error(i(419)),h.stack="",h.digest=k,bl({value:h,source:null,stack:null}),s=bh(a,s,c)}else if(An||Sl(a,s,c,!1),k=(c&a.childLanes)!==0,An||k){if(k=Ut,k!==null&&(h=c&-c,h=(h&42)!==0?1:as(h),h=(h&(k.suspendedLanes|c))!==0?0:h,h!==0&&h!==G.retryLane))throw G.retryLane=h,so(a,h),Ri(k,a,h),z0;O.data==="$?"||Bh(),s=bh(a,s,c)}else O.data==="$?"?(s.flags|=192,s.child=a.child,s=null):(a=G.treeContext,tn=dr(O.nextSibling),ri=s,St=!0,vs=null,wr=!1,a!==null&&(Xi[$i++]=Gr,Xi[$i++]=Yr,Xi[$i++]=ps,Gr=a.id,Yr=a.overflow,ps=s),s=xh(s,h.children),s.flags|=4096);return s}return g?(ja(),g=h.fallback,O=s.mode,G=a.child,oe=G.sibling,h=Vr(G,{mode:"hidden",children:h.children}),h.subtreeFlags=G.subtreeFlags&65011712,oe!==null?g=Vr(oe,g):(g=ms(g,O,c,null),g.flags|=2),g.return=s,h.return=s,h.sibling=g,s.child=h,h=g,g=s.child,O=a.child.memoizedState,O===null?O=vh(c):(G=O.cachePool,G!==null?(oe=bn._currentValue,G=G.parent!==oe?{parent:oe,pool:oe}:G):G=Ig(),O={baseLanes:O.baseLanes|c,cachePool:G}),g.memoizedState=O,g.childLanes=yh(a,k,c),s.memoizedState=gh,h):(Ca(s),c=a.child,a=c.sibling,c=Vr(c,{mode:"visible",children:h.children}),c.return=s,c.sibling=null,a!==null&&(k=s.deletions,k===null?(s.deletions=[a],s.flags|=16):k.push(a)),s.child=c,s.memoizedState=null,c)}function xh(a,s){return s=Ou({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Ou(a,s){return a=ji(22,a,null,s),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function bh(a,s,c){return yo(s,a.child,null,c),a=xh(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function Z0(a,s,c){a.lanes|=s;var h=a.alternate;h!==null&&(h.lanes|=s),Bf(a.return,s,c)}function Sh(a,s,c,h,g){var y=a.memoizedState;y===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(y.isBackwards=s,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=c,y.tailMode=g)}function Q0(a,s,c){var h=s.pendingProps,g=h.revealOrder,y=h.tail;if(Ln(a,s,h.children,c),h=Sn.current,(h&2)!==0)h=h&1|2,s.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Z0(a,c,s);else if(a.tag===19)Z0(a,c,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}h&=1}switch(Y(Sn,h),g){case"forwards":for(c=s.child,g=null;c!==null;)a=c.alternate,a!==null&&Cu(a)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),Sh(s,!1,g,c,y);break;case"backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(a=g.alternate,a!==null&&Cu(a)===null){s.child=g;break}a=g.sibling,g.sibling=c,c=g,g=a}Sh(s,!0,c,null,y);break;case"together":Sh(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Zr(a,s,c){if(a!==null&&(s.dependencies=a.dependencies),Ra|=s.lanes,(c&s.childLanes)===0)if(a!==null){if(Sl(a,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(i(153));if(s.child!==null){for(a=s.child,c=Vr(a,a.pendingProps),s.child=c,c.return=s;a.sibling!==null;)a=a.sibling,c=c.sibling=Vr(a,a.pendingProps),c.return=s;c.sibling=null}return s.child}function _h(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&fu(a)))}function N2(a,s,c){switch(s.tag){case 3:Ce(s,s.stateNode.containerInfo),Ta(s,bn,a.memoizedState.cache),xl();break;case 27:case 5:ke(s);break;case 4:Ce(s,s.stateNode.containerInfo);break;case 10:Ta(s,s.type,s.memoizedProps.value);break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(Ca(s),s.flags|=128,null):(c&s.child.childLanes)!==0?K0(a,s,c):(Ca(s),a=Zr(a,s,c),a!==null?a.sibling:null);Ca(s);break;case 19:var g=(a.flags&128)!==0;if(h=(c&s.childLanes)!==0,h||(Sl(a,s,c,!1),h=(c&s.childLanes)!==0),g){if(h)return Q0(a,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Y(Sn,Sn.current),h)break;return null;case 22:case 23:return s.lanes=0,G0(a,s,c);case 24:Ta(s,bn,a.memoizedState.cache)}return Zr(a,s,c)}function J0(a,s,c){if(a!==null)if(a.memoizedProps!==s.pendingProps)An=!0;else{if(!_h(a,c)&&(s.flags&128)===0)return An=!1,N2(a,s,c);An=(a.flags&131072)!==0}else An=!1,St&&(s.flags&1048576)!==0&&jg(s,du,s.index);switch(s.lanes=0,s.tag){case 16:e:{a=s.pendingProps;var h=s.elementType,g=h._init;if(h=g(h._payload),s.type=h,typeof h=="function")Nf(h)?(a=Ts(h,a),s.tag=1,s=$0(null,s,h,a,c)):(s.tag=0,s=ph(null,s,h,a,c));else{if(h!=null){if(g=h.$$typeof,g===N){s.tag=11,s=H0(null,s,h,a,c);break e}else if(g===D){s.tag=14,s=W0(null,s,h,a,c);break e}}throw s=He(h)||h,Error(i(306,s,""))}}return s;case 0:return ph(a,s,s.type,s.pendingProps,c);case 1:return h=s.type,g=Ts(h,s.pendingProps),$0(a,s,h,g,c);case 3:e:{if(Ce(s,s.stateNode.containerInfo),a===null)throw Error(i(387));h=s.pendingProps;var y=s.memoizedState;g=y.element,Gf(a,s),Cl(s,h,null,c);var k=s.memoizedState;if(h=k.cache,Ta(s,bn,h),h!==y.cache&&Ff(s,[bn],c,!0),kl(),h=k.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:k.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=q0(a,s,h,c);break e}else if(h!==g){g=Gi(Error(i(424)),s),bl(g),s=q0(a,s,h,c);break e}else{switch(a=s.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(tn=dr(a.firstChild),ri=s,St=!0,vs=null,wr=!0,c=N0(s,null,h,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(xl(),h===g){s=Zr(a,s,c);break e}Ln(a,s,h,c)}s=s.child}return s;case 26:return Nu(a,s),a===null?(c=iv(s.type,null,s.pendingProps,null))?s.memoizedState=c:St||(c=s.type,a=s.pendingProps,h=Yu(ae.current).createElement(c),h[Jt]=s,h[en]=a,Pn(h,c,a),ee(h),s.stateNode=h):s.memoizedState=iv(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return ke(s),a===null&&St&&(h=s.stateNode=ev(s.type,s.pendingProps,ae.current),ri=s,wr=!0,g=tn,Ba(s.type)?(nm=g,tn=dr(h.firstChild)):tn=g),Ln(a,s,s.pendingProps.children,c),Nu(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&St&&((g=h=tn)&&(h=aT(h,s.type,s.pendingProps,wr),h!==null?(s.stateNode=h,ri=s,tn=dr(h.firstChild),wr=!1,g=!0):g=!1),g||ys(s)),ke(s),g=s.type,y=s.pendingProps,k=a!==null?a.memoizedProps:null,h=y.children,Qh(g,y)?h=null:k!==null&&Qh(g,k)&&(s.flags|=32),s.memoizedState!==null&&(g=Zf(a,s,T2,null,null,c),Kl._currentValue=g),Nu(a,s),Ln(a,s,h,c),s.child;case 6:return a===null&&St&&((a=c=tn)&&(c=sT(c,s.pendingProps,wr),c!==null?(s.stateNode=c,ri=s,tn=null,a=!0):a=!1),a||ys(s)),null;case 13:return K0(a,s,c);case 4:return Ce(s,s.stateNode.containerInfo),h=s.pendingProps,a===null?s.child=yo(s,null,h,c):Ln(a,s,h,c),s.child;case 11:return H0(a,s,s.type,s.pendingProps,c);case 7:return Ln(a,s,s.pendingProps,c),s.child;case 8:return Ln(a,s,s.pendingProps.children,c),s.child;case 12:return Ln(a,s,s.pendingProps.children,c),s.child;case 10:return h=s.pendingProps,Ta(s,s.type,h.value),Ln(a,s,h.children,c),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,bs(s),g=Xn(g),h=h(g),s.flags|=1,Ln(a,s,h,c),s.child;case 14:return W0(a,s,s.type,s.pendingProps,c);case 15:return V0(a,s,s.type,s.pendingProps,c);case 19:return Q0(a,s,c);case 31:return h=s.pendingProps,c=s.mode,h={mode:h.mode,children:h.children},a===null?(c=Ou(h,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=Vr(a.child,h),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return G0(a,s,c);case 24:return bs(s),h=Xn(bn),a===null?(g=Hf(),g===null&&(g=Ut,y=Uf(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=c),g=y),s.memoizedState={parent:h,cache:g},Vf(s),Ta(s,bn,g)):((a.lanes&c)!==0&&(Gf(a,s),Cl(s,null,null,c),kl()),g=a.memoizedState,y=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Ta(s,bn,h)):(h=y.cache,Ta(s,bn,h),h!==g.cache&&Ff(s,[bn],c,!0))),Ln(a,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Qr(a){a.flags|=4}function e1(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!lv(s)){if(s=qi.current,s!==null&&((ft&4194048)===ft?Er!==null:(ft&62914560)!==ft&&(ft&536870912)===0||s!==Er))throw El=Wf,Pg;a.flags|=8192}}function Mu(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?wi():536870912,a.lanes|=s,_o|=s)}function Ll(a,s){if(!St)switch(a.tailMode){case"hidden":s=a.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:h.sibling=null}}function Zt(a){var s=a.alternate!==null&&a.alternate.child===a.child,c=0,h=0;if(s)for(var g=a.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=h,a.childLanes=c,s}function O2(a,s,c){var h=s.pendingProps;switch(Lf(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(s),null;case 1:return Zt(s),null;case 3:return c=s.stateNode,h=null,a!==null&&(h=a.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),$r(bn),Le(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(yl(s)?Qr(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Og())),Zt(s),null;case 26:return c=s.memoizedState,a===null?(Qr(s),c!==null?(Zt(s),e1(s,c)):(Zt(s),s.flags&=-16777217)):c?c!==a.memoizedState?(Qr(s),Zt(s),e1(s,c)):(Zt(s),s.flags&=-16777217):(a.memoizedProps!==h&&Qr(s),Zt(s),s.flags&=-16777217),null;case 27:ct(s),c=ae.current;var g=s.type;if(a!==null&&s.stateNode!=null)a.memoizedProps!==h&&Qr(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Zt(s),null}a=V.current,yl(s)?Dg(s):(a=ev(g,h,c),s.stateNode=a,Qr(s))}return Zt(s),null;case 5:if(ct(s),c=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==h&&Qr(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Zt(s),null}if(a=V.current,yl(s))Dg(s);else{switch(g=Yu(ae.current),a){case 1:a=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:a=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":a=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":a=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":a=g.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?a.multiple=!0:h.size&&(a.size=h.size);break;default:a=typeof h.is=="string"?g.createElement(c,{is:h.is}):g.createElement(c)}}a[Jt]=s,a[en]=h;e:for(g=s.child;g!==null;){if(g.tag===5||g.tag===6)a.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===s)break e;for(;g.sibling===null;){if(g.return===null||g.return===s)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}s.stateNode=a;e:switch(Pn(a,c,h),c){case"button":case"input":case"select":case"textarea":a=!!h.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Qr(s)}}return Zt(s),s.flags&=-16777217,null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==h&&Qr(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(i(166));if(a=ae.current,yl(s)){if(a=s.stateNode,c=s.memoizedProps,h=null,g=ri,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}a[Jt]=s,a=!!(a.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||X1(a.nodeValue,c)),a||ys(s)}else a=Yu(a).createTextNode(h),a[Jt]=s,s.stateNode=a}return Zt(s),null;case 13:if(h=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(g=yl(s),h!==null&&h.dehydrated!==null){if(a===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Jt]=s}else xl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Zt(s),g=!1}else g=Og(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Kr(s),s):(Kr(s),null)}if(Kr(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=h!==null,a=a!==null&&a.memoizedState!==null,c){h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var y=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==g&&(h.flags|=2048)}return c!==a&&c&&(s.child.flags|=8192),Mu(s,s.updateQueue),Zt(s),null;case 4:return Le(),a===null&&Xh(s.stateNode.containerInfo),Zt(s),null;case 10:return $r(s.type),Zt(s),null;case 19:if(P(Sn),g=s.memoizedState,g===null)return Zt(s),null;if(h=(s.flags&128)!==0,y=g.rendering,y===null)if(h)Ll(g,!1);else{if(nn!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(y=Cu(a),y!==null){for(s.flags|=128,Ll(g,!1),a=y.updateQueue,s.updateQueue=a,Mu(s,a),s.subtreeFlags=0,a=c,c=s.child;c!==null;)Cg(c,a),c=c.sibling;return Y(Sn,Sn.current&1|2),s.child}a=a.sibling}g.tail!==null&&Me()>Iu&&(s.flags|=128,h=!0,Ll(g,!1),s.lanes=4194304)}else{if(!h)if(a=Cu(y),a!==null){if(s.flags|=128,h=!0,a=a.updateQueue,s.updateQueue=a,Mu(s,a),Ll(g,!0),g.tail===null&&g.tailMode==="hidden"&&!y.alternate&&!St)return Zt(s),null}else 2*Me()-g.renderingStartTime>Iu&&c!==536870912&&(s.flags|=128,h=!0,Ll(g,!1),s.lanes=4194304);g.isBackwards?(y.sibling=s.child,s.child=y):(a=g.last,a!==null?a.sibling=y:s.child=y,g.last=y)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=Me(),s.sibling=null,a=Sn.current,Y(Sn,h?a&1|2:a&1),s):(Zt(s),null);case 22:case 23:return Kr(s),qf(),h=s.memoizedState!==null,a!==null?a.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(c&536870912)!==0&&(s.flags&128)===0&&(Zt(s),s.subtreeFlags&6&&(s.flags|=8192)):Zt(s),c=s.updateQueue,c!==null&&Mu(s,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==c&&(s.flags|=2048),a!==null&&P(Ss),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),$r(bn),Zt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function M2(a,s){switch(Lf(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return $r(bn),Le(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return ct(s),null;case 13:if(Kr(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(i(340));xl()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return P(Sn),null;case 4:return Le(),null;case 10:return $r(s.type),null;case 22:case 23:return Kr(s),qf(),a!==null&&P(Ss),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return $r(bn),null;case 25:return null;default:return null}}function t1(a,s){switch(Lf(s),s.tag){case 3:$r(bn),Le();break;case 26:case 27:case 5:ct(s);break;case 4:Le();break;case 13:Kr(s);break;case 19:P(Sn);break;case 10:$r(s.type);break;case 22:case 23:Kr(s),qf(),a!==null&&P(Ss);break;case 24:$r(bn)}}function Il(a,s){try{var c=s.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&a)===a){h=void 0;var y=c.create,k=c.inst;h=y(),k.destroy=h}c=c.next}while(c!==g)}}catch(O){Bt(s,s.return,O)}}function Da(a,s,c){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var y=g.next;h=y;do{if((h.tag&a)===a){var k=h.inst,O=k.destroy;if(O!==void 0){k.destroy=void 0,g=s;var G=c,oe=O;try{oe()}catch(ge){Bt(g,G,ge)}}}h=h.next}while(h!==y)}}catch(ge){Bt(s,s.return,ge)}}function n1(a){var s=a.updateQueue;if(s!==null){var c=a.stateNode;try{Wg(s,c)}catch(h){Bt(a,a.return,h)}}}function i1(a,s,c){c.props=Ts(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(h){Bt(a,s,h)}}function Pl(a,s){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var h=a.stateNode;break;case 30:h=a.stateNode;break;default:h=a.stateNode}typeof c=="function"?a.refCleanup=c(h):c.current=h}}catch(g){Bt(a,s,g)}}function Ar(a,s){var c=a.ref,h=a.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){Bt(a,s,g)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Bt(a,s,g)}else c.current=null}function r1(a){var s=a.type,c=a.memoizedProps,h=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){Bt(a,a.return,g)}}function Th(a,s,c){try{var h=a.stateNode;eT(h,a.type,c,s),h[en]=s}catch(g){Bt(a,a.return,g)}}function a1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ba(a.type)||a.tag===4}function wh(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||a1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ba(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Eh(a,s,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(a),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Gu));else if(h!==4&&(h===27&&Ba(a.type)&&(c=a.stateNode,s=null),a=a.child,a!==null))for(Eh(a,s,c),a=a.sibling;a!==null;)Eh(a,s,c),a=a.sibling}function Ru(a,s,c){var h=a.tag;if(h===5||h===6)a=a.stateNode,s?c.insertBefore(a,s):c.appendChild(a);else if(h!==4&&(h===27&&Ba(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Ru(a,s,c),a=a.sibling;a!==null;)Ru(a,s,c),a=a.sibling}function s1(a){var s=a.stateNode,c=a.memoizedProps;try{for(var h=a.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Pn(s,h,c),s[Jt]=a,s[en]=c}catch(y){Bt(a,a.return,y)}}var Jr=!1,ln=!1,Ah=!1,o1=typeof WeakSet=="function"?WeakSet:Set,kn=null;function R2(a,s){if(a=a.containerInfo,Kh=Qu,a=yg(a),wf(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var k=0,O=-1,G=-1,oe=0,ge=0,ye=a,ce=null;t:for(;;){for(var fe;ye!==c||g!==0&&ye.nodeType!==3||(O=k+g),ye!==y||h!==0&&ye.nodeType!==3||(G=k+h),ye.nodeType===3&&(k+=ye.nodeValue.length),(fe=ye.firstChild)!==null;)ce=ye,ye=fe;for(;;){if(ye===a)break t;if(ce===c&&++oe===g&&(O=k),ce===y&&++ge===h&&(G=k),(fe=ye.nextSibling)!==null)break;ye=ce,ce=ye.parentNode}ye=fe}c=O===-1||G===-1?null:{start:O,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(Zh={focusedElem:a,selectionRange:c},Qu=!1,kn=s;kn!==null;)if(s=kn,a=s.child,(s.subtreeFlags&1024)!==0&&a!==null)a.return=s,kn=a;else for(;kn!==null;){switch(s=kn,y=s.alternate,a=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&y!==null){a=void 0,c=s,g=y.memoizedProps,y=y.memoizedState,h=c.stateNode;try{var Ke=Ts(c.type,g,c.elementType===c.type);a=h.getSnapshotBeforeUpdate(Ke,y),h.__reactInternalSnapshotBeforeUpdate=a}catch($e){Bt(c,c.return,$e)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,c=a.nodeType,c===9)em(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":em(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(i(163))}if(a=s.sibling,a!==null){a.return=s.return,kn=a;break}kn=s.return}}function l1(a,s,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Na(a,c),h&4&&Il(5,c);break;case 1:if(Na(a,c),h&4)if(a=c.stateNode,s===null)try{a.componentDidMount()}catch(k){Bt(c,c.return,k)}else{var g=Ts(c.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(g,s,a.__reactInternalSnapshotBeforeUpdate)}catch(k){Bt(c,c.return,k)}}h&64&&n1(c),h&512&&Pl(c,c.return);break;case 3:if(Na(a,c),h&64&&(a=c.updateQueue,a!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Wg(a,s)}catch(k){Bt(c,c.return,k)}}break;case 27:s===null&&h&4&&s1(c);case 26:case 5:Na(a,c),s===null&&h&4&&r1(c),h&512&&Pl(c,c.return);break;case 12:Na(a,c);break;case 13:Na(a,c),h&4&&d1(a,c),h&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=W2.bind(null,c),oT(a,c))));break;case 22:if(h=c.memoizedState!==null||Jr,!h){s=s!==null&&s.memoizedState!==null||ln,g=Jr;var y=ln;Jr=h,(ln=s)&&!y?Oa(a,c,(c.subtreeFlags&8772)!==0):Na(a,c),Jr=g,ln=y}break;case 30:break;default:Na(a,c)}}function c1(a){var s=a.alternate;s!==null&&(a.alternate=null,c1(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&R(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Gt=null,hi=!1;function ea(a,s,c){for(c=c.child;c!==null;)u1(a,s,c),c=c.sibling}function u1(a,s,c){if(wt&&typeof wt.onCommitFiberUnmount=="function")try{wt.onCommitFiberUnmount(Ot,c)}catch{}switch(c.tag){case 26:ln||Ar(c,s),ea(a,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:ln||Ar(c,s);var h=Gt,g=hi;Ba(c.type)&&(Gt=c.stateNode,hi=!1),ea(a,s,c),Yl(c.stateNode),Gt=h,hi=g;break;case 5:ln||Ar(c,s);case 6:if(h=Gt,g=hi,Gt=null,ea(a,s,c),Gt=h,hi=g,Gt!==null)if(hi)try{(Gt.nodeType===9?Gt.body:Gt.nodeName==="HTML"?Gt.ownerDocument.body:Gt).removeChild(c.stateNode)}catch(y){Bt(c,s,y)}else try{Gt.removeChild(c.stateNode)}catch(y){Bt(c,s,y)}break;case 18:Gt!==null&&(hi?(a=Gt,Q1(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),ec(a)):Q1(Gt,c.stateNode));break;case 4:h=Gt,g=hi,Gt=c.stateNode.containerInfo,hi=!0,ea(a,s,c),Gt=h,hi=g;break;case 0:case 11:case 14:case 15:ln||Da(2,c,s),ln||Da(4,c,s),ea(a,s,c);break;case 1:ln||(Ar(c,s),h=c.stateNode,typeof h.componentWillUnmount=="function"&&i1(c,s,h)),ea(a,s,c);break;case 21:ea(a,s,c);break;case 22:ln=(h=ln)||c.memoizedState!==null,ea(a,s,c),ln=h;break;default:ea(a,s,c)}}function d1(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{ec(a)}catch(c){Bt(s,s.return,c)}}function L2(a){switch(a.tag){case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new o1),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new o1),s;default:throw Error(i(435,a.tag))}}function kh(a,s){var c=L2(a);s.forEach(function(h){var g=V2.bind(null,a,h);c.has(h)||(c.add(h),h.then(g,g))})}function Di(a,s){var c=s.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],y=a,k=s,O=k;e:for(;O!==null;){switch(O.tag){case 27:if(Ba(O.type)){Gt=O.stateNode,hi=!1;break e}break;case 5:Gt=O.stateNode,hi=!1;break e;case 3:case 4:Gt=O.stateNode.containerInfo,hi=!0;break e}O=O.return}if(Gt===null)throw Error(i(160));u1(y,k,g),Gt=null,hi=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)f1(s,a),s=s.sibling}var ur=null;function f1(a,s){var c=a.alternate,h=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Di(s,a),Ni(a),h&4&&(Da(3,a,a.return),Il(3,a),Da(5,a,a.return));break;case 1:Di(s,a),Ni(a),h&512&&(ln||c===null||Ar(c,c.return)),h&64&&Jr&&(a=a.updateQueue,a!==null&&(h=a.callbacks,h!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=ur;if(Di(s,a),Ni(a),h&512&&(ln||c===null||Ar(c,c.return)),h&4){var y=c!==null?c.memoizedState:null;if(h=a.memoizedState,c===null)if(h===null)if(a.stateNode===null){e:{h=a.type,c=a.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":y=g.getElementsByTagName("title")[0],(!y||y[M]||y[Jt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(h),g.head.insertBefore(y,g.querySelector("head > title"))),Pn(y,h,c),y[Jt]=a,ee(y),h=y;break e;case"link":var k=sv("link","href",g).get(h+(c.href||""));if(k){for(var O=0;O<k.length;O++)if(y=k[O],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(O,1);break t}}y=g.createElement(h),Pn(y,h,c),g.head.appendChild(y);break;case"meta":if(k=sv("meta","content",g).get(h+(c.content||""))){for(O=0;O<k.length;O++)if(y=k[O],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(O,1);break t}}y=g.createElement(h),Pn(y,h,c),g.head.appendChild(y);break;default:throw Error(i(468,h))}y[Jt]=a,ee(y),h=y}a.stateNode=h}else ov(g,a.type,a.stateNode);else a.stateNode=av(g,h,a.memoizedProps);else y!==h?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,h===null?ov(g,a.type,a.stateNode):av(g,h,a.memoizedProps)):h===null&&a.stateNode!==null&&Th(a,a.memoizedProps,c.memoizedProps)}break;case 27:Di(s,a),Ni(a),h&512&&(ln||c===null||Ar(c,c.return)),c!==null&&h&4&&Th(a,a.memoizedProps,c.memoizedProps);break;case 5:if(Di(s,a),Ni(a),h&512&&(ln||c===null||Ar(c,c.return)),a.flags&32){g=a.stateNode;try{sr(g,"")}catch(fe){Bt(a,a.return,fe)}}h&4&&a.stateNode!=null&&(g=a.memoizedProps,Th(a,g,c!==null?c.memoizedProps:g)),h&1024&&(Ah=!0);break;case 6:if(Di(s,a),Ni(a),h&4){if(a.stateNode===null)throw Error(i(162));h=a.memoizedProps,c=a.stateNode;try{c.nodeValue=h}catch(fe){Bt(a,a.return,fe)}}break;case 3:if(qu=null,g=ur,ur=Xu(s.containerInfo),Di(s,a),ur=g,Ni(a),h&4&&c!==null&&c.memoizedState.isDehydrated)try{ec(s.containerInfo)}catch(fe){Bt(a,a.return,fe)}Ah&&(Ah=!1,h1(a));break;case 4:h=ur,ur=Xu(a.stateNode.containerInfo),Di(s,a),Ni(a),ur=h;break;case 12:Di(s,a),Ni(a);break;case 13:Di(s,a),Ni(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Mh=Me()),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,kh(a,h)));break;case 22:g=a.memoizedState!==null;var G=c!==null&&c.memoizedState!==null,oe=Jr,ge=ln;if(Jr=oe||g,ln=ge||G,Di(s,a),ln=ge,Jr=oe,Ni(a),h&8192)e:for(s=a.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||G||Jr||ln||ws(a)),c=null,s=a;;){if(s.tag===5||s.tag===26){if(c===null){G=c=s;try{if(y=G.stateNode,g)k=y.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{O=G.stateNode;var ye=G.memoizedProps.style,ce=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;O.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(fe){Bt(G,G.return,fe)}}}else if(s.tag===6){if(c===null){G=s;try{G.stateNode.nodeValue=g?"":G.memoizedProps}catch(fe){Bt(G,G.return,fe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=a.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,kh(a,c))));break;case 19:Di(s,a),Ni(a),h&4&&(h=a.updateQueue,h!==null&&(a.updateQueue=null,kh(a,h)));break;case 30:break;case 21:break;default:Di(s,a),Ni(a)}}function Ni(a){var s=a.flags;if(s&2){try{for(var c,h=a.return;h!==null;){if(a1(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var g=c.stateNode,y=wh(a);Ru(a,y,g);break;case 5:var k=c.stateNode;c.flags&32&&(sr(k,""),c.flags&=-33);var O=wh(a);Ru(a,O,k);break;case 3:case 4:var G=c.stateNode.containerInfo,oe=wh(a);Eh(a,oe,G);break;default:throw Error(i(161))}}catch(ge){Bt(a,a.return,ge)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function h1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;h1(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function Na(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)l1(a,s.alternate,s),s=s.sibling}function ws(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:Da(4,s,s.return),ws(s);break;case 1:Ar(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&i1(s,s.return,c),ws(s);break;case 27:Yl(s.stateNode);case 26:case 5:Ar(s,s.return),ws(s);break;case 22:s.memoizedState===null&&ws(s);break;case 30:ws(s);break;default:ws(s)}a=a.sibling}}function Oa(a,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=a,y=s,k=y.flags;switch(y.tag){case 0:case 11:case 15:Oa(g,y,c),Il(4,y);break;case 1:if(Oa(g,y,c),h=y,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(oe){Bt(h,h.return,oe)}if(h=y,g=h.updateQueue,g!==null){var O=h.stateNode;try{var G=g.shared.hiddenCallbacks;if(G!==null)for(g.shared.hiddenCallbacks=null,g=0;g<G.length;g++)Hg(G[g],O)}catch(oe){Bt(h,h.return,oe)}}c&&k&64&&n1(y),Pl(y,y.return);break;case 27:s1(y);case 26:case 5:Oa(g,y,c),c&&h===null&&k&4&&r1(y),Pl(y,y.return);break;case 12:Oa(g,y,c);break;case 13:Oa(g,y,c),c&&k&4&&d1(g,y);break;case 22:y.memoizedState===null&&Oa(g,y,c),Pl(y,y.return);break;case 30:break;default:Oa(g,y,c)}s=s.sibling}}function Ch(a,s){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&_l(c))}function jh(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&_l(a))}function kr(a,s,c,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)m1(a,s,c,h),s=s.sibling}function m1(a,s,c,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:kr(a,s,c,h),g&2048&&Il(9,s);break;case 1:kr(a,s,c,h);break;case 3:kr(a,s,c,h),g&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&_l(a)));break;case 12:if(g&2048){kr(a,s,c,h),a=s.stateNode;try{var y=s.memoizedProps,k=y.id,O=y.onPostCommit;typeof O=="function"&&O(k,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(G){Bt(s,s.return,G)}}else kr(a,s,c,h);break;case 13:kr(a,s,c,h);break;case 23:break;case 22:y=s.stateNode,k=s.alternate,s.memoizedState!==null?y._visibility&2?kr(a,s,c,h):Bl(a,s):y._visibility&2?kr(a,s,c,h):(y._visibility|=2,xo(a,s,c,h,(s.subtreeFlags&10256)!==0)),g&2048&&Ch(k,s);break;case 24:kr(a,s,c,h),g&2048&&jh(s.alternate,s);break;default:kr(a,s,c,h)}}function xo(a,s,c,h,g){for(g=g&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var y=a,k=s,O=c,G=h,oe=k.flags;switch(k.tag){case 0:case 11:case 15:xo(y,k,O,G,g),Il(8,k);break;case 23:break;case 22:var ge=k.stateNode;k.memoizedState!==null?ge._visibility&2?xo(y,k,O,G,g):Bl(y,k):(ge._visibility|=2,xo(y,k,O,G,g)),g&&oe&2048&&Ch(k.alternate,k);break;case 24:xo(y,k,O,G,g),g&&oe&2048&&jh(k.alternate,k);break;default:xo(y,k,O,G,g)}s=s.sibling}}function Bl(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=a,h=s,g=h.flags;switch(h.tag){case 22:Bl(c,h),g&2048&&Ch(h.alternate,h);break;case 24:Bl(c,h),g&2048&&jh(h.alternate,h);break;default:Bl(c,h)}s=s.sibling}}var Fl=8192;function bo(a){if(a.subtreeFlags&Fl)for(a=a.child;a!==null;)p1(a),a=a.sibling}function p1(a){switch(a.tag){case 26:bo(a),a.flags&Fl&&a.memoizedState!==null&&bT(ur,a.memoizedState,a.memoizedProps);break;case 5:bo(a);break;case 3:case 4:var s=ur;ur=Xu(a.stateNode.containerInfo),bo(a),ur=s;break;case 22:a.memoizedState===null&&(s=a.alternate,s!==null&&s.memoizedState!==null?(s=Fl,Fl=16777216,bo(a),Fl=s):bo(a));break;default:bo(a)}}function g1(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function Ul(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];kn=h,y1(h,a)}g1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)v1(a),a=a.sibling}function v1(a){switch(a.tag){case 0:case 11:case 15:Ul(a),a.flags&2048&&Da(9,a,a.return);break;case 3:Ul(a);break;case 12:Ul(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,Lu(a)):Ul(a);break;default:Ul(a)}}function Lu(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];kn=h,y1(h,a)}g1(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:Da(8,s,s.return),Lu(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,Lu(s));break;default:Lu(s)}a=a.sibling}}function y1(a,s){for(;kn!==null;){var c=kn;switch(c.tag){case 0:case 11:case 15:Da(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:_l(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,kn=h;else e:for(c=a;kn!==null;){h=kn;var g=h.sibling,y=h.return;if(c1(h),h===c){kn=null;break e}if(g!==null){g.return=y,kn=g;break e}kn=y}}}var I2={getCacheForType:function(a){var s=Xn(bn),c=s.data.get(a);return c===void 0&&(c=a(),s.data.set(a,c)),c}},P2=typeof WeakMap=="function"?WeakMap:Map,Et=0,Ut=null,ot=null,ft=0,At=0,Oi=null,Ma=!1,So=!1,Dh=!1,ta=0,nn=0,Ra=0,Es=0,Nh=0,Ki=0,_o=0,zl=null,mi=null,Oh=!1,Mh=0,Iu=1/0,Pu=null,La=null,In=0,Ia=null,To=null,wo=0,Rh=0,Lh=null,x1=null,Hl=0,Ih=null;function Mi(){if((Et&2)!==0&&ft!==0)return ft&-ft;if(ie.T!==null){var a=uo;return a!==0?a:Wh()}return Ks()}function b1(){Ki===0&&(Ki=(ft&536870912)===0||St?ar():536870912);var a=qi.current;return a!==null&&(a.flags|=32),Ki}function Ri(a,s,c){(a===Ut&&(At===2||At===9)||a.cancelPendingCommit!==null)&&(Eo(a,0),Pa(a,ft,Ki,!1)),qt(a,c),((Et&2)===0||a!==Ut)&&(a===Ut&&((Et&2)===0&&(Es|=c),nn===4&&Pa(a,ft,Ki,!1)),Cr(a))}function S1(a,s,c){if((Et&6)!==0)throw Error(i(327));var h=!c&&(s&124)===0&&(s&a.expiredLanes)===0||Ui(a,s),g=h?U2(a,s):Fh(a,s,!0),y=h;do{if(g===0){So&&!h&&Pa(a,s,0,!1);break}else{if(c=a.current.alternate,y&&!B2(c)){g=Fh(a,s,!1),y=!1;continue}if(g===2){if(y=s,a.errorRecoveryDisabledLanes&y)var k=0;else k=a.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){s=k;e:{var O=a;g=zl;var G=O.current.memoizedState.isDehydrated;if(G&&(Eo(O,k).flags|=256),k=Fh(O,k,!1),k!==2){if(Dh&&!G){O.errorRecoveryDisabledLanes|=y,Es|=y,g=4;break e}y=mi,mi=g,y!==null&&(mi===null?mi=y:mi.push.apply(mi,y))}g=k}if(y=!1,g!==2)continue}}if(g===1){Eo(a,0),Pa(a,s,0,!0);break}e:{switch(h=a,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Pa(h,s,Ki,!Ma);break e;case 2:mi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=Mh+300-Me(),10<g)){if(Pa(h,s,Ki,!Ma),Yn(h,0,!0)!==0)break e;h.timeoutHandle=K1(_1.bind(null,h,c,mi,Pu,Oh,s,Ki,Es,_o,Ma,y,2,-0,0),g);break e}_1(h,c,mi,Pu,Oh,s,Ki,Es,_o,Ma,y,0,-0,0)}}break}while(!0);Cr(a)}function _1(a,s,c,h,g,y,k,O,G,oe,ge,ye,ce,fe){if(a.timeoutHandle=-1,ye=s.subtreeFlags,(ye&8192||(ye&16785408)===16785408)&&(ql={stylesheets:null,count:0,unsuspend:xT},p1(s),ye=ST(),ye!==null)){a.cancelPendingCommit=ye(j1.bind(null,a,s,y,c,h,g,k,O,G,ge,1,ce,fe)),Pa(a,y,k,!oe);return}j1(a,s,y,c,h,g,k,O,G)}function B2(a){for(var s=a;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],y=g.getSnapshot;g=g.value;try{if(!Ci(y(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Pa(a,s,c,h){s&=~Nh,s&=~Es,a.suspendedLanes|=s,a.pingedLanes&=~s,h&&(a.warmLanes|=s),h=a.expirationTimes;for(var g=s;0<g;){var y=31-J(g),k=1<<y;h[y]=-1,g&=~k}c!==0&&va(a,c,s)}function Bu(){return(Et&6)===0?(Wl(0),!1):!0}function Ph(){if(ot!==null){if(At===0)var a=ot.return;else a=ot,Xr=xs=null,eh(a),vo=null,Ml=0,a=ot;for(;a!==null;)t1(a.alternate,a),a=a.return;ot=null}}function Eo(a,s){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,nT(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),Ph(),Ut=a,ot=c=Vr(a.current,null),ft=s,At=0,Oi=null,Ma=!1,So=Ui(a,s),Dh=!1,_o=Ki=Nh=Es=Ra=nn=0,mi=zl=null,Oh=!1,(s&8)!==0&&(s|=s&32);var h=a.entangledLanes;if(h!==0)for(a=a.entanglements,h&=s;0<h;){var g=31-J(h),y=1<<g;s|=a[g],h&=~y}return ta=s,su(),c}function T1(a,s){at=null,ie.H=Eu,s===wl||s===pu?(s=Ug(),At=3):s===Pg?(s=Ug(),At=4):At=s===z0?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Oi=s,ot===null&&(nn=1,Du(a,Gi(s,a.current)))}function w1(){var a=ie.H;return ie.H=Eu,a===null?Eu:a}function E1(){var a=ie.A;return ie.A=I2,a}function Bh(){nn=4,Ma||(ft&4194048)!==ft&&qi.current!==null||(So=!0),(Ra&134217727)===0&&(Es&134217727)===0||Ut===null||Pa(Ut,ft,Ki,!1)}function Fh(a,s,c){var h=Et;Et|=2;var g=w1(),y=E1();(Ut!==a||ft!==s)&&(Pu=null,Eo(a,s)),s=!1;var k=nn;e:do try{if(At!==0&&ot!==null){var O=ot,G=Oi;switch(At){case 8:Ph(),k=6;break e;case 3:case 2:case 9:case 6:qi.current===null&&(s=!0);var oe=At;if(At=0,Oi=null,Ao(a,O,G,oe),c&&So){k=0;break e}break;default:oe=At,At=0,Oi=null,Ao(a,O,G,oe)}}F2(),k=nn;break}catch(ge){T1(a,ge)}while(!0);return s&&a.shellSuspendCounter++,Xr=xs=null,Et=h,ie.H=g,ie.A=y,ot===null&&(Ut=null,ft=0,su()),k}function F2(){for(;ot!==null;)A1(ot)}function U2(a,s){var c=Et;Et|=2;var h=w1(),g=E1();Ut!==a||ft!==s?(Pu=null,Iu=Me()+500,Eo(a,s)):So=Ui(a,s);e:do try{if(At!==0&&ot!==null){s=ot;var y=Oi;t:switch(At){case 1:At=0,Oi=null,Ao(a,s,y,1);break;case 2:case 9:if(Bg(y)){At=0,Oi=null,k1(s);break}s=function(){At!==2&&At!==9||Ut!==a||(At=7),Cr(a)},y.then(s,s);break e;case 3:At=7;break e;case 4:At=5;break e;case 7:Bg(y)?(At=0,Oi=null,k1(s)):(At=0,Oi=null,Ao(a,s,y,7));break;case 5:var k=null;switch(ot.tag){case 26:k=ot.memoizedState;case 5:case 27:var O=ot;if(!k||lv(k)){At=0,Oi=null;var G=O.sibling;if(G!==null)ot=G;else{var oe=O.return;oe!==null?(ot=oe,Fu(oe)):ot=null}break t}}At=0,Oi=null,Ao(a,s,y,5);break;case 6:At=0,Oi=null,Ao(a,s,y,6);break;case 8:Ph(),nn=6;break e;default:throw Error(i(462))}}z2();break}catch(ge){T1(a,ge)}while(!0);return Xr=xs=null,ie.H=h,ie.A=g,Et=c,ot!==null?0:(Ut=null,ft=0,su(),nn)}function z2(){for(;ot!==null&&!Gn();)A1(ot)}function A1(a){var s=J0(a.alternate,a,ta);a.memoizedProps=a.pendingProps,s===null?Fu(a):ot=s}function k1(a){var s=a,c=s.alternate;switch(s.tag){case 15:case 0:s=X0(c,s,s.pendingProps,s.type,void 0,ft);break;case 11:s=X0(c,s,s.pendingProps,s.type.render,s.ref,ft);break;case 5:eh(s);default:t1(c,s),s=ot=Cg(s,ta),s=J0(c,s,ta)}a.memoizedProps=a.pendingProps,s===null?Fu(a):ot=s}function Ao(a,s,c,h){Xr=xs=null,eh(s),vo=null,Ml=0;var g=s.return;try{if(D2(a,g,s,c,ft)){nn=1,Du(a,Gi(c,a.current)),ot=null;return}}catch(y){if(g!==null)throw ot=g,y;nn=1,Du(a,Gi(c,a.current)),ot=null;return}s.flags&32768?(St||h===1?a=!0:So||(ft&536870912)!==0?a=!1:(Ma=a=!0,(h===2||h===9||h===3||h===6)&&(h=qi.current,h!==null&&h.tag===13&&(h.flags|=16384))),C1(s,a)):Fu(s)}function Fu(a){var s=a;do{if((s.flags&32768)!==0){C1(s,Ma);return}a=s.return;var c=O2(s.alternate,s,ta);if(c!==null){ot=c;return}if(s=s.sibling,s!==null){ot=s;return}ot=s=a}while(s!==null);nn===0&&(nn=5)}function C1(a,s){do{var c=M2(a.alternate,a);if(c!==null){c.flags&=32767,ot=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(a=a.sibling,a!==null)){ot=a;return}ot=a=c}while(a!==null);nn=6,ot=null}function j1(a,s,c,h,g,y,k,O,G){a.cancelPendingCommit=null;do Uu();while(In!==0);if((Et&6)!==0)throw Error(i(327));if(s!==null){if(s===a.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=jf,zi(a,c,y,k,O,G),a===Ut&&(ot=Ut=null,ft=0),To=s,Ia=a,wo=c,Rh=y,Lh=g,x1=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,G2(ti,function(){return R1(),null})):(a.callbackNode=null,a.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=ie.T,ie.T=null,g=he.p,he.p=2,k=Et,Et|=4;try{R2(a,s,c)}finally{Et=k,he.p=g,ie.T=h}}In=1,D1(),N1(),O1()}}function D1(){if(In===1){In=0;var a=Ia,s=To,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=ie.T,ie.T=null;var h=he.p;he.p=2;var g=Et;Et|=4;try{f1(s,a);var y=Zh,k=yg(a.containerInfo),O=y.focusedElem,G=y.selectionRange;if(k!==O&&O&&O.ownerDocument&&vg(O.ownerDocument.documentElement,O)){if(G!==null&&wf(O)){var oe=G.start,ge=G.end;if(ge===void 0&&(ge=oe),"selectionStart"in O)O.selectionStart=oe,O.selectionEnd=Math.min(ge,O.value.length);else{var ye=O.ownerDocument||document,ce=ye&&ye.defaultView||window;if(ce.getSelection){var fe=ce.getSelection(),Ke=O.textContent.length,$e=Math.min(G.start,Ke),Lt=G.end===void 0?$e:Math.min(G.end,Ke);!fe.extend&&$e>Lt&&(k=Lt,Lt=$e,$e=k);var te=gg(O,$e),Q=gg(O,Lt);if(te&&Q&&(fe.rangeCount!==1||fe.anchorNode!==te.node||fe.anchorOffset!==te.offset||fe.focusNode!==Q.node||fe.focusOffset!==Q.offset)){var re=ye.createRange();re.setStart(te.node,te.offset),fe.removeAllRanges(),$e>Lt?(fe.addRange(re),fe.extend(Q.node,Q.offset)):(re.setEnd(Q.node,Q.offset),fe.addRange(re))}}}}for(ye=[],fe=O;fe=fe.parentNode;)fe.nodeType===1&&ye.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<ye.length;O++){var ve=ye[O];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}Qu=!!Kh,Zh=Kh=null}finally{Et=g,he.p=h,ie.T=c}}a.current=s,In=2}}function N1(){if(In===2){In=0;var a=Ia,s=To,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=ie.T,ie.T=null;var h=he.p;he.p=2;var g=Et;Et|=4;try{l1(a,s.alternate,s)}finally{Et=g,he.p=h,ie.T=c}}In=3}}function O1(){if(In===4||In===3){In=0,gt();var a=Ia,s=To,c=wo,h=x1;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?In=5:(In=0,To=Ia=null,M1(a,a.pendingLanes));var g=a.pendingLanes;if(g===0&&(La=null),ss(c),s=s.stateNode,wt&&typeof wt.onCommitFiberRoot=="function")try{wt.onCommitFiberRoot(Ot,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=ie.T,g=he.p,he.p=2,ie.T=null;try{for(var y=a.onRecoverableError,k=0;k<h.length;k++){var O=h[k];y(O.value,{componentStack:O.stack})}}finally{ie.T=s,he.p=g}}(wo&3)!==0&&Uu(),Cr(a),g=a.pendingLanes,(c&4194090)!==0&&(g&42)!==0?a===Ih?Hl++:(Hl=0,Ih=a):Hl=0,Wl(0)}}function M1(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,_l(s)))}function Uu(a){return D1(),N1(),O1(),R1()}function R1(){if(In!==5)return!1;var a=Ia,s=Rh;Rh=0;var c=ss(wo),h=ie.T,g=he.p;try{he.p=32>c?32:c,ie.T=null,c=Lh,Lh=null;var y=Ia,k=wo;if(In=0,To=Ia=null,wo=0,(Et&6)!==0)throw Error(i(331));var O=Et;if(Et|=4,v1(y.current),m1(y,y.current,k,c),Et=O,Wl(0,!1),wt&&typeof wt.onPostCommitFiberRoot=="function")try{wt.onPostCommitFiberRoot(Ot,y)}catch{}return!0}finally{he.p=g,ie.T=h,M1(a,s)}}function L1(a,s,c){s=Gi(c,s),s=mh(a.stateNode,s,2),a=Aa(a,s,2),a!==null&&(qt(a,2),Cr(a))}function Bt(a,s,c){if(a.tag===3)L1(a,a,c);else for(;s!==null;){if(s.tag===3){L1(s,a,c);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(La===null||!La.has(h))){a=Gi(c,a),c=F0(2),h=Aa(s,c,2),h!==null&&(U0(c,h,s,a),qt(h,2),Cr(h));break}}s=s.return}}function Uh(a,s,c){var h=a.pingCache;if(h===null){h=a.pingCache=new P2;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(c)||(Dh=!0,g.add(c),a=H2.bind(null,a,s,c),s.then(a,a))}function H2(a,s,c){var h=a.pingCache;h!==null&&h.delete(s),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Ut===a&&(ft&c)===c&&(nn===4||nn===3&&(ft&62914560)===ft&&300>Me()-Mh?(Et&2)===0&&Eo(a,0):Nh|=c,_o===ft&&(_o=0)),Cr(a)}function I1(a,s){s===0&&(s=wi()),a=so(a,s),a!==null&&(qt(a,s),Cr(a))}function W2(a){var s=a.memoizedState,c=0;s!==null&&(c=s.retryLane),I1(a,c)}function V2(a,s){var c=0;switch(a.tag){case 13:var h=a.stateNode,g=a.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=a.stateNode;break;case 22:h=a.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(s),I1(a,c)}function G2(a,s){return Ht(a,s)}var zu=null,ko=null,zh=!1,Hu=!1,Hh=!1,As=0;function Cr(a){a!==ko&&a.next===null&&(ko===null?zu=ko=a:ko=ko.next=a),Hu=!0,zh||(zh=!0,X2())}function Wl(a,s){if(!Hh&&Hu){Hh=!0;do for(var c=!1,h=zu;h!==null;){if(a!==0){var g=h.pendingLanes;if(g===0)var y=0;else{var k=h.suspendedLanes,O=h.pingedLanes;y=(1<<31-J(42|a)+1)-1,y&=g&~(k&~O),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,U1(h,y))}else y=ft,y=Yn(h,h===Ut?y:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(y&3)===0||Ui(h,y)||(c=!0,U1(h,y));h=h.next}while(c);Hh=!1}}function Y2(){P1()}function P1(){Hu=zh=!1;var a=0;As!==0&&(tT()&&(a=As),As=0);for(var s=Me(),c=null,h=zu;h!==null;){var g=h.next,y=B1(h,s);y===0?(h.next=null,c===null?zu=g:c.next=g,g===null&&(ko=c)):(c=h,(a!==0||(y&3)!==0)&&(Hu=!0)),h=g}Wl(a)}function B1(a,s){for(var c=a.suspendedLanes,h=a.pingedLanes,g=a.expirationTimes,y=a.pendingLanes&-62914561;0<y;){var k=31-J(y),O=1<<k,G=g[k];G===-1?((O&c)===0||(O&h)!==0)&&(g[k]=ut(O,s)):G<=s&&(a.expiredLanes|=O),y&=~O}if(s=Ut,c=ft,c=Yn(a,a===s?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h=a.callbackNode,c===0||a===s&&(At===2||At===9)||a.cancelPendingCommit!==null)return h!==null&&h!==null&&rt(h),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||Ui(a,c)){if(s=c&-c,s===a.callbackPriority)return s;switch(h!==null&&rt(h),ss(c)){case 2:case 8:c=ei;break;case 32:c=ti;break;case 268435456:c=Fe;break;default:c=ti}return h=F1.bind(null,a),c=Ht(c,h),a.callbackPriority=s,a.callbackNode=c,s}return h!==null&&h!==null&&rt(h),a.callbackPriority=2,a.callbackNode=null,2}function F1(a,s){if(In!==0&&In!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(Uu()&&a.callbackNode!==c)return null;var h=ft;return h=Yn(a,a===Ut?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),h===0?null:(S1(a,h,s),B1(a,Me()),a.callbackNode!=null&&a.callbackNode===c?F1.bind(null,a):null)}function U1(a,s){if(Uu())return null;S1(a,s,!0)}function X2(){iT(function(){(Et&6)!==0?Ht(Mn,Y2):P1()})}function Wh(){return As===0&&(As=ar()),As}function z1(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:or(""+a)}function H1(a,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,a.id&&c.setAttribute("form",a.id),s.parentNode.insertBefore(c,s),a=new FormData(a),c.parentNode.removeChild(c),a}function $2(a,s,c,h,g){if(s==="submit"&&c&&c.stateNode===g){var y=z1((g[en]||null).action),k=h.submitter;k&&(s=(s=k[en]||null)?z1(s.formAction):k.getAttribute("formAction"),s!==null&&(y=s,k=null));var O=new we("action","action",null,h,g);a.push({event:O,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(As!==0){var G=k?H1(g,k):new FormData(g);ch(c,{pending:!0,data:G,method:g.method,action:y},null,G)}}else typeof y=="function"&&(O.preventDefault(),G=k?H1(g,k):new FormData(g),ch(c,{pending:!0,data:G,method:g.method,action:y},y,G))},currentTarget:g}]})}}for(var Vh=0;Vh<Cf.length;Vh++){var Gh=Cf[Vh],q2=Gh.toLowerCase(),K2=Gh[0].toUpperCase()+Gh.slice(1);cr(q2,"on"+K2)}cr(Sg,"onAnimationEnd"),cr(_g,"onAnimationIteration"),cr(Tg,"onAnimationStart"),cr("dblclick","onDoubleClick"),cr("focusin","onFocus"),cr("focusout","onBlur"),cr(h2,"onTransitionRun"),cr(m2,"onTransitionStart"),cr(p2,"onTransitionCancel"),cr(wg,"onTransitionEnd"),Ae("onMouseEnter",["mouseout","mouseover"]),Ae("onMouseLeave",["mouseout","mouseover"]),Ae("onPointerEnter",["pointerout","pointerover"]),Ae("onPointerLeave",["pointerout","pointerover"]),Se("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Se("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Se("onBeforeInput",["compositionend","keypress","textInput","paste"]),Se("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vl));function W1(a,s){s=(s&4)!==0;for(var c=0;c<a.length;c++){var h=a[c],g=h.event;h=h.listeners;e:{var y=void 0;if(s)for(var k=h.length-1;0<=k;k--){var O=h[k],G=O.instance,oe=O.currentTarget;if(O=O.listener,G!==y&&g.isPropagationStopped())break e;y=O,g.currentTarget=oe;try{y(g)}catch(ge){ju(ge)}g.currentTarget=null,y=G}else for(k=0;k<h.length;k++){if(O=h[k],G=O.instance,oe=O.currentTarget,O=O.listener,G!==y&&g.isPropagationStopped())break e;y=O,g.currentTarget=oe;try{y(g)}catch(ge){ju(ge)}g.currentTarget=null,y=G}}}}function lt(a,s){var c=s[os];c===void 0&&(c=s[os]=new Set);var h=a+"__bubble";c.has(h)||(V1(s,a,2,!1),c.add(h))}function Yh(a,s,c){var h=0;s&&(h|=4),V1(c,a,h,s)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function Xh(a){if(!a[Wu]){a[Wu]=!0,le.forEach(function(c){c!=="selectionchange"&&(Z2.has(c)||Yh(c,!1,a),Yh(c,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[Wu]||(s[Wu]=!0,Yh("selectionchange",!1,s))}}function V1(a,s,c,h){switch(mv(s)){case 2:var g=wT;break;case 8:g=ET;break;default:g=om}c=g.bind(null,s,c,a),g=void 0,!eo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?a.addEventListener(s,c,{capture:!0,passive:g}):a.addEventListener(s,c,!0):g!==void 0?a.addEventListener(s,c,{passive:g}):a.addEventListener(s,c,!1)}function $h(a,s,c,h,g){var y=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var k=h.tag;if(k===3||k===4){var O=h.stateNode.containerInfo;if(O===g)break;if(k===4)for(k=h.return;k!==null;){var G=k.tag;if((G===3||G===4)&&k.stateNode.containerInfo===g)return;k=k.return}for(;O!==null;){if(k=F(O),k===null)return;if(G=k.tag,G===5||G===6||G===26||G===27){h=y=k;continue e}O=O.parentNode}}h=h.return}Ai(function(){var oe=y,ge=Js(c),ye=[];e:{var ce=Eg.get(a);if(ce!==void 0){var fe=we,Ke=a;switch(a){case"keypress":if(us(c)===0)break e;case"keydown":case"keyup":fe=G_;break;case"focusin":Ke="focus",fe=to;break;case"focusout":Ke="blur",fe=to;break;case"beforeblur":case"afterblur":fe=to;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=_a;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=En;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=$_;break;case Sg:case _g:case Tg:fe=I_;break;case wg:fe=K_;break;case"scroll":case"scrollend":fe=Ft;break;case"wheel":fe=Q_;break;case"copy":case"cut":case"paste":fe=B_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=ng;break;case"toggle":case"beforetoggle":fe=e2}var $e=(s&4)!==0,Lt=!$e&&(a==="scroll"||a==="scrollend"),te=$e?ce!==null?ce+"Capture":null:ce;$e=[];for(var Q=oe,re;Q!==null;){var ve=Q;if(re=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||re===null||te===null||(ve=Wi(Q,te),ve!=null&&$e.push(Gl(Q,ve,re))),Lt)break;Q=Q.return}0<$e.length&&(ce=new fe(ce,Ke,null,c,ge),ye.push({event:ce,listeners:$e}))}}if((s&7)===0){e:{if(ce=a==="mouseover"||a==="pointerover",fe=a==="mouseout"||a==="pointerout",ce&&c!==ll&&(Ke=c.relatedTarget||c.fromElement)&&(F(Ke)||Ke[br]))break e;if((fe||ce)&&(ce=ge.window===ge?ge:(ce=ge.ownerDocument)?ce.defaultView||ce.parentWindow:window,fe?(Ke=c.relatedTarget||c.toElement,fe=oe,Ke=Ke?F(Ke):null,Ke!==null&&(Lt=o(Ke),$e=Ke.tag,Ke!==Lt||$e!==5&&$e!==27&&$e!==6)&&(Ke=null)):(fe=null,Ke=oe),fe!==Ke)){if($e=_a,ve="onMouseLeave",te="onMouseEnter",Q="mouse",(a==="pointerout"||a==="pointerover")&&($e=ng,ve="onPointerLeave",te="onPointerEnter",Q="pointer"),Lt=fe==null?ce:se(fe),re=Ke==null?ce:se(Ke),ce=new $e(ve,Q+"leave",fe,c,ge),ce.target=Lt,ce.relatedTarget=re,ve=null,F(ge)===oe&&($e=new $e(te,Q+"enter",Ke,c,ge),$e.target=re,$e.relatedTarget=Lt,ve=$e),Lt=ve,fe&&Ke)t:{for($e=fe,te=Ke,Q=0,re=$e;re;re=Co(re))Q++;for(re=0,ve=te;ve;ve=Co(ve))re++;for(;0<Q-re;)$e=Co($e),Q--;for(;0<re-Q;)te=Co(te),re--;for(;Q--;){if($e===te||te!==null&&$e===te.alternate)break t;$e=Co($e),te=Co(te)}$e=null}else $e=null;fe!==null&&G1(ye,ce,fe,$e,!1),Ke!==null&&Lt!==null&&G1(ye,Lt,Ke,$e,!0)}}e:{if(ce=oe?se(oe):window,fe=ce.nodeName&&ce.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ce.type==="file")var ze=ug;else if(lg(ce))if(dg)ze=u2;else{ze=l2;var st=o2}else fe=ce.nodeName,!fe||fe.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?oe&&ol(oe.elementType)&&(ze=ug):ze=c2;if(ze&&(ze=ze(a,oe))){cg(ye,ze,c,ge);break e}st&&st(a,ce,oe),a==="focusout"&&oe&&ce.type==="number"&&oe.memoizedProps.value!=null&&Sr(ce,"number",ce.value)}switch(st=oe?se(oe):window,a){case"focusin":(lg(st)||st.contentEditable==="true")&&(io=st,Ef=oe,vl=null);break;case"focusout":vl=Ef=io=null;break;case"mousedown":Af=!0;break;case"contextmenu":case"mouseup":case"dragend":Af=!1,xg(ye,c,ge);break;case"selectionchange":if(f2)break;case"keydown":case"keyup":xg(ye,c,ge)}var Ve;if(Sf)e:{switch(a){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else no?sg(a,c)&&(qe="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(qe="onCompositionStart");qe&&(ig&&c.locale!=="ko"&&(no||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&no&&(Ve=dl()):(lr=ge,ki="value"in lr?lr.value:lr.textContent,no=!0)),st=Vu(oe,qe),0<st.length&&(qe=new tg(qe,a,null,c,ge),ye.push({event:qe,listeners:st}),Ve?qe.data=Ve:(Ve=og(c),Ve!==null&&(qe.data=Ve)))),(Ve=n2?i2(a,c):r2(a,c))&&(qe=Vu(oe,"onBeforeInput"),0<qe.length&&(st=new tg("onBeforeInput","beforeinput",null,c,ge),ye.push({event:st,listeners:qe}),st.data=Ve)),$2(ye,a,oe,c,ge)}W1(ye,s)})}function Gl(a,s,c){return{instance:a,listener:s,currentTarget:c}}function Vu(a,s){for(var c=s+"Capture",h=[];a!==null;){var g=a,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=Wi(a,c),g!=null&&h.unshift(Gl(a,g,y)),g=Wi(a,s),g!=null&&h.push(Gl(a,g,y))),a.tag===3)return h;a=a.return}return[]}function Co(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function G1(a,s,c,h,g){for(var y=s._reactName,k=[];c!==null&&c!==h;){var O=c,G=O.alternate,oe=O.stateNode;if(O=O.tag,G!==null&&G===h)break;O!==5&&O!==26&&O!==27||oe===null||(G=oe,g?(oe=Wi(c,y),oe!=null&&k.unshift(Gl(c,oe,G))):g||(oe=Wi(c,y),oe!=null&&k.push(Gl(c,oe,G)))),c=c.return}k.length!==0&&a.push({event:s,listeners:k})}var Q2=/\r\n?/g,J2=/\u0000|\uFFFD/g;function Y1(a){return(typeof a=="string"?a:""+a).replace(Q2,`
`).replace(J2,"")}function X1(a,s){return s=Y1(s),Y1(a)===s}function Gu(){}function Rt(a,s,c,h,g,y){switch(c){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||sr(a,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&sr(a,""+h);break;case"className":yt(a,"class",h);break;case"tabIndex":yt(a,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":yt(a,c,h);break;case"style":Sa(a,h,y);break;case"data":if(s!=="object"){yt(a,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||c!=="href")){a.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=or(""+h),a.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(s!=="input"&&Rt(a,s,"name",g.name,g,null),Rt(a,s,"formEncType",g.formEncType,g,null),Rt(a,s,"formMethod",g.formMethod,g,null),Rt(a,s,"formTarget",g.formTarget,g,null)):(Rt(a,s,"encType",g.encType,g,null),Rt(a,s,"method",g.method,g,null),Rt(a,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){a.removeAttribute(c);break}h=or(""+h),a.setAttribute(c,h);break;case"onClick":h!=null&&(a.onclick=Gu);break;case"onScroll":h!=null&&lt("scroll",a);break;case"onScrollEnd":h!=null&&lt("scrollend",a);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));a.innerHTML=c}}break;case"multiple":a.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":a.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){a.removeAttribute("xlink:href");break}c=or(""+h),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""+h):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":h===!0?a.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?a.setAttribute(c,h):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?a.setAttribute(c,h):a.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?a.removeAttribute(c):a.setAttribute(c,h);break;case"popover":lt("beforetoggle",a),lt("toggle",a),vt(a,"popover",h);break;case"xlinkActuate":ht(a,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ht(a,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ht(a,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ht(a,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ht(a,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ht(a,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ht(a,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ht(a,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ht(a,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":vt(a,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=xf.get(c)||c,vt(a,c,h))}}function qh(a,s,c,h,g,y){switch(c){case"style":Sa(a,h,y);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));a.innerHTML=c}}break;case"children":typeof h=="string"?sr(a,h):(typeof h=="number"||typeof h=="bigint")&&sr(a,""+h);break;case"onScroll":h!=null&&lt("scroll",a);break;case"onScrollEnd":h!=null&&lt("scrollend",a);break;case"onClick":h!=null&&(a.onclick=Gu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!de.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),y=a[en]||null,y=y!=null?y[c]:null,typeof y=="function"&&a.removeEventListener(s,y,g),typeof h=="function")){typeof y!="function"&&y!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(s,h,g);break e}c in a?a[c]=h:h===!0?a.setAttribute(c,""):vt(a,c,h)}}}function Pn(a,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lt("error",a),lt("load",a);var h=!1,g=!1,y;for(y in c)if(c.hasOwnProperty(y)){var k=c[y];if(k!=null)switch(y){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Rt(a,s,y,k,c,null)}}g&&Rt(a,s,"srcSet",c.srcSet,c,null),h&&Rt(a,s,"src",c.src,c,null);return;case"input":lt("invalid",a);var O=y=k=g=null,G=null,oe=null;for(h in c)if(c.hasOwnProperty(h)){var ge=c[h];if(ge!=null)switch(h){case"name":g=ge;break;case"type":k=ge;break;case"checked":G=ge;break;case"defaultChecked":oe=ge;break;case"value":y=ge;break;case"defaultValue":O=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,s));break;default:Rt(a,s,h,ge,c,null)}}Hi(a,y,O,G,oe,k,g,!1),ls(a);return;case"select":lt("invalid",a),h=k=y=null;for(g in c)if(c.hasOwnProperty(g)&&(O=c[g],O!=null))switch(g){case"value":y=O;break;case"defaultValue":k=O;break;case"multiple":h=O;default:Rt(a,s,g,O,c,null)}s=y,c=k,a.multiple=!!h,s!=null?_r(a,!!h,s,!1):c!=null&&_r(a,!!h,c,!0);return;case"textarea":lt("invalid",a),y=g=h=null;for(k in c)if(c.hasOwnProperty(k)&&(O=c[k],O!=null))switch(k){case"value":h=O;break;case"defaultValue":g=O;break;case"children":y=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(91));break;default:Rt(a,s,k,O,c,null)}tu(a,h,g,y),ls(a);return;case"option":for(G in c)if(c.hasOwnProperty(G)&&(h=c[G],h!=null))switch(G){case"selected":a.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Rt(a,s,G,h,c,null)}return;case"dialog":lt("beforetoggle",a),lt("toggle",a),lt("cancel",a),lt("close",a);break;case"iframe":case"object":lt("load",a);break;case"video":case"audio":for(h=0;h<Vl.length;h++)lt(Vl[h],a);break;case"image":lt("error",a),lt("load",a);break;case"details":lt("toggle",a);break;case"embed":case"source":case"link":lt("error",a),lt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in c)if(c.hasOwnProperty(oe)&&(h=c[oe],h!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Rt(a,s,oe,h,c,null)}return;default:if(ol(s)){for(ge in c)c.hasOwnProperty(ge)&&(h=c[ge],h!==void 0&&qh(a,s,ge,h,c,void 0));return}}for(O in c)c.hasOwnProperty(O)&&(h=c[O],h!=null&&Rt(a,s,O,h,c,null))}function eT(a,s,c,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,k=null,O=null,G=null,oe=null,ge=null;for(fe in c){var ye=c[fe];if(c.hasOwnProperty(fe)&&ye!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":G=ye;default:h.hasOwnProperty(fe)||Rt(a,s,fe,null,h,ye)}}for(var ce in h){var fe=h[ce];if(ye=c[ce],h.hasOwnProperty(ce)&&(fe!=null||ye!=null))switch(ce){case"type":y=fe;break;case"name":g=fe;break;case"checked":oe=fe;break;case"defaultChecked":ge=fe;break;case"value":k=fe;break;case"defaultValue":O=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,s));break;default:fe!==ye&&Rt(a,s,ce,fe,h,ye)}}ba(a,k,O,G,oe,ge,y,g);return;case"select":fe=k=O=ce=null;for(y in c)if(G=c[y],c.hasOwnProperty(y)&&G!=null)switch(y){case"value":break;case"multiple":fe=G;default:h.hasOwnProperty(y)||Rt(a,s,y,null,h,G)}for(g in h)if(y=h[g],G=c[g],h.hasOwnProperty(g)&&(y!=null||G!=null))switch(g){case"value":ce=y;break;case"defaultValue":O=y;break;case"multiple":k=y;default:y!==G&&Rt(a,s,g,y,h,G)}s=O,c=k,h=fe,ce!=null?_r(a,!!c,ce,!1):!!h!=!!c&&(s!=null?_r(a,!!c,s,!0):_r(a,!!c,c?[]:"",!1));return;case"textarea":fe=ce=null;for(O in c)if(g=c[O],c.hasOwnProperty(O)&&g!=null&&!h.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Rt(a,s,O,null,h,g)}for(k in h)if(g=h[k],y=c[k],h.hasOwnProperty(k)&&(g!=null||y!=null))switch(k){case"value":ce=g;break;case"defaultValue":fe=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&Rt(a,s,k,g,h,y)}Zs(a,ce,fe);return;case"option":for(var Ke in c)if(ce=c[Ke],c.hasOwnProperty(Ke)&&ce!=null&&!h.hasOwnProperty(Ke))switch(Ke){case"selected":a.selected=!1;break;default:Rt(a,s,Ke,null,h,ce)}for(G in h)if(ce=h[G],fe=c[G],h.hasOwnProperty(G)&&ce!==fe&&(ce!=null||fe!=null))switch(G){case"selected":a.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:Rt(a,s,G,ce,h,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $e in c)ce=c[$e],c.hasOwnProperty($e)&&ce!=null&&!h.hasOwnProperty($e)&&Rt(a,s,$e,null,h,ce);for(oe in h)if(ce=h[oe],fe=c[oe],h.hasOwnProperty(oe)&&ce!==fe&&(ce!=null||fe!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,s));break;default:Rt(a,s,oe,ce,h,fe)}return;default:if(ol(s)){for(var Lt in c)ce=c[Lt],c.hasOwnProperty(Lt)&&ce!==void 0&&!h.hasOwnProperty(Lt)&&qh(a,s,Lt,void 0,h,ce);for(ge in h)ce=h[ge],fe=c[ge],!h.hasOwnProperty(ge)||ce===fe||ce===void 0&&fe===void 0||qh(a,s,ge,ce,h,fe);return}}for(var te in c)ce=c[te],c.hasOwnProperty(te)&&ce!=null&&!h.hasOwnProperty(te)&&Rt(a,s,te,null,h,ce);for(ye in h)ce=h[ye],fe=c[ye],!h.hasOwnProperty(ye)||ce===fe||ce==null&&fe==null||Rt(a,s,ye,ce,h,fe)}var Kh=null,Zh=null;function Yu(a){return a.nodeType===9?a:a.ownerDocument}function $1(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function q1(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function Qh(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Jh=null;function tT(){var a=window.event;return a&&a.type==="popstate"?a===Jh?!1:(Jh=a,!0):(Jh=null,!1)}var K1=typeof setTimeout=="function"?setTimeout:void 0,nT=typeof clearTimeout=="function"?clearTimeout:void 0,Z1=typeof Promise=="function"?Promise:void 0,iT=typeof queueMicrotask=="function"?queueMicrotask:typeof Z1<"u"?function(a){return Z1.resolve(null).then(a).catch(rT)}:K1;function rT(a){setTimeout(function(){throw a})}function Ba(a){return a==="head"}function Q1(a,s){var c=s,h=0,g=0;do{var y=c.nextSibling;if(a.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"){if(0<h&&8>h){c=h;var k=a.ownerDocument;if(c&1&&Yl(k.documentElement),c&2&&Yl(k.body),c&4)for(c=k.head,Yl(c),k=c.firstChild;k;){var O=k.nextSibling,G=k.nodeName;k[M]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&k.rel.toLowerCase()==="stylesheet"||c.removeChild(k),k=O}}if(g===0){a.removeChild(y),ec(s);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:h=c.charCodeAt(0)-48;else h=0;c=y}while(c);ec(s)}function em(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":em(c),R(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function aT(a,s,c,h){for(;a.nodeType===1;){var g=c;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(h){if(!a[M])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(y=a.getAttribute("rel"),y==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(y!==g.rel||a.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||a.getAttribute("title")!==(g.title==null?null:g.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(y=a.getAttribute("src"),(y!==(g.src==null?null:g.src)||a.getAttribute("type")!==(g.type==null?null:g.type)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&a.getAttribute("name")===y)return a}else return a;if(a=dr(a.nextSibling),a===null)break}return null}function sT(a,s,c){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=dr(a.nextSibling),a===null))return null;return a}function tm(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function oT(a,s){var c=a.ownerDocument;if(a.data!=="$?"||c.readyState==="complete")s();else{var h=function(){s(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),a._reactRetry=h}}function dr(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return a}var nm=null;function J1(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return a;s--}else c==="/$"&&s++}a=a.previousSibling}return null}function ev(a,s,c){switch(s=Yu(c),a){case"html":if(a=s.documentElement,!a)throw Error(i(452));return a;case"head":if(a=s.head,!a)throw Error(i(453));return a;case"body":if(a=s.body,!a)throw Error(i(454));return a;default:throw Error(i(451))}}function Yl(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);R(a)}var Zi=new Map,tv=new Set;function Xu(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var na=he.d;he.d={f:lT,r:cT,D:uT,C:dT,L:fT,m:hT,X:pT,S:mT,M:gT};function lT(){var a=na.f(),s=Bu();return a||s}function cT(a){var s=B(a);s!==null&&s.tag===5&&s.type==="form"?S0(s):na.r(a)}var jo=typeof document>"u"?null:document;function nv(a,s,c){var h=jo;if(h&&typeof s=="string"&&s){var g=Rn(s);g='link[rel="'+a+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),tv.has(g)||(tv.add(g),a={rel:a,crossOrigin:c,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),Pn(s,"link",a),ee(s),h.head.appendChild(s)))}}function uT(a){na.D(a),nv("dns-prefetch",a,null)}function dT(a,s){na.C(a,s),nv("preconnect",a,s)}function fT(a,s,c){na.L(a,s,c);var h=jo;if(h&&a&&s){var g='link[rel="preload"][as="'+Rn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Rn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Rn(c.imageSizes)+'"]')):g+='[href="'+Rn(a)+'"]';var y=g;switch(s){case"style":y=Do(a);break;case"script":y=No(a)}Zi.has(y)||(a=p({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:a,as:s},c),Zi.set(y,a),h.querySelector(g)!==null||s==="style"&&h.querySelector(Xl(y))||s==="script"&&h.querySelector($l(y))||(s=h.createElement("link"),Pn(s,"link",a),ee(s),h.head.appendChild(s)))}}function hT(a,s){na.m(a,s);var c=jo;if(c&&a){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Rn(h)+'"][href="'+Rn(a)+'"]',y=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=No(a)}if(!Zi.has(y)&&(a=p({rel:"modulepreload",href:a},s),Zi.set(y,a),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector($l(y)))return}h=c.createElement("link"),Pn(h,"link",a),ee(h),c.head.appendChild(h)}}}function mT(a,s,c){na.S(a,s,c);var h=jo;if(h&&a){var g=ue(h).hoistableStyles,y=Do(a);s=s||"default";var k=g.get(y);if(!k){var O={loading:0,preload:null};if(k=h.querySelector(Xl(y)))O.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":s},c),(c=Zi.get(y))&&im(a,c);var G=k=h.createElement("link");ee(G),Pn(G,"link",a),G._p=new Promise(function(oe,ge){G.onload=oe,G.onerror=ge}),G.addEventListener("load",function(){O.loading|=1}),G.addEventListener("error",function(){O.loading|=2}),O.loading|=4,$u(k,s,h)}k={type:"stylesheet",instance:k,count:1,state:O},g.set(y,k)}}}function pT(a,s){na.X(a,s);var c=jo;if(c&&a){var h=ue(c).hoistableScripts,g=No(a),y=h.get(g);y||(y=c.querySelector($l(g)),y||(a=p({src:a,async:!0},s),(s=Zi.get(g))&&rm(a,s),y=c.createElement("script"),ee(y),Pn(y,"link",a),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(g,y))}}function gT(a,s){na.M(a,s);var c=jo;if(c&&a){var h=ue(c).hoistableScripts,g=No(a),y=h.get(g);y||(y=c.querySelector($l(g)),y||(a=p({src:a,async:!0,type:"module"},s),(s=Zi.get(g))&&rm(a,s),y=c.createElement("script"),ee(y),Pn(y,"link",a),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(g,y))}}function iv(a,s,c,h){var g=(g=ae.current)?Xu(g):null;if(!g)throw Error(i(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Do(c.href),c=ue(g).hoistableStyles,h=c.get(s),h||(h={type:"style",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=Do(c.href);var y=ue(g).hoistableStyles,k=y.get(a);if(k||(g=g.ownerDocument||g,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(a,k),(y=g.querySelector(Xl(a)))&&!y._p&&(k.instance=y,k.state.loading=5),Zi.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Zi.set(a,c),y||vT(g,a,c,k.state))),s&&h===null)throw Error(i(528,""));return k}if(s&&h!==null)throw Error(i(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=No(c),c=ue(g).hoistableScripts,h=c.get(s),h||(h={type:"script",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,a))}}function Do(a){return'href="'+Rn(a)+'"'}function Xl(a){return'link[rel="stylesheet"]['+a+"]"}function rv(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function vT(a,s,c,h){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=a.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Pn(s,"link",c),ee(s),a.head.appendChild(s))}function No(a){return'[src="'+Rn(a)+'"]'}function $l(a){return"script[async]"+a}function av(a,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var h=a.querySelector('style[data-href~="'+Rn(c.href)+'"]');if(h)return s.instance=h,ee(h),h;var g=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(a.ownerDocument||a).createElement("style"),ee(h),Pn(h,"style",g),$u(h,c.precedence,a),s.instance=h;case"stylesheet":g=Do(c.href);var y=a.querySelector(Xl(g));if(y)return s.state.loading|=4,s.instance=y,ee(y),y;h=rv(c),(g=Zi.get(g))&&im(h,g),y=(a.ownerDocument||a).createElement("link"),ee(y);var k=y;return k._p=new Promise(function(O,G){k.onload=O,k.onerror=G}),Pn(y,"link",h),s.state.loading|=4,$u(y,c.precedence,a),s.instance=y;case"script":return y=No(c.src),(g=a.querySelector($l(y)))?(s.instance=g,ee(g),g):(h=c,(g=Zi.get(y))&&(h=p({},c),rm(h,g)),a=a.ownerDocument||a,g=a.createElement("script"),ee(g),Pn(g,"link",h),a.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,$u(h,c.precedence,a));return s.instance}function $u(a,s,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,y=g,k=0;k<h.length;k++){var O=h[k];if(O.dataset.precedence===s)y=O;else if(y!==g)break}y?y.parentNode.insertBefore(a,y.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(a,s.firstChild))}function im(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function rm(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var qu=null;function sv(a,s,c){if(qu===null){var h=new Map,g=qu=new Map;g.set(c,h)}else g=qu,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(a))return h;for(h.set(a,null),c=c.getElementsByTagName(a),g=0;g<c.length;g++){var y=c[g];if(!(y[M]||y[Jt]||a==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var k=y.getAttribute(s)||"";k=a+k;var O=h.get(k);O?O.push(y):h.set(k,[y])}}return h}function ov(a,s,c){a=a.ownerDocument||a,a.head.insertBefore(c,s==="title"?a.querySelector("head > title"):null)}function yT(a,s,c){if(c===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function lv(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var ql=null;function xT(){}function bT(a,s,c){if(ql===null)throw Error(i(475));var h=ql;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var g=Do(c.href),y=a.querySelector(Xl(g));if(y){a=y._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(h.count++,h=Ku.bind(h),a.then(h,h)),s.state.loading|=4,s.instance=y,ee(y);return}y=a.ownerDocument||a,c=rv(c),(g=Zi.get(g))&&im(c,g),y=y.createElement("link"),ee(y);var k=y;k._p=new Promise(function(O,G){k.onload=O,k.onerror=G}),Pn(y,"link",c),s.instance=y}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(h.count++,s=Ku.bind(h),a.addEventListener("load",s),a.addEventListener("error",s))}}function ST(){if(ql===null)throw Error(i(475));var a=ql;return a.stylesheets&&a.count===0&&am(a,a.stylesheets),0<a.count?function(s){var c=setTimeout(function(){if(a.stylesheets&&am(a,a.stylesheets),a.unsuspend){var h=a.unsuspend;a.unsuspend=null,h()}},6e4);return a.unsuspend=s,function(){a.unsuspend=null,clearTimeout(c)}}:null}function Ku(){if(this.count--,this.count===0){if(this.stylesheets)am(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Zu=null;function am(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Zu=new Map,s.forEach(_T,a),Zu=null,Ku.call(a))}function _T(a,s){if(!(s.state.loading&4)){var c=Zu.get(a);if(c)var h=c.get(null);else{c=new Map,Zu.set(a,c);for(var g=a.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var k=g[y];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),h=k)}h&&c.set(null,h)}g=s.instance,k=g.getAttribute("data-precedence"),y=c.get(k)||h,y===h&&c.set(null,g),c.set(k,g),this.count++,h=Ku.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),y?y.parentNode.insertBefore(g,y.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(g,a.firstChild)),s.state.loading|=4}}var Kl={$$typeof:C,Provider:null,Consumer:null,_currentValue:Ne,_currentValue2:Ne,_threadCount:0};function TT(a,s,c,h,g,y,k,O){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xr(0),this.hiddenUpdates=xr(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function cv(a,s,c,h,g,y,k,O,G,oe,ge,ye){return a=new TT(a,s,c,k,O,G,oe,ye),s=1,y===!0&&(s|=24),y=ji(3,null,null,s),a.current=y,y.stateNode=a,s=Uf(),s.refCount++,a.pooledCache=s,s.refCount++,y.memoizedState={element:h,isDehydrated:c,cache:s},Vf(y),a}function uv(a){return a?(a=oo,a):oo}function dv(a,s,c,h,g,y){g=uv(g),h.context===null?h.context=g:h.pendingContext=g,h=Ea(s),h.payload={element:c},y=y===void 0?null:y,y!==null&&(h.callback=y),c=Aa(a,h,s),c!==null&&(Ri(c,a,s),Al(c,a,s))}function fv(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<s?c:s}}function sm(a,s){fv(a,s),(a=a.alternate)&&fv(a,s)}function hv(a){if(a.tag===13){var s=so(a,67108864);s!==null&&Ri(s,a,67108864),sm(a,67108864)}}var Qu=!0;function wT(a,s,c,h){var g=ie.T;ie.T=null;var y=he.p;try{he.p=2,om(a,s,c,h)}finally{he.p=y,ie.T=g}}function ET(a,s,c,h){var g=ie.T;ie.T=null;var y=he.p;try{he.p=8,om(a,s,c,h)}finally{he.p=y,ie.T=g}}function om(a,s,c,h){if(Qu){var g=lm(h);if(g===null)$h(a,s,h,Ju,c),pv(a,h);else if(kT(g,a,s,c,h))h.stopPropagation();else if(pv(a,h),s&4&&-1<AT.indexOf(a)){for(;g!==null;){var y=B(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var k=$t(y.pendingLanes);if(k!==0){var O=y;for(O.pendingLanes|=2,O.entangledLanes|=2;k;){var G=1<<31-J(k);O.entanglements[1]|=G,k&=~G}Cr(y),(Et&6)===0&&(Iu=Me()+500,Wl(0))}}break;case 13:O=so(y,2),O!==null&&Ri(O,y,2),Bu(),sm(y,2)}if(y=lm(h),y===null&&$h(a,s,h,Ju,c),y===g)break;g=y}g!==null&&h.stopPropagation()}else $h(a,s,h,null,c)}}function lm(a){return a=Js(a),cm(a)}var Ju=null;function cm(a){if(Ju=null,a=F(a),a!==null){var s=o(a);if(s===null)a=null;else{var c=s.tag;if(c===13){if(a=l(s),a!==null)return a;a=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return Ju=a,null}function mv(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wn()){case Mn:return 2;case ei:return 8;case ti:case Qe:return 32;case Fe:return 268435456;default:return 32}default:return 32}}var um=!1,Fa=null,Ua=null,za=null,Zl=new Map,Ql=new Map,Ha=[],AT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pv(a,s){switch(a){case"focusin":case"focusout":Fa=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":za=null;break;case"pointerover":case"pointerout":Zl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ql.delete(s.pointerId)}}function Jl(a,s,c,h,g,y){return a===null||a.nativeEvent!==y?(a={blockedOn:s,domEventName:c,eventSystemFlags:h,nativeEvent:y,targetContainers:[g]},s!==null&&(s=B(s),s!==null&&hv(s)),a):(a.eventSystemFlags|=h,s=a.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),a)}function kT(a,s,c,h,g){switch(s){case"focusin":return Fa=Jl(Fa,a,s,c,h,g),!0;case"dragenter":return Ua=Jl(Ua,a,s,c,h,g),!0;case"mouseover":return za=Jl(za,a,s,c,h,g),!0;case"pointerover":var y=g.pointerId;return Zl.set(y,Jl(Zl.get(y)||null,a,s,c,h,g)),!0;case"gotpointercapture":return y=g.pointerId,Ql.set(y,Jl(Ql.get(y)||null,a,s,c,h,g)),!0}return!1}function gv(a){var s=F(a.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){a.blockedOn=s,yn(a.priority,function(){if(c.tag===13){var h=Mi();h=as(h);var g=so(c,h);g!==null&&Ri(g,c,h),sm(c,h)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function ed(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var c=lm(a.nativeEvent);if(c===null){c=a.nativeEvent;var h=new c.constructor(c.type,c);ll=h,c.target.dispatchEvent(h),ll=null}else return s=B(c),s!==null&&hv(s),a.blockedOn=c,!1;s.shift()}return!0}function vv(a,s,c){ed(a)&&c.delete(s)}function CT(){um=!1,Fa!==null&&ed(Fa)&&(Fa=null),Ua!==null&&ed(Ua)&&(Ua=null),za!==null&&ed(za)&&(za=null),Zl.forEach(vv),Ql.forEach(vv)}function td(a,s){a.blockedOn===s&&(a.blockedOn=null,um||(um=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,CT)))}var nd=null;function yv(a){nd!==a&&(nd=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){nd===a&&(nd=null);for(var s=0;s<a.length;s+=3){var c=a[s],h=a[s+1],g=a[s+2];if(typeof h!="function"){if(cm(h||c)===null)continue;break}var y=B(c);y!==null&&(a.splice(s,3),s-=3,ch(y,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function ec(a){function s(G){return td(G,a)}Fa!==null&&td(Fa,a),Ua!==null&&td(Ua,a),za!==null&&td(za,a),Zl.forEach(s),Ql.forEach(s);for(var c=0;c<Ha.length;c++){var h=Ha[c];h.blockedOn===a&&(h.blockedOn=null)}for(;0<Ha.length&&(c=Ha[0],c.blockedOn===null);)gv(c),c.blockedOn===null&&Ha.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],y=c[h+1],k=g[en]||null;if(typeof y=="function")k||yv(c);else if(k){var O=null;if(y&&y.hasAttribute("formAction")){if(g=y,k=y[en]||null)O=k.formAction;else if(cm(g)!==null)continue}else O=k.action;typeof O=="function"?c[h+1]=O:(c.splice(h,3),h-=3),yv(c)}}}function dm(a){this._internalRoot=a}id.prototype.render=dm.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(i(409));var c=s.current,h=Mi();dv(c,h,a,s,null,null)},id.prototype.unmount=dm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;dv(a.current,2,null,a,null,null),Bu(),s[br]=null}};function id(a){this._internalRoot=a}id.prototype.unstable_scheduleHydration=function(a){if(a){var s=Ks();a={blockedOn:null,target:a,priority:s};for(var c=0;c<Ha.length&&s!==0&&s<Ha[c].priority;c++);Ha.splice(c,0,a),c===0&&gv(a)}};var xv=e.version;if(xv!=="19.1.0")throw Error(i(527,xv,"19.1.0"));he.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(i(188)):(a=Object.keys(a).join(","),Error(i(268,a)));return a=f(s),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var jT={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{Ot=rd.inject(jT),wt=rd}catch{}}return nc.createRoot=function(a,s){if(!r(a))throw Error(i(299));var c=!1,h="",g=L0,y=I0,k=P0,O=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(k=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(O=s.unstable_transitionCallbacks)),s=cv(a,1,!1,null,null,c,h,g,y,k,O,null),a[br]=s.current,Xh(a),new dm(s)},nc.hydrateRoot=function(a,s,c){if(!r(a))throw Error(i(299));var h=!1,g="",y=L0,k=I0,O=P0,G=null,oe=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(O=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(G=c.unstable_transitionCallbacks),c.formState!==void 0&&(oe=c.formState)),s=cv(a,1,!0,s,c??null,h,g,y,k,O,G,oe),s.context=uv(null),c=s.current,h=Mi(),h=as(h),g=Ea(h),g.callback=null,Aa(c,g,h),c=h,s.current.lanes=c,qt(s,c),Cr(s),a[br]=s.current,Xh(a),new id(s)},nc.version="19.1.0",nc}var jv;function FT(){if(jv)return mm.exports;jv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),mm.exports=BT(),mm.exports}var UT=FT();const zT=sp(UT);/**
 * react-router v7.7.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Dv="popstate";function HT(n={}){function e(i,r){let{pathname:o,search:l,hash:u}=i.location;return Vm("",{pathname:o,search:l,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:kc(r)}return VT(e,t,null,n)}function Xt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ir(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function WT(){return Math.random().toString(36).substring(2,10)}function Nv(n,e){return{usr:n.state,key:n.key,idx:e}}function Vm(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Ko(e):e,state:t,key:e&&e.key||i||WT()}}function kc({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Ko(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function VT(n,e,t,i={}){let{window:r=document.defaultView,v5Compat:o=!1}=i,l=r.history,u="POP",f=null,m=p();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function p(){return(l.state||{idx:null}).idx}function v(){u="POP";let T=p(),w=T==null?null:T-m;m=T,f&&f({action:u,location:b.location,delta:w})}function x(T,w){u="PUSH";let A=Vm(b.location,T,w);m=p()+1;let C=Nv(A,m),N=b.createHref(A);try{l.pushState(C,"",N)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;r.location.assign(N)}o&&f&&f({action:u,location:b.location,delta:1})}function S(T,w){u="REPLACE";let A=Vm(b.location,T,w);m=p();let C=Nv(A,m),N=b.createHref(A);l.replaceState(C,"",N),o&&f&&f({action:u,location:b.location,delta:0})}function _(T){return GT(T)}let b={get action(){return u},get location(){return n(r,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(Dv,v),f=T,()=>{r.removeEventListener(Dv,v),f=null}},createHref(T){return e(r,T)},createURL:_,encodeLocation(T){let w=_(T);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:x,replace:S,go(T){return l.go(T)}};return b}function GT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Xt(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:kc(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function Yx(n,e,t="/"){return YT(n,e,t,!1)}function YT(n,e,t,i){let r=typeof e=="string"?Ko(e):e,o=fa(r.pathname||"/",t);if(o==null)return null;let l=Xx(n);XT(l);let u=null;for(let f=0;u==null&&f<l.length;++f){let m=rw(o);u=nw(l[f],m,i)}return u}function Xx(n,e=[],t=[],i=""){let r=(o,l,u)=>{let f={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(Xt(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length));let m=la([i,f.relativePath]),p=t.concat(f);o.children&&o.children.length>0&&(Xt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Xx(o.children,e,p,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:ew(m,o.index),routesMeta:p})};return n.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))r(o,l);else for(let u of $x(o.path))r(o,l,u)}),e}function $x(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return r?[o,""]:[o];let l=$x(i.join("/")),u=[];return u.push(...l.map(f=>f===""?o:[o,f].join("/"))),r&&u.push(...l),u.map(f=>n.startsWith("/")&&f===""?"/":f)}function XT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:tw(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var $T=/^:[\w-]+$/,qT=3,KT=2,ZT=1,QT=10,JT=-2,Ov=n=>n==="*";function ew(n,e){let t=n.split("/"),i=t.length;return t.some(Ov)&&(i+=JT),e&&(i+=KT),t.filter(r=>!Ov(r)).reduce((r,o)=>r+($T.test(o)?qT:o===""?ZT:QT),i)}function tw(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function nw(n,e,t=!1){let{routesMeta:i}=n,r={},o="/",l=[];for(let u=0;u<i.length;++u){let f=i[u],m=u===i.length-1,p=o==="/"?e:e.slice(o.length)||"/",v=Rd({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},p),x=f.route;if(!v&&m&&t&&!i[i.length-1].route.index&&(v=Rd({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!v)return null;Object.assign(r,v.params),l.push({params:r,pathname:la([o,v.pathname]),pathnameBase:lw(la([o,v.pathnameBase])),route:x}),v.pathnameBase!=="/"&&(o=la([o,v.pathnameBase]))}return l}function Rd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=iw(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let o=r[0],l=o.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:i.reduce((m,{paramName:p,isOptional:v},x)=>{if(p==="*"){let _=u[x]||"";l=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const S=u[x];return v&&!S?m[p]=void 0:m[p]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:n}}function iw(n,e=!1,t=!0){ir(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,f)=>(i.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function rw(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ir(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function fa(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function aw(n,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?Ko(n):n;return{pathname:t?t.startsWith("/")?t:sw(t,e):e,search:cw(i),hash:uw(r)}}function sw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function ym(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ow(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function lp(n){let e=ow(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function cp(n,e,t,i=!1){let r;typeof n=="string"?r=Ko(n):(r={...n},Xt(!r.pathname||!r.pathname.includes("?"),ym("?","pathname","search",r)),Xt(!r.pathname||!r.pathname.includes("#"),ym("#","pathname","hash",r)),Xt(!r.search||!r.search.includes("#"),ym("#","search","hash",r)));let o=n===""||r.pathname==="",l=o?"/":r.pathname,u;if(l==null)u=t;else{let v=e.length-1;if(!i&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),v-=1;r.pathname=x.join("/")}u=v>=0?e[v]:"/"}let f=aw(r,u),m=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(m||p)&&(f.pathname+="/"),f}var la=n=>n.join("/").replace(/\/\/+/g,"/"),lw=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),cw=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,uw=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function dw(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var qx=["POST","PUT","PATCH","DELETE"];new Set(qx);var fw=["GET",...qx];new Set(fw);var Zo=W.createContext(null);Zo.displayName="DataRouter";var rf=W.createContext(null);rf.displayName="DataRouterState";W.createContext(!1);var Kx=W.createContext({isTransitioning:!1});Kx.displayName="ViewTransition";var hw=W.createContext(new Map);hw.displayName="Fetchers";var mw=W.createContext(null);mw.displayName="Await";var yr=W.createContext(null);yr.displayName="Navigation";var Hc=W.createContext(null);Hc.displayName="Location";var Br=W.createContext({outlet:null,matches:[],isDataRoute:!1});Br.displayName="Route";var up=W.createContext(null);up.displayName="RouteError";function pw(n,{relative:e}={}){Xt(Qo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=W.useContext(yr),{hash:r,pathname:o,search:l}=Wc(n,{relative:e}),u=o;return t!=="/"&&(u=o==="/"?t:la([t,o])),i.createHref({pathname:u,search:l,hash:r})}function Qo(){return W.useContext(Hc)!=null}function Fr(){return Xt(Qo(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(Hc).location}var Zx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Qx(n){W.useContext(yr).static||W.useLayoutEffect(n)}function Jo(){let{isDataRoute:n}=W.useContext(Br);return n?Cw():gw()}function gw(){Xt(Qo(),"useNavigate() may be used only in the context of a <Router> component.");let n=W.useContext(Zo),{basename:e,navigator:t}=W.useContext(yr),{matches:i}=W.useContext(Br),{pathname:r}=Fr(),o=JSON.stringify(lp(i)),l=W.useRef(!1);return Qx(()=>{l.current=!0}),W.useCallback((f,m={})=>{if(ir(l.current,Zx),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=cp(f,JSON.parse(o),r,m.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:la([e,p.pathname])),(m.replace?t.replace:t.push)(p,m.state,m)},[e,t,o,r,n])}W.createContext(null);function Wc(n,{relative:e}={}){let{matches:t}=W.useContext(Br),{pathname:i}=Fr(),r=JSON.stringify(lp(t));return W.useMemo(()=>cp(n,JSON.parse(r),i,e==="path"),[n,r,i,e])}function vw(n,e){return Jx(n,e)}function Jx(n,e,t,i){Xt(Qo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=W.useContext(yr),{matches:o}=W.useContext(Br),l=o[o.length-1],u=l?l.params:{},f=l?l.pathname:"/",m=l?l.pathnameBase:"/",p=l&&l.route;{let w=p&&p.path||"";eb(f,!p||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let v=Fr(),x;if(e){let w=typeof e=="string"?Ko(e):e;Xt(m==="/"||w.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${w.pathname}" was given in the \`location\` prop.`),x=w}else x=v;let S=x.pathname||"/",_=S;if(m!=="/"){let w=m.replace(/^\//,"").split("/");_="/"+S.replace(/^\//,"").split("/").slice(w.length).join("/")}let b=Yx(n,{pathname:_});ir(p||b!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),ir(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=_w(b&&b.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:la([m,r.encodeLocation?r.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?m:la([m,r.encodeLocation?r.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,t,i);return e&&T?W.createElement(Hc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},T):T}function yw(){let n=kw(),e=dw(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=W.createElement(W.Fragment,null,W.createElement("p",null,"💿 Hey developer 👋"),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:o},"ErrorBoundary")," or"," ",W.createElement("code",{style:o},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},e),t?W.createElement("pre",{style:r},t):null,l)}var xw=W.createElement(yw,null),bw=class extends W.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?W.createElement(Br.Provider,{value:this.props.routeContext},W.createElement(up.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Sw({routeContext:n,match:e,children:t}){let i=W.useContext(Zo);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),W.createElement(Br.Provider,{value:n},t)}function _w(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let r=n,o=t?.errors;if(o!=null){let f=r.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);Xt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),r=r.slice(0,Math.min(r.length,f+1))}let l=!1,u=-1;if(t)for(let f=0;f<r.length;f++){let m=r[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:p,errors:v}=t,x=m.route.loader&&!p.hasOwnProperty(m.route.id)&&(!v||v[m.route.id]===void 0);if(m.route.lazy||x){l=!0,u>=0?r=r.slice(0,u+1):r=[r[0]];break}}}return r.reduceRight((f,m,p)=>{let v,x=!1,S=null,_=null;t&&(v=o&&m.route.id?o[m.route.id]:void 0,S=m.route.errorElement||xw,l&&(u<0&&p===0?(eb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,_=null):u===p&&(x=!0,_=m.route.hydrateFallbackElement||null)));let b=e.concat(r.slice(0,p+1)),T=()=>{let w;return v?w=S:x?w=_:m.route.Component?w=W.createElement(m.route.Component,null):m.route.element?w=m.route.element:w=f,W.createElement(Sw,{match:m,routeContext:{outlet:f,matches:b,isDataRoute:t!=null},children:w})};return t&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?W.createElement(bw,{location:t.location,revalidation:t.revalidation,component:S,error:v,children:T(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):T()},null)}function dp(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Tw(n){let e=W.useContext(Zo);return Xt(e,dp(n)),e}function ww(n){let e=W.useContext(rf);return Xt(e,dp(n)),e}function Ew(n){let e=W.useContext(Br);return Xt(e,dp(n)),e}function fp(n){let e=Ew(n),t=e.matches[e.matches.length-1];return Xt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Aw(){return fp("useRouteId")}function kw(){let n=W.useContext(up),e=ww("useRouteError"),t=fp("useRouteError");return n!==void 0?n:e.errors?.[t]}function Cw(){let{router:n}=Tw("useNavigate"),e=fp("useNavigate"),t=W.useRef(!1);return Qx(()=>{t.current=!0}),W.useCallback(async(r,o={})=>{ir(t.current,Zx),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...o}))},[n,e])}var Mv={};function eb(n,e,t){!e&&!Mv[n]&&(Mv[n]=!0,ir(!1,t))}W.memo(jw);function jw({routes:n,future:e,state:t}){return Jx(n,void 0,t,e)}function tb({to:n,replace:e,state:t,relative:i}){Xt(Qo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=W.useContext(yr);ir(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=W.useContext(Br),{pathname:l}=Fr(),u=Jo(),f=cp(n,lp(o),l,i==="path"),m=JSON.stringify(f);return W.useEffect(()=>{u(JSON.parse(m),{replace:e,state:t,relative:i})},[u,m,i,e,t]),null}function jn(n){Xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Dw({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:o=!1}){Xt(!Qo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=W.useMemo(()=>({basename:l,navigator:r,static:o,future:{}}),[l,r,o]);typeof t=="string"&&(t=Ko(t));let{pathname:f="/",search:m="",hash:p="",state:v=null,key:x="default"}=t,S=W.useMemo(()=>{let _=fa(f,l);return _==null?null:{location:{pathname:_,search:m,hash:p,state:v,key:x},navigationType:i}},[l,f,m,p,v,x,i]);return ir(S!=null,`<Router basename="${l}"> is not able to match the URL "${f}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:W.createElement(yr.Provider,{value:u},W.createElement(Hc.Provider,{children:e,value:S}))}function Nw({children:n,location:e}){return vw(Gm(n),e)}function Gm(n,e=[]){let t=[];return W.Children.forEach(n,(i,r)=>{if(!W.isValidElement(i))return;let o=[...e,r];if(i.type===W.Fragment){t.push.apply(t,Gm(i.props.children,o));return}Xt(i.type===jn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=Gm(i.props.children,o)),t.push(l)}),t}var Dd="get",Nd="application/x-www-form-urlencoded";function af(n){return n!=null&&typeof n.tagName=="string"}function Ow(n){return af(n)&&n.tagName.toLowerCase()==="button"}function Mw(n){return af(n)&&n.tagName.toLowerCase()==="form"}function Rw(n){return af(n)&&n.tagName.toLowerCase()==="input"}function Lw(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Iw(n,e){return n.button===0&&(!e||e==="_self")&&!Lw(n)}function Ym(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(r=>[t,r]):[[t,i]])},[]))}function Pw(n,e){let t=Ym(n);return e&&e.forEach((i,r)=>{t.has(r)||e.getAll(r).forEach(o=>{t.append(r,o)})}),t}var ad=null;function Bw(){if(ad===null)try{new FormData(document.createElement("form"),0),ad=!1}catch{ad=!0}return ad}var Fw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xm(n){return n!=null&&!Fw.has(n)?(ir(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Nd}"`),null):n}function Uw(n,e){let t,i,r,o,l;if(Mw(n)){let u=n.getAttribute("action");i=u?fa(u,e):null,t=n.getAttribute("method")||Dd,r=xm(n.getAttribute("enctype"))||Nd,o=new FormData(n)}else if(Ow(n)||Rw(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||u.getAttribute("action");if(i=f?fa(f,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||Dd,r=xm(n.getAttribute("formenctype"))||xm(u.getAttribute("enctype"))||Nd,o=new FormData(u,n),!Bw()){let{name:m,type:p,value:v}=n;if(p==="image"){let x=m?`${m}.`:"";o.append(`${x}x`,"0"),o.append(`${x}y`,"0")}else m&&o.append(m,v)}}else{if(af(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Dd,i=null,r=Nd,l=n}return o&&r==="text/plain"&&(l=o,o=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function hp(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function zw(n,e,t){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return i.pathname==="/"?i.pathname=`_root.${t}`:e&&fa(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${t}`,i}async function Hw(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ww(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Vw(n,e,t){let i=await Promise.all(n.map(async r=>{let o=e.routes[r.route.id];if(o){let l=await Hw(o,t);return l.links?l.links():[]}return[]}));return $w(i.flat(1).filter(Ww).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function Rv(n,e,t,i,r,o){let l=(f,m)=>t[m]?f.route.id!==t[m].route.id:!0,u=(f,m)=>t[m].pathname!==f.pathname||t[m].route.path?.endsWith("*")&&t[m].params["*"]!==f.params["*"];return o==="assets"?e.filter((f,m)=>l(f,m)||u(f,m)):o==="data"?e.filter((f,m)=>{let p=i.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,m)||u(f,m))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Gw(n,e,{includeHydrateFallback:t}={}){return Yw(n.map(i=>{let r=e.routes[i.route.id];if(!r)return[];let o=[r.module];return r.clientActionModule&&(o=o.concat(r.clientActionModule)),r.clientLoaderModule&&(o=o.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(o=o.concat(r.hydrateFallbackModule)),r.imports&&(o=o.concat(r.imports)),o}).flat(1))}function Yw(n){return[...new Set(n)]}function Xw(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function $w(n,e){let t=new Set;return new Set(e),n.reduce((i,r)=>{let o=JSON.stringify(Xw(r));return t.has(o)||(t.add(o),i.push({key:o,link:r})),i},[])}function nb(){let n=W.useContext(Zo);return hp(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function qw(){let n=W.useContext(rf);return hp(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var mp=W.createContext(void 0);mp.displayName="FrameworkContext";function ib(){let n=W.useContext(mp);return hp(n,"You must render this element inside a <HydratedRouter> element"),n}function Kw(n,e){let t=W.useContext(mp),[i,r]=W.useState(!1),[o,l]=W.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:m,onMouseLeave:p,onTouchStart:v}=e,x=W.useRef(null);W.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let b=w=>{w.forEach(A=>{l(A.isIntersecting)})},T=new IntersectionObserver(b,{threshold:.5});return x.current&&T.observe(x.current),()=>{T.disconnect()}}},[n]),W.useEffect(()=>{if(i){let b=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(b)}}},[i]);let S=()=>{r(!0)},_=()=>{r(!1),l(!1)};return t?n!=="intent"?[o,x,{}]:[o,x,{onFocus:ic(u,S),onBlur:ic(f,_),onMouseEnter:ic(m,S),onMouseLeave:ic(p,_),onTouchStart:ic(v,S)}]:[!1,x,{}]}function ic(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Zw({page:n,...e}){let{router:t}=nb(),i=W.useMemo(()=>Yx(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?W.createElement(Jw,{page:n,matches:i,...e}):null}function Qw(n){let{manifest:e,routeModules:t}=ib(),[i,r]=W.useState([]);return W.useEffect(()=>{let o=!1;return Vw(n,e,t).then(l=>{o||r(l)}),()=>{o=!0}},[n,e,t]),i}function Jw({page:n,matches:e,...t}){let i=Fr(),{manifest:r,routeModules:o}=ib(),{basename:l}=nb(),{loaderData:u,matches:f}=qw(),m=W.useMemo(()=>Rv(n,e,f,r,i,"data"),[n,e,f,r,i]),p=W.useMemo(()=>Rv(n,e,f,r,i,"assets"),[n,e,f,r,i]),v=W.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let _=new Set,b=!1;if(e.forEach(w=>{let A=r.routes[w.route.id];!A||!A.hasLoader||(!m.some(C=>C.route.id===w.route.id)&&w.route.id in u&&o[w.route.id]?.shouldRevalidate||A.hasClientLoader?b=!0:_.add(w.route.id))}),_.size===0)return[];let T=zw(n,l,"data");return b&&_.size>0&&T.searchParams.set("_routes",e.filter(w=>_.has(w.route.id)).map(w=>w.route.id).join(",")),[T.pathname+T.search]},[l,u,i,r,m,e,n,o]),x=W.useMemo(()=>Gw(p,r),[p,r]),S=Qw(p);return W.createElement(W.Fragment,null,v.map(_=>W.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...t})),x.map(_=>W.createElement("link",{key:_,rel:"modulepreload",href:_,...t})),S.map(({key:_,link:b})=>W.createElement("link",{key:_,...b})))}function eE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var rb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{rb&&(window.__reactRouterVersion="7.7.0")}catch{}function tE({basename:n,children:e,window:t}){let i=W.useRef();i.current==null&&(i.current=HT({window:t,v5Compat:!0}));let r=i.current,[o,l]=W.useState({action:r.action,location:r.location}),u=W.useCallback(f=>{W.startTransition(()=>l(f))},[l]);return W.useLayoutEffect(()=>r.listen(u),[r,u]),W.createElement(Dw,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:r})}var ab=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sb=W.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:o,replace:l,state:u,target:f,to:m,preventScrollReset:p,viewTransition:v,...x},S){let{basename:_}=W.useContext(yr),b=typeof m=="string"&&ab.test(m),T,w=!1;if(typeof m=="string"&&b&&(T=m,rb))try{let L=new URL(window.location.href),H=m.startsWith("//")?new URL(L.protocol+m):new URL(m),K=fa(H.pathname,_);H.origin===L.origin&&K!=null?m=K+H.search+H.hash:w=!0}catch{ir(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=pw(m,{relative:r}),[C,N,E]=Kw(i,x),I=aE(m,{replace:l,state:u,target:f,preventScrollReset:p,relative:r,viewTransition:v});function D(L){e&&e(L),L.defaultPrevented||I(L)}let z=W.createElement("a",{...x,...E,href:T||A,onClick:w||o?e:D,ref:eE(S,N),target:f,"data-discover":!b&&t==="render"?"true":void 0});return C&&!b?W.createElement(W.Fragment,null,z,W.createElement(Zw,{page:A})):z});sb.displayName="Link";var nE=W.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:o,to:l,viewTransition:u,children:f,...m},p){let v=Wc(l,{relative:m.relative}),x=Fr(),S=W.useContext(rf),{navigator:_,basename:b}=W.useContext(yr),T=S!=null&&dE(v)&&u===!0,w=_.encodeLocation?_.encodeLocation(v).pathname:v.pathname,A=x.pathname,C=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(A=A.toLowerCase(),C=C?C.toLowerCase():null,w=w.toLowerCase()),C&&b&&(C=fa(C,b)||C);const N=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let E=A===w||!r&&A.startsWith(w)&&A.charAt(N)==="/",I=C!=null&&(C===w||!r&&C.startsWith(w)&&C.charAt(w.length)==="/"),D={isActive:E,isPending:I,isTransitioning:T},z=E?e:void 0,L;typeof i=="function"?L=i(D):L=[i,E?"active":null,I?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let H=typeof o=="function"?o(D):o;return W.createElement(sb,{...m,"aria-current":z,className:L,ref:p,style:H,to:l,viewTransition:u},typeof f=="function"?f(D):f)});nE.displayName="NavLink";var iE=W.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:o,method:l=Dd,action:u,onSubmit:f,relative:m,preventScrollReset:p,viewTransition:v,...x},S)=>{let _=cE(),b=uE(u,{relative:m}),T=l.toLowerCase()==="get"?"get":"post",w=typeof u=="string"&&ab.test(u),A=C=>{if(f&&f(C),C.defaultPrevented)return;C.preventDefault();let N=C.nativeEvent.submitter,E=N?.getAttribute("formmethod")||l;_(N||C.currentTarget,{fetcherKey:e,method:E,navigate:t,replace:r,state:o,relative:m,preventScrollReset:p,viewTransition:v})};return W.createElement("form",{ref:S,method:T,action:b,onSubmit:i?f:A,...x,"data-discover":!w&&n==="render"?"true":void 0})});iE.displayName="Form";function rE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ob(n){let e=W.useContext(Zo);return Xt(e,rE(n)),e}function aE(n,{target:e,replace:t,state:i,preventScrollReset:r,relative:o,viewTransition:l}={}){let u=Jo(),f=Fr(),m=Wc(n,{relative:o});return W.useCallback(p=>{if(Iw(p,e)){p.preventDefault();let v=t!==void 0?t:kc(f)===kc(m);u(n,{replace:v,state:i,preventScrollReset:r,relative:o,viewTransition:l})}},[f,u,m,t,i,e,n,r,o,l])}function sE(n){ir(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=W.useRef(Ym(n)),t=W.useRef(!1),i=Fr(),r=W.useMemo(()=>Pw(i.search,t.current?null:e.current),[i.search]),o=Jo(),l=W.useCallback((u,f)=>{const m=Ym(typeof u=="function"?u(new URLSearchParams(r)):u);t.current=!0,o("?"+m,f)},[o,r]);return[r,l]}var oE=0,lE=()=>`__${String(++oE)}__`;function cE(){let{router:n}=ob("useSubmit"),{basename:e}=W.useContext(yr),t=Aw();return W.useCallback(async(i,r={})=>{let{action:o,method:l,encType:u,formData:f,body:m}=Uw(i,e);if(r.navigate===!1){let p=r.fetcherKey||lE();await n.fetch(p,t,r.action||o,{preventScrollReset:r.preventScrollReset,formData:f,body:m,formMethod:r.method||l,formEncType:r.encType||u,flushSync:r.flushSync})}else await n.navigate(r.action||o,{preventScrollReset:r.preventScrollReset,formData:f,body:m,formMethod:r.method||l,formEncType:r.encType||u,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function uE(n,{relative:e}={}){let{basename:t}=W.useContext(yr),i=W.useContext(Br);Xt(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),o={...Wc(n||".",{relative:e})},l=Fr();if(n==null){o.search=l.search;let u=new URLSearchParams(o.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(v=>v).forEach(v=>u.append("index",v));let p=u.toString();o.search=p?`?${p}`:""}}return(!n||n===".")&&r.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:la([t,o.pathname])),kc(o)}function dE(n,e={}){let t=W.useContext(Kx);Xt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=ob("useViewTransitionState"),r=Wc(n,{relative:e.relative});if(!t.isTransitioning)return!1;let o=fa(t.currentLocation.pathname,i)||t.currentLocation.pathname,l=fa(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Rd(r.pathname,l)!=null||Rd(r.pathname,o)!=null}const lb=W.createContext(void 0),fE=()=>{const n=W.useContext(lb);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},hE=({children:n})=>{const[e,t]=W.useState(()=>localStorage.getItem("timebeacon-theme")||"light"),[i,r]=W.useState("light");W.useEffect(()=>{const l=()=>{if(e==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";r(u)}else r(e)};if(l(),e==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)");return u.addEventListener("change",l),()=>u.removeEventListener("change",l)}},[e]),W.useEffect(()=>{localStorage.setItem("timebeacon-theme",e),document.documentElement.setAttribute("data-theme",i)},[e,i]);const o={theme:e,effectiveTheme:i,setTheme:t};return d.jsx(lb.Provider,{value:o,children:n})},Oo={owner:{level:100,title:"Owner",description:"Full system access including billing and company management"},admin:{level:90,title:"Administrator",description:"User and project management, settings control"},manager:{level:70,title:"Manager",description:"Team oversight with scoped permissions for team members"},individual_contributor:{level:50,title:"Individual Contributor",description:"Senior employee with project leadership and limited team visibility"},employee:{level:30,title:"Employee",description:"Self-service time tracking and basic project access"},viewer:{level:10,title:"Viewer",description:"Read-only access to own data"}},cb={owner:[{id:"owner-company",resource:"company",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-users",resource:"users",actions:["create","read","update","delete","invite","manage"],scope:{all:!0}},{id:"owner-projects",resource:"projects",actions:["create","read","update","delete","assign","manage"],scope:{all:!0}},{id:"owner-timeEntries",resource:"timeEntries",actions:["create","read","update","delete","approve"],scope:{all:!0}},{id:"owner-reports",resource:"reports",actions:["create","read","export"],scope:{all:!0}},{id:"owner-analytics",resource:"analytics",actions:["read","export"],scope:{all:!0}},{id:"owner-billing",resource:"billing",actions:["read","update","manage"],scope:{all:!0}},{id:"owner-settings",resource:"settings",actions:["read","update","manage"],scope:{all:!0}},{id:"owner-integrations",resource:"integrations",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-teams",resource:"teams",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-clients",resource:"clients",actions:["create","read","update","delete","manage"],scope:{all:!0}}],admin:[{id:"admin-company",resource:"company",actions:["read","update"],scope:{all:!0}},{id:"admin-users",resource:"users",actions:["create","read","update","invite","manage"],scope:{all:!0}},{id:"admin-projects",resource:"projects",actions:["create","read","update","delete","assign","manage"],scope:{all:!0}},{id:"admin-timeEntries",resource:"timeEntries",actions:["read","update","approve"],scope:{all:!0}},{id:"admin-reports",resource:"reports",actions:["create","read","export"],scope:{all:!0}},{id:"admin-analytics",resource:"analytics",actions:["read","export"],scope:{all:!0}},{id:"admin-settings",resource:"settings",actions:["read","update"],scope:{all:!0}},{id:"admin-integrations",resource:"integrations",actions:["create","read","update","delete"],scope:{all:!0}},{id:"admin-teams",resource:"teams",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"admin-clients",resource:"clients",actions:["create","read","update","delete"],scope:{all:!0}}],manager:[{id:"manager-users",resource:"users",actions:["read"],scope:{team:[],department:[]}},{id:"manager-projects",resource:"projects",actions:["create","read","update","assign"],scope:{team:[],own:!0}},{id:"manager-timeEntries",resource:"timeEntries",actions:["read","approve","review"],scope:{team:[],own:!0}},{id:"manager-reports",resource:"reports",actions:["read","export"],scope:{team:[],own:!0}},{id:"manager-analytics",resource:"analytics",actions:["read"],scope:{team:[],own:!0}},{id:"manager-teams",resource:"teams",actions:["read","manage"],scope:{team:[]}},{id:"manager-clients",resource:"clients",actions:["read","update"],scope:{team:[],own:!0}},{id:"manager-own",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}}],individual_contributor:[{id:"ic-projects",resource:"projects",actions:["create","read","update"],scope:{own:!0}},{id:"ic-timeEntries",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}},{id:"ic-reports",resource:"reports",actions:["read","export"],scope:{own:!0}},{id:"ic-analytics",resource:"analytics",actions:["read"],scope:{own:!0}},{id:"ic-clients",resource:"clients",actions:["read","update"],scope:{own:!0}},{id:"ic-team-visibility",resource:"users",actions:["read"],scope:{team:[]}},{id:"ic-project-lead",resource:"projects",actions:["assign","review"],scope:{own:!0}}],employee:[{id:"employee-timeEntries",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}},{id:"employee-projects",resource:"projects",actions:["read"],scope:{own:!0}},{id:"employee-reports",resource:"reports",actions:["read"],scope:{own:!0}},{id:"employee-clients",resource:"clients",actions:["read"],scope:{own:!0}},{id:"employee-profile",resource:"users",actions:["read","update"],scope:{own:!0}}],viewer:[{id:"viewer-timeEntries",resource:"timeEntries",actions:["read"],scope:{own:!0}},{id:"viewer-projects",resource:"projects",actions:["read"],scope:{own:!0}},{id:"viewer-profile",resource:"users",actions:["read"],scope:{own:!0}}]};class mE{API_BASE="https://api.timebeacon.io";TOKEN_KEY="timebeacon_access_token";REFRESH_KEY="timebeacon_refresh_token";USER_KEY="timebeacon_user";COMPANY_KEY="timebeacon_company";async login(e){if(!e.email||!e.password)throw new Error("Email and password are required");if(!this.isValidEmail(e.email))throw new Error("Invalid email format");if(e.password.length<8)throw new Error("Password must be at least 8 characters");try{this.checkRateLimit(e.email)}catch(t){if(!e.email.includes("@demo.com"))throw t;console.warn("Rate limit reached for demo account, but allowing attempt")}try{return await this.secureLogin(e)}catch(t){return console.warn("Demo login failed, trying production:",t),this.productionLogin(e)}}async signup(e){if(!e.email||!e.password||!e.companyName)throw new Error("Email, password, and company name are required");if(!this.isValidEmail(e.email))throw new Error("Invalid email format");if(!this.isValidPassword(e.password))throw new Error("Password must be at least 8 characters with uppercase, lowercase, and numbers");return this.productionSignup(e)}async refreshToken(){const e=localStorage.getItem(this.REFRESH_KEY);if(!e)throw new Error("No refresh token available");try{const t=await fetch(`${this.API_BASE}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)throw new Error("Token refresh failed");const i=await t.json();return localStorage.setItem(this.TOKEN_KEY,i.accessToken),i.accessToken}catch(t){throw console.error("Token refresh error:",t),this.logout(),t}}async logout(){const e=localStorage.getItem(this.TOKEN_KEY);if(localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.REFRESH_KEY),localStorage.removeItem(this.USER_KEY),localStorage.removeItem(this.COMPANY_KEY),e)try{await fetch(`${this.API_BASE}/auth/logout`,{method:"POST",headers:{Authorization:`Bearer ${e}`}})}catch(t){console.warn("Failed to notify server of logout:",t)}}getAuthState(){const e=localStorage.getItem(this.TOKEN_KEY),t=localStorage.getItem(this.USER_KEY),i=localStorage.getItem(this.COMPANY_KEY);if(!e||!t||!i)return{user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]};try{const r=JSON.parse(t),o=JSON.parse(i),l=this.getUserPermissions(r.role,r.permissions);return{user:r,company:o,isAuthenticated:!0,isLoading:!1,permissions:l}}catch(r){return console.error("Error parsing auth state:",r),this.logout(),{user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]}}}hasPermission(e,t,i,r){return e.some(o=>o.resource!==t||!o.actions.includes(i)?!1:(o.scope&&(o.scope.own&&r||o.scope.all),!0))}getUserPermissions(e,t){return[...cb[e]||[],...t]}async inviteUser(e){const t=localStorage.getItem(this.TOKEN_KEY);if(!t)throw new Error("Not authenticated");try{const i=await fetch(`${this.API_BASE}/users/invite`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)});if(!i.ok){const r=await i.json();throw new Error(r.message||"Failed to invite user")}}catch(i){throw console.error("Invite user error:",i),i}}async getTeamMembers(){return this.mockTeamMembers()}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPassword(e){const i=/[A-Z]/.test(e),r=/[a-z]/.test(e),o=/\d/.test(e);return e.length>=8&&i&&r&&o}checkRateLimit(e){const t=`auth_attempts_${e}`,i=JSON.parse(localStorage.getItem(t)||"[]"),o=Date.now()-5*60*1e3,l=i.filter(m=>m>o),f=e.includes("@demo.com")?20:5;if(l.length>=f)throw new Error("Too many login attempts. Please try again in 5 minutes.")}clearRateLimit(e){const t=`auth_attempts_${e}`;localStorage.removeItem(t)}recordFailedAttempt(e){const t=`auth_attempts_${e}`,i=JSON.parse(localStorage.getItem(t)||"[]");i.push(Date.now()),localStorage.setItem(t,JSON.stringify(i))}async secureLogin(e){await new Promise(r=>setTimeout(r,300));const i=[{email:"admin@demo.com",password:"Admin123!",role:"owner"},{email:"manager@demo.com",password:"Manager123!",role:"manager"},{email:"employee@demo.com",password:"Employee123!",role:"employee"},{email:e.email,password:"Demo123!",role:"employee"}].find(r=>r.email===e.email&&r.password===e.password);if(!i)throw this.recordFailedAttempt(e.email),new Error("Invalid email or password. Try: admin@demo.com/Admin123!, manager@demo.com/Manager123!, or employee@demo.com/Employee123!");return this.clearRateLimit(e.email),this.createAuthResponse(e,i.role)}async productionLogin(e){try{const t=await fetch(`${this.API_BASE}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Login failed")}const i=await t.json();return this.storeAuthData(i),i}catch(t){throw console.error("Login error:",t),t}}async secureSignup(e){return await new Promise(t=>setTimeout(t,1e3)),this.createAuthResponse({email:e.email,password:e.password},"owner")}async productionSignup(e){try{const t=await fetch(`${this.API_BASE}/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Signup failed")}const i=await t.json();return this.storeAuthData(i),i}catch(t){throw console.error("Signup error:",t),t}}storeAuthData(e){localStorage.setItem(this.TOKEN_KEY,e.accessToken),localStorage.setItem(this.REFRESH_KEY,e.refreshToken),localStorage.setItem(this.USER_KEY,JSON.stringify(e.user)),localStorage.setItem(this.COMPANY_KEY,JSON.stringify(e.company))}generateSecureToken(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")}createAuthResponse(e,t){const i=crypto.randomUUID(),r=crypto.randomUUID(),o=this.generateSecureToken(),l={id:i,visitorId:this.generateVisitorId(),email:e.email,name:e.email.split("@")[0],companyId:r,role:t,permissions:[],profile:{firstName:e.email.split("@")[0],lastName:"User",jobTitle:"CEO",department:"Executive"},settings:{theme:"system",timezone:"America/New_York",workingHours:{start:"09:00",end:"17:00",workingDays:[1,2,3,4,5]},notifications:{enableDesktop:!0,reminderInterval:30,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:{}},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},u={id:r,accountId:this.generateAccountId(),name:"TimeBeacon Demo",slug:"demo",subscription:{id:crypto.randomUUID(),companyId:r,plan:"professional",status:"active",currentPeriodStart:new Date().toISOString(),currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString(),pricePerUser:15,features:{maxUsers:50,aiInsights:!0,advancedReports:!0,integrations:["google-calendar","slack","zoom"],dataRetentionMonths:24,apiAccess:!0,ssoEnabled:!1,customBranding:!0,prioritySupport:!0}},settings:{workingHours:{start:"09:00",end:"17:00",timezone:"America/New_York",workingDays:[1,2,3,4,5]},billing:{currency:"USD",invoiceEmail:e.email},security:{requireMfa:!1,sessionTimeout:480,passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSymbols:!1}}},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),ownerId:l.id,activeUsers:1,maxUsers:50};return{user:l,company:u,accessToken:o,refreshToken:this.generateSecureToken(),expiresIn:3600}}generateAccountId(){return Math.floor(1e4+Math.random()*9e4).toString()}generateVisitorId(){return Math.floor(1e4+Math.random()*9e4).toString()}mockTeamMembers(){return[{id:"user-1",visitorId:"10002",email:"john.doe@demo.com",name:"John Doe",companyId:"mock-company-id",role:"manager",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Engineering Manager",department:"Engineering",hourlyRate:75},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10003",email:"jane.smith@demo.com",name:"Jane Smith",companyId:"mock-company-id",role:"employee",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Senior Developer",department:"Engineering",hourlyRate:65},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!0}]}}const ks=new mE;class pE{SESSION_KEY="timebeacon_session";SESSION_TIMEOUT=30*60*1e3;MAX_IDLE_TIME=15*60*1e3;activityTimer=null;setSession(e){const t={token:e.accessToken,refreshToken:e.refreshToken,user:e.user,company:e.company,expiresAt:Date.now()+e.expiresIn*1e3,lastActivity:Date.now()},i=this.encryptSession(t);localStorage.setItem(this.SESSION_KEY,i),this.startActivityMonitoring()}getSession(){try{const e=localStorage.getItem(this.SESSION_KEY);if(!e)return null;const t=this.decryptSession(e);return t?this.isSessionExpired(t)?(this.clearSession(),null):(t.lastActivity=Date.now(),this.setSession({accessToken:t.token,refreshToken:t.refreshToken,user:t.user,company:t.company,expiresIn:Math.floor((t.expiresAt-Date.now())/1e3)}),t):null}catch(e){return console.error("Error getting session:",e),this.clearSession(),null}}clearSession(){localStorage.removeItem(this.SESSION_KEY),this.activityTimer&&(clearTimeout(this.activityTimer),this.activityTimer=null)}isSessionValid(){const e=this.getSession();return e!==null&&!this.isSessionExpired(e)}refreshActivity(){const e=this.getSession();e&&(e.lastActivity=Date.now(),this.setSession({accessToken:e.token,refreshToken:e.refreshToken,user:e.user,company:e.company,expiresIn:Math.floor((e.expiresAt-Date.now())/1e3)}))}isSessionExpired(e){const t=Date.now(),i=t>e.expiresAt,r=t-e.lastActivity>this.MAX_IDLE_TIME;return i||r}encryptSession(e){const t=JSON.stringify(e),i=this.getEncryptionKey();let r="";for(let o=0;o<t.length;o++)r+=String.fromCharCode(t.charCodeAt(o)^i.charCodeAt(o%i.length));return btoa(r)}decryptSession(e){try{const t=atob(e),i=this.getEncryptionKey();let r="";for(let o=0;o<t.length;o++)r+=String.fromCharCode(t.charCodeAt(o)^i.charCodeAt(o%i.length));return JSON.parse(r)}catch(t){return console.error("Failed to decrypt session:",t),null}}getEncryptionKey(){return"timebeacon-session-key-2024"}startActivityMonitoring(){this.activityTimer&&clearTimeout(this.activityTimer);const e=["mousedown","mousemove","keypress","scroll","touchstart"],t=()=>this.refreshActivity();e.forEach(i=>{document.addEventListener(i,t,{passive:!0})}),this.activityTimer=setTimeout(()=>{this.clearSession(),window.location.href="/login?reason=idle"},this.MAX_IDLE_TIME)}}const Cs=new pE;class gE{BASE_URL="https://app.timebeacon.io";extractRouteParams(){const t=window.location.pathname.split("/").filter(Boolean);if(t.length>=2){const[i,r]=t;if(this.isNumericId(i)&&this.isNumericId(r))return{accountId:i,visitorId:r}}return null}generateUserUrl(e,t,i=""){const r=`/${e.accountId}/${t.visitorId}`,o=i?`${r}/${i.replace(/^\//,"")}`:r;return`${this.BASE_URL}${o}`}navigateToRoute(e,t,i){const r=this.generateUserUrl(e,t,i);window.history.pushState({},"",r)}validateCurrentRoute(e,t){const i=this.extractRouteParams();return i?i.accountId===e.accountId&&i.visitorId===t.visitorId:!1}redirectToUserContext(e,t){if(!this.validateCurrentRoute(e,t)){const i=this.generateUserUrl(e,t,"dashboard");window.location.href=i}}getAppRoutes(e,t){const i={accountId:e.accountId,visitorId:t.visitorId};return[{...i,path:"dashboard"},{...i,path:"reports"},{...i,path:"ai-insights"},{...i,path:"projects"},{...i,path:"team"},{...i,path:"settings"},{...i,path:"privacy"}]}generateAccountId(){return Math.floor(1e4+Math.random()*9e4).toString()}generateVisitorId(){return Math.floor(1e4+Math.random()*9e4).toString()}formatId(e,t=5){return e.toString().padStart(t,"0")}parseId(e){return parseInt(e,10)}isNumericId(e){return/^\d{4,6}$/.test(e)}generateSharingUrl(e,t,i,r,o){const l=this.generateUserUrl(e,t),u=new URLSearchParams({type:i,id:r,...o?.readonly&&{readonly:"true"},...o?.expires&&{expires:o.expires.toISOString()}});return`${l}/share?${u.toString()}`}generateCompanyUrl(e){return`${this.BASE_URL}/company/${e.slug}`}generateLoginUrl(e,t){const i=new URLSearchParams;e&&i.set("account",e),t&&i.set("visitor",t);const r=i.toString();return`${this.BASE_URL}/login${r?`?${r}`:""}`}handleDeepLink(e,t,i){return!t||!i?`/login?${new URLSearchParams({return:e}).toString()}`:e.startsWith(`/${t.accountId}/${i.visitorId}`)?e:this.generateUserUrl(t,i,e)}encodeForUrl(e){return btoa(JSON.stringify(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}decodeFromUrl(e){try{const t=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"=");return JSON.parse(atob(t))}catch(t){return console.error("Failed to decode URL data:",t),null}}}const Lv=new gE,ub=W.createContext(void 0),Vc=()=>{const n=W.useContext(ub);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},vE=({children:n})=>{const[e,t]=W.useState({user:null,company:null,isAuthenticated:!1,isLoading:!0,permissions:[]}),[i,r]=W.useState(null);W.useEffect(()=>{o()},[]),W.useEffect(()=>{const v=Lv.extractRouteParams();r(v)},[window.location.pathname]);const o=()=>{try{const v=Cs.getSession();if(v&&Cs.isSessionValid()){const x=ks.hasPermission?ks.getUserPermissions?.(v.user.role,v.user.permissions||[])||[]:v.user.permissions||[];t({user:v.user,company:v.company,isAuthenticated:!0,isLoading:!1,permissions:x})}else Cs.clearSession(),t(x=>({...x,isLoading:!1}))}catch(v){console.error("Auth initialization failed:",v),Cs.clearSession(),t(x=>({...x,isLoading:!1}))}},p={...e,login:async(v,x)=>{t(S=>({...S,isLoading:!0}));try{const S=Lv.extractRouteParams(),_={email:v,password:x,accountId:S?.accountId,visitorId:S?.visitorId},b=await ks.login(_);Cs.setSession({accessToken:b.accessToken,refreshToken:b.refreshToken,user:b.user,company:b.company,expiresIn:b.expiresIn});const T=ks.hasPermission?ks.getUserPermissions?.(b.user.role,b.user.permissions||[])||[]:b.user.permissions||[],w={user:b.user,company:b.company,isAuthenticated:!0,isLoading:!1,permissions:T};return t(w),!0}catch(S){return console.error("Login failed:",S),t(_=>({..._,isLoading:!1})),!1}},logout:async()=>{try{await ks.logout()}catch(v){console.error("Logout error:",v)}Cs.clearSession(),t({user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]}),r(null),window.location.href="/login"},checkPermission:(v,x)=>e.user?ks.hasPermission(e.permissions,v,x,e.user.id):!1,currentRoute:i,refreshSession:()=>{Cs.refreshActivity()}};return d.jsx(ub.Provider,{value:p,children:n})};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */var bm,Iv;function Pv(){if(Iv)return bm;Iv=1;const{entries:n,setPrototypeOf:e,isFrozen:t,getPrototypeOf:i,getOwnPropertyDescriptor:r}=Object;let{freeze:o,seal:l,create:u}=Object,{apply:f,construct:m}=typeof Reflect<"u"&&Reflect;o||(o=function(Fe){return Fe}),l||(l=function(Fe){return Fe}),f||(f=function(Fe,Ye,Ze){return Fe.apply(Ye,Ze)}),m||(m=function(Fe,Ye){return new Fe(...Ye)});const p=z(Array.prototype.forEach),v=z(Array.prototype.lastIndexOf),x=z(Array.prototype.pop),S=z(Array.prototype.push),_=z(Array.prototype.splice),b=z(String.prototype.toLowerCase),T=z(String.prototype.toString),w=z(String.prototype.match),A=z(String.prototype.replace),C=z(String.prototype.indexOf),N=z(String.prototype.trim),E=z(Object.prototype.hasOwnProperty),I=z(RegExp.prototype.test),D=L(TypeError);function z(Qe){return function(Fe){Fe instanceof RegExp&&(Fe.lastIndex=0);for(var Ye=arguments.length,Ze=new Array(Ye>1?Ye-1:0),Ot=1;Ot<Ye;Ot++)Ze[Ot-1]=arguments[Ot];return f(Qe,Fe,Ze)}}function L(Qe){return function(){for(var Fe=arguments.length,Ye=new Array(Fe),Ze=0;Ze<Fe;Ze++)Ye[Ze]=arguments[Ze];return m(Qe,Ye)}}function H(Qe,Fe){let Ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b;e&&e(Qe,null);let Ze=Fe.length;for(;Ze--;){let Ot=Fe[Ze];if(typeof Ot=="string"){const wt=Ye(Ot);wt!==Ot&&(t(Fe)||(Fe[Ze]=wt),Ot=wt)}Qe[Ot]=!0}return Qe}function K(Qe){for(let Fe=0;Fe<Qe.length;Fe++)E(Qe,Fe)||(Qe[Fe]=null);return Qe}function ne(Qe){const Fe=u(null);for(const[Ye,Ze]of n(Qe))E(Qe,Ye)&&(Array.isArray(Ze)?Fe[Ye]=K(Ze):Ze&&typeof Ze=="object"&&Ze.constructor===Object?Fe[Ye]=ne(Ze):Fe[Ye]=Ze);return Fe}function xe(Qe,Fe){for(;Qe!==null;){const Ze=r(Qe,Fe);if(Ze){if(Ze.get)return z(Ze.get);if(typeof Ze.value=="function")return z(Ze.value)}Qe=i(Qe)}function Ye(){return null}return Ye}const He=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_e=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ie=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),he=o(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ne=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Be=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),X=o(["#text"]),pe=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),P=o(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Y=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),V=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),q=l(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ae=l(/<%[\w\W]*|[\w\W]*%>/gm),Re=l(/\$\{[\w\W]*/gm),Ce=l(/^data-[\-\w.\u00B7-\uFFFF]+$/),Le=l(/^aria-[\-\w]+$/),ke=l(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ct=l(/^(?:\w+script|data):/i),et=l(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ht=l(/^html$/i),rt=l(/^[a-z][.\w]*(-[.\w]+)+$/i);var Gn=Object.freeze({__proto__:null,ARIA_ATTR:Le,ATTR_WHITESPACE:et,CUSTOM_ELEMENT:rt,DATA_ATTR:Ce,DOCTYPE_NAME:Ht,ERB_EXPR:ae,IS_ALLOWED_URI:ke,IS_SCRIPT_OR_DATA:ct,MUSTACHE_EXPR:q,TMPLIT_EXPR:Re});const gt={element:1,text:3,progressingInstruction:7,comment:8,document:9},Me=function(){return typeof window>"u"?null:window},wn=function(Fe,Ye){if(typeof Fe!="object"||typeof Fe.createPolicy!="function")return null;let Ze=null;const Ot="data-tt-policy-suffix";Ye&&Ye.hasAttribute(Ot)&&(Ze=Ye.getAttribute(Ot));const wt="dompurify"+(Ze?"#"+Ze:"");try{return Fe.createPolicy(wt,{createHTML(Wt){return Wt},createScriptURL(Wt){return Wt}})}catch{return console.warn("TrustedTypes policy "+wt+" could not be created."),null}},Mn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ei(){let Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Me();const Fe=Pe=>ei(Pe);if(Fe.version="3.2.6",Fe.removed=[],!Qe||!Qe.document||Qe.document.nodeType!==gt.document||!Qe.Element)return Fe.isSupported=!1,Fe;let{document:Ye}=Qe;const Ze=Ye,Ot=Ze.currentScript,{DocumentFragment:wt,HTMLTemplateElement:Wt,Node:J,Element:Ee,NodeFilter:Xe,NamedNodeMap:We=Qe.NamedNodeMap||Qe.MozNamedAttrMap,HTMLFormElement:Je,DOMParser:dt,trustedTypes:$t}=Qe,Yn=Ee.prototype,Ui=xe(Yn,"cloneNode"),ut=xe(Yn,"remove"),ar=xe(Yn,"nextSibling"),wi=xe(Yn,"childNodes"),xr=xe(Yn,"parentNode");if(typeof Wt=="function"){const Pe=Ye.createElement("template");Pe.content&&Pe.content.ownerDocument&&(Ye=Pe.content.ownerDocument)}let qt,zi="";const{implementation:va,createNodeIterator:qs,createDocumentFragment:as,getElementsByTagName:ss}=Ye,{importNode:Ks}=Ze;let yn=Mn();Fe.isSupported=typeof n=="function"&&typeof xr=="function"&&va&&va.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:li,ERB_EXPR:Jt,TMPLIT_EXPR:en,DATA_ATTR:br,ARIA_ATTR:os,IS_SCRIPT_OR_DATA:al,ATTR_WHITESPACE:j,CUSTOM_ELEMENT:U}=Gn;let{IS_ALLOWED_URI:M}=Gn,R=null;const F=H({},[...He,..._e,...ie,...Ne,...X]);let B=null;const se=H({},[...pe,...P,...Y,...V]);let ue=Object.seal(u(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ee=null,le=null,de=!0,Se=!0,Ae=!1,Ie=!0,Te=!1,Oe=!0,Ge=!1,vt=!1,yt=!1,ht=!1,ci=!1,Ei=!1,ni=!0,ui=!1;const Ur="user-content-";let ii=!0,ya=!1,xn={},zr=null;const Jc=H({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ls=null;const sl=H({},["audio","video","img","source","image","track"]);let xa=null;const eu=H({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Rn="http://www.w3.org/1998/Math/MathML",ba="http://www.w3.org/2000/svg",Hi="http://www.w3.org/1999/xhtml";let Sr=Hi,_r=!1,Zs=null;const tu=H({},[Rn,ba,Hi],T);let sr=H({},["mi","mo","mn","ms","mtext"]),Qs=H({},["annotation-xml"]);const nu=H({},["title","style","font","a","script"]);let Sa=null;const ol=["application/xhtml+xml","text/html"],xf="text/html";let un=null,or=null;const ll=Ye.createElement("form"),Js=function(Z){return Z instanceof RegExp||Z instanceof Function},Tr=function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(or&&or===Z)){if((!Z||typeof Z!="object")&&(Z={}),Z=ne(Z),Sa=ol.indexOf(Z.PARSER_MEDIA_TYPE)===-1?xf:Z.PARSER_MEDIA_TYPE,un=Sa==="application/xhtml+xml"?T:b,R=E(Z,"ALLOWED_TAGS")?H({},Z.ALLOWED_TAGS,un):F,B=E(Z,"ALLOWED_ATTR")?H({},Z.ALLOWED_ATTR,un):se,Zs=E(Z,"ALLOWED_NAMESPACES")?H({},Z.ALLOWED_NAMESPACES,T):tu,xa=E(Z,"ADD_URI_SAFE_ATTR")?H(ne(eu),Z.ADD_URI_SAFE_ATTR,un):eu,ls=E(Z,"ADD_DATA_URI_TAGS")?H(ne(sl),Z.ADD_DATA_URI_TAGS,un):sl,zr=E(Z,"FORBID_CONTENTS")?H({},Z.FORBID_CONTENTS,un):Jc,ee=E(Z,"FORBID_TAGS")?H({},Z.FORBID_TAGS,un):ne({}),le=E(Z,"FORBID_ATTR")?H({},Z.FORBID_ATTR,un):ne({}),xn=E(Z,"USE_PROFILES")?Z.USE_PROFILES:!1,de=Z.ALLOW_ARIA_ATTR!==!1,Se=Z.ALLOW_DATA_ATTR!==!1,Ae=Z.ALLOW_UNKNOWN_PROTOCOLS||!1,Ie=Z.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=Z.SAFE_FOR_TEMPLATES||!1,Oe=Z.SAFE_FOR_XML!==!1,Ge=Z.WHOLE_DOCUMENT||!1,ht=Z.RETURN_DOM||!1,ci=Z.RETURN_DOM_FRAGMENT||!1,Ei=Z.RETURN_TRUSTED_TYPE||!1,yt=Z.FORCE_BODY||!1,ni=Z.SANITIZE_DOM!==!1,ui=Z.SANITIZE_NAMED_PROPS||!1,ii=Z.KEEP_CONTENT!==!1,ya=Z.IN_PLACE||!1,M=Z.ALLOWED_URI_REGEXP||ke,Sr=Z.NAMESPACE||Hi,sr=Z.MATHML_TEXT_INTEGRATION_POINTS||sr,Qs=Z.HTML_INTEGRATION_POINTS||Qs,ue=Z.CUSTOM_ELEMENT_HANDLING||{},Z.CUSTOM_ELEMENT_HANDLING&&Js(Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ue.tagNameCheck=Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&Js(Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ue.attributeNameCheck=Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&typeof Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ue.allowCustomizedBuiltInElements=Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(Se=!1),ci&&(ht=!0),xn&&(R=H({},X),B=[],xn.html===!0&&(H(R,He),H(B,pe)),xn.svg===!0&&(H(R,_e),H(B,P),H(B,V)),xn.svgFilters===!0&&(H(R,ie),H(B,P),H(B,V)),xn.mathMl===!0&&(H(R,Ne),H(B,Y),H(B,V))),Z.ADD_TAGS&&(R===F&&(R=ne(R)),H(R,Z.ADD_TAGS,un)),Z.ADD_ATTR&&(B===se&&(B=ne(B)),H(B,Z.ADD_ATTR,un)),Z.ADD_URI_SAFE_ATTR&&H(xa,Z.ADD_URI_SAFE_ATTR,un),Z.FORBID_CONTENTS&&(zr===Jc&&(zr=ne(zr)),H(zr,Z.FORBID_CONTENTS,un)),ii&&(R["#text"]=!0),Ge&&H(R,["html","head","body"]),R.table&&(H(R,["tbody"]),delete ee.tbody),Z.TRUSTED_TYPES_POLICY){if(typeof Z.TRUSTED_TYPES_POLICY.createHTML!="function")throw D('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Z.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw D('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');qt=Z.TRUSTED_TYPES_POLICY,zi=qt.createHTML("")}else qt===void 0&&(qt=wn($t,Ot)),qt!==null&&typeof zi=="string"&&(zi=qt.createHTML(""));o&&o(Z),or=Z}},Hr=H({},[..._e,...ie,...he]),cl=H({},[...Ne,...Be]),ul=function(Z){let we=xr(Z);(!we||!we.tagName)&&(we={namespaceURI:Sr,tagName:"template"});const Ue=b(Z.tagName),Ft=b(we.tagName);return Zs[Z.namespaceURI]?Z.namespaceURI===ba?we.namespaceURI===Hi?Ue==="svg":we.namespaceURI===Rn?Ue==="svg"&&(Ft==="annotation-xml"||sr[Ft]):!!Hr[Ue]:Z.namespaceURI===Rn?we.namespaceURI===Hi?Ue==="math":we.namespaceURI===ba?Ue==="math"&&Qs[Ft]:!!cl[Ue]:Z.namespaceURI===Hi?we.namespaceURI===ba&&!Qs[Ft]||we.namespaceURI===Rn&&!sr[Ft]?!1:!cl[Ue]&&(nu[Ue]||!Hr[Ue]):!!(Sa==="application/xhtml+xml"&&Zs[Z.namespaceURI]):!1},Ai=function(Z){S(Fe.removed,{element:Z});try{xr(Z).removeChild(Z)}catch{ut(Z)}},Wi=function(Z,we){try{S(Fe.removed,{attribute:we.getAttributeNode(Z),from:we})}catch{S(Fe.removed,{attribute:null,from:we})}if(we.removeAttribute(Z),Z==="is")if(ht||ci)try{Ai(we)}catch{}else try{we.setAttribute(Z,"")}catch{}},Vi=function(Z){let we=null,Ue=null;if(yt)Z="<remove></remove>"+Z;else{const Kt=w(Z,/^[\r\n\t ]+/);Ue=Kt&&Kt[0]}Sa==="application/xhtml+xml"&&Sr===Hi&&(Z='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Z+"</body></html>");const Ft=qt?qt.createHTML(Z):Z;if(Sr===Hi)try{we=new dt().parseFromString(Ft,Sa)}catch{}if(!we||!we.documentElement){we=va.createDocument(Sr,"template",null);try{we.documentElement.innerHTML=_r?zi:Ft}catch{}}const dn=we.body||we.documentElement;return Z&&Ue&&dn.insertBefore(Ye.createTextNode(Ue),dn.childNodes[0]||null),Sr===Hi?ss.call(we,Ge?"html":"body")[0]:Ge?we.documentElement:dn},eo=function(Z){return qs.call(Z.ownerDocument||Z,Z,Xe.SHOW_ELEMENT|Xe.SHOW_COMMENT|Xe.SHOW_TEXT|Xe.SHOW_PROCESSING_INSTRUCTION|Xe.SHOW_CDATA_SECTION,null)},Wr=function(Z){return Z instanceof Je&&(typeof Z.nodeName!="string"||typeof Z.textContent!="string"||typeof Z.removeChild!="function"||!(Z.attributes instanceof We)||typeof Z.removeAttribute!="function"||typeof Z.setAttribute!="function"||typeof Z.namespaceURI!="string"||typeof Z.insertBefore!="function"||typeof Z.hasChildNodes!="function")},lr=function(Z){return typeof J=="function"&&Z instanceof J};function ki(Pe,Z,we){p(Pe,Ue=>{Ue.call(Fe,Z,we,or)})}const cs=function(Z){let we=null;if(ki(yn.beforeSanitizeElements,Z,null),Wr(Z))return Ai(Z),!0;const Ue=un(Z.nodeName);if(ki(yn.uponSanitizeElement,Z,{tagName:Ue,allowedTags:R}),Oe&&Z.hasChildNodes()&&!lr(Z.firstElementChild)&&I(/<[/\w!]/g,Z.innerHTML)&&I(/<[/\w!]/g,Z.textContent)||Z.nodeType===gt.progressingInstruction||Oe&&Z.nodeType===gt.comment&&I(/<[/\w]/g,Z.data))return Ai(Z),!0;if(!R[Ue]||ee[Ue]){if(!ee[Ue]&&us(Ue)&&(ue.tagNameCheck instanceof RegExp&&I(ue.tagNameCheck,Ue)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Ue)))return!1;if(ii&&!zr[Ue]){const Ft=xr(Z)||Z.parentNode,dn=wi(Z)||Z.childNodes;if(dn&&Ft){const Kt=dn.length;for(let fn=Kt-1;fn>=0;--fn){const di=Ui(dn[fn],!0);di.__removalCount=(Z.__removalCount||0)+1,Ft.insertBefore(di,ar(Z))}}}return Ai(Z),!0}return Z instanceof Ee&&!ul(Z)||(Ue==="noscript"||Ue==="noembed"||Ue==="noframes")&&I(/<\/no(script|embed|frames)/i,Z.innerHTML)?(Ai(Z),!0):(Te&&Z.nodeType===gt.text&&(we=Z.textContent,p([li,Jt,en],Ft=>{we=A(we,Ft," ")}),Z.textContent!==we&&(S(Fe.removed,{element:Z.cloneNode()}),Z.textContent=we)),ki(yn.afterSanitizeElements,Z,null),!1)},dl=function(Z,we,Ue){if(ni&&(we==="id"||we==="name")&&(Ue in Ye||Ue in ll))return!1;if(!(Se&&!le[we]&&I(br,we))){if(!(de&&I(os,we))){if(!B[we]||le[we]){if(!(us(Z)&&(ue.tagNameCheck instanceof RegExp&&I(ue.tagNameCheck,Z)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Z))&&(ue.attributeNameCheck instanceof RegExp&&I(ue.attributeNameCheck,we)||ue.attributeNameCheck instanceof Function&&ue.attributeNameCheck(we))||we==="is"&&ue.allowCustomizedBuiltInElements&&(ue.tagNameCheck instanceof RegExp&&I(ue.tagNameCheck,Ue)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Ue))))return!1}else if(!xa[we]){if(!I(M,A(Ue,j,""))){if(!((we==="src"||we==="xlink:href"||we==="href")&&Z!=="script"&&C(Ue,"data:")===0&&ls[Z])){if(!(Ae&&!I(al,A(Ue,j,"")))){if(Ue)return!1}}}}}}return!0},us=function(Z){return Z!=="annotation-xml"&&w(Z,U)},ds=function(Z){ki(yn.beforeSanitizeAttributes,Z,null);const{attributes:we}=Z;if(!we||Wr(Z))return;const Ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let Ft=we.length;for(;Ft--;){const dn=we[Ft],{name:Kt,namespaceURI:fn,value:di}=dn,_a=un(Kt),fl=di;let En=Kt==="value"?fl:N(fl);if(Ue.attrName=_a,Ue.attrValue=En,Ue.keepAttr=!0,Ue.forceKeepAttr=void 0,ki(yn.uponSanitizeAttribute,Z,Ue),En=Ue.attrValue,ui&&(_a==="id"||_a==="name")&&(Wi(Kt,Z),En=Ur+En),Oe&&I(/((--!?|])>)|<\/(style|title)/i,En)){Wi(Kt,Z);continue}if(Ue.forceKeepAttr)continue;if(!Ue.keepAttr){Wi(Kt,Z);continue}if(!Ie&&I(/\/>/i,En)){Wi(Kt,Z);continue}Te&&p([li,Jt,en],to=>{En=A(En,to," ")});const ru=un(Z.nodeName);if(!dl(ru,_a,En)){Wi(Kt,Z);continue}if(qt&&typeof $t=="object"&&typeof $t.getAttributeType=="function"&&!fn)switch($t.getAttributeType(ru,_a)){case"TrustedHTML":{En=qt.createHTML(En);break}case"TrustedScriptURL":{En=qt.createScriptURL(En);break}}if(En!==fl)try{fn?Z.setAttributeNS(fn,Kt,En):Z.setAttribute(Kt,En),Wr(Z)?Ai(Z):x(Fe.removed)}catch{Wi(Kt,Z)}}ki(yn.afterSanitizeAttributes,Z,null)},iu=function Pe(Z){let we=null;const Ue=eo(Z);for(ki(yn.beforeSanitizeShadowDOM,Z,null);we=Ue.nextNode();)ki(yn.uponSanitizeShadowNode,we,null),cs(we),ds(we),we.content instanceof wt&&Pe(we.content);ki(yn.afterSanitizeShadowDOM,Z,null)};return Fe.sanitize=function(Pe){let Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},we=null,Ue=null,Ft=null,dn=null;if(_r=!Pe,_r&&(Pe="<!-->"),typeof Pe!="string"&&!lr(Pe))if(typeof Pe.toString=="function"){if(Pe=Pe.toString(),typeof Pe!="string")throw D("dirty is not a string, aborting")}else throw D("toString is not a function");if(!Fe.isSupported)return Pe;if(vt||Tr(Z),Fe.removed=[],typeof Pe=="string"&&(ya=!1),ya){if(Pe.nodeName){const di=un(Pe.nodeName);if(!R[di]||ee[di])throw D("root node is forbidden and cannot be sanitized in-place")}}else if(Pe instanceof J)we=Vi("<!---->"),Ue=we.ownerDocument.importNode(Pe,!0),Ue.nodeType===gt.element&&Ue.nodeName==="BODY"||Ue.nodeName==="HTML"?we=Ue:we.appendChild(Ue);else{if(!ht&&!Te&&!Ge&&Pe.indexOf("<")===-1)return qt&&Ei?qt.createHTML(Pe):Pe;if(we=Vi(Pe),!we)return ht?null:Ei?zi:""}we&&yt&&Ai(we.firstChild);const Kt=eo(ya?Pe:we);for(;Ft=Kt.nextNode();)cs(Ft),ds(Ft),Ft.content instanceof wt&&iu(Ft.content);if(ya)return Pe;if(ht){if(ci)for(dn=as.call(we.ownerDocument);we.firstChild;)dn.appendChild(we.firstChild);else dn=we;return(B.shadowroot||B.shadowrootmode)&&(dn=Ks.call(Ze,dn,!0)),dn}let fn=Ge?we.outerHTML:we.innerHTML;return Ge&&R["!doctype"]&&we.ownerDocument&&we.ownerDocument.doctype&&we.ownerDocument.doctype.name&&I(Ht,we.ownerDocument.doctype.name)&&(fn="<!DOCTYPE "+we.ownerDocument.doctype.name+`>
`+fn),Te&&p([li,Jt,en],di=>{fn=A(fn,di," ")}),qt&&Ei?qt.createHTML(fn):fn},Fe.setConfig=function(){let Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Tr(Pe),vt=!0},Fe.clearConfig=function(){or=null,vt=!1},Fe.isValidAttribute=function(Pe,Z,we){or||Tr({});const Ue=un(Pe),Ft=un(Z);return dl(Ue,Ft,we)},Fe.addHook=function(Pe,Z){typeof Z=="function"&&S(yn[Pe],Z)},Fe.removeHook=function(Pe,Z){if(Z!==void 0){const we=v(yn[Pe],Z);return we===-1?void 0:_(yn[Pe],we,1)[0]}return x(yn[Pe])},Fe.removeHooks=function(Pe){yn[Pe]=[]},Fe.removeAllHooks=function(){yn=Mn()},Fe}var ti=ei();return bm=ti,bm}var Sm,Bv;function yE(){return Bv||(Bv=1,Sm=window.DOMPurify||(window.DOMPurify=Pv().default||Pv())),Sm}var xE=yE();const bE=sp(xE);class SE{validateField(e,t){const i=[];let r=e;if(t.required&&this.isEmpty(e))return i.push(t.errorMessage||"This field is required"),{isValid:!1,errors:i};if(this.isEmpty(e)&&!t.required)return{isValid:!0,errors:[],sanitizedValue:""};if(t.type){const o=this.validateType(e,t.type);o.isValid||i.push(...o.errors),r=o.sanitizedValue||e}return t.minLength&&e.length<t.minLength&&i.push(`Must be at least ${t.minLength} characters long`),t.maxLength&&e.length>t.maxLength&&i.push(`Must be no more than ${t.maxLength} characters long`),t.pattern&&!t.pattern.test(e)&&i.push(t.errorMessage||"Invalid format"),t.customValidator&&!t.customValidator(e)&&i.push(t.errorMessage||"Invalid value"),{isValid:i.length===0,errors:i,sanitizedValue:r}}validateForm(e,t){const i={},r={};let o=!0;for(const[l,u]of Object.entries(t)){const f=this.validateField(e[l],u);f.isValid||(i[l]=f.errors,o=!1),r[l]=f.sanitizedValue}return{isValid:o,errors:i,sanitizedData:r}}sanitizeHtml(e){return bE.sanitize(e,{ALLOWED_TAGS:["p","br","strong","em","u","ol","ul","li"],ALLOWED_ATTR:[]})}sanitizeText(e){return e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}sanitizeSql(e){const t=[/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE)\b)/gi,/(--|\/\*|\*\/)/g,/(\bOR\b.*=.*\b)|(\bAND\b.*=.*\b)/gi,/(\bunion\b.*\bselect\b)/gi];let i=e;return t.forEach(r=>{i=i.replace(r,"")}),i.trim()}validateType(e,t){let i=e;const r=[];switch(t){case"email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||r.push("Please enter a valid email address"),i=this.sanitizeText(e);break;case"password":e.length<8&&r.push("Password must be at least 8 characters long"),/[A-Z]/.test(e)||r.push("Password must contain at least one uppercase letter"),/[a-z]/.test(e)||r.push("Password must contain at least one lowercase letter"),/\d/.test(e)||r.push("Password must contain at least one number"),i=e;break;case"text":i=this.sanitizeText(e);break;case"number":const l=Number(e);isNaN(l)&&r.push("Please enter a valid number"),i=l;break;case"url":try{new URL(e),i=this.sanitizeText(e)}catch{r.push("Please enter a valid URL")}break;case"phone":/^\+?[\d\s\-\(\)]+$/.test(e)||r.push("Please enter a valid phone number"),i=e.replace(/[^\d\+\-\(\)\s]/g,"");break;default:i=this.sanitizeText(e)}return{isValid:r.length===0,errors:r,sanitizedValue:i}}isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||typeof e=="object"&&Object.keys(e).length===0}validateTimeEntry(e){const t={description:{required:!0,type:"text",maxLength:500,errorMessage:"Description is required and must be less than 500 characters"},duration:{required:!0,type:"number",customValidator:i=>i>0&&i<=1440,errorMessage:"Duration must be between 1 minute and 24 hours"},projectId:{required:!0,errorMessage:"Project is required"},clientId:{required:!1}};return this.validateForm(e,t)}validateProject(e){const t={name:{required:!0,type:"text",maxLength:100,errorMessage:"Project name is required and must be less than 100 characters"},description:{required:!1,type:"text",maxLength:1e3},budget:{required:!1,type:"number",customValidator:i=>i>=0,errorMessage:"Budget must be a positive number"},hourlyRate:{required:!1,type:"number",customValidator:i=>i>=0,errorMessage:"Hourly rate must be a positive number"}};return this.validateForm(e,t)}validateClient(e){const t={name:{required:!0,type:"text",maxLength:100,errorMessage:"Client name is required and must be less than 100 characters"},email:{required:!1,type:"email"},phone:{required:!1,type:"phone"},website:{required:!1,type:"url"}};return this.validateForm(e,t)}}const Fv=new SE,_E=()=>{const[n,e]=W.useState(""),[t,i]=W.useState(""),[r,o]=W.useState(""),[l,u]=W.useState(!1),{login:f,isLoading:m}=Vc(),p=Jo(),v=async S=>{S.preventDefault(),o("");const _=Fv.validateField(n,{required:!0,type:"email",errorMessage:"Please enter a valid email address"}),b=Fv.validateField(t,{required:!0,minLength:8,errorMessage:"Password must be at least 8 characters"});if(!_.isValid){o(_.errors[0]);return}if(!b.isValid){o(b.errors[0]);return}try{await f(n,t)?p("/dashboard"):o("Invalid email or password")}catch(T){o(T.message||"Login failed. Please try again.")}},x=S=>{const _={admin:{email:"admin@demo.com",password:"Admin123!"},manager:{email:"manager@demo.com",password:"Manager123!"},employee:{email:"employee@demo.com",password:"Employee123!"}};e(_[S].email),i(_[S].password),u(!1)};return d.jsx("div",{className:"login-page",children:d.jsxs("div",{className:"login-container",children:[d.jsxs("div",{className:"login-header",children:[d.jsx("h1",{children:"TimeBeacon"}),d.jsx("p",{children:"Sign in to your account"})]}),d.jsxs("form",{onSubmit:v,className:"login-form",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"email",children:"Email"}),d.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),placeholder:"Enter your email",disabled:m})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"password",children:"Password"}),d.jsx("input",{type:"password",id:"password",value:t,onChange:S=>i(S.target.value),placeholder:"Enter your password",disabled:m})]}),r&&d.jsx("div",{className:"error-message",children:r}),d.jsx("button",{type:"submit",className:"login-button",disabled:m,children:m?"Signing in...":"Sign In"}),d.jsxs("div",{className:"demo-section",children:[d.jsxs("button",{type:"button",className:"demo-toggle-button",onClick:()=>u(!l),children:[l?"Hide":"Show"," Demo Credentials"]}),l&&d.jsxs("div",{className:"demo-credentials",children:[d.jsx("p",{children:"Try these demo accounts:"}),d.jsxs("div",{className:"demo-options",children:[d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>x("admin"),children:"Admin (Owner)"}),d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>x("manager"),children:"Manager"}),d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>x("employee"),children:"Employee"})]})]})]})]}),d.jsxs("div",{className:"security-notice",children:[d.jsx("p",{children:"🔒 This demo uses enhanced security features including:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Input validation and sanitization"}),d.jsx("li",{children:"Rate limiting protection"}),d.jsx("li",{children:"Secure session management"}),d.jsx("li",{children:"CSRF protection"})]})]})]})})},pi=({children:n})=>{const{user:e,isLoading:t}=Vc();return t?d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"var(--text-secondary)"},children:"Loading..."}):!e&&!localStorage.getItem("timebeacon_user")?d.jsx(tb,{to:"/login",replace:!0}):d.jsx(d.Fragment,{children:n})},TE=n=>{const e=[{id:"dashboard",label:"Dashboard",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),d.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),d.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),d.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})},{id:"reports",label:"Analytics & Reports",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M3 3v18h18"}),d.jsx("path",{d:"M18 17V9"}),d.jsx("path",{d:"M13 17V5"}),d.jsx("path",{d:"M8 17v-3"})]})},{id:"ai-insights",label:"AI Insights",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M9 12l2 2 4-4"}),d.jsx("path",{d:"M21 12c.5 0 .9-.4.9-.9V6.1c0-.5-.4-.9-.9-.9H17"}),d.jsx("path",{d:"M3 12c-.5 0-.9-.4-.9-.9V6.1c0-.5.4-.9.9-.9H7"}),d.jsx("path",{d:"M12 3c0-.5.4-.9.9-.9h4.9c.5 0 .9.4.9.9V7"}),d.jsx("path",{d:"M12 21c0 .5-.4.9-.9.9H6.1c-.5 0-.9-.4-.9-.9V17"})]})},{id:"privacy",label:"Privacy & Data",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),d.jsx("path",{d:"M9 12l2 2 4-4"})]})},{id:"integrations",label:"Integrations",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),d.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}],t=[];n&&["owner","admin","manager"].includes(n)&&t.push({id:"permissions",label:"Team & Permissions",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),d.jsx("circle",{cx:"9",cy:"7",r:"4"}),d.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),d.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),d.jsx("line",{x1:"15",y1:"11",x2:"21",y2:"5"}),d.jsx("circle",{cx:"18",cy:"8",r:"3"})]})});const i={id:"settings",label:"Settings",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return[...e,...t,i]},wE=({activeItem:n,onItemClick:e})=>{const{theme:t,setTheme:i}=fE(),{logout:r,user:o}=Vc(),[l,u]=W.useState(!1),f=()=>{const p=["light","dark","system"],x=(p.indexOf(t)+1)%p.length;i(p[x])},m=()=>{switch(t){case"light":return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]});case"dark":return d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})});case"system":return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",ry:"2"}),d.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),d.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]});default:return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]})}};return d.jsxs("div",{className:`sidebar ${l?"collapsed":""}`,children:[d.jsxs("div",{className:"sidebar-header",children:[d.jsxs("div",{className:"logo-container",children:[d.jsx("div",{className:"logo-icon",children:d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"drop-shadow(0 2px 4px rgba(99, 102, 241, 0.3))"},children:[d.jsx("defs",{children:d.jsxs("linearGradient",{id:"lightning-logo",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:1}}),d.jsx("stop",{offset:"50%",style:{stopColor:"#6366f1",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#3b82f6",stopOpacity:1}})]})}),d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",fill:"url(#lightning-logo)",stroke:"url(#lightning-logo)"})]})}),!l&&d.jsxs("div",{children:[d.jsx("h1",{className:"sidebar-title",children:"TimeBeacon"}),d.jsx("p",{className:"sidebar-subtitle",children:"AI-Powered Privacy-First"})]})]}),d.jsx("button",{className:"collapse-toggle",onClick:()=>u(!l),title:l?"Expand sidebar":"Collapse sidebar",children:l?d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"9,18 15,12 9,6"})}):d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"15,18 9,12 15,6"})})})]}),d.jsxs("nav",{className:"nav-menu",children:[TE(o?.role).map(p=>d.jsxs("a",{href:"#",className:`nav-item ${n===p.id?"active":""}`,onClick:v=>{v.preventDefault(),e(p.id)},title:l?p.label:"",children:[d.jsx("span",{className:"nav-icon",children:p.icon}),!l&&d.jsx("span",{className:"nav-label",children:p.label})]},p.id)),d.jsxs("div",{className:"nav-footer",children:[d.jsxs("button",{className:"theme-toggle",onClick:f,title:l?`Theme: ${t}`:`Current theme: ${t}`,children:[d.jsx("span",{className:"nav-icon",children:m()}),!l&&d.jsx("span",{className:"theme-label",children:t.charAt(0).toUpperCase()+t.slice(1)})]}),!l&&o&&d.jsx("div",{className:"user-info",children:d.jsxs("div",{className:"user-details",children:[d.jsx("span",{className:"user-name",children:o.name}),d.jsx("span",{className:"user-email",children:o.email})]})}),d.jsxs("button",{className:"logout-button",onClick:r,title:l?"Logout":"Sign out",children:[d.jsx("span",{className:"nav-icon",children:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),d.jsx("polyline",{points:"16,17 21,12 16,7"}),d.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})}),!l&&d.jsx("span",{className:"logout-label",children:"Sign Out"})]})]})]})]})},_m=(n,e)=>{const t=i=>{const[r,o]=i.split(":"),l=parseInt(r),u=l>=12?"PM":"AM";return`${l===0?12:l>12?l-12:l}:${o} ${u}`};return`${t(n)} - ${t(e)}`};class EE{config={ollamaBaseUrl:"http://localhost:11434",model:"llama3.2:3b",maxTokens:512,temperature:.1,confidenceThreshold:.7,enabled:!1};isAvailable=!1;constructor(){this.checkOllamaAvailability()}async checkOllamaAvailability(){try{const e=await fetch(`${this.config.ollamaBaseUrl}/api/tags`);if(e.ok){const i=(await e.json()).models?.some(r=>r.name.includes(this.config.model.split(":")[0]));return this.isAvailable=i,this.config.enabled=i,i?console.log("✅ Ollama AI service available with model:",this.config.model):console.log("⚠️ Ollama available but model not found. Install with:",`ollama pull ${this.config.model}`),this.isAvailable}}catch{console.log("ℹ️ Ollama not available. Install from https://ollama.com for AI features."),this.isAvailable=!1,this.config.enabled=!1}return!1}async analyzeContent(e){if(!this.isAvailable||!this.config.enabled)return this.fallbackAnalysis(e);try{const t=this.buildAnalysisPrompt(e),i=await this.callOllama(t);return this.parseAnalysisResponse(i,e)}catch(t){return console.error("AI analysis failed:",t),this.fallbackAnalysis(e)}}buildAnalysisPrompt(e){const{title:t,description:i,participants:r,location:o,source:l,context:u}=e,f=u?.projects.map(p=>`${p.name} (${p.client})`).join(", ")||"No projects available",m=u?.clients.map(p=>p.name).join(", ")||"No clients available";return`You are an AI assistant helping categorize work activities for time tracking. Analyze the following activity and suggest appropriate categorization.

ACTIVITY TO ANALYZE:
Title: ${t}
Description: ${i||"No description"}
Participants: ${r?.join(", ")||"Not specified"}
Location: ${o||"Not specified"}
Source: ${l}

AVAILABLE CONTEXT:
Projects: ${f}
Clients: ${m}

INSTRUCTIONS:
1. Suggest the most appropriate project and client from the available options
2. Determine if this is billable work (client work = billable, internal = non-billable)
3. Categorize as: client, internal, admin, sales, or marketing
4. If it's a meeting, classify type: kickoff, discovery, implementation, support, training, check-in, or escalation
5. Extract relevant tags or keywords
6. Provide your confidence level (0.0 to 1.0)
7. Explain your reasoning briefly

RESPOND IN THIS EXACT JSON FORMAT:
{
  "confidence": 0.85,
  "suggestedProject": "Project Name",
  "suggestedClient": "Client Name",
  "suggestedDescription": "Enhanced description if needed",
  "suggestedCategory": "client",
  "suggestedBillable": true,
  "meetingType": "implementation",
  "tags": ["keyword1", "keyword2"],
  "reasoning": "Brief explanation of categorization logic"
}

Only respond with valid JSON. If uncertain, lower the confidence score.`}async callOllama(e){const t=await fetch(`${this.config.ollamaBaseUrl}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.config.model,prompt:e,stream:!1,options:{temperature:this.config.temperature,num_predict:this.config.maxTokens}})});if(!t.ok)throw new Error(`Ollama API error: ${t.status}`);return(await t.json()).response}parseAnalysisResponse(e,t){try{const i=e.match(/\{[\s\S]*\}/);if(!i)throw new Error("No JSON found in response");const r=JSON.parse(i[0]);return{confidence:Math.max(0,Math.min(1,r.confidence||.5)),suggestedProject:this.validateProject(r.suggestedProject,t.context?.projects),suggestedClient:this.validateClient(r.suggestedClient,t.context?.clients),suggestedDescription:r.suggestedDescription||t.title,suggestedCategory:this.validateCategory(r.suggestedCategory),suggestedBillable:!!r.suggestedBillable,meetingType:this.validateMeetingType(r.meetingType),tags:Array.isArray(r.tags)?r.tags.slice(0,5):[],reasoning:r.reasoning||"AI analysis completed"}}catch(i){return console.error("Failed to parse AI response:",i),this.fallbackAnalysis(t)}}validateProject(e,t){if(!e||!t)return;const i=t.find(o=>o.name.toLowerCase()===e.toLowerCase());return i?i.name:t.find(o=>o.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(o.name.toLowerCase()))?.name}validateClient(e,t){if(!e||!t)return;const i=t.find(o=>o.name.toLowerCase()===e.toLowerCase());return i?i.name:t.find(o=>o.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(o.name.toLowerCase()))?.name}validateCategory(e){return["client","internal","admin","meeting"].includes(e)?e:"client"}validateMeetingType(e){return e&&["kickoff","discovery","implementation","support","training","check-in","escalation"].includes(e)?e:void 0}fallbackAnalysis(e){const t=e.title.toLowerCase(),i=e.description?.toLowerCase()||"";let r="client",o=!0,l;t.includes("internal")||t.includes("team")||t.includes("standup")?(r="internal",o=!1):t.includes("meeting")||t.includes("demo")?r="meeting":(t.includes("admin")||t.includes("setup")||t.includes("configuration"))&&(r="admin",o=!1),t.includes("kickoff")?l="kickoff":t.includes("discovery")?l="discovery":t.includes("implementation")?l="implementation":t.includes("support")?l="support":t.includes("training")?l="training":(t.includes("check-in")||t.includes("checkin"))&&(l="check-in");const u=this.findClientByKeywords(t+" "+i,e.context?.clients);return{confidence:.6,suggestedProject:this.findProjectByKeywords(t+" "+i,e.context?.projects),suggestedClient:u,suggestedDescription:e.title,suggestedCategory:r,suggestedBillable:o,meetingType:l,tags:this.extractKeywords(t+" "+i),reasoning:"Rule-based analysis (AI not available)"}}findClientByKeywords(e,t){if(t)return t.find(i=>e.toLowerCase().includes(i.name.toLowerCase()))?.name}findProjectByKeywords(e,t){if(t)return t.find(i=>e.toLowerCase().includes(i.name.toLowerCase())||e.toLowerCase().includes(i.client.toLowerCase()))?.name}extractKeywords(e){const t=e.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(i=>i.length>3).filter(i=>!["with","from","this","that","will","have","been","they","them","were"].includes(i));return[...new Set(t)].slice(0,5)}updateConfig(e){this.config={...this.config,...e},(e.ollamaBaseUrl||e.model)&&this.checkOllamaAvailability()}getStatus(){return{available:this.isAvailable,model:this.config.model,enabled:this.config.enabled}}async testService(){const e=Date.now();try{const t={title:"Team standup meeting",description:"Daily team sync with engineering",source:"calendar",timestamp:new Date().toISOString(),context:{projects:[{id:"1",name:"Internal Tools",client:"Internal",color:"#000",active:!0,createdAt:""}],clients:[{id:"1",name:"Internal",color:"#000",active:!0,createdAt:""}],recentEntries:[]}},i=await this.analyzeContent(t),r=Date.now()-e;return{success:i.confidence>0,latency:r}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown error"}}}}const Ga=new EE;class AE{db=null;dbName="TimeBeaconDB";version=1;stores=["timeEntries","projects","clients","settings","syncMetadata"];constructor(){this.init()}async init(){return new Promise((e,t)=>{const i=indexedDB.open(this.dbName,this.version);i.onerror=r=>{console.error("Database failed to open:",r),console.log("ℹ️ Database issue detected. Please refresh the page or clear browser cache."),t(new Error("Failed to open database"))},i.onsuccess=()=>{this.db=i.result,console.log("✅ TimeBeacon Database initialized"),e()},i.onupgradeneeded=r=>{const o=r.target.result;if(!o.objectStoreNames.contains("timeEntries")){const l=o.createObjectStore("timeEntries",{keyPath:"id"});l.createIndex("date","date",{unique:!1}),l.createIndex("project","project",{unique:!1}),l.createIndex("client","client",{unique:!1}),l.createIndex("status","status",{unique:!1})}if(!o.objectStoreNames.contains("projects")){const l=o.createObjectStore("projects",{keyPath:"id"});l.createIndex("name","name",{unique:!0}),l.createIndex("client","client",{unique:!1})}o.objectStoreNames.contains("clients")||o.createObjectStore("clients",{keyPath:"id"}).createIndex("name","name",{unique:!0}),o.objectStoreNames.contains("settings")||o.createObjectStore("settings",{keyPath:"key"}),o.objectStoreNames.contains("syncMetadata")||o.createObjectStore("syncMetadata",{keyPath:"id"}),console.log("📦 Database schema created")}})}async performOperation(e,t,i="readonly"){return this.db||await this.init(),new Promise((r,o)=>{const u=this.db.transaction([e],i).objectStore(e),f=t(u);f.onsuccess=()=>r(f.result),f.onerror=()=>o(f.error)})}async addTimeEntry(e){await this.performOperation("timeEntries",t=>t.add(e),"readwrite"),console.log("✅ Time entry added:",e.id)}async updateTimeEntry(e,t){const i=await this.getTimeEntry(e);if(!i)throw new Error(`Time entry ${e} not found`);const r={...i,...t};await this.performOperation("timeEntries",o=>o.put(r),"readwrite"),console.log("✅ Time entry updated:",e)}async deleteTimeEntry(e){await this.performOperation("timeEntries",t=>t.delete(e),"readwrite"),console.log("✅ Time entry deleted:",e)}async getTimeEntry(e){return await this.performOperation("timeEntries",i=>i.get(e))||null}async getAllTimeEntries(){return await this.performOperation("timeEntries",e=>e.getAll())}async getTimeEntriesByDateRange(e,t){return(await this.getAllTimeEntries()).filter(r=>r.date>=e&&r.date<=t)}async addProject(e){await this.performOperation("projects",t=>t.add(e),"readwrite"),console.log("✅ Project added:",e.name)}async updateProject(e,t){const i=await this.getProject(e);if(!i)throw new Error(`Project ${e} not found`);const r={...i,...t};await this.performOperation("projects",o=>o.put(r),"readwrite"),console.log("✅ Project updated:",e)}async deleteProject(e){await this.performOperation("projects",t=>t.delete(e),"readwrite"),console.log("✅ Project deleted:",e)}async getProject(e){return await this.performOperation("projects",i=>i.get(e))||null}async getAllProjects(){return await this.performOperation("projects",e=>e.getAll())}async addClient(e){await this.performOperation("clients",t=>t.add(e),"readwrite"),console.log("✅ Client added:",e.name)}async updateClient(e,t){const i=await this.getClient(e);if(!i)throw new Error(`Client ${e} not found`);const r={...i,...t};await this.performOperation("clients",o=>o.put(r),"readwrite"),console.log("✅ Client updated:",e)}async deleteClient(e){await this.performOperation("clients",t=>t.delete(e),"readwrite"),console.log("✅ Client deleted:",e)}async getClient(e){return await this.performOperation("clients",i=>i.get(e))||null}async getAllClients(){return await this.performOperation("clients",e=>e.getAll())}async updateSettings(e){await this.performOperation("settings",t=>t.put({key:"userSettings",value:e}),"readwrite"),console.log("✅ Settings updated")}async getSettings(){return(await this.performOperation("settings",t=>t.get("userSettings")))?.value||null}async updateSyncMetadata(e){await this.performOperation("syncMetadata",t=>t.put({id:"sync",...e}),"readwrite")}async getSyncMetadata(){return await this.performOperation("syncMetadata",t=>t.get("sync"))||null}async exportAllData(){const[e,t,i,r,o]=await Promise.all([this.getAllTimeEntries(),this.getAllProjects(),this.getAllClients(),this.getSettings(),this.getSyncMetadata()]);return{timeEntries:e,projects:t,clients:i,settings:r||{},syncMetadata:o||{lastSync:"",version:1,deviceId:crypto.randomUUID()}}}async importData(e){const t=this.db.transaction(this.stores,"readwrite");try{if(e.timeEntries){const i=t.objectStore("timeEntries");for(const r of e.timeEntries)await new Promise((o,l)=>{const u=i.put(r);u.onsuccess=()=>o(void 0),u.onerror=()=>l(u.error)})}if(e.projects){const i=t.objectStore("projects");for(const r of e.projects)await new Promise((o,l)=>{const u=i.put(r);u.onsuccess=()=>o(void 0),u.onerror=()=>l(u.error)})}if(e.clients){const i=t.objectStore("clients");for(const r of e.clients)await new Promise((o,l)=>{const u=i.put(r);u.onsuccess=()=>o(void 0),u.onerror=()=>l(u.error)})}console.log("✅ Data import completed")}catch(i){throw console.error("❌ Data import failed:",i),i}}async clearAllData(){const e=this.db.transaction(this.stores,"readwrite");for(const t of this.stores){const i=e.objectStore(t);await new Promise((r,o)=>{const l=i.clear();l.onsuccess=()=>r(void 0),l.onerror=()=>o(l.error)})}console.log("✅ All data cleared")}async getStats(){const[e,t,i]=await Promise.all([this.getAllTimeEntries(),this.getAllProjects(),this.getAllClients()]),o=`${(JSON.stringify({timeEntries:e,projects:t,clients:i}).length/1024).toFixed(2)} KB`;return{timeEntries:e.length,projects:t.length,clients:i.length,dbSize:o}}}const It=new AE;class kE{processingQueue=[];isProcessing=!1;analysisCache=new Map;constructor(){setInterval(()=>this.processQueue(),3e4)}async addActivity(e){this.processingQueue.push(e),console.log(`📝 Added activity for analysis: ${e.title}`),(this.processingQueue.length>=5||this.isHighPriority(e))&&await this.processQueue()}async processQueue(){if(!(this.isProcessing||this.processingQueue.length===0)){this.isProcessing=!0,console.log(`🤖 Processing ${this.processingQueue.length} activities...`);try{const e=await this.buildAnalysisContext(),t=[...this.processingQueue];this.processingQueue=[];for(const i of t)await this.analyzeActivity(i,e)}catch(e){console.error("Content analysis failed:",e)}finally{this.isProcessing=!1}}}async analyzeActivity(e,t){try{const i=this.getCacheKey(e);let r=this.analysisCache.get(i);if(!r){const o={title:e.title,description:e.description,participants:e.participants,location:e.location,source:e.source,timestamp:e.timestamp,context:{projects:t.projects,clients:t.clients,recentEntries:t.recentEntries.slice(0,10)}};r=await Ga.analyzeContent(o),this.analysisCache.set(i,r),setTimeout(()=>this.analysisCache.delete(i),36e5)}r.confidence>=.5?await this.createSuggestion(e,r,t):console.log(`⚠️ Low confidence (${r.confidence}) for activity: ${e.title}`)}catch(i){console.error(`Failed to analyze activity ${e.id}:`,i)}}async createSuggestion(e,t,i){const r={id:`suggestion-${e.id}-${Date.now()}`,analysisId:`analysis-${e.id}`,source:e.source,suggestedDate:e.startTime.split("T")[0],suggestedStartTime:this.extractTime(e.startTime),suggestedDuration:this.calculateDuration(e,t),suggestedProject:t.suggestedProject||"Unknown Project",suggestedClient:t.suggestedClient||"Unknown Client",suggestedDescription:t.suggestedDescription||e.title,suggestedTags:t.tags||[],confidence:t.confidence,basedOnDataFrom:[e.source],generatedAt:new Date().toISOString(),status:"pending"};await this.storeSuggestion(r),console.log(`✨ Created suggestion: ${r.suggestedProject} - ${r.suggestedDescription} (${Math.round(r.confidence*100)}% confidence)`),t.confidence>=i.userPreferences.autoApproveThreshold&&await this.autoApproveSuggestion(r)}calculateDuration(e,t){if(e.duration)return e.duration;if(e.startTime&&e.endTime){const r=new Date(e.startTime);return(new Date(e.endTime).getTime()-r.getTime())/(1e3*60*60)}const i=e.title.toLowerCase();return i.includes("standup")||i.includes("daily")?.25:i.includes("check-in")||i.includes("quick")?.5:i.includes("kickoff")||i.includes("discovery")?2:i.includes("training")||i.includes("workshop")?4:1}extractTime(e){return new Date(e).toTimeString().slice(0,5)}async buildAnalysisContext(){const[e,t,i]=await Promise.all([It.getAllProjects(),It.getAllClients(),It.getAllTimeEntries()]),r=new Date;r.setDate(r.getDate()-30);const o=i.filter(l=>new Date(l.date)>=r).sort((l,u)=>new Date(u.date).getTime()-new Date(l.date).getTime());return{projects:e.filter(l=>l.active),clients:t.filter(l=>l.active),recentEntries:o.slice(0,50),userPreferences:{defaultDuration:1,autoApproveThreshold:.85,preferredCategories:["client","implementation"]}}}async storeSuggestion(e){const t=this.getStoredSuggestions();t.push(e),localStorage.setItem("timebeacon_suggestions",JSON.stringify(t))}getStoredSuggestions(){try{const e=localStorage.getItem("timebeacon_suggestions");return e?JSON.parse(e):[]}catch{return[]}}async updateSuggestion(e,t){const i=this.getStoredSuggestions(),r=i.findIndex(o=>o.id===e);r>=0&&(i[r]={...i[r],...t},localStorage.setItem("timebeacon_suggestions",JSON.stringify(i)))}async approveSuggestion(e,t){const r=this.getStoredSuggestions().find(l=>l.id===e);if(!r)throw new Error("Suggestion not found");const o={date:r.suggestedDate,startTime:r.suggestedStartTime,endTime:this.calculateEndTime(r.suggestedStartTime,r.suggestedDuration),duration:r.suggestedDuration,client:r.suggestedClient,project:r.suggestedProject,description:r.suggestedDescription,category:"client",status:"pending",automated:!0,source:"ai_suggested",billable:!0,tags:r.suggestedTags,generatedFromSuggestion:r.id,aiConfidence:r.confidence,dataSourcesUsed:r.basedOnDataFrom,...t};await It.addTimeEntry({...o,id:crypto.randomUUID()}),await this.updateSuggestion(e,{status:"approved",approvedAt:new Date().toISOString()}),console.log(`✅ Approved suggestion and created time entry: ${r.suggestedProject}`)}async rejectSuggestion(e,t){await this.updateSuggestion(e,{status:"rejected",rejectedAt:new Date().toISOString(),rejectionReason:t}),console.log(`❌ Rejected suggestion: ${t}`)}async autoApproveSuggestion(e){try{await this.approveSuggestion(e.id),console.log(`🚀 Auto-approved high confidence suggestion: ${e.suggestedProject}`)}catch(t){console.error("Auto-approval failed:",t)}}calculateEndTime(e,t){const[i,r]=e.split(":").map(Number),o=i*60+r+t*60,l=Math.floor(o/60)%24,u=o%60;return`${l.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}isHighPriority(e){const t=e.title.toLowerCase();return t.includes("urgent")||t.includes("escalation")||t.includes("emergency")}getCacheKey(e){return`${e.source}-${e.title}-${e.startTime}`}async clearOldSuggestions(e=30){const t=this.getStoredSuggestions(),i=new Date;i.setDate(i.getDate()-e);const r=t.filter(o=>new Date(o.generatedAt)>i||o.status==="pending");localStorage.setItem("timebeacon_suggestions",JSON.stringify(r)),console.log(`🧹 Cleaned up ${t.length-r.length} old suggestions`)}getStats(){const e=this.getStoredSuggestions(),t=e.filter(i=>i.status==="pending");return{queueLength:this.processingQueue.length,isProcessing:this.isProcessing,cacheSize:this.analysisCache.size,totalSuggestions:e.length,pendingSuggestions:t.length}}}const tr=new kE;class CE{oauth2Client;config;STORAGE_KEY="timebeacon_google_auth";constructor(){this.config={clientId:"829394557114-32bedmchkqvru4gvtg52ojgef7fssusn.apps.googleusercontent.com",clientSecret:"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",redirectUri:`${window.location.origin}/auth/google/callback`,scopes:["https://www.googleapis.com/auth/calendar.readonly","https://www.googleapis.com/auth/userinfo.email"]},this.initializeOAuth2Client()}initializeOAuth2Client(){console.log("Google Calendar auth disabled for production")}getAuthUrl(){return this.oauth2Client.generateAuthUrl({access_type:"offline",scope:this.config.scopes,prompt:"consent"})}async exchangeCodeForTokens(e){try{const{tokens:t}=await this.oauth2Client.getToken(e);return this.oauth2Client.setCredentials(t),this.storeTokens(t),console.log("✅ Google Calendar authentication successful"),{success:!0}}catch(t){return console.error("Google Calendar auth failed:",t),{success:!1,error:t instanceof Error?t.message:"Authentication failed"}}}isAuthenticated(){const e=this.getStoredTokens();return!!(e&&e.access_token)}getCalendarClient(){return console.warn("Google Calendar disabled in production"),null}async refreshAccessToken(){try{const e=this.getStoredTokens();if(!e||!e.refresh_token)return console.log("No refresh token available, need to re-authenticate"),!1;this.oauth2Client.setCredentials(e);const{credentials:t}=await this.oauth2Client.refreshAccessToken(),i={...e,...t};return this.storeTokens(i),this.oauth2Client.setCredentials(i),console.log("✅ Google Calendar token refreshed"),!0}catch(e){return console.error("Failed to refresh token:",e),this.clearStoredTokens(),!1}}async testConnection(){try{if(!this.isAuthenticated())return{success:!1,error:"Not authenticated"};const e=this.getStoredTokens();return e&&e.expiry_date&&e.expiry_date<Date.now()&&!await this.refreshAccessToken()?{success:!1,error:"Token refresh failed"}:{success:!0,userEmail:{data:{email:"disabled@example.com"}}.data.email||void 0}}catch(e){return console.error("Google Calendar connection test failed:",e),{success:!1,error:e instanceof Error?e.message:"Connection test failed"}}}signOut(){this.clearStoredTokens(),this.oauth2Client.setCredentials({}),console.log("📤 Signed out from Google Calendar")}async getUserInfo(){try{if(!this.isAuthenticated())return null;const e={data:{email:"disabled@example.com",name:"Google Auth Disabled"}};return{email:e.data.email||void 0,name:e.data.name||void 0}}catch(e){return console.error("Failed to get user info:",e),null}}storeTokens(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){console.error("Failed to store auth tokens:",t)}}getStoredTokens(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):null}catch(e){return console.error("Failed to load stored tokens:",e),null}}clearStoredTokens(){try{localStorage.removeItem(this.STORAGE_KEY)}catch(e){console.error("Failed to clear stored tokens:",e)}}isConfigured(){return!!(this.config.clientId&&this.config.clientSecret)}getOAuth2Client(){return this.oauth2Client}}const Tm=new CE;class jE{config={enabled:!1,autoTrackMeetings:!0,minimumDuration:15,excludeAllDay:!0,excludePersonal:!0,excludeCalendars:[],includeCalendars:[],trackingKeywords:["meeting","call","sync","review","demo","training"],excludeKeywords:["personal","lunch","break","vacation","holiday","blocked"]};lastSyncTimestamp=null;processedEvents=new Set;constructor(){this.loadConfig(),this.config.enabled&&this.startBackgroundSync()}async initialize(){try{return await this.checkCalendarAccess()?(this.config.enabled=!0,this.saveConfig(),this.startBackgroundSync(),console.log("✅ Calendar integration initialized"),{success:!0}):{success:!1,error:"Calendar access not available. Please enable calendar integration in settings."}}catch(e){return console.error("Calendar initialization failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async checkCalendarAccess(){return!0}startBackgroundSync(){setInterval(()=>{this.syncCalendarEvents()},5*60*1e3),this.syncCalendarEvents()}async syncCalendarEvents(){if(this.config.enabled)try{console.log("📅 Syncing calendar events...");const t=(await this.fetchCalendarEvents()).filter(i=>!this.processedEvents.has(i.id));console.log(`Found ${t.length} new calendar events to process`);for(const i of t)this.shouldProcessEvent(i)&&(await this.processCalendarEvent(i),this.processedEvents.add(i.id));this.lastSyncTimestamp=new Date().toISOString(),this.saveConfig()}catch(e){console.error("Calendar sync failed:",e)}}async fetchCalendarEvents(){try{if(!Tm.isAuthenticated())return console.log("Not authenticated with Google Calendar, using mock data"),this.getMockEvents();const e=await Tm.testConnection();if(!e.success)return console.log("Google Calendar connection failed, using mock data:",e.error),this.getMockEvents();let t;try{t=Tm.getCalendarClient()}catch(f){return console.warn("Calendar client not available:",f),[]}if(!t)return console.warn("Calendar client not available"),[];const i=new Date;i.setHours(i.getHours()-24);const r=new Date,o=await t.events.list({calendarId:"primary",timeMin:i.toISOString(),timeMax:r.toISOString(),maxResults:50,singleEvents:!0,orderBy:"startTime"});if(!o||!o.data)return console.warn("No response data from Google Calendar API"),[];const u=(o.data.items||[]).map(f=>({id:f.id||"",title:f.summary||"Untitled Event",description:f.description||void 0,start:f.start?.dateTime||f.start?.date||new Date().toISOString(),end:f.end?.dateTime||f.end?.date||new Date().toISOString(),attendees:f.attendees?.map(m=>m.email||"")||[],location:f.location||void 0,organizer:f.organizer?.email||void 0,status:this.mapEventStatus(f.status||void 0),isAllDay:!!f.start?.date,recurrence:f.recurrence?.join(", ")||void 0,calendarId:"primary",calendarName:"Google Calendar"})).filter(f=>f.start&&f.end);return console.log(`📅 Fetched ${u.length} events from Google Calendar`),u}catch(e){return console.error("Failed to fetch Google Calendar events:",e),console.log("Falling back to mock data"),this.getMockEvents()}}getMockEvents(){return[{id:"event-1",title:"Client Discovery Call - Acme Corp",description:"Initial discovery session to understand requirements",start:new Date(Date.now()-72e5).toISOString(),end:new Date(Date.now()-36e5).toISOString(),attendees:["john@acme.com","sarah@acme.com"],location:"Zoom",status:"confirmed",calendarId:"primary",calendarName:"Work Calendar"},{id:"event-2",title:"Team Standup",description:"Daily team sync",start:new Date(Date.now()-18e5).toISOString(),end:new Date(Date.now()-9e5).toISOString(),attendees:["team@company.com"],status:"confirmed",calendarId:"primary",calendarName:"Work Calendar"}].filter(t=>new Date(t.end)<new Date)}mapEventStatus(e){switch(e){case"confirmed":return"confirmed";case"tentative":return"tentative";case"cancelled":return"cancelled";default:return"confirmed"}}shouldProcessEvent(e){if(this.processedEvents.has(e.id)||e.status==="cancelled"||e.isAllDay&&this.config.excludeAllDay||(new Date(e.end).getTime()-new Date(e.start).getTime())/(1e3*60)<this.config.minimumDuration||this.config.includeCalendars.length>0&&!this.config.includeCalendars.includes(e.calendarId)||this.config.excludeCalendars.includes(e.calendarId))return!1;const i=`${e.title} ${e.description||""}`.toLowerCase();return this.config.excludeKeywords.some(r=>i.includes(r))?!1:this.config.trackingKeywords.length>0?this.config.trackingKeywords.some(r=>i.includes(r)):!0}async processCalendarEvent(e){try{const t={id:`calendar-${e.id}`,title:e.title,description:e.description,startTime:e.start,endTime:e.end,duration:this.calculateDuration(e.start,e.end),participants:e.attendees,location:e.location,source:"calendar",sourceId:e.id,timestamp:e.start,rawData:e};await tr.addActivity(t),console.log(`📅 Processed calendar event: ${e.title}`)}catch(t){console.error(`Failed to process calendar event ${e.id}:`,t)}}calculateDuration(e,t){const i=new Date(e);return(new Date(t).getTime()-i.getTime())/(1e3*60*60)}updateConfig(e){this.config={...this.config,...e},this.saveConfig(),e.enabled!==void 0&&e.enabled&&!this.config.enabled&&this.startBackgroundSync()}getConfig(){return{...this.config}}getStatus(){return{enabled:this.config.enabled,lastSync:this.lastSyncTimestamp,processedEventsCount:this.processedEvents.size,isConnected:this.config.enabled}}async forceSync(){try{const e=this.processedEvents.size;return await this.syncCalendarEvents(),{success:!0,eventsProcessed:this.processedEvents.size-e}}catch(e){return{success:!1,eventsProcessed:0,error:e instanceof Error?e.message:"Sync failed"}}}clearHistory(){this.processedEvents.clear(),this.lastSyncTimestamp=null,this.saveConfig(),console.log("📅 Cleared calendar sync history")}loadConfig(){try{const e=localStorage.getItem("timebeacon_calendar_config");if(e){const t=JSON.parse(e);this.config={...this.config,...t};const i=localStorage.getItem("timebeacon_processed_events");i&&(this.processedEvents=new Set(JSON.parse(i))),this.lastSyncTimestamp=localStorage.getItem("timebeacon_last_sync")}}catch(e){console.error("Failed to load calendar config:",e)}}saveConfig(){try{localStorage.setItem("timebeacon_calendar_config",JSON.stringify(this.config)),localStorage.setItem("timebeacon_processed_events",JSON.stringify([...this.processedEvents])),this.lastSyncTimestamp&&localStorage.setItem("timebeacon_last_sync",this.lastSyncTimestamp)}catch(e){console.error("Failed to save calendar config:",e)}}async testConnection(){try{return{success:!0,eventsFound:(await this.fetchCalendarEvents()).length}}catch(e){return{success:!1,eventsFound:0,error:e instanceof Error?e.message:"Connection test failed"}}}}const Rr=new jE,DE=()=>{const[n,e]=W.useState([]),[t,i]=W.useState(!1),[r,o]=W.useState(null),l=async()=>{i(!0),o(null);try{const m=await Rr.forceSync();m.success?(console.log(`Calendar sync completed. Processed ${m.eventsProcessed} new events.`),e([])):o(m.error||"Failed to sync calendar events")}catch(m){o(m instanceof Error?m.message:"Failed to fetch calendar events")}finally{i(!1)}},u=m=>n.filter(p=>new Date(p.start).toISOString().split("T")[0]===m),f=()=>Rr.getStatus();return W.useEffect(()=>{l();const m=setInterval(l,5*60*1e3);return()=>clearInterval(m)},[]),{events:n,isLoading:t,error:r,fetchEvents:l,getEventsForDate:u,getIntegrationStatus:f}},Uv=n=>{const e=["Monday","Tuesday","Wednesday","Thursday","Friday"],i=new Date(n+"T00:00:00").getDay();console.log(`🔍 getDayOfWeek debug: ${n} -> JS day ${i}`);const o={1:0,2:1,3:2,4:3,5:4}[i],l=o!==void 0?e[o]:null;return console.log(`🔍 Mapped to: ${l} (workDay index: ${o})`),l},NE=n=>{const e=[],t=new Date(n),i=t.getDay();let r;i===0?r=6:r=i-1;const o=new Date(t);o.setDate(t.getDate()-r);for(let l=0;l<5;l++){const u=new Date(o);u.setDate(o.getDate()+l),e.push(u.toISOString().split("T")[0])}return e},OE=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"}),zv=({entries:n,projects:e,onUpdateEntry:t,onDeleteEntry:i,onAddEntry:r})=>{const[o,l]=W.useState(new Date),[u,f]=W.useState(null),[m,p]=W.useState(!1),[v,x]=W.useState(0),[S,_]=W.useState(""),[b,T]=W.useState(!1),[w,A]=W.useState(new Set),[C,N]=W.useState(!1),[E,I]=W.useState(null),[D,z]=W.useState({frequency:"weekly",count:4,skipWeekends:!1}),[L,H]=W.useState(!1),[K,ne]=W.useState({date:new Date().toISOString().split("T")[0],startTime:"09:00",duration:1,project:"",description:"",billable:!0,createSeries:!1,frequency:"weekly",repeatCount:4,skipWeekends:!1}),xe=zo.useCallback(J=>{ne(Ee=>({...Ee,...J}))},[]),He=zo.useCallback(()=>{T(!1)},[]),_e=zo.useCallback(()=>{L||(N(!1),I(null))},[L]),{getEventsForDate:ie}=DE(),he=NE(o);console.log("🗓️ WEEK DATES DEBUG:",he),he.forEach((J,Ee)=>{const Xe=Uv(J),Je=new Date(J).getDay();console.log(`Index ${Ee}: ${J} -> ${Xe} (JS day: ${Je})`)});const Ne=J=>{const Ee=new Date(o);Ee.setDate(Ee.getDate()+(J==="next"?7:-7)),l(Ee)},Be=()=>{l(new Date)},X=()=>{const Ee=new Date().toISOString().split("T")[0];return he.includes(Ee)},pe=J=>n.filter(Ee=>Ee.date===J).sort((Ee,Xe)=>Ee.startTime.localeCompare(Xe.startTime)),P=J=>{const Ee=new Date(J.start).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),Xe=new Date(J.end).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),We=(new Date(J.end).getTime()-new Date(J.start).getTime())/(1e3*60*60);return d.jsxs("div",{className:"calendar-event-card",children:[d.jsxs("div",{className:"entry-header",children:[d.jsxs("div",{className:"entry-time",children:[Ee," - ",Xe]}),d.jsx("div",{className:"entry-duration",children:Y(We)})]}),d.jsxs("div",{className:"entry-content",children:[d.jsxs("div",{className:"entry-source",children:[d.jsx("div",{className:"source-dot",style:{backgroundColor:"#4285F4"}}),d.jsxs("span",{className:"source-name",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Calendar Event"]})]}),d.jsx("div",{className:"entry-project",children:J.title}),J.description&&d.jsx("div",{className:"entry-description",children:J.description}),d.jsxs("div",{className:"entry-meta",children:[d.jsxs("div",{className:"source-badge",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),d.jsx("span",{children:"Google Calendar"})]}),J.attendees&&J.attendees.length>0&&d.jsxs("span",{className:"meeting-attendees",children:[J.attendees.length," attendees"]}),J.location&&d.jsxs("span",{className:"meeting-location",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),d.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),J.location]})]})]}),d.jsx("div",{className:"entry-actions",children:d.jsxs("button",{className:"btn btn-small btn-primary",onClick:()=>wn(J),title:"Convert to time entry",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),d.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Track Time"]})})]},`calendar-${J.id}`)},Y=J=>{const Ee=Math.floor(J),Xe=Math.round((J-Ee)*60);return`${Ee}h ${Xe}m`},V=J=>pe(J).reduce((Ee,Xe)=>Ee+Xe.duration,0),q=()=>he.reduce((J,Ee)=>J+V(Ee),0),ae=(J,Ee)=>{t(J,{status:Ee})},Re=J=>{f(J),x(J.duration),_(J.description),p(!0)},Ce=()=>{if(u&&S.trim()&&v>0){const J=Le(u.startTime,v);t(u.id,{description:S.trim(),duration:v,endTime:J}),p(!1),f(null),_(""),x(0)}},Le=(J,Ee)=>{const[Xe,We]=J.split(":").map(Number),Je=Xe*60+We+Ee*60,dt=Math.floor(Je/60)%24,$t=Je%60;return`${dt.toString().padStart(2,"0")}:${$t.toString().padStart(2,"0")}`},ke=J=>{const Ee=Math.max(.25,v+J);x(Math.round(Ee*4)/4)},ct=(J,Ee)=>{const Xe=[],We=new Date(J.date);for(let Je=0;Je<Ee.count;Je++){const dt=new Date(We);switch(Ee.frequency){case"daily":dt.setDate(We.getDate()+Je);break;case"weekly":dt.setDate(We.getDate()+Je*7);break;case"monthly":dt.setMonth(We.getMonth()+Je);break}if(Ee.skipWeekends&&(dt.getDay()===0||dt.getDay()===6)){const $t=dt.getDay()===0?1:2;dt.setDate(dt.getDate()+$t)}Xe.push({...J,date:dt.toISOString().split("T")[0]})}return Xe},et=J=>{if(J.preventDefault(),!r)return;const Ee=Le(K.startTime,K.duration);K.createSeries?ct({date:K.date,startTime:K.startTime,endTime:Ee,duration:K.duration,client:K.client,project:K.project,description:K.description,category:"client",status:"pending",automated:!1,billable:K.billable},{frequency:K.frequency,count:K.repeatCount,skipWeekends:K.skipWeekends}).forEach(We=>r(We)):r({date:K.date,startTime:K.startTime,endTime:Ee,duration:K.duration,client:K.client,project:K.project,description:K.description,category:"client",status:"pending",automated:!1,billable:K.billable}),ne({date:new Date().toISOString().split("T")[0],startTime:"09:00",duration:1,client:"",project:"",description:"",billable:!0,createSeries:!1,frequency:"weekly",repeatCount:4,skipWeekends:!1}),T(!1)},Ht=(J,Ee)=>{const Xe=new Set(w);Ee?Xe.add(J):Xe.delete(J),A(Xe)},rt=J=>{w.forEach(Ee=>{t(Ee,{status:J})}),A(new Set)},Gn=J=>{I(J),z({frequency:"weekly",count:4,skipWeekends:!1}),N(!0)},gt=async()=>{if(!(!E||!r)){H(!0);try{const J=[],Ee=new Date(E.date);let Xe=0;for(let We=1;We<=D.count&&Xe<D.count;We++){const Je=new Date(Ee);switch(D.frequency){case"daily":Je.setDate(Ee.getDate()+We);break;case"weekly":Je.setDate(Ee.getDate()+We*7);break;case"monthly":Je.setMonth(Ee.getMonth()+We);break}if(D.skipWeekends){const dt=Je.getDay();if(dt===0||dt===6)continue}J.push({...E,date:Je.toISOString().split("T")[0],status:"pending"}),Xe++}for(const We of J)r(We),await new Promise(Je=>setTimeout(Je,50));setTimeout(()=>{N(!1),I(null),H(!1)},200)}catch(J){console.error("Error generating duplicates:",J),H(!1)}}},Me=()=>{if(!E)return[];const J=new Date(E.date),Ee=[];let Xe=0;for(let We=1;We<=D.count&&Xe<Math.min(D.count,5);We++){const Je=new Date(J);switch(D.frequency){case"daily":Je.setDate(J.getDate()+We);break;case"weekly":Je.setDate(J.getDate()+We*7);break;case"monthly":Je.setMonth(J.getMonth()+We);break}if(D.skipWeekends){const dt=Je.getDay();if(dt===0||dt===6)continue}Ee.push(Je),Xe++}return Ee},wn=J=>{if(!r){console.warn("onAddEntry prop not provided, cannot convert calendar event");return}const Ee=new Date(J.start),Xe=new Date(J.end),We=(Xe.getTime()-Ee.getTime())/(1e3*60*60),{client:Je,project:dt}=Mn(J),$t={date:Ee.toISOString().split("T")[0],startTime:Ee.toTimeString().slice(0,5),endTime:Xe.toTimeString().slice(0,5),duration:We,client:Je,project:dt,description:J.description||J.title,category:"meeting",status:"pending",automated:!0,source:"calendar",meetingType:ei(J),billable:!0,tags:J.attendees?[`${J.attendees.length} attendees`]:void 0};r($t),console.log("✅ Converted calendar event to time entry:",J.title)},Mn=J=>{const Ee=J.title.toLowerCase(),Xe=e.find(We=>Ee.includes(We.name.toLowerCase()));if(Xe)return{client:"",project:Xe.name};if(J.attendees&&J.attendees.length>0)for(const We of J.attendees){const Je=We.split("@")[1];if(Je){const dt=Je.split(".")[0];return{client:"",project:`${dt.charAt(0).toUpperCase()+dt.slice(1)} - Meeting`}}}return{client:"",project:"Calendar Meeting"}},ei=J=>{const Ee=J.title.toLowerCase(),Xe=(J.description||"").toLowerCase(),We=`${Ee} ${Xe}`;return We.includes("kickoff")||We.includes("kick-off")?"kickoff":We.includes("discovery")||We.includes("discovery")?"discovery":We.includes("implementation")||We.includes("implement")?"implementation":We.includes("support")||We.includes("help")?"support":We.includes("training")||We.includes("onboarding")?"training":We.includes("check-in")||We.includes("checkin")||We.includes("status")?"check-in":We.includes("escalation")||We.includes("urgent")?"escalation":"check-in"},ti=J=>{const Ee=Math.floor(J),Xe=Math.round((J-Ee)*60);return`${Ee}h ${Xe}m`},Qe=J=>{switch(J){case"pending":return"#f59e0b";case"submitted":return"#3b82f6";case"approved":return"#10b981";case"rejected":return"#ef4444";default:return"#6b7280"}},Fe=()=>n.filter(J=>he.includes(J.date)&&J.status==="pending").length,Ye=()=>{const J=n.filter(Ee=>he.includes(Ee.date));return J.length>0&&J.every(Ee=>Ee.status==="approved")},Ze=()=>{n.filter(Ee=>he.includes(Ee.date)&&Ee.status==="approved").forEach(Ee=>{t(Ee.id,{status:"submitted"})})},Ot=new Date(he[0]),wt=new Date(he[4]),Wt=`${Ot.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${wt.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`;return d.jsxs("div",{children:[d.jsx("div",{className:"dashboard-header",children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",width:"100%"},children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Dashboard"}),d.jsx("p",{className:"dashboard-subtitle",children:"Your weekly time tracking overview with smart automation"})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>Ne("prev"),children:"Previous Week"}),d.jsx("span",{style:{fontWeight:"600",fontSize:"16px",minWidth:"200px",textAlign:"center"},children:Wt}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>Ne("next"),children:"Next Week"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[d.jsx("button",{className:"btn btn-primary",onClick:()=>T(!0),children:"Add Entry"}),!X()&&d.jsx("button",{className:"btn btn-secondary",onClick:Be,children:"Current Week"})]})]})]})}),w.size>0&&d.jsx("div",{className:"content-card",style:{marginBottom:"24px",background:"var(--brand-primary-light)",border:"2px solid var(--brand-primary)"},children:d.jsxs("div",{style:{padding:"16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},children:[d.jsxs("span",{style:{fontWeight:"600",color:"var(--brand-primary)"},children:[w.size," entries selected"]}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>rt("pending"),children:"Mark as Pending"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>rt("approved"),children:"Mark as Approved"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>A(new Set),children:"Clear Selection"})]})}),d.jsxs("div",{className:"week-summary",children:[d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Total Hours This Week"}),d.jsx("div",{className:"summary-value",children:Y(q())})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Customer-Focused Hours"}),d.jsx("div",{className:"summary-value",children:Y(n.filter(J=>he.includes(J.date)&&J.billable).reduce((J,Ee)=>J+Ee.duration,0))})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Utilization Rate"}),d.jsxs("div",{className:"summary-value",children:[q()>0?(n.filter(J=>he.includes(J.date)&&J.billable).reduce((J,Ee)=>J+Ee.duration,0)/q()*100).toFixed(1):0,"%"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Automated Entries"}),d.jsx("div",{className:"summary-value",children:n.filter(J=>he.includes(J.date)&&J.automated).length})]}),d.jsx("div",{className:"submit-actions",children:X()?d.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[d.jsx("button",{className:`btn ${Ye()?"btn-primary":"btn-secondary"}`,onClick:Ye()?Ze:void 0,disabled:!Ye(),title:Ye()?"Submit all approved entries for manager review":`You have ${Fe()} pending entries. Please approve all entries before submitting.`,children:Ye()?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M9 11l3 3 8-8"}),d.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.18 0 2.3.23 3.32.64"})]}),"Submit Week for Review"]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("polyline",{points:"12,6 12,12 16,14"})]}),Fe()," Pending Entries"]})}),!Ye()&&Fe()>0&&d.jsx("div",{className:"tooltip-warning",style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"var(--warning)",color:"white",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",whiteSpace:"nowrap",marginBottom:"8px",opacity:0,animation:"fadeIn 0.3s ease-in-out 2s forwards"},children:"Please approve all entries before submitting"})]}):d.jsx("button",{className:"btn btn-secondary",disabled:!0,children:he[0]>new Date().toISOString().split("T")[0]?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Future Week"]}):n.filter(J=>he.includes(J.date)&&J.status==="submitted").length>0?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M9 11l3 3 8-8"}),d.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.18 0 2.3.23 3.32.64"})]}),"Submitted"]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),d.jsx("polyline",{points:"22,4 12,14.01 9,11.01"})]}),"Past Week"]})})})]}),d.jsx("div",{className:"weekly-grid",children:he.map((J,Ee)=>{const Xe=pe(J),We=ie(J),Je=V(J),dt=J===new Date().toISOString().split("T")[0],$t=J<new Date().toISOString().split("T")[0],Yn=J>new Date().toISOString().split("T")[0],Ui=Uv(J);return Ui?d.jsxs("div",{className:`day-column ${dt?"today":""} ${$t?"past":""} ${Yn?"future":""}`,children:[d.jsxs("div",{className:"day-header",children:[d.jsxs("div",{className:"day-info",children:[d.jsx("div",{className:"day-name",children:Ui}),d.jsx("div",{className:"day-date",children:OE(J)})]}),d.jsxs("div",{className:"day-total",children:[Xe.length>0&&d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"12px",marginBottom:"4px"},children:[d.jsx("input",{type:"checkbox",checked:Xe.every(ut=>w.has(ut.id)),onChange:ut=>{Xe.forEach(ar=>Ht(ar.id,ut.target.checked))},style:{margin:0}}),"All"]}),Je>0&&d.jsx("span",{className:"hours-badge",children:Y(Je)}),Yn&&Je===0&&d.jsx("span",{className:"future-indicator",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})]})]}),d.jsxs("div",{className:"day-entries",children:[We.map(ut=>P(ut)),Xe.length===0&&We.length===0?d.jsx("div",{className:"no-entries",children:Yn?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),d.jsx("p",{children:"Upcoming - no meetings scheduled"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",ry:"2"}),d.jsx("circle",{cx:"12",cy:"5",r:"2"}),d.jsx("path",{d:"m12 7-3 4 3 4 3-4-3-4z"}),d.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"16"}),d.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"16"})]}),d.jsx("p",{children:"No automated entries detected"})]})}):Xe.map(ut=>{const ar=e.find(wi=>wi.name===ut.project);return d.jsxs("div",{className:"time-entry-card",children:[d.jsxs("div",{className:"entry-header",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("input",{type:"checkbox",checked:w.has(ut.id),onChange:wi=>Ht(ut.id,wi.target.checked),style:{margin:0}}),d.jsx("div",{className:"entry-time",children:_m(ut.startTime,ut.endTime)})]}),d.jsx("div",{className:"entry-duration",children:Y(ut.duration)})]}),d.jsxs("div",{className:"entry-content",children:[d.jsxs("div",{className:"entry-project-info",children:[d.jsx("div",{className:"project-dot",style:{backgroundColor:ar?.color||"#6366f1"}}),d.jsx("span",{className:"project-name",children:ut.project})]}),d.jsx("div",{className:"entry-description",children:ut.description}),d.jsxs("div",{className:"entry-meta",children:[ut.automated&&d.jsxs("div",{className:"source-badge",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",ry:"2"}),d.jsx("circle",{cx:"12",cy:"5",r:"2"}),d.jsx("path",{d:"m12 7-3 4 3 4 3-4-3-4z"}),d.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"16"}),d.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"16"})]}),d.jsx("span",{children:ut.source||"Auto"})]}),ut.meetingType&&d.jsx("span",{className:"meeting-type",children:ut.meetingType.replace("-"," ")}),d.jsx("span",{className:`billable-badge ${ut.billable?"billable":"non-billable"}`,children:ut.billable?"Billable":"Non-billable"})]})]}),d.jsxs("div",{className:"entry-actions",children:[d.jsxs("select",{value:ut.status==="submitted"||ut.status==="rejected"?"approved":ut.status,onChange:wi=>ae(ut.id,wi.target.value),className:"status-select",style:{borderColor:Qe(ut.status)},children:[d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"approved",children:"Approved"})]}),d.jsx("button",{className:"btn btn-small btn-secondary",onClick:()=>Re(ut),title:"Edit entry",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),d.jsx("path",{d:"m15 5 4 4"})]})}),d.jsx("button",{className:"btn btn-small btn-secondary",onClick:()=>Gn(ut),title:"Duplicate for recurring meetings",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),d.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"})]})}),d.jsx("button",{className:"btn btn-small btn-danger",onClick:()=>{confirm("Delete this entry?")&&i(ut.id)},children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3,6 5,6 21,6"}),d.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]},ut.id)})]})]},J):null})}),m&&u&&d.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:d.jsxs("div",{className:"modal-content",onClick:J=>J.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"8px"},children:[d.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),d.jsx("path",{d:"m15 5 4 4"})]}),"Edit Time Entry"]}),d.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:"×"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{background:"var(--background-secondary)",padding:"16px",borderRadius:"8px",marginBottom:"24px"},children:[d.jsxs("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",color:"var(--text-primary)"},children:[u.project," • ",u.client]}),d.jsxs("div",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:[new Date(u.date).toLocaleDateString()," • ",_m(u.startTime,u.endTime)]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"24px"},children:[d.jsx("label",{style:{fontWeight:"600",marginBottom:"8px",display:"block"},children:"Description:"}),d.jsx("textarea",{value:S,onChange:J=>_(J.target.value),className:"form-input",rows:3,placeholder:"Describe what you worked on...",style:{width:"100%",resize:"vertical"}})]}),d.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:"24px"},children:[d.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",color:"var(--text-primary)"},children:"Duration"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--brand-primary)",marginBottom:"16px",textAlign:"center"},children:ti(v)}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsxs("div",{style:{marginBottom:"12px"},children:[d.jsx("label",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",display:"block",textAlign:"center"},children:"Subtract Time"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>ke(-.25),disabled:v<=.25,style:{fontSize:"12px",padding:"8px 4px"},children:"− 15min"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>ke(-.5),disabled:v<=.5,style:{fontSize:"12px",padding:"8px 4px"},children:"− 30min"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>ke(-1),disabled:v<=1,style:{fontSize:"12px",padding:"8px 4px"},children:"− 1hr"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",display:"block",textAlign:"center"},children:"Add Time"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>ke(.25),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 15min"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>ke(.5),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 30min"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>ke(1),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 1hr"})]})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{fontWeight:"600",marginBottom:"8px",display:"block"},children:"Exact duration (hours):"}),d.jsx("input",{type:"number",min:"0.25",max:"24",step:"0.25",value:v,onChange:J=>{const Ee=parseFloat(J.target.value)||.25;x(Math.max(.25,Math.round(Ee*4)/4))},className:"form-input",style:{textAlign:"center"}})]}),d.jsx("div",{style:{background:"var(--info-light)",padding:"12px",borderRadius:"8px",marginTop:"12px"},children:d.jsxs("p",{style:{fontSize:"14px",color:"var(--info-dark)",margin:0,textAlign:"center"},children:[d.jsx("strong",{children:"New time:"})," ",u.startTime," - ",Le(u.startTime,v)]})})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>p(!1),children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:Ce,disabled:!S.trim()||v<=0,children:"Save Changes"})]})]})}),b&&d.jsx("div",{className:"modal-overlay",onClick:He,children:d.jsxs("div",{className:"modal-content",onClick:J=>J.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"8px",filter:"drop-shadow(0 2px 4px rgba(99, 102, 241, 0.3))"},children:[d.jsx("defs",{children:d.jsxs("linearGradient",{id:"lightning-dashboard",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:1}}),d.jsx("stop",{offset:"50%",style:{stopColor:"#6366f1",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#3b82f6",stopOpacity:1}})]})}),d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",fill:"url(#lightning-dashboard)",stroke:"url(#lightning-dashboard)"})]}),"Quick Time Entry"]}),d.jsx("button",{className:"modal-close",onClick:He,children:"×"})]}),d.jsx("div",{className:"modal-body",children:d.jsxs("form",{onSubmit:et,children:[d.jsxs("div",{className:"form-group",style:{marginBottom:"24px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",display:"block"},children:"How long did you work?"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px",marginBottom:"16px"},children:[.5,1,2,4].map(J=>d.jsx("button",{type:"button",className:`btn ${K.duration===J?"btn-primary":"btn-secondary"}`,onClick:()=>ne({...K,duration:J}),style:{padding:"12px 8px",fontSize:"14px",fontWeight:"600"},children:J===.5?"30min":`${J}h`},J))}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[6,8,"custom"].map(J=>d.jsx("button",{type:"button",className:`btn ${J==="custom"?[.5,1,2,4,6,8].includes(K.duration)?"btn-secondary":"btn-primary":K.duration===J?"btn-primary":"btn-secondary"}`,onClick:()=>{if(J==="custom"){const Ee=prompt("Enter duration in hours (e.g., 1.5):");Ee&&!isNaN(parseFloat(Ee))&&ne({...K,duration:parseFloat(Ee)})}else ne({...K,duration:J})},style:{padding:"12px 8px",fontSize:"14px",fontWeight:"600"},children:J==="custom"?"Other":`${J}h`},J))}),![.5,1,2,4,6,8].includes(K.duration)&&d.jsxs("div",{style:{marginTop:"12px",padding:"8px 12px",background:"var(--brand-primary-light)",borderRadius:"6px",textAlign:"center",fontSize:"14px",fontWeight:"600",color:"var(--brand-primary)"},children:[K.duration,"h selected"]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"Project"}),d.jsxs("select",{value:K.project,onChange:J=>ne({...K,project:J.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"},children:[d.jsx("option",{value:"",children:"Select project..."}),e.filter(J=>J.active).map(J=>d.jsx("option",{value:J.name,children:J.name},J.id))]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"When did this happen?"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Date"}),d.jsx("input",{type:"date",value:K.date,onChange:J=>xe({date:J.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Start Time"}),d.jsx("input",{type:"time",value:K.startTime,onChange:J=>ne({...K,startTime:J.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"}})]})]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"What did you work on?"}),d.jsx("textarea",{value:K.description,onChange:J=>ne({...K,description:J.target.value}),className:"form-input",rows:2,placeholder:"Brief description of work completed...",required:!0,style:{fontSize:"14px"}})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"600",marginBottom:"12px"},children:[d.jsx("input",{type:"checkbox",checked:K.createSeries||!1,onChange:J=>ne({...K,createSeries:J.target.checked})}),d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("polyline",{points:"23,4 23,10 17,10"}),d.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),"Create recurring entries"]}),K.createSeries&&d.jsxs("div",{style:{padding:"16px",background:"var(--brand-primary-light)",borderRadius:"8px",border:"1px solid var(--brand-primary)"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Frequency"}),d.jsxs("select",{value:K.frequency||"weekly",onChange:J=>ne({...K,frequency:J.target.value}),className:"form-input",style:{fontSize:"14px"},children:[d.jsx("option",{value:"daily",children:"Daily"}),d.jsx("option",{value:"weekly",children:"Weekly"}),d.jsx("option",{value:"monthly",children:"Monthly"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Count"}),d.jsx("input",{type:"number",min:"2",max:"52",value:K.repeatCount||4,onChange:J=>ne({...K,repeatCount:parseInt(J.target.value)||4}),className:"form-input",style:{fontSize:"14px"}})]}),d.jsx("div",{style:{display:"flex",alignItems:"end"},children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:K.skipWeekends||!0,onChange:J=>ne({...K,skipWeekends:J.target.checked})}),"Skip weekends"]})})]}),d.jsxs("div",{style:{fontSize:"13px",color:"var(--brand-primary)",fontWeight:"500",textAlign:"center"},children:["Will create ",K.repeatCount||4," entries ",K.frequency==="daily"?"daily":K.frequency==="weekly"?"weekly":"monthly",K.skipWeekends?", skipping weekends":""]})]})]}),d.jsxs("details",{style:{marginBottom:"20px"},children:[d.jsxs("summary",{style:{cursor:"pointer",fontSize:"14px",color:"var(--text-secondary)",marginBottom:"12px"},children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),"Additional Options"]}),d.jsx("div",{style:{padding:"12px",background:"var(--background-secondary)",borderRadius:"8px"},children:d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:K.billable,onChange:J=>ne({...K,billable:J.target.checked})}),"Billable to client"]})})})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{type:"button",className:"btn btn-secondary",onClick:He,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"btn btn-primary",style:{fontSize:"16px",padding:"12px 24px"},children:[d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:d.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Create Entry"]})]})]})})]})}),C&&E&&d.jsx("div",{className:"modal-overlay",onClick:_e,children:d.jsxs("div",{className:"modal-content duplicate-modal",onClick:J=>J.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:"🔄 Create Recurring Time Entries"}),d.jsx("button",{className:"modal-close",onClick:_e,disabled:L,children:"×"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{className:"duplicate-preview-card",children:[d.jsxs("div",{className:"preview-header",children:[d.jsx("span",{className:"preview-icon",children:"📋"}),d.jsxs("div",{children:[d.jsxs("h4",{className:"preview-title",children:[E.project," • ",E.client]}),d.jsxs("div",{className:"preview-details",children:[new Date(E.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"})," • ",_m(E.startTime,E.endTime)," • ",Y(E.duration)]})]})]}),d.jsx("div",{className:"preview-description",children:E.description})]}),d.jsxs("div",{className:"duplicate-settings",children:[d.jsxs("div",{className:"settings-grid",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"🔄 Frequency"}),d.jsxs("select",{value:D.frequency,onChange:J=>z({...D,frequency:J.target.value}),className:"form-input",disabled:L,children:[d.jsx("option",{value:"daily",children:"📅 Daily"}),d.jsx("option",{value:"weekly",children:"📆 Weekly"}),d.jsx("option",{value:"monthly",children:"🗓️ Monthly"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:"📊 Count"}),d.jsxs("div",{className:"count-input-wrapper",children:[d.jsx("input",{type:"number",min:"1",max:"52",value:D.count,onChange:J=>z({...D,count:parseInt(J.target.value)||1}),className:"form-input",disabled:L}),d.jsx("span",{className:"count-label",children:"occurrences"})]})]})]}),d.jsx("div",{className:"form-group",children:d.jsxs("label",{className:"checkbox-label",children:[d.jsx("input",{type:"checkbox",checked:D.skipWeekends,onChange:J=>z({...D,skipWeekends:J.target.checked}),disabled:L}),d.jsx("span",{className:"checkbox-text",children:"🚫 Skip weekends (Saturday & Sunday)"})]})})]}),d.jsxs("div",{className:"dates-preview",children:[d.jsx("h4",{className:"preview-section-title",children:"📅 Upcoming dates preview:"}),d.jsxs("div",{className:"dates-list",children:[Me().map((J,Ee)=>d.jsxs("div",{className:"date-item",children:[d.jsx("span",{className:"date-number",children:Ee+1}),d.jsx("span",{className:"date-text",children:J.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]},Ee)),D.count>5&&d.jsxs("div",{className:"date-item more-dates",children:[d.jsx("span",{className:"date-number",children:"..."}),d.jsxs("span",{className:"date-text",children:["+",D.count-5," more dates"]})]})]})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:_e,disabled:L,children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:gt,disabled:L,children:L?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"spinner",children:"⏳"}),"Creating..."]}):d.jsxs(d.Fragment,{children:["✨ Create ",D.count," Duplicates"]})})]})]})})]})},fr=n=>{const e=Math.floor(n),t=Math.round((n-e)*60);return`${e}h ${t}m`},rc=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),ME=({entries:n,projects:e})=>{const[t,i]=W.useState("thisWeek"),[r,o]=W.useState(""),[l,u]=W.useState(""),[f,m]=W.useState([]),[p,v]=W.useState("overview"),x=()=>{const A=new Date;let C,N;switch(t){case"today":C=N=new Date(A);break;case"yesterday":C=N=new Date(A.getTime()-24*60*60*1e3);break;case"thisWeek":const E=new Date(A);E.setDate(A.getDate()-A.getDay()+1),C=E,N=new Date(E.getTime()+4*24*60*60*1e3);break;case"lastWeek":const I=new Date(A);I.setDate(A.getDate()-A.getDay()-6),C=I,N=new Date(I.getTime()+4*24*60*60*1e3);break;case"thisMonth":C=new Date(A.getFullYear(),A.getMonth(),1),N=new Date(A.getFullYear(),A.getMonth()+1,0);break;case"lastMonth":C=new Date(A.getFullYear(),A.getMonth()-1,1),N=new Date(A.getFullYear(),A.getMonth(),0);break;case"custom":C=r?new Date(r):new Date,N=l?new Date(l):new Date;break;default:C=N=A}return{start:C.toISOString().split("T")[0],end:N.toISOString().split("T")[0]}},S=W.useMemo(()=>{const A=x();return n.filter(C=>{const N=C.date,E=N>=A.start&&N<=A.end,I=f.length===0||f.includes(C.project);return E&&I})},[n,t,r,l,f]),_=W.useMemo(()=>{const A=S.reduce((L,H)=>L+H.duration,0),C=S.filter(L=>L.billable).reduce((L,H)=>L+H.duration,0),N=S.filter(L=>L.status==="approved"&&L.billable).reduce((L,H)=>{const K=e.find(xe=>xe.name===H.project),ne=H.rate||K?.rate||0;return L+H.duration*ne},0),E=A>0?C/A*100:0,I=A/Math.max(1,new Set(S.map(L=>L.date)).size),D=S.reduce((L,H)=>{if(L[H.project]||(L[H.project]={hours:0,earnings:0,count:0}),L[H.project].hours+=H.duration,L[H.project].count+=1,H.status==="approved"&&H.billable){const K=e.find(xe=>xe.name===H.project),ne=H.rate||K?.rate||0;L[H.project].earnings+=H.duration*ne}return L},{}),z=S.reduce((L,H)=>(L[H.status]=(L[H.status]||0)+H.duration,L),{});return{totalHours:A,billableHours:C,totalEarnings:N,utilizationRate:E,avgHoursPerDay:I,projectStats:D,statusStats:z,totalEntries:S.length,automatedEntries:S.filter(L=>L.automated).length}},[S,e]),b=()=>{const A=["Date","Start","End","Duration","Client","Project","Description","Status","Billable","Earnings"],C=S.map(D=>{const z=e.find(K=>K.name===D.project),L=D.rate||z?.rate||0,H=D.status==="approved"&&D.billable?D.duration*L:0;return[D.date,D.startTime,D.endTime,D.duration,D.client,D.project,`"${D.description.replace(/"/g,'""')}"`,D.status,D.billable?"Yes":"No",H.toFixed(2)]}),N=[A.join(","),...C.map(D=>D.join(","))].join(`
`),E=new Blob([N],{type:"text/csv"}),I=document.createElement("a");I.href=URL.createObjectURL(E),I.download=`timebeacon-report-${x().start}-to-${x().end}.csv`,I.click()},T=({data:A,title:C,total:N})=>{const E=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];let I=0;return d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{className:"chart-title",children:C}),d.jsxs("div",{className:"donut-chart-wrapper",children:[d.jsxs("svg",{width:"200",height:"200",viewBox:"0 0 200 200",children:[Object.entries(A).sort(([,D],[,z])=>z-D).slice(0,6).map(([D,z],L)=>{const K=z/N*100/100*360,ne=K>180?1:0,xe=I*Math.PI/180,He=(I+K)*Math.PI/180,_e=100+70*Math.cos(xe),ie=100+70*Math.sin(xe),he=100+70*Math.cos(He),Ne=100+70*Math.sin(He),Be=["M 100 100",`L ${_e} ${ie}`,`A 70 70 0 ${ne} 1 ${he} ${Ne}`,"Z"].join(" ");return I+=K,d.jsx("path",{d:Be,fill:E[L%E.length],stroke:"white",strokeWidth:"2"},D)}),d.jsx("circle",{cx:"100",cy:"100",r:"35",fill:"white"}),d.jsx("text",{x:"100",y:"95",textAnchor:"middle",fontSize:"14",fontWeight:"bold",children:fr(N)}),d.jsx("text",{x:"100",y:"110",textAnchor:"middle",fontSize:"12",fill:"#666",children:"Total"})]}),d.jsx("div",{className:"chart-legend",children:Object.entries(A).sort(([,D],[,z])=>z-D).slice(0,6).map(([D,z],L)=>d.jsxs("div",{className:"legend-item",children:[d.jsx("div",{className:"legend-color",style:{backgroundColor:E[L%E.length]}}),d.jsx("span",{className:"legend-label",children:D}),d.jsxs("span",{className:"legend-value",children:[fr(z)," (",(z/N*100).toFixed(1),"%)"]})]},D))})]})]})},w=({data:A,title:C,type:N="hours"})=>{const E=Math.max(...Object.values(A).map(D=>N==="hours"?D.hours||D:D.earnings||D)),I=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];return d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{className:"chart-title",children:C}),d.jsx("div",{className:"bar-chart",children:Object.entries(A).sort(([,D],[,z])=>{const L=N==="hours"?D.hours||D:D.earnings||D;return(N==="hours"?z.hours||z:z.earnings||z)-L}).slice(0,8).map(([D,z],L)=>{const H=N==="hours"?z.hours||z:z.earnings||z,K=H/E*150;return d.jsxs("div",{className:"bar-item",children:[d.jsx("div",{className:"bar-label",children:D.length>12?D.substring(0,12)+"...":D}),d.jsx("div",{className:"bar-container",children:d.jsx("div",{className:"bar-fill",style:{height:`${K}px`,backgroundColor:I[L%I.length]}})}),d.jsx("div",{className:"bar-value",children:N==="hours"?fr(H):rc(H)})]},D)})})]})};return d.jsxs("div",{className:"reports-page",children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Reports & Analytics"}),d.jsx("p",{className:"dashboard-subtitle",children:"Comprehensive insights into your time tracking"})]}),d.jsx("div",{className:"header-actions",children:d.jsx("button",{className:"btn btn-secondary",onClick:b,children:"📊 Export CSV"})})]}),d.jsxs("div",{className:"content-card filters-card",children:[d.jsx("div",{className:"card-header",children:d.jsx("h2",{className:"card-title",children:"Filters & Date Range"})}),d.jsxs("div",{className:"filters-content",children:[d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:"Time Period"}),d.jsx("div",{className:"date-range-buttons",children:[{key:"today",label:"Today"},{key:"yesterday",label:"Yesterday"},{key:"thisWeek",label:"This Week"},{key:"lastWeek",label:"Last Week"},{key:"thisMonth",label:"This Month"},{key:"lastMonth",label:"Last Month"},{key:"custom",label:"Custom"}].map(A=>d.jsx("button",{className:`btn ${t===A.key?"btn-primary":"btn-secondary"}`,onClick:()=>i(A.key),children:A.label},A.key))}),t==="custom"&&d.jsxs("div",{className:"custom-date-inputs",children:[d.jsx("input",{type:"date",value:r,onChange:A=>o(A.target.value),className:"form-input"}),d.jsx("span",{children:"to"}),d.jsx("input",{type:"date",value:l,onChange:A=>u(A.target.value),className:"form-input"})]})]}),d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:"Projects"}),d.jsxs("select",{multiple:!0,value:f,onChange:A=>m(Array.from(A.target.selectedOptions,C=>C.value)),className:"form-input projects-select",children:[d.jsx("option",{value:"",children:"All Projects"}),e.map(A=>d.jsxs("option",{value:A.name,children:[A.name," (",A.client,")"]},A.name))]}),d.jsx("small",{children:"Hold Ctrl/Cmd to select multiple projects"})]})]})]}),d.jsxs("div",{className:"metrics-grid",children:[d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:"⏱️"}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:fr(_.totalHours)}),d.jsx("div",{className:"metric-label",children:"Total Hours"}),d.jsxs("div",{className:"metric-detail",children:[_.totalEntries," entries"]})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:"💰"}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:rc(_.totalEarnings)}),d.jsx("div",{className:"metric-label",children:"Total Earnings"}),d.jsxs("div",{className:"metric-detail",children:[fr(_.billableHours)," billable"]})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:"📈"}),d.jsxs("div",{className:"metric-content",children:[d.jsxs("div",{className:"metric-value",children:[_.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"metric-label",children:"Utilization Rate"}),d.jsx("div",{className:"metric-detail",children:"Billable vs total time"})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:"📅"}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:fr(_.avgHoursPerDay)}),d.jsx("div",{className:"metric-label",children:"Avg. Hours/Day"}),d.jsxs("div",{className:"metric-detail",children:[_.automatedEntries," automated"]})]})]})]}),d.jsx("div",{className:"chart-navigation",children:[{key:"overview",label:"📊 Overview",desc:"Key metrics and summaries"},{key:"projects",label:"📁 Projects",desc:"Time breakdown by project"},{key:"status",label:"✅ Status",desc:"Entry status analysis"},{key:"trends",label:"📈 Trends",desc:"Daily and weekly patterns"},{key:"utilization",label:"⚖️ Utilization",desc:"Billable vs non-billable"}].map(A=>d.jsxs("button",{className:`chart-nav-btn ${p===A.key?"active":""}`,onClick:()=>v(A.key),children:[d.jsx("div",{className:"chart-nav-label",children:A.label}),d.jsx("div",{className:"chart-nav-desc",children:A.desc})]},A.key))}),d.jsxs("div",{className:"chart-display-area",children:[p==="overview"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(T,{data:Object.fromEntries(Object.entries(_.projectStats).map(([A,C])=>[A,C.hours])),title:"Hours by Project",total:_.totalHours}),d.jsx(w,{data:_.projectStats,title:"Earnings by Project",type:"currency"})]}),p==="projects"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(w,{data:_.projectStats,title:"Hours by Project",type:"hours"}),d.jsxs("div",{className:"project-details-table",children:[d.jsx("h3",{children:"Project Details"}),d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Hours"}),d.jsx("th",{children:"Entries"}),d.jsx("th",{children:"Earnings"}),d.jsx("th",{children:"Avg Rate"})]})}),d.jsx("tbody",{children:Object.entries(_.projectStats).sort(([,A],[,C])=>C.hours-A.hours).map(([A,C])=>d.jsxs("tr",{children:[d.jsx("td",{children:A}),d.jsx("td",{children:fr(C.hours)}),d.jsx("td",{children:C.count}),d.jsx("td",{children:rc(C.earnings)}),d.jsx("td",{children:C.hours>0?rc(C.earnings/C.hours):"$0"})]},A))})]})]})]}),p==="status"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(T,{data:_.statusStats,title:"Hours by Status",total:_.totalHours}),d.jsxs("div",{className:"status-details",children:[d.jsx("h3",{children:"Status Breakdown"}),d.jsx("div",{className:"status-cards",children:Object.entries(_.statusStats).sort(([,A],[,C])=>C-A).map(([A,C])=>d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-name",children:A.charAt(0).toUpperCase()+A.slice(1)}),d.jsx("div",{className:"status-hours",children:fr(C)}),d.jsxs("div",{className:"status-percentage",children:[(C/_.totalHours*100).toFixed(1),"%"]})]},A))})]})]}),p==="utilization"&&d.jsxs("div",{className:"utilization-analysis",children:[d.jsxs("div",{className:"utilization-overview",children:[d.jsx("div",{className:"utilization-gauge",children:d.jsx("div",{className:"gauge-container",children:d.jsx("div",{className:"gauge-fill",style:{background:`conic-gradient(#3b82f6 0deg ${_.utilizationRate/100*360}deg, #e5e7eb ${_.utilizationRate/100*360}deg 360deg)`},children:d.jsxs("div",{className:"gauge-center",children:[d.jsxs("div",{className:"gauge-value",children:[_.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"gauge-label",children:"Utilization"})]})})})}),d.jsxs("div",{className:"utilization-breakdown",children:[d.jsxs("div",{className:"breakdown-item billable",children:[d.jsx("div",{className:"breakdown-color"}),d.jsx("div",{className:"breakdown-label",children:"Billable Hours"}),d.jsx("div",{className:"breakdown-value",children:fr(_.billableHours)})]}),d.jsxs("div",{className:"breakdown-item non-billable",children:[d.jsx("div",{className:"breakdown-color"}),d.jsx("div",{className:"breakdown-label",children:"Non-billable Hours"}),d.jsx("div",{className:"breakdown-value",children:fr(_.totalHours-_.billableHours)})]})]})]}),d.jsxs("div",{className:"utilization-tips",children:[d.jsx("h4",{children:"💡 Optimization Tips"}),d.jsxs("div",{className:"tips-list",children:[_.utilizationRate<60&&d.jsx("div",{className:"tip warning",children:"⚠️ Low utilization rate. Consider focusing more time on billable client work."}),_.utilizationRate>=80&&d.jsx("div",{className:"tip success",children:"✅ Excellent utilization rate! You're maximizing billable time."}),_.automatedEntries/_.totalEntries>.7&&d.jsxs("div",{className:"tip info",children:["🤖 Great automation usage! ",(_.automatedEntries/_.totalEntries*100).toFixed(0),"% of entries are automated."]})]})]})]})]}),d.jsxs("div",{className:"content-card data-table-card",children:[d.jsx("div",{className:"card-header",children:d.jsxs("h2",{className:"card-title",children:["Time Entries (",S.length,")"]})}),d.jsxs("div",{className:"table-container",children:[d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Time"}),d.jsx("th",{children:"Duration"}),d.jsx("th",{children:"Client"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Billable"}),d.jsx("th",{children:"Earnings"})]})}),d.jsx("tbody",{children:S.sort((A,C)=>new Date(C.date+" "+C.startTime).getTime()-new Date(A.date+" "+A.startTime).getTime()).slice(0,100).map((A,C)=>{const N=e.find(D=>D.name===A.project),E=A.rate||N?.rate||0,I=A.status==="approved"&&A.billable?A.duration*E:0;return d.jsxs("tr",{children:[d.jsx("td",{children:new Date(A.date).toLocaleDateString()}),d.jsxs("td",{className:"time-cell",children:[A.startTime," - ",A.endTime]}),d.jsx("td",{children:fr(A.duration)}),d.jsx("td",{children:A.client}),d.jsx("td",{children:A.project}),d.jsx("td",{className:"description-cell",children:A.description}),d.jsx("td",{children:d.jsx("span",{className:`status-badge status-${A.status}`,children:A.status})}),d.jsx("td",{children:d.jsx("span",{className:`billable-badge ${A.billable?"billable":"non-billable"}`,children:A.billable?"Yes":"No"})}),d.jsx("td",{children:rc(I)})]},A.id||C)})})]}),S.length>100&&d.jsxs("div",{className:"table-footer",children:["Showing first 100 of ",S.length," entries. Export to CSV for complete data."]})]})]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Gc(n){return n+.5|0}const Ya=(n,e,t)=>Math.max(Math.min(n,t),e);function hc(n){return Ya(Gc(n*2.55),0,255)}function Za(n){return Ya(Gc(n*255),0,255)}function sa(n){return Ya(Gc(n/2.55)/100,0,1)}function Hv(n){return Ya(Gc(n*100),0,100)}const Qi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Xm=[..."0123456789ABCDEF"],RE=n=>Xm[n&15],LE=n=>Xm[(n&240)>>4]+Xm[n&15],sd=n=>(n&240)>>4===(n&15),IE=n=>sd(n.r)&&sd(n.g)&&sd(n.b)&&sd(n.a);function PE(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Qi[n[1]]*17,g:255&Qi[n[2]]*17,b:255&Qi[n[3]]*17,a:e===5?Qi[n[4]]*17:255}:(e===7||e===9)&&(t={r:Qi[n[1]]<<4|Qi[n[2]],g:Qi[n[3]]<<4|Qi[n[4]],b:Qi[n[5]]<<4|Qi[n[6]],a:e===9?Qi[n[7]]<<4|Qi[n[8]]:255})),t}const BE=(n,e)=>n<255?e(n):"";function FE(n){var e=IE(n)?RE:LE;return n?"#"+e(n.r)+e(n.g)+e(n.b)+BE(n.a,e):void 0}const UE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function db(n,e,t){const i=e*Math.min(t,1-t),r=(o,l=(o+n/30)%12)=>t-i*Math.max(Math.min(l-3,9-l,1),-1);return[r(0),r(8),r(4)]}function zE(n,e,t){const i=(r,o=(r+n/60)%6)=>t-t*e*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function HE(n,e,t){const i=db(n,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)i[r]*=1-e-t,i[r]+=e;return i}function WE(n,e,t,i,r){return n===r?(e-t)/i+(e<t?6:0):e===r?(t-n)/i+2:(n-e)/i+4}function pp(n){const t=n.r/255,i=n.g/255,r=n.b/255,o=Math.max(t,i,r),l=Math.min(t,i,r),u=(o+l)/2;let f,m,p;return o!==l&&(p=o-l,m=u>.5?p/(2-o-l):p/(o+l),f=WE(t,i,r,p,o),f=f*60+.5),[f|0,m||0,u]}function gp(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(Za)}function vp(n,e,t){return gp(db,n,e,t)}function VE(n,e,t){return gp(HE,n,e,t)}function GE(n,e,t){return gp(zE,n,e,t)}function fb(n){return(n%360+360)%360}function YE(n){const e=UE.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?hc(+e[5]):Za(+e[5]));const r=fb(+e[2]),o=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?i=VE(r,o,l):e[1]==="hsv"?i=GE(r,o,l):i=vp(r,o,l),{r:i[0],g:i[1],b:i[2],a:t}}function XE(n,e){var t=pp(n);t[0]=fb(t[0]+e),t=vp(t),n.r=t[0],n.g=t[1],n.b=t[2]}function $E(n){if(!n)return;const e=pp(n),t=e[0],i=Hv(e[1]),r=Hv(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${r}%, ${sa(n.a)})`:`hsl(${t}, ${i}%, ${r}%)`}const Wv={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Vv={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qE(){const n={},e=Object.keys(Vv),t=Object.keys(Wv);let i,r,o,l,u;for(i=0;i<e.length;i++){for(l=u=e[i],r=0;r<t.length;r++)o=t[r],u=u.replace(o,Wv[o]);o=parseInt(Vv[l],16),n[u]=[o>>16&255,o>>8&255,o&255]}return n}let od;function KE(n){od||(od=qE(),od.transparent=[0,0,0,0]);const e=od[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const ZE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function QE(n){const e=ZE.exec(n);let t=255,i,r,o;if(e){if(e[7]!==i){const l=+e[7];t=e[8]?hc(l):Ya(l*255,0,255)}return i=+e[1],r=+e[3],o=+e[5],i=255&(e[2]?hc(i):Ya(i,0,255)),r=255&(e[4]?hc(r):Ya(r,0,255)),o=255&(e[6]?hc(o):Ya(o,0,255)),{r:i,g:r,b:o,a:t}}}function JE(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${sa(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const wm=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Mo=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function e4(n,e,t){const i=Mo(sa(n.r)),r=Mo(sa(n.g)),o=Mo(sa(n.b));return{r:Za(wm(i+t*(Mo(sa(e.r))-i))),g:Za(wm(r+t*(Mo(sa(e.g))-r))),b:Za(wm(o+t*(Mo(sa(e.b))-o))),a:n.a+t*(e.a-n.a)}}function ld(n,e,t){if(n){let i=pp(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=vp(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function hb(n,e){return n&&Object.assign(e||{},n)}function Gv(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Za(n[3]))):(e=hb(n,{r:0,g:0,b:0,a:1}),e.a=Za(e.a)),e}function t4(n){return n.charAt(0)==="r"?QE(n):YE(n)}class Cc{constructor(e){if(e instanceof Cc)return e;const t=typeof e;let i;t==="object"?i=Gv(e):t==="string"&&(i=PE(e)||KE(e)||t4(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=hb(this._rgb);return e&&(e.a=sa(e.a)),e}set rgb(e){this._rgb=Gv(e)}rgbString(){return this._valid?JE(this._rgb):void 0}hexString(){return this._valid?FE(this._rgb):void 0}hslString(){return this._valid?$E(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,r=e.rgb;let o;const l=t===o?.5:t,u=2*l-1,f=i.a-r.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;o=1-m,i.r=255&m*i.r+o*r.r+.5,i.g=255&m*i.g+o*r.g+.5,i.b=255&m*i.b+o*r.b+.5,i.a=l*i.a+(1-l)*r.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=e4(this._rgb,e._rgb,t)),this}clone(){return new Cc(this.rgb)}alpha(e){return this._rgb.a=Za(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Gc(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return ld(this._rgb,2,e),this}darken(e){return ld(this._rgb,2,-e),this}saturate(e){return ld(this._rgb,1,e),this}desaturate(e){return ld(this._rgb,1,-e),this}rotate(e){return XE(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function ia(){}const n4=(()=>{let n=0;return()=>n++})();function mt(n){return n==null}function Qt(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function pt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Si(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function jr(n,e){return Si(n)?n:e}function it(n,e){return typeof n>"u"?e:n}const i4=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,mb=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function zt(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function jt(n,e,t,i){let r,o,l;if(Qt(n))for(o=n.length,r=0;r<o;r++)e.call(t,n[r],r);else if(pt(n))for(l=Object.keys(n),o=l.length,r=0;r<o;r++)e.call(t,n[l[r]],l[r])}function Ld(n,e){let t,i,r,o;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(r=n[t],o=e[t],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function Id(n){if(Qt(n))return n.map(Id);if(pt(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let r=0;for(;r<i;++r)e[t[r]]=Id(n[t[r]]);return e}return n}function pb(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function r4(n,e,t,i){if(!pb(n))return;const r=e[n],o=t[n];pt(r)&&pt(o)?jc(r,o,i):e[n]=Id(o)}function jc(n,e,t){const i=Qt(e)?e:[e],r=i.length;if(!pt(n))return n;t=t||{};const o=t.merger||r4;let l;for(let u=0;u<r;++u){if(l=i[u],!pt(l))continue;const f=Object.keys(l);for(let m=0,p=f.length;m<p;++m)o(f[m],n,l,t)}return n}function vc(n,e){return jc(n,e,{merger:a4})}function a4(n,e,t){if(!pb(n))return;const i=e[n],r=t[n];pt(i)&&pt(r)?vc(i,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Id(r))}const Yv={"":n=>n,x:n=>n.x,y:n=>n.y};function s4(n){const e=n.split("."),t=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function o4(n){const e=s4(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function Qa(n,e){return(Yv[e]||(Yv[e]=o4(e)))(n)}function yp(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Dc=n=>typeof n<"u",Ja=n=>typeof n=="function",Xv=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function l4(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Tt=Math.PI,Yt=2*Tt,c4=Yt+Tt,Pd=Number.POSITIVE_INFINITY,u4=Tt/180,cn=Tt/2,js=Tt/4,$v=Tt*2/3,gb=Math.log10,Ir=Math.sign;function yc(n,e,t){return Math.abs(n-e)<t}function qv(n){const e=Math.round(n);n=yc(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(gb(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function d4(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((r,o)=>r-o).pop(),e}function f4(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Nc(n){return!f4(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function h4(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function m4(n,e,t){let i,r,o;for(i=0,r=n.length;i<r;i++)o=n[i][t],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Lr(n){return n*(Tt/180)}function xp(n){return n*(180/Tt)}function Kv(n){if(!Si(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function vb(n,e){const t=e.x-n.x,i=e.y-n.y,r=Math.sqrt(t*t+i*i);let o=Math.atan2(i,t);return o<-.5*Tt&&(o+=Yt),{angle:o,distance:r}}function $m(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function p4(n,e){return(n-e+c4)%Yt-Tt}function yi(n){return(n%Yt+Yt)%Yt}function Oc(n,e,t,i){const r=yi(n),o=yi(e),l=yi(t),u=yi(o-r),f=yi(l-r),m=yi(r-o),p=yi(r-l);return r===o||r===l||i&&o===l||u>f&&m<p}function Kn(n,e,t){return Math.max(e,Math.min(t,n))}function g4(n){return Kn(n,-32768,32767)}function Xa(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function bp(n,e,t){t=t||(l=>n[l]<e);let i=n.length-1,r=0,o;for(;i-r>1;)o=r+i>>1,t(o)?r=o:i=o;return{lo:r,hi:i}}const Ls=(n,e,t,i)=>bp(n,t,i?r=>{const o=n[r][e];return o<t||o===t&&n[r+1][e]===t}:r=>n[r][e]<t),v4=(n,e,t)=>bp(n,t,i=>n[i][e]>=t);function y4(n,e,t){let i=0,r=n.length;for(;i<r&&n[i]<e;)i++;for(;r>i&&n[r-1]>t;)r--;return i>0||r<n.length?n.slice(i,r):n}const yb=["push","pop","shift","splice","unshift"];function x4(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),yb.forEach(t=>{const i="_onData"+yp(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...o){const l=r.apply(this,o);return n._chartjs.listeners.forEach(u=>{typeof u[i]=="function"&&u[i](...o)}),l}})})}function Zv(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(yb.forEach(o=>{delete n[o]}),delete n._chartjs)}function xb(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const bb=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Sb(n,e){let t=[],i=!1;return function(...r){t=r,i||(i=!0,bb.call(window,()=>{i=!1,n.apply(e,t)}))}}function b4(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const Sp=n=>n==="start"?"left":n==="end"?"right":"center",qn=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,S4=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function _4(n,e,t){const i=e.length;let r=0,o=i;if(n._sorted){const{iScale:l,vScale:u,_parsed:f}=n,m=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,p=l.axis,{min:v,max:x,minDefined:S,maxDefined:_}=l.getUserBounds();if(S){if(r=Math.min(Ls(f,p,v).lo,t?i:Ls(e,p,l.getPixelForValue(v)).lo),m){const b=f.slice(0,r+1).reverse().findIndex(T=>!mt(T[u.axis]));r-=Math.max(0,b)}r=Kn(r,0,i-1)}if(_){let b=Math.max(Ls(f,l.axis,x,!0).hi+1,t?0:Ls(e,p,l.getPixelForValue(x),!0).hi+1);if(m){const T=f.slice(b-1).findIndex(w=>!mt(w[u.axis]));b+=Math.max(0,T)}o=Kn(b,r,i)-r}else o=i-r}return{start:r,count:o}}function T4(n){const{xScale:e,yScale:t,_scaleRanges:i}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=r,!0;const o=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,r),o}const cd=n=>n===0||n===1,Qv=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Yt/t)),Jv=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Yt/t)+1,xc={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*cn)+1,easeOutSine:n=>Math.sin(n*cn),easeInOutSine:n=>-.5*(Math.cos(Tt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>cd(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>cd(n)?n:Qv(n,.075,.3),easeOutElastic:n=>cd(n)?n:Jv(n,.075,.3),easeInOutElastic(n){return cd(n)?n:n<.5?.5*Qv(n*2,.1125,.45):.5+.5*Jv(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-xc.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?xc.easeInBounce(n*2)*.5:xc.easeOutBounce(n*2-1)*.5+.5};function _p(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function ey(n){return _p(n)?n:new Cc(n)}function Em(n){return _p(n)?n:new Cc(n).saturate(.5).darken(.1).hexString()}const w4=["x","y","borderWidth","radius","tension"],E4=["color","borderColor","backgroundColor"];function A4(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:E4},numbers:{type:"number",properties:w4}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function k4(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ty=new Map;function C4(n,e){e=e||{};const t=n+JSON.stringify(e);let i=ty.get(t);return i||(i=new Intl.NumberFormat(n,e),ty.set(t,i)),i}function Tp(n,e,t){return C4(e,t).format(n)}const j4={values(n){return Qt(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let r,o=n;if(t.length>1){const m=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(m<1e-4||m>1e15)&&(r="scientific"),o=D4(n,t)}const l=gb(Math.abs(o)),u=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),f={notation:r,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),Tp(n,i,f)}};function D4(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var wp={formatters:j4};function N4(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:wp.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Fs=Object.create(null),qm=Object.create(null);function bc(n,e){if(!e)return n;const t=e.split(".");for(let i=0,r=t.length;i<r;++i){const o=t[i];n=n[o]||(n[o]=Object.create(null))}return n}function Am(n,e,t){return typeof e=="string"?jc(bc(n,e),t):jc(bc(n,""),e)}class O4{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>Em(r.backgroundColor),this.hoverBorderColor=(i,r)=>Em(r.borderColor),this.hoverColor=(i,r)=>Em(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Am(this,e,t)}get(e){return bc(this,e)}describe(e,t){return Am(qm,e,t)}override(e,t){return Am(Fs,e,t)}route(e,t,i,r){const o=bc(this,e),l=bc(this,i),u="_"+t;Object.defineProperties(o,{[u]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const f=this[u],m=l[r];return pt(f)?Object.assign({},m,f):it(f,m)},set(f){this[u]=f}}})}apply(e){e.forEach(t=>t(this))}}var an=new O4({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[A4,k4,N4]);function M4(n){return!n||mt(n.size)||mt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Bd(n,e,t,i,r){let o=e[r];return o||(o=e[r]=n.measureText(r).width,t.push(r)),o>i&&(i=o),i}function R4(n,e,t,i){i=i||{};let r=i.data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},o=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let l=0;const u=t.length;let f,m,p,v,x;for(f=0;f<u;f++)if(v=t[f],v!=null&&!Qt(v))l=Bd(n,r,o,l,v);else if(Qt(v))for(m=0,p=v.length;m<p;m++)x=v[m],x!=null&&!Qt(x)&&(l=Bd(n,r,o,l,x));n.restore();const S=o.length/2;if(S>t.length){for(f=0;f<S;f++)delete r[o[f]];o.splice(0,S)}return l}function Ds(n,e,t){const i=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*i)/i+r}function ny(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function Km(n,e,t,i){_b(n,e,t,i,null)}function _b(n,e,t,i,r){let o,l,u,f,m,p,v,x;const S=e.pointStyle,_=e.rotation,b=e.radius;let T=(_||0)*u4;if(S&&typeof S=="object"&&(o=S.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(T),n.drawImage(S,-S.width/2,-S.height/2,S.width,S.height),n.restore();return}if(!(isNaN(b)||b<=0)){switch(n.beginPath(),S){default:r?n.ellipse(t,i,r/2,b,0,0,Yt):n.arc(t,i,b,0,Yt),n.closePath();break;case"triangle":p=r?r/2:b,n.moveTo(t+Math.sin(T)*p,i-Math.cos(T)*b),T+=$v,n.lineTo(t+Math.sin(T)*p,i-Math.cos(T)*b),T+=$v,n.lineTo(t+Math.sin(T)*p,i-Math.cos(T)*b),n.closePath();break;case"rectRounded":m=b*.516,f=b-m,l=Math.cos(T+js)*f,v=Math.cos(T+js)*(r?r/2-m:f),u=Math.sin(T+js)*f,x=Math.sin(T+js)*(r?r/2-m:f),n.arc(t-v,i-u,m,T-Tt,T-cn),n.arc(t+x,i-l,m,T-cn,T),n.arc(t+v,i+u,m,T,T+cn),n.arc(t-x,i+l,m,T+cn,T+Tt),n.closePath();break;case"rect":if(!_){f=Math.SQRT1_2*b,p=r?r/2:f,n.rect(t-p,i-f,2*p,2*f);break}T+=js;case"rectRot":v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,x=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+x,i-l),n.lineTo(t+v,i+u),n.lineTo(t-x,i+l),n.closePath();break;case"crossRot":T+=js;case"cross":v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,x=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+x,i-l),n.lineTo(t-x,i+l);break;case"star":v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,x=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+x,i-l),n.lineTo(t-x,i+l),T+=js,v=Math.cos(T)*(r?r/2:b),l=Math.cos(T)*b,u=Math.sin(T)*b,x=Math.sin(T)*(r?r/2:b),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+x,i-l),n.lineTo(t-x,i+l);break;case"line":l=r?r/2:Math.cos(T)*b,u=Math.sin(T)*b,n.moveTo(t-l,i-u),n.lineTo(t+l,i+u);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(T)*(r?r/2:b),i+Math.sin(T)*b);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function oa(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Ep(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Ap(n){n.restore()}function L4(n,e,t,i,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){const o=(e.x+t.x)/2;n.lineTo(o,e.y),n.lineTo(o,t.y)}else r==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function I4(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function P4(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),mt(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function B4(n,e,t,i,r){if(r.strikethrough||r.underline){const o=n.measureText(i),l=e-o.actualBoundingBoxLeft,u=e+o.actualBoundingBoxRight,f=t-o.actualBoundingBoxAscent,m=t+o.actualBoundingBoxDescent,p=r.strikethrough?(f+m)/2:m;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(l,p),n.lineTo(u,p),n.stroke()}}function F4(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Us(n,e,t,i,r,o={}){const l=Qt(e)?e:[e],u=o.strokeWidth>0&&o.strokeColor!=="";let f,m;for(n.save(),n.font=r.string,P4(n,o),f=0;f<l.length;++f)m=l[f],o.backdrop&&F4(n,o.backdrop),u&&(o.strokeColor&&(n.strokeStyle=o.strokeColor),mt(o.strokeWidth)||(n.lineWidth=o.strokeWidth),n.strokeText(m,t,i,o.maxWidth)),n.fillText(m,t,i,o.maxWidth),B4(n,t,i,m,o),i+=Number(r.lineHeight);n.restore()}function Mc(n,e){const{x:t,y:i,w:r,h:o,radius:l}=e;n.arc(t+l.topLeft,i+l.topLeft,l.topLeft,1.5*Tt,Tt,!0),n.lineTo(t,i+o-l.bottomLeft),n.arc(t+l.bottomLeft,i+o-l.bottomLeft,l.bottomLeft,Tt,cn,!0),n.lineTo(t+r-l.bottomRight,i+o),n.arc(t+r-l.bottomRight,i+o-l.bottomRight,l.bottomRight,cn,0,!0),n.lineTo(t+r,i+l.topRight),n.arc(t+r-l.topRight,i+l.topRight,l.topRight,0,-cn,!0),n.lineTo(t+l.topLeft,i)}const U4=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,z4=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function H4(n,e){const t=(""+n).match(U4);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const W4=n=>+n||0;function kp(n,e){const t={},i=pt(e),r=i?Object.keys(e):e,o=pt(n)?i?l=>it(n[l],n[e[l]]):l=>n[l]:()=>n;for(const l of r)t[l]=W4(o(l));return t}function Tb(n){return kp(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Is(n){return kp(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Jn(n){const e=Tb(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Tn(n,e){n=n||{},e=e||an.font;let t=it(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=it(n.style,e.style);i&&!(""+i).match(z4)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:it(n.family,e.family),lineHeight:H4(it(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:it(n.weight,e.weight),string:""};return r.string=M4(r),r}function ud(n,e,t,i){let r,o,l;for(r=0,o=n.length;r<o;++r)if(l=n[r],l!==void 0&&l!==void 0)return l}function V4(n,e,t){const{min:i,max:r}=n,o=mb(e,(r-i)/2),l=(u,f)=>t&&u===0?0:u+f;return{min:l(i,-Math.abs(o)),max:l(r,o)}}function is(n,e){return Object.assign(Object.create(n),e)}function Cp(n,e=[""],t,i,r=()=>n[0]){const o=t||n;typeof i>"u"&&(i=kb("_fallback",n));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:o,_fallback:i,_getTarget:r,override:u=>Cp([u,...n],e,o,i)};return new Proxy(l,{deleteProperty(u,f){return delete u[f],delete u._keys,delete n[0][f],!0},get(u,f){return Eb(u,f,()=>Q4(f,e,n,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(u,f){return ry(u).includes(f)},ownKeys(u){return ry(u)},set(u,f,m){const p=u._storage||(u._storage=r());return u[f]=p[f]=m,delete u._keys,!0}})}function Xo(n,e,t,i){const r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:wb(n,i),setContext:o=>Xo(n,o,t,i),override:o=>Xo(n.override(o),e,t,i)};return new Proxy(r,{deleteProperty(o,l){return delete o[l],delete n[l],!0},get(o,l,u){return Eb(o,l,()=>Y4(o,l,u))},getOwnPropertyDescriptor(o,l){return o._descriptors.allKeys?Reflect.has(n,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,l)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(o,l){return Reflect.has(n,l)},ownKeys(){return Reflect.ownKeys(n)},set(o,l,u){return n[l]=u,delete o[l],!0}})}function wb(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:i,isScriptable:Ja(t)?t:()=>t,isIndexable:Ja(i)?i:()=>i}}const G4=(n,e)=>n?n+yp(e):e,jp=(n,e)=>pt(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Eb(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const i=t();return n[e]=i,i}function Y4(n,e,t){const{_proxy:i,_context:r,_subProxy:o,_descriptors:l}=n;let u=i[e];return Ja(u)&&l.isScriptable(e)&&(u=X4(e,u,n,t)),Qt(u)&&u.length&&(u=$4(e,u,n,l.isIndexable)),jp(e,u)&&(u=Xo(u,r,o&&o[e],l)),u}function X4(n,e,t,i){const{_proxy:r,_context:o,_subProxy:l,_stack:u}=t;if(u.has(n))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+n);u.add(n);let f=e(o,l||i);return u.delete(n),jp(n,f)&&(f=Dp(r._scopes,r,n,f)),f}function $4(n,e,t,i){const{_proxy:r,_context:o,_subProxy:l,_descriptors:u}=t;if(typeof o.index<"u"&&i(n))return e[o.index%e.length];if(pt(e[0])){const f=e,m=r._scopes.filter(p=>p!==f);e=[];for(const p of f){const v=Dp(m,r,n,p);e.push(Xo(v,o,l&&l[n],u))}}return e}function Ab(n,e,t){return Ja(n)?n(e,t):n}const q4=(n,e)=>n===!0?e:typeof n=="string"?Qa(e,n):void 0;function K4(n,e,t,i,r){for(const o of e){const l=q4(t,o);if(l){n.add(l);const u=Ab(l._fallback,t,r);if(typeof u<"u"&&u!==t&&u!==i)return u}else if(l===!1&&typeof i<"u"&&t!==i)return null}return!1}function Dp(n,e,t,i){const r=e._rootScopes,o=Ab(e._fallback,t,i),l=[...n,...r],u=new Set;u.add(i);let f=iy(u,l,t,o||t,i);return f===null||typeof o<"u"&&o!==t&&(f=iy(u,l,o,f,i),f===null)?!1:Cp(Array.from(u),[""],r,o,()=>Z4(e,t,i))}function iy(n,e,t,i,r){for(;t;)t=K4(n,e,t,i,r);return t}function Z4(n,e,t){const i=n._getTarget();e in i||(i[e]={});const r=i[e];return Qt(r)&&pt(t)?t:r||{}}function Q4(n,e,t,i){let r;for(const o of e)if(r=kb(G4(o,n),t),typeof r<"u")return jp(n,r)?Dp(t,i,n,r):r}function kb(n,e){for(const t of e){if(!t)continue;const i=t[n];if(typeof i<"u")return i}}function ry(n){let e=n._keys;return e||(e=n._keys=J4(n._scopes)),e}function J4(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}function eA(n,e,t,i){const{iScale:r}=n,{key:o="r"}=this._parsing,l=new Array(i);let u,f,m,p;for(u=0,f=i;u<f;++u)m=u+t,p=e[m],l[u]={r:r.parse(Qa(p,o),m)};return l}const tA=Number.EPSILON||1e-14,$o=(n,e)=>e<n.length&&!n[e].skip&&n[e],Cb=n=>n==="x"?"y":"x";function nA(n,e,t,i){const r=n.skip?e:n,o=e,l=t.skip?e:t,u=$m(o,r),f=$m(l,o);let m=u/(u+f),p=f/(u+f);m=isNaN(m)?0:m,p=isNaN(p)?0:p;const v=i*m,x=i*p;return{previous:{x:o.x-v*(l.x-r.x),y:o.y-v*(l.y-r.y)},next:{x:o.x+x*(l.x-r.x),y:o.y+x*(l.y-r.y)}}}function iA(n,e,t){const i=n.length;let r,o,l,u,f,m=$o(n,0);for(let p=0;p<i-1;++p)if(f=m,m=$o(n,p+1),!(!f||!m)){if(yc(e[p],0,tA)){t[p]=t[p+1]=0;continue}r=t[p]/e[p],o=t[p+1]/e[p],u=Math.pow(r,2)+Math.pow(o,2),!(u<=9)&&(l=3/Math.sqrt(u),t[p]=r*l*e[p],t[p+1]=o*l*e[p])}}function rA(n,e,t="x"){const i=Cb(t),r=n.length;let o,l,u,f=$o(n,0);for(let m=0;m<r;++m){if(l=u,u=f,f=$o(n,m+1),!u)continue;const p=u[t],v=u[i];l&&(o=(p-l[t])/3,u[`cp1${t}`]=p-o,u[`cp1${i}`]=v-o*e[m]),f&&(o=(f[t]-p)/3,u[`cp2${t}`]=p+o,u[`cp2${i}`]=v+o*e[m])}}function aA(n,e="x"){const t=Cb(e),i=n.length,r=Array(i).fill(0),o=Array(i);let l,u,f,m=$o(n,0);for(l=0;l<i;++l)if(u=f,f=m,m=$o(n,l+1),!!f){if(m){const p=m[e]-f[e];r[l]=p!==0?(m[t]-f[t])/p:0}o[l]=u?m?Ir(r[l-1])!==Ir(r[l])?0:(r[l-1]+r[l])/2:r[l-1]:r[l]}iA(n,r,o),rA(n,o,e)}function dd(n,e,t){return Math.max(Math.min(n,t),e)}function sA(n,e){let t,i,r,o,l,u=oa(n[0],e);for(t=0,i=n.length;t<i;++t)l=o,o=u,u=t<i-1&&oa(n[t+1],e),o&&(r=n[t],l&&(r.cp1x=dd(r.cp1x,e.left,e.right),r.cp1y=dd(r.cp1y,e.top,e.bottom)),u&&(r.cp2x=dd(r.cp2x,e.left,e.right),r.cp2y=dd(r.cp2y,e.top,e.bottom)))}function oA(n,e,t,i,r){let o,l,u,f;if(e.spanGaps&&(n=n.filter(m=>!m.skip)),e.cubicInterpolationMode==="monotone")aA(n,r);else{let m=i?n[n.length-1]:n[0];for(o=0,l=n.length;o<l;++o)u=n[o],f=nA(m,u,n[Math.min(o+1,l-(i?0:1))%l],e.tension),u.cp1x=f.previous.x,u.cp1y=f.previous.y,u.cp2x=f.next.x,u.cp2y=f.next.y,m=u}e.capBezierPoints&&sA(n,t)}function Np(){return typeof window<"u"&&typeof document<"u"}function Op(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Fd(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const sf=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function lA(n,e){return sf(n).getPropertyValue(e)}const cA=["top","right","bottom","left"];function Ps(n,e,t){const i={};t=t?"-"+t:"";for(let r=0;r<4;r++){const o=cA[r];i[o]=parseFloat(n[e+"-"+o+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const uA=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function dA(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:r,offsetY:o}=i;let l=!1,u,f;if(uA(r,o,n.target))u=r,f=o;else{const m=e.getBoundingClientRect();u=i.clientX-m.left,f=i.clientY-m.top,l=!0}return{x:u,y:f,box:l}}function Os(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,r=sf(t),o=r.boxSizing==="border-box",l=Ps(r,"padding"),u=Ps(r,"border","width"),{x:f,y:m,box:p}=dA(n,t),v=l.left+(p&&u.left),x=l.top+(p&&u.top);let{width:S,height:_}=e;return o&&(S-=l.width+u.width,_-=l.height+u.height),{x:Math.round((f-v)/S*t.width/i),y:Math.round((m-x)/_*t.height/i)}}function fA(n,e,t){let i,r;if(e===void 0||t===void 0){const o=n&&Op(n);if(!o)e=n.clientWidth,t=n.clientHeight;else{const l=o.getBoundingClientRect(),u=sf(o),f=Ps(u,"border","width"),m=Ps(u,"padding");e=l.width-m.width-f.width,t=l.height-m.height-f.height,i=Fd(u.maxWidth,o,"clientWidth"),r=Fd(u.maxHeight,o,"clientHeight")}}return{width:e,height:t,maxWidth:i||Pd,maxHeight:r||Pd}}const fd=n=>Math.round(n*10)/10;function hA(n,e,t,i){const r=sf(n),o=Ps(r,"margin"),l=Fd(r.maxWidth,n,"clientWidth")||Pd,u=Fd(r.maxHeight,n,"clientHeight")||Pd,f=fA(n,e,t);let{width:m,height:p}=f;if(r.boxSizing==="content-box"){const x=Ps(r,"border","width"),S=Ps(r,"padding");m-=S.width+x.width,p-=S.height+x.height}return m=Math.max(0,m-o.width),p=Math.max(0,i?m/i:p-o.height),m=fd(Math.min(m,l,f.maxWidth)),p=fd(Math.min(p,u,f.maxHeight)),m&&!p&&(p=fd(m/2)),(e!==void 0||t!==void 0)&&i&&f.height&&p>f.height&&(p=f.height,m=fd(Math.floor(p*i))),{width:m,height:p}}function ay(n,e,t){const i=e||1,r=Math.floor(n.height*i),o=Math.floor(n.width*i);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const l=n.canvas;return l.style&&(t||!l.style.height&&!l.style.width)&&(l.style.height=`${n.height}px`,l.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||l.height!==r||l.width!==o?(n.currentDevicePixelRatio=i,l.height=r,l.width=o,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const mA=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};Np()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function sy(n,e){const t=lA(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Ms(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function pA(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function gA(n,e,t,i){const r={x:n.cp2x,y:n.cp2y},o={x:e.cp1x,y:e.cp1y},l=Ms(n,r,t),u=Ms(r,o,t),f=Ms(o,e,t),m=Ms(l,u,t),p=Ms(u,f,t);return Ms(m,p,t)}const vA=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},yA=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Ho(n,e,t){return n?vA(e,t):yA()}function jb(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function Db(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function Nb(n){return n==="angle"?{between:Oc,compare:p4,normalize:yi}:{between:Xa,compare:(e,t)=>e-t,normalize:e=>e}}function oy({start:n,end:e,count:t,loop:i,style:r}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:r}}function xA(n,e,t){const{property:i,start:r,end:o}=t,{between:l,normalize:u}=Nb(i),f=e.length;let{start:m,end:p,loop:v}=n,x,S;if(v){for(m+=f,p+=f,x=0,S=f;x<S&&l(u(e[m%f][i]),r,o);++x)m--,p--;m%=f,p%=f}return p<m&&(p+=f),{start:m,end:p,loop:v,style:n.style}}function bA(n,e,t){if(!t)return[n];const{property:i,start:r,end:o}=t,l=e.length,{compare:u,between:f,normalize:m}=Nb(i),{start:p,end:v,loop:x,style:S}=xA(n,e,t),_=[];let b=!1,T=null,w,A,C;const N=()=>f(r,C,w)&&u(r,C)!==0,E=()=>u(o,w)===0||f(o,C,w),I=()=>b||N(),D=()=>!b||E();for(let z=p,L=p;z<=v;++z)A=e[z%l],!A.skip&&(w=m(A[i]),w!==C&&(b=f(w,r,o),T===null&&I()&&(T=u(w,r)===0?z:L),T!==null&&D()&&(_.push(oy({start:T,end:z,loop:x,count:l,style:S})),T=null),L=z,C=w));return T!==null&&_.push(oy({start:T,end:v,loop:x,count:l,style:S})),_}function SA(n,e){const t=[],i=n.segments;for(let r=0;r<i.length;r++){const o=bA(i[r],n.points,e);o.length&&t.push(...o)}return t}function _A(n,e,t,i){let r=0,o=e-1;if(t&&!i)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(o+=r);o>r&&n[o%e].skip;)o--;return o%=e,{start:r,end:o}}function TA(n,e,t,i){const r=n.length,o=[];let l=e,u=n[e],f;for(f=e+1;f<=t;++f){const m=n[f%r];m.skip||m.stop?u.skip||(i=!1,o.push({start:e%r,end:(f-1)%r,loop:i}),e=l=m.stop?f:null):(l=f,u.skip&&(e=f)),u=m}return l!==null&&o.push({start:e%r,end:l%r,loop:i}),o}function wA(n,e){const t=n.points,i=n.options.spanGaps,r=t.length;if(!r)return[];const o=!!n._loop,{start:l,end:u}=_A(t,r,o,i);if(i===!0)return ly(n,[{start:l,end:u,loop:o}],t,e);const f=u<l?u+r:u,m=!!n._fullLoop&&l===0&&u===r-1;return ly(n,TA(t,l,f,m),t,e)}function ly(n,e,t,i){return!i||!i.setContext||!t?e:EA(n,e,t,i)}function EA(n,e,t,i){const r=n._chart.getContext(),o=cy(n.options),{_datasetIndex:l,options:{spanGaps:u}}=n,f=t.length,m=[];let p=o,v=e[0].start,x=v;function S(_,b,T,w){const A=u?-1:1;if(_!==b){for(_+=f;t[_%f].skip;)_-=A;for(;t[b%f].skip;)b+=A;_%f!==b%f&&(m.push({start:_%f,end:b%f,loop:T,style:w}),p=w,v=b%f)}}for(const _ of e){v=u?v:_.start;let b=t[v%f],T;for(x=v+1;x<=_.end;x++){const w=t[x%f];T=cy(i.setContext(is(r,{type:"segment",p0:b,p1:w,p0DataIndex:(x-1)%f,p1DataIndex:x%f,datasetIndex:l}))),AA(T,p)&&S(v,x-1,_.loop,p),b=w,p=T}v<x-1&&S(v,x-1,_.loop,p)}return m}function cy(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function AA(n,e){if(!e)return!1;const t=[],i=function(r,o){return _p(o)?(t.includes(o)||t.push(o),t.indexOf(o)):o};return JSON.stringify(n,i)!==JSON.stringify(e,i)}function hd(n,e,t){return n.options.clip?n[t]:e[t]}function kA(n,e){const{xScale:t,yScale:i}=n;return t&&i?{left:hd(t,e,"left"),right:hd(t,e,"right"),top:hd(i,e,"top"),bottom:hd(i,e,"bottom")}:e}function CA(n,e){const t=e._clip;if(t.disabled)return!1;const i=kA(e,n.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:i.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class jA{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,r){const o=t.listeners[r],l=t.duration;o.forEach(u=>u({chart:e,initial:t.initial,numSteps:l,currentStep:Math.min(i-t.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=bb.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const o=i.items;let l=o.length-1,u=!1,f;for(;l>=0;--l)f=o[l],f._active?(f._total>i.duration&&(i.duration=f._total),f.tick(e),u=!0):(o[l]=o[o.length-1],o.pop());u&&(r.draw(),this._notify(r,i,e,"progress")),o.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),t+=o.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ra=new jA;const uy="transparent",DA={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=ey(n||uy),r=i.valid&&ey(e||uy);return r&&r.valid?r.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class NA{constructor(e,t,i,r){const o=t[i];r=ud([e.to,r,o,e.from]);const l=ud([e.from,o,r]);this._active=!0,this._fn=e.fn||DA[e.type||typeof l],this._easing=xc[e.easing]||xc.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=l,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const r=this._target[this._prop],o=i-this._start,l=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=ud([e.to,t,r,e.from]),this._from=ud([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,r=this._prop,o=this._from,l=this._loop,u=this._to;let f;if(this._active=o!==u&&(l||t<i),!this._active){this._target[r]=u,this._notify(!0);return}if(t<0){this._target[r]=o;return}f=t/i%2,f=l&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[r]=this._fn(o,u,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][t]()}}class Ob{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!pt(e))return;const t=Object.keys(an.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const o=e[r];if(!pt(o))return;const l={};for(const u of t)l[u]=o[u];(Qt(o.properties)&&o.properties||[r]).forEach(u=>{(u===r||!i.has(u))&&i.set(u,l)})})}_animateOptions(e,t){const i=t.options,r=MA(e,i);if(!r)return[];const o=this._createAnimations(r,i);return i.$shared&&OA(e.options.$animations,i).then(()=>{e.options=i},()=>{}),o}_createAnimations(e,t){const i=this._properties,r=[],o=e.$animations||(e.$animations={}),l=Object.keys(t),u=Date.now();let f;for(f=l.length-1;f>=0;--f){const m=l[f];if(m.charAt(0)==="$")continue;if(m==="options"){r.push(...this._animateOptions(e,t));continue}const p=t[m];let v=o[m];const x=i.get(m);if(v)if(x&&v.active()){v.update(x,p,u);continue}else v.cancel();if(!x||!x.duration){e[m]=p;continue}o[m]=v=new NA(x,e,m,p),r.push(v)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return ra.add(this._chart,i),!0}}function OA(n,e){const t=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const o=n[i[r]];o&&o.active()&&t.push(o.wait())}return Promise.all(t)}function MA(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function dy(n,e){const t=n&&n.options||{},i=t.reverse,r=t.min===void 0?e:0,o=t.max===void 0?e:0;return{start:i?o:r,end:i?r:o}}function RA(n,e,t){if(t===!1)return!1;const i=dy(n,t),r=dy(e,t);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function LA(n){let e,t,i,r;return pt(n)?(e=n.top,t=n.right,i=n.bottom,r=n.left):e=t=i=r=n,{top:e,right:t,bottom:i,left:r,disabled:n===!1}}function Mb(n,e){const t=[],i=n._getSortedDatasetMetas(e);let r,o;for(r=0,o=i.length;r<o;++r)t.push(i[r].index);return t}function fy(n,e,t,i={}){const r=n.keys,o=i.mode==="single";let l,u,f,m;if(e===null)return;let p=!1;for(l=0,u=r.length;l<u;++l){if(f=+r[l],f===t){if(p=!0,i.all)continue;break}m=n.values[f],Si(m)&&(o||e===0||Ir(e)===Ir(m))&&(e+=m)}return!p&&!i.all?0:e}function IA(n,e){const{iScale:t,vScale:i}=e,r=t.axis==="x"?"x":"y",o=i.axis==="x"?"x":"y",l=Object.keys(n),u=new Array(l.length);let f,m,p;for(f=0,m=l.length;f<m;++f)p=l[f],u[f]={[r]:p,[o]:n[p]};return u}function km(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function PA(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function BA(n){const{min:e,max:t,minDefined:i,maxDefined:r}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function FA(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function hy(n,e,t,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const o=n[r.index];if(t&&o>0||!t&&o<0)return r.index}return null}function my(n,e){const{chart:t,_cachedMeta:i}=n,r=t._stacks||(t._stacks={}),{iScale:o,vScale:l,index:u}=i,f=o.axis,m=l.axis,p=PA(o,l,i),v=e.length;let x;for(let S=0;S<v;++S){const _=e[S],{[f]:b,[m]:T}=_,w=_._stacks||(_._stacks={});x=w[m]=FA(r,p,b),x[u]=T,x._top=hy(x,l,!0,i.type),x._bottom=hy(x,l,!1,i.type);const A=x._visualValues||(x._visualValues={});A[u]=T}}function Cm(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function UA(n,e){return is(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function zA(n,e,t){return is(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function ac(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const r of e){const o=r._stacks;if(!o||o[i]===void 0||o[i][t]===void 0)return;delete o[i][t],o[i]._visualValues!==void 0&&o[i]._visualValues[t]!==void 0&&delete o[i]._visualValues[t]}}}const jm=n=>n==="reset"||n==="none",py=(n,e)=>e?n:Object.assign({},n),HA=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:Mb(t,!0),values:null};class Yc{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=km(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&ac(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),r=(v,x,S,_)=>v==="x"?x:v==="r"?_:S,o=t.xAxisID=it(i.xAxisID,Cm(e,"x")),l=t.yAxisID=it(i.yAxisID,Cm(e,"y")),u=t.rAxisID=it(i.rAxisID,Cm(e,"r")),f=t.indexAxis,m=t.iAxisID=r(f,o,l,u),p=t.vAxisID=r(f,l,o,u);t.xScale=this.getScaleForId(o),t.yScale=this.getScaleForId(l),t.rScale=this.getScaleForId(u),t.iScale=this.getScaleForId(m),t.vScale=this.getScaleForId(p)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Zv(this._data,this),e._stacked&&ac(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(pt(t)){const r=this._cachedMeta;this._data=IA(t,r)}else if(i!==t){if(i){Zv(i,this);const r=this._cachedMeta;ac(r),r._parsed=[]}t&&Object.isExtensible(t)&&x4(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const o=t._stacked;t._stacked=km(t.vScale,t),t.stack!==i.stack&&(r=!0,ac(t),t.stack=i.stack),this._resyncElements(e),(r||o!==t._stacked)&&(my(this,t._parsed),t._stacked=km(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:r}=this,{iScale:o,_stacked:l}=i,u=o.axis;let f=e===0&&t===r.length?!0:i._sorted,m=e>0&&i._parsed[e-1],p,v,x;if(this._parsing===!1)i._parsed=r,i._sorted=!0,x=r;else{Qt(r[e])?x=this.parseArrayData(i,r,e,t):pt(r[e])?x=this.parseObjectData(i,r,e,t):x=this.parsePrimitiveData(i,r,e,t);const S=()=>v[u]===null||m&&v[u]<m[u];for(p=0;p<t;++p)i._parsed[p+e]=v=x[p],f&&(S()&&(f=!1),m=v);i._sorted=f}l&&my(this,x)}parsePrimitiveData(e,t,i,r){const{iScale:o,vScale:l}=e,u=o.axis,f=l.axis,m=o.getLabels(),p=o===l,v=new Array(r);let x,S,_;for(x=0,S=r;x<S;++x)_=x+i,v[x]={[u]:p||o.parse(m[_],_),[f]:l.parse(t[_],_)};return v}parseArrayData(e,t,i,r){const{xScale:o,yScale:l}=e,u=new Array(r);let f,m,p,v;for(f=0,m=r;f<m;++f)p=f+i,v=t[p],u[f]={x:o.parse(v[0],p),y:l.parse(v[1],p)};return u}parseObjectData(e,t,i,r){const{xScale:o,yScale:l}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(r);let p,v,x,S;for(p=0,v=r;p<v;++p)x=p+i,S=t[x],m[p]={x:o.parse(Qa(S,u),x),y:l.parse(Qa(S,f),x)};return m}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const r=this.chart,o=this._cachedMeta,l=t[e.axis],u={keys:Mb(r,!0),values:t._stacks[e.axis]._visualValues};return fy(u,l,o.index,{mode:i})}updateRangeFromParsed(e,t,i,r){const o=i[t.axis];let l=o===null?NaN:o;const u=r&&i._stacks[t.axis];r&&u&&(r.values=u,l=fy(r,o,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,t){const i=this._cachedMeta,r=i._parsed,o=i._sorted&&e===i.iScale,l=r.length,u=this._getOtherScale(e),f=HA(t,i,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:p,max:v}=BA(u);let x,S;function _(){S=r[x];const b=S[u.axis];return!Si(S[e.axis])||p>b||v<b}for(x=0;x<l&&!(!_()&&(this.updateRangeFromParsed(m,e,S,f),o));++x);if(o){for(x=l-1;x>=0;--x)if(!_()){this.updateRangeFromParsed(m,e,S,f);break}}return m}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let r,o,l;for(r=0,o=t.length;r<o;++r)l=t[r][e.axis],Si(l)&&i.push(l);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,r=t.vScale,o=this.getParsed(e);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=LA(it(this.options.clip,RA(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,r=i.data||[],o=t.chartArea,l=[],u=this._drawStart||0,f=this._drawCount||r.length-u,m=this.options.drawActiveElementsOnTop;let p;for(i.dataset&&i.dataset.draw(e,o,u,f),p=u;p<u+f;++p){const v=r[p];v.hidden||(v.active&&m?l.push(v):v.draw(e,o))}for(p=0;p<l.length;++p)l[p].draw(e,o)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const r=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];o=l.$context||(l.$context=zA(this.getContext(),e,l)),o.parsed=this.getParsed(e),o.raw=r.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=UA(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=i,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const r=t==="active",o=this._cachedDataOpts,l=e+"-"+t,u=o[l],f=this.enableOptionSharing&&Dc(i);if(u)return py(u,f);const m=this.chart.config,p=m.datasetElementScopeKeys(this._type,e),v=r?[`${e}Hover`,"hover",e,""]:[e,""],x=m.getOptionScopes(this.getDataset(),p),S=Object.keys(an.elements[e]),_=()=>this.getContext(i,r,t),b=m.resolveNamedOptions(x,S,_,v);return b.$shared&&(b.$shared=f,o[l]=Object.freeze(py(b,f))),b}_resolveAnimations(e,t,i){const r=this.chart,o=this._cachedDataOpts,l=`animation-${t}`,u=o[l];if(u)return u;let f;if(r.options.animation!==!1){const p=this.chart.config,v=p.datasetAnimationScopeKeys(this._type,t),x=p.getOptionScopes(this.getDataset(),v);f=p.createResolver(x,this.getContext(e,i,t))}const m=new Ob(r,f&&f.animations);return f&&f._cacheable&&(o[l]=Object.freeze(m)),m}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||jm(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),r=this._sharedOptions,o=this.getSharedOptions(i),l=this.includeOptions(t,o)||o!==r;return this.updateSharedOptions(o,t,i),{sharedOptions:o,includeOptions:l}}updateElement(e,t,i,r){jm(r)?Object.assign(e,i):this._resolveAnimations(t,r).update(e,i)}updateSharedOptions(e,t,i){e&&!jm(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,r){e.active=r;const o=this.getStyle(t,r);this._resolveAnimations(t,i,r).update(e,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];const r=i.length,o=t.length,l=Math.min(o,r);l&&this.parse(0,l),o>r?this._insertElements(r,o-r,e):o<r&&this._removeElements(o,r-o)}_insertElements(e,t,i=!0){const r=this._cachedMeta,o=r.data,l=e+t;let u;const f=m=>{for(m.length+=t,u=m.length-1;u>=l;u--)m[u]=m[u-t]};for(f(o),u=e;u<l;++u)o[u]=new this.dataElementType;this._parsing&&f(r._parsed),this.parse(e,t),i&&this.updateElements(o,e,t,"reset")}updateElements(e,t,i,r){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,t);i._stacked&&ac(i,r)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,r]=e;this[t](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function WA(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let r=0,o=t.length;r<o;r++)i=i.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=xb(i.sort((r,o)=>r-o))}return n._cache.$bar}function VA(n){const e=n.iScale,t=WA(e,n.type);let i=e._length,r,o,l,u;const f=()=>{l===32767||l===-32768||(Dc(u)&&(i=Math.min(i,Math.abs(l-u)||i)),u=l)};for(r=0,o=t.length;r<o;++r)l=e.getPixelForValue(t[r]),f();for(u=void 0,r=0,o=e.ticks.length;r<o;++r)l=e.getPixelForTick(r),f();return i}function GA(n,e,t,i){const r=t.barThickness;let o,l;return mt(r)?(o=e.min*t.categoryPercentage,l=t.barPercentage):(o=r*i,l=1),{chunk:o/i,ratio:l,start:e.pixels[n]-o/2}}function YA(n,e,t,i){const r=e.pixels,o=r[n];let l=n>0?r[n-1]:null,u=n<r.length-1?r[n+1]:null;const f=t.categoryPercentage;l===null&&(l=o-(u===null?e.end-e.start:u-o)),u===null&&(u=o+o-l);const m=o-(o-Math.min(l,u))/2*f;return{chunk:Math.abs(u-l)/2*f/i,ratio:t.barPercentage,start:m}}function XA(n,e,t,i){const r=t.parse(n[0],i),o=t.parse(n[1],i),l=Math.min(r,o),u=Math.max(r,o);let f=l,m=u;Math.abs(l)>Math.abs(u)&&(f=u,m=l),e[t.axis]=m,e._custom={barStart:f,barEnd:m,start:r,end:o,min:l,max:u}}function Rb(n,e,t,i){return Qt(n)?XA(n,e,t,i):e[t.axis]=t.parse(n,i),e}function gy(n,e,t,i){const r=n.iScale,o=n.vScale,l=r.getLabels(),u=r===o,f=[];let m,p,v,x;for(m=t,p=t+i;m<p;++m)x=e[m],v={},v[r.axis]=u||r.parse(l[m],m),f.push(Rb(x,v,o,m));return f}function Dm(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function $A(n,e,t){return n!==0?Ir(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function qA(n){let e,t,i,r,o;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(r="end",o="start"):(r="start",o="end"),{start:t,end:i,reverse:e,top:r,bottom:o}}function KA(n,e,t,i){let r=e.borderSkipped;const o={};if(!r){n.borderSkipped=o;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:u,reverse:f,top:m,bottom:p}=qA(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?r=m:(t._bottom||0)===i?r=p:(o[vy(p,l,u,f)]=!0,r=m)),o[vy(r,l,u,f)]=!0,n.borderSkipped=o}function vy(n,e,t,i){return i?(n=ZA(n,e,t),n=yy(n,t,e)):n=yy(n,e,t),n}function ZA(n,e,t){return n===e?t:n===t?e:n}function yy(n,e,t){return n==="start"?e:n==="end"?t:n}function QA(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class JA extends Yc{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,i,r){return gy(e,t,i,r)}parseArrayData(e,t,i,r){return gy(e,t,i,r)}parseObjectData(e,t,i,r){const{iScale:o,vScale:l}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=o.axis==="x"?u:f,p=l.axis==="x"?u:f,v=[];let x,S,_,b;for(x=i,S=i+r;x<S;++x)b=t[x],_={},_[o.axis]=o.parse(Qa(b,m),x),v.push(Rb(Qa(b,p),_,l,x));return v}updateRangeFromParsed(e,t,i,r){super.updateRangeFromParsed(e,t,i,r);const o=i._custom;o&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:r}=t,o=this.getParsed(e),l=o._custom,u=Dm(l)?"["+l.start+", "+l.end+"]":""+r.getLabelForValue(o[r.axis]);return{label:""+i.getLabelForValue(o[i.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,r){const o=r==="reset",{index:l,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),p=this._getRuler(),{sharedOptions:v,includeOptions:x}=this._getSharedOptions(t,r);for(let S=t;S<t+i;S++){const _=this.getParsed(S),b=o||mt(_[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(S),T=this._calculateBarIndexPixels(S,p),w=(_._stacks||{})[u.axis],A={horizontal:m,base:b.base,enableBorderRadius:!w||Dm(_._custom)||l===w._top||l===w._bottom,x:m?b.head:T.center,y:m?T.center:b.head,height:m?T.size:Math.abs(b.size),width:m?Math.abs(b.size):T.size};x&&(A.options=v||this.resolveDataElementOptions(S,e[S].active?"active":r));const C=A.options||e[S].options;KA(A,C,w,l),QA(A,C,p.ratio),this.updateElement(e[S],S,A,r)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(p=>p.controller.options.grouped),o=i.options.stacked,l=[],u=this._cachedMeta.controller.getParsed(t),f=u&&u[i.axis],m=p=>{const v=p._parsed.find(S=>S[i.axis]===f),x=v&&v[p.vScale.axis];if(mt(x)||isNaN(x))return!0};for(const p of r)if(!(t!==void 0&&m(p))&&((o===!1||l.indexOf(p.stack)===-1||o===void 0&&p.stack===void 0)&&l.push(p.stack),p.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(i=>e[i].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)e[it(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,i){const r=this._getStacks(e,i),o=t!==void 0?r.indexOf(t):-1;return o===-1?r.length-1:o}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,r=[];let o,l;for(o=0,l=t.data.length;o<l;++o)r.push(i.getPixelForValue(this.getParsed(o)[i.axis],o));const u=e.barThickness;return{min:u||VA(t),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:r},options:{base:o,minBarLength:l}}=this,u=o||0,f=this.getParsed(e),m=f._custom,p=Dm(m);let v=f[t.axis],x=0,S=i?this.applyStack(t,f,i):v,_,b;S!==v&&(x=S-v,S=v),p&&(v=m.barStart,S=m.barEnd-m.barStart,v!==0&&Ir(v)!==Ir(m.barEnd)&&(x=0),x+=v);const T=!mt(o)&&!p?o:x;let w=t.getPixelForValue(T);if(this.chart.getDataVisibility(e)?_=t.getPixelForValue(x+S):_=w,b=_-w,Math.abs(b)<l){b=$A(b,t,u)*l,v===u&&(w-=b/2);const A=t.getPixelForDecimal(0),C=t.getPixelForDecimal(1),N=Math.min(A,C),E=Math.max(A,C);w=Math.max(Math.min(w,E),N),_=w+b,i&&!p&&(f._stacks[t.axis]._visualValues[r]=t.getValueForPixel(_)-t.getValueForPixel(w))}if(w===t.getPixelForValue(u)){const A=Ir(b)*t.getLineWidthForValue(u)/2;w+=A,b-=A}return{size:b,base:w,head:_,center:_+b/2}}_calculateBarIndexPixels(e,t){const i=t.scale,r=this.options,o=r.skipNull,l=it(r.maxBarThickness,1/0);let u,f;const m=this._getAxisCount();if(t.grouped){const p=o?this._getStackCount(e):t.stackCount,v=r.barThickness==="flex"?YA(e,t,r,p*m):GA(e,t,r,p*m),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,S=this._getAxis().indexOf(it(x,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+S;u=v.start+v.chunk*_+v.chunk/2,f=Math.min(l,v.chunk*v.ratio)}else u=i.getPixelForValue(this.getParsed(e)[i.axis],e),f=Math.min(l,t.min*t.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,r=i.length;let o=0;for(;o<r;++o)this.getParsed(o)[t.axis]!==null&&!i[o].hidden&&i[o].draw(this._ctx)}}function e3(n,e,t){let i=1,r=1,o=0,l=0;if(e<Yt){const u=n,f=u+e,m=Math.cos(u),p=Math.sin(u),v=Math.cos(f),x=Math.sin(f),S=(C,N,E)=>Oc(C,u,f,!0)?1:Math.max(N,N*t,E,E*t),_=(C,N,E)=>Oc(C,u,f,!0)?-1:Math.min(N,N*t,E,E*t),b=S(0,m,v),T=S(cn,p,x),w=_(Tt,m,v),A=_(Tt+cn,p,x);i=(b-w)/2,r=(T-A)/2,o=-(b+w)/2,l=-(T+A)/2}return{ratioX:i,ratioY:r,offsetX:o,offsetY:l}}class t3 extends Yc{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:r}}=e.legend.options;return t.labels.map((o,l)=>{const f=e.getDatasetMeta(0).controller.getStyle(l);return{text:o,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:r,lineWidth:f.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let o=f=>+i[f];if(pt(i[e])){const{key:f="value"}=this._parsing;o=m=>+Qa(i[m],f)}let l,u;for(l=e,u=e+t;l<u;++l)r._parsed[l]=o(l)}}_getRotation(){return Lr(this.options.rotation-90)}_getCircumference(){return Lr(this.options.circumference)}_getRotationExtents(){let e=Yt,t=-Yt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,o=r._getRotation(),l=r._getCircumference();e=Math.min(e,o),t=Math.max(t,o+l)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,r=this._cachedMeta,o=r.data,l=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,u=Math.max((Math.min(i.width,i.height)-l)/2,0),f=Math.min(i4(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:p,rotation:v}=this._getRotationExtents(),{ratioX:x,ratioY:S,offsetX:_,offsetY:b}=e3(v,p,f),T=(i.width-l)/x,w=(i.height-l)/S,A=Math.max(Math.min(T,w)/2,0),C=mb(this.options.radius,A),N=Math.max(C*f,0),E=(C-N)/this._getVisibleDatasetWeightTotal();this.offsetX=_*C,this.offsetY=b*C,r.total=this.calculateTotal(),this.outerRadius=C-E*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-E*m,0),this.updateElements(o,0,o.length,e)}_circumference(e,t){const i=this.options,r=this._cachedMeta,o=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*o/Yt)}updateElements(e,t,i,r){const o=r==="reset",l=this.chart,u=l.chartArea,m=l.options.animation,p=(u.left+u.right)/2,v=(u.top+u.bottom)/2,x=o&&m.animateScale,S=x?0:this.innerRadius,_=x?0:this.outerRadius,{sharedOptions:b,includeOptions:T}=this._getSharedOptions(t,r);let w=this._getRotation(),A;for(A=0;A<t;++A)w+=this._circumference(A,o);for(A=t;A<t+i;++A){const C=this._circumference(A,o),N=e[A],E={x:p+this.offsetX,y:v+this.offsetY,startAngle:w,endAngle:w+C,circumference:C,outerRadius:_,innerRadius:S};T&&(E.options=b||this.resolveDataElementOptions(A,N.active?"active":r)),w+=C,this.updateElement(N,A,E,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,r;for(r=0;r<t.length;r++){const o=e._parsed[r];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(i+=Math.abs(o))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Yt*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],o=Tp(t._parsed[e],i.options.locale);return{label:r[e]||"",value:o}}getMaxBorderWidth(e){let t=0;const i=this.chart;let r,o,l,u,f;if(!e){for(r=0,o=i.data.datasets.length;r<o;++r)if(i.isDatasetVisible(r)){l=i.getDatasetMeta(r),e=l.data,u=l.controller;break}}if(!e)return 0;for(r=0,o=e.length;r<o;++r)f=u.resolveDataElementOptions(r),f.borderAlign!=="inner"&&(t=Math.max(t,f.borderWidth||0,f.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,r=e.length;i<r;++i){const o=this.resolveDataElementOptions(i);t=Math.max(t,o.offset||0,o.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(it(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class n3 extends Yc{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:r=[],_dataset:o}=t,l=this.chart._animationsDisabled;let{start:u,count:f}=_4(t,r,l);this._drawStart=u,this._drawCount=f,T4(t)&&(u=0,f=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=r;const m=this.resolveDatasetElementOptions(e);this.options.showLine||(m.borderWidth=0),m.segment=this.options.segment,this.updateElement(i,void 0,{animated:!l,options:m},e),this.updateElements(r,u,f,e)}updateElements(e,t,i,r){const o=r==="reset",{iScale:l,vScale:u,_stacked:f,_dataset:m}=this._cachedMeta,{sharedOptions:p,includeOptions:v}=this._getSharedOptions(t,r),x=l.axis,S=u.axis,{spanGaps:_,segment:b}=this.options,T=Nc(_)?_:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||o||r==="none",A=t+i,C=e.length;let N=t>0&&this.getParsed(t-1);for(let E=0;E<C;++E){const I=e[E],D=w?I:{};if(E<t||E>=A){D.skip=!0;continue}const z=this.getParsed(E),L=mt(z[S]),H=D[x]=l.getPixelForValue(z[x],E),K=D[S]=o||L?u.getBasePixel():u.getPixelForValue(f?this.applyStack(u,z,f):z[S],E);D.skip=isNaN(H)||isNaN(K)||L,D.stop=E>0&&Math.abs(z[x]-N[x])>T,b&&(D.parsed=z,D.raw=m.data[E]),v&&(D.options=p||this.resolveDataElementOptions(E,I.active?"active":r)),w||this.updateElement(I,E,D,r),N=z}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return i;const o=r[0].size(this.resolveDataElementOptions(0)),l=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,o,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class i3 extends Yc{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,r){return eA.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta,i=t.dataset,r=t.data||[],o=t.iScale.getLabels();if(i.points=r,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const u={_loop:!0,_fullLoop:o.length===r.length,options:l};this.updateElement(i,void 0,u,e)}this.updateElements(r,0,r.length,e)}updateElements(e,t,i,r){const o=this._cachedMeta.rScale,l=r==="reset";for(let u=t;u<t+i;u++){const f=e[u],m=this.resolveDataElementOptions(u,f.active?"active":r),p=o.getPointPositionForValue(u,this.getParsed(u).r),v=l?o.xCenter:p.x,x=l?o.yCenter:p.y,S={x:v,y:x,angle:p.angle,skip:isNaN(v)||isNaN(x),options:m};this.updateElement(f,u,S,r)}}}function Ns(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Mp{static override(e){Object.assign(Mp.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Ns()}parse(){return Ns()}format(){return Ns()}add(){return Ns()}diff(){return Ns()}startOf(){return Ns()}endOf(){return Ns()}}var r3={_date:Mp};function a3(n,e,t,i){const{controller:r,data:o,_sorted:l}=n,u=r._cachedMeta.iScale,f=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(u&&e===u.axis&&e!=="r"&&l&&o.length){const m=u._reversePixels?v4:Ls;if(i){if(r._sharedOptions){const p=o[0],v=typeof p.getRange=="function"&&p.getRange(e);if(v){const x=m(o,e,t-v),S=m(o,e,t+v);return{lo:x.lo,hi:S.hi}}}}else{const p=m(o,e,t);if(f){const{vScale:v}=r._cachedMeta,{_parsed:x}=n,S=x.slice(0,p.lo+1).reverse().findIndex(b=>!mt(b[v.axis]));p.lo-=Math.max(0,S);const _=x.slice(p.hi).findIndex(b=>!mt(b[v.axis]));p.hi+=Math.max(0,_)}return p}}return{lo:0,hi:o.length-1}}function of(n,e,t,i,r){const o=n.getSortedVisibleDatasetMetas(),l=t[e];for(let u=0,f=o.length;u<f;++u){const{index:m,data:p}=o[u],{lo:v,hi:x}=a3(o[u],e,l,r);for(let S=v;S<=x;++S){const _=p[S];_.skip||i(_,m,S)}}}function s3(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,r){const o=e?Math.abs(i.x-r.x):0,l=t?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(l,2))}}function Nm(n,e,t,i,r){const o=[];return!r&&!n.isPointInArea(e)||of(n,t,e,function(u,f,m){!r&&!oa(u,n.chartArea,0)||u.inRange(e.x,e.y,i)&&o.push({element:u,datasetIndex:f,index:m})},!0),o}function o3(n,e,t,i){let r=[];function o(l,u,f){const{startAngle:m,endAngle:p}=l.getProps(["startAngle","endAngle"],i),{angle:v}=vb(l,{x:e.x,y:e.y});Oc(v,m,p)&&r.push({element:l,datasetIndex:u,index:f})}return of(n,t,e,o),r}function l3(n,e,t,i,r,o){let l=[];const u=s3(t);let f=Number.POSITIVE_INFINITY;function m(p,v,x){const S=p.inRange(e.x,e.y,r);if(i&&!S)return;const _=p.getCenterPoint(r);if(!(!!o||n.isPointInArea(_))&&!S)return;const T=u(e,_);T<f?(l=[{element:p,datasetIndex:v,index:x}],f=T):T===f&&l.push({element:p,datasetIndex:v,index:x})}return of(n,t,e,m),l}function Om(n,e,t,i,r,o){return!o&&!n.isPointInArea(e)?[]:t==="r"&&!i?o3(n,e,t,r):l3(n,e,t,i,r,o)}function xy(n,e,t,i,r){const o=[],l=t==="x"?"inXRange":"inYRange";let u=!1;return of(n,t,e,(f,m,p)=>{f[l]&&f[l](e[t],r)&&(o.push({element:f,datasetIndex:m,index:p}),u=u||f.inRange(e.x,e.y,r))}),i&&!u?[]:o}var c3={modes:{index(n,e,t,i){const r=Os(e,n),o=t.axis||"x",l=t.includeInvisible||!1,u=t.intersect?Nm(n,r,o,i,l):Om(n,r,o,!1,i,l),f=[];return u.length?(n.getSortedVisibleDatasetMetas().forEach(m=>{const p=u[0].index,v=m.data[p];v&&!v.skip&&f.push({element:v,datasetIndex:m.index,index:p})}),f):[]},dataset(n,e,t,i){const r=Os(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;let u=t.intersect?Nm(n,r,o,i,l):Om(n,r,o,!1,i,l);if(u.length>0){const f=u[0].datasetIndex,m=n.getDatasetMeta(f).data;u=[];for(let p=0;p<m.length;++p)u.push({element:m[p],datasetIndex:f,index:p})}return u},point(n,e,t,i){const r=Os(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return Nm(n,r,o,i,l)},nearest(n,e,t,i){const r=Os(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return Om(n,r,o,t.intersect,i,l)},x(n,e,t,i){const r=Os(e,n);return xy(n,r,"x",t.intersect,i)},y(n,e,t,i){const r=Os(e,n);return xy(n,r,"y",t.intersect,i)}}};const Lb=["left","top","right","bottom"];function sc(n,e){return n.filter(t=>t.pos===e)}function by(n,e){return n.filter(t=>Lb.indexOf(t.pos)===-1&&t.box.axis===e)}function oc(n,e){return n.sort((t,i)=>{const r=e?i:t,o=e?t:i;return r.weight===o.weight?r.index-o.index:r.weight-o.weight})}function u3(n){const e=[];let t,i,r,o,l,u;for(t=0,i=(n||[]).length;t<i;++t)r=n[t],{position:o,options:{stack:l,stackWeight:u=1}}=r,e.push({index:t,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:l&&o+l,stackWeight:u});return e}function d3(n){const e={};for(const t of n){const{stack:i,pos:r,stackWeight:o}=t;if(!i||!Lb.includes(r))continue;const l=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=o}return e}function f3(n,e){const t=d3(n),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let o,l,u;for(o=0,l=n.length;o<l;++o){u=n[o];const{fullSize:f}=u.box,m=t[u.stack],p=m&&u.stackWeight/m.weight;u.horizontal?(u.width=p?p*i:f&&e.availableWidth,u.height=r):(u.width=i,u.height=p?p*r:f&&e.availableHeight)}return t}function h3(n){const e=u3(n),t=oc(e.filter(m=>m.box.fullSize),!0),i=oc(sc(e,"left"),!0),r=oc(sc(e,"right")),o=oc(sc(e,"top"),!0),l=oc(sc(e,"bottom")),u=by(e,"x"),f=by(e,"y");return{fullSize:t,leftAndTop:i.concat(o),rightAndBottom:r.concat(f).concat(l).concat(u),chartArea:sc(e,"chartArea"),vertical:i.concat(r).concat(f),horizontal:o.concat(l).concat(u)}}function Sy(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function Ib(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function m3(n,e,t,i){const{pos:r,box:o}=t,l=n.maxPadding;if(!pt(r)){t.size&&(n[r]-=t.size);const v=i[t.stack]||{size:0,count:1};v.size=Math.max(v.size,t.horizontal?o.height:o.width),t.size=v.size/v.count,n[r]+=t.size}o.getPadding&&Ib(l,o.getPadding());const u=Math.max(0,e.outerWidth-Sy(l,n,"left","right")),f=Math.max(0,e.outerHeight-Sy(l,n,"top","bottom")),m=u!==n.w,p=f!==n.h;return n.w=u,n.h=f,t.horizontal?{same:m,other:p}:{same:p,other:m}}function p3(n){const e=n.maxPadding;function t(i){const r=Math.max(e[i]-n[i],0);return n[i]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function g3(n,e){const t=e.maxPadding;function i(r){const o={left:0,top:0,right:0,bottom:0};return r.forEach(l=>{o[l]=Math.max(e[l],t[l])}),o}return i(n?["left","right"]:["top","bottom"])}function mc(n,e,t,i){const r=[];let o,l,u,f,m,p;for(o=0,l=n.length,m=0;o<l;++o){u=n[o],f=u.box,f.update(u.width||e.w,u.height||e.h,g3(u.horizontal,e));const{same:v,other:x}=m3(e,t,u,i);m|=v&&r.length,p=p||x,f.fullSize||r.push(u)}return m&&mc(r,e,t,i)||p}function md(n,e,t,i,r){n.top=t,n.left=e,n.right=e+i,n.bottom=t+r,n.width=i,n.height=r}function _y(n,e,t,i){const r=t.padding;let{x:o,y:l}=e;for(const u of n){const f=u.box,m=i[u.stack]||{placed:0,weight:1},p=u.stackWeight/m.weight||1;if(u.horizontal){const v=e.w*p,x=m.size||f.height;Dc(m.start)&&(l=m.start),f.fullSize?md(f,r.left,l,t.outerWidth-r.right-r.left,x):md(f,e.left+m.placed,l,v,x),m.start=l,m.placed+=v,l=f.bottom}else{const v=e.h*p,x=m.size||f.width;Dc(m.start)&&(o=m.start),f.fullSize?md(f,o,r.top,x,t.outerHeight-r.bottom-r.top):md(f,o,e.top+m.placed,x,v),m.start=o,m.placed+=v,o=f.right}}e.x=o,e.y=l}var nr={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const r=Jn(n.options.layout.padding),o=Math.max(e-r.width,0),l=Math.max(t-r.height,0),u=h3(n.boxes),f=u.vertical,m=u.horizontal;jt(n.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const p=f.reduce((b,T)=>T.box.options&&T.box.options.display===!1?b:b+1,0)||1,v=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:o,availableHeight:l,vBoxMaxWidth:o/2/p,hBoxMaxHeight:l/2}),x=Object.assign({},r);Ib(x,Jn(i));const S=Object.assign({maxPadding:x,w:o,h:l,x:r.left,y:r.top},r),_=f3(f.concat(m),v);mc(u.fullSize,S,v,_),mc(f,S,v,_),mc(m,S,v,_)&&mc(f,S,v,_),p3(S),_y(u.leftAndTop,S,v,_),S.x+=S.w,S.y+=S.h,_y(u.rightAndBottom,S,v,_),n.chartArea={left:S.left,top:S.top,right:S.left+S.w,bottom:S.top+S.h,height:S.h,width:S.w},jt(u.chartArea,b=>{const T=b.box;Object.assign(T,n.chartArea),T.update(S.w,S.h,{left:0,top:0,right:0,bottom:0})})}};class Pb{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,r){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):i)}}isAttached(e){return!0}updateConfig(e){}}class v3 extends Pb{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Od="$chartjs",y3={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ty=n=>n===null||n==="";function x3(n,e){const t=n.style,i=n.getAttribute("height"),r=n.getAttribute("width");if(n[Od]={initial:{height:i,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Ty(r)){const o=sy(n,"width");o!==void 0&&(n.width=o)}if(Ty(i))if(n.style.height==="")n.height=n.width/(e||2);else{const o=sy(n,"height");o!==void 0&&(n.height=o)}return n}const Bb=mA?{passive:!0}:!1;function b3(n,e,t){n&&n.addEventListener(e,t,Bb)}function S3(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,Bb)}function _3(n,e){const t=y3[n.type]||n.type,{x:i,y:r}=Os(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:r!==void 0?r:null}}function Ud(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function T3(n,e,t){const i=n.canvas,r=new MutationObserver(o=>{let l=!1;for(const u of o)l=l||Ud(u.addedNodes,i),l=l&&!Ud(u.removedNodes,i);l&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function w3(n,e,t){const i=n.canvas,r=new MutationObserver(o=>{let l=!1;for(const u of o)l=l||Ud(u.removedNodes,i),l=l&&!Ud(u.addedNodes,i);l&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const Rc=new Map;let wy=0;function Fb(){const n=window.devicePixelRatio;n!==wy&&(wy=n,Rc.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function E3(n,e){Rc.size||window.addEventListener("resize",Fb),Rc.set(n,e)}function A3(n){Rc.delete(n),Rc.size||window.removeEventListener("resize",Fb)}function k3(n,e,t){const i=n.canvas,r=i&&Op(i);if(!r)return;const o=Sb((u,f)=>{const m=r.clientWidth;t(u,f),m<r.clientWidth&&t()},window),l=new ResizeObserver(u=>{const f=u[0],m=f.contentRect.width,p=f.contentRect.height;m===0&&p===0||o(m,p)});return l.observe(r),E3(n,o),l}function Mm(n,e,t){t&&t.disconnect(),e==="resize"&&A3(n)}function C3(n,e,t){const i=n.canvas,r=Sb(o=>{n.ctx!==null&&t(_3(o,n))},n);return b3(i,e,r),r}class j3 extends Pb{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(x3(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[Od])return!1;const i=t[Od].initial;["height","width"].forEach(o=>{const l=i[o];mt(l)?t.removeAttribute(o):t.setAttribute(o,l)});const r=i.style||{};return Object.keys(r).forEach(o=>{t.style[o]=r[o]}),t.width=t.width,delete t[Od],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),l={attach:T3,detach:w3,resize:k3}[t]||C3;r[t]=l(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),r=i[t];if(!r)return;({attach:Mm,detach:Mm,resize:Mm}[t]||S3)(e,t,r),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,r){return hA(e,t,i,r)}isAttached(e){const t=e&&Op(e);return!!(t&&t.isConnected)}}function D3(n){return!Np()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?v3:j3}class pa{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return Nc(this.x)&&Nc(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const r={};return e.forEach(o=>{r[o]=i[o]&&i[o].active()?i[o]._to:this[o]}),r}}function N3(n,e){const t=n.options.ticks,i=O3(n),r=Math.min(t.maxTicksLimit||i,i),o=t.major.enabled?R3(e):[],l=o.length,u=o[0],f=o[l-1],m=[];if(l>r)return L3(e,m,o,l/r),m;const p=M3(o,e,r);if(l>0){let v,x;const S=l>1?Math.round((f-u)/(l-1)):null;for(pd(e,m,p,mt(S)?0:u-S,u),v=0,x=l-1;v<x;v++)pd(e,m,p,o[v],o[v+1]);return pd(e,m,p,f,mt(S)?e.length:f+S),m}return pd(e,m,p),m}function O3(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(i,r))}function M3(n,e,t){const i=I3(n),r=e.length/t;if(!i)return Math.max(r,1);const o=d4(i);for(let l=0,u=o.length-1;l<u;l++){const f=o[l];if(f>r)return f}return Math.max(r,1)}function R3(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function L3(n,e,t,i){let r=0,o=t[0],l;for(i=Math.ceil(i),l=0;l<n.length;l++)l===o&&(e.push(n[l]),r++,o=t[r*i])}function pd(n,e,t,i,r){const o=it(i,0),l=Math.min(it(r,n.length),n.length);let u=0,f,m,p;for(t=Math.ceil(t),r&&(f=r-i,t=f/Math.floor(f/t)),p=o;p<0;)u++,p=Math.round(o+u*t);for(m=Math.max(o,0);m<l;m++)m===p&&(e.push(n[m]),u++,p=Math.round(o+u*t))}function I3(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const P3=n=>n==="left"?"right":n==="right"?"left":n,Ey=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,Ay=(n,e)=>Math.min(e||n,n);function ky(n,e){const t=[],i=n.length/e,r=n.length;let o=0;for(;o<r;o+=i)t.push(n[Math.floor(o)]);return t}function B3(n,e,t){const i=n.ticks.length,r=Math.min(e,i-1),o=n._startPixel,l=n._endPixel,u=1e-6;let f=n.getPixelForTick(r),m;if(!(t&&(i===1?m=Math.max(f-o,l-f):e===0?m=(n.getPixelForTick(1)-f)/2:m=(f-n.getPixelForTick(r-1))/2,f+=r<e?m:-m,f<o-u||f>l+u)))return f}function F3(n,e){jt(n,t=>{const i=t.gc,r=i.length/2;let o;if(r>e){for(o=0;o<r;++o)delete t.data[i[o]];i.splice(0,r)}})}function lc(n){return n.drawTicks?n.tickLength:0}function Cy(n,e){if(!n.display)return 0;const t=Tn(n.font,e),i=Jn(n.padding);return(Qt(n.text)?n.text.length:1)*t.lineHeight+i.height}function U3(n,e){return is(n,{scale:e,type:"scale"})}function z3(n,e,t){return is(n,{tick:t,index:e,type:"tick"})}function H3(n,e,t){let i=Sp(n);return(t&&e!=="right"||!t&&e==="right")&&(i=P3(i)),i}function W3(n,e,t,i){const{top:r,left:o,bottom:l,right:u,chart:f}=n,{chartArea:m,scales:p}=f;let v=0,x,S,_;const b=l-r,T=u-o;if(n.isHorizontal()){if(S=qn(i,o,u),pt(t)){const w=Object.keys(t)[0],A=t[w];_=p[w].getPixelForValue(A)+b-e}else t==="center"?_=(m.bottom+m.top)/2+b-e:_=Ey(n,t,e);x=u-o}else{if(pt(t)){const w=Object.keys(t)[0],A=t[w];S=p[w].getPixelForValue(A)-T+e}else t==="center"?S=(m.left+m.right)/2-T+e:S=Ey(n,t,e);_=qn(i,l,r),v=t==="left"?-cn:cn}return{titleX:S,titleY:_,maxWidth:x,rotation:v}}class el extends pa{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:r}=this;return e=jr(e,Number.POSITIVE_INFINITY),t=jr(t,Number.NEGATIVE_INFINITY),i=jr(i,Number.POSITIVE_INFINITY),r=jr(r,Number.NEGATIVE_INFINITY),{min:jr(e,i),max:jr(t,r),minDefined:Si(e),maxDefined:Si(t)}}getMinMax(e){let{min:t,max:i,minDefined:r,maxDefined:o}=this.getUserBounds(),l;if(r&&o)return{min:t,max:i};const u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)l=u[f].controller.getMinMax(this,e),r||(t=Math.min(t,l.min)),o||(i=Math.max(i,l.max));return t=o&&t>i?i:t,i=r&&t>i?t:i,{min:jr(t,jr(i,t)),max:jr(i,jr(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){zt(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:r,grace:o,ticks:l}=this.options,u=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=V4(this,o,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?ky(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=N3(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){zt(this.options.afterUpdate,[this])}beforeSetDimensions(){zt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){zt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),zt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){zt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,r,o;for(i=0,r=e.length;i<r;i++)o=e[i],o.label=zt(t.callback,[o.value,i,e],this)}afterTickToLabelConversion(){zt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){zt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=Ay(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,o=t.maxRotation;let l=r,u,f,m;if(!this._isVisible()||!t.display||r>=o||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const p=this._getLabelSizes(),v=p.widest.width,x=p.highest.height,S=Kn(this.chart.width-v,0,this.maxWidth);u=e.offset?this.maxWidth/i:S/(i-1),v+6>u&&(u=S/(i-(e.offset?.5:1)),f=this.maxHeight-lc(e.grid)-t.padding-Cy(e.title,this.chart.options.font),m=Math.sqrt(v*v+x*x),l=xp(Math.min(Math.asin(Kn((p.highest.height+6)/u,-1,1)),Math.asin(Kn(f/m,-1,1))-Math.asin(Kn(x/m,-1,1)))),l=Math.max(r,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){zt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){zt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:r,grid:o}}=this,l=this._isVisible(),u=this.isHorizontal();if(l){const f=Cy(r,t.options.font);if(u?(e.width=this.maxWidth,e.height=lc(o)+f):(e.height=this.maxHeight,e.width=lc(o)+f),i.display&&this.ticks.length){const{first:m,last:p,widest:v,highest:x}=this._getLabelSizes(),S=i.padding*2,_=Lr(this.labelRotation),b=Math.cos(_),T=Math.sin(_);if(u){const w=i.mirror?0:T*v.width+b*x.height;e.height=Math.min(this.maxHeight,e.height+w+S)}else{const w=i.mirror?0:b*v.width+T*x.height;e.width=Math.min(this.maxWidth,e.width+w+S)}this._calculatePadding(m,p,T,b)}}this._handleMargins(),u?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,r){const{ticks:{align:o,padding:l},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const p=this.getPixelForTick(0)-this.left,v=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,S=0;f?m?(x=r*e.width,S=i*t.height):(x=i*e.height,S=r*t.width):o==="start"?S=t.width:o==="end"?x=e.width:o!=="inner"&&(x=e.width/2,S=t.width/2),this.paddingLeft=Math.max((x-p+l)*this.width/(this.width-p),0),this.paddingRight=Math.max((S-v+l)*this.width/(this.width-v),0)}else{let p=t.height/2,v=e.height/2;o==="start"?(p=0,v=e.height):o==="end"&&(p=t.height,v=0),this.paddingTop=p+l,this.paddingBottom=v+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){zt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)mt(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=ky(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){const{ctx:r,_longestTextCache:o}=this,l=[],u=[],f=Math.floor(t/Ay(t,i));let m=0,p=0,v,x,S,_,b,T,w,A,C,N,E;for(v=0;v<t;v+=f){if(_=e[v].label,b=this._resolveTickFontOptions(v),r.font=T=b.string,w=o[T]=o[T]||{data:{},gc:[]},A=b.lineHeight,C=N=0,!mt(_)&&!Qt(_))C=Bd(r,w.data,w.gc,C,_),N=A;else if(Qt(_))for(x=0,S=_.length;x<S;++x)E=_[x],!mt(E)&&!Qt(E)&&(C=Bd(r,w.data,w.gc,C,E),N+=A);l.push(C),u.push(N),m=Math.max(C,m),p=Math.max(N,p)}F3(o,t);const I=l.indexOf(m),D=u.indexOf(p),z=L=>({width:l[L]||0,height:u[L]||0});return{first:z(0),last:z(t-1),widest:z(I),highest:z(D),widths:l,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return g4(this._alignToPixels?Ds(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=z3(this.getContext(),e,i))}return this.$context||(this.$context=U3(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Lr(this.labelRotation),i=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),o=this._getLabelSizes(),l=e.autoSkipPadding||0,u=o?o.widest.width+l:0,f=o?o.highest.height+l:0;return this.isHorizontal()?f*i>u*r?u/i:f/r:f*r<u*i?f/i:u/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,r=this.options,{grid:o,position:l,border:u}=r,f=o.offset,m=this.isHorizontal(),v=this.ticks.length+(f?1:0),x=lc(o),S=[],_=u.setContext(this.getContext()),b=_.display?_.width:0,T=b/2,w=function(ie){return Ds(i,ie,b)};let A,C,N,E,I,D,z,L,H,K,ne,xe;if(l==="top")A=w(this.bottom),D=this.bottom-x,L=A-T,K=w(e.top)+T,xe=e.bottom;else if(l==="bottom")A=w(this.top),K=e.top,xe=w(e.bottom)-T,D=A+T,L=this.top+x;else if(l==="left")A=w(this.right),I=this.right-x,z=A-T,H=w(e.left)+T,ne=e.right;else if(l==="right")A=w(this.left),H=e.left,ne=w(e.right)-T,I=A+T,z=this.left+x;else if(t==="x"){if(l==="center")A=w((e.top+e.bottom)/2+.5);else if(pt(l)){const ie=Object.keys(l)[0],he=l[ie];A=w(this.chart.scales[ie].getPixelForValue(he))}K=e.top,xe=e.bottom,D=A+T,L=D+x}else if(t==="y"){if(l==="center")A=w((e.left+e.right)/2);else if(pt(l)){const ie=Object.keys(l)[0],he=l[ie];A=w(this.chart.scales[ie].getPixelForValue(he))}I=A-T,z=I-x,H=e.left,ne=e.right}const He=it(r.ticks.maxTicksLimit,v),_e=Math.max(1,Math.ceil(v/He));for(C=0;C<v;C+=_e){const ie=this.getContext(C),he=o.setContext(ie),Ne=u.setContext(ie),Be=he.lineWidth,X=he.color,pe=Ne.dash||[],P=Ne.dashOffset,Y=he.tickWidth,V=he.tickColor,q=he.tickBorderDash||[],ae=he.tickBorderDashOffset;N=B3(this,C,f),N!==void 0&&(E=Ds(i,N,Be),m?I=z=H=ne=E:D=L=K=xe=E,S.push({tx1:I,ty1:D,tx2:z,ty2:L,x1:H,y1:K,x2:ne,y2:xe,width:Be,color:X,borderDash:pe,borderDashOffset:P,tickWidth:Y,tickColor:V,tickBorderDash:q,tickBorderDashOffset:ae}))}return this._ticksLength=v,this._borderValue=A,S}_computeLabelItems(e){const t=this.axis,i=this.options,{position:r,ticks:o}=i,l=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:p,mirror:v}=o,x=lc(i.grid),S=x+p,_=v?-p:S,b=-Lr(this.labelRotation),T=[];let w,A,C,N,E,I,D,z,L,H,K,ne,xe="middle";if(r==="top")I=this.bottom-_,D=this._getXAxisLabelAlignment();else if(r==="bottom")I=this.top+_,D=this._getXAxisLabelAlignment();else if(r==="left"){const _e=this._getYAxisLabelAlignment(x);D=_e.textAlign,E=_e.x}else if(r==="right"){const _e=this._getYAxisLabelAlignment(x);D=_e.textAlign,E=_e.x}else if(t==="x"){if(r==="center")I=(e.top+e.bottom)/2+S;else if(pt(r)){const _e=Object.keys(r)[0],ie=r[_e];I=this.chart.scales[_e].getPixelForValue(ie)+S}D=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")E=(e.left+e.right)/2-S;else if(pt(r)){const _e=Object.keys(r)[0],ie=r[_e];E=this.chart.scales[_e].getPixelForValue(ie)}D=this._getYAxisLabelAlignment(x).textAlign}t==="y"&&(f==="start"?xe="top":f==="end"&&(xe="bottom"));const He=this._getLabelSizes();for(w=0,A=u.length;w<A;++w){C=u[w],N=C.label;const _e=o.setContext(this.getContext(w));z=this.getPixelForTick(w)+o.labelOffset,L=this._resolveTickFontOptions(w),H=L.lineHeight,K=Qt(N)?N.length:1;const ie=K/2,he=_e.color,Ne=_e.textStrokeColor,Be=_e.textStrokeWidth;let X=D;l?(E=z,D==="inner"&&(w===A-1?X=this.options.reverse?"left":"right":w===0?X=this.options.reverse?"right":"left":X="center"),r==="top"?m==="near"||b!==0?ne=-K*H+H/2:m==="center"?ne=-He.highest.height/2-ie*H+H:ne=-He.highest.height+H/2:m==="near"||b!==0?ne=H/2:m==="center"?ne=He.highest.height/2-ie*H:ne=He.highest.height-K*H,v&&(ne*=-1),b!==0&&!_e.showLabelBackdrop&&(E+=H/2*Math.sin(b))):(I=z,ne=(1-K)*H/2);let pe;if(_e.showLabelBackdrop){const P=Jn(_e.backdropPadding),Y=He.heights[w],V=He.widths[w];let q=ne-P.top,ae=0-P.left;switch(xe){case"middle":q-=Y/2;break;case"bottom":q-=Y;break}switch(D){case"center":ae-=V/2;break;case"right":ae-=V;break;case"inner":w===A-1?ae-=V:w>0&&(ae-=V/2);break}pe={left:ae,top:q,width:V+P.width,height:Y+P.height,color:_e.backdropColor}}T.push({label:N,font:L,textOffset:ne,options:{rotation:b,color:he,strokeColor:Ne,strokeWidth:Be,textAlign:X,textBaseline:xe,translation:[E,I],backdrop:pe}})}return T}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Lr(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:r,padding:o}}=this.options,l=this._getLabelSizes(),u=e+o,f=l.widest.width;let m,p;return t==="left"?r?(p=this.right+o,i==="near"?m="left":i==="center"?(m="center",p+=f/2):(m="right",p+=f)):(p=this.right-u,i==="near"?m="right":i==="center"?(m="center",p-=f/2):(m="left",p=this.left)):t==="right"?r?(p=this.left+o,i==="near"?m="right":i==="center"?(m="center",p-=f/2):(m="left",p-=f)):(p=this.left+u,i==="near"?m="left":i==="center"?(m="center",p+=f/2):(m="right",p=this.right)):m="right",{textAlign:m,x:p}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:r,width:o,height:l}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,r,o,l),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(o=>o.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,l;const u=(f,m,p)=>{!p.width||!p.color||(i.save(),i.lineWidth=p.width,i.strokeStyle=p.color,i.setLineDash(p.borderDash||[]),i.lineDashOffset=p.borderDashOffset,i.beginPath(),i.moveTo(f.x,f.y),i.lineTo(m.x,m.y),i.stroke(),i.restore())};if(t.display)for(o=0,l=r.length;o<l;++o){const f=r[o];t.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),t.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:r}}=this,o=i.setContext(this.getContext()),l=i.display?o.width:0;if(!l)return;const u=r.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,p,v,x;this.isHorizontal()?(m=Ds(e,this.left,l)-l/2,p=Ds(e,this.right,u)+u/2,v=x=f):(v=Ds(e,this.top,l)-l/2,x=Ds(e,this.bottom,u)+u/2,m=p=f),t.save(),t.lineWidth=o.width,t.strokeStyle=o.color,t.beginPath(),t.moveTo(m,v),t.lineTo(p,x),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&Ep(i,r);const o=this.getLabelItems(e);for(const l of o){const u=l.options,f=l.font,m=l.label,p=l.textOffset;Us(i,m,0,p,f,u)}r&&Ap(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:r}}=this;if(!i.display)return;const o=Tn(i.font),l=Jn(i.padding),u=i.align;let f=o.lineHeight/2;t==="bottom"||t==="center"||pt(t)?(f+=l.bottom,Qt(i.text)&&(f+=o.lineHeight*(i.text.length-1))):f+=l.top;const{titleX:m,titleY:p,maxWidth:v,rotation:x}=W3(this,f,t,u);Us(e,i.text,0,0,o,{color:i.color,maxWidth:v,rotation:x,textAlign:H3(u,t,r),textBaseline:"middle",translation:[m,p]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=it(e.grid&&e.grid.z,-1),r=it(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==el.prototype.draw?[{z:t,draw:o=>{this.draw(o)}}]:[{z:i,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let o,l;for(o=0,l=t.length;o<l;++o){const u=t[o];u[i]===this.id&&(!e||u.type===e)&&r.push(u)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Tn(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class gd{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;Y3(t)&&(i=this.register(t));const r=this.items,o=e.id,l=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in r||(r[o]=e,V3(e,l,i),this.override&&an.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,r=this.scope;i in t&&delete t[i],r&&i in an[r]&&(delete an[r][i],this.override&&delete Fs[i])}}function V3(n,e,t){const i=jc(Object.create(null),[t?an.get(t):{},an.get(e),n.defaults]);an.set(e,i),n.defaultRoutes&&G3(e,n.defaultRoutes),n.descriptors&&an.describe(e,n.descriptors)}function G3(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),r=i.pop(),o=[n].concat(i).join("."),l=e[t].split("."),u=l.pop(),f=l.join(".");an.route(o,r,f,u)})}function Y3(n){return"id"in n&&"defaults"in n}class X3{constructor(){this.controllers=new gd(Yc,"datasets",!0),this.elements=new gd(pa,"elements"),this.plugins=new gd(Object,"plugins"),this.scales=new gd(el,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(r=>{const o=i||this._getRegistryForType(r);i||o.isForType(r)||o===this.plugins&&r.id?this._exec(e,o,r):jt(r,l=>{const u=i||this._getRegistryForType(l);this._exec(e,u,l)})})}_exec(e,t,i){const r=yp(e);zt(i["before"+r],[],i),t[e](i),zt(i["after"+r],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}}var Mr=new X3;class $3{constructor(){this._init=[]}notify(e,t,i,r){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=r?this._descriptors(e).filter(r):this._descriptors(e),l=this._notify(o,e,t,i);return t==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),l}_notify(e,t,i,r){r=r||{};for(const o of e){const l=o.plugin,u=l[i],f=[t,r,o.options];if(zt(u,f,l)===!1&&r.cancelable)return!1}return!0}invalidate(){mt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,r=it(i.options&&i.options.plugins,{}),o=q3(i);return r===!1&&!t?[]:Z3(e,o,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,r=(o,l)=>o.filter(u=>!l.some(f=>u.plugin.id===f.plugin.id));this._notify(r(t,i),e,"stop"),this._notify(r(i,t),e,"start")}}function q3(n){const e={},t=[],i=Object.keys(Mr.plugins.items);for(let o=0;o<i.length;o++)t.push(Mr.getPlugin(i[o]));const r=n.plugins||[];for(let o=0;o<r.length;o++){const l=r[o];t.indexOf(l)===-1&&(t.push(l),e[l.id]=!0)}return{plugins:t,localIds:e}}function K3(n,e){return!e&&n===!1?null:n===!0?{}:n}function Z3(n,{plugins:e,localIds:t},i,r){const o=[],l=n.getContext();for(const u of e){const f=u.id,m=K3(i[f],r);m!==null&&o.push({plugin:u,options:Q3(n.config,{plugin:u,local:t[f]},m,l)})}return o}function Q3(n,{plugin:e,local:t},i,r){const o=n.pluginScopeKeys(e),l=n.getOptionScopes(i,o);return t&&e.defaults&&l.push(e.defaults),n.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Zm(n,e){const t=an.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function J3(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function ek(n,e){return n===e?"_index_":"_value_"}function jy(n){if(n==="x"||n==="y"||n==="r")return n}function tk(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Qm(n,...e){if(jy(n))return n;for(const t of e){const i=t.axis||tk(t.position)||n.length>1&&jy(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function Dy(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function nk(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(t.length)return Dy(n,"x",t[0])||Dy(n,"y",t[0])}return{}}function ik(n,e){const t=Fs[n.type]||{scales:{}},i=e.scales||{},r=Zm(n.type,e),o=Object.create(null);return Object.keys(i).forEach(l=>{const u=i[l];if(!pt(u))return console.error(`Invalid scale configuration for scale: ${l}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const f=Qm(l,u,nk(l,n),an.scales[u.type]),m=ek(f,r),p=t.scales||{};o[l]=vc(Object.create(null),[{axis:f},u,p[f],p[m]])}),n.data.datasets.forEach(l=>{const u=l.type||n.type,f=l.indexAxis||Zm(u,e),p=(Fs[u]||{}).scales||{};Object.keys(p).forEach(v=>{const x=J3(v,f),S=l[x+"AxisID"]||x;o[S]=o[S]||Object.create(null),vc(o[S],[{axis:x},i[S],p[v]])})}),Object.keys(o).forEach(l=>{const u=o[l];vc(u,[an.scales[u.type],an.scale])}),o}function Ub(n){const e=n.options||(n.options={});e.plugins=it(e.plugins,{}),e.scales=ik(n,e)}function zb(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function rk(n){return n=n||{},n.data=zb(n.data),Ub(n),n}const Ny=new Map,Hb=new Set;function vd(n,e){let t=Ny.get(n);return t||(t=e(),Ny.set(n,t),Hb.add(t)),t}const cc=(n,e,t)=>{const i=Qa(e,t);i!==void 0&&n.add(i)};class ak{constructor(e){this._config=rk(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=zb(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Ub(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return vd(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return vd(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return vd(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return vd(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let r=i.get(e);return(!r||t)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,t,i){const{options:r,type:o}=this,l=this._cachedScopes(e,i),u=l.get(t);if(u)return u;const f=new Set;t.forEach(p=>{e&&(f.add(e),p.forEach(v=>cc(f,e,v))),p.forEach(v=>cc(f,r,v)),p.forEach(v=>cc(f,Fs[o]||{},v)),p.forEach(v=>cc(f,an,v)),p.forEach(v=>cc(f,qm,v))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),Hb.has(t)&&l.set(t,m),m}chartOptionScopes(){const{options:e,type:t}=this;return[e,Fs[t]||{},an.datasets[t]||{},{type:t},an,qm]}resolveNamedOptions(e,t,i,r=[""]){const o={$shared:!0},{resolver:l,subPrefixes:u}=Oy(this._resolverCache,e,r);let f=l;if(ok(l,t)){o.$shared=!1,i=Ja(i)?i():i;const m=this.createResolver(e,i,u);f=Xo(l,i,m)}for(const m of t)o[m]=f[m];return o}createResolver(e,t,i=[""],r){const{resolver:o}=Oy(this._resolverCache,e,i);return pt(t)?Xo(o,t,void 0,r):o}}function Oy(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const r=t.join();let o=i.get(r);return o||(o={resolver:Cp(e,t),subPrefixes:t.filter(u=>!u.toLowerCase().includes("hover"))},i.set(r,o)),o}const sk=n=>pt(n)&&Object.getOwnPropertyNames(n).some(e=>Ja(n[e]));function ok(n,e){const{isScriptable:t,isIndexable:i}=wb(n);for(const r of e){const o=t(r),l=i(r),u=(l||o)&&n[r];if(o&&(Ja(u)||sk(u))||l&&Qt(u))return!0}return!1}var lk="4.5.0";const ck=["top","bottom","left","right","chartArea"];function My(n,e){return n==="top"||n==="bottom"||ck.indexOf(n)===-1&&e==="x"}function Ry(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function Ly(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),zt(t&&t.onComplete,[n],e)}function uk(n){const e=n.chart,t=e.options.animation;zt(t&&t.onProgress,[n],e)}function Wb(n){return Np()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Md={},Iy=n=>{const e=Wb(n);return Object.values(Md).filter(t=>t.canvas===e).pop()};function dk(n,e,t){const i=Object.keys(n);for(const r of i){const o=+r;if(o>=e){const l=n[r];delete n[r],(t>0||o>e)&&(n[o+t]=l)}}}function fk(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}let lf=class{static defaults=an;static instances=Md;static overrides=Fs;static registry=Mr;static version=lk;static getChart=Iy;static register(...e){Mr.add(...e),Py()}static unregister(...e){Mr.remove(...e),Py()}constructor(e,t){const i=this.config=new ak(t),r=Wb(e),o=Iy(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const l=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||D3(r)),this.platform.updateConfig(i);const u=this.platform.acquireContext(r,l.aspectRatio),f=u&&u.canvas,m=f&&f.height,p=f&&f.width;if(this.id=n4(),this.ctx=u,this.canvas=f,this.width=p,this.height=m,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new $3,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=b4(v=>this.update(v),l.resizeDelay||0),this._dataChanges=[],Md[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}ra.listen(this,"complete",Ly),ra.listen(this,"progress",uk),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:r,_aspectRatio:o}=this;return mt(e)?t&&o?o:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Mr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():ay(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ny(this.canvas,this.ctx),this}stop(){return ra.stop(this),this}resize(e,t){ra.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,r=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(r,e,t,o),u=i.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,ay(this,u,!0)&&(this.notifyPlugins("resize",{size:l}),zt(i.onResize,[this,l],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};jt(t,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,r=Object.keys(i).reduce((l,u)=>(l[u]=!1,l),{});let o=[];t&&(o=o.concat(Object.keys(t).map(l=>{const u=t[l],f=Qm(l,u),m=f==="r",p=f==="x";return{options:u,dposition:m?"chartArea":p?"bottom":"left",dtype:m?"radialLinear":p?"category":"linear"}}))),jt(o,l=>{const u=l.options,f=u.id,m=Qm(f,u),p=it(u.type,l.dtype);(u.position===void 0||My(u.position,m)!==My(l.dposition))&&(u.position=l.dposition),r[f]=!0;let v=null;if(f in i&&i[f].type===p)v=i[f];else{const x=Mr.getScale(p);v=new x({id:f,type:p,ctx:this.ctx,chart:this}),i[v.id]=v}v.init(u,e)}),jt(r,(l,u)=>{l||delete i[u]}),jt(i,l=>{nr.configure(this,l,l.options),nr.addBox(this,l)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((r,o)=>r.index-o.index),i>t){for(let r=t;r<i;++r)this._destroyDatasetMeta(r);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(Ry("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,r)=>{t.filter(o=>o===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=t.length;i<r;i++){const o=t[i];let l=this.getDatasetMeta(i);const u=o.type||this.config.type;if(l.type&&l.type!==u&&(this._destroyDatasetMeta(i),l=this.getDatasetMeta(i)),l.type=u,l.indexAxis=o.indexAxis||Zm(u,this.options),l.order=o.order||0,l.index=i,l.label=""+o.label,l.visible=this.isDatasetVisible(i),l.controller)l.controller.updateIndex(i),l.controller.linkScales();else{const f=Mr.getController(u),{datasetElementType:m,dataElementType:p}=an.datasets[u];Object.assign(f,{dataElementType:Mr.getElement(p),datasetElementType:m&&Mr.getElement(m)}),l.controller=new f(this,i),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){jt(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let m=0,p=this.data.datasets.length;m<p;m++){const{controller:v}=this.getDatasetMeta(m),x=!r&&o.indexOf(v)===-1;v.buildOrUpdateElements(x),l=Math.max(+v.getMaxOverflow(),l)}l=this._minPadding=i.layout.autoPadding?l:0,this._updateLayout(l),r||jt(o,m=>{m.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Ry("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){jt(this.scales,e=>{nr.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!Xv(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:o}of t){const l=i==="_removeElements"?-o:o;dk(e,r,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=o=>new Set(e.filter(l=>l[0]===o).map((l,u)=>u+","+l.splice(1).join(","))),r=i(0);for(let o=1;o<t;o++)if(!Xv(r,i(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;nr.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],jt(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,Ja(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ra.has(this)?this.attached&&!ra.running(this)&&ra.start(this):(this.draw(),Ly({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let r,o;for(r=0,o=t.length;r<o;++r){const l=t[r];(!e||l.visible)&&i.push(l)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i={meta:e,index:e.index,cancelable:!0},r=CA(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&Ep(t,r),e.controller.draw(),r&&Ap(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return oa(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,r){const o=c3.modes[t];return typeof o=="function"?o(this,e,i,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let r=i.filter(o=>o&&o._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=is(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const r=i?"show":"hide",o=this.getDatasetMeta(e),l=o.controller._resolveAnimations(void 0,r);Dc(t)?(o.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),l.update(o,{visible:i}),this.update(u=>u.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ra.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ny(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Md[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(o,l)=>{t.addEventListener(this,o,l),e[o]=l},r=(o,l,u)=>{o.offsetX=l,o.offsetY=u,this._eventHandler(o)};jt(this.options.events,o=>i(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(f,m)=>{t.addEventListener(this,f,m),e[f]=m},r=(f,m)=>{e[f]&&(t.removeEventListener(this,f,m),delete e[f])},o=(f,m)=>{this.canvas&&this.resize(f,m)};let l;const u=()=>{r("attach",u),this.attached=!0,this.resize(),i("resize",o),i("detach",l)};l=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),i("attach",u)},t.isAttached(this.canvas)?u():l()}unbindEvents(){jt(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},jt(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const r=i?"set":"remove";let o,l,u,f;for(t==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),u=0,f=e.length;u<f;++u){l=e[u];const m=l&&this.getDatasetMeta(l.datasetIndex).controller;m&&m[r+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:o,index:l})=>{const u=this.getDatasetMeta(o);if(!u)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:u.data[l],index:l}});!Ld(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const r=this.options.hover,o=(f,m)=>f.filter(p=>!m.some(v=>p.datasetIndex===v.datasetIndex&&p.index===v.index)),l=o(t,e),u=i?e:o(e,t);l.length&&this.updateHoverStyle(l,r.mode,!1),u.length&&r.mode&&this.updateHoverStyle(u,r.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const o=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(o||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:r=[],options:o}=this,l=t,u=this._getActiveElements(e,r,i,l),f=l4(e),m=fk(e,this._lastEvent,i,f);i&&(this._lastEvent=null,zt(o.onHover,[e,u,this],this),f&&zt(o.onClick,[e,u,this],this));const p=!Ld(u,r);return(p||t)&&(this._active=u,this._updateHoverStyles(u,r,t)),this._lastEvent=m,p}_getActiveElements(e,t,i,r){if(e.type==="mouseout")return[];if(!i)return t;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,r)}};function Py(){return jt(lf.instances,n=>n._plugins.invalidate())}function hk(n,e,t){const{startAngle:i,x:r,y:o,outerRadius:l,innerRadius:u,options:f}=e,{borderWidth:m,borderJoinStyle:p}=f,v=Math.min(m/l,yi(i-t));if(n.beginPath(),n.arc(r,o,l-m/2,i+v/2,t-v/2),u>0){const x=Math.min(m/u,yi(i-t));n.arc(r,o,u+m/2,t-x/2,i+x/2,!0)}else{const x=Math.min(m/2,l*yi(i-t));if(p==="round")n.arc(r,o,x,t-Tt/2,i+Tt/2,!0);else if(p==="bevel"){const S=2*x*x,_=-S*Math.cos(t+Tt/2)+r,b=-S*Math.sin(t+Tt/2)+o,T=S*Math.cos(i+Tt/2)+r,w=S*Math.sin(i+Tt/2)+o;n.lineTo(_,b),n.lineTo(T,w)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function mk(n,e,t){const{startAngle:i,pixelMargin:r,x:o,y:l,outerRadius:u,innerRadius:f}=e;let m=r/u;n.beginPath(),n.arc(o,l,u,i-m,t+m),f>r?(m=r/f,n.arc(o,l,f,t+m,i-m,!0)):n.arc(o,l,r,t+cn,i-cn),n.closePath(),n.clip()}function pk(n){return kp(n,["outerStart","outerEnd","innerStart","innerEnd"])}function gk(n,e,t,i){const r=pk(n.options.borderRadius),o=(t-e)/2,l=Math.min(o,i*e/2),u=f=>{const m=(t-Math.min(o,f))*i/2;return Kn(f,0,Math.min(o,m))};return{outerStart:u(r.outerStart),outerEnd:u(r.outerEnd),innerStart:Kn(r.innerStart,0,l),innerEnd:Kn(r.innerEnd,0,l)}}function Ro(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function zd(n,e,t,i,r,o){const{x:l,y:u,startAngle:f,pixelMargin:m,innerRadius:p}=e,v=Math.max(e.outerRadius+i+t-m,0),x=p>0?p+i+t+m:0;let S=0;const _=r-f;if(i){const _e=p>0?p-i:0,ie=v>0?v-i:0,he=(_e+ie)/2,Ne=he!==0?_*he/(he+i):_;S=(_-Ne)/2}const b=Math.max(.001,_*v-t/Tt)/v,T=(_-b)/2,w=f+T+S,A=r-T-S,{outerStart:C,outerEnd:N,innerStart:E,innerEnd:I}=gk(e,x,v,A-w),D=v-C,z=v-N,L=w+C/D,H=A-N/z,K=x+E,ne=x+I,xe=w+E/K,He=A-I/ne;if(n.beginPath(),o){const _e=(L+H)/2;if(n.arc(l,u,v,L,_e),n.arc(l,u,v,_e,H),N>0){const Be=Ro(z,H,l,u);n.arc(Be.x,Be.y,N,H,A+cn)}const ie=Ro(ne,A,l,u);if(n.lineTo(ie.x,ie.y),I>0){const Be=Ro(ne,He,l,u);n.arc(Be.x,Be.y,I,A+cn,He+Math.PI)}const he=(A-I/x+(w+E/x))/2;if(n.arc(l,u,x,A-I/x,he,!0),n.arc(l,u,x,he,w+E/x,!0),E>0){const Be=Ro(K,xe,l,u);n.arc(Be.x,Be.y,E,xe+Math.PI,w-cn)}const Ne=Ro(D,w,l,u);if(n.lineTo(Ne.x,Ne.y),C>0){const Be=Ro(D,L,l,u);n.arc(Be.x,Be.y,C,w-cn,L)}}else{n.moveTo(l,u);const _e=Math.cos(L)*v+l,ie=Math.sin(L)*v+u;n.lineTo(_e,ie);const he=Math.cos(H)*v+l,Ne=Math.sin(H)*v+u;n.lineTo(he,Ne)}n.closePath()}function vk(n,e,t,i,r){const{fullCircles:o,startAngle:l,circumference:u}=e;let f=e.endAngle;if(o){zd(n,e,t,i,f,r);for(let m=0;m<o;++m)n.fill();isNaN(u)||(f=l+(u%Yt||Yt))}return zd(n,e,t,i,f,r),n.fill(),f}function yk(n,e,t,i,r){const{fullCircles:o,startAngle:l,circumference:u,options:f}=e,{borderWidth:m,borderJoinStyle:p,borderDash:v,borderDashOffset:x,borderRadius:S}=f,_=f.borderAlign==="inner";if(!m)return;n.setLineDash(v||[]),n.lineDashOffset=x,_?(n.lineWidth=m*2,n.lineJoin=p||"round"):(n.lineWidth=m,n.lineJoin=p||"bevel");let b=e.endAngle;if(o){zd(n,e,t,i,b,r);for(let T=0;T<o;++T)n.stroke();isNaN(u)||(b=l+(u%Yt||Yt))}_&&mk(n,e,b),f.selfJoin&&b-l>=Tt&&S===0&&p!=="miter"&&hk(n,e,b),o||(zd(n,e,t,i,b,r),n.stroke())}class xk extends pa{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.getProps(["x","y"],i),{angle:o,distance:l}=vb(r,{x:e,y:t}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:p,circumference:v}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),x=(this.options.spacing+this.options.borderWidth)/2,S=it(v,f-u),_=Oc(o,u,f)&&u!==f,b=S>=Yt||_,T=Xa(l,m+x,p+x);return b&&T}getCenterPoint(e){const{x:t,y:i,startAngle:r,endAngle:o,innerRadius:l,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,p=(r+o)/2,v=(l+u+m+f)/2;return{x:t+Math.cos(p)*v,y:i+Math.sin(p)*v}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,r=(t.offset||0)/4,o=(t.spacing||0)/2,l=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=i>Yt?Math.floor(i/Yt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const u=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(u)*r,Math.sin(u)*r);const f=1-Math.sin(Math.min(Tt,i||0)),m=r*f;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,vk(e,this,m,o,l),yk(e,this,m,o,l),e.restore()}}function Vb(n,e,t=e){n.lineCap=it(t.borderCapStyle,e.borderCapStyle),n.setLineDash(it(t.borderDash,e.borderDash)),n.lineDashOffset=it(t.borderDashOffset,e.borderDashOffset),n.lineJoin=it(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=it(t.borderWidth,e.borderWidth),n.strokeStyle=it(t.borderColor,e.borderColor)}function bk(n,e,t){n.lineTo(t.x,t.y)}function Sk(n){return n.stepped?L4:n.tension||n.cubicInterpolationMode==="monotone"?I4:bk}function Gb(n,e,t={}){const i=n.length,{start:r=0,end:o=i-1}=t,{start:l,end:u}=e,f=Math.max(r,l),m=Math.min(o,u),p=r<l&&o<l||r>u&&o>u;return{count:i,start:f,loop:e.loop,ilen:m<f&&!p?i+m-f:m-f}}function _k(n,e,t,i){const{points:r,options:o}=e,{count:l,start:u,loop:f,ilen:m}=Gb(r,t,i),p=Sk(o);let{move:v=!0,reverse:x}=i||{},S,_,b;for(S=0;S<=m;++S)_=r[(u+(x?m-S:S))%l],!_.skip&&(v?(n.moveTo(_.x,_.y),v=!1):p(n,b,_,x,o.stepped),b=_);return f&&(_=r[(u+(x?m:0))%l],p(n,b,_,x,o.stepped)),!!f}function Tk(n,e,t,i){const r=e.points,{count:o,start:l,ilen:u}=Gb(r,t,i),{move:f=!0,reverse:m}=i||{};let p=0,v=0,x,S,_,b,T,w;const A=N=>(l+(m?u-N:N))%o,C=()=>{b!==T&&(n.lineTo(p,T),n.lineTo(p,b),n.lineTo(p,w))};for(f&&(S=r[A(0)],n.moveTo(S.x,S.y)),x=0;x<=u;++x){if(S=r[A(x)],S.skip)continue;const N=S.x,E=S.y,I=N|0;I===_?(E<b?b=E:E>T&&(T=E),p=(v*p+N)/++v):(C(),n.lineTo(N,E),_=I,v=0,b=T=E),w=E}C()}function Jm(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?Tk:_k}function wk(n){return n.stepped?pA:n.tension||n.cubicInterpolationMode==="monotone"?gA:Ms}function Ek(n,e,t,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,i)&&r.closePath()),Vb(n,e.options),n.stroke(r)}function Ak(n,e,t,i){const{segments:r,options:o}=e,l=Jm(e);for(const u of r)Vb(n,o,u.style),n.beginPath(),l(n,e,u,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const kk=typeof Path2D=="function";function Ck(n,e,t,i){kk&&!e.options.segment?Ek(n,e,t,i):Ak(n,e,t,i)}class jk extends pa{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;oA(this._points,i,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=wA(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,r=e[t],o=this.points,l=SA(this,{property:t,start:r,end:r});if(!l.length)return;const u=[],f=wk(i);let m,p;for(m=0,p=l.length;m<p;++m){const{start:v,end:x}=l[m],S=o[v],_=o[x];if(S===_){u.push(S);continue}const b=Math.abs((r-S[t])/(_[t]-S[t])),T=f(S,_,b,i.stepped);T[t]=e[t],u.push(T)}return u.length===1?u[0]:u}pathSegment(e,t,i){return Jm(this)(e,this,t,i)}path(e,t,i){const r=this.segments,o=Jm(this);let l=this._loop;t=t||0,i=i||this.points.length-t;for(const u of r)l&=o(e,this,u,{start:t,end:t+i-1});return!!l}draw(e,t,i,r){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(e.save(),Ck(e,this,i,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function By(n,e,t,i){const r=n.options,{[t]:o}=n.getProps([t],i);return Math.abs(e-o)<r.radius+r.hitRadius}class Dk extends pa{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(e-o,2)+Math.pow(t-l,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return By(this,e,"x",t)}inYRange(e,t){return By(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const i=t&&e.borderWidth||0;return(t+i)*2}draw(e,t){const i=this.options;this.skip||i.radius<.1||!oa(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Km(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Yb(n,e){const{x:t,y:i,base:r,width:o,height:l}=n.getProps(["x","y","base","width","height"],e);let u,f,m,p,v;return n.horizontal?(v=l/2,u=Math.min(t,r),f=Math.max(t,r),m=i-v,p=i+v):(v=o/2,u=t-v,f=t+v,m=Math.min(i,r),p=Math.max(i,r)),{left:u,top:m,right:f,bottom:p}}function $a(n,e,t,i){return n?0:Kn(e,t,i)}function Nk(n,e,t){const i=n.options.borderWidth,r=n.borderSkipped,o=Tb(i);return{t:$a(r.top,o.top,0,t),r:$a(r.right,o.right,0,e),b:$a(r.bottom,o.bottom,0,t),l:$a(r.left,o.left,0,e)}}function Ok(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,o=Is(r),l=Math.min(e,t),u=n.borderSkipped,f=i||pt(r);return{topLeft:$a(!f||u.top||u.left,o.topLeft,0,l),topRight:$a(!f||u.top||u.right,o.topRight,0,l),bottomLeft:$a(!f||u.bottom||u.left,o.bottomLeft,0,l),bottomRight:$a(!f||u.bottom||u.right,o.bottomRight,0,l)}}function Mk(n){const e=Yb(n),t=e.right-e.left,i=e.bottom-e.top,r=Nk(n,t/2,i/2),o=Ok(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:o},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function Rm(n,e,t,i){const r=e===null,o=t===null,u=n&&!(r&&o)&&Yb(n,i);return u&&(r||Xa(e,u.left,u.right))&&(o||Xa(t,u.top,u.bottom))}function Rk(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Lk(n,e){n.rect(e.x,e.y,e.w,e.h)}function Lm(n,e,t={}){const i=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,o=(n.x+n.w!==t.x+t.w?e:0)-i,l=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+i,y:n.y+r,w:n.w+o,h:n.h+l,radius:n.radius}}class Ik extends pa{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:r}}=this,{inner:o,outer:l}=Mk(this),u=Rk(l.radius)?Mc:Lk;e.save(),(l.w!==o.w||l.h!==o.h)&&(e.beginPath(),u(e,Lm(l,t,o)),e.clip(),u(e,Lm(o,-t,l)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),u(e,Lm(o,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,i){return Rm(this,e,t,i)}inXRange(e,t){return Rm(this,e,null,t)}inYRange(e,t){return Rm(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:r,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(t+r)/2:t,y:o?i:(i+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const Fy=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},Pk=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class Uy extends pa{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=zt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,r=Tn(i.font),o=r.size,l=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Fy(i,o);let m,p;t.font=r.string,this.isHorizontal()?(m=this.maxWidth,p=this._fitRows(l,o,u,f)+10):(p=this.maxHeight,m=this._fitCols(l,r,u,f)+10),this.width=Math.min(m,e.maxWidth||this.maxWidth),this.height=Math.min(p,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,r){const{ctx:o,maxWidth:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],p=r+u;let v=e;o.textAlign="left",o.textBaseline="middle";let x=-1,S=-p;return this.legendItems.forEach((_,b)=>{const T=i+t/2+o.measureText(_.text).width;(b===0||m[m.length-1]+T+2*u>l)&&(v+=p,m[m.length-(b>0?0:1)]=0,S+=p,x++),f[b]={left:0,top:S,row:x,width:T,height:r},m[m.length-1]+=T+u}),v}_fitCols(e,t,i,r){const{ctx:o,maxHeight:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],p=l-e;let v=u,x=0,S=0,_=0,b=0;return this.legendItems.forEach((T,w)=>{const{itemWidth:A,itemHeight:C}=Bk(i,t,o,T,r);w>0&&S+C+2*u>p&&(v+=x+u,m.push({width:x,height:S}),_+=x+u,b++,x=S=0),f[w]={left:_,top:S,col:b,width:A,height:C},x=Math.max(x,A),S+=C+u}),v+=x,m.push({width:x,height:S}),v}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:r},rtl:o}}=this,l=Ho(o,this.left,this.width);if(this.isHorizontal()){let u=0,f=qn(i,this.left+r,this.right-this.lineWidths[u]);for(const m of t)u!==m.row&&(u=m.row,f=qn(i,this.left+r,this.right-this.lineWidths[u])),m.top+=this.top+e+r,m.left=l.leftForLtr(l.x(f),m.width),f+=m.width+r}else{let u=0,f=qn(i,this.top+e+r,this.bottom-this.columnSizes[u].height);for(const m of t)m.col!==u&&(u=m.col,f=qn(i,this.top+e+r,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+r,m.left=l.leftForLtr(l.x(m.left),m.width),f+=m.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Ep(e,this),this._draw(),Ap(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:r}=this,{align:o,labels:l}=e,u=an.color,f=Ho(e.rtl,this.left,this.width),m=Tn(l.font),{padding:p}=l,v=m.size,x=v/2;let S;this.drawTitle(),r.textAlign=f.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=m.string;const{boxWidth:_,boxHeight:b,itemHeight:T}=Fy(l,v),w=function(I,D,z){if(isNaN(_)||_<=0||isNaN(b)||b<0)return;r.save();const L=it(z.lineWidth,1);if(r.fillStyle=it(z.fillStyle,u),r.lineCap=it(z.lineCap,"butt"),r.lineDashOffset=it(z.lineDashOffset,0),r.lineJoin=it(z.lineJoin,"miter"),r.lineWidth=L,r.strokeStyle=it(z.strokeStyle,u),r.setLineDash(it(z.lineDash,[])),l.usePointStyle){const H={radius:b*Math.SQRT2/2,pointStyle:z.pointStyle,rotation:z.rotation,borderWidth:L},K=f.xPlus(I,_/2),ne=D+x;_b(r,H,K,ne,l.pointStyleWidth&&_)}else{const H=D+Math.max((v-b)/2,0),K=f.leftForLtr(I,_),ne=Is(z.borderRadius);r.beginPath(),Object.values(ne).some(xe=>xe!==0)?Mc(r,{x:K,y:H,w:_,h:b,radius:ne}):r.rect(K,H,_,b),r.fill(),L!==0&&r.stroke()}r.restore()},A=function(I,D,z){Us(r,z.text,I,D+T/2,m,{strikethrough:z.hidden,textAlign:f.textAlign(z.textAlign)})},C=this.isHorizontal(),N=this._computeTitleHeight();C?S={x:qn(o,this.left+p,this.right-i[0]),y:this.top+p+N,line:0}:S={x:this.left+p,y:qn(o,this.top+N+p,this.bottom-t[0].height),line:0},jb(this.ctx,e.textDirection);const E=T+p;this.legendItems.forEach((I,D)=>{r.strokeStyle=I.fontColor,r.fillStyle=I.fontColor;const z=r.measureText(I.text).width,L=f.textAlign(I.textAlign||(I.textAlign=l.textAlign)),H=_+x+z;let K=S.x,ne=S.y;f.setWidth(this.width),C?D>0&&K+H+p>this.right&&(ne=S.y+=E,S.line++,K=S.x=qn(o,this.left+p,this.right-i[S.line])):D>0&&ne+E>this.bottom&&(K=S.x=K+t[S.line].width+p,S.line++,ne=S.y=qn(o,this.top+N+p,this.bottom-t[S.line].height));const xe=f.x(K);if(w(xe,ne,I),K=S4(L,K+_+x,C?K+H:this.right,e.rtl),A(f.x(K),ne,I),C)S.x+=H+p;else if(typeof I.text!="string"){const He=m.lineHeight;S.y+=Xb(I,He)+p}else S.y+=E}),Db(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=Tn(t.font),r=Jn(t.padding);if(!t.display)return;const o=Ho(e.rtl,this.left,this.width),l=this.ctx,u=t.position,f=i.size/2,m=r.top+f;let p,v=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),p=this.top+m,v=qn(e.align,v,this.right-x);else{const _=this.columnSizes.reduce((b,T)=>Math.max(b,T.height),0);p=m+qn(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const S=qn(u,v,v+x);l.textAlign=o.textAlign(Sp(u)),l.textBaseline="middle",l.strokeStyle=t.color,l.fillStyle=t.color,l.font=i.string,Us(l,t.text,S,p,i)}_computeTitleHeight(){const e=this.options.title,t=Tn(e.font),i=Jn(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,r,o;if(Xa(e,this.left,this.right)&&Xa(t,this.top,this.bottom)){for(o=this.legendHitBoxes,i=0;i<o.length;++i)if(r=o[i],Xa(e,r.left,r.left+r.width)&&Xa(t,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!zk(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,o=Pk(r,i);r&&!o&&zt(t.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!o&&zt(t.onHover,[e,i,this],this)}else i&&zt(t.onClick,[e,i,this],this)}}function Bk(n,e,t,i,r){const o=Fk(i,n,e,t),l=Uk(r,i,e.lineHeight);return{itemWidth:o,itemHeight:l}}function Fk(n,e,t,i){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((o,l)=>o.length>l.length?o:l)),e+t.size/2+i.measureText(r).width}function Uk(n,e,t){let i=n;return typeof e.text!="string"&&(i=Xb(e,t)),i}function Xb(n,e){const t=n.text?n.text.length:0;return e*t}function zk(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var Hk={id:"legend",_element:Uy,start(n,e,t){const i=n.legend=new Uy({ctx:n.ctx,options:t,chart:n});nr.configure(n,i,t),nr.addBox(n,i)},stop(n){nr.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;nr.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,r=t.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:r,color:o,useBorderRadius:l,borderRadius:u}}=n.legend.options;return n._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(t?0:void 0),p=Jn(m.borderWidth);return{text:e[f.index].label,fillStyle:m.backgroundColor,fontColor:o,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:m.borderColor,pointStyle:i||m.pointStyle,rotation:m.rotation,textAlign:r||m.textAlign,borderRadius:l&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class $b extends pa{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const r=Qt(i.text)?i.text.length:1;this._padding=Jn(i.padding);const o=r*Tn(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:r,right:o,options:l}=this,u=l.align;let f=0,m,p,v;return this.isHorizontal()?(p=qn(u,i,o),v=t+e,m=o-i):(l.position==="left"?(p=i+e,v=qn(u,r,t),f=Tt*-.5):(p=o-e,v=qn(u,t,r),f=Tt*.5),m=r-t),{titleX:p,titleY:v,maxWidth:m,rotation:f}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=Tn(t.font),o=i.lineHeight/2+this._padding.top,{titleX:l,titleY:u,maxWidth:f,rotation:m}=this._drawArgs(o);Us(e,t.text,0,0,i,{color:t.color,maxWidth:f,rotation:m,textAlign:Sp(t.align),textBaseline:"middle",translation:[l,u]})}}function Wk(n,e){const t=new $b({ctx:n.ctx,options:e,chart:n});nr.configure(n,t,e),nr.addBox(n,t),n.titleBlock=t}var Vk={id:"title",_element:$b,start(n,e,t){Wk(n,t)},stop(n){const e=n.titleBlock;nr.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;nr.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const pc={average(n){if(!n.length)return!1;let e,t,i=new Set,r=0,o=0;for(e=0,t=n.length;e<t;++e){const u=n[e].element;if(u&&u.hasValue()){const f=u.tooltipPosition();i.add(f.x),r+=f.y,++o}}return o===0||i.size===0?!1:{x:[...i].reduce((u,f)=>u+f)/i.size,y:r/o}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,r=Number.POSITIVE_INFINITY,o,l,u;for(o=0,l=n.length;o<l;++o){const f=n[o].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),p=$m(e,m);p<r&&(r=p,u=f)}}if(u){const f=u.tooltipPosition();t=f.x,i=f.y}return{x:t,y:i}}};function Dr(n,e){return e&&(Qt(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function aa(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function Gk(n,e){const{element:t,datasetIndex:i,index:r}=e,o=n.getDatasetMeta(i).controller,{label:l,value:u}=o.getLabelAndValue(r);return{chart:n,label:l,parsed:o.getParsed(r),raw:n.data.datasets[i].data[r],formattedValue:u,dataset:o.getDataset(),dataIndex:r,datasetIndex:i,element:t}}function zy(n,e){const t=n.chart.ctx,{body:i,footer:r,title:o}=n,{boxWidth:l,boxHeight:u}=e,f=Tn(e.bodyFont),m=Tn(e.titleFont),p=Tn(e.footerFont),v=o.length,x=r.length,S=i.length,_=Jn(e.padding);let b=_.height,T=0,w=i.reduce((N,E)=>N+E.before.length+E.lines.length+E.after.length,0);if(w+=n.beforeBody.length+n.afterBody.length,v&&(b+=v*m.lineHeight+(v-1)*e.titleSpacing+e.titleMarginBottom),w){const N=e.displayColors?Math.max(u,f.lineHeight):f.lineHeight;b+=S*N+(w-S)*f.lineHeight+(w-1)*e.bodySpacing}x&&(b+=e.footerMarginTop+x*p.lineHeight+(x-1)*e.footerSpacing);let A=0;const C=function(N){T=Math.max(T,t.measureText(N).width+A)};return t.save(),t.font=m.string,jt(n.title,C),t.font=f.string,jt(n.beforeBody.concat(n.afterBody),C),A=e.displayColors?l+2+e.boxPadding:0,jt(i,N=>{jt(N.before,C),jt(N.lines,C),jt(N.after,C)}),A=0,t.font=p.string,jt(n.footer,C),t.restore(),T+=_.width,{width:T,height:b}}function Yk(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function Xk(n,e,t,i){const{x:r,width:o}=i,l=t.caretSize+t.caretPadding;if(n==="left"&&r+o+l>e.width||n==="right"&&r-o-l<0)return!0}function $k(n,e,t,i){const{x:r,width:o}=t,{width:l,chartArea:{left:u,right:f}}=n;let m="center";return i==="center"?m=r<=(u+f)/2?"left":"right":r<=o/2?m="left":r>=l-o/2&&(m="right"),Xk(m,n,e,t)&&(m="center"),m}function Hy(n,e,t){const i=t.yAlign||e.yAlign||Yk(n,t);return{xAlign:t.xAlign||e.xAlign||$k(n,e,t,i),yAlign:i}}function qk(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function Kk(n,e,t){let{y:i,height:r}=n;return e==="top"?i+=t:e==="bottom"?i-=r+t:i-=r/2,i}function Wy(n,e,t,i){const{caretSize:r,caretPadding:o,cornerRadius:l}=n,{xAlign:u,yAlign:f}=t,m=r+o,{topLeft:p,topRight:v,bottomLeft:x,bottomRight:S}=Is(l);let _=qk(e,u);const b=Kk(e,f,m);return f==="center"?u==="left"?_+=m:u==="right"&&(_-=m):u==="left"?_-=Math.max(p,x)+r:u==="right"&&(_+=Math.max(v,S)+r),{x:Kn(_,0,i.width-e.width),y:Kn(b,0,i.height-e.height)}}function yd(n,e,t){const i=Jn(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function Vy(n){return Dr([],aa(n))}function Zk(n,e,t){return is(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function Gy(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const qb={beforeTitle:ia,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:ia,beforeBody:ia,beforeLabel:ia,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return mt(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ia,afterBody:ia,beforeFooter:ia,footer:ia,afterFooter:ia};function gi(n,e,t,i){const r=n[e].call(t,i);return typeof r>"u"?qb[e].call(t,i):r}class Yy extends pa{static positioners=pc;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&t.options.animation&&i.animations,o=new Ob(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=Zk(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,r=gi(i,"beforeTitle",this,e),o=gi(i,"title",this,e),l=gi(i,"afterTitle",this,e);let u=[];return u=Dr(u,aa(r)),u=Dr(u,aa(o)),u=Dr(u,aa(l)),u}getBeforeBody(e,t){return Vy(gi(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:i}=t,r=[];return jt(e,o=>{const l={before:[],lines:[],after:[]},u=Gy(i,o);Dr(l.before,aa(gi(u,"beforeLabel",this,o))),Dr(l.lines,gi(u,"label",this,o)),Dr(l.after,aa(gi(u,"afterLabel",this,o))),r.push(l)}),r}getAfterBody(e,t){return Vy(gi(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,r=gi(i,"beforeFooter",this,e),o=gi(i,"footer",this,e),l=gi(i,"afterFooter",this,e);let u=[];return u=Dr(u,aa(r)),u=Dr(u,aa(o)),u=Dr(u,aa(l)),u}_createItems(e){const t=this._active,i=this.chart.data,r=[],o=[],l=[];let u=[],f,m;for(f=0,m=t.length;f<m;++f)u.push(Gk(this.chart,t[f]));return e.filter&&(u=u.filter((p,v,x)=>e.filter(p,v,x,i))),e.itemSort&&(u=u.sort((p,v)=>e.itemSort(p,v,i))),jt(u,p=>{const v=Gy(e.callbacks,p);r.push(gi(v,"labelColor",this,p)),o.push(gi(v,"labelPointStyle",this,p)),l.push(gi(v,"labelTextColor",this,p))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=l,this.dataPoints=u,u}update(e,t){const i=this.options.setContext(this.getContext()),r=this._active;let o,l=[];if(!r.length)this.opacity!==0&&(o={opacity:0});else{const u=pc[i.position].call(this,r,this._eventPosition);l=this._createItems(i),this.title=this.getTitle(l,i),this.beforeBody=this.getBeforeBody(l,i),this.body=this.getBody(l,i),this.afterBody=this.getAfterBody(l,i),this.footer=this.getFooter(l,i);const f=this._size=zy(this,i),m=Object.assign({},u,f),p=Hy(this.chart,i,m),v=Wy(i,m,p,this.chart);this.xAlign=p.xAlign,this.yAlign=p.yAlign,o={opacity:1,x:v.x,y:v.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=l,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,r){const o=this.getCaretPosition(e,i,r);t.lineTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.lineTo(o.x3,o.y3)}getCaretPosition(e,t,i){const{xAlign:r,yAlign:o}=this,{caretSize:l,cornerRadius:u}=i,{topLeft:f,topRight:m,bottomLeft:p,bottomRight:v}=Is(u),{x,y:S}=e,{width:_,height:b}=t;let T,w,A,C,N,E;return o==="center"?(N=S+b/2,r==="left"?(T=x,w=T-l,C=N+l,E=N-l):(T=x+_,w=T+l,C=N-l,E=N+l),A=T):(r==="left"?w=x+Math.max(f,p)+l:r==="right"?w=x+_-Math.max(m,v)-l:w=this.caretX,o==="top"?(C=S,N=C-l,T=w-l,A=w+l):(C=S+b,N=C+l,T=w+l,A=w-l),E=C),{x1:T,x2:w,x3:A,y1:C,y2:N,y3:E}}drawTitle(e,t,i){const r=this.title,o=r.length;let l,u,f;if(o){const m=Ho(i.rtl,this.x,this.width);for(e.x=yd(this,i.titleAlign,i),t.textAlign=m.textAlign(i.titleAlign),t.textBaseline="middle",l=Tn(i.titleFont),u=i.titleSpacing,t.fillStyle=i.titleColor,t.font=l.string,f=0;f<o;++f)t.fillText(r[f],m.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+u,f+1===o&&(e.y+=i.titleMarginBottom-u)}}_drawColorBox(e,t,i,r,o){const l=this.labelColors[i],u=this.labelPointStyles[i],{boxHeight:f,boxWidth:m}=o,p=Tn(o.bodyFont),v=yd(this,"left",o),x=r.x(v),S=f<p.lineHeight?(p.lineHeight-f)/2:0,_=t.y+S;if(o.usePointStyle){const b={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},T=r.leftForLtr(x,m)+m/2,w=_+f/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,Km(e,b,T,w),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,Km(e,b,T,w)}else{e.lineWidth=pt(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const b=r.leftForLtr(x,m),T=r.leftForLtr(r.xPlus(x,1),m-2),w=Is(l.borderRadius);Object.values(w).some(A=>A!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,Mc(e,{x:b,y:_,w:m,h:f,radius:w}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),Mc(e,{x:T,y:_+1,w:m-2,h:f-2,radius:w}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(b,_,m,f),e.strokeRect(b,_,m,f),e.fillStyle=l.backgroundColor,e.fillRect(T,_+1,m-2,f-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:r}=this,{bodySpacing:o,bodyAlign:l,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:p}=i,v=Tn(i.bodyFont);let x=v.lineHeight,S=0;const _=Ho(i.rtl,this.x,this.width),b=function(z){t.fillText(z,_.x(e.x+S),e.y+x/2),e.y+=x+o},T=_.textAlign(l);let w,A,C,N,E,I,D;for(t.textAlign=l,t.textBaseline="middle",t.font=v.string,e.x=yd(this,T,i),t.fillStyle=i.bodyColor,jt(this.beforeBody,b),S=u&&T!=="right"?l==="center"?m/2+p:m+2+p:0,N=0,I=r.length;N<I;++N){for(w=r[N],A=this.labelTextColors[N],t.fillStyle=A,jt(w.before,b),C=w.lines,u&&C.length&&(this._drawColorBox(t,e,N,_,i),x=Math.max(v.lineHeight,f)),E=0,D=C.length;E<D;++E)b(C[E]),x=v.lineHeight;jt(w.after,b)}S=0,x=v.lineHeight,jt(this.afterBody,b),e.y-=o}drawFooter(e,t,i){const r=this.footer,o=r.length;let l,u;if(o){const f=Ho(i.rtl,this.x,this.width);for(e.x=yd(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=f.textAlign(i.footerAlign),t.textBaseline="middle",l=Tn(i.footerFont),t.fillStyle=i.footerColor,t.font=l.string,u=0;u<o;++u)t.fillText(r[u],f.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+i.footerSpacing}}drawBackground(e,t,i,r){const{xAlign:o,yAlign:l}=this,{x:u,y:f}=e,{width:m,height:p}=i,{topLeft:v,topRight:x,bottomLeft:S,bottomRight:_}=Is(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(u+v,f),l==="top"&&this.drawCaret(e,t,i,r),t.lineTo(u+m-x,f),t.quadraticCurveTo(u+m,f,u+m,f+x),l==="center"&&o==="right"&&this.drawCaret(e,t,i,r),t.lineTo(u+m,f+p-_),t.quadraticCurveTo(u+m,f+p,u+m-_,f+p),l==="bottom"&&this.drawCaret(e,t,i,r),t.lineTo(u+S,f+p),t.quadraticCurveTo(u,f+p,u,f+p-S),l==="center"&&o==="left"&&this.drawCaret(e,t,i,r),t.lineTo(u,f+v),t.quadraticCurveTo(u,f,u+v,f),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,r=i&&i.x,o=i&&i.y;if(r||o){const l=pc[e.position].call(this,this._active,this._eventPosition);if(!l)return;const u=this._size=zy(this,e),f=Object.assign({},l,this._size),m=Hy(t,e,f),p=Wy(e,f,m,t);(r._to!==p.x||o._to!==p.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,p))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},o={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const l=Jn(t.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&u&&(e.save(),e.globalAlpha=i,this.drawBackground(o,e,r,t),jb(e,t.textDirection),o.y+=l.top,this.drawTitle(o,e,t),this.drawBody(o,e,t),this.drawFooter(o,e,t),Db(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,r=e.map(({datasetIndex:u,index:f})=>{const m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),o=!Ld(i,r),l=this._positionChanged(r,t);(o||l)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,o=this._active||[],l=this._getActiveElements(e,o,t,i),u=this._positionChanged(l,e),f=t||!Ld(l,o)||u;return f&&(this._active=l,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),f}_getActiveElements(e,t,i,r){const o=this.options;if(e.type==="mouseout")return[];if(!r)return t.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,o.mode,o,i);return o.reverse&&l.reverse(),l}_positionChanged(e,t){const{caretX:i,caretY:r,options:o}=this,l=pc[o.position].call(this,e,t);return l!==!1&&(i!==l.x||r!==l.y)}}var Qk={id:"tooltip",_element:Yy,positioners:pc,afterInit(n,e,t){t&&(n.tooltip=new Yy({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:qb},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Jk=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function e5(n,e,t,i){const r=n.indexOf(e);if(r===-1)return Jk(n,e,t,i);const o=n.lastIndexOf(e);return r!==o?t:r}const t5=(n,e)=>n===null?null:Kn(Math.round(n),0,e);function Xy(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class n5 extends el{static id="category";static defaults={ticks:{callback:Xy}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:r,label:o}of t)i[r]===o&&i.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(mt(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:e5(i,e,it(t,e),this._addedLabels),t5(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,r=[];let o=this.getLabels();o=e===0&&t===o.length-1?o:o.slice(e,t+1),this._valueRange=Math.max(o.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let l=e;l<=t;l++)r.push({value:l});return r}getLabelForValue(e){return Xy.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function i5(n,e){const t=[],{bounds:r,step:o,min:l,max:u,precision:f,count:m,maxTicks:p,maxDigits:v,includeBounds:x}=n,S=o||1,_=p-1,{min:b,max:T}=e,w=!mt(l),A=!mt(u),C=!mt(m),N=(T-b)/(v+1);let E=qv((T-b)/_/S)*S,I,D,z,L;if(E<1e-14&&!w&&!A)return[{value:b},{value:T}];L=Math.ceil(T/E)-Math.floor(b/E),L>_&&(E=qv(L*E/_/S)*S),mt(f)||(I=Math.pow(10,f),E=Math.ceil(E*I)/I),r==="ticks"?(D=Math.floor(b/E)*E,z=Math.ceil(T/E)*E):(D=b,z=T),w&&A&&o&&h4((u-l)/o,E/1e3)?(L=Math.round(Math.min((u-l)/E,p)),E=(u-l)/L,D=l,z=u):C?(D=w?l:D,z=A?u:z,L=m-1,E=(z-D)/L):(L=(z-D)/E,yc(L,Math.round(L),E/1e3)?L=Math.round(L):L=Math.ceil(L));const H=Math.max(Kv(E),Kv(D));I=Math.pow(10,mt(f)?H:f),D=Math.round(D*I)/I,z=Math.round(z*I)/I;let K=0;for(w&&(x&&D!==l?(t.push({value:l}),D<l&&K++,yc(Math.round((D+K*E)*I)/I,l,$y(l,N,n))&&K++):D<l&&K++);K<L;++K){const ne=Math.round((D+K*E)*I)/I;if(A&&ne>u)break;t.push({value:ne})}return A&&x&&z!==u?t.length&&yc(t[t.length-1].value,u,$y(u,N,n))?t[t.length-1].value=u:t.push({value:u}):(!A||z===u)&&t.push({value:z}),t}function $y(n,e,{horizontal:t,minRotation:i}){const r=Lr(i),o=(t?Math.sin(r):Math.cos(r))||.001,l=.75*e*(""+n).length;return Math.min(e/o,l)}class ep extends el{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return mt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:r,max:o}=this;const l=f=>r=t?r:f,u=f=>o=i?o:f;if(e){const f=Ir(r),m=Ir(o);f<0&&m<0?u(0):f>0&&m>0&&l(0)}if(r===o){let f=o===0?1:Math.abs(o*.05);u(o+f),e||l(r-f)}this.min=r,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},o=this._range||this,l=i5(r,o);return e.bounds==="ticks"&&m4(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-t)/Math.max(e.length-1,1)/2;t-=r,i+=r}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return Tp(e,this.chart.options.locale,this.options.ticks.format)}}class r5 extends ep{static id="linear";static defaults={ticks:{callback:wp.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Si(e)?e:0,this.max=Si(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=Lr(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,o.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}function tp(n){const e=n.ticks;if(e.display&&n.display){const t=Jn(e.backdropPadding);return it(e.font&&e.font.size,an.font.size)+t.height}return 0}function a5(n,e,t){return t=Qt(t)?t:[t],{w:R4(n,e.string,t),h:t.length*e.lineHeight}}function qy(n,e,t,i,r){return n===i||n===r?{start:e-t/2,end:e+t/2}:n<i||n>r?{start:e-t,end:e}:{start:e,end:e+t}}function s5(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],r=[],o=n._pointLabels.length,l=n.options.pointLabels,u=l.centerPointLabels?Tt/o:0;for(let f=0;f<o;f++){const m=l.setContext(n.getPointLabelContext(f));r[f]=m.padding;const p=n.getPointPosition(f,n.drawingArea+r[f],u),v=Tn(m.font),x=a5(n.ctx,v,n._pointLabels[f]);i[f]=x;const S=yi(n.getIndexAngle(f)+u),_=Math.round(xp(S)),b=qy(_,p.x,x.w,0,180),T=qy(_,p.y,x.h,90,270);o5(t,e,S,b,T)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=u5(n,i,r)}function o5(n,e,t,i,r){const o=Math.abs(Math.sin(t)),l=Math.abs(Math.cos(t));let u=0,f=0;i.start<e.l?(u=(e.l-i.start)/o,n.l=Math.min(n.l,e.l-u)):i.end>e.r&&(u=(i.end-e.r)/o,n.r=Math.max(n.r,e.r+u)),r.start<e.t?(f=(e.t-r.start)/l,n.t=Math.min(n.t,e.t-f)):r.end>e.b&&(f=(r.end-e.b)/l,n.b=Math.max(n.b,e.b+f))}function l5(n,e,t){const i=n.drawingArea,{extra:r,additionalAngle:o,padding:l,size:u}=t,f=n.getPointPosition(e,i+r+l,o),m=Math.round(xp(yi(f.angle+cn))),p=h5(f.y,u.h,m),v=d5(m),x=f5(f.x,u.w,v);return{visible:!0,x:f.x,y:p,textAlign:v,left:x,top:p,right:x+u.w,bottom:p+u.h}}function c5(n,e){if(!e)return!0;const{left:t,top:i,right:r,bottom:o}=n;return!(oa({x:t,y:i},e)||oa({x:t,y:o},e)||oa({x:r,y:i},e)||oa({x:r,y:o},e))}function u5(n,e,t){const i=[],r=n._pointLabels.length,o=n.options,{centerPointLabels:l,display:u}=o.pointLabels,f={extra:tp(o)/2,additionalAngle:l?Tt/r:0};let m;for(let p=0;p<r;p++){f.padding=t[p],f.size=e[p];const v=l5(n,p,f);i.push(v),u==="auto"&&(v.visible=c5(v,m),v.visible&&(m=v))}return i}function d5(n){return n===0||n===180?"center":n<180?"left":"right"}function f5(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function h5(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function m5(n,e,t){const{left:i,top:r,right:o,bottom:l}=t,{backdropColor:u}=e;if(!mt(u)){const f=Is(e.borderRadius),m=Jn(e.backdropPadding);n.fillStyle=u;const p=i-m.left,v=r-m.top,x=o-i+m.width,S=l-r+m.height;Object.values(f).some(_=>_!==0)?(n.beginPath(),Mc(n,{x:p,y:v,w:x,h:S,radius:f}),n.fill()):n.fillRect(p,v,x,S)}}function p5(n,e){const{ctx:t,options:{pointLabels:i}}=n;for(let r=e-1;r>=0;r--){const o=n._pointLabelItems[r];if(!o.visible)continue;const l=i.setContext(n.getPointLabelContext(r));m5(t,l,o);const u=Tn(l.font),{x:f,y:m,textAlign:p}=o;Us(t,n._pointLabels[r],f,m+u.lineHeight/2,u,{color:l.color,textAlign:p,textBaseline:"middle"})}}function Kb(n,e,t,i){const{ctx:r}=n;if(t)r.arc(n.xCenter,n.yCenter,e,0,Yt);else{let o=n.getPointPosition(0,e);r.moveTo(o.x,o.y);for(let l=1;l<i;l++)o=n.getPointPosition(l,e),r.lineTo(o.x,o.y)}}function g5(n,e,t,i,r){const o=n.ctx,l=e.circular,{color:u,lineWidth:f}=e;!l&&!i||!u||!f||t<0||(o.save(),o.strokeStyle=u,o.lineWidth=f,o.setLineDash(r.dash||[]),o.lineDashOffset=r.dashOffset,o.beginPath(),Kb(n,t,l,i),o.closePath(),o.stroke(),o.restore())}function v5(n,e,t){return is(n,{label:t,index:e,type:"pointLabel"})}class y5 extends ep{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:wp.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Jn(tp(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Si(e)&&!isNaN(e)?e:0,this.max=Si(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/tp(this.options))}generateTickLabels(e){ep.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const r=zt(this.options.pointLabels.callback,[t,i],this);return r||r===0?r:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?s5(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,r))}getIndexAngle(e){const t=Yt/(this._pointLabels.length||1),i=this.options.startAngle||0;return yi(e*t+Lr(i))}getDistanceFromCenterForValue(e){if(mt(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(mt(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return v5(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const r=this.getIndexAngle(e)-cn+i;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:r,bottom:o}=this._pointLabelItems[e];return{left:t,top:i,right:r,bottom:o}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),Kb(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:r,border:o}=t,l=this._pointLabels.length;let u,f,m;if(t.pointLabels.display&&p5(this,l),r.display&&this.ticks.forEach((p,v)=>{if(v!==0||v===0&&this.min<0){f=this.getDistanceFromCenterForValue(p.value);const x=this.getContext(v),S=r.setContext(x),_=o.setContext(x);g5(this,S,f,l,_)}}),i.display){for(e.save(),u=l-1;u>=0;u--){const p=i.setContext(this.getPointLabelContext(u)),{color:v,lineWidth:x}=p;!x||!v||(e.lineWidth=x,e.strokeStyle=v,e.setLineDash(p.borderDash),e.lineDashOffset=p.borderDashOffset,f=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),m=this.getPointPosition(u,f),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(m.x,m.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let o,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((u,f)=>{if(f===0&&this.min>=0&&!t.reverse)return;const m=i.setContext(this.getContext(f)),p=Tn(m.font);if(o=this.getDistanceFromCenterForValue(this.ticks[f].value),m.showLabelBackdrop){e.font=p.string,l=e.measureText(u.label).width,e.fillStyle=m.backdropColor;const v=Jn(m.backdropPadding);e.fillRect(-l/2-v.left,-o-p.size/2-v.top,l+v.width,p.size+v.height)}Us(e,u.label,0,-o,p,{color:m.color,strokeColor:m.textStrokeColor,strokeWidth:m.textStrokeWidth})}),e.restore()}drawTitle(){}}const cf={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},xi=Object.keys(cf);function Ky(n,e){return n-e}function Zy(n,e){if(mt(e))return null;const t=n._adapter,{parser:i,round:r,isoWeekday:o}=n._parseOpts;let l=e;return typeof i=="function"&&(l=i(l)),Si(l)||(l=typeof i=="string"?t.parse(l,i):t.parse(l)),l===null?null:(r&&(l=r==="week"&&(Nc(o)||o===!0)?t.startOf(l,"isoWeek",o):t.startOf(l,r)),+l)}function Qy(n,e,t,i){const r=xi.length;for(let o=xi.indexOf(n);o<r-1;++o){const l=cf[xi[o]],u=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((t-e)/(u*l.size))<=i)return xi[o]}return xi[r-1]}function x5(n,e,t,i,r){for(let o=xi.length-1;o>=xi.indexOf(t);o--){const l=xi[o];if(cf[l].common&&n._adapter.diff(r,i,l)>=e-1)return l}return xi[t?xi.indexOf(t):0]}function b5(n){for(let e=xi.indexOf(n)+1,t=xi.length;e<t;++e)if(cf[xi[e]].common)return xi[e]}function Jy(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:r}=bp(t,e),o=t[i]>=e?t[i]:t[r];n[o]=!0}}function S5(n,e,t,i){const r=n._adapter,o=+r.startOf(e[0].value,i),l=e[e.length-1].value;let u,f;for(u=o;u<=l;u=+r.add(u,1,i))f=t[u],f>=0&&(e[f].major=!0);return e}function ex(n,e,t){const i=[],r={},o=e.length;let l,u;for(l=0;l<o;++l)u=e[l],r[u]=l,i.push({value:u,major:!1});return o===0||!t?i:S5(n,i,r,t)}class tx extends el{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),r=this._adapter=new r3._date(e.adapters.date);r.init(t),vc(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:Zy(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:r,max:o,minDefined:l,maxDefined:u}=this.getUserBounds();function f(m){!l&&!isNaN(m.min)&&(r=Math.min(r,m.min)),!u&&!isNaN(m.max)&&(o=Math.max(o,m.max))}(!l||!u)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),r=Si(r)&&!isNaN(r)?r:+t.startOf(Date.now(),i),o=Si(o)&&!isNaN(o)?o:+t.endOf(Date.now(),i)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,l=this.max,u=y4(r,o,l);return this._unit=t.unit||(i.autoSkip?Qy(t.minUnit,this.min,this.max,this._getLabelCapacity(o)):x5(this,u.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:b5(this._unit),this.initOffsets(r),e.reverse&&u.reverse(),ex(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,r,o;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?i=o:i=(o-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;t=Kn(t,0,l),i=Kn(i,0,l),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,r=this.options,o=r.time,l=o.unit||Qy(o.minUnit,t,i,this._getLabelCapacity(t)),u=it(r.ticks.stepSize,1),f=l==="week"?o.isoWeekday:!1,m=Nc(f)||f===!0,p={};let v=t,x,S;if(m&&(v=+e.startOf(v,"isoWeek",f)),v=+e.startOf(v,m?"day":l),e.diff(i,t,l)>1e5*u)throw new Error(t+" and "+i+" are too far apart with stepSize of "+u+" "+l);const _=r.ticks.source==="data"&&this.getDataTimestamps();for(x=v,S=0;x<i;x=+e.add(x,u,l),S++)Jy(p,x,_);return(x===i||r.bounds==="ticks"||S===1)&&Jy(p,x,_),Object.keys(p).sort(Ky).map(b=>+b)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,o=this._unit,l=t||r[o];return this._adapter.format(e,l)}_tickFormatFunction(e,t,i,r){const o=this.options,l=o.ticks.callback;if(l)return zt(l,[e,t,i],this);const u=o.time.displayFormats,f=this._unit,m=this._majorUnit,p=f&&u[f],v=m&&u[m],x=i[t],S=m&&v&&x&&x.major;return this._adapter.format(e,r||(S?v:p))}generateTickLabels(e){let t,i,r;for(t=0,i=e.length;t<i;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,r=Lr(this.isHorizontal()?t.maxRotation:t.minRotation),o=Math.cos(r),l=Math.sin(r),u=this._resolveTickFontOptions(0).size;return{w:i*o+u*l,h:i*l+u*o}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,r=i[t.unit]||i.millisecond,o=this._tickFormatFunction(e,0,ex(this,[e],this._majorUnit),r),l=this._getLabelSize(o),u=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,i=r.length;t<i;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const r=this.getLabels();for(t=0,i=r.length;t<i;++t)e.push(Zy(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return xb(e.sort(Ky))}}function xd(n,e,t){let i=0,r=n.length-1,o,l,u,f;t?(e>=n[i].pos&&e<=n[r].pos&&({lo:i,hi:r}=Ls(n,"pos",e)),{pos:o,time:u}=n[i],{pos:l,time:f}=n[r]):(e>=n[i].time&&e<=n[r].time&&({lo:i,hi:r}=Ls(n,"time",e)),{time:o,pos:u}=n[i],{time:l,pos:f}=n[r]);const m=l-o;return m?u+(f-u)*(e-o)/m:u}class BR extends tx{static id="timeseries";static defaults=tx.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=xd(t,this.min),this._tableRange=xd(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,r=[],o=[];let l,u,f,m,p;for(l=0,u=e.length;l<u;++l)m=e[l],m>=t&&m<=i&&r.push(m);if(r.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(l=0,u=r.length;l<u;++l)p=r[l+1],f=r[l-1],m=r[l],Math.round((p+f)/2)!==m&&o.push({time:m,pos:l/(u-1)});return o}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((r,o)=>r-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(xd(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return xd(this._table,i*this._tableRange+this._minPos,!0)}}const Zb="label";function nx(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function _5(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function Qb(n,e){n.labels=e}function Jb(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zb;const i=[];n.datasets=e.map(r=>{const o=n.datasets.find(l=>l[t]===r[t]);return!o||!r.data||i.includes(o)?{...r}:(i.push(o),Object.assign(o,r),o)})}function T5(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zb;const t={labels:[],datasets:[]};return Qb(t,n.labels),Jb(t,n.datasets,e),t}function w5(n,e){const{height:t=150,width:i=300,redraw:r=!1,datasetIdKey:o,type:l,data:u,options:f,plugins:m=[],fallbackContent:p,updateMode:v,...x}=n,S=W.useRef(null),_=W.useRef(null),b=()=>{S.current&&(_.current=new lf(S.current,{type:l,data:T5(u,o),options:f&&{...f},plugins:m}),nx(e,_.current))},T=()=>{nx(e,null),_.current&&(_.current.destroy(),_.current=null)};return W.useEffect(()=>{!r&&_.current&&f&&_5(_.current,f)},[r,f]),W.useEffect(()=>{!r&&_.current&&Qb(_.current.config.data,u.labels)},[r,u.labels]),W.useEffect(()=>{!r&&_.current&&u.datasets&&Jb(_.current.config.data,u.datasets,o)},[r,u.datasets]),W.useEffect(()=>{_.current&&(r?(T(),setTimeout(b)):_.current.update(v))},[r,f,u.labels,u.datasets,v]),W.useEffect(()=>{_.current&&(T(),setTimeout(b))},[l]),W.useEffect(()=>(b(),()=>T()),[]),zo.createElement("canvas",{ref:S,role:"img",height:t,width:i,...x},p)}const E5=W.forwardRef(w5);function uf(n,e){return lf.register(e),W.forwardRef((t,i)=>zo.createElement(E5,{...t,ref:i,type:n}))}const A5=uf("line",n3),k5=uf("bar",JA),C5=uf("radar",i3),j5=uf("doughnut",t3),ix=[{id:"1",name:"Enterprise CRM Implementation",client:"Salesforce",clientId:"1",color:"#00a1e0",rate:285,description:"Full Salesforce deployment for global enterprise sales team",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-01-15",expectedEndDate:"2025-05-30",createdAt:"2025-01-15"},{id:"2",name:"Marketing Automation Platform",client:"HubSpot",clientId:"2",color:"#ff7a59",rate:265,description:"HubSpot marketing automation setup for lead nurturing campaigns",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-02-01",expectedEndDate:"2025-06-15",createdAt:"2025-02-01"},{id:"3",name:"Customer Support Portal Migration",client:"Zendesk",clientId:"3",color:"#03363d",rate:225,description:"Migrate legacy support system to Zendesk with custom workflows",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-12-01",expectedEndDate:"2025-04-15",createdAt:"2025-12-01"},{id:"4",name:"Project Management Rollout",client:"Monday.com",clientId:"4",color:"#ff3d57",rate:195,description:"Monday.com deployment across 15 departments with custom workflows",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-03-15",expectedEndDate:"2025-04-30",createdAt:"2025-03-05"},{id:"5",name:"Identity & Access Management",client:"Okta",clientId:"5",color:"#007dc1",rate:295,description:"Okta SSO implementation with multi-factor authentication",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-08-12",expectedEndDate:"2025-02-28",createdAt:"2025-08-12"},{id:"6",name:"Enterprise Communication Platform",client:"Slack",clientId:"6",color:"#4a154b",rate:275,description:"Slack Enterprise Grid setup for 5,000+ employees",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-09-18",expectedEndDate:"2025-03-31",createdAt:"2025-09-18"},{id:"7",name:"Digital Signature Workflow",client:"DocuSign",clientId:"7",color:"#ffb900",rate:215,description:"DocuSign integration with existing contract management system",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-01-25",expectedEndDate:"2025-05-15",createdAt:"2025-01-25"},{id:"8",name:"Video Communications Platform",client:"Zoom",clientId:"8",color:"#2d8cff",rate:255,description:"Zoom Enterprise deployment with webinar and phone integration",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-12-08",expectedEndDate:"2025-04-30",createdAt:"2025-12-08"},{id:"9",name:"Developer Toolchain Modernization",client:"Atlassian",clientId:"9",color:"#0052cc",rate:270,description:"Atlassian suite implementation: Jira, Confluence, Bitbucket",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-10-14",expectedEndDate:"2025-03-31",createdAt:"2025-10-14"},{id:"10",name:"Communication API Integration",client:"Twilio",clientId:"10",color:"#f22f46",rate:235,description:"Twilio API integration for SMS/voice notifications",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-02-12",expectedEndDate:"2025-05-30",createdAt:"2025-02-12"},{id:"11",name:"Internal Operations",client:"Internal",clientId:"11",color:"#6b7280",rate:0,description:"Internal meetings, team development, and administrative tasks",category:"ongoing-support",status:"active",active:!0,billable:!1,startDate:"2025-01-01",createdAt:"2025-01-01"}],D5=[{id:"1",name:"google-calendar",enabled:!0,connectedAt:"2024-01-10T10:00:00Z",lastSync:"2024-06-28T14:30:00Z",settings:{autoCreateEntries:!0,defaultCategory:"client",syncCalendars:["primary","work@company.com"]}},{id:"2",name:"slack",enabled:!0,connectedAt:"2024-01-10T10:00:00Z",lastSync:"2024-06-28T14:25:00Z",settings:{trackDMs:!0,trackChannels:["#customer-success","#implementations"],minimumDuration:5}},{id:"3",name:"zoom",enabled:!0,connectedAt:"2024-01-12T09:00:00Z",lastSync:"2024-06-28T13:45:00Z",settings:{autoTrackMeetings:!0,excludePersonalMeetings:!0}},{id:"4",name:"teams",enabled:!1,settings:{}},{id:"5",name:"salesforce",enabled:!0,connectedAt:"2024-02-01T11:00:00Z",lastSync:"2024-06-28T15:00:00Z",settings:{syncOpportunities:!0,autoCreateProjects:!0}}],rx=[{id:"1",date:"2025-07-13",startTime:"09:00",endTime:"10:30",duration:1.5,client:"Salesforce",project:"Enterprise CRM Implementation",description:"Project kickoff with Salesforce stakeholders - scope and timeline review",category:"client",status:"pending",automated:!0,source:"calendar",meetingType:"kickoff",billable:!0,rate:285,tags:["kickoff","stakeholders","planning"]},{id:"2",date:"2025-07-13",startTime:"10:45",endTime:"11:15",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"1:1 with manager Jessica - quarterly goal alignment and feedback",category:"internal",status:"pending",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["1:1","manager","goals","feedback"]},{id:"3",date:"2025-07-13",startTime:"13:00",endTime:"14:00",duration:1,client:"HubSpot",project:"Marketing Automation Platform",description:"Discovery session with HubSpot marketing team for lead scoring workflows",category:"client",status:"pending",automated:!0,source:"zoom",meetingType:"discovery",billable:!0,rate:265,tags:["discovery","marketing","lead-scoring"]},{id:"4",date:"2025-07-13",startTime:"15:30",endTime:"16:30",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"All-hands company meeting - Q2 results and new product roadmap",category:"internal",status:"pending",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["all-hands","q2-results","roadmap"]},{id:"5",date:"2025-07-12",startTime:"09:00",endTime:"10:00",duration:1,client:"Zendesk",project:"Customer Support Portal Migration",description:"Technical requirements review with Zendesk integration team",category:"client",status:"submitted",automated:!0,source:"calendar",meetingType:"discovery",billable:!0,rate:225,tags:["technical","requirements","integration"]},{id:"6",date:"2025-07-12",startTime:"10:30",endTime:"11:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Daily standup - sprint retrospective and planning for next iteration",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["standup","sprint","retrospective"]},{id:"7",date:"2025-07-12",startTime:"14:00",endTime:"15:30",duration:1.5,client:"Monday.com",project:"Project Management Rollout",description:"Training session for department heads on Monday.com workflows",category:"client",status:"submitted",automated:!0,source:"zoom",meetingType:"training",billable:!0,rate:195,tags:["training","workflows","department-heads"]},{id:"8",date:"2025-07-11",startTime:"16:00",endTime:"16:45",duration:.75,client:"Okta",project:"Identity & Access Management",description:"Slack discussion thread - troubleshooting SSO configuration issues",category:"client",status:"submitted",automated:!0,source:"slack",billable:!0,rate:295,tags:["support","sso","troubleshooting"]},{id:"9",date:"2025-07-10",startTime:"09:00",endTime:"10:30",duration:1.5,client:"Slack Technologies",project:"Enterprise Communication Platform",description:"Monthly business review with Slack executive team",category:"client",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!0,rate:275,tags:["mbr","executive","monthly-review"]},{id:"10",date:"2025-07-10",startTime:"11:00",endTime:"12:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Customer Success team standup - pipeline review and account updates",category:"internal",status:"approved",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["cs-team","pipeline","accounts"]},{id:"11",date:"2025-07-10",startTime:"13:30",endTime:"14:30",duration:1,client:"DocuSign",project:"Digital Signature Workflow",description:"Implementation planning session with DocuSign product team",category:"client",status:"approved",automated:!0,source:"zoom",meetingType:"implementation",billable:!0,rate:215,tags:["implementation","planning","product-team"]},{id:"12",date:"2025-07-10",startTime:"15:30",endTime:"16:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Expense report submission and timesheet review",category:"admin",status:"approved",automated:!1,billable:!1,tags:["admin","expenses","timesheet"]},{id:"13",date:"2025-07-09",startTime:"10:00",endTime:"11:30",duration:1.5,client:"Zoom Video Communications",project:"Video Communications Platform",description:"Training session with Zoom admins on enterprise features and webinars",category:"client",status:"approved",automated:!0,source:"zoom",meetingType:"training",billable:!0,rate:255,tags:["training","enterprise","webinars"]},{id:"14",date:"2025-07-09",startTime:"14:00",endTime:"15:00",duration:1,client:"Atlassian",project:"Developer Toolchain Modernization",description:"Escalation call with Atlassian CTO - critical integration blockers",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"escalation",billable:!0,rate:270,tags:["escalation","cto","blockers"]},{id:"15",date:"2025-07-09",startTime:"16:30",endTime:"17:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"1:1 with direct report Alex - career development and project assignments",category:"internal",status:"approved",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["1:1","direct-report","career-development"]},{id:"16",date:"2025-07-08",startTime:"09:00",endTime:"09:30",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Daily team standup - sprint planning and impediment review",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["standup","sprint","impediments"]},{id:"17",date:"2025-07-08",startTime:"11:00",endTime:"12:00",duration:1,client:"Twilio",project:"Communication API Integration",description:"Discovery session for SMS and voice notification requirements",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"discovery",billable:!0,rate:235,tags:["discovery","sms","voice","notifications"]},{id:"18",date:"2025-07-08",startTime:"15:00",endTime:"16:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Engineering sync - technical debt review and architecture decisions",category:"internal",status:"approved",automated:!0,source:"slack",meetingType:"check-in",billable:!1,tags:["engineering","tech-debt","architecture"]},{id:"19",date:"2025-07-07",startTime:"09:30",endTime:"10:30",duration:1,client:"HubSpot",project:"Marketing Automation Platform",description:"Support escalation - campaign automation not triggering properly",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"support",billable:!0,rate:265,tags:["support","automation","campaigns"]},{id:"20",date:"2025-07-07",startTime:"13:00",endTime:"14:30",duration:1.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Quarterly all-hands - company strategy and new hiring initiatives",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["quarterly","all-hands","strategy","hiring"]},{id:"21",date:"2025-07-06",startTime:"10:00",endTime:"11:00",duration:1,client:"Salesforce",project:"Enterprise CRM Implementation",description:"Weekly implementation status meeting with project stakeholders",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"implementation",billable:!0,rate:285,tags:["weekly","status","stakeholders"]},{id:"22",date:"2025-07-06",startTime:"14:00",endTime:"15:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Team retrospective - process improvements and workflow optimization",category:"internal",status:"approved",automated:!0,source:"zoom",meetingType:"check-in",billable:!1,tags:["retrospective","process","optimization"]}],uc={workingHours:{start:"09:00",end:"17:00"},notifications:!0,theme:"light",integrations:D5},bd={theme:"light",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,workingHours:{start:"09:00",end:"17:00",workingDays:[1,2,3,4,5]},notifications:{enableDesktop:!0,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:{}},eS=()=>{const[n,e]=W.useState({timeEntries:[],projects:[],clients:[],settings:bd,isLoading:!0,error:null});W.useEffect(()=>{(async()=>{try{e(E=>({...E,isLoading:!0,error:null})),await It.init();const[w,A,C,N]=await Promise.all([It.getAllTimeEntries(),It.getAllProjects(),It.getAllClients(),It.getSettings()]);if(w.length===0){console.log("🔄 No time entries found. Loading mock data..."),await It.clearAllData(),await t();const[E,I,D]=await Promise.all([It.getAllTimeEntries(),It.getAllProjects(),It.getAllClients()]);e({timeEntries:E,projects:I,clients:D,settings:N||bd,isLoading:!1,error:null})}else e({timeEntries:w,projects:A,clients:C,settings:N||bd,isLoading:!1,error:null});console.log("✅ Data loaded from database")}catch(w){console.error("❌ Failed to load data:",w),e(A=>({...A,isLoading:!1,error:w instanceof Error?w.message:"Failed to load data"}))}})()},[]);const t=async()=>{console.log("🚀 Creating initial data with mock entries...");for(const w of ix)await It.addProject(w);for(const w of rx)await It.addTimeEntry(w);const T={theme:uc.theme,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,workingHours:{start:uc.workingHours.start,end:uc.workingHours.end,workingDays:[1,2,3,4,5]},notifications:{enableDesktop:uc.notifications,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:uc.integrations.reduce((w,A)=>(w[A.name]={enabled:A.enabled,lastSync:A.lastSync,connectedAt:A.connectedAt,settings:A.settings},w),{})};await It.updateSettings(T),console.log("✅ Initial data created with",rx.length,"time entries and",ix.length,"projects")},i=W.useCallback(async T=>{try{const w={...T,id:crypto.randomUUID()};return await It.addTimeEntry(w),e(A=>({...A,timeEntries:[...A.timeEntries,w]})),w}catch(w){throw console.error("❌ Failed to add time entry:",w),w}},[]),r=W.useCallback(async(T,w)=>{try{await It.updateTimeEntry(T,w),e(A=>({...A,timeEntries:A.timeEntries.map(C=>C.id===T?{...C,...w}:C)}))}catch(A){throw console.error("❌ Failed to update time entry:",A),A}},[]),o=W.useCallback(async T=>{try{await It.deleteTimeEntry(T),e(w=>({...w,timeEntries:w.timeEntries.filter(A=>A.id!==T)}))}catch(w){throw console.error("❌ Failed to delete time entry:",w),w}},[]),l=W.useCallback(async T=>{try{const w={...T,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return await It.addProject(w),e(A=>({...A,projects:[...A.projects,w]})),w}catch(w){throw console.error("❌ Failed to add project:",w),w}},[]),u=W.useCallback(async(T,w)=>{try{await It.updateProject(T,w),e(A=>({...A,projects:A.projects.map(C=>C.id===T?{...C,...w}:C)}))}catch(A){throw console.error("❌ Failed to update project:",A),A}},[]),f=W.useCallback(async T=>{try{await It.deleteProject(T),e(w=>({...w,projects:w.projects.filter(A=>A.id!==T)}))}catch(w){throw console.error("❌ Failed to delete project:",w),w}},[]),m=W.useCallback(async T=>{try{const w={...T,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return await It.addClient(w),e(A=>({...A,clients:[...A.clients,w]})),w}catch(w){throw console.error("❌ Failed to add client:",w),w}},[]),p=W.useCallback(async(T,w)=>{try{await It.updateClient(T,w),e(A=>({...A,clients:A.clients.map(C=>C.id===T?{...C,...w}:C)}))}catch(A){throw console.error("❌ Failed to update client:",A),A}},[]),v=W.useCallback(async T=>{try{await It.deleteClient(T),e(w=>({...w,clients:w.clients.filter(A=>A.id!==T)}))}catch(w){throw console.error("❌ Failed to delete client:",w),w}},[]),x=W.useCallback(async T=>{try{await It.updateSettings(T),e(w=>({...w,settings:T}))}catch(w){throw console.error("❌ Failed to update settings:",w),w}},[]),S=W.useCallback(T=>{console.log("🔗 Toggle integration:",T),e(w=>({...w,settings:{...w.settings,integrations:{...w.settings.integrations,[T]:{enabled:!w.settings.integrations[T]?.enabled,lastSync:new Date().toISOString()}}}}))},[]),_=W.useCallback(async T=>{try{const w=await It.exportAllData();if(T==="json"){const A=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),C=URL.createObjectURL(A),N=document.createElement("a");N.href=C,N.download=`timebeacon-backup-${new Date().toISOString().split("T")[0]}.json`,N.click(),URL.revokeObjectURL(C)}else{const A=["Date,Start Time,End Time,Duration,Client,Project,Description,Status,Billable",...w.timeEntries.map(I=>[I.date,I.startTime,I.endTime,I.duration,I.client,I.project,`"${I.description.replace(/"/g,'""')}"`,I.status,I.billable?"Yes":"No"].join(","))].join(`
`),C=new Blob([A],{type:"text/csv"}),N=URL.createObjectURL(C),E=document.createElement("a");E.href=N,E.download=`timebeacon-entries-${new Date().toISOString().split("T")[0]}.csv`,E.click(),URL.revokeObjectURL(N)}console.log("✅ Data exported successfully")}catch(w){throw console.error("❌ Failed to export data:",w),w}},[]),b=W.useCallback(async()=>{try{await It.clearAllData(),e({timeEntries:[],projects:[],clients:[],settings:bd,isLoading:!1,error:null}),console.log("✅ All data cleared")}catch(T){throw console.error("❌ Failed to clear data:",T),T}},[]);return{timeEntries:n.timeEntries,projects:n.projects,clients:n.clients,settings:n.settings,isLoading:n.isLoading,error:n.error,addTimeEntry:i,updateTimeEntry:r,deleteTimeEntry:o,addProject:l,updateProject:u,deleteProject:f,addClient:m,updateClient:p,deleteClient:v,setSettings:x,toggleIntegration:S,exportData:_,clearAllData:b}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Hd={};Hd.version="0.18.5";var tS=1252,N5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],nS=function(n){N5.indexOf(n)!=-1&&(tS=n)};function O5(){nS(1252)}var Lc=function(n){nS(n)};function M5(){Lc(1200),O5()}var Sd=function(e){return String.fromCharCode(e)},ax=function(e){return String.fromCharCode(e)},Wd,qa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ic(n){for(var e="",t=0,i=0,r=0,o=0,l=0,u=0,f=0,m=0;m<n.length;)t=n.charCodeAt(m++),o=t>>2,i=n.charCodeAt(m++),l=(t&3)<<4|i>>4,r=n.charCodeAt(m++),u=(i&15)<<2|r>>6,f=r&63,isNaN(i)?u=f=64:isNaN(r)&&(f=64),e+=qa.charAt(o)+qa.charAt(l)+qa.charAt(u)+qa.charAt(f);return e}function ha(n){var e="",t=0,i=0,r=0,o=0,l=0,u=0,f=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<n.length;)o=qa.indexOf(n.charAt(m++)),l=qa.indexOf(n.charAt(m++)),t=o<<2|l>>4,e+=String.fromCharCode(t),u=qa.indexOf(n.charAt(m++)),i=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(i)),f=qa.indexOf(n.charAt(m++)),r=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(r));return e}var _t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ga=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function zs(n){return _t?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function sx(n){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var pr=function(e){return _t?ga(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function df(n){if(typeof ArrayBuffer>"u")return pr(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),i=0;i!=n.length;++i)t[i]=n.charCodeAt(i)&255;return e}function Xc(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function R5(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var zn=_t?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:ga(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var i=new Uint8Array(t),r=0;for(e=0,t=0;e<n.length;t+=r,++e)if(r=n[e].length,n[e]instanceof Uint8Array)i.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";i.set(new Uint8Array(n[e]),t)}return i}return[].concat.apply([],n.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function L5(n){for(var e=[],t=0,i=n.length+250,r=zs(n.length+255),o=0;o<n.length;++o){var l=n.charCodeAt(o);if(l<128)r[t++]=l;else if(l<2048)r[t++]=192|l>>6&31,r[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=n.charCodeAt(++o)&1023;r[t++]=240|l>>8&7,r[t++]=128|l>>2&63,r[t++]=128|u>>6&15|(l&3)<<4,r[t++]=128|u&63}else r[t++]=224|l>>12&15,r[t++]=128|l>>6&63,r[t++]=128|l&63;t>i&&(e.push(r.slice(0,t)),t=0,r=zs(65535),i=65530)}return e.push(r.slice(0,t)),zn(e)}var Sc=/\u0000/g,_d=/[\u0001-\u0006]/g;function Wo(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function gr(n,e){var t=""+n;return t.length>=e?t:rn("0",e-t.length)+t}function Rp(n,e){var t=""+n;return t.length>=e?t:rn(" ",e-t.length)+t}function Vd(n,e){var t=""+n;return t.length>=e?t:t+rn(" ",e-t.length)}function I5(n,e){var t=""+Math.round(n);return t.length>=e?t:rn("0",e-t.length)+t}function P5(n,e){var t=""+n;return t.length>=e?t:rn("0",e-t.length)+t}var ox=Math.pow(2,32);function Lo(n,e){if(n>ox||n<-ox)return I5(n,e);var t=Math.round(n);return P5(t,e)}function Gd(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var lx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Im=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function B5(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var sn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},cx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},F5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Yd(n,e,t){for(var i=n<0?-1:1,r=n*i,o=0,l=1,u=0,f=1,m=0,p=0,v=Math.floor(r);m<e&&(v=Math.floor(r),u=v*l+o,p=v*m+f,!(r-v<5e-8));)r=1/(r-v),o=l,l=u,f=m,m=p;if(p>e&&(m>e?(p=f,u=o):(p=m,u=l)),!t)return[0,i*u,p];var x=Math.floor(i*u/p);return[x,i*u-x*p,p]}function Td(n,e,t){if(n>2958465||n<0)return null;var i=n|0,r=Math.floor(86400*(n-i)),o=0,l=[],u={D:i,T:r,u:86400*(n-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(i+=1462),u.u>.9999&&(u.u=0,++r==86400&&(u.T=r=0,++i,++u.D)),i===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(i===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{i>60&&--i;var f=new Date(1900,0,1);f.setDate(f.getDate()+i-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),i<60&&(o=(o+6)%7),t&&(o=Y5(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=r%60,r=Math.floor(r/60),u.M=r%60,r=Math.floor(r/60),u.H=r,u.q=o,u}var iS=new Date(1899,11,31,0,0,0),U5=iS.getTime(),z5=new Date(1900,2,1,0,0,0);function rS(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=z5&&(t+=24*60*60*1e3),(t-(U5+(n.getTimezoneOffset()-iS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Lp(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function H5(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function W5(n){var e=n<0?12:11,t=Lp(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function V5(n){var e=Lp(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function G5(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=W5(n):e===10?t=n.toFixed(10).substr(0,12):t=V5(n),Lp(H5(t.toUpperCase()))}function np(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):G5(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return es(14,rS(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Y5(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function X5(n,e,t,i){var r="",o=0,l=0,u=t.y,f,m=0;switch(n){case 98:u=t.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,m=2;break;default:f=u%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:f=t.m,m=e.length;break;case 3:return Im[t.m-1][1];case 5:return Im[t.m-1][0];default:return Im[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=t.d,m=e.length;break;case 3:return lx[t.q][0];default:return lx[t.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(t.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=t.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=t.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?gr(t.S,e.length):(i>=2?l=i===3?1e3:100:l=i===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(r=gr(o,2+i),e==="ss"?r.substr(0,2):"."+r.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:f=u,m=1;break}var p=m>0?gr(f,m):"";return p}function Ka(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,i=n.substr(0,t);t!=n.length;t+=e)i+=(i.length>0?",":"")+n.substr(t,e);return i}var aS=/%/g;function $5(n,e,t){var i=e.replace(aS,""),r=e.length-i.length;return ca(n,i,t*Math.pow(10,2*r))+rn("%",r)}function q5(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ca(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function sS(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+sS(n,-e);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%r;if(o<0&&(o+=r),t=(e/Math.pow(10,o)).toPrecision(i+1+(r+o)%r),t.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,r)+"."+t.substr(2+r),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(r+o)%r)+"."+p.substr(o)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var oS=/# (\?+)( ?)\/( ?)(\d+)/;function K5(n,e,t){var i=parseInt(n[4],10),r=Math.round(e*i),o=Math.floor(r/i),l=r-o*i,u=i;return t+(o===0?"":""+o)+" "+(l===0?rn(" ",n[1].length+1+n[4].length):Rp(l,n[1].length)+n[2]+"/"+n[3]+gr(u,n[4].length))}function Z5(n,e,t){return t+(e===0?"":""+e)+rn(" ",n[1].length+2+n[4].length)}var lS=/^#*0*\.([0#]+)/,cS=/\).*[0#]/,uS=/\(###\) ###\\?-####/;function ai(n){for(var e="",t,i=0;i!=n.length;++i)switch(t=n.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function ux(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function dx(n,e){var t=n-Math.floor(n),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function Q5(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function J5(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ji(n,e,t){if(n.charCodeAt(0)===40&&!e.match(cS)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ji("n",i,t):"("+Ji("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return q5(n,e,t);if(e.indexOf("%")!==-1)return $5(n,e,t);if(e.indexOf("E")!==-1)return sS(e,t);if(e.charCodeAt(0)===36)return"$"+Ji(n,e.substr(e.charAt(1)==" "?2:1),t);var r,o,l,u,f=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+Lo(f,e.length);if(e.match(/^[#?]+$/))return r=Lo(t,0),r==="0"&&(r=""),r.length>e.length?r:ai(e.substr(0,e.length-r.length))+r;if(o=e.match(oS))return K5(o,f,m);if(e.match(/^#+0+$/))return m+Lo(f,e.length-e.indexOf("0"));if(o=e.match(lS))return r=ux(t,o[1].length).replace(/^([^\.]+)$/,"$1."+ai(o[1])).replace(/\.$/,"."+ai(o[1])).replace(/\.(\d*)$/,function(_,b){return"."+b+rn("0",ai(o[1]).length-b.length)}),e.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+ux(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+Ka(Lo(f,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ji(n,e,-t):Ka(""+(Math.floor(t)+Q5(t,o[1].length)))+"."+gr(dx(t,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Ji(n,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Wo(Ji(n,e.replace(/[\\-]/g,""),t)),l=0,Wo(Wo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return l<r.length?r.charAt(l++):_==="0"?"0":""}));if(e.match(uS))return r=Ji(n,"##########",t),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Yd(f,Math.pow(10,l)-1,!1),r=""+m,p=ca("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+o[2]+"/"+o[3],p=Vd(u[2],l),p.length<o[4].length&&(p=ai(o[4].substr(o[4].length-p.length))+p),r+=p,r;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Yd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Rp(u[1],l)+o[2]+"/"+o[3]+Vd(u[2],l):rn(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return r=Lo(t,0),e.length<=r.length?r:ai(e.substr(0,e.length-r.length))+r;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var v=e.indexOf(".")-l,x=e.length-r.length-v;return ai(e.substr(0,v)+r+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=dx(t,o[1].length),t<0?"-"+Ji(n,e,-t):Ka(J5(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?gr(0,3-_.length):"")+_})+"."+gr(l,o[1].length);switch(e){case"###,##0.00":return Ji(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var S=Ka(Lo(f,0));return S!=="0"?m+S:"";case"###,###.00":return Ji(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ji(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function e6(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ca(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function t6(n,e,t){var i=e.replace(aS,""),r=e.length-i.length;return ca(n,i,t*Math.pow(10,2*r))+rn("%",r)}function dS(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dS(n,-e);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%r;if(o<0&&(o+=r),t=(e/Math.pow(10,o)).toPrecision(i+1+(r+o)%r),!t.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(r+o)%r)+"."+p.substr(o)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Nr(n,e,t){if(n.charCodeAt(0)===40&&!e.match(cS)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Nr("n",i,t):"("+Nr("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return e6(n,e,t);if(e.indexOf("%")!==-1)return t6(n,e,t);if(e.indexOf("E")!==-1)return dS(e,t);if(e.charCodeAt(0)===36)return"$"+Nr(n,e.substr(e.charAt(1)==" "?2:1),t);var r,o,l,u,f=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+gr(f,e.length);if(e.match(/^[#?]+$/))return r=""+t,t===0&&(r=""),r.length>e.length?r:ai(e.substr(0,e.length-r.length))+r;if(o=e.match(oS))return Z5(o,f,m);if(e.match(/^#+0+$/))return m+gr(f,e.length-e.indexOf("0"));if(o=e.match(lS))return r=(""+t).replace(/^([^\.]+)$/,"$1."+ai(o[1])).replace(/\.$/,"."+ai(o[1])),r=r.replace(/\.(\d*)$/,function(_,b){return"."+b+rn("0",ai(o[1]).length-b.length)}),e.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+Ka(""+f);if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Nr(n,e,-t):Ka(""+t)+"."+rn("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Nr(n,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Wo(Nr(n,e.replace(/[\\-]/g,""),t)),l=0,Wo(Wo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return l<r.length?r.charAt(l++):_==="0"?"0":""}));if(e.match(uS))return r=Nr(n,"##########",t),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Yd(f,Math.pow(10,l)-1,!1),r=""+m,p=ca("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+o[2]+"/"+o[3],p=Vd(u[2],l),p.length<o[4].length&&(p=ai(o[4].substr(o[4].length-p.length))+p),r+=p,r;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Yd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Rp(u[1],l)+o[2]+"/"+o[3]+Vd(u[2],l):rn(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return r=""+t,e.length<=r.length?r:ai(e.substr(0,e.length-r.length))+r;if(o=e.match(/^([#0]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var v=e.indexOf(".")-l,x=e.length-r.length-v;return ai(e.substr(0,v)+r+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Nr(n,e,-t):Ka(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?gr(0,3-_.length):"")+_})+"."+gr(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var S=Ka(""+f);return S!=="0"?m+S:"";default:if(e.match(/\.[0#?]*$/))return Nr(n,e.slice(0,e.lastIndexOf(".")),t)+ai(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ca(n,e,t){return(t|0)===t?Nr(n,e,t):Ji(n,e,t)}function n6(n){for(var e=[],t=!1,i=0,r=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=n.substr(r,i-r),r=i+1}if(e[e.length]=n.substr(r),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var fS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function hS(n){for(var e=0,t="",i="";e<n.length;)switch(t=n.charAt(e)){case"G":Gd(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(i=t;n.charAt(e++)!=="]"&&e<n.length;)i+=n.charAt(e);if(i.match(fS))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function i6(n,e,t,i){for(var r=[],o="",l=0,u="",f="t",m,p,v,x="H";l<n.length;)switch(u=n.charAt(l)){case"G":if(!Gd(n,l))throw new Error("unrecognized character "+u+" in "+n);r[r.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=n.charCodeAt(++l))!==34&&l<n.length;)o+=String.fromCharCode(v);r[r.length]={t:"t",v:o},++l;break;case"\\":var S=n.charAt(++l),_=S==="("||S===")"?S:"t";r[r.length]={t:_,v:S},++l;break;case"_":r[r.length]={t:"t",v:" "},l+=2;break;case"@":r[r.length]={t:"T",v:e},++l;break;case"B":case"b":if(n.charAt(l+1)==="1"||n.charAt(l+1)==="2"){if(m==null&&(m=Td(e,t,n.charAt(l+1)==="2"),m==null))return"";r[r.length]={t:"X",v:n.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=Td(e,t),m==null))return"";for(o=u;++l<n.length&&n.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=x),r[r.length]={t:u,v:o},f=u;break;case"A":case"a":case"上":var b={t:u,v:u};if(m==null&&(m=Td(e,t)),n.substr(l,3).toUpperCase()==="A/P"?(m!=null&&(b.v=m.H>=12?"P":"A"),b.t="T",x="h",l+=3):n.substr(l,5).toUpperCase()==="AM/PM"?(m!=null&&(b.v=m.H>=12?"PM":"AM"),b.t="T",l+=5,x="h"):n.substr(l,5).toUpperCase()==="上午/下午"?(m!=null&&(b.v=m.H>=12?"下午":"上午"),b.t="T",l+=5,x="h"):(b.t="t",++l),m==null&&b.t==="T")return"";r[r.length]=b,f=u;break;case"[":for(o=u;n.charAt(l++)!=="]"&&l<n.length;)o+=n.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(fS)){if(m==null&&(m=Td(e,t),m==null))return"";r[r.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",hS(n)||(r[r.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=u;++l<n.length&&(u=n.charAt(l))==="0";)o+=u;r[r.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<n.length&&"0#?.,E+-%".indexOf(u=n.charAt(l))>-1;)o+=u;r[r.length]={t:"n",v:o};break;case"?":for(o=u;n.charAt(++l)===u;)o+=u;r[r.length]={t:u,v:o},f=u;break;case"*":++l,(n.charAt(l)==" "||n.charAt(l)=="*")&&++l;break;case"(":case")":r[r.length]={t:i===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<n.length&&"0123456789".indexOf(n.charAt(++l))>-1;)o+=n.charAt(l);r[r.length]={t:"D",v:o};break;case" ":r[r.length]={t:u,v:u},++l;break;case"$":r[r.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+n);r[r.length]={t:"t",v:u},++l;break}var T=0,w=0,A;for(l=r.length-1,f="t";l>=0;--l)switch(r[l].t){case"h":case"H":r[l].t=x,f="h",T<1&&(T=1);break;case"s":(A=r[l].v.match(/\.0+$/))&&(w=Math.max(w,A[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=r[l].t;break;case"m":f==="s"&&(r[l].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&r[l].v.match(/[Hh]/)&&(T=1),T<2&&r[l].v.match(/[Mm]/)&&(T=2),T<3&&r[l].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var C="",N;for(l=0;l<r.length;++l)switch(r[l].t){case"t":case"T":case" ":case"D":break;case"X":r[l].v="",r[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[l].v=X5(r[l].t.charCodeAt(0),r[l].v,m,w),r[l].t="t";break;case"n":case"?":for(N=l+1;r[N]!=null&&((u=r[N].t)==="?"||u==="D"||(u===" "||u==="t")&&r[N+1]!=null&&(r[N+1].t==="?"||r[N+1].t==="t"&&r[N+1].v==="/")||r[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(r[N].v==="/"||r[N].v===" "&&r[N+1]!=null&&r[N+1].t=="?"));)r[l].v+=r[N].v,r[N]={v:"",t:";"},++N;C+=r[l].v,l=N-1;break;case"G":r[l].t="t",r[l].v=np(e,t);break}var E="",I,D;if(C.length>0){C.charCodeAt(0)==40?(I=e<0&&C.charCodeAt(0)===45?-e:e,D=ca("n",C,I)):(I=e<0&&i>1?-e:e,D=ca("n",C,I),I<0&&r[0]&&r[0].t=="t"&&(D=D.substr(1),r[0].v="-"+r[0].v)),N=D.length-1;var z=r.length;for(l=0;l<r.length;++l)if(r[l]!=null&&r[l].t!="t"&&r[l].v.indexOf(".")>-1){z=l;break}var L=r.length;if(z===r.length&&D.indexOf("E")===-1){for(l=r.length-1;l>=0;--l)r[l]==null||"n?".indexOf(r[l].t)===-1||(N>=r[l].v.length-1?(N-=r[l].v.length,r[l].v=D.substr(N+1,r[l].v.length)):N<0?r[l].v="":(r[l].v=D.substr(0,N+1),N=-1),r[l].t="t",L=l);N>=0&&L<r.length&&(r[L].v=D.substr(0,N+1)+r[L].v)}else if(z!==r.length&&D.indexOf("E")===-1){for(N=D.indexOf(".")-1,l=z;l>=0;--l)if(!(r[l]==null||"n?".indexOf(r[l].t)===-1)){for(p=r[l].v.indexOf(".")>-1&&l===z?r[l].v.indexOf(".")-1:r[l].v.length-1,E=r[l].v.substr(p+1);p>=0;--p)N>=0&&(r[l].v.charAt(p)==="0"||r[l].v.charAt(p)==="#")&&(E=D.charAt(N--)+E);r[l].v=E,r[l].t="t",L=l}for(N>=0&&L<r.length&&(r[L].v=D.substr(0,N+1)+r[L].v),N=D.indexOf(".")+1,l=z;l<r.length;++l)if(!(r[l]==null||"n?(".indexOf(r[l].t)===-1&&l!==z)){for(p=r[l].v.indexOf(".")>-1&&l===z?r[l].v.indexOf(".")+1:0,E=r[l].v.substr(0,p);p<r[l].v.length;++p)N<D.length&&(E+=D.charAt(N++));r[l].v=E,r[l].t="t",L=l}}}for(l=0;l<r.length;++l)r[l]!=null&&"n?".indexOf(r[l].t)>-1&&(I=i>1&&e<0&&l>0&&r[l-1].v==="-"?-e:e,r[l].v=ca(r[l].t,r[l].v,I),r[l].t="t");var H="";for(l=0;l!==r.length;++l)r[l]!=null&&(H+=r[l].v);return H}var fx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function hx(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function r6(n,e){var t=n6(n),i=t.length,r=t[i-1].indexOf("@");if(i<4&&r>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||r>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=r>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=r>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=r>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(fx),u=t[1].match(fx);return hx(e,l)?[i,t[0]]:hx(e,u)?[i,t[1]]:[i,t[l!=null&&u!=null?2:1]]}return[i,o]}function es(n,e,t){t==null&&(t={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?i=t.dateNF:i=n;break;case"number":n==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:sn)[n],i==null&&(i=t.table&&t.table[cx[n]]||sn[cx[n]]),i==null&&(i=F5[n]||"General");break}if(Gd(i,0))return np(e,t);e instanceof Date&&(e=rS(e,t.date1904));var r=r6(i,e);if(Gd(r[1]))return np(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return i6(r[1],e,t,r[0])}function mS(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(sn[t]==null){e<0&&(e=t);continue}if(sn[t]==n){e=t;break}}e<0&&(e=391)}return sn[e]=n,e}function ff(n){for(var e=0;e!=392;++e)n[e]!==void 0&&mS(n[e],e)}function hf(){sn=B5()}var pS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function a6(n){var e=typeof n=="number"?sn[n]:n;return e=e.replace(pS,"(\\d+)"),new RegExp("^"+e+"$")}function s6(n,e,t){var i=-1,r=-1,o=-1,l=-1,u=-1,f=-1;(e.match(pS)||[]).forEach(function(v,x){var S=parseInt(t[x+1],10);switch(v.toLowerCase().charAt(0)){case"y":i=S;break;case"d":o=S;break;case"h":l=S;break;case"s":f=S;break;case"m":l>=0?u=S:r=S;break}}),f>=0&&u==-1&&r>=0&&(u=r,r=-1);var m=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?m:i==-1&&r==-1&&o==-1?p:m+"T"+p}var o6=function(){var n={};n.version="1.2.0";function e(){for(var D=0,z=new Array(256),L=0;L!=256;++L)D=L,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,z[L]=D;return typeof Int32Array<"u"?new Int32Array(z):z}var t=e();function i(D){var z=0,L=0,H=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)K[H]=D[H];for(H=0;H!=256;++H)for(L=D[H],z=256+H;z<4096;z+=256)L=K[z]=L>>>8^D[L&255];var ne=[];for(H=1;H!=16;++H)ne[H-1]=typeof Int32Array<"u"?K.subarray(H*256,H*256+256):K.slice(H*256,H*256+256);return ne}var r=i(t),o=r[0],l=r[1],u=r[2],f=r[3],m=r[4],p=r[5],v=r[6],x=r[7],S=r[8],_=r[9],b=r[10],T=r[11],w=r[12],A=r[13],C=r[14];function N(D,z){for(var L=z^-1,H=0,K=D.length;H<K;)L=L>>>8^t[(L^D.charCodeAt(H++))&255];return~L}function E(D,z){for(var L=z^-1,H=D.length-15,K=0;K<H;)L=C[D[K++]^L&255]^A[D[K++]^L>>8&255]^w[D[K++]^L>>16&255]^T[D[K++]^L>>>24]^b[D[K++]]^_[D[K++]]^S[D[K++]]^x[D[K++]]^v[D[K++]]^p[D[K++]]^m[D[K++]]^f[D[K++]]^u[D[K++]]^l[D[K++]]^o[D[K++]]^t[D[K++]];for(H+=15;K<H;)L=L>>>8^t[(L^D[K++])&255];return~L}function I(D,z){for(var L=z^-1,H=0,K=D.length,ne=0,xe=0;H<K;)ne=D.charCodeAt(H++),ne<128?L=L>>>8^t[(L^ne)&255]:ne<2048?(L=L>>>8^t[(L^(192|ne>>6&31))&255],L=L>>>8^t[(L^(128|ne&63))&255]):ne>=55296&&ne<57344?(ne=(ne&1023)+64,xe=D.charCodeAt(H++)&1023,L=L>>>8^t[(L^(240|ne>>8&7))&255],L=L>>>8^t[(L^(128|ne>>2&63))&255],L=L>>>8^t[(L^(128|xe>>6&15|(ne&3)<<4))&255],L=L>>>8^t[(L^(128|xe&63))&255]):(L=L>>>8^t[(L^(224|ne>>12&15))&255],L=L>>>8^t[(L^(128|ne>>6&63))&255],L=L>>>8^t[(L^(128|ne&63))&255]);return~L}return n.table=t,n.bstr=N,n.buf=E,n.str=I,n}(),Pt=function(){var e={};e.version="1.2.1";function t(j,U){for(var M=j.split("/"),R=U.split("/"),F=0,B=0,se=Math.min(M.length,R.length);F<se;++F){if(B=M[F].length-R[F].length)return B;if(M[F]!=R[F])return M[F]<R[F]?-1:1}return M.length-R.length}function i(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:i(j.slice(0,-1));var U=j.lastIndexOf("/");return U===-1?j:j.slice(0,U+1)}function r(j){if(j.charAt(j.length-1)=="/")return r(j.slice(0,-1));var U=j.lastIndexOf("/");return U===-1?j:j.slice(U+1)}function o(j,U){typeof U=="string"&&(U=new Date(U));var M=U.getHours();M=M<<6|U.getMinutes(),M=M<<5|U.getSeconds()>>>1,j.write_shift(2,M);var R=U.getFullYear()-1980;R=R<<4|U.getMonth()+1,R=R<<5|U.getDate(),j.write_shift(2,R)}function l(j){var U=j.read_shift(2)&65535,M=j.read_shift(2)&65535,R=new Date,F=M&31;M>>>=5;var B=M&15;M>>>=4,R.setMilliseconds(0),R.setFullYear(M+1980),R.setMonth(B-1),R.setDate(F);var se=U&31;U>>>=5;var ue=U&63;return U>>>=6,R.setHours(U),R.setMinutes(ue),R.setSeconds(se<<1),R}function u(j){Ii(j,0);for(var U={},M=0;j.l<=j.length-4;){var R=j.read_shift(2),F=j.read_shift(2),B=j.l+F,se={};switch(R){case 21589:M=j.read_shift(1),M&1&&(se.mtime=j.read_shift(4)),F>5&&(M&2&&(se.atime=j.read_shift(4)),M&4&&(se.ctime=j.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}j.l=B,U[R]=se}return U}var f;function m(){return f||(f={})}function p(j,U){if(j[0]==80&&j[1]==75)return wi(j,U);if((j[0]|32)==109&&(j[1]|32)==105)return yn(j,U);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var M=3,R=512,F=0,B=0,se=0,ue=0,ee=0,le=[],de=j.slice(0,512);Ii(de,0);var Se=v(de);switch(M=Se[0],M){case 3:R=512;break;case 4:R=4096;break;case 0:if(Se[1]==0)return wi(j,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}R!==512&&(de=j.slice(0,R),Ii(de,28));var Ae=j.slice(0,R);x(de,M);var Ie=de.read_shift(4,"i");if(M===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);de.l+=4,se=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ue=de.read_shift(4,"i"),F=de.read_shift(4,"i"),ee=de.read_shift(4,"i"),B=de.read_shift(4,"i");for(var Te=-1,Oe=0;Oe<109&&(Te=de.read_shift(4,"i"),!(Te<0));++Oe)le[Oe]=Te;var Ge=S(j,R);T(ee,B,Ge,R,le);var vt=A(Ge,se,le,R);vt[se].name="!Directory",F>0&&ue!==xe&&(vt[ue].name="!MiniFAT"),vt[le[0]].name="!FAT",vt.fat_addrs=le,vt.ssz=R;var yt={},ht=[],ci=[],Ei=[];C(se,vt,Ge,ht,F,yt,ci,ue),_(ci,Ei,ht),ht.shift();var ni={FileIndex:ci,FullPaths:Ei};return U&&U.raw&&(ni.raw={header:Ae,sectors:Ge}),ni}function v(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(He,"Header Signature: "),j.l+=16;var U=j.read_shift(2,"u");return[j.read_shift(2,"u"),U]}function x(j,U){var M=9;switch(j.l+=2,M=j.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function S(j,U){for(var M=Math.ceil(j.length/U)-1,R=[],F=1;F<M;++F)R[F-1]=j.slice(F*U,(F+1)*U);return R[M-1]=j.slice(M*U),R}function _(j,U,M){for(var R=0,F=0,B=0,se=0,ue=0,ee=M.length,le=[],de=[];R<ee;++R)le[R]=de[R]=R,U[R]=M[R];for(;ue<de.length;++ue)R=de[ue],F=j[R].L,B=j[R].R,se=j[R].C,le[R]===R&&(F!==-1&&le[F]!==F&&(le[R]=le[F]),B!==-1&&le[B]!==B&&(le[R]=le[B])),se!==-1&&(le[se]=R),F!==-1&&R!=le[R]&&(le[F]=le[R],de.lastIndexOf(F)<ue&&de.push(F)),B!==-1&&R!=le[R]&&(le[B]=le[R],de.lastIndexOf(B)<ue&&de.push(B));for(R=1;R<ee;++R)le[R]===R&&(B!==-1&&le[B]!==B?le[R]=le[B]:F!==-1&&le[F]!==F&&(le[R]=le[F]));for(R=1;R<ee;++R)if(j[R].type!==0){if(ue=R,ue!=le[ue])do ue=le[ue],U[R]=U[ue]+"/"+U[R];while(ue!==0&&le[ue]!==-1&&ue!=le[ue]);le[R]=-1}for(U[0]+="/",R=1;R<ee;++R)j[R].type!==2&&(U[R]+="/")}function b(j,U,M){for(var R=j.start,F=j.size,B=[],se=R;M&&F>0&&se>=0;)B.push(U.slice(se*ne,se*ne+ne)),F-=ne,se=Rs(M,se*4);return B.length===0?me(0):zn(B).slice(0,j.size)}function T(j,U,M,R,F){var B=xe;if(j===xe){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var se=M[j],ue=(R>>>2)-1;if(!se)return;for(var ee=0;ee<ue&&(B=Rs(se,ee*4))!==xe;++ee)F.push(B);T(Rs(se,R-4),U-1,M,R,F)}}function w(j,U,M,R,F){var B=[],se=[];F||(F=[]);var ue=R-1,ee=0,le=0;for(ee=U;ee>=0;){F[ee]=!0,B[B.length]=ee,se.push(j[ee]);var de=M[Math.floor(ee*4/R)];if(le=ee*4&ue,R<4+le)throw new Error("FAT boundary crossed: "+ee+" 4 "+R);if(!j[de])break;ee=Rs(j[de],le)}return{nodes:B,data:Sx([se])}}function A(j,U,M,R){var F=j.length,B=[],se=[],ue=[],ee=[],le=R-1,de=0,Se=0,Ae=0,Ie=0;for(de=0;de<F;++de)if(ue=[],Ae=de+U,Ae>=F&&(Ae-=F),!se[Ae]){ee=[];var Te=[];for(Se=Ae;Se>=0;){Te[Se]=!0,se[Se]=!0,ue[ue.length]=Se,ee.push(j[Se]);var Oe=M[Math.floor(Se*4/R)];if(Ie=Se*4&le,R<4+Ie)throw new Error("FAT boundary crossed: "+Se+" 4 "+R);if(!j[Oe]||(Se=Rs(j[Oe],Ie),Te[Se]))break}B[Ae]={nodes:ue,data:Sx([ee])}}return B}function C(j,U,M,R,F,B,se,ue){for(var ee=0,le=R.length?2:0,de=U[j].data,Se=0,Ae=0,Ie;Se<de.length;Se+=128){var Te=de.slice(Se,Se+128);Ii(Te,64),Ae=Te.read_shift(2),Ie=Up(Te,0,Ae-le),R.push(Ie);var Oe={name:Ie,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},Ge=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);Ge!==0&&(Oe.ct=N(Te,Te.l-8));var vt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);vt!==0&&(Oe.mt=N(Te,Te.l-8)),Oe.start=Te.read_shift(4,"i"),Oe.size=Te.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=xe,Oe.name=""),Oe.type===5?(ee=Oe.start,F>0&&ee!==xe&&(U[ee].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",U[Oe.start]===void 0&&(U[Oe.start]=w(M,Oe.start,U.fat_addrs,U.ssz)),U[Oe.start].name=Oe.name,Oe.content=U[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:ee!==xe&&Oe.start!==xe&&U[ee]&&(Oe.content=b(Oe,U[ee].data,(U[ue]||{}).data))),Oe.content&&Ii(Oe.content,0),B[Ie]=Oe,se.push(Oe)}}function N(j,U){return new Date((Bi(j,U+4)/1e7*Math.pow(2,32)+Bi(j,U)/1e7-11644473600)*1e3)}function E(j,U){return m(),p(f.readFileSync(j),U)}function I(j,U){var M=U&&U.type;switch(M||_t&&Buffer.isBuffer(j)&&(M="buffer"),M||"base64"){case"file":return E(j,U);case"base64":return p(pr(ha(j)),U);case"binary":return p(pr(j),U)}return p(j,U)}function D(j,U){var M=U||{},R=M.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=R+"/",j.FileIndex[0]={name:R,type:5}),M.CLSID&&(j.FileIndex[0].clsid=M.CLSID),z(j)}function z(j){var U="Sh33tJ5";if(!Pt.find(j,"/"+U)){var M=me(4);M[0]=55,M[1]=M[3]=50,M[2]=54,j.FileIndex.push({name:U,type:2,content:M,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+U),L(j)}}function L(j,U){D(j);for(var M=!1,R=!1,F=j.FullPaths.length-1;F>=0;--F){var B=j.FileIndex[F];switch(B.type){case 0:R?M=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(B.R*B.L*B.C)&&(M=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!U)){var se=new Date(1987,1,19),ue=0,ee=Object.create?Object.create(null):{},le=[];for(F=0;F<j.FullPaths.length;++F)ee[j.FullPaths[F]]=!0,j.FileIndex[F].type!==0&&le.push([j.FullPaths[F],j.FileIndex[F]]);for(F=0;F<le.length;++F){var de=i(le[F][0]);R=ee[de],R||(le.push([de,{name:r(de).replace("/",""),type:1,clsid:ie,ct:se,mt:se,content:null}]),ee[de]=!0)}for(le.sort(function(Ie,Te){return t(Ie[0],Te[0])}),j.FullPaths=[],j.FileIndex=[],F=0;F<le.length;++F)j.FullPaths[F]=le[F][0],j.FileIndex[F]=le[F][1];for(F=0;F<le.length;++F){var Se=j.FileIndex[F],Ae=j.FullPaths[F];if(Se.name=r(Ae).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||ie,F===0)Se.C=le.length>1?1:-1,Se.size=0,Se.type=5;else if(Ae.slice(-1)=="/"){for(ue=F+1;ue<le.length&&i(j.FullPaths[ue])!=Ae;++ue);for(Se.C=ue>=le.length?-1:ue,ue=F+1;ue<le.length&&i(j.FullPaths[ue])!=i(Ae);++ue);Se.R=ue>=le.length?-1:ue,Se.type=1}else i(j.FullPaths[F+1]||"")==i(Ae)&&(Se.R=F+1),Se.type=2}}}function H(j,U){var M=U||{};if(M.fileType=="mad")return li(j,M);switch(L(j),M.fileType){case"zip":return qt(j,M)}var R=function(Ie){for(var Te=0,Oe=0,Ge=0;Ge<Ie.FileIndex.length;++Ge){var vt=Ie.FileIndex[Ge];if(vt.content){var yt=vt.content.length;yt>0&&(yt<4096?Te+=yt+63>>6:Oe+=yt+511>>9)}}for(var ht=Ie.FullPaths.length+3>>2,ci=Te+7>>3,Ei=Te+127>>7,ni=ci+Oe+ht+Ei,ui=ni+127>>7,Ur=ui<=109?0:Math.ceil((ui-109)/127);ni+ui+Ur+127>>7>ui;)Ur=++ui<=109?0:Math.ceil((ui-109)/127);var ii=[1,Ur,ui,Ei,ht,Oe,Te,0];return Ie.FileIndex[0].size=Te<<6,ii[7]=(Ie.FileIndex[0].start=ii[0]+ii[1]+ii[2]+ii[3]+ii[4]+ii[5])+(ii[6]+7>>3),ii}(j),F=me(R[7]<<9),B=0,se=0;{for(B=0;B<8;++B)F.write_shift(1,_e[B]);for(B=0;B<8;++B)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),B=0;B<3;++B)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,R[2]),F.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:xe),F.write_shift(4,R[3]),F.write_shift(-4,R[1]?R[0]-1:xe),F.write_shift(4,R[1]),B=0;B<109;++B)F.write_shift(-4,B<R[2]?R[1]+B:-1)}if(R[1])for(se=0;se<R[1];++se){for(;B<236+se*127;++B)F.write_shift(-4,B<R[2]?R[1]+B:-1);F.write_shift(-4,se===R[1]-1?xe:se+1)}var ue=function(Ie){for(se+=Ie;B<se-1;++B)F.write_shift(-4,B+1);Ie&&(++B,F.write_shift(-4,xe))};for(se=B=0,se+=R[1];B<se;++B)F.write_shift(-4,he.DIFSECT);for(se+=R[2];B<se;++B)F.write_shift(-4,he.FATSECT);ue(R[3]),ue(R[4]);for(var ee=0,le=0,de=j.FileIndex[0];ee<j.FileIndex.length;++ee)de=j.FileIndex[ee],de.content&&(le=de.content.length,!(le<4096)&&(de.start=se,ue(le+511>>9)));for(ue(R[6]+7>>3);F.l&511;)F.write_shift(-4,he.ENDOFCHAIN);for(se=B=0,ee=0;ee<j.FileIndex.length;++ee)de=j.FileIndex[ee],de.content&&(le=de.content.length,!(!le||le>=4096)&&(de.start=se,ue(le+63>>6)));for(;F.l&511;)F.write_shift(-4,he.ENDOFCHAIN);for(B=0;B<R[4]<<2;++B){var Se=j.FullPaths[B];if(!Se||Se.length===0){for(ee=0;ee<17;++ee)F.write_shift(4,0);for(ee=0;ee<3;++ee)F.write_shift(4,-1);for(ee=0;ee<12;++ee)F.write_shift(4,0);continue}de=j.FileIndex[B],B===0&&(de.start=de.size?de.start-1:xe);var Ae=B===0&&M.root||de.name;if(le=2*(Ae.length+1),F.write_shift(64,Ae,"utf16le"),F.write_shift(2,le),F.write_shift(1,de.type),F.write_shift(1,de.color),F.write_shift(-4,de.L),F.write_shift(-4,de.R),F.write_shift(-4,de.C),de.clsid)F.write_shift(16,de.clsid,"hex");else for(ee=0;ee<4;++ee)F.write_shift(4,0);F.write_shift(4,de.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,de.start),F.write_shift(4,de.size),F.write_shift(4,0)}for(B=1;B<j.FileIndex.length;++B)if(de=j.FileIndex[B],de.size>=4096)if(F.l=de.start+1<<9,_t&&Buffer.isBuffer(de.content))de.content.copy(F,F.l,0,de.size),F.l+=de.size+511&-512;else{for(ee=0;ee<de.size;++ee)F.write_shift(1,de.content[ee]);for(;ee&511;++ee)F.write_shift(1,0)}for(B=1;B<j.FileIndex.length;++B)if(de=j.FileIndex[B],de.size>0&&de.size<4096)if(_t&&Buffer.isBuffer(de.content))de.content.copy(F,F.l,0,de.size),F.l+=de.size+63&-64;else{for(ee=0;ee<de.size;++ee)F.write_shift(1,de.content[ee]);for(;ee&63;++ee)F.write_shift(1,0)}if(_t)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function K(j,U){var M=j.FullPaths.map(function(ee){return ee.toUpperCase()}),R=M.map(function(ee){var le=ee.split("/");return le[le.length-(ee.slice(-1)=="/"?2:1)]}),F=!1;U.charCodeAt(0)===47?(F=!0,U=M[0].slice(0,-1)+U):F=U.indexOf("/")!==-1;var B=U.toUpperCase(),se=F===!0?M.indexOf(B):R.indexOf(B);if(se!==-1)return j.FileIndex[se];var ue=!B.match(_d);for(B=B.replace(Sc,""),ue&&(B=B.replace(_d,"!")),se=0;se<M.length;++se)if((ue?M[se].replace(_d,"!"):M[se]).replace(Sc,"")==B||(ue?R[se].replace(_d,"!"):R[se]).replace(Sc,"")==B)return j.FileIndex[se];return null}var ne=64,xe=-2,He="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:xe,FREESECT:-1,HEADER_SIGNATURE:He,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ne(j,U,M){m();var R=H(j,M);f.writeFileSync(U,R)}function Be(j){for(var U=new Array(j.length),M=0;M<j.length;++M)U[M]=String.fromCharCode(j[M]);return U.join("")}function X(j,U){var M=H(j,U);switch(U&&U.type||"buffer"){case"file":return m(),f.writeFileSync(U.filename,M),M;case"binary":return typeof M=="string"?M:Be(M);case"base64":return Ic(typeof M=="string"?M:Be(M));case"buffer":if(_t)return Buffer.isBuffer(M)?M:ga(M);case"array":return typeof M=="string"?pr(M):M}return M}var pe;function P(j){try{var U=j.InflateRaw,M=new U;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)pe=j;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function Y(j,U){if(!pe)return ut(j,U);var M=pe.InflateRaw,R=new M,F=R._processChunk(j.slice(j.l),R._finishFlushFlag);return j.l+=R.bytesRead,F}function V(j){return pe?pe.deflateRawSync(j):Ee(j)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(j){var U=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(U>>16|U>>8|U)&255}for(var Le=typeof Uint8Array<"u",ke=Le?new Uint8Array(256):[],ct=0;ct<256;++ct)ke[ct]=Ce(ct);function et(j,U){var M=ke[j&255];return U<=8?M>>>8-U:(M=M<<8|ke[j>>8&255],U<=16?M>>>16-U:(M=M<<8|ke[j>>16&255],M>>>24-U))}function Ht(j,U){var M=U&7,R=U>>>3;return(j[R]|(M<=6?0:j[R+1]<<8))>>>M&3}function rt(j,U){var M=U&7,R=U>>>3;return(j[R]|(M<=5?0:j[R+1]<<8))>>>M&7}function Gn(j,U){var M=U&7,R=U>>>3;return(j[R]|(M<=4?0:j[R+1]<<8))>>>M&15}function gt(j,U){var M=U&7,R=U>>>3;return(j[R]|(M<=3?0:j[R+1]<<8))>>>M&31}function Me(j,U){var M=U&7,R=U>>>3;return(j[R]|(M<=1?0:j[R+1]<<8))>>>M&127}function wn(j,U,M){var R=U&7,F=U>>>3,B=(1<<M)-1,se=j[F]>>>R;return M<8-R||(se|=j[F+1]<<8-R,M<16-R)||(se|=j[F+2]<<16-R,M<24-R)||(se|=j[F+3]<<24-R),se&B}function Mn(j,U,M){var R=U&7,F=U>>>3;return R<=5?j[F]|=(M&7)<<R:(j[F]|=M<<R&255,j[F+1]=(M&7)>>8-R),U+3}function ei(j,U,M){var R=U&7,F=U>>>3;return M=(M&1)<<R,j[F]|=M,U+1}function ti(j,U,M){var R=U&7,F=U>>>3;return M<<=R,j[F]|=M&255,M>>>=8,j[F+1]=M,U+8}function Qe(j,U,M){var R=U&7,F=U>>>3;return M<<=R,j[F]|=M&255,M>>>=8,j[F+1]=M&255,j[F+2]=M>>>8,U+16}function Fe(j,U){var M=j.length,R=2*M>U?2*M:U+5,F=0;if(M>=U)return j;if(_t){var B=sx(R);if(j.copy)j.copy(B);else for(;F<j.length;++F)B[F]=j[F];return B}else if(Le){var se=new Uint8Array(R);if(se.set)se.set(j);else for(;F<M;++F)se[F]=j[F];return se}return j.length=R,j}function Ye(j){for(var U=new Array(j),M=0;M<j;++M)U[M]=0;return U}function Ze(j,U,M){var R=1,F=0,B=0,se=0,ue=0,ee=j.length,le=Le?new Uint16Array(32):Ye(32);for(B=0;B<32;++B)le[B]=0;for(B=ee;B<M;++B)j[B]=0;ee=j.length;var de=Le?new Uint16Array(ee):Ye(ee);for(B=0;B<ee;++B)le[F=j[B]]++,R<F&&(R=F),de[B]=0;for(le[0]=0,B=1;B<=R;++B)le[B+16]=ue=ue+le[B-1]<<1;for(B=0;B<ee;++B)ue=j[B],ue!=0&&(de[B]=le[ue+16]++);var Se=0;for(B=0;B<ee;++B)if(Se=j[B],Se!=0)for(ue=et(de[B],R)>>R-Se,se=(1<<R+4-Se)-1;se>=0;--se)U[ue|se<<Se]=Se&15|B<<4;return R}var Ot=Le?new Uint16Array(512):Ye(512),wt=Le?new Uint16Array(32):Ye(32);if(!Le){for(var Wt=0;Wt<512;++Wt)Ot[Wt]=0;for(Wt=0;Wt<32;++Wt)wt[Wt]=0}(function(){for(var j=[],U=0;U<32;U++)j.push(5);Ze(j,wt,32);var M=[];for(U=0;U<=143;U++)M.push(8);for(;U<=255;U++)M.push(9);for(;U<=279;U++)M.push(7);for(;U<=287;U++)M.push(8);Ze(M,Ot,288)})();var J=function(){for(var U=Le?new Uint8Array(32768):[],M=0,R=0;M<Re.length-1;++M)for(;R<Re[M+1];++R)U[R]=M;for(;R<32768;++R)U[R]=29;var F=Le?new Uint8Array(259):[];for(M=0,R=0;M<ae.length-1;++M)for(;R<ae[M+1];++R)F[R]=M;function B(ue,ee){for(var le=0;le<ue.length;){var de=Math.min(65535,ue.length-le),Se=le+de==ue.length;for(ee.write_shift(1,+Se),ee.write_shift(2,de),ee.write_shift(2,~de&65535);de-- >0;)ee[ee.l++]=ue[le++]}return ee.l}function se(ue,ee){for(var le=0,de=0,Se=Le?new Uint16Array(32768):[];de<ue.length;){var Ae=Math.min(65535,ue.length-de);if(Ae<10){for(le=Mn(ee,le,+(de+Ae==ue.length)),le&7&&(le+=8-(le&7)),ee.l=le/8|0,ee.write_shift(2,Ae),ee.write_shift(2,~Ae&65535);Ae-- >0;)ee[ee.l++]=ue[de++];le=ee.l*8;continue}le=Mn(ee,le,+(de+Ae==ue.length)+2);for(var Ie=0;Ae-- >0;){var Te=ue[de];Ie=(Ie<<5^Te)&32767;var Oe=-1,Ge=0;if((Oe=Se[Ie])&&(Oe|=de&-32768,Oe>de&&(Oe-=32768),Oe<de))for(;ue[Oe+Ge]==ue[de+Ge]&&Ge<250;)++Ge;if(Ge>2){Te=F[Ge],Te<=22?le=ti(ee,le,ke[Te+1]>>1)-1:(ti(ee,le,3),le+=5,ti(ee,le,ke[Te-23]>>5),le+=3);var vt=Te<8?0:Te-4>>2;vt>0&&(Qe(ee,le,Ge-ae[Te]),le+=vt),Te=U[de-Oe],le=ti(ee,le,ke[Te]>>3),le-=3;var yt=Te<4?0:Te-2>>1;yt>0&&(Qe(ee,le,de-Oe-Re[Te]),le+=yt);for(var ht=0;ht<Ge;++ht)Se[Ie]=de&32767,Ie=(Ie<<5^ue[de])&32767,++de;Ae-=Ge-1}else Te<=143?Te=Te+48:le=ei(ee,le,1),le=ti(ee,le,ke[Te]),Se[Ie]=de&32767,++de}le=ti(ee,le,0)-1}return ee.l=(le+7)/8|0,ee.l}return function(ee,le){return ee.length<8?B(ee,le):se(ee,le)}}();function Ee(j){var U=me(50+Math.floor(j.length*1.1)),M=J(j,U);return U.slice(0,M)}var Xe=Le?new Uint16Array(32768):Ye(32768),We=Le?new Uint16Array(32768):Ye(32768),Je=Le?new Uint16Array(128):Ye(128),dt=1,$t=1;function Yn(j,U){var M=gt(j,U)+257;U+=5;var R=gt(j,U)+1;U+=5;var F=Gn(j,U)+4;U+=4;for(var B=0,se=Le?new Uint8Array(19):Ye(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,le=Le?new Uint8Array(8):Ye(8),de=Le?new Uint8Array(8):Ye(8),Se=se.length,Ae=0;Ae<F;++Ae)se[q[Ae]]=B=rt(j,U),ee<B&&(ee=B),le[B]++,U+=3;var Ie=0;for(le[0]=0,Ae=1;Ae<=ee;++Ae)de[Ae]=Ie=Ie+le[Ae-1]<<1;for(Ae=0;Ae<Se;++Ae)(Ie=se[Ae])!=0&&(ue[Ae]=de[Ie]++);var Te=0;for(Ae=0;Ae<Se;++Ae)if(Te=se[Ae],Te!=0){Ie=ke[ue[Ae]]>>8-Te;for(var Oe=(1<<7-Te)-1;Oe>=0;--Oe)Je[Ie|Oe<<Te]=Te&7|Ae<<3}var Ge=[];for(ee=1;Ge.length<M+R;)switch(Ie=Je[Me(j,U)],U+=Ie&7,Ie>>>=3){case 16:for(B=3+Ht(j,U),U+=2,Ie=Ge[Ge.length-1];B-- >0;)Ge.push(Ie);break;case 17:for(B=3+rt(j,U),U+=3;B-- >0;)Ge.push(0);break;case 18:for(B=11+Me(j,U),U+=7;B-- >0;)Ge.push(0);break;default:Ge.push(Ie),ee<Ie&&(ee=Ie);break}var vt=Ge.slice(0,M),yt=Ge.slice(M);for(Ae=M;Ae<286;++Ae)vt[Ae]=0;for(Ae=R;Ae<30;++Ae)yt[Ae]=0;return dt=Ze(vt,Xe,286),$t=Ze(yt,We,30),U}function Ui(j,U){if(j[0]==3&&!(j[1]&3))return[zs(U),2];for(var M=0,R=0,F=sx(U||1<<18),B=0,se=F.length>>>0,ue=0,ee=0;(R&1)==0;){if(R=rt(j,M),M+=3,R>>>1)R>>1==1?(ue=9,ee=5):(M=Yn(j,M),ue=dt,ee=$t);else{M&7&&(M+=8-(M&7));var le=j[M>>>3]|j[(M>>>3)+1]<<8;if(M+=32,le>0)for(!U&&se<B+le&&(F=Fe(F,B+le),se=F.length);le-- >0;)F[B++]=j[M>>>3],M+=8;continue}for(;;){!U&&se<B+32767&&(F=Fe(F,B+32767),se=F.length);var de=wn(j,M,ue),Se=R>>>1==1?Ot[de]:Xe[de];if(M+=Se&15,Se>>>=4,(Se>>>8&255)===0)F[B++]=Se;else{if(Se==256)break;Se-=257;var Ae=Se<8?0:Se-4>>2;Ae>5&&(Ae=0);var Ie=B+ae[Se];Ae>0&&(Ie+=wn(j,M,Ae),M+=Ae),de=wn(j,M,ee),Se=R>>>1==1?wt[de]:We[de],M+=Se&15,Se>>>=4;var Te=Se<4?0:Se-2>>1,Oe=Re[Se];for(Te>0&&(Oe+=wn(j,M,Te),M+=Te),!U&&se<Ie&&(F=Fe(F,Ie+100),se=F.length);B<Ie;)F[B]=F[B-Oe],++B}}}return U?[F,M+7>>>3]:[F.slice(0,B),M+7>>>3]}function ut(j,U){var M=j.slice(j.l||0),R=Ui(M,U);return j.l+=R[1],R[0]}function ar(j,U){if(j)typeof console<"u"&&console.error(U);else throw new Error(U)}function wi(j,U){var M=j;Ii(M,0);var R=[],F=[],B={FileIndex:R,FullPaths:F};D(B,{root:U.root});for(var se=M.length-4;(M[se]!=80||M[se+1]!=75||M[se+2]!=5||M[se+3]!=6)&&se>=0;)--se;M.l=se+4,M.l+=4;var ue=M.read_shift(2);M.l+=6;var ee=M.read_shift(4);for(M.l=ee,se=0;se<ue;++se){M.l+=20;var le=M.read_shift(4),de=M.read_shift(4),Se=M.read_shift(2),Ae=M.read_shift(2),Ie=M.read_shift(2);M.l+=8;var Te=M.read_shift(4),Oe=u(M.slice(M.l+Se,M.l+Se+Ae));M.l+=Se+Ae+Ie;var Ge=M.l;M.l=Te+4,xr(M,le,de,B,Oe),M.l=Ge}return B}function xr(j,U,M,R,F){j.l+=2;var B=j.read_shift(2),se=j.read_shift(2),ue=l(j);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var ee=j.read_shift(4),le=j.read_shift(4),de=j.read_shift(4),Se=j.read_shift(2),Ae=j.read_shift(2),Ie="",Te=0;Te<Se;++Te)Ie+=String.fromCharCode(j[j.l++]);if(Ae){var Oe=u(j.slice(j.l,j.l+Ae));(Oe[21589]||{}).mt&&(ue=Oe[21589].mt),((F||{})[21589]||{}).mt&&(ue=F[21589].mt)}j.l+=Ae;var Ge=j.slice(j.l,j.l+le);switch(se){case 8:Ge=Y(j,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var vt=!1;B&8&&(ee=j.read_shift(4),ee==134695760&&(ee=j.read_shift(4),vt=!0),le=j.read_shift(4),de=j.read_shift(4)),le!=U&&ar(vt,"Bad compressed size: "+U+" != "+le),de!=M&&ar(vt,"Bad uncompressed size: "+M+" != "+de),en(R,Ie,Ge,{unsafe:!0,mt:ue})}function qt(j,U){var M=U||{},R=[],F=[],B=me(1),se=M.compression?8:0,ue=0,ee=0,le=0,de=0,Se=0,Ae=j.FullPaths[0],Ie=Ae,Te=j.FileIndex[0],Oe=[],Ge=0;for(ee=1;ee<j.FullPaths.length;++ee)if(Ie=j.FullPaths[ee].slice(Ae.length),Te=j.FileIndex[ee],!(!Te.size||!Te.content||Ie=="Sh33tJ5")){var vt=de,yt=me(Ie.length);for(le=0;le<Ie.length;++le)yt.write_shift(1,Ie.charCodeAt(le)&127);yt=yt.slice(0,yt.l),Oe[Se]=o6.buf(Te.content,0);var ht=Te.content;se==8&&(ht=V(ht)),B=me(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,ue),B.write_shift(2,se),Te.mt?o(B,Te.mt):B.write_shift(4,0),B.write_shift(-4,Oe[Se]),B.write_shift(4,ht.length),B.write_shift(4,Te.content.length),B.write_shift(2,yt.length),B.write_shift(2,0),de+=B.length,R.push(B),de+=yt.length,R.push(yt),de+=ht.length,R.push(ht),B=me(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,ue),B.write_shift(2,se),B.write_shift(4,0),B.write_shift(-4,Oe[Se]),B.write_shift(4,ht.length),B.write_shift(4,Te.content.length),B.write_shift(2,yt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,vt),Ge+=B.l,F.push(B),Ge+=yt.length,F.push(yt),++Se}return B=me(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,Se),B.write_shift(2,Se),B.write_shift(4,Ge),B.write_shift(4,de),B.write_shift(2,0),zn([zn(R),zn(F),B])}var zi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function va(j,U){if(j.ctype)return j.ctype;var M=j.name||"",R=M.match(/\.([^\.]+)$/);return R&&zi[R[1]]||U&&(R=(M=U).match(/[\.\\]([^\.\\])+$/),R&&zi[R[1]])?zi[R[1]]:"application/octet-stream"}function qs(j){for(var U=Ic(j),M=[],R=0;R<U.length;R+=76)M.push(U.slice(R,R+76));return M.join(`\r
`)+`\r
`}function as(j){var U=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var de=le.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],R=U.split(`\r
`),F=0;F<R.length;++F){var B=R[F];if(B.length==0){M.push("");continue}for(var se=0;se<B.length;){var ue=76,ee=B.slice(se,se+ue);ee.charAt(ue-1)=="="?ue--:ee.charAt(ue-2)=="="?ue-=2:ee.charAt(ue-3)=="="&&(ue-=3),ee=B.slice(se,se+ue),se+=ue,se<B.length&&(ee+="="),M.push(ee)}}return M.join(`\r
`)}function ss(j){for(var U=[],M=0;M<j.length;++M){for(var R=j[M];M<=j.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+j[++M];U.push(R)}for(var F=0;F<U.length;++F)U[F]=U[F].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return pr(U.join(`\r
`))}function Ks(j,U,M){for(var R="",F="",B="",se,ue=0;ue<10;++ue){var ee=U[ue];if(!ee||ee.match(/^\s*$/))break;var le=ee.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":R=le[2].trim();break;case"content-type":B=le[2].trim();break;case"content-transfer-encoding":F=le[2].trim();break}}switch(++ue,F.toLowerCase()){case"base64":se=pr(ha(U.slice(ue).join("")));break;case"quoted-printable":se=ss(U.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var de=en(j,R.slice(M.length),se,{unsafe:!0});B&&(de.ctype=B)}function yn(j,U){if(Be(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=U&&U.root||"",R=(_t&&Buffer.isBuffer(j)?j.toString("binary"):Be(j)).split(`\r
`),F=0,B="";for(F=0;F<R.length;++F)if(B=R[F],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),M||(M=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),B.slice(0,M.length)!=M););var se=(R[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ue="--"+(se[1]||""),ee=[],le=[],de={FileIndex:ee,FullPaths:le};D(de);var Se,Ae=0;for(F=0;F<R.length;++F){var Ie=R[F];Ie!==ue&&Ie!==ue+"--"||(Ae++&&Ks(de,R.slice(Se,F),M),Se=F)}return de}function li(j,U){var M=U||{},R=M.boundary||"SheetJS";R="------="+R;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],B=j.FullPaths[0],se=B,ue=j.FileIndex[0],ee=1;ee<j.FullPaths.length;++ee)if(se=j.FullPaths[ee].slice(B.length),ue=j.FileIndex[ee],!(!ue.size||!ue.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var le=ue.content,de=_t&&Buffer.isBuffer(le)?le.toString("binary"):Be(le),Se=0,Ae=Math.min(1024,de.length),Ie=0,Te=0;Te<=Ae;++Te)(Ie=de.charCodeAt(Te))>=32&&Ie<128&&++Se;var Oe=Se>=Ae*4/5;F.push(R),F.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+se),F.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),F.push("Content-Type: "+va(ue,se)),F.push(""),F.push(Oe?as(de):qs(de))}return F.push(R+`--\r
`),F.join(`\r
`)}function Jt(j){var U={};return D(U,j),U}function en(j,U,M,R){var F=R&&R.unsafe;F||D(j);var B=!F&&Pt.find(j,U);if(!B){var se=j.FullPaths[0];U.slice(0,se.length)==se?se=U:(se.slice(-1)!="/"&&(se+="/"),se=(se+U).replace("//","/")),B={name:r(U),type:2},j.FileIndex.push(B),j.FullPaths.push(se),F||Pt.utils.cfb_gc(j)}return B.content=M,B.size=M?M.length:0,R&&(R.CLSID&&(B.clsid=R.CLSID),R.mt&&(B.mt=R.mt),R.ct&&(B.ct=R.ct)),B}function br(j,U){D(j);var M=Pt.find(j,U);if(M){for(var R=0;R<j.FileIndex.length;++R)if(j.FileIndex[R]==M)return j.FileIndex.splice(R,1),j.FullPaths.splice(R,1),!0}return!1}function os(j,U,M){D(j);var R=Pt.find(j,U);if(R){for(var F=0;F<j.FileIndex.length;++F)if(j.FileIndex[F]==R)return j.FileIndex[F].name=r(M),j.FullPaths[F]=M,!0}return!1}function al(j){L(j,!0)}return e.find=K,e.read=I,e.parse=p,e.write=X,e.writeFile=Ne,e.utils={cfb_new:Jt,cfb_add:en,cfb_del:br,cfb_mov:os,cfb_gc:al,ReadShift:Tc,CheckField:MS,prep_blob:Ii,bconcat:zn,use_zlib:P,_deflateRaw:Ee,_inflateRaw:ut,consts:he},e}();function l6(n){return typeof n=="string"?df(n):Array.isArray(n)?R5(n):n}function $c(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=df(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var i=t=="utf8"?Bc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var r=new Blob([l6(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,n);if(typeof saveAs<"u")return saveAs(r,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:n,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=n,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=Xc(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+n)}function Vn(n){for(var e=Object.keys(n),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(n,e[i])&&t.push(e[i]);return t}function mx(n,e){for(var t=[],i=Vn(n),r=0;r!==i.length;++r)t[n[i[r]][e]]==null&&(t[n[i[r]][e]]=i[r]);return t}function Ip(n){for(var e=[],t=Vn(n),i=0;i!==t.length;++i)e[n[t[i]]]=t[i];return e}function mf(n){for(var e=[],t=Vn(n),i=0;i!==t.length;++i)e[n[t[i]]]=parseInt(t[i],10);return e}function c6(n){for(var e=[],t=Vn(n),i=0;i!==t.length;++i)e[n[t[i]]]==null&&(e[n[t[i]]]=[]),e[n[t[i]]].push(t[i]);return e}var Xd=new Date(1899,11,30,0,0,0);function _i(n,e){var t=n.getTime(),i=Xd.getTime()+(n.getTimezoneOffset()-Xd.getTimezoneOffset())*6e4;return(t-i)/(24*60*60*1e3)}var gS=new Date,u6=Xd.getTime()+(gS.getTimezoneOffset()-Xd.getTimezoneOffset())*6e4,px=gS.getTimezoneOffset();function vS(n){var e=new Date;return e.setTime(n*24*60*60*1e3+u6),e.getTimezoneOffset()!==px&&e.setTime(e.getTime()+(e.getTimezoneOffset()-px)*6e4),e}var gx=new Date("2017-02-19T19:06:09.000Z"),yS=isNaN(gx.getFullYear())?new Date("2/19/17"):gx,d6=yS.getFullYear()==2017;function oi(n,e){var t=new Date(n);if(d6)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(yS.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return n.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var r=n.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return n.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function pf(n,e){if(_t&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return t[o]||o})}catch{}for(var i=[],r=0;r!=n.length;++r)i.push(String.fromCharCode(n[r]));return i.join("")}function Ti(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ti(n[t]));return e}function rn(n,e){for(var t="";t.length<e;)t+=n;return t}function ua(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(r,o){return t=-t,o}),!isNaN(e=Number(i)))?e/t:e}var f6=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pc(n){var e=new Date(n),t=new Date(NaN),i=e.getYear(),r=e.getMonth(),o=e.getDate();if(isNaN(o))return t;var l=n.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&f6.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return i<0||i>8099?t:(r>0||o>1)&&i!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function nt(n,e,t){if(n.FullPaths){if(typeof t=="string"){var i;return _t?i=ga(t):i=L5(t),Pt.utils.cfb_add(n,e,i)}Pt.utils.cfb_add(n,e,t)}else n.file(e,t)}function Pp(){return Pt.utils.cfb_new()}var vn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,h6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bp=Ip(h6),Fp=/[&<>'"]/g,m6=/[\u0000-\u0008\u000b-\u001f]/g;function Dt(n){var e=n+"";return e.replace(Fp,function(t){return Bp[t]}).replace(m6,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function vx(n){return Dt(n).replace(/ /g,"_x0020_")}var xS=/[\u0000-\u001f]/g;function p6(n){var e=n+"";return e.replace(Fp,function(t){return Bp[t]}).replace(/\n/g,"<br/>").replace(xS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function g6(n){var e=n+"";return e.replace(Fp,function(t){return Bp[t]}).replace(xS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function v6(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function y6(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pm(n){for(var e="",t=0,i=0,r=0,o=0,l=0,u=0;t<n.length;){if(i=n.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(r=n.charCodeAt(t++),i>191&&i<224){l=(i&31)<<6,l|=r&63,e+=String.fromCharCode(l);continue}if(o=n.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63);continue}l=n.charCodeAt(t++),u=((i&7)<<18|(r&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function yx(n){var e=zs(2*n.length),t,i,r=1,o=0,l=0,u;for(i=0;i<n.length;i+=r)r=1,(u=n.charCodeAt(i))<128?t=u:u<224?(t=(u&31)*64+(n.charCodeAt(i+1)&63),r=2):u<240?(t=(u&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),r=3):(r=4,t=(u&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=t%256,e[o++]=t>>>8;return e.slice(0,o).toString("ucs2")}function xx(n){return ga(n,"binary").toString("utf8")}var wd="foo bar bazâð£",_c=_t&&(xx(wd)==Pm(wd)&&xx||yx(wd)==Pm(wd)&&yx)||Pm,Bc=_t?function(n){return ga(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,i=0,r=0;t<n.length;)switch(i=n.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=n.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(r>>18&7))),e.push(String.fromCharCode(144+(r>>12&63))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},x6=function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<n.length;++r)i=i.replace(n[r][0],n[r][1]);return i}}(),bS=/(^\s|\s$|\n)/;function Hn(n,e){return"<"+n+(e.match(bS)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Fc(n){return Vn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function je(n,e,t){return"<"+n+(t!=null?Fc(t):"")+(e!=null?(e.match(bS)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function ip(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function b6(n,e){switch(typeof n){case"string":var t=je("vt:lpwstr",Dt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return je((n|0)==n?"vt:i4":"vt:r8",Dt(String(n)));case"boolean":return je("vt:bool",n?"true":"false")}if(n instanceof Date)return je("vt:filetime",ip(n));throw new Error("Unable to serialize "+n)}var Dn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},tl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function S6(n,e){for(var t=1-2*(n[e+7]>>>7),i=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),r=n[e+6]&15,o=5;o>=0;--o)r=r*256+n[e+o];return i==2047?r==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),t*Math.pow(2,i-52)*r)}function _6(n,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,r=0,o=0,l=i?-e:e;isFinite(l)?l==0?r=o=0:(r=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-r),r<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?r=-1022:(o-=Math.pow(2,52),r+=1023)):(r=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)n[t+u]=o&255;n[t+6]=(r&15)<<4|o&15,n[t+7]=r>>4|i}var bx=function(n){for(var e=[],t=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var r=0,o=n[0][i].length;r<o;r+=t)e.push.apply(e,n[0][i].slice(r,r+t));return e},Sx=_t?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:ga(e)})):bx(n)}:bx,_x=function(n,e,t){for(var i=[],r=e;r<t;r+=2)i.push(String.fromCharCode(gc(n,r)));return i.join("").replace(Sc,"")},Up=_t?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Sc,""):_x(n,e,t)}:_x,Tx=function(n,e,t){for(var i=[],r=e;r<e+t;++r)i.push(("0"+n[r].toString(16)).slice(-2));return i.join("")},SS=_t?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):Tx(n,e,t)}:Tx,wx=function(n,e,t){for(var i=[],r=e;r<t;r++)i.push(String.fromCharCode(Fo(n,r)));return i.join("")},qc=_t?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):wx(e,t,i)}:wx,_S=function(n,e){var t=Bi(n,e);return t>0?qc(n,e+4,e+4+t-1):""},TS=_S,wS=function(n,e){var t=Bi(n,e);return t>0?qc(n,e+4,e+4+t-1):""},ES=wS,AS=function(n,e){var t=2*Bi(n,e);return t>0?qc(n,e+4,e+4+t-1):""},kS=AS,CS=function(e,t){var i=Bi(e,t);return i>0?Up(e,t+4,t+4+i):""},jS=CS,DS=function(n,e){var t=Bi(n,e);return t>0?qc(n,e+4,e+4+t):""},NS=DS,OS=function(n,e){return S6(n,e)},$d=OS,zp=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};_t&&(TS=function(e,t){if(!Buffer.isBuffer(e))return _S(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},ES=function(e,t){if(!Buffer.isBuffer(e))return wS(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},kS=function(e,t){if(!Buffer.isBuffer(e))return AS(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},jS=function(e,t){if(!Buffer.isBuffer(e))return CS(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},NS=function(e,t){if(!Buffer.isBuffer(e))return DS(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},$d=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):OS(e,t)},zp=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Fo=function(n,e){return n[e]},gc=function(n,e){return n[e+1]*256+n[e]},T6=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Bi=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Rs=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},w6=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Tc(n,e){var t="",i,r,o=[],l,u,f,m;switch(e){case"dbcs":if(m=this.l,_t&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(f=0;f<n;++f)t+=String.fromCharCode(gc(this,m)),m+=2;n*=2;break;case"utf8":t=qc(this,this.l,this.l+n);break;case"utf16le":n*=2,t=Up(this,this.l,this.l+n);break;case"wstr":return Tc.call(this,n,"dbcs");case"lpstr-ansi":t=TS(this,this.l),n=4+Bi(this,this.l);break;case"lpstr-cp":t=ES(this,this.l),n=4+Bi(this,this.l);break;case"lpwstr":t=kS(this,this.l),n=4+2*Bi(this,this.l);break;case"lpp4":n=4+Bi(this,this.l),t=jS(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Bi(this,this.l),t=NS(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(l=Fo(this,this.l+n++))!==0;)o.push(Sd(l));t=o.join("");break;case"_wstr":for(n=0,t="";(l=gc(this,this.l+n))!==0;)o.push(Sd(l)),n+=2;n+=2,t=o.join("");break;case"dbcs-cont":for(t="",m=this.l,f=0;f<n;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Fo(this,m),this.l=m+1,u=Tc.call(this,n-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Sd(gc(this,m))),m+=2}t=o.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,f=0;f!=n;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Fo(this,m),this.l=m+1,u=Tc.call(this,n-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Sd(Fo(this,m))),m+=1}t=o.join("");break;default:switch(n){case 1:return i=Fo(this,this.l),this.l++,i;case 2:return i=(e==="i"?T6:gc)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(i=(n>0?Rs:w6)(this,this.l),this.l+=4,i):(r=Bi(this,this.l),this.l+=4,r);case 8:case-8:if(e==="f")return n==8?r=$d(this,this.l):r=$d([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;n=8;case 16:t=SS(this,this.l,n);break}}return this.l+=n,t}var E6=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},A6=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},k6=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function C6(n,e,t){var i=0,r=0;if(t==="dbcs"){for(r=0;r!=e.length;++r)k6(this,e.charCodeAt(r),this.l+2*r);i=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=e.length;++r)this[this.l+r]=e.charCodeAt(r)&255;i=e.length}else if(t==="hex"){for(;r<n;++r)this[this.l++]=parseInt(e.slice(2*r,2*r+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+n,this.length);for(r=0;r<Math.min(e.length,n);++r){var l=e.charCodeAt(r);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,E6(this,e,this.l);break;case 8:if(i=8,t==="f"){_6(this,e,this.l);break}case 16:break;case-4:i=4,A6(this,e,this.l);break}return this.l+=i,this}function MS(n,e){var t=SS(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Ii(n,e){n.l=e,n.read_shift=Tc,n.chk=MS,n.write_shift=C6}function Pr(n,e){n.l+=e}function me(n){var e=zs(n);return Ii(e,0),e}function bi(){var n=[],e=_t?256:2048,t=function(m){var p=me(m);return Ii(p,0),p},i=t(e),r=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i),i=null)},o=function(m){return i&&m<i.length-i.l?i:(r(),i=t(Math.max(m+1,e)))},l=function(){return r(),zn(n)},u=function(m){r(),i=m,i.l==null&&(i.l=i.length),o(e)};return{next:o,push:u,end:l,_bufs:n}}function be(n,e,t,i){var r=+e,o;if(!isNaN(r)){i||(i=SM[r].p||(t||[]).length||0),o=1+(r>=128?1:0)+1,i>=128&&++o,i>=16384&&++o,i>=2097152&&++o;var l=n.next(o);r<=127?l.write_shift(1,r):(l.write_shift(1,(r&127)+128),l.write_shift(1,r>>7));for(var u=0;u!=4;++u)if(i>=128)l.write_shift(1,(i&127)+128),i>>=7;else{l.write_shift(1,i);break}i>0&&zp(t)&&n.push(t)}}function wc(n,e,t){var i=Ti(n);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Ex(n,e,t){var i=Ti(n);return i.s=wc(i.s,e.s,t),i.e=wc(i.e,e.s,t),i}function Ec(n,e){if(n.cRel&&n.c<0)for(n=Ti(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ti(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Nt(n);return!n.cRel&&n.cRel!=null&&(t=N6(t)),!n.rRel&&n.rRel!=null&&(t=j6(t)),t}function Bm(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Zn(n.s.c)+":"+(n.e.cRel?"":"$")+Zn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Wn(n.s.r)+":"+(n.e.rRel?"":"$")+Wn(n.e.r):Ec(n.s,e.biff)+":"+Ec(n.e,e.biff)}function Hp(n){return parseInt(D6(n),10)-1}function Wn(n){return""+(n+1)}function j6(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function D6(n){return n.replace(/\$(\d+)$/,"$1")}function Wp(n){for(var e=O6(n),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function Zn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function N6(n){return n.replace(/^([A-Z])/,"$$$1")}function O6(n){return n.replace(/^\$([A-Z])/,"$1")}function M6(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nn(n){for(var e=0,t=0,i=0;i<n.length;++i){var r=n.charCodeAt(i);r>=48&&r<=57?e=10*e+(r-48):r>=65&&r<=90&&(t=26*t+(r-64))}return{c:t-1,r:e-1}}function Nt(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Fi(n){var e=n.indexOf(":");return e==-1?{s:Nn(n),e:Nn(n)}:{s:Nn(n.slice(0,e)),e:Nn(n.slice(e+1))}}function gn(n,e){return typeof e>"u"||typeof e=="number"?gn(n.s,n.e):(typeof n!="string"&&(n=Nt(n)),typeof e!="string"&&(e=Nt(e)),n==e?n:n+":"+e)}function Vt(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,r=0,o=n.length;for(t=0;i<o&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)t=26*t+r;for(e.s.c=--t,t=0;i<o&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)t=10*t+r;if(e.s.r=--t,i===o||r!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=o&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)t=26*t+r;for(e.e.c=--t,t=0;i!=o&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)t=10*t+r;return e.e.r=--t,e}function Ax(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=es(n.z,t?_i(e):e)}catch{}try{return n.w=es((n.XF||{}).numFmtId||(t?14:0),t?_i(e):e)}catch{return""+e}}function ma(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?Kc[n.v]||n.v:e==null?Ax(n,n.v):Ax(n,e))}function Vs(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=n,{SheetNames:[t],Sheets:i}}function RS(n,e,t){var i=t||{},r=n?Array.isArray(n):i.dense,o=n||(r?[]:{}),l=0,u=0;if(o&&i.origin!=null){if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Nn(i.origin):i.origin;l=f.r,u=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Vt(o["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(m.e.r=l=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[v].length;++x)if(!(typeof e[v][x]>"u")){var S={v:e[v][x]},_=l+v,b=u+x;if(m.s.r>_&&(m.s.r=_),m.s.c>b&&(m.s.c=b),m.e.r<_&&(m.e.r=_),m.e.c<b&&(m.e.c=b),e[v][x]&&typeof e[v][x]=="object"&&!Array.isArray(e[v][x])&&!(e[v][x]instanceof Date))S=e[v][x];else if(Array.isArray(S.v)&&(S.f=e[v][x][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(i.nullError)S.t="e",S.v=0;else if(i.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=i.dateNF||sn[14],i.cellDates?(S.t="d",S.w=es(S.z,_i(S.v))):(S.t="n",S.v=_i(S.v),S.w=es(S.z,S.v))):S.t="s";if(r)o[_]||(o[_]=[]),o[_][b]&&o[_][b].z&&(S.z=o[_][b].z),o[_][b]=S;else{var T=Nt({c:b,r:_});o[T]&&o[T].z&&(S.z=o[T].z),o[T]=S}}}return m.s.c<1e7&&(o["!ref"]=gn(m)),o}function nl(n,e){return RS(null,n,e)}function R6(n){return n.read_shift(4,"i")}function vr(n,e){return e||(e=me(4)),e.write_shift(4,n),e}function Qn(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function On(n,e){var t=!1;return e==null&&(t=!0,e=me(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function L6(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function I6(n,e){return e||(e=me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Vp(n,e){var t=n.l,i=n.read_shift(1),r=Qn(n),o=[],l={t:r,h:r};if((i&1)!==0){for(var u=n.read_shift(4),f=0;f!=u;++f)o.push(L6(n));l.r=o}else l.r=[{ich:0,ifnt:0}];return n.l=t+e,l}function P6(n,e){var t=!1;return e==null&&(t=!0,e=me(15+4*n.t.length)),e.write_shift(1,0),On(n.t,e),t?e.slice(0,e.l):e}var B6=Vp;function F6(n,e){var t=!1;return e==null&&(t=!0,e=me(23+4*n.t.length)),e.write_shift(1,1),On(n.t,e),e.write_shift(4,1),I6({},e),t?e.slice(0,e.l):e}function rr(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Gs(n,e){return e==null&&(e=me(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Ys(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Xs(n,e){return e==null&&(e=me(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var U6=Qn,LS=On;function Gp(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function qd(n,e){var t=!1;return e==null&&(t=!0,e=me(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var z6=Qn,rp=Gp,Yp=qd;function IS(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,i=e[0]&2;n.l+=4;var r=i===0?$d([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Rs(e,0)>>2;return t?r/100:r}function PS(n,e){e==null&&(e=me(4));var t=0,i=0,r=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(i=1,t=1),i)e.write_shift(-4,((t?r:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function BS(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function H6(n,e){return e||(e=me(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var $s=BS,il=H6;function rl(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Hs(n,e){return(e||me(8)).write_shift(8,n,"f")}function W6(n){var e={},t=n.read_shift(1),i=t>>>1,r=n.read_shift(1),o=n.read_shift(2,"i"),l=n.read_shift(1),u=n.read_shift(1),f=n.read_shift(1);switch(n.l++,i){case 0:e.auto=1;break;case 1:e.index=r;var m=Q6[r];m&&(e.rgb=Px(m));break;case 2:e.rgb=Px([l,u,f]);break;case 3:e.theme=r;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function Kd(n,e){if(e||(e=me(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function V6(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function G6(n,e){e||(e=me(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var FS=2,Li=3,Ed=11,Zd=19,Ad=64,Y6=65,X6=71,$6=4108,q6=4126,Un=80,kx={1:{n:"CodePage",t:FS},2:{n:"Category",t:Un},3:{n:"PresentationFormat",t:Un},4:{n:"ByteCount",t:Li},5:{n:"LineCount",t:Li},6:{n:"ParagraphCount",t:Li},7:{n:"SlideCount",t:Li},8:{n:"NoteCount",t:Li},9:{n:"HiddenCount",t:Li},10:{n:"MultimediaClipCount",t:Li},11:{n:"ScaleCrop",t:Ed},12:{n:"HeadingPairs",t:$6},13:{n:"TitlesOfParts",t:q6},14:{n:"Manager",t:Un},15:{n:"Company",t:Un},16:{n:"LinksUpToDate",t:Ed},17:{n:"CharacterCount",t:Li},19:{n:"SharedDoc",t:Ed},22:{n:"HyperlinksChanged",t:Ed},23:{n:"AppVersion",t:Li,p:"version"},24:{n:"DigSig",t:Y6},26:{n:"ContentType",t:Un},27:{n:"ContentStatus",t:Un},28:{n:"Language",t:Un},29:{n:"Version",t:Un},255:{},2147483648:{n:"Locale",t:Zd},2147483651:{n:"Behavior",t:Zd},1919054434:{}},Cx={1:{n:"CodePage",t:FS},2:{n:"Title",t:Un},3:{n:"Subject",t:Un},4:{n:"Author",t:Un},5:{n:"Keywords",t:Un},6:{n:"Comments",t:Un},7:{n:"Template",t:Un},8:{n:"LastAuthor",t:Un},9:{n:"RevNumber",t:Un},10:{n:"EditTime",t:Ad},11:{n:"LastPrinted",t:Ad},12:{n:"CreatedDate",t:Ad},13:{n:"ModifiedDate",t:Ad},14:{n:"PageCount",t:Li},15:{n:"WordCount",t:Li},16:{n:"CharCount",t:Li},17:{n:"Thumbnail",t:X6},18:{n:"Application",t:Un},19:{n:"DocSecurity",t:Li},255:{},2147483648:{n:"Locale",t:Zd},2147483651:{n:"Behavior",t:Zd},1919054434:{}};function K6(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Z6=K6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Q6=Ti(Z6),Kc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},J6={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},kd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function US(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function zS(n,e){var t=c6(J6),i=[],r;i[i.length]=vn,i[i.length]=je("Types",null,{xmlns:Dn.CT,"xmlns:xsd":Dn.xsd,"xmlns:xsi":Dn.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return je("Default",null,{Extension:f[0],ContentType:f[1]})}));var o=function(f){n[f]&&n[f].length>0&&(r=n[f][0],i[i.length]=je("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:kd[f][e.bookType]||kd[f].xlsx}))},l=function(f){(n[f]||[]).forEach(function(m){i[i.length]=je("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:kd[f][e.bookType]||kd[f].xlsx})})},u=function(f){(n[f]||[]).forEach(function(m){i[i.length]=je("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[f][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function HS(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function Vo(n){var e=[vn,je("Relationships",null,{xmlns:Dn.RELS})];return Vn(n["!id"]).forEach(function(t){e[e.length]=je("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ct(n,e,t,i,r,o){if(r||(r={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,r.Id="rId"+e,r.Type=i,r.Target=t,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),n["!id"][r.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][r.Id]=r,n[("/"+r.Target).replace("//","/")]=r,e}function eC(n){var e=[vn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function jx(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function tC(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function nC(n){var e=[vn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(jx(n[t][0],n[t][1])),e.push(tC("",n[t][0]));return e.push(jx("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function WS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Hd.version+"</meta:generator></office:meta></office:document-meta>"}var Bs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Fm(n,e,t,i,r){r[n]!=null||e==null||e===""||(r[n]=e,e=Dt(e),i[i.length]=t?je(n,e,t):Hn(n,e))}function VS(n,e){var t=e||{},i=[vn,je("cp:coreProperties",null,{"xmlns:cp":Dn.CORE_PROPS,"xmlns:dc":Dn.dc,"xmlns:dcterms":Dn.dcterms,"xmlns:dcmitype":Dn.dcmitype,"xmlns:xsi":Dn.xsi})],r={};if(!n&&!t.Props)return i.join("");n&&(n.CreatedDate!=null&&Fm("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:ip(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),n.ModifiedDate!=null&&Fm("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:ip(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var o=0;o!=Bs.length;++o){var l=Bs[o],u=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:n?n[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Fm(l[0],u,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Go=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],GS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function YS(n){var e=[],t=je;return n||(n={}),n.Application="SheetJS",e[e.length]=vn,e[e.length]=je("Properties",null,{xmlns:Dn.EXT_PROPS,"xmlns:vt":Dn.vt}),Go.forEach(function(i){if(n[i[1]]!==void 0){var r;switch(i[2]){case"string":r=Dt(String(n[i[1]]));break;case"bool":r=n[i[1]]?"true":"false";break}r!==void 0&&(e[e.length]=t(i[0],r))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+Dt(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function XS(n){var e=[vn,je("Properties",null,{xmlns:Dn.CUST_PROPS,"xmlns:vt":Dn.vt})];if(!n)return e.join("");var t=1;return Vn(n).forEach(function(r){++t,e[e.length]=je("property",b6(n[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Dt(r)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Dx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function iC(n,e){var t=[];return Vn(Dx).map(function(i){for(var r=0;r<Bs.length;++r)if(Bs[r][1]==i)return Bs[r];for(r=0;r<Go.length;++r)if(Go[r][1]==i)return Go[r];throw i}).forEach(function(i){if(n[i[1]]!=null){var r=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:n[i[1]];switch(i[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),t.push(Hn(Dx[i[1]]||i[1],r))}}),je("DocumentProperties",t.join(""),{xmlns:Pi.o})}function rC(n,e){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return n&&Vn(n).forEach(function(o){if(Object.prototype.hasOwnProperty.call(n,o)){for(var l=0;l<Bs.length;++l)if(o==Bs[l][1])return;for(l=0;l<Go.length;++l)if(o==Go[l][1])return;for(l=0;l<t.length;++l)if(o==t[l])return;var u=n[o],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),r.push(je(vx(o),u,{"dt:dt":f}))}}),e&&Vn(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(n&&Object.prototype.hasOwnProperty.call(n,o))){var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),r.push(je(vx(o),l,{"dt:dt":u}))}}),"<"+i+' xmlns="'+Pi.o+'">'+r.join("")+"</"+i+">"}function aC(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,i=t%Math.pow(2,32),r=(t-i)/Math.pow(2,32);i*=1e7,r*=1e7;var o=i/Math.pow(2,32)|0;o>0&&(i=i%Math.pow(2,32),r+=o);var l=me(8);return l.write_shift(4,i),l.write_shift(4,r),l}function Nx(n,e){var t=me(4),i=me(4);switch(t.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,e);break;case 5:i=me(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=aC(e);break;case 31:case 80:for(i=me(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return zn([t,i])}var $S=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function sC(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function Ox(n,e,t){var i=me(8),r=[],o=[],l=8,u=0,f=me(8),m=me(8);if(f.write_shift(4,2),f.write_shift(4,1200),m.write_shift(4,1),o.push(f),r.push(m),l+=8+f.length,!e){m=me(8),m.write_shift(4,0),r.unshift(m);var p=[me(4)];for(p[0].write_shift(4,n.length),u=0;u<n.length;++u){var v=n[u][0];for(f=me(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);p.push(f)}f=zn(p),o.unshift(f),l+=8+f.length}for(u=0;u<n.length;++u)if(!(e&&!e[n[u][0]])&&!($S.indexOf(n[u][0])>-1||GS.indexOf(n[u][0])>-1)&&n[u][1]!=null){var x=n[u][1],S=0;if(e){S=+e[n[u][0]];var _=t[S];if(_.p=="version"&&typeof x=="string"){var b=x.split(".");x=(+b[0]<<16)+(+b[1]||0)}f=Nx(_.t,x)}else{var T=sC(x);T==-1&&(T=31,x=String(x)),f=Nx(T,x)}o.push(f),m=me(8),m.write_shift(4,e?S:2+u),r.push(m),l+=8+f.length}var w=8*(o.length+1);for(u=0;u<o.length;++u)r[u].write_shift(4,w),w+=o[u].length;return i.write_shift(4,l),i.write_shift(4,o.length),zn([i].concat(r).concat(o))}function Mx(n,e,t,i,r,o){var l=me(r?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Pt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,r?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,r?68:48);var f=Ox(n,t,i);if(u.push(f),r){var m=Ox(r,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+f.length),u.push(m)}return zn(u)}function oC(n,e){e||(e=me(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function lC(n,e){return n.read_shift(e)===1}function si(n,e){return e||(e=me(2)),e.write_shift(2,+!!n),e}function qS(n){return n.read_shift(2,"u")}function er(n,e){return e||(e=me(2)),e.write_shift(2,n),e}function KS(n,e,t){return t||(t=me(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function ZS(n,e,t){var i=n.read_shift(t&&t.biff>=12?2:1),r="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=n.read_shift(1);o&&(r="dbcs-cont")}else t.biff==12&&(r="wstr");t.biff>=2&&t.biff<=5&&(r="cpstr");var l=i?n.read_shift(i,r):"";return l}function cC(n){var e=n.t||"",t=me(3);t.write_shift(2,e.length),t.write_shift(1,1);var i=me(2*e.length);i.write_shift(2*e.length,e,"utf16le");var r=[t,i];return zn(r)}function uC(n,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var r=n.read_shift(1);return r===0?i=n.read_shift(e,"sbcs-cont"):i=n.read_shift(e,"dbcs-cont"),i}function dC(n,e,t){var i=n.read_shift(t&&t.biff==2?1:2);return i===0?(n.l++,""):uC(n,i,t)}function fC(n,e,t){if(t.biff>5)return dC(n,e,t);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function QS(n,e,t){return t||(t=me(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function Rx(n,e){e||(e=me(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function hC(n){var e=me(512),t=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),o=r>-1?31:23;switch(i.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)e.write_shift(4,l[t]);if(o==28)i=i.slice(1),Rx(i,e);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));var u=r>-1?i.slice(0,r):i;for(e.write_shift(4,2*(u.length+1)),t=0;t<u.length;++t)e.write_shift(2,u.charCodeAt(t));e.write_shift(2,0),o&8&&Rx(r>-1?i.slice(r+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));for(var f=0;i.slice(f*3,f*3+3)=="../"||i.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,i.length-3*f+1),t=0;t<i.length-3*f;++t)e.write_shift(1,i.charCodeAt(t+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Ws(n,e,t,i){return i||(i=me(6)),i.write_shift(2,n),i.write_shift(2,e),i.write_shift(2,t||0),i}function mC(n,e,t){var i=t.biff>8?4:2,r=n.read_shift(i),o=n.read_shift(i,"i"),l=n.read_shift(i,"i");return[r,o,l]}function pC(n){var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(2),r=n.read_shift(2);return{s:{c:i,r:e},e:{c:r,r:t}}}function JS(n,e){return e||(e=me(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function Xp(n,e,t){var i=1536,r=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=me(r);return o.write_shift(2,i),o.write_shift(2,e),r>4&&o.write_shift(2,29282),r>6&&o.write_shift(2,1997),r>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function gC(n,e){var t=!e||e.biff==8,i=me(t?112:54);for(i.write_shift(e.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function vC(n,e){var t=!e||e.biff>=8?2:1,i=me(8+t*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function yC(n,e){var t=me(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var i=[],r=0;r<n.length;++r)i[r]=cC(n[r]);var o=zn([t].concat(i));return o.parts=[t.length].concat(i.map(function(l){return l.length})),o}function xC(){var n=me(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function bC(n){var e=me(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function SC(n,e){var t=n.name||"Arial",i=e&&e.biff==5,r=i?15+t.length:16+2*t.length,o=me(r);return o.write_shift(2,n.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),i||o.write_shift(1,1),o.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),o}function _C(n,e,t,i){var r=me(10);return Ws(n,e,i,r),r.write_shift(4,t),r}function TC(n,e,t,i,r){var o=!r||r.biff==8,l=me(8+ +o+(1+o)*t.length);return Ws(n,e,i,l),l.write_shift(2,t.length),o&&l.write_shift(1,1),l.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),l}function wC(n,e,t,i){var r=t&&t.biff==5;i||(i=me(r?3+e.length:5+2*e.length)),i.write_shift(2,n),i.write_shift(r?1:2,e.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le");var o=i.length>i.l?i.slice(0,i.l):i;return o.l==null&&(o.l=o.length),o}function EC(n,e){var t=e.biff==8||!e.biff?4:2,i=me(2*t+6);return i.write_shift(t,n.s.r),i.write_shift(t,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function Lx(n,e,t,i){var r=t&&t.biff==5;i||(i=me(r?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,e<<4));var o=0;return n.numFmtId>0&&r&&(o|=1024),i.write_shift(4,o),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function AC(n){var e=me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function kC(n,e,t,i,r,o){var l=me(8);return Ws(n,e,i,l),KS(t,o,l),l}function CC(n,e,t,i){var r=me(14);return Ws(n,e,i,r),Hs(t,r),r}function jC(n,e,t){if(t.biff<8)return DC(n,e,t);for(var i=[],r=n.l+e,o=n.read_shift(t.biff>8?4:2);o--!==0;)i.push(mC(n,t.biff>8?12:6,t));if(n.l!=r)throw new Error("Bad ExternSheet: "+n.l+" != "+r);return i}function DC(n,e,t){n[n.l+1]==3&&n[n.l]++;var i=ZS(n,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function NC(n){var e=me(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)JS(n[t],e);return e}function OC(n){var e=me(24),t=Nn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)e.write_shift(1,parseInt(i[r],16));return zn([e,hC(n[1])])}function MC(n){var e=n[1].Tooltip,t=me(10+2*(e.length+1));t.write_shift(2,2048);var i=Nn(n[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function RC(n){return n||(n=me(4)),n.write_shift(2,1),n.write_shift(2,1),n}function LC(n,e,t){if(!t.cellStyles)return Pr(n,e);var i=t&&t.biff>=12?4:2,r=n.read_shift(i),o=n.read_shift(i),l=n.read_shift(i),u=n.read_shift(i),f=n.read_shift(2);i==2&&(n.l+=2);var m={s:r,e:o,w:l,ixfe:u,flags:f};return(t.biff>=5||!t.biff)&&(m.level=f>>8&7),m}function IC(n,e){var t=me(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var i=0;return n.hidden&&(i|=1),t.write_shift(1,i),i=n.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function PC(n){for(var e=me(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function BC(n,e,t){var i=me(15);return Qc(i,n,e),i.write_shift(8,t,"f"),i}function FC(n,e,t){var i=me(9);return Qc(i,n,e),i.write_shift(2,t),i}var UC=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Ip({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,f){var m=[],p=zs(1);switch(f.type){case"base64":p=pr(ha(u));break;case"binary":p=pr(u);break;case"buffer":case"array":p=u;break}Ii(p,0);var v=p.read_shift(1),x=!!(v&136),S=!1,_=!1;switch(v){case 2:break;case 3:break;case 48:S=!0,x=!0;break;case 49:S=!0,x=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var b=0,T=521;v==2&&(b=p.read_shift(2)),p.l+=3,v!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),v!=2&&(T=p.read_shift(2));var w=p.read_shift(2),A=f.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(A=n[p[p.l]]),p.l+=1,p.l+=2),_&&(p.l+=36);for(var C=[],N={},E=Math.min(p.length,v==2?521:T-10-(S?264:0)),I=_?32:11;p.l<E&&p[p.l]!=13;)switch(N={},N.name=Wd.utils.decode(A,p.slice(p.l,p.l+I)).replace(/[\u0000\r\n].*$/g,""),p.l+=I,N.type=String.fromCharCode(p.read_shift(1)),v!=2&&!_&&(N.offset=p.read_shift(4)),N.len=p.read_shift(1),v==2&&(N.offset=p.read_shift(2)),N.dec=p.read_shift(1),N.name.length&&C.push(N),v!=2&&(p.l+=_?13:14),N.type){case"B":(!S||N.len!=8)&&f.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(p[p.l]!==13&&(p.l=T-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=T;var D=0,z=0;for(m[0]=[],z=0;z!=C.length;++z)m[0][z]=C[z].name;for(;b-- >0;){if(p[p.l]===42){p.l+=w;continue}for(++p.l,m[++D]=[],z=0,z=0;z!=C.length;++z){var L=p.slice(p.l,p.l+C[z].len);p.l+=C[z].len,Ii(L,0);var H=Wd.utils.decode(A,L);switch(C[z].type){case"C":H.trim().length&&(m[D][z]=H.replace(/\s+$/,""));break;case"D":H.length===8?m[D][z]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):m[D][z]=H;break;case"F":m[D][z]=parseFloat(H.trim());break;case"+":case"I":m[D][z]=_?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":m[D][z]=!0;break;case"N":case"F":m[D][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[D][z]="##MEMO##"+(_?parseInt(H.trim(),10):L.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(m[D][z]=+H||0);break;case"@":m[D][z]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":m[D][z]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":m[D][z]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[D][z]=-L.read_shift(-8,"f");break;case"B":if(S&&C[z].len==8){m[D][z]=L.read_shift(8,"f");break}case"G":case"P":L.l+=C[z].len;break;case"0":if(C[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[z].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(m=m.slice(0,f.sheetRows)),f.DBF=C,m}function i(u,f){var m=f||{};m.dateNF||(m.dateNF="yyyymmdd");var p=nl(t(u,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function r(u,f){try{return Vs(i(u,f),f)}catch(m){if(f&&f.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var m=f||{};if(+m.codepage>=0&&Lc(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=bi(),v=nf(u,{header:1,raw:!0,cellDates:!0}),x=v[0],S=v.slice(1),_=u["!cols"]||[],b=0,T=0,w=0,A=1;for(b=0;b<x.length;++b){if(((_[b]||{}).DBF||{}).name){x[b]=_[b].DBF.name,++w;continue}if(x[b]!=null){if(++w,typeof x[b]=="number"&&(x[b]=x[b].toString(10)),typeof x[b]!="string")throw new Error("DBF Invalid column name "+x[b]+" |"+typeof x[b]+"|");if(x.indexOf(x[b])!==b){for(T=0;T<1024;++T)if(x.indexOf(x[b]+"_"+T)==-1){x[b]+="_"+T;break}}}}var C=Vt(u["!ref"]),N=[],E=[],I=[];for(b=0;b<=C.e.c-C.s.c;++b){var D="",z="",L=0,H=[];for(T=0;T<S.length;++T)S[T][b]!=null&&H.push(S[T][b]);if(H.length==0||x[b]==null){N[b]="?";continue}for(T=0;T<H.length;++T){switch(typeof H[T]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=H[T]instanceof Date?"D":"C";break;default:z="C"}L=Math.max(L,String(H[T]).length),D=D&&D!=z?"C":z}L>250&&(L=250),z=((_[b]||{}).DBF||{}).type,z=="C"&&_[b].DBF.len>L&&(L=_[b].DBF.len),D=="B"&&z=="N"&&(D="N",I[b]=_[b].DBF.dec,L=_[b].DBF.len),E[b]=D=="C"||z=="N"?L:o[D]||0,A+=E[b],N[b]=D}var K=p.next(32);for(K.write_shift(4,318902576),K.write_shift(4,S.length),K.write_shift(2,296+32*w),K.write_shift(2,A),b=0;b<4;++b)K.write_shift(4,0);for(K.write_shift(4,0|(+e[tS]||3)<<8),b=0,T=0;b<x.length;++b)if(x[b]!=null){var ne=p.next(32),xe=(x[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ne.write_shift(1,xe,"sbcs"),ne.write_shift(1,N[b]=="?"?"C":N[b],"sbcs"),ne.write_shift(4,T),ne.write_shift(1,E[b]||o[N[b]]||0),ne.write_shift(1,I[b]||0),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(1,0),ne.write_shift(4,0),ne.write_shift(4,0),T+=E[b]||o[N[b]]||0}var He=p.next(264);for(He.write_shift(4,13),b=0;b<65;++b)He.write_shift(4,0);for(b=0;b<S.length;++b){var _e=p.next(A);for(_e.write_shift(1,0),T=0;T<x.length;++T)if(x[T]!=null)switch(N[T]){case"L":_e.write_shift(1,S[b][T]==null?63:S[b][T]?84:70);break;case"B":_e.write_shift(8,S[b][T]||0,"f");break;case"N":var ie="0";for(typeof S[b][T]=="number"&&(ie=S[b][T].toFixed(I[T]||0)),w=0;w<E[T]-ie.length;++w)_e.write_shift(1,32);_e.write_shift(1,ie,"sbcs");break;case"D":S[b][T]?(_e.write_shift(4,("0000"+S[b][T].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(S[b][T].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+S[b][T].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var he=String(S[b][T]!=null?S[b][T]:"").slice(0,E[T]);for(_e.write_shift(1,he,"sbcs"),w=0;w<E[T]-he.length;++w)_e.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:r,to_sheet:i,from_sheet:l}}(),zC=function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Vn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,S){var _=n[S];return typeof _=="number"?ax(_):_},i=function(x,S,_){var b=S.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return b==59?x:ax(b)};n["|"]=254;function r(x,S){switch(S.type){case"base64":return o(ha(x),S);case"binary":return o(x,S);case"buffer":return o(_t&&Buffer.isBuffer(x)?x.toString("binary"):Xc(x),S);case"array":return o(pf(x),S)}throw new Error("Unrecognized type "+S.type)}function o(x,S){var _=x.split(/[\n\r]+/),b=-1,T=-1,w=0,A=0,C=[],N=[],E=null,I={},D=[],z=[],L=[],H=0,K;for(+S.codepage>=0&&Lc(+S.codepage);w!==_.length;++w){H=0;var ne=_[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),xe=ne.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),He=xe[0],_e;if(ne.length>0)switch(He){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":xe[1].charAt(0)=="P"&&N.push(ne.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,he=!1,Ne=!1,Be=!1,X=-1,pe=-1;for(A=1;A<xe.length;++A)switch(xe[A].charAt(0)){case"A":break;case"X":T=parseInt(xe[A].slice(1))-1,he=!0;break;case"Y":for(b=parseInt(xe[A].slice(1))-1,he||(T=0),K=C.length;K<=b;++K)C[K]=[];break;case"K":_e=xe[A].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(ua(_e))?isNaN(Pc(_e).getDate())||(_e=oi(_e)):(_e=ua(_e),E!==null&&hS(E)&&(_e=vS(_e))),ie=!0;break;case"E":Be=!0;var P=Fj(xe[A].slice(1),{r:b,c:T});C[b][T]=[C[b][T],P];break;case"S":Ne=!0,C[b][T]=[C[b][T],"S5S"];break;case"G":break;case"R":X=parseInt(xe[A].slice(1))-1;break;case"C":pe=parseInt(xe[A].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}if(ie&&(C[b][T]&&C[b][T].length==2?C[b][T][0]=_e:C[b][T]=_e,E=null),Ne){if(Be)throw new Error("SYLK shared formula cannot have own formula");var Y=X>-1&&C[X][pe];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");C[b][T][1]=Uj(Y[1],{r:b-X,c:T-pe})}break;case"F":var V=0;for(A=1;A<xe.length;++A)switch(xe[A].charAt(0)){case"X":T=parseInt(xe[A].slice(1))-1,++V;break;case"Y":for(b=parseInt(xe[A].slice(1))-1,K=C.length;K<=b;++K)C[K]=[];break;case"M":H=parseInt(xe[A].slice(1))/20;break;case"F":break;case"G":break;case"P":E=N[parseInt(xe[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=xe[A].slice(1).split(" "),K=parseInt(L[0],10);K<=parseInt(L[1],10);++K)H=parseInt(L[2],10),z[K-1]=H===0?{hidden:!0}:{wch:H},$p(z[K-1]);break;case"C":T=parseInt(xe[A].slice(1))-1,z[T]||(z[T]={});break;case"R":b=parseInt(xe[A].slice(1))-1,D[b]||(D[b]={}),H>0?(D[b].hpt=H,D[b].hpx=r_(H)):H===0&&(D[b].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}V<1&&(E=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}}return D.length>0&&(I["!rows"]=D),z.length>0&&(I["!cols"]=z),S&&S.sheetRows&&(C=C.slice(0,S.sheetRows)),[C,I]}function l(x,S){var _=r(x,S),b=_[0],T=_[1],w=nl(b,S);return Vn(T).forEach(function(A){w[A]=T[A]}),w}function u(x,S){return Vs(l(x,S),S)}function f(x,S,_,b){var T="C;Y"+(_+1)+";X"+(b+1)+";K";switch(x.t){case"n":T+=x.v||0,x.f&&!x.F&&(T+=";E"+Kp(x.f,{r:_,c:b}));break;case"b":T+=x.v?"TRUE":"FALSE";break;case"e":T+=x.w||x.v;break;case"d":T+='"'+(x.w||x.v)+'"';break;case"s":T+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function m(x,S){S.forEach(function(_,b){var T="F;W"+(b+1)+" "+(b+1)+" ";_.hidden?T+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Qd(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Jd(_.wpx)),typeof _.wch=="number"&&(T+=Math.round(_.wch))),T.charAt(T.length-1)!=" "&&x.push(T)})}function p(x,S){S.forEach(function(_,b){var T="F;";_.hidden?T+="M0;":_.hpt?T+="M"+20*_.hpt+";":_.hpx&&(T+="M"+20*ef(_.hpx)+";"),T.length>2&&x.push(T+"R"+(b+1))})}function v(x,S){var _=["ID;PWXL;N;E"],b=[],T=Vt(x["!ref"]),w,A=Array.isArray(x),C=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),x["!cols"]&&m(_,x["!cols"]),x["!rows"]&&p(_,x["!rows"]),_.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var N=T.s.r;N<=T.e.r;++N)for(var E=T.s.c;E<=T.e.c;++E){var I=Nt({r:N,c:E});w=A?(x[N]||[])[E]:x[I],!(!w||w.v==null&&(!w.f||w.F))&&b.push(f(w,x,N,E))}return _.join(C)+C+b.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:l,from_sheet:v}}(),HC=function(){function n(o,l){switch(l.type){case"base64":return e(ha(o),l);case"binary":return e(o,l);case"buffer":return e(_t&&Buffer.isBuffer(o)?o.toString("binary"):Xc(o),l);case"array":return e(pf(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),f=-1,m=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++f]=[],m=0;continue}if(!(f<0)){var x=u[p].trim().split(","),S=x[0],_=x[1];++p;for(var b=u[p]||"";(b.match(/["]/g)||[]).length&1&&p<u.length-1;)b+=`
`+u[++p];switch(b=b.trim(),+S){case-1:if(b==="BOT"){v[++f]=[],m=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?v[f][m]=!0:b==="FALSE"?v[f][m]=!1:isNaN(ua(_))?isNaN(Pc(_).getDate())?v[f][m]=_:v[f][m]=oi(_):v[f][m]=ua(_),++m;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),v[f][m++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function t(o,l){return nl(n(o,l),l)}function i(o,l){return Vs(t(o,l),l)}var r=function(){var o=function(f,m,p,v,x){f.push(m),f.push(p+","+v),f.push('"'+x.replace(/"/g,'""')+'"')},l=function(f,m,p,v){f.push(m+","+p),f.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var m=[],p=Vt(f["!ref"]),v,x=Array.isArray(f);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,p.e.r-p.s.r+1,""),o(m,"TUPLES",0,p.e.c-p.s.c+1,""),o(m,"DATA",0,0,"");for(var S=p.s.r;S<=p.e.r;++S){l(m,-1,0,"BOT");for(var _=p.s.c;_<=p.e.c;++_){var b=Nt({r:S,c:_});if(v=x?(f[S]||[])[_]:f[b],!v){l(m,1,0,"");continue}switch(v.t){case"n":var T=v.w;!T&&v.v!=null&&(T=v.v),T==null?v.f&&!v.F?l(m,1,0,"="+v.f):l(m,1,0,""):l(m,0,T,"V");break;case"b":l(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=es(v.z||sn[14],_i(oi(v.v)))),l(m,0,v.w,"V");break;default:l(m,1,0,"")}}}l(m,-1,0,"EOD");var w=`\r
`,A=m.join(w);return A}}();return{to_workbook:i,to_sheet:t,from_sheet:r}}(),e_=function(){function n(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,x){for(var S=v.split(`
`),_=-1,b=-1,T=0,w=[];T!==S.length;++T){var A=S[T].trim().split(":");if(A[0]==="cell"){var C=Nn(A[1]);if(w.length<=C.r)for(_=w.length;_<=C.r;++_)w[_]||(w[_]=[]);switch(_=C.r,b=C.c,A[2]){case"t":w[_][b]=n(A[3]);break;case"v":w[_][b]=+A[3];break;case"vtf":var N=A[A.length-1];case"vtc":switch(A[3]){case"nl":w[_][b]=!!+A[4];break;default:w[_][b]=+A[4];break}A[2]=="vtf"&&(w[_][b]=[w[_][b],N])}}}return x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),w}function i(v,x){return nl(t(v,x),x)}function r(v,x){return Vs(i(v,x),x)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var x=[],S=[],_,b="",T=Fi(v["!ref"]),w=Array.isArray(v),A=T.s.r;A<=T.e.r;++A)for(var C=T.s.c;C<=T.e.c;++C)if(b=Nt({r:A,c:C}),_=w?(v[A]||[])[C]:v[b],!(!_||_.v==null||_.t==="z")){switch(S=["cell",b,"t"],_.t){case"s":case"str":S.push(e(_.v));break;case"n":_.f?(S[2]="vtf",S[3]="n",S[4]=_.v,S[5]=e(_.f)):(S[2]="v",S[3]=_.v);break;case"b":S[2]="vt"+(_.f?"f":"c"),S[3]="nl",S[4]=_.v?"1":"0",S[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var N=_i(oi(_.v));S[2]="vtc",S[3]="nd",S[4]=""+N,S[5]=_.w||es(_.z||sn[14],N);break;case"e":continue}x.push(S.join(":"))}return x.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function p(v){return[o,l,u,l,m(v),f].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:p}}(),WC=function(){function n(p,v,x,S,_){_.raw?v[x][S]=p:p===""||(p==="TRUE"?v[x][S]=!0:p==="FALSE"?v[x][S]=!1:isNaN(ua(p))?isNaN(Pc(p).getDate())?v[x][S]=p:v[x][S]=oi(p):v[x][S]=ua(p))}function e(p,v){var x=v||{},S=[];if(!p||p.length===0)return S;for(var _=p.split(/[\r\n]/),b=_.length-1;b>=0&&_[b].length===0;)--b;for(var T=10,w=0,A=0;A<=b;++A)w=_[A].indexOf(" "),w==-1?w=_[A].length:w++,T=Math.max(T,w);for(A=0;A<=b;++A){S[A]=[];var C=0;for(n(_[A].slice(0,T).trim(),S,A,C,x),C=1;C<=(_[A].length-T)/10+1;++C)n(_[A].slice(T+(C-1)*10,T+C*10).trim(),S,A,C,x)}return x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(p){for(var v={},x=!1,S=0,_=0;S<p.length;++S)(_=p.charCodeAt(S))==34?x=!x:!x&&_ in t&&(v[_]=(v[_]||0)+1);_=[];for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&_.push([v[S],S]);if(!_.length){v=i;for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&_.push([v[S],S])}return _.sort(function(b,T){return b[0]-T[0]||i[b[1]]-i[T[1]]}),t[_.pop()[1]]||44}function o(p,v){var x=v||{},S="",_=x.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(S=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(S=p.charAt(4),p=p.slice(6)):S=r(p.slice(0,1024)):x&&x.FS?S=x.FS:S=r(p.slice(0,1024));var T=0,w=0,A=0,C=0,N=0,E=S.charCodeAt(0),I=!1,D=0,z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var L=x.dateNF!=null?a6(x.dateNF):null;function H(){var K=p.slice(C,N),ne={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)ne.t="z";else if(x.raw)ne.t="s",ne.v=K;else if(K.trim().length===0)ne.t="s",ne.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(ne.t="s",ne.v=K.slice(2,-1).replace(/""/g,'"')):zj(K)?(ne.t="n",ne.f=K.slice(1)):(ne.t="s",ne.v=K);else if(K=="TRUE")ne.t="b",ne.v=!0;else if(K=="FALSE")ne.t="b",ne.v=!1;else if(!isNaN(A=ua(K)))ne.t="n",x.cellText!==!1&&(ne.w=K),ne.v=A;else if(!isNaN(Pc(K).getDate())||L&&K.match(L)){ne.z=x.dateNF||sn[14];var xe=0;L&&K.match(L)&&(K=s6(K,x.dateNF,K.match(L)||[]),xe=1),x.cellDates?(ne.t="d",ne.v=oi(K,xe)):(ne.t="n",ne.v=_i(oi(K,xe))),x.cellText!==!1&&(ne.w=es(ne.z,ne.v instanceof Date?_i(ne.v):ne.v)),x.cellNF||delete ne.z}else ne.t="s",ne.v=K;if(ne.t=="z"||(x.dense?(_[T]||(_[T]=[]),_[T][w]=ne):_[Nt({c:w,r:T})]=ne),C=N+1,z=p.charCodeAt(C),b.e.c<w&&(b.e.c=w),b.e.r<T&&(b.e.r=T),D==E)++w;else if(w=0,++T,x.sheetRows&&x.sheetRows<=T)return!0}e:for(;N<p.length;++N)switch(D=p.charCodeAt(N)){case 34:z===34&&(I=!I);break;case E:case 10:case 13:if(!I&&H())break e;break}return N-C>0&&H(),_["!ref"]=gn(b),_}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):nl(e(p,v),v)}function u(p,v){var x="",S=v.type=="string"?[0,0,0,0]:tR(p,v);switch(v.type){case"base64":x=ha(p);break;case"binary":x=p;break;case"buffer":v.codepage==65001?x=p.toString("utf8"):v.codepage&&typeof Wd<"u"||(x=_t&&Buffer.isBuffer(p)?p.toString("binary"):Xc(p));break;case"array":x=pf(p);break;case"string":x=p;break;default:throw new Error("Unrecognized type "+v.type)}return S[0]==239&&S[1]==187&&S[2]==191?x=_c(x.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?x=_c(x):v.type=="binary"&&typeof Wd<"u",x.slice(0,19)=="socialcalc:version:"?e_.to_sheet(v.type=="string"?x:_c(x),v):l(x,v)}function f(p,v){return Vs(u(p,v),v)}function m(p){for(var v=[],x=Vt(p["!ref"]),S,_=Array.isArray(p),b=x.s.r;b<=x.e.r;++b){for(var T=[],w=x.s.c;w<=x.e.c;++w){var A=Nt({r:b,c:w});if(S=_?(p[b]||[])[w]:p[A],!S||S.v==null){T.push("          ");continue}for(var C=(S.w||(ma(S),S.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(w===0?" ":""))}v.push(T.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:m}}(),Ix=function(){function n(P,Y,V){if(P){Ii(P,P.l||0);for(var q=V.Enum||X;P.l<P.length;){var ae=P.read_shift(2),Re=q[ae]||q[65535],Ce=P.read_shift(2),Le=P.l+Ce,ke=Re.f&&Re.f(P,Ce,V);if(P.l=Le,Y(ke,Re,ae))return}}}function e(P,Y){switch(Y.type){case"base64":return t(pr(ha(P)),Y);case"binary":return t(pr(P),Y);case"buffer":case"array":return t(P,Y)}throw"Unsupported type "+Y.type}function t(P,Y){if(!P)return P;var V=Y||{},q=V.dense?[]:{},ae="Sheet1",Re="",Ce=0,Le={},ke=[],ct=[],et={s:{r:0,c:0},e:{r:0,c:0}},Ht=V.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)V.Enum=X,n(P,function(Me,wn,Mn){switch(Mn){case 0:V.vers=Me,Me>=4096&&(V.qpro=!0);break;case 6:et=Me;break;case 204:Me&&(Re=Me);break;case 222:Re=Me;break;case 15:case 51:V.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:Mn==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=V.dateNF||sn[14],V.cellDates&&(Me[1].t="d",Me[1].v=vS(Me[1].v))),V.qpro&&Me[3]>Ce&&(q["!ref"]=gn(et),Le[ae]=q,ke.push(ae),q=V.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ce=Me[3],ae=Re||"Sheet"+(Ce+1),Re="");var ei=V.dense?(q[Me[0].r]||[])[Me[0].c]:q[Nt(Me[0])];if(ei){ei.t=Me[1].t,ei.v=Me[1].v,Me[1].z!=null&&(ei.z=Me[1].z),Me[1].f!=null&&(ei.f=Me[1].f);break}V.dense?(q[Me[0].r]||(q[Me[0].r]=[]),q[Me[0].r][Me[0].c]=Me[1]):q[Nt(Me[0])]=Me[1];break}},V);else if(P[2]==26||P[2]==14)V.Enum=pe,P[2]==14&&(V.qpro=!0,P.l=0),n(P,function(Me,wn,Mn){switch(Mn){case 204:ae=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>Ce&&(q["!ref"]=gn(et),Le[ae]=q,ke.push(ae),q=V.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ce=Me[3],ae="Sheet"+(Ce+1)),Ht>0&&Me[0].r>=Ht)break;V.dense?(q[Me[0].r]||(q[Me[0].r]=[]),q[Me[0].r][Me[0].c]=Me[1]):q[Nt(Me[0])]=Me[1],et.e.c<Me[0].c&&(et.e.c=Me[0].c),et.e.r<Me[0].r&&(et.e.r=Me[0].r);break;case 27:Me[14e3]&&(ct[Me[14e3][0]]=Me[14e3][1]);break;case 1537:ct[Me[0]]=Me[1],Me[0]==Ce&&(ae=Me[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(q["!ref"]=gn(et),Le[Re||ae]=q,ke.push(Re||ae),!ct.length)return{SheetNames:ke,Sheets:Le};for(var rt={},Gn=[],gt=0;gt<ct.length;++gt)Le[ke[gt]]?(Gn.push(ct[gt]||ke[gt]),rt[ct[gt]]=Le[ct[gt]]||Le[ke[gt]]):(Gn.push(ct[gt]),rt[ct[gt]]={"!ref":"A1"});return{SheetNames:Gn,Sheets:rt}}function i(P,Y){var V=Y||{};if(+V.codepage>=0&&Lc(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var q=bi(),ae=Vt(P["!ref"]),Re=Array.isArray(P),Ce=[];De(q,0,o(1030)),De(q,6,f(ae));for(var Le=Math.min(ae.e.r,8191),ke=ae.s.r;ke<=Le;++ke)for(var ct=Wn(ke),et=ae.s.c;et<=ae.e.c;++et){ke===ae.s.r&&(Ce[et]=Zn(et));var Ht=Ce[et]+ct,rt=Re?(P[ke]||[])[et]:P[Ht];if(!(!rt||rt.t=="z"))if(rt.t=="n")(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?De(q,13,S(ke,et,rt.v)):De(q,14,b(ke,et,rt.v));else{var Gn=ma(rt);De(q,15,v(ke,et,Gn.slice(0,239)))}}return De(q,1),q.end()}function r(P,Y){var V=Y||{};if(+V.codepage>=0&&Lc(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var q=bi();De(q,0,l(P));for(var ae=0,Re=0;ae<P.SheetNames.length;++ae)(P.Sheets[P.SheetNames[ae]]||{})["!ref"]&&De(q,27,Be(P.SheetNames[ae],Re++));var Ce=0;for(ae=0;ae<P.SheetNames.length;++ae){var Le=P.Sheets[P.SheetNames[ae]];if(!(!Le||!Le["!ref"])){for(var ke=Vt(Le["!ref"]),ct=Array.isArray(Le),et=[],Ht=Math.min(ke.e.r,8191),rt=ke.s.r;rt<=Ht;++rt)for(var Gn=Wn(rt),gt=ke.s.c;gt<=ke.e.c;++gt){rt===ke.s.r&&(et[gt]=Zn(gt));var Me=et[gt]+Gn,wn=ct?(Le[rt]||[])[gt]:Le[Me];if(!(!wn||wn.t=="z"))if(wn.t=="n")De(q,23,H(rt,gt,Ce,wn.v));else{var Mn=ma(wn);De(q,22,D(rt,gt,Ce,Mn.slice(0,239)))}}++Ce}}return De(q,1),q.end()}function o(P){var Y=me(2);return Y.write_shift(2,P),Y}function l(P){var Y=me(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var V=0,q=0,ae=0,Re=0;Re<P.SheetNames.length;++Re){var Ce=P.SheetNames[Re],Le=P.Sheets[Ce];if(!(!Le||!Le["!ref"])){++ae;var ke=Fi(Le["!ref"]);V<ke.e.r&&(V=ke.e.r),q<ke.e.c&&(q=ke.e.c)}}return V>8191&&(V=8191),Y.write_shift(2,V),Y.write_shift(1,ae),Y.write_shift(1,q),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function u(P,Y,V){var q={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&V.qpro?(q.s.c=P.read_shift(1),P.l++,q.s.r=P.read_shift(2),q.e.c=P.read_shift(1),P.l++,q.e.r=P.read_shift(2),q):(q.s.c=P.read_shift(2),q.s.r=P.read_shift(2),Y==12&&V.qpro&&(P.l+=2),q.e.c=P.read_shift(2),q.e.r=P.read_shift(2),Y==12&&V.qpro&&(P.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function f(P){var Y=me(8);return Y.write_shift(2,P.s.c),Y.write_shift(2,P.s.r),Y.write_shift(2,P.e.c),Y.write_shift(2,P.e.r),Y}function m(P,Y,V){var q=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(q[0].c=P.read_shift(1),q[3]=P.read_shift(1),q[0].r=P.read_shift(2),P.l+=2):(q[2]=P.read_shift(1),q[0].c=P.read_shift(2),q[0].r=P.read_shift(2)),q}function p(P,Y,V){var q=P.l+Y,ae=m(P,Y,V);if(ae[1].t="s",V.vers==20768){P.l++;var Re=P.read_shift(1);return ae[1].v=P.read_shift(Re,"utf8"),ae}return V.qpro&&P.l++,ae[1].v=P.read_shift(q-P.l,"cstr"),ae}function v(P,Y,V){var q=me(7+V.length);q.write_shift(1,255),q.write_shift(2,Y),q.write_shift(2,P),q.write_shift(1,39);for(var ae=0;ae<q.length;++ae){var Re=V.charCodeAt(ae);q.write_shift(1,Re>=128?95:Re)}return q.write_shift(1,0),q}function x(P,Y,V){var q=m(P,Y,V);return q[1].v=P.read_shift(2,"i"),q}function S(P,Y,V){var q=me(7);return q.write_shift(1,255),q.write_shift(2,Y),q.write_shift(2,P),q.write_shift(2,V,"i"),q}function _(P,Y,V){var q=m(P,Y,V);return q[1].v=P.read_shift(8,"f"),q}function b(P,Y,V){var q=me(13);return q.write_shift(1,255),q.write_shift(2,Y),q.write_shift(2,P),q.write_shift(8,V,"f"),q}function T(P,Y,V){var q=P.l+Y,ae=m(P,Y,V);if(ae[1].v=P.read_shift(8,"f"),V.qpro)P.l=q;else{var Re=P.read_shift(2);N(P.slice(P.l,P.l+Re),ae),P.l+=Re}return ae}function w(P,Y,V){var q=Y&32768;return Y&=-32769,Y=(q?P:0)+(Y>=8192?Y-16384:Y),(q?"":"$")+(V?Zn(Y):Wn(Y))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(P,Y){Ii(P,0);for(var V=[],q=0,ae="",Re="",Ce="",Le="";P.l<P.length;){var ke=P[P.l++];switch(ke){case 0:V.push(P.read_shift(8,"f"));break;case 1:Re=w(Y[0].c,P.read_shift(2),!0),ae=w(Y[0].r,P.read_shift(2),!1),V.push(Re+ae);break;case 2:{var ct=w(Y[0].c,P.read_shift(2),!0),et=w(Y[0].r,P.read_shift(2),!1);Re=w(Y[0].c,P.read_shift(2),!0),ae=w(Y[0].r,P.read_shift(2),!1),V.push(ct+et+":"+Re+ae)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(P.read_shift(2));break;case 6:{for(var Ht="";ke=P[P.l++];)Ht+=String.fromCharCode(ke);V.push('"'+Ht.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Le=V.pop(),Ce=V.pop(),V.push(["AND","OR"][ke-20]+"("+Ce+","+Le+")");break;default:if(ke<32&&C[ke])Le=V.pop(),Ce=V.pop(),V.push(Ce+C[ke]+Le);else if(A[ke]){if(q=A[ke][1],q==69&&(q=P[P.l++]),q>V.length){console.error("WK1 bad formula parse 0x"+ke.toString(16)+":|"+V.join("|")+"|");return}var rt=V.slice(-q);V.length-=q,V.push(A[ke][0]+"("+rt.join(",")+")")}else return ke<=7?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=24?console.error("WK1 unsupported op "+ke.toString(16)):ke<=30?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=115?console.error("WK1 unsupported function opcode "+ke.toString(16)):console.error("WK1 unrecognized opcode "+ke.toString(16))}}V.length==1?Y[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function E(P){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=P.read_shift(2),Y[3]=P[P.l++],Y[0].c=P[P.l++],Y}function I(P,Y){var V=E(P);return V[1].t="s",V[1].v=P.read_shift(Y-4,"cstr"),V}function D(P,Y,V,q){var ae=me(6+q.length);ae.write_shift(2,P),ae.write_shift(1,V),ae.write_shift(1,Y),ae.write_shift(1,39);for(var Re=0;Re<q.length;++Re){var Ce=q.charCodeAt(Re);ae.write_shift(1,Ce>=128?95:Ce)}return ae.write_shift(1,0),ae}function z(P,Y){var V=E(P);V[1].v=P.read_shift(2);var q=V[1].v>>1;if(V[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return V[1].v=q,V}function L(P,Y){var V=E(P),q=P.read_shift(4),ae=P.read_shift(4),Re=P.read_shift(2);if(Re==65535)return q===0&&ae===3221225472?(V[1].t="e",V[1].v=15):q===0&&ae===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var Ce=Re&32768;return Re=(Re&32767)-16446,V[1].v=(1-Ce*2)*(ae*Math.pow(2,Re+32)+q*Math.pow(2,Re)),V}function H(P,Y,V,q){var ae=me(14);if(ae.write_shift(2,P),ae.write_shift(1,V),ae.write_shift(1,Y),q==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var Re=0,Ce=0,Le=0,ke=0;return q<0&&(Re=1,q=-q),Ce=Math.log2(q)|0,q/=Math.pow(2,Ce-31),ke=q>>>0,(ke&2147483648)==0&&(q/=2,++Ce,ke=q>>>0),q-=ke,ke|=2147483648,ke>>>=0,q*=Math.pow(2,32),Le=q>>>0,ae.write_shift(4,Le),ae.write_shift(4,ke),Ce+=16383+(Re?32768:0),ae.write_shift(2,Ce),ae}function K(P,Y){var V=L(P);return P.l+=Y-14,V}function ne(P,Y){var V=E(P),q=P.read_shift(4);return V[1].v=q>>6,V}function xe(P,Y){var V=E(P),q=P.read_shift(8,"f");return V[1].v=q,V}function He(P,Y){var V=xe(P);return P.l+=Y-10,V}function _e(P,Y){return P[P.l+Y-1]==0?P.read_shift(Y,"cstr"):""}function ie(P,Y){var V=P[P.l++];V>Y-1&&(V=Y-1);for(var q="";q.length<V;)q+=String.fromCharCode(P[P.l++]);return q}function he(P,Y,V){if(!(!V.qpro||Y<21)){var q=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var ae=P.read_shift(Y-21,"cstr");return[q,ae]}}function Ne(P,Y){for(var V={},q=P.l+Y;P.l<q;){var ae=P.read_shift(2);if(ae==14e3){for(V[ae]=[0,""],V[ae][0]=P.read_shift(2);P[P.l];)V[ae][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return V}function Be(P,Y){var V=me(5+P.length);V.write_shift(2,14e3),V.write_shift(2,Y);for(var q=0;q<P.length;++q){var ae=P.charCodeAt(q);V[V.l++]=ae>127?95:ae}return V[V.l++]=0,V}var X={0:{n:"BOF",f:qS},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ne},38:{n:"??"},39:{n:"NUMBER27",f:xe},40:{n:"FORMULA28",f:He},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:r,to_workbook:e}}(),VC=/^\s|\s$|[\t\n\r]/;function t_(n,e){if(!e.bookSST)return"";var t=[vn];t[t.length]=je("sst",null,{xmlns:tl[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var r=n[i],o="<si>";r.r?o+=r.r:(o+="<t",r.t||(r.t=""),r.t.match(VC)&&(o+=' xml:space="preserve"'),o+=">"+Dt(r.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function GC(n){return[n.read_shift(4),n.read_shift(4)]}function YC(n,e){return e||(e=me(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var XC=P6;function $C(n){var e=bi();be(e,159,YC(n));for(var t=0;t<n.length;++t)be(e,19,XC(n[t]));return be(e,160),e.end()}function qC(n){for(var e=[],t=n.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function n_(n){var e=0,t,i=qC(n),r=i.length+1,o,l,u,f,m;for(t=zs(r),t[0]=i.length,o=1;o!=r;++o)t[o]=i[o-1];for(o=r-1;o>=0;--o)l=t[o],u=(e&16384)===0?0:1,f=e<<1&32767,m=u|f,e=m^l;return e^52811}var KC=function(){function n(r,o){switch(o.type){case"base64":return e(ha(r),o);case"binary":return e(r,o);case"buffer":return e(_t&&Buffer.isBuffer(r)?r.toString("binary"):Xc(r),o);case"array":return e(pf(r),o)}throw new Error("Unrecognized type "+o.type)}function e(r,o){var l=o||{},u=l.dense?[]:{},f=r.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var x=/\\\w+\b/g,S=0,_,b=-1;_=x.exec(p);){switch(_[0]){case"\\cell":var T=p.slice(S,x.lastIndex-_[0].length);if(T[0]==" "&&(T=T.slice(1)),++b,T.length){var w={v:T,t:"s"};Array.isArray(u)?u[v][b]=w:u[Nt({r:v,c:b})]=w}break}S=x.lastIndex}b>m.e.c&&(m.e.c=b)}),u["!ref"]=gn(m),u}function t(r,o){return Vs(n(r,o),o)}function i(r){for(var o=["{\\rtf1\\ansi"],l=Vt(r["!ref"]),u,f=Array.isArray(r),m=l.s.r;m<=l.e.r;++m){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=Nt({r:m,c:p});u=f?(r[m]||[])[p]:r[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(ma(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:i}}();function Px(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var ZC=6,da=ZC;function Qd(n){return Math.floor((n+Math.round(128/da)/256)*da)}function Jd(n){return Math.floor((n-5)/da*100+.5)/100}function ap(n){return Math.round((n*da+5)/da*256)/256}function $p(n){n.width?(n.wpx=Qd(n.width),n.wch=Jd(n.wpx),n.MDW=da):n.wpx?(n.wch=Jd(n.wpx),n.width=ap(n.wch),n.MDW=da):typeof n.wch=="number"&&(n.width=ap(n.wch),n.wpx=Qd(n.width),n.MDW=da),n.customWidth&&delete n.customWidth}var QC=96,i_=QC;function ef(n){return n*96/i_}function r_(n){return n*i_/96}function JC(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)n[i]!=null&&(e[e.length]=je("numFmt",null,{numFmtId:i,formatCode:Dt(n[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=je("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function ej(n){var e=[];return e[e.length]=je("cellXfs",null),n.forEach(function(t){e[e.length]=je("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=je("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function a_(n,e){var t=[vn,je("styleSheet",null,{xmlns:tl[0],"xmlns:vt":Dn.vt})],i;return n.SSF&&(i=JC(n.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=ej(e.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function tj(n,e){var t=n.read_shift(2),i=Qn(n);return[t,i]}function nj(n,e,t){t||(t=me(6+4*e.length)),t.write_shift(2,n),On(e,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function ij(n,e,t){var i={};i.sz=n.read_shift(2)/20;var r=V6(n);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var o=n.read_shift(2);switch(o===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var l=n.read_shift(1);l!=0&&(i.underline=l);var u=n.read_shift(1);u>0&&(i.family=u);var f=n.read_shift(1);switch(f>0&&(i.charset=f),n.l++,i.color=W6(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Qn(n),i}function rj(n,e){e||(e=me(25+4*32)),e.write_shift(2,n.sz*20),G6(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Kd(n.color,e);var i=0;return i=2,e.write_shift(1,i),On(n.name,e),e.length>e.l?e.slice(0,e.l):e}var aj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Um,sj=Pr;function Bx(n,e){e||(e=me(4*3+8*7+16*1)),Um||(Um=Ip(aj));var t=Um[n.patternType];t==null&&(t=40),e.write_shift(4,t);var i=0;if(t!=40)for(Kd({auto:1},e),Kd({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function oj(n,e){var t=n.l+e,i=n.read_shift(2),r=n.read_shift(2);return n.l=t,{ixfe:i,numFmtId:r}}function s_(n,e,t){t||(t=me(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function dc(n,e){return e||(e=me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var lj=Pr;function cj(n,e){return e||(e=me(51)),e.write_shift(1,0),dc(null,e),dc(null,e),dc(null,e),dc(null,e),dc(null,e),e.length>e.l?e.slice(0,e.l):e}function uj(n,e){return e||(e=me(12+4*10)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),qd(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function dj(n,e,t){var i=me(2052);return i.write_shift(4,n),qd(e,i),qd(t,i),i.length>i.l?i.slice(0,i.l):i}function fj(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&++t}),t!=0&&(be(n,615,vr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&be(n,44,nj(r,e[r]))}),be(n,616))}}function hj(n){var e=1;be(n,611,vr(e)),be(n,43,rj({sz:12,color:{theme:1},name:"Calibri",family:2})),be(n,612)}function mj(n){var e=2;be(n,603,vr(e)),be(n,45,Bx({patternType:"none"})),be(n,45,Bx({patternType:"gray125"})),be(n,604)}function pj(n){var e=1;be(n,613,vr(e)),be(n,46,cj()),be(n,614)}function gj(n){var e=1;be(n,626,vr(e)),be(n,47,s_({numFmtId:0},65535)),be(n,627)}function vj(n,e){be(n,617,vr(e.length)),e.forEach(function(t){be(n,47,s_(t,0))}),be(n,618)}function yj(n){var e=1;be(n,619,vr(e)),be(n,48,uj({xfId:0,name:"Normal"})),be(n,620)}function xj(n){var e=0;be(n,505,vr(e)),be(n,506)}function bj(n){var e=0;be(n,508,dj(e,"TableStyleMedium9","PivotStyleMedium4")),be(n,509)}function Sj(n,e){var t=bi();return be(t,278),fj(t,n.SSF),hj(t),mj(t),pj(t),gj(t),vj(t,e.cellXfs),yj(t),xj(t),bj(t),be(t,279),t.end()}function o_(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[vn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function _j(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:Qn(n)}}function Tj(n){var e=me(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),On(n.name,e),e.slice(0,e.l)}function wj(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function Ej(n){var e=me(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function Aj(n,e){var t=me(8+2*e.length);return t.write_shift(4,n),On(e,t),t.slice(0,t.l)}function kj(n){return n.l+=4,n.read_shift(4)!=0}function Cj(n,e){var t=me(8);return t.write_shift(4,n),t.write_shift(4,1),t}function jj(){var n=bi();return be(n,332),be(n,334,vr(1)),be(n,335,Tj({name:"XLDAPR",version:12e4,flags:3496657072})),be(n,336),be(n,339,Aj(1,"XLDAPR")),be(n,52),be(n,35,vr(514)),be(n,4096,vr(0)),be(n,4097,er(1)),be(n,36),be(n,53),be(n,340),be(n,337,Cj(1)),be(n,51,Ej([[1,0]])),be(n,338),be(n,333),n.end()}function l_(){var n=[vn];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function Dj(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Nt(t);var i=n.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}var Uo=1024;function c_(n,e){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),r=[je("xml",null,{"xmlns:v":Pi.v,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:mv":Pi.mv}).replace(/\/>/,">"),je("o:shapelayout",je("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),je("v:shapetype",[je("v:stroke",null,{joinstyle:"miter"}),je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Uo<n*1e3;)Uo+=1e3;return e.forEach(function(o){var l=Nn(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=je("v:fill",f,u),p={on:"t",obscured:"t"};++Uo,r=r.concat(["<v:shape"+Fc({id:"_x0000_s"+Uo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,je("v:shadow",null,p),je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Hn("x:AutoFill","False"),Hn("x:Row",String(l.r)),Hn("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function u_(n){var e=[vn,je("comments",null,{xmlns:tl[0]})],t=[];return e.push("<authors>"),n.forEach(function(i){i[1].forEach(function(r){var o=Dt(r.a);t.indexOf(o)==-1&&(t.push(o),e.push("<author>"+o+"</author>")),r.T&&r.ID&&t.indexOf("tc="+r.ID)==-1&&(t.push("tc="+r.ID),e.push("<author>tc="+r.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(i){var r=0,o=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?r=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(f){f.a&&(r=t.indexOf(Dt(f.a))),o.push(f.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>'),o.length<=1)e.push(Hn("t",Dt(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;e.push(Hn("t",Dt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Nj(n,e,t){var i=[vn,je("ThreadedComments",null,{xmlns:Dn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(r){var o="";(r[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};u==0?o=f.id:f.parentId=o,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),i.push(je("threadedComment",Hn("text",l.t||""),f))})}),i.push("</ThreadedComments>"),i.join("")}function Oj(n){var e=[vn,je("personList",null,{xmlns:Dn.TCMNT,"xmlns:x":tl[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,i){e.push(je("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Mj(n){var e={};e.iauthor=n.read_shift(4);var t=$s(n);return e.rfx=t.s,e.ref=Nt(t.s),n.l+=16,e}function Rj(n,e){return e==null&&(e=me(36)),e.write_shift(4,n[1].iauthor),il(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Lj=Qn;function Ij(n){return On(n.slice(0,54))}function Pj(n){var e=bi(),t=[];return be(e,628),be(e,630),n.forEach(function(i){i[1].forEach(function(r){t.indexOf(r.a)>-1||(t.push(r.a.slice(0,54)),be(e,632,Ij(r.a)))})}),be(e,631),be(e,633),n.forEach(function(i){i[1].forEach(function(r){r.iauthor=t.indexOf(r.a);var o={s:Nn(i[0]),e:Nn(i[0])};be(e,635,Rj([o,r])),r.t&&r.t.length>0&&be(e,637,F6(r)),be(e,636),delete r.iauthor})}),be(e,634),be(e,629),e.end()}function Bj(n,e){e.FullPaths.forEach(function(t,i){if(i!=0){var r=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Pt.utils.cfb_add(n,r,e.FileIndex[i].content)}})}var d_=["xlsb","xlsm","xlam","biff8","xla"],Fj=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,r,o,l){var u=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=e.c:--p,f?m+=e.r:--m,r+(u?"":"$")+Zn(p)+(f?"":"$")+Wn(m)}return function(r,o){return e=o,r.replace(n,t)}}(),qp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Kp=function(){return function(e,t){return e.replace(qp,function(i,r,o,l,u,f){var m=Wp(l)-(o?0:t.c),p=Hp(f)-(u?0:t.r),v=p==0?"":u?p+1:"["+p+"]",x=m==0?"":o?m+1:"["+m+"]";return r+"R"+v+"C"+x})}}();function Uj(n,e){return n.replace(qp,function(t,i,r,o,l,u){return i+(r=="$"?r+o:Zn(Wp(o)+e.c))+(l=="$"?l+u:Wn(Hp(u)+e.r))})}function zj(n){return n.length!=1}function pn(n){n.l+=1}function ts(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function f_(n,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return h_(n);t.biff==12&&(i=4)}var r=n.read_shift(i),o=n.read_shift(i),l=ts(n),u=ts(n);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function h_(n){var e=ts(n),t=ts(n),i=n.read_shift(1),r=n.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:r,cRel:t[1],rRel:t[2]}}}function Hj(n,e,t){if(t.biff<8)return h_(n);var i=n.read_shift(t.biff==12?4:2),r=n.read_shift(t.biff==12?4:2),o=ts(n),l=ts(n);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r,c:l[0],cRel:l[1],rRel:l[2]}}}function m_(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return Wj(n);var i=n.read_shift(t&&t.biff==12?4:2),r=ts(n);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function Wj(n){var e=ts(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Vj(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Gj(n,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return Yj(n);var r=n.read_shift(i>=12?4:2),o=n.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;r>524287;)r-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r,c:o,cRel:l,rRel:u}}function Yj(n){var e=n.read_shift(2),t=n.read_shift(1),i=(e&32768)>>15,r=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),r==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:r,rRel:i}}function Xj(n,e,t){var i=(n[n.l++]&96)>>5,r=f_(n,t.biff>=2&&t.biff<=5?6:8,t);return[i,r]}function $j(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:n.l+=12,o=6;break;case 12:o=12;break}var l=f_(n,o,t);return[i,r,l]}function qj(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function Kj(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),o=8;if(t)switch(t.biff){case 5:n.l+=12,o=6;break;case 12:o=12;break}return n.l+=o,[i,r]}function Zj(n,e,t){var i=(n[n.l++]&96)>>5,r=Hj(n,e-1,t);return[i,r]}function Qj(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[i]}function Fx(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function Jj(n,e,t){n.l+=2;for(var i=n.read_shift(t&&t.biff==2?1:2),r=[],o=0;o<=i;++o)r.push(n.read_shift(t&&t.biff==2?1:2));return r}function eD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function tD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function nD(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function iD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[i]}function p_(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function rD(n){return n.read_shift(2),p_(n)}function aD(n){return n.read_shift(2),p_(n)}function sD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=m_(n,0,t);return[i,r]}function oD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=Gj(n,0,t);return[i,r]}function lD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var o=m_(n,0,t);return[i,r,o]}function cD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(t&&t.biff<=3?1:2);return[cN[r],y_[r],i]}function uD(n,e,t){var i=n[n.l++],r=n.read_shift(1),o=t&&t.biff<=3?[i==88?-1:0,n.read_shift(1)]:dD(n);return[r,(o[0]===0?y_:lN)[o[1]]]}function dD(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function fD(n,e,t){n.l+=t&&t.biff==2?3:4}function hD(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function mD(n){return n.l++,Kc[n.read_shift(1)]}function pD(n){return n.l++,n.read_shift(2)}function gD(n){return n.l++,n.read_shift(1)!==0}function vD(n){return n.l++,rl(n)}function yD(n,e,t){return n.l++,ZS(n,e-1,t)}function xD(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=lC(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=Kc[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=rl(n);break;case 2:t[1]=fC(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function bD(n,e,t){for(var i=n.read_shift(t.biff==12?4:2),r=[],o=0;o!=i;++o)r.push((t.biff==12?$s:pC)(n));return r}function SD(n,e,t){var i=0,r=0;t.biff==12?(i=n.read_shift(4),r=n.read_shift(4)):(r=1+n.read_shift(1),i=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--r==0&&(r=256));for(var o=0,l=[];o!=i&&(l[o]=[]);++o)for(var u=0;u!=r;++u)l[o][u]=xD(n,t.biff);return l}function _D(n,e,t){var i=n.read_shift(1)>>>5&3,r=!t||t.biff>=8?4:2,o=n.read_shift(r);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,o]}function TD(n,e,t){if(t.biff==5)return wD(n);var i=n.read_shift(1)>>>5&3,r=n.read_shift(2),o=n.read_shift(4);return[i,r,o]}function wD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[e,t,i]}function ED(n,e,t){var i=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function AD(n,e,t){var i=n.read_shift(1)>>>5&3,r=n.read_shift(t&&t.biff==2?1:2);return[i,r]}function kD(n,e,t){var i=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[i]}function CD(n,e,t){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return n.l+=o,[i,r]}var jD=Pr,DD=Pr,ND=Pr;function Zc(n,e,t){return n.l+=2,[Vj(n)]}function Zp(n){return n.l+=6,[]}var OD=Zc,MD=Zp,RD=Zp,LD=Zc;function g_(n){return n.l+=2,[qS(n),n.read_shift(2)&1]}var ID=Zc,PD=g_,BD=Zp,FD=Zc,UD=Zc,zD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function HD(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(4),r=n.read_shift(2),o=n.read_shift(2),l=zD[t>>2&31];return{ixti:e,coltype:t&3,rt:l,idx:i,c:r,C:o}}function WD(n){return n.l+=2,[n.read_shift(4)]}function VD(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function GD(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function YD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function XD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function $D(n){return n.l+=4,[0,0]}var Ux={1:{n:"PtgExp",f:hD},2:{n:"PtgTbl",f:ND},3:{n:"PtgAdd",f:pn},4:{n:"PtgSub",f:pn},5:{n:"PtgMul",f:pn},6:{n:"PtgDiv",f:pn},7:{n:"PtgPower",f:pn},8:{n:"PtgConcat",f:pn},9:{n:"PtgLt",f:pn},10:{n:"PtgLe",f:pn},11:{n:"PtgEq",f:pn},12:{n:"PtgGe",f:pn},13:{n:"PtgGt",f:pn},14:{n:"PtgNe",f:pn},15:{n:"PtgIsect",f:pn},16:{n:"PtgUnion",f:pn},17:{n:"PtgRange",f:pn},18:{n:"PtgUplus",f:pn},19:{n:"PtgUminus",f:pn},20:{n:"PtgPercent",f:pn},21:{n:"PtgParen",f:pn},22:{n:"PtgMissArg",f:pn},23:{n:"PtgStr",f:yD},26:{n:"PtgSheet",f:VD},27:{n:"PtgEndSheet",f:GD},28:{n:"PtgErr",f:mD},29:{n:"PtgBool",f:gD},30:{n:"PtgInt",f:pD},31:{n:"PtgNum",f:vD},32:{n:"PtgArray",f:Qj},33:{n:"PtgFunc",f:cD},34:{n:"PtgFuncVar",f:uD},35:{n:"PtgName",f:_D},36:{n:"PtgRef",f:sD},37:{n:"PtgArea",f:Xj},38:{n:"PtgMemArea",f:ED},39:{n:"PtgMemErr",f:jD},40:{n:"PtgMemNoMem",f:DD},41:{n:"PtgMemFunc",f:AD},42:{n:"PtgRefErr",f:kD},43:{n:"PtgAreaErr",f:qj},44:{n:"PtgRefN",f:oD},45:{n:"PtgAreaN",f:Zj},46:{n:"PtgMemAreaN",f:YD},47:{n:"PtgMemNoMemN",f:XD},57:{n:"PtgNameX",f:TD},58:{n:"PtgRef3d",f:lD},59:{n:"PtgArea3d",f:$j},60:{n:"PtgRefErr3d",f:CD},61:{n:"PtgAreaErr3d",f:Kj},255:{}},qD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},KD={1:{n:"PtgElfLel",f:g_},2:{n:"PtgElfRw",f:FD},3:{n:"PtgElfCol",f:OD},6:{n:"PtgElfRwV",f:UD},7:{n:"PtgElfColV",f:LD},10:{n:"PtgElfRadical",f:ID},11:{n:"PtgElfRadicalS",f:BD},13:{n:"PtgElfColS",f:MD},15:{n:"PtgElfColSV",f:RD},16:{n:"PtgElfRadicalLel",f:PD},25:{n:"PtgList",f:HD},29:{n:"PtgSxName",f:WD},255:{}},ZD={0:{n:"PtgAttrNoop",f:$D},1:{n:"PtgAttrSemi",f:iD},2:{n:"PtgAttrIf",f:tD},4:{n:"PtgAttrChoose",f:Jj},8:{n:"PtgAttrGoto",f:eD},16:{n:"PtgAttrSum",f:fD},32:{n:"PtgAttrBaxcel",f:Fx},33:{n:"PtgAttrBaxcel",f:Fx},64:{n:"PtgAttrSpace",f:rD},65:{n:"PtgAttrSpaceSemi",f:aD},128:{n:"PtgAttrIfError",f:nD},255:{}};function QD(n,e,t,i){if(i.biff<8)return Pr(n,e);for(var r=n.l+e,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=SD(n,0,i),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=bD(n,t[l][1],i),o.push(t[l][2]);break;case"PtgExp":i&&i.biff==12&&(t[l][1][1]=n.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return e=r-n.l,e!==0&&o.push(Pr(n,e)),o}function JD(n,e,t){for(var i=n.l+e,r,o,l=[];i!=n.l;)e=i-n.l,o=n[n.l],r=Ux[o]||Ux[qD[o]],(o===24||o===25)&&(r=(o===24?KD:ZD)[n[n.l+1]]),!r||!r.f?Pr(n,e):l.push([r.n,r.f(n,e,t)]);return l}function eN(n){for(var e=[],t=0;t<n.length;++t){for(var i=n[t],r=[],o=0;o<i.length;++o){var l=i[o];if(l)switch(l[0]){case 2:r.push('"'+l[1].replace(/"/g,'""')+'"');break;default:r.push(l[1])}else r.push("")}e.push(r.join(","))}return e.join(";")}var tN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nN(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function v_(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!i)return"SH33TJSERR1";var r="";if(t.biff>8)switch(n[i[0]][0]){case 357:return r=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[i[0]][0];case 355:default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return n[i[0]][0][3]?(r=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function zx(n,e,t){var i=v_(n,e,t);return i=="#REF"?i:nN(i,t)}function qo(n,e,t,i,r){var o=r&&r.biff||8,l={s:{c:0,r:0}},u=[],f,m,p,v=0,x=0,S,_="";if(!n[0]||!n[0][0])return"";for(var b=-1,T="",w=0,A=n[0].length;w<A;++w){var C=n[0][w];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),m=u.pop(),b>=0){switch(n[0][b][1][0]){case 0:T=rn(" ",n[0][b][1][1]);break;case 1:T=rn("\r",n[0][b][1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][b][1][0])}m=m+T,b=-1}u.push(m+tN[C[0]]+f);break;case"PtgIsect":f=u.pop(),m=u.pop(),u.push(m+" "+f);break;case"PtgUnion":f=u.pop(),m=u.pop(),u.push(m+","+f);break;case"PtgRange":f=u.pop(),m=u.pop(),u.push(m+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=wc(C[1][1],l,r),u.push(Ec(p,o));break;case"PtgRefN":p=t?wc(C[1][1],t,r):C[1][1],u.push(Ec(p,o));break;case"PtgRef3d":v=C[1][1],p=wc(C[1][2],l,r),_=zx(i,v,r),u.push(_+"!"+Ec(p,o));break;case"PtgFunc":case"PtgFuncVar":var N=C[1][0],E=C[1][1];N||(N=0),N&=127;var I=N==0?[]:u.slice(-N);u.length-=N,E==="User"&&(E=I.shift()),u.push(E+"("+I.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":S=Ex(C[1][1],t?{s:t}:l,r),u.push(Bm(S,r));break;case"PtgArea":S=Ex(C[1][1],l,r),u.push(Bm(S,r));break;case"PtgArea3d":v=C[1][1],S=C[1][2],_=zx(i,v,r),u.push(_+"!"+Bm(S,r));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=C[1][2];var D=(i.names||[])[x-1]||(i[0]||[])[x],z=D?D.Name:"SH33TJSNAME"+String(x);z&&z.slice(0,6)=="_xlfn."&&!r.xlfn&&(z=z.slice(6)),u.push(z);break;case"PtgNameX":var L=C[1][1];x=C[1][2];var H;if(r.biff<=5)L<0&&(L=-L),i[L]&&(H=i[L][x]);else{var K="";if(((i[L]||[])[0]||[])[0]==14849||(((i[L]||[])[0]||[])[0]==1025?i[L][x]&&i[L][x].itab>0&&(K=i.SheetNames[i[L][x].itab-1]+"!"):K=i.SheetNames[x-1]+"!"),i[L]&&i[L][x])K+=i[L][x].Name;else if(i[0]&&i[0][x])K+=i[0][x].Name;else{var ne=(v_(i,L,r)||"").split(";;");ne[x-1]?K=ne[x-1]:K+="SH33TJSERRX"}u.push(K);break}H||(H={Name:"SH33TJSERRY"}),u.push(H.Name);break;case"PtgParen":var xe="(",He=")";if(b>=0){switch(T="",n[0][b][1][0]){case 2:xe=rn(" ",n[0][b][1][1])+xe;break;case 3:xe=rn("\r",n[0][b][1][1])+xe;break;case 4:He=rn(" ",n[0][b][1][1])+He;break;case 5:He=rn("\r",n[0][b][1][1])+He;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][b][1][0])}b=-1}u.push(xe+u.pop()+He);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var _e={c:t.c,r:t.r};if(i.sharedf[Nt(p)]){var ie=i.sharedf[Nt(p)];u.push(qo(ie,l,_e,i,r))}else{var he=!1;for(f=0;f!=i.arrayf.length;++f)if(m=i.arrayf[f],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(qo(m[1],l,_e,i,r)),he=!0;break}he||u.push(C[1])}break;case"PtgArray":u.push("{"+eN(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&b>=0&&Ne.indexOf(n[0][w][0])==-1){C=n[0][b];var Be=!0;switch(C[1][0]){case 4:Be=!1;case 0:T=rn(" ",C[1][1]);break;case 5:Be=!1;case 1:T=rn("\r",C[1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((Be?T:"")+u.pop()+(Be?"":T)),b=-1}}if(u.length>1&&r.WTF)throw new Error("bad formula stack");return u[0]}function iN(n){if(n==null){var e=me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Hs(n);return Hs(0)}function rN(n,e,t,i,r){var o=Ws(e,t,r),l=iN(n.v),u=me(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var m=me(n.bf.length),p=0;p<n.bf.length;++p)m[p]=n.bf[p];var v=zn([o,l,u,m]);return v}function gf(n,e,t){var i=n.read_shift(4),r=JD(n,i,t),o=n.read_shift(4),l=o>0?QD(n,o,r,t):null;return[r,l]}var aN=gf,vf=gf,sN=gf,oN=gf,lN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},y_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uN(n){var e="of:="+n.replace(qp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function dN(n){return n.replace(/\./,"!")}var Ac=typeof Map<"u";function Qp(n,e,t){var i=0,r=n.length;if(t){if(Ac?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var o=Ac?t.get(e):t[e];i<o.length;++i)if(n[o[i]].t===e)return n.Count++,o[i]}}else for(;i<r;++i)if(n[i].t===e)return n.Count++,i;return n[r]={t:e},n.Count++,n.Unique++,t&&(Ac?(t.has(e)||t.set(e,[]),t.get(e).push(r)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(r))),r}function yf(n,e){var t={min:n+1,max:n+1},i=-1;return e.MDW&&(da=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?i=Jd(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(t.width=ap(i),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function x_(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function rs(n,e,t){var i=t.revssf[e.z!=null?e.z:"General"],r=60,o=n.length;if(i==null&&t.ssf){for(;r<392;++r)if(t.ssf[r]==null){mS(e.z,r),t.ssf[r]=e.z,t.revssf[e.z]=i=r;break}}for(r=0;r!=o;++r)if(n[r].numFmtId===i)return r;return n[o]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function fN(n,e,t){if(n&&n["!ref"]){var i=Vt(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function hN(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+gn(n[t])+'"/>';return e+"</mergeCells>"}function mN(n,e,t,i,r){var o=!1,l={},u=null;if(i.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[t];try{e.Workbook&&(f=e.Workbook.Sheets[t].CodeName||f)}catch{}o=!0,l.codeName=Bc(Dt(f))}if(n&&n["!outline"]){var m={summaryBelow:1,summaryRight:1};n["!outline"].above&&(m.summaryBelow=0),n["!outline"].left&&(m.summaryRight=0),u=(u||"")+je("outlinePr",null,m)}!o&&!u||(r[r.length]=je("sheetPr",u,l))}var pN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gN=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vN(n){var e={sheet:1};return pN.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),gN.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=n_(n.password).toString(16).toUpperCase()),je("sheetProtection",null,e)}function yN(n){return x_(n),je("pageMargins",null,n)}function xN(n,e){for(var t=["<cols>"],i,r=0;r!=e.length;++r)(i=e[r])&&(t[t.length]=je("col",null,yf(r,i)));return t[t.length]="</cols>",t.join("")}function bN(n,e,t,i){var r=typeof n.ref=="string"?n.ref:gn(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=Fi(r);l.s.r==l.e.r&&(l.e.r=Fi(e["!ref"]).e.r,r=gn(l));for(var u=0;u<o.length;++u){var f=o[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref="'"+t.SheetNames[i]+"'!"+r;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+r}),je("autoFilter",null,{ref:r})}function SN(n,e,t,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),je("sheetViews",je("sheetView",null,r),{})}function _N(n,e,t,i){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var r="",o=n.t,l=n.v;if(n.t!=="z")switch(n.t){case"b":r=n.v?"1":"0";break;case"n":r=""+n.v;break;case"e":r=Kc[n.v];break;case"d":i&&i.cellDates?r=oi(n.v,-1).toISOString():(n=Ti(n),n.t="n",r=""+(n.v=_i(oi(n.v)))),typeof n.z>"u"&&(n.z=sn[14]);break;default:r=n.v;break}var u=Hn("v",Dt(r)),f={r:e},m=rs(i.cellXfs,n,i);switch(m!==0&&(f.s=m),n.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){u=Hn("v",""+Qp(i.Strings,n.v,i.revStrings)),f.t="s";break}f.t="str";break}if(n.t!=o&&(n.t=o,n.v=l),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;u=je("f",Dt(n.f),p)+(n.v!=null?u:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(f.cm=1),je("c",u,f)}function TN(n,e,t,i){var r=[],o=[],l=Vt(n["!ref"]),u="",f,m="",p=[],v=0,x=0,S=n["!rows"],_=Array.isArray(n),b={r:m},T,w=-1;for(x=l.s.c;x<=l.e.c;++x)p[x]=Zn(x);for(v=l.s.r;v<=l.e.r;++v){for(o=[],m=Wn(v),x=l.s.c;x<=l.e.c;++x){f=p[x]+m;var A=_?(n[v]||[])[x]:n[f];A!==void 0&&(u=_N(A,f,n,e))!=null&&o.push(u)}(o.length>0||S&&S[v])&&(b={r:m},S&&S[v]&&(T=S[v],T.hidden&&(b.hidden=1),w=-1,T.hpx?w=ef(T.hpx):T.hpt&&(w=T.hpt),w>-1&&(b.ht=w,b.customHeight=1),T.level&&(b.outlineLevel=T.level)),r[r.length]=je("row",o.join(""),b))}if(S)for(;v<S.length;++v)S&&S[v]&&(b={r:v+1},T=S[v],T.hidden&&(b.hidden=1),w=-1,T.hpx?w=ef(T.hpx):T.hpt&&(w=T.hpt),w>-1&&(b.ht=w,b.customHeight=1),T.level&&(b.outlineLevel=T.level),r[r.length]=je("row","",b));return r.join("")}function b_(n,e,t,i){var r=[vn,je("worksheet",null,{xmlns:tl[0],"xmlns:r":Dn.r})],o=t.SheetNames[n],l=0,u="",f=t.Sheets[o];f==null&&(f={});var m=f["!ref"]||"A1",p=Vt(m);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),m=gn(p)}i||(i={}),f["!comments"]=[];var v=[];mN(f,t,n,e,r),r[r.length]=je("dimension",null,{ref:m}),r[r.length]=SN(f,e,n,t),e.sheetFormat&&(r[r.length]=je("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(r[r.length]=xN(f,f["!cols"])),r[l=r.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=TN(f,e),u.length>0&&(r[r.length]=u)),r.length>l+1&&(r[r.length]="</sheetData>",r[l]=r[l].replace("/>",">")),f["!protect"]&&(r[r.length]=vN(f["!protect"])),f["!autofilter"]!=null&&(r[r.length]=bN(f["!autofilter"],f,t,n)),f["!merges"]!=null&&f["!merges"].length>0&&(r[r.length]=hN(f["!merges"]));var x=-1,S,_=-1;return f["!links"].length>0&&(r[r.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(S={ref:b[0]},b[1].Target.charAt(0)!="#"&&(_=Ct(i,-1,Dt(b[1].Target).replace(/#.*$/,""),bt.HLINK),S["r:id"]="rId"+_),(x=b[1].Target.indexOf("#"))>-1&&(S.location=Dt(b[1].Target.slice(x+1))),b[1].Tooltip&&(S.tooltip=Dt(b[1].Tooltip)),r[r.length]=je("hyperlink",null,S))}),r[r.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(r[r.length]=yN(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(r[r.length]=Hn("ignoredErrors",je("ignoredError",null,{numberStoredAsText:1,sqref:m}))),v.length>0&&(_=Ct(i,-1,"../drawings/drawing"+(n+1)+".xml",bt.DRAW),r[r.length]=je("drawing",null,{"r:id":"rId"+_}),f["!drawing"]=v),f["!comments"].length>0&&(_=Ct(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",bt.VML),r[r.length]=je("legacyDrawing",null,{"r:id":"rId"+_}),f["!legacy"]=_),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function wN(n,e){var t={},i=n.l+e;t.r=n.read_shift(4),n.l+=4;var r=n.read_shift(2);n.l+=1;var o=n.read_shift(1);return n.l=i,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=r/20),t}function EN(n,e,t){var i=me(145),r=(t["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var o=320;r.hpx?o=ef(r.hpx)*20:r.hpt&&(o=r.hpt*20),i.write_shift(2,o),i.write_shift(1,0);var l=0;r.level&&(l|=r.level),r.hidden&&(l|=16),(r.hpx||r.hpt)&&(l|=32),i.write_shift(1,l),i.write_shift(1,0);var u=0,f=i.l;i.l+=4;for(var m={r:n,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,x=-1,S=p<<10;S<p+1<<10;++S){m.c=S;var _=Array.isArray(t)?(t[m.r]||[])[m.c]:t[Nt(m)];_&&(v<0&&(v=S),x=S)}v<0||(++u,i.write_shift(4,v),i.write_shift(4,x))}var b=i.l;return i.l=f,i.write_shift(4,u),i.l=b,i.length>i.l?i.slice(0,i.l):i}function AN(n,e,t,i){var r=EN(i,t,e);(r.length>17||(e["!rows"]||[])[i])&&be(n,0,r)}var kN=$s,CN=il;function jN(){}function DN(n,e){var t={},i=n[n.l];return++n.l,t.above=!(i&64),t.left=!(i&128),n.l+=18,t.name=U6(n),t}function NN(n,e,t){t==null&&(t=me(84+4*n.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),t.write_shift(1,i);for(var r=1;r<3;++r)t.write_shift(1,0);return Kd({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),LS(n,t),t.slice(0,t.l)}function ON(n){var e=rr(n);return[e]}function MN(n,e,t){return t==null&&(t=me(8)),Gs(e,t)}function RN(n){var e=Ys(n);return[e]}function LN(n,e,t){return t==null&&(t=me(4)),Xs(e,t)}function IN(n){var e=rr(n),t=n.read_shift(1);return[e,t,"b"]}function PN(n,e,t){return t==null&&(t=me(9)),Gs(e,t),t.write_shift(1,n.v?1:0),t}function BN(n){var e=Ys(n),t=n.read_shift(1);return[e,t,"b"]}function FN(n,e,t){return t==null&&(t=me(5)),Xs(e,t),t.write_shift(1,n.v?1:0),t}function UN(n){var e=rr(n),t=n.read_shift(1);return[e,t,"e"]}function zN(n,e,t){return t==null&&(t=me(9)),Gs(e,t),t.write_shift(1,n.v),t}function HN(n){var e=Ys(n),t=n.read_shift(1);return[e,t,"e"]}function WN(n,e,t){return t==null&&(t=me(8)),Xs(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function VN(n){var e=rr(n),t=n.read_shift(4);return[e,t,"s"]}function GN(n,e,t){return t==null&&(t=me(12)),Gs(e,t),t.write_shift(4,e.v),t}function YN(n){var e=Ys(n),t=n.read_shift(4);return[e,t,"s"]}function XN(n,e,t){return t==null&&(t=me(8)),Xs(e,t),t.write_shift(4,e.v),t}function $N(n){var e=rr(n),t=rl(n);return[e,t,"n"]}function qN(n,e,t){return t==null&&(t=me(16)),Gs(e,t),Hs(n.v,t),t}function KN(n){var e=Ys(n),t=rl(n);return[e,t,"n"]}function ZN(n,e,t){return t==null&&(t=me(12)),Xs(e,t),Hs(n.v,t),t}function QN(n){var e=rr(n),t=IS(n);return[e,t,"n"]}function JN(n,e,t){return t==null&&(t=me(12)),Gs(e,t),PS(n.v,t),t}function eO(n){var e=Ys(n),t=IS(n);return[e,t,"n"]}function tO(n,e,t){return t==null&&(t=me(8)),Xs(e,t),PS(n.v,t),t}function nO(n){var e=rr(n),t=Vp(n);return[e,t,"is"]}function iO(n){var e=rr(n),t=Qn(n);return[e,t,"str"]}function rO(n,e,t){return t==null&&(t=me(12+4*n.v.length)),Gs(e,t),On(n.v,t),t.length>t.l?t.slice(0,t.l):t}function aO(n){var e=Ys(n),t=Qn(n);return[e,t,"str"]}function sO(n,e,t){return t==null&&(t=me(8+4*n.v.length)),Xs(e,t),On(n.v,t),t.length>t.l?t.slice(0,t.l):t}function oO(n,e,t){var i=n.l+e,r=rr(n);r.r=t["!row"];var o=n.read_shift(1),l=[r,o,"b"];if(t.cellFormula){n.l+=2;var u=vf(n,i-n.l,t);l[3]=qo(u,null,r,t.supbooks,t)}else n.l=i;return l}function lO(n,e,t){var i=n.l+e,r=rr(n);r.r=t["!row"];var o=n.read_shift(1),l=[r,o,"e"];if(t.cellFormula){n.l+=2;var u=vf(n,i-n.l,t);l[3]=qo(u,null,r,t.supbooks,t)}else n.l=i;return l}function cO(n,e,t){var i=n.l+e,r=rr(n);r.r=t["!row"];var o=rl(n),l=[r,o,"n"];if(t.cellFormula){n.l+=2;var u=vf(n,i-n.l,t);l[3]=qo(u,null,r,t.supbooks,t)}else n.l=i;return l}function uO(n,e,t){var i=n.l+e,r=rr(n);r.r=t["!row"];var o=Qn(n),l=[r,o,"str"];if(t.cellFormula){n.l+=2;var u=vf(n,i-n.l,t);l[3]=qo(u,null,r,t.supbooks,t)}else n.l=i;return l}var dO=$s,fO=il;function hO(n,e){return e==null&&(e=me(4)),e.write_shift(4,n),e}function mO(n,e){var t=n.l+e,i=$s(n),r=Gp(n),o=Qn(n),l=Qn(n),u=Qn(n);n.l=t;var f={rfx:i,relId:r,loc:o,display:u};return l&&(f.Tooltip=l),f}function pO(n,e){var t=me(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));il({s:Nn(n[0]),e:Nn(n[0])},t),Yp("rId"+e,t);var i=n[1].Target.indexOf("#"),r=i==-1?"":n[1].Target.slice(i+1);return On(r||"",t),On(n[1].Tooltip||"",t),On("",t),t.slice(0,t.l)}function gO(){}function vO(n,e,t){var i=n.l+e,r=BS(n),o=n.read_shift(1),l=[r];if(l[2]=o,t.cellFormula){var u=aN(n,i-n.l,t);l[1]=u}else n.l=i;return l}function yO(n,e,t){var i=n.l+e,r=$s(n),o=[r];if(t.cellFormula){var l=oN(n,i-n.l,t);o[1]=l,n.l=i}else n.l=i;return o}function xO(n,e,t){t==null&&(t=me(18));var i=yf(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var r=0;return e.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),e.level&&(r|=e.level<<8),t.write_shift(2,r),t}var S_=["left","right","top","bottom","header","footer"];function bO(n){var e={};return S_.forEach(function(t){e[t]=rl(n)}),e}function SO(n,e){return e==null&&(e=me(6*8)),x_(n),S_.forEach(function(t){Hs(n[t],e)}),e}function _O(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function TO(n,e,t){t==null&&(t=me(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function wO(n){var e=me(24);return e.write_shift(4,4),e.write_shift(4,1),il(n,e),e}function EO(n,e){return e==null&&(e=me(16*4+2)),e.write_shift(2,n.password?n_(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function AO(){}function kO(){}function CO(n,e,t,i,r,o,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=Ti(e),e.z=e.z||sn[14],e.v=_i(oi(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r:t,c:i};switch(f.s=rs(r.cellXfs,e,r),e.l&&o["!links"].push([Nt(f),e.l]),e.c&&o["!comments"].push([Nt(f),e.c]),e.t){case"s":case"str":return r.bookSST?(u=Qp(r.Strings,e.v,r.revStrings),f.t="s",f.v=u,l?be(n,18,XN(e,f)):be(n,7,GN(e,f))):(f.t="str",l?be(n,17,sO(e,f)):be(n,6,rO(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?be(n,13,tO(e,f)):be(n,2,JN(e,f)):l?be(n,16,ZN(e,f)):be(n,5,qN(e,f)),!0;case"b":return f.t="b",l?be(n,15,FN(e,f)):be(n,4,PN(e,f)),!0;case"e":return f.t="e",l?be(n,14,WN(e,f)):be(n,3,zN(e,f)),!0}return l?be(n,12,LN(e,f)):be(n,1,MN(e,f)),!0}function jO(n,e,t,i){var r=Vt(e["!ref"]||"A1"),o,l="",u=[];be(n,145);var f=Array.isArray(e),m=r.e.r;e["!rows"]&&(m=Math.max(r.e.r,e["!rows"].length-1));for(var p=r.s.r;p<=m;++p){l=Wn(p),AN(n,e,r,p);var v=!1;if(p<=r.e.r)for(var x=r.s.c;x<=r.e.c;++x){p===r.s.r&&(u[x]=Zn(x)),o=u[x]+l;var S=f?(e[p]||[])[x]:e[o];if(!S){v=!1;continue}v=CO(n,S,p,x,i,e,v)}}be(n,146)}function DO(n,e){!e||!e["!merges"]||(be(n,177,hO(e["!merges"].length)),e["!merges"].forEach(function(t){be(n,176,fO(t))}),be(n,178))}function NO(n,e){!e||!e["!cols"]||(be(n,390),e["!cols"].forEach(function(t,i){t&&be(n,60,xO(i,t))}),be(n,391))}function OO(n,e){!e||!e["!ref"]||(be(n,648),be(n,649,wO(Vt(e["!ref"]))),be(n,650))}function MO(n,e,t){e["!links"].forEach(function(i){if(i[1].Target){var r=Ct(t,-1,i[1].Target.replace(/#.*$/,""),bt.HLINK);be(n,494,pO(i,r))}}),delete e["!links"]}function RO(n,e,t,i){if(e["!comments"].length>0){var r=Ct(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",bt.VML);be(n,551,Yp("rId"+r)),e["!legacy"]=r}}function LO(n,e,t,i){if(e["!autofilter"]){var r=e["!autofilter"],o=typeof r.ref=="string"?r.ref:gn(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,u=Fi(o);u.s.r==u.e.r&&(u.e.r=Fi(e["!ref"]).e.r,o=gn(u));for(var f=0;f<l.length;++f){var m=l[f];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==i){m.Ref="'"+t.SheetNames[i]+"'!"+o;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+o}),be(n,161,il(Vt(o))),be(n,162)}}function IO(n,e,t){be(n,133),be(n,137,TO(e,t)),be(n,138),be(n,134)}function PO(n,e){e["!protect"]&&be(n,535,EO(e["!protect"]))}function BO(n,e,t,i){var r=bi(),o=t.SheetNames[n],l=t.Sheets[o]||{},u=o;try{t&&t.Workbook&&(u=t.Workbook.Sheets[n].CodeName||u)}catch{}var f=Vt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],be(r,129),(t.vbaraw||l["!outline"])&&be(r,147,NN(u,l["!outline"])),be(r,148,CN(f)),IO(r,l,t.Workbook),NO(r,l),jO(r,l,n,e),PO(r,l),LO(r,l,t,n),DO(r,l),MO(r,l,i),l["!margins"]&&be(r,476,SO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&OO(r,l),RO(r,l,n,i),be(r,130),r.end()}function FO(n,e){n.l+=10;var t=Qn(n);return{name:t}}var UO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function zO(n){return!n.Workbook||!n.Workbook.WBProps?"false":y6(n.Workbook.WBProps.date1904)?"true":"false"}var HO="][*?/\\".split("");function __(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return HO.forEach(function(i){if(n.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function WO(n,e,t){n.forEach(function(i,r){__(i);for(var o=0;o<r;++o)if(i==n[o])throw new Error("Duplicate Sheet Name: "+i);if(t){var l=e&&e[r]&&e[r].CodeName||i;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function VO(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];WO(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)fN(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function T_(n){var e=[vn];e[e.length]=je("workbook",null,{xmlns:tl[0],"xmlns:r":Dn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(UO.forEach(function(u){n.Workbook.WBProps[u[0]]!=null&&n.Workbook.WBProps[u[0]]!=u[1]&&(i[u[0]]=n.Workbook.WBProps[u[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=je("workbookPr",null,i);var r=n.Workbook&&n.Workbook.Sheets||[],o=0;if(r&&r[0]&&r[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=n.SheetNames.length&&!(!r[o]||!r[o].Hidden);++o);o==n.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=n.SheetNames.length;++o){var l={name:Dt(n.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),r[o])switch(r[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=je("sheet",null,l)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=je("definedName",Dt(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function GO(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=rp(n),t.name=Qn(n),t}function YO(n,e){return e||(e=me(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),Yp(n.strRelID,e),On(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function XO(n,e){var t={},i=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var r=e>8?Qn(n):"";return r.length>0&&(t.CodeName=r),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function $O(n,e){e||(e=me(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),LS(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function qO(n,e,t){var i=n.l+e;n.l+=4,n.l+=1;var r=n.read_shift(4),o=z6(n),l=sN(n,0,t),u=Gp(n);n.l=i;var f={Name:o,Ptg:l};return r<268435455&&(f.Sheet=r),u&&(f.Comment=u),f}function KO(n,e){be(n,143);for(var t=0;t!=e.SheetNames.length;++t){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,r={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};be(n,156,YO(r))}be(n,144)}function ZO(n,e){e||(e=me(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return On("SheetJS",e),On(Hd.version,e),On(Hd.version,e),On("7262",e),e.length>e.l?e.slice(0,e.l):e}function QO(n,e){e||(e=me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function JO(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,i=0,r=-1,o=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&r==-1?r=i:t[i].Hidden==1&&o==-1&&(o=i);o>r||(be(n,135),be(n,158,QO(r)),be(n,136))}}function eM(n,e){var t=bi();return be(t,131),be(t,128,ZO()),be(t,153,$O(n.Workbook&&n.Workbook.WBProps||null)),JO(t,n),KO(t,n),be(t,132),t.end()}function tM(n,e,t){return(e.slice(-4)===".bin"?eM:T_)(n)}function nM(n,e,t,i,r){return(e.slice(-4)===".bin"?BO:b_)(n,t,i,r)}function iM(n,e,t){return(e.slice(-4)===".bin"?Sj:a_)(n,t)}function rM(n,e,t){return(e.slice(-4)===".bin"?$C:t_)(n,t)}function aM(n,e,t){return(e.slice(-4)===".bin"?Pj:u_)(n)}function sM(n){return(n.slice(-4)===".bin"?jj:l_)()}function oM(n,e){var t=[];return n.Props&&t.push(iC(n.Props,e)),n.Custprops&&t.push(rC(n.Props,n.Custprops)),t.join("")}function lM(){return""}function cM(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,r){var o=[];o.push(je("NumberFormat",null,{"ss:Format":Dt(sn[i.numFmtId])}));var l={"ss:ID":"s"+(21+r)};t.push(je("Style",o.join(""),l))}),je("Styles",t.join(""))}function w_(n){return je("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Kp(n.Ref,{r:0,c:0})})}function uM(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],i=0;i<e.length;++i){var r=e[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||t.push(w_(r)))}return je("Names",t.join(""))}function dM(n,e,t,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,o=[],l=0;l<r.length;++l){var u=r[l];u.Sheet==t&&(u.Name.match(/^_xlfn\./)||o.push(w_(u)))}return o.join("")}function fM(n,e,t,i){if(!n)return"";var r=[];if(n["!margins"]&&(r.push("<PageSetup>"),n["!margins"].header&&r.push(je("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&r.push(je("Footer",null,{"x:Margin":n["!margins"].footer})),r.push(je("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)r.push(je("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(i.Workbook.Sheets[o]&&!i.Workbook.Sheets[o].Hidden);++o);o==t&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),n["!protect"]&&(r.push(Hn("ProtectContents","True")),n["!protect"].objects&&r.push(Hn("ProtectObjects","True")),n["!protect"].scenarios&&r.push(Hn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?r.push(Hn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&r.push(Hn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){n["!protect"][l[0]]&&r.push("<"+l[1]+"/>")})),r.length==0?"":je("WorksheetOptions",r.join(""),{xmlns:Pi.x})}function hM(n){return n.map(function(e){var t=v6(e.t||""),i=je("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return je("Comment",i,{"ss:Author":e.a})}).join("")}function mM(n,e,t,i,r,o,l){if(!n||n.v==null&&n.f==null)return"";var u={};if(n.f&&(u["ss:Formula"]="="+Dt(Kp(n.f,l))),n.F&&n.F.slice(0,e.length)==e){var f=Nn(n.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(n.l&&n.l.Target&&(u["ss:HRef"]=Dt(n.l.Target),n.l.Tooltip&&(u["x:HRefScreenTip"]=Dt(n.l.Tooltip))),t["!merges"])for(var m=t["!merges"],p=0;p!=m.length;++p)m[p].s.c!=l.c||m[p].s.r!=l.r||(m[p].e.c>m[p].s.c&&(u["ss:MergeAcross"]=m[p].e.c-m[p].s.c),m[p].e.r>m[p].s.r&&(u["ss:MergeDown"]=m[p].e.r-m[p].s.r));var v="",x="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":v="Number",x=String(n.v);break;case"b":v="Boolean",x=n.v?"1":"0";break;case"e":v="Error",x=Kc[n.v];break;case"d":v="DateTime",x=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||sn[14]);break;case"s":v="String",x=g6(n.v||"");break}var S=rs(i.cellXfs,n,i);u["ss:StyleID"]="s"+(21+S),u["ss:Index"]=l.c+1;var _=n.v!=null?x:"",b=n.t=="z"?"":'<Data ss:Type="'+v+'">'+_+"</Data>";return(n.c||[]).length>0&&(b+=hM(n.c)),je("Cell",b,u)}function pM(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=r_(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function gM(n,e,t,i){if(!n["!ref"])return"";var r=Vt(n["!ref"]),o=n["!merges"]||[],l=0,u=[];n["!cols"]&&n["!cols"].forEach(function(T,w){$p(T);var A=!!T.width,C=yf(w,T),N={"ss:Index":w+1};A&&(N["ss:Width"]=Qd(C.width)),T.hidden&&(N["ss:Hidden"]="1"),u.push(je("Column",null,N))});for(var f=Array.isArray(n),m=r.s.r;m<=r.e.r;++m){for(var p=[pM(m,(n["!rows"]||[])[m])],v=r.s.c;v<=r.e.c;++v){var x=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>m)&&!(o[l].e.c<v)&&!(o[l].e.r<m)){(o[l].s.c!=v||o[l].s.r!=m)&&(x=!0);break}if(!x){var S={r:m,c:v},_=Nt(S),b=f?(n[m]||[])[v]:n[_];p.push(mM(b,_,n,e,t,i,S))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function vM(n,e,t){var i=[],r=t.SheetNames[n],o=t.Sheets[r],l=o?dM(o,e,n,t):"";return l.length>0&&i.push("<Names>"+l+"</Names>"),l=o?gM(o,e,n,t):"",l.length>0&&i.push("<Table>"+l+"</Table>"),i.push(fM(o,e,n,t)),i.join("")}function yM(n,e){e||(e={}),n.SSF||(n.SSF=Ti(sn)),n.SSF&&(hf(),ff(n.SSF),e.revssf=mf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],rs(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(oM(n,e)),t.push(lM()),t.push(""),t.push("");for(var i=0;i<n.SheetNames.length;++i)t.push(je("Worksheet",vM(i,e,n),{"ss:Name":Dt(n.SheetNames[i])}));return t[2]=cM(n,e),t[3]=uM(n),vn+je("Workbook",t.join(""),{xmlns:Pi.ss,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:ss":Pi.ss,"xmlns:dt":Pi.dt,"xmlns:html":Pi.html})}var zm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xM(n,e){var t=[],i=[],r=[],o=0,l,u=mx(kx,"n"),f=mx(Cx,"n");if(n.Props)for(l=Vn(n.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?t:Object.prototype.hasOwnProperty.call(f,l[o])?i:r).push([l[o],n.Props[l[o]]]);if(n.Custprops)for(l=Vn(n.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(n.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?t:Object.prototype.hasOwnProperty.call(f,l[o])?i:r).push([l[o],n.Custprops[l[o]]]);var m=[];for(o=0;o<r.length;++o)$S.indexOf(r[o][0])>-1||GS.indexOf(r[o][0])>-1||r[o][1]!=null&&m.push(r[o]);i.length&&Pt.utils.cfb_add(e,"/SummaryInformation",Mx(i,zm.SI,f,Cx)),(t.length||m.length)&&Pt.utils.cfb_add(e,"/DocumentSummaryInformation",Mx(t,zm.DSI,u,kx,m.length?m:null,zm.UDI))}function bM(n,e){var t=e||{},i=Pt.utils.cfb_new({root:"R"}),r="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":r="/Workbook",t.biff=8;break;case"biff5":r="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Pt.utils.cfb_add(i,r,E_(n,t)),t.biff==8&&(n.Props||n.Custprops)&&xM(n,i),t.biff==8&&n.vbaraw&&Bj(i,Pt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var SM={0:{f:wN},1:{f:ON},2:{f:QN},3:{f:UN},4:{f:IN},5:{f:$N},6:{f:iO},7:{f:VN},8:{f:uO},9:{f:cO},10:{f:oO},11:{f:lO},12:{f:RN},13:{f:eO},14:{f:HN},15:{f:BN},16:{f:KN},17:{f:aO},18:{f:YN},19:{f:Vp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qO},40:{},42:{},43:{f:ij},44:{f:tj},45:{f:sj},46:{f:lj},47:{f:oj},48:{},49:{f:R6},50:{},51:{f:wj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:LC},62:{f:nO},63:{f:Dj},64:{f:AO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_O},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DN},148:{f:kN,p:16},151:{f:gO},152:{},153:{f:XO},154:{},155:{},156:{f:GO},157:{},158:{},159:{T:1,f:GC},160:{T:-1},161:{T:1,f:$s},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_j},336:{T:-1},337:{f:kj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:rp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vO},427:{f:yO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:mO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:rp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Lj},633:{T:1},634:{T:-1},635:{T:1,f:Mj},636:{T:-1},637:{f:B6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function De(n,e,t,i){var r=e;if(!isNaN(r)){var o=i||(t||[]).length||0,l=n.next(4);l.write_shift(2,r),l.write_shift(2,o),o>0&&zp(t)&&n.push(t)}}function _M(n,e,t,i){var r=(t||[]).length||0;if(r<=8224)return De(n,e,t,r);var o=e;if(!isNaN(o)){for(var l=t.parts||[],u=0,f=0,m=0;m+(l[u]||8224)<=8224;)m+=l[u]||8224,u++;var p=n.next(4);for(p.write_shift(2,o),p.write_shift(2,m),n.push(t.slice(f,f+m)),f+=m;f<r;){for(p=n.next(4),p.write_shift(2,60),m=0;m+(l[u]||8224)<=8224;)m+=l[u]||8224,u++;p.write_shift(2,m),n.push(t.slice(f,f+m)),f+=m}}}function Qc(n,e,t){return n||(n=me(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function TM(n,e,t,i){var r=me(9);return Qc(r,n,e),KS(t,i||"b",r),r}function wM(n,e,t){var i=me(8+2*t.length);return Qc(i,n,e),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function EM(n,e,t,i){if(e.v!=null)switch(e.t){case"d":case"n":var r=e.t=="d"?_i(oi(e.v)):e.v;r==(r|0)&&r>=0&&r<65536?De(n,2,FC(t,i,r)):De(n,3,BC(t,i,r));return;case"b":case"e":De(n,5,TM(t,i,e.v,e.t));return;case"s":case"str":De(n,4,wM(t,i,(e.v||"").slice(0,255)));return}De(n,1,Qc(null,t,i))}function AM(n,e,t,i){var r=Array.isArray(e),o=Vt(e["!ref"]||"A1"),l,u="",f=[];if(o.e.c>255||o.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=gn(o)}for(var m=o.s.r;m<=o.e.r;++m){u=Wn(m);for(var p=o.s.c;p<=o.e.c;++p){m===o.s.r&&(f[p]=Zn(p)),l=f[p]+u;var v=r?(e[m]||[])[p]:e[l];v&&EM(n,v,m,p)}}}function kM(n,e){for(var t=e||{},i=bi(),r=0,o=0;o<n.SheetNames.length;++o)n.SheetNames[o]==t.sheet&&(r=o);if(r==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return De(i,t.biff==4?1033:t.biff==3?521:9,Xp(n,16,t)),AM(i,n.Sheets[n.SheetNames[r]],r,t),De(i,10),i.end()}function CM(n,e,t){De(n,49,SC({sz:12,name:"Arial"},t))}function jM(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)e[r]!=null&&De(n,1054,wC(r,e[r],t))})}function DM(n,e){var t=me(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),De(n,2151,t),t=me(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),JS(Vt(e["!ref"]||"A1"),t),t.write_shift(4,4),De(n,2152,t)}function NM(n,e){for(var t=0;t<16;++t)De(n,224,Lx({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){De(n,224,Lx(i,0,e))})}function OM(n,e){for(var t=0;t<e["!links"].length;++t){var i=e["!links"][t];De(n,440,OC(i)),i[1].Tooltip&&De(n,2048,MC(i))}delete e["!links"]}function MM(n,e){if(e){var t=0;e.forEach(function(i,r){++t<=256&&i&&De(n,125,IC(yf(r,i),r))})}}function RM(n,e,t,i,r){var o=16+rs(r.cellXfs,e,r);if(e.v==null&&!e.bf){De(n,513,Ws(t,i,o));return}if(e.bf)De(n,6,rN(e,t,i,r,o));else switch(e.t){case"d":case"n":var l=e.t=="d"?_i(oi(e.v)):e.v;De(n,515,CC(t,i,l,o));break;case"b":case"e":De(n,517,kC(t,i,e.v,o,r,e.t));break;case"s":case"str":if(r.bookSST){var u=Qp(r.Strings,e.v,r.revStrings);De(n,253,_C(t,i,u,o))}else De(n,516,TC(t,i,(e.v||"").slice(0,255),o,r));break;default:De(n,513,Ws(t,i,o))}}function LM(n,e,t){var i=bi(),r=t.SheetNames[n],o=t.Sheets[r]||{},l=(t||{}).Workbook||{},u=(l.Sheets||[])[n]||{},f=Array.isArray(o),m=e.biff==8,p,v="",x=[],S=Vt(o["!ref"]||"A1"),_=m?65536:16384;if(S.e.c>255||S.e.r>=_){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,_-1)}De(i,2057,Xp(t,16,e)),De(i,13,er(1)),De(i,12,er(100)),De(i,15,si(!0)),De(i,17,si(!1)),De(i,16,Hs(.001)),De(i,95,si(!0)),De(i,42,si(!1)),De(i,43,si(!1)),De(i,130,er(1)),De(i,128,AC()),De(i,131,si(!1)),De(i,132,si(!1)),m&&MM(i,o["!cols"]),De(i,512,EC(S,e)),m&&(o["!links"]=[]);for(var b=S.s.r;b<=S.e.r;++b){v=Wn(b);for(var T=S.s.c;T<=S.e.c;++T){b===S.s.r&&(x[T]=Zn(T)),p=x[T]+v;var w=f?(o[b]||[])[T]:o[p];w&&(RM(i,w,b,T,e),m&&w.l&&o["!links"].push([p,w.l]))}}var A=u.CodeName||u.name||r;return m&&De(i,574,bC((l.Views||[])[0])),m&&(o["!merges"]||[]).length&&De(i,229,NC(o["!merges"])),m&&OM(i,o),De(i,442,QS(A)),m&&DM(i,o),De(i,10),i.end()}function IM(n,e,t){var i=bi(),r=(n||{}).Workbook||{},o=r.Sheets||[],l=r.WBProps||{},u=t.biff==8,f=t.biff==5;if(De(i,2057,Xp(n,5,t)),t.bookType=="xla"&&De(i,135),De(i,225,u?er(1200):null),De(i,193,oC(2)),f&&De(i,191),f&&De(i,192),De(i,226),De(i,92,gC("SheetJS",t)),De(i,66,er(u?1200:1252)),u&&De(i,353,er(0)),u&&De(i,448),De(i,317,PC(n.SheetNames.length)),u&&n.vbaraw&&De(i,211),u&&n.vbaraw){var m=l.CodeName||"ThisWorkbook";De(i,442,QS(m))}De(i,156,er(17)),De(i,25,si(!1)),De(i,18,si(!1)),De(i,19,er(0)),u&&De(i,431,si(!1)),u&&De(i,444,er(0)),De(i,61,xC()),De(i,64,si(!1)),De(i,141,er(0)),De(i,34,si(zO(n)=="true")),De(i,14,si(!0)),u&&De(i,439,si(!1)),De(i,218,er(0)),CM(i,n,t),jM(i,n.SSF,t),NM(i,t),u&&De(i,352,si(!1));var p=i.end(),v=bi();u&&De(v,140,RC()),u&&t.Strings&&_M(v,252,yC(t.Strings)),De(v,10);var x=v.end(),S=bi(),_=0,b=0;for(b=0;b<n.SheetNames.length;++b)_+=(u?12:11)+(u?2:1)*n.SheetNames[b].length;var T=p.length+_+x.length;for(b=0;b<n.SheetNames.length;++b){var w=o[b]||{};De(S,133,vC({pos:T,hs:w.Hidden||0,dt:0,name:n.SheetNames[b]},t)),T+=e[b].length}var A=S.end();if(_!=A.length)throw new Error("BS8 "+_+" != "+A.length);var C=[];return p.length&&C.push(p),A.length&&C.push(A),x.length&&C.push(x),zn(C)}function PM(n,e){var t=e||{},i=[];n&&!n.SSF&&(n.SSF=Ti(sn)),n&&n.SSF&&(hf(),ff(n.SSF),t.revssf=mf(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Jp(t),t.cellXfs=[],rs(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var r=0;r<n.SheetNames.length;++r)i[i.length]=LM(r,t,n);return i.unshift(IM(n,i,t)),zn(i)}function E_(n,e){for(var t=0;t<=n.SheetNames.length;++t){var i=n.Sheets[n.SheetNames[t]];if(!(!i||!i["!ref"])){var r=Fi(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return PM(n,e);case 4:case 3:case 2:return kM(n,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function BM(n,e,t,i){for(var r=n["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,m=0;m<r.length;++m)if(!(r[m].s.r>t||r[m].s.c>l)&&!(r[m].e.r<t||r[m].e.c<l)){if(r[m].s.r<t||r[m].s.c<l){u=-1;break}u=r[m].e.r-r[m].s.r+1,f=r[m].e.c-r[m].s.c+1;break}if(!(u<0)){var p=Nt({r:t,c:l}),v=i.dense?(n[t]||[])[l]:n[p],x=v&&v.v!=null&&(v.h||p6(v.w||(ma(v),v.w)||""))||"",S={};u>1&&(S.rowspan=u),f>1&&(S.colspan=f),i.editable?x='<span contenteditable="true">'+x+"</span>":v&&(S["data-t"]=v&&v.t||"z",v.v!=null&&(S["data-v"]=v.v),v.z!=null&&(S["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+v.l.Target+'">'+x+"</a>")),S.id=(i.id||"sjs")+"-"+p,o.push(je("td",x,S))}}var _="<tr>";return _+o.join("")+"</tr>"}var FM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',UM="</body></html>";function zM(n,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function A_(n,e){var t=e||{},i=t.header!=null?t.header:FM,r=t.footer!=null?t.footer:UM,o=[i],l=Fi(n["!ref"]);t.dense=Array.isArray(n),o.push(zM(n,l,t));for(var u=l.s.r;u<=l.e.r;++u)o.push(BM(n,l,u,t));return o.push("</table>"+r),o.join("")}function k_(n,e,t){var i=t||{},r=0,o=0;if(i.origin!=null)if(typeof i.origin=="number")r=i.origin;else{var l=typeof i.origin=="string"?Nn(i.origin):i.origin;r=l.r,o=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(i.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r,c:o}};if(n["!ref"]){var p=Fi(n["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),r==-1&&(m.e.r=r=p.e.r+1)}var v=[],x=0,S=n["!rows"]||(n["!rows"]=[]),_=0,b=0,T=0,w=0,A=0,C=0;for(n["!cols"]||(n["!cols"]=[]);_<u.length&&b<f;++_){var N=u[_];if(Hx(N)){if(i.display)continue;S[b]={hidden:!0}}var E=N.children;for(T=w=0;T<E.length;++T){var I=E[T];if(!(i.display&&Hx(I))){var D=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):x6(I.innerHTML),z=I.getAttribute("data-z")||I.getAttribute("z");for(x=0;x<v.length;++x){var L=v[x];L.s.c==w+o&&L.s.r<b+r&&b+r<=L.e.r&&(w=L.e.c+1-o,x=-1)}C=+I.getAttribute("colspan")||1,((A=+I.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:b+r,c:w+o},e:{r:b+r+(A||1)-1,c:w+o+(C||1)-1}});var H={t:"s",v:D},K=I.getAttribute("data-t")||I.getAttribute("t")||"";D!=null&&(D.length==0?H.t=K||"z":i.raw||D.trim().length==0||K=="s"||(D==="TRUE"?H={t:"b",v:!0}:D==="FALSE"?H={t:"b",v:!1}:isNaN(ua(D))?isNaN(Pc(D).getDate())||(H={t:"d",v:oi(D)},i.cellDates||(H={t:"n",v:_i(H.v)}),H.z=i.dateNF||sn[14]):H={t:"n",v:ua(D)})),H.z===void 0&&z!=null&&(H.z=z);var ne="",xe=I.getElementsByTagName("A");if(xe&&xe.length)for(var He=0;He<xe.length&&!(xe[He].hasAttribute("href")&&(ne=xe[He].getAttribute("href"),ne.charAt(0)!="#"));++He);ne&&ne.charAt(0)!="#"&&(H.l={Target:ne}),i.dense?(n[b+r]||(n[b+r]=[]),n[b+r][w+o]=H):n[Nt({c:w+o,r:b+r})]=H,m.e.c<w+o&&(m.e.c=w+o),w+=C}}++b}return v.length&&(n["!merges"]=(n["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,b-1+r),n["!ref"]=gn(m),b>=f&&(n["!fullref"]=gn((m.e.r=u.length-_+b-1+r,m))),n}function C_(n,e){var t=e||{},i=t.dense?[]:{};return k_(i,n,e)}function HM(n,e){return Vs(C_(n,e),e)}function Hx(n){var e="",t=WM(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function WM(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var VM=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Fc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return vn+e}}(),Wx=function(){var n=function(o){return Dt(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(o,l,u){var f=[];f.push('      <table:table table:name="'+Dt(l.SheetNames[u])+`" table:style-name="ta1">
`);var m=0,p=0,v=Fi(o["!ref"]||"A1"),x=o["!merges"]||[],S=0,_=Array.isArray(o);if(o["!cols"])for(p=0;p<=v.e.c;++p)f.push("        <table:table-column"+(o["!cols"][p]?' table:style-name="co'+o["!cols"][p].ods+'"':"")+`></table:table-column>
`);var b="",T=o["!rows"]||[];for(m=0;m<v.s.r;++m)b=T[m]?' table:style-name="ro'+T[m].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;m<=v.e.r;++m){for(b=T[m]?' table:style-name="ro'+T[m].ods+'"':"",f.push("        <table:table-row"+b+`>
`),p=0;p<v.s.c;++p)f.push(e);for(;p<=v.e.c;++p){var w=!1,A={},C="";for(S=0;S!=x.length;++S)if(!(x[S].s.c>p)&&!(x[S].s.r>m)&&!(x[S].e.c<p)&&!(x[S].e.r<m)){(x[S].s.c!=p||x[S].s.r!=m)&&(w=!0),A["table:number-columns-spanned"]=x[S].e.c-x[S].s.c+1,A["table:number-rows-spanned"]=x[S].e.r-x[S].s.r+1;break}if(w){f.push(t);continue}var N=Nt({r:m,c:p}),E=_?(o[m]||[])[p]:o[N];if(E&&E.f&&(A["table:formula"]=Dt(uN(E.f)),E.F&&E.F.slice(0,N.length)==N)){var I=Fi(E.F);A["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,A["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!E){f.push(e);continue}switch(E.t){case"b":C=E.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=E.v?"true":"false";break;case"n":C=E.w||String(E.v||0),A["office:value-type"]="float",A["office:value"]=E.v||0;break;case"s":case"str":C=E.v==null?"":E.v,A["office:value-type"]="string";break;case"d":C=E.w||oi(E.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=oi(E.v).toISOString(),A["table:style-name"]="ce1";break;default:f.push(e);continue}var D=n(C);if(E.l&&E.l.Target){var z=E.l.Target;z=z.charAt(0)=="#"?"#"+dN(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),D=je("text:a",D,{"xlink:href":z.replace(/&/g,"&amp;")})}f.push("          "+je("table:table-cell",je("text:p",D,{}),A)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},r=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var p=0;p<m["!cols"].length;++p)if(m["!cols"][p]){var v=m["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;$p(v),v.ods=u;var x=m["!cols"][p].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),o.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var p=0;p<m["!rows"].length;++p)if(m["!rows"][p]){m["!rows"][p].ods=f;var v=m["!rows"][p].hpx+"px";o.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++f}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var f=[vn],m=Fc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Fc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+m+p+`>
`),f.push(WS().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+m+`>
`),r(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)f.push(i(l.Sheets[l.SheetNames[v]],l,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function j_(n,e){if(e.bookType=="fods")return Wx(n,e);var t=Pp(),i="",r=[],o=[];return i="mimetype",nt(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",nt(t,i,Wx(n,e)),r.push([i,"text/xml"]),o.push([i,"ContentFile"]),i="styles.xml",nt(t,i,VM(n,e)),r.push([i,"text/xml"]),o.push([i,"StylesFile"]),i="meta.xml",nt(t,i,vn+WS()),r.push([i,"text/xml"]),o.push([i,"MetadataFile"]),i="manifest.rdf",nt(t,i,nC(o)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",nt(t,i,eC(r)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tf(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function GM(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):pr(Bc(n))}function YM(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var i=0;i<e.length;++i)if(n[t+i]!=e[i])continue e;return!0}return!1}function ns(n){var e=n.reduce(function(r,o){return r+o.length},0),t=new Uint8Array(e),i=0;return n.forEach(function(r){t.set(r,i),i+=r.length}),t}function XM(n,e,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,r=t/Math.pow(10,i-6176);n[e+15]|=i>>7,n[e+14]|=(i&127)<<1;for(var o=0;r>=1;++o,r/=256)n[e+o]=r&255;n[e+15]|=t>=0?0:128}function Uc(n,e){var t=e?e[0]:0,i=n[t]&127;e:if(n[t++]>=128&&(i|=(n[t]&127)<<7,n[t++]<128||(i|=(n[t]&127)<<14,n[t++]<128)||(i|=(n[t]&127)<<21,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),i}function kt(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function Yo(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function _n(n){for(var e=[],t=[0];t[0]<n.length;){var i=t[0],r=Uc(n,t),o=r&7;r=Math.floor(r/8);var l=0,u;if(r==0)break;switch(o){case 0:{for(var f=t[0];n[t[0]++]>=128;);u=n.slice(f,t[0])}break;case 5:l=4,u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Uc(n,t),u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(r," at offset ").concat(i))}var m={data:u,type:o};e[r]==null?e[r]=[m]:e[r].push(m)}return e}function Fn(n){var e=[];return n.forEach(function(t,i){t.forEach(function(r){r.data&&(e.push(kt(i*8+r.type)),r.type==2&&e.push(kt(r.data.length)),e.push(r.data))})}),ns(e)}function hr(n){for(var e,t=[],i=[0];i[0]<n.length;){var r=Uc(n,i),o=_n(n.slice(i[0],i[0]+r));i[0]+=r;var l={id:Yo(o[1][0].data),messages:[]};o[2].forEach(function(u){var f=_n(u.data),m=Yo(f[3][0].data);l.messages.push({meta:f,data:n.slice(i[0],i[0]+m)}),i[0]+=m}),(e=o[3])!=null&&e[0]&&(l.merge=Yo(o[3][0].data)>>>0>0),t.push(l)}return t}function Io(n){var e=[];return n.forEach(function(t){var i=[];i[1]=[{data:kt(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:kt(+!!t.merge),type:0}]);var r=[];t.messages.forEach(function(l){r.push(l.data),l.meta[3]=[{type:0,data:kt(l.data.length)}],i[2].push({data:Fn(l.meta),type:2})});var o=Fn(i);e.push(kt(o.length)),e.push(o),r.forEach(function(l){return e.push(l)})}),ns(e)}function $M(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],i=Uc(e,t),r=[];t[0]<e.length;){var o=e[t[0]]&3;if(o==0){var l=e[t[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[t[0]],u>1&&(l|=e[t[0]+1]<<8),u>2&&(l|=e[t[0]+2]<<16),u>3&&(l|=e[t[0]+3]<<24),l>>>=0,l++,t[0]+=u}r.push(e.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,m=0;if(o==1?(m=(e[t[0]]>>2&7)+4,f=(e[t[0]++]&224)<<3,f|=e[t[0]++]):(m=(e[t[0]++]>>2)+1,o==2?(f=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(f=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),r=[ns(r)],f==0)throw new Error("Invalid offset 0");if(f>r[0].length)throw new Error("Invalid offset beyond length");if(m>=f)for(r.push(r[0].slice(-f)),m-=f;m>=r[r.length-1].length;)r.push(r[r.length-1]),m-=r[r.length-1].length;r.push(r[0].slice(-f,-f+m))}}var p=ns(r);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function mr(n){for(var e=[],t=0;t<n.length;){var i=n[t++],r=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push($M(i,n.slice(t,t+r))),t+=r}if(t!==n.length)throw new Error("data is not a valid framed stream!");return ns(e)}function Po(n){for(var e=[],t=0;t<n.length;){var i=Math.min(n.length-t,268435455),r=new Uint8Array(4);e.push(r);var o=kt(i),l=o.length;e.push(o),i<=60?(l++,e.push(new Uint8Array([i-1<<2]))):i<=256?(l+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(l+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(l+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(l+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(n.slice(t,t+i)),l+=i,r[0]=0,r[1]=l&255,r[2]=l>>8&255,r[3]=l>>16&255,t+=i}return ns(e)}function Hm(n,e){var t=new Uint8Array(32),i=tf(t),r=12,o=0;switch(t[0]=5,n.t){case"n":t[1]=2,XM(t,r,n.v),o|=1,r+=16;break;case"b":t[1]=6,i.setFloat64(r,n.v?1:0,!0),o|=2,r+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,i.setUint32(r,e.indexOf(n.v),!0),o|=8,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,o,!0),t.slice(0,r)}function Wm(n,e){var t=new Uint8Array(32),i=tf(t),r=12,o=0;switch(t[0]=3,n.t){case"n":t[2]=2,i.setFloat64(r,n.v,!0),o|=32,r+=8;break;case"b":t[2]=6,i.setFloat64(r,n.v?1:0,!0),o|=32,r+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,i.setUint32(r,e.indexOf(n.v),!0),o|=16,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(4,o,!0),t.slice(0,r)}function Va(n){var e=_n(n);return Uc(e[1][0].data)}function qM(n,e,t){var i,r,o,l;if(!((i=n[6])!=null&&i[0])||!((r=n[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=n[8])==null?void 0:o[0])==null?void 0:l.data)&&Yo(n[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,m=tf(n[7][0].data),p=0,v=[],x=tf(n[4][0].data),S=0,_=[],b=0;b<e.length;++b){if(e[b]==null){m.setUint16(b*2,65535,!0),x.setUint16(b*2,65535);continue}m.setUint16(b*2,p,!0),x.setUint16(b*2,S,!0);var T,w;switch(typeof e[b]){case"string":T=Hm({t:"s",v:e[b]},t),w=Wm({t:"s",v:e[b]},t);break;case"number":T=Hm({t:"n",v:e[b]},t),w=Wm({t:"n",v:e[b]},t);break;case"boolean":T=Hm({t:"b",v:e[b]},t),w=Wm({t:"b",v:e[b]},t);break;default:throw new Error("Unsupported value "+e[b])}v.push(T),p+=T.length,_.push(w),S+=w.length,++f}for(n[2][0].data=kt(f);b<n[7][0].data.length/2;++b)m.setUint16(b*2,65535,!0),x.setUint16(b*2,65535,!0);return n[6][0].data=ns(v),n[3][0].data=ns(_),f}function KM(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Fi(t["!ref"]);i.s.r=i.s.c=0;var r=!1;i.e.c>9&&(r=!0,i.e.c=9),i.e.r>49&&(r=!0,i.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(gn(i)));var o=nf(t,{range:i,header:1}),l=["~Sh33tJ5~"];o.forEach(function(Y){return Y.forEach(function(V){typeof V=="string"&&l.push(V)})});var u={},f=[],m=Pt.read(e.numbers,{type:"base64"});m.FileIndex.map(function(Y,V){return[Y,m.FullPaths[V]]}).forEach(function(Y){var V=Y[0],q=Y[1];if(V.type==2&&V.name.match(/\.iwa/)){var ae=V.content,Re=mr(ae),Ce=hr(Re);Ce.forEach(function(Le){f.push(Le.id),u[Le.id]={deps:[],location:q,type:Yo(Le.messages[0].meta[1][0].data)}})}}),f.sort(function(Y,V){return Y-V});var p=f.filter(function(Y){return Y>1}).map(function(Y){return[Y,kt(Y)]});m.FileIndex.map(function(Y,V){return[Y,m.FullPaths[V]]}).forEach(function(Y){var V=Y[0];if(Y[1],!!V.name.match(/\.iwa/)){var q=hr(mr(V.content));q.forEach(function(ae){ae.messages.forEach(function(Re){p.forEach(function(Ce){ae.messages.some(function(Le){return Yo(Le.meta[1][0].data)!=11006&&YM(Le.data,Ce[1])})&&u[Ce[0]].deps.push(ae.id)})})})}});for(var v=Pt.find(m,u[1].location),x=hr(mr(v.content)),S,_=0;_<x.length;++_){var b=x[_];b.id==1&&(S=b)}var T=Va(_n(S.messages[0].data)[1][0].data);for(v=Pt.find(m,u[T].location),x=hr(mr(v.content)),_=0;_<x.length;++_)b=x[_],b.id==T&&(S=b);for(T=Va(_n(S.messages[0].data)[2][0].data),v=Pt.find(m,u[T].location),x=hr(mr(v.content)),_=0;_<x.length;++_)b=x[_],b.id==T&&(S=b);for(T=Va(_n(S.messages[0].data)[2][0].data),v=Pt.find(m,u[T].location),x=hr(mr(v.content)),_=0;_<x.length;++_)b=x[_],b.id==T&&(S=b);var w=_n(S.messages[0].data);{w[6][0].data=kt(i.e.r+1),w[7][0].data=kt(i.e.c+1);var A=Va(w[46][0].data),C=Pt.find(m,u[A].location),N=hr(mr(C.content));{for(var E=0;E<N.length&&N[E].id!=A;++E);if(N[E].id!=A)throw"Bad ColumnRowUIDMapArchive";var I=_n(N[E].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var D=0;D<=i.e.c;++D){var z=[];z[1]=z[2]=[{type:0,data:kt(D+420690)}],I[1].push({type:2,data:Fn(z)}),I[2].push({type:0,data:kt(D)}),I[3].push({type:0,data:kt(D)})}I[4]=[],I[5]=[],I[6]=[];for(var L=0;L<=i.e.r;++L)z=[],z[1]=z[2]=[{type:0,data:kt(L+726270)}],I[4].push({type:2,data:Fn(z)}),I[5].push({type:0,data:kt(L)}),I[6].push({type:0,data:kt(L)});N[E].messages[0].data=Fn(I)}C.content=Po(Io(N)),C.size=C.content.length,delete w[46];var H=_n(w[4][0].data);{H[7][0].data=kt(i.e.r+1);var K=_n(H[1][0].data),ne=Va(K[2][0].data);C=Pt.find(m,u[ne].location),N=hr(mr(C.content));{if(N[0].id!=ne)throw"Bad HeaderStorageBucket";var xe=_n(N[0].messages[0].data);for(L=0;L<o.length;++L){var He=_n(xe[2][0].data);He[1][0].data=kt(L),He[4][0].data=kt(o[L].length),xe[2][L]={type:xe[2][0].type,data:Fn(He)}}N[0].messages[0].data=Fn(xe)}C.content=Po(Io(N)),C.size=C.content.length;var _e=Va(H[2][0].data);C=Pt.find(m,u[_e].location),N=hr(mr(C.content));{if(N[0].id!=_e)throw"Bad HeaderStorageBucket";for(xe=_n(N[0].messages[0].data),D=0;D<=i.e.c;++D)He=_n(xe[2][0].data),He[1][0].data=kt(D),He[4][0].data=kt(i.e.r+1),xe[2][D]={type:xe[2][0].type,data:Fn(He)};N[0].messages[0].data=Fn(xe)}C.content=Po(Io(N)),C.size=C.content.length;var ie=Va(H[4][0].data);(function(){for(var Y=Pt.find(m,u[ie].location),V=hr(mr(Y.content)),q,ae=0;ae<V.length;++ae){var Re=V[ae];Re.id==ie&&(q=Re)}var Ce=_n(q.messages[0].data);{Ce[3]=[];var Le=[];l.forEach(function(et,Ht){Le[1]=[{type:0,data:kt(Ht)}],Le[2]=[{type:0,data:kt(1)}],Le[3]=[{type:2,data:GM(et)}],Ce[3].push({type:2,data:Fn(Le)})})}q.messages[0].data=Fn(Ce);var ke=Io(V),ct=Po(ke);Y.content=ct,Y.size=Y.content.length})();var he=_n(H[3][0].data);{var Ne=he[1][0];delete he[2];var Be=_n(Ne.data);{var X=Va(Be[2][0].data);(function(){for(var Y=Pt.find(m,u[X].location),V=hr(mr(Y.content)),q,ae=0;ae<V.length;++ae){var Re=V[ae];Re.id==X&&(q=Re)}var Ce=_n(q.messages[0].data);{delete Ce[6],delete he[7];var Le=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var ke=0,ct=0;ct<=i.e.r;++ct){var et=_n(Le);ke+=qM(et,o[ct],l),et[1][0].data=kt(ct),Ce[5].push({data:Fn(et),type:2})}Ce[1]=[{type:0,data:kt(i.e.c+1)}],Ce[2]=[{type:0,data:kt(i.e.r+1)}],Ce[3]=[{type:0,data:kt(ke)}],Ce[4]=[{type:0,data:kt(i.e.r+1)}]}q.messages[0].data=Fn(Ce);var Ht=Io(V),rt=Po(Ht);Y.content=rt,Y.size=Y.content.length})()}Ne.data=Fn(Be)}H[3][0].data=Fn(he)}w[4][0].data=Fn(H)}S.messages[0].data=Fn(w);var pe=Io(x),P=Po(pe);return v.content=P,v.size=v.content.length,m}function ZM(n){return function(t){for(var i=0;i!=n.length;++i){var r=n[i];t[r[0]]===void 0&&(t[r[0]]=r[1]),r[2]==="n"&&(t[r[0]]=Number(t[r[0]]))}}}function Jp(n){ZM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function QM(n,e){return e.bookType=="ods"?j_(n,e):e.bookType=="numbers"?KM(n,e):e.bookType=="xlsb"?JM(n,e):eR(n,e)}function JM(n,e){Uo=1024,n&&!n.SSF&&(n.SSF=Ti(sn)),n&&n.SSF&&(hf(),ff(n.SSF),e.revssf=mf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ac?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",i=d_.indexOf(e.bookType)>-1,r=US();Jp(e=e||{});var o=Pp(),l="",u=0;if(e.cellXfs=[],rs(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",nt(o,l,VS(n.Props,e)),r.coreprops.push(l),Ct(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],m=0;m<n.SheetNames.length;++m)(n.Workbook.Sheets[m]||{}).Hidden!=2&&f.push(n.SheetNames[m]);n.Props.SheetNames=f}for(n.Props.Worksheets=n.Props.SheetNames.length,nt(o,l,YS(n.Props)),r.extprops.push(l),Ct(e.rels,3,l,bt.EXT_PROPS),n.Custprops!==n.Props&&Vn(n.Custprops||{}).length>0&&(l="docProps/custom.xml",nt(o,l,XS(n.Custprops)),r.custprops.push(l),Ct(e.rels,4,l,bt.CUST_PROPS)),u=1;u<=n.SheetNames.length;++u){var p={"!id":{}},v=n.Sheets[n.SheetNames[u-1]],x=(v||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,nt(o,l,nM(u-1,l,e,n,p)),r.sheets.push(l),Ct(e.wbrels,-1,"worksheets/sheet"+u+"."+t,bt.WS[0])}if(v){var S=v["!comments"],_=!1,b="";S&&S.length>0&&(b="xl/comments"+u+"."+t,nt(o,b,aM(S,b)),r.comments.push(b),Ct(p,-1,"../comments"+u+"."+t,bt.CMNT),_=!0),v["!legacy"]&&_&&nt(o,"xl/drawings/vmlDrawing"+u+".vml",c_(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&nt(o,HS(l),Vo(p))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,nt(o,l,rM(e.Strings,l,e)),r.strs.push(l),Ct(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,nt(o,l,tM(n,l)),r.workbooks.push(l),Ct(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",nt(o,l,o_(n.Themes,e)),r.themes.push(l),Ct(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,nt(o,l,iM(n,l,e)),r.styles.push(l),Ct(e.wbrels,-1,"styles."+t,bt.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",nt(o,l,n.vbaraw),r.vba.push(l),Ct(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,nt(o,l,sM(l)),r.metadata.push(l),Ct(e.wbrels,-1,"metadata."+t,bt.XLMETA),nt(o,"[Content_Types].xml",zS(r,e)),nt(o,"_rels/.rels",Vo(e.rels)),nt(o,"xl/_rels/workbook."+t+".rels",Vo(e.wbrels)),delete e.revssf,delete e.ssf,o}function eR(n,e){Uo=1024,n&&!n.SSF&&(n.SSF=Ti(sn)),n&&n.SSF&&(hf(),ff(n.SSF),e.revssf=mf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ac?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",i=d_.indexOf(e.bookType)>-1,r=US();Jp(e=e||{});var o=Pp(),l="",u=0;if(e.cellXfs=[],rs(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",nt(o,l,VS(n.Props,e)),r.coreprops.push(l),Ct(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],m=0;m<n.SheetNames.length;++m)(n.Workbook.Sheets[m]||{}).Hidden!=2&&f.push(n.SheetNames[m]);n.Props.SheetNames=f}n.Props.Worksheets=n.Props.SheetNames.length,nt(o,l,YS(n.Props)),r.extprops.push(l),Ct(e.rels,3,l,bt.EXT_PROPS),n.Custprops!==n.Props&&Vn(n.Custprops||{}).length>0&&(l="docProps/custom.xml",nt(o,l,XS(n.Custprops)),r.custprops.push(l),Ct(e.rels,4,l,bt.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=n.SheetNames.length;++u){var v={"!id":{}},x=n.Sheets[n.SheetNames[u-1]],S=(x||{})["!type"]||"sheet";switch(S){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,nt(o,l,b_(u-1,e,n,v)),r.sheets.push(l),Ct(e.wbrels,-1,"worksheets/sheet"+u+"."+t,bt.WS[0])}if(x){var _=x["!comments"],b=!1,T="";if(_&&_.length>0){var w=!1;_.forEach(function(A){A[1].forEach(function(C){C.T==!0&&(w=!0)})}),w&&(T="xl/threadedComments/threadedComment"+u+"."+t,nt(o,T,Nj(_,p,e)),r.threadedcomments.push(T),Ct(v,-1,"../threadedComments/threadedComment"+u+"."+t,bt.TCMNT)),T="xl/comments"+u+"."+t,nt(o,T,u_(_)),r.comments.push(T),Ct(v,-1,"../comments"+u+"."+t,bt.CMNT),b=!0}x["!legacy"]&&b&&nt(o,"xl/drawings/vmlDrawing"+u+".vml",c_(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}v["!id"].rId1&&nt(o,HS(l),Vo(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,nt(o,l,t_(e.Strings,e)),r.strs.push(l),Ct(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,nt(o,l,T_(n)),r.workbooks.push(l),Ct(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",nt(o,l,o_(n.Themes,e)),r.themes.push(l),Ct(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,nt(o,l,a_(n,e)),r.styles.push(l),Ct(e.wbrels,-1,"styles."+t,bt.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",nt(o,l,n.vbaraw),r.vba.push(l),Ct(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,nt(o,l,l_()),r.metadata.push(l),Ct(e.wbrels,-1,"metadata."+t,bt.XLMETA),p.length>1&&(l="xl/persons/person.xml",nt(o,l,Oj(p)),r.people.push(l),Ct(e.wbrels,-1,"persons/person.xml",bt.PEOPLE)),nt(o,"[Content_Types].xml",zS(r,e)),nt(o,"_rels/.rels",Vo(e.rels)),nt(o,"xl/_rels/workbook."+t+".rels",Vo(e.wbrels)),delete e.revssf,delete e.ssf,o}function tR(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=ha(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function D_(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return $c(e.file,Pt.write(n,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pt.write(n,e)}function nR(n,e){var t=Ti(e||{}),i=QM(n,t);return iR(i,t)}function iR(n,e){var t={},i=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=i;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var r=n.FullPaths?Pt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof r=="string"){if(e.type=="binary"||e.type=="base64")return r;r=new Uint8Array(df(r))}return e.password&&typeof encrypt_agile<"u"?D_(encrypt_agile(r,e.password),e):e.type==="file"?$c(e.file,r):e.type=="string"?_c(r):r}function rR(n,e){var t=e||{},i=bM(n,t);return D_(i,t)}function Or(n,e,t){t||(t="");var i=t+n;switch(e.type){case"base64":return Ic(Bc(i));case"binary":return Bc(i);case"string":return n;case"file":return $c(e.file,i,"utf8");case"buffer":return _t?ga(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Or(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function aR(n,e){switch(e.type){case"base64":return Ic(n);case"binary":return n;case"string":return n;case"file":return $c(e.file,n,"binary");case"buffer":return _t?ga(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Cd(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",i=0;i<n.length;++i)t+=String.fromCharCode(n[i]);return e.type=="base64"?Ic(t):e.type=="string"?_c(t):t;case"file":return $c(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function N_(n,e){M5(),VO(n);var t=Ti(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=N_(n,t);return t.type="array",df(i)}var r=0;if(t.sheet&&(typeof t.sheet=="number"?r=t.sheet:r=n.SheetNames.indexOf(t.sheet),!n.SheetNames[r]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Or(yM(n,t),t);case"slk":case"sylk":return Or(zC.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"htm":case"html":return Or(A_(n.Sheets[n.SheetNames[r]],t),t);case"txt":return aR(O_(n.Sheets[n.SheetNames[r]],t),t);case"csv":return Or(eg(n.Sheets[n.SheetNames[r]],t),t,"\uFEFF");case"dif":return Or(HC.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"dbf":return Cd(UC.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"prn":return Or(WC.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"rtf":return Or(KC.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"eth":return Or(e_.from_sheet(n.Sheets[n.SheetNames[r]],t),t);case"fods":return Or(j_(n,t),t);case"wk1":return Cd(Ix.sheet_to_wk1(n.Sheets[n.SheetNames[r]],t),t);case"wk3":return Cd(Ix.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Cd(E_(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),rR(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nR(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function sR(n,e,t,i,r,o,l,u){var f=Wn(t),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,x=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!l||n[t])for(var S=e.s.c;S<=e.e.c;++S){var _=l?n[t][S]:n[i[S]+f];if(_===void 0||_.t===void 0){if(m===void 0)continue;o[S]!=null&&(x[o[S]]=m);continue}var b=_.v;switch(_.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(o[S]!=null){if(b==null)if(_.t=="e"&&b===null)x[o[S]]=null;else if(m!==void 0)x[o[S]]=m;else if(p&&b===null)x[o[S]]=null;else continue;else x[o[S]]=p&&(_.t!=="n"||_.t==="n"&&u.rawNumbers!==!1)?b:ma(_,b,u);b!=null&&(v=!1)}}return{row:x,isempty:v}}function nf(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},i=0,r=1,o=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},p=m.range!=null?m.range:n["!ref"];switch(m.header===1?i=1:m.header==="A"?i=2:Array.isArray(m.header)?i=3:m.header==null&&(i=0),typeof p){case"string":f=Vt(p);break;case"number":f=Vt(n["!ref"]),f.s.r=p;break;default:f=p}i>0&&(r=0);var v=Wn(f.s.r),x=[],S=[],_=0,b=0,T=Array.isArray(n),w=f.s.r,A=0,C={};T&&!n[w]&&(n[w]=[]);var N=m.skipHidden&&n["!cols"]||[],E=m.skipHidden&&n["!rows"]||[];for(A=f.s.c;A<=f.e.c;++A)if(!(N[A]||{}).hidden)switch(x[A]=Zn(A),t=T?n[w][A]:n[x[A]+v],i){case 1:o[A]=A-f.s.c;break;case 2:o[A]=x[A];break;case 3:o[A]=m.header[A-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=l=ma(t,null,m),b=C[l]||0,!b)C[l]=1;else{do u=l+"_"+b++;while(C[u]);C[l]=b,C[u]=1}o[A]=u}for(w=f.s.r+r;w<=f.e.r;++w)if(!(E[w]||{}).hidden){var I=sR(n,f,w,x,i,o,T,m);(I.isempty===!1||(i===1?m.blankrows!==!1:m.blankrows))&&(S[_++]=I.row)}return S.length=_,S}var Vx=/"/g;function oR(n,e,t,i,r,o,l,u){for(var f=!0,m=[],p="",v=Wn(t),x=e.s.c;x<=e.e.c;++x)if(i[x]){var S=u.dense?(n[t]||[])[x]:n[i[x]+v];if(S==null)p="";else if(S.v!=null){f=!1,p=""+(u.rawNumbers&&S.t=="n"?S.v:ma(S,null,u));for(var _=0,b=0;_!==p.length;++_)if((b=p.charCodeAt(_))===r||b===o||b===34||u.forceQuotes){p='"'+p.replace(Vx,'""')+'"';break}p=="ID"&&(p='"ID"')}else S.f!=null&&!S.F?(f=!1,p="="+S.f,p.indexOf(",")>=0&&(p='"'+p.replace(Vx,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&f?null:m.join(l)}function eg(n,e){var t=[],i=e??{};if(n==null||n["!ref"]==null)return"";var r=Vt(n["!ref"]),o=i.FS!==void 0?i.FS:",",l=o.charCodeAt(0),u=i.RS!==void 0?i.RS:`
`,f=u.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];i.dense=Array.isArray(n);for(var x=i.skipHidden&&n["!cols"]||[],S=i.skipHidden&&n["!rows"]||[],_=r.s.c;_<=r.e.c;++_)(x[_]||{}).hidden||(v[_]=Zn(_));for(var b=0,T=r.s.r;T<=r.e.r;++T)(S[T]||{}).hidden||(p=oR(n,r,T,v,l,f,o,i),p!=null&&(i.strip&&(p=p.replace(m,"")),(p||i.blankrows!==!1)&&t.push((b++?u:"")+p)));return delete i.dense,t.join("")}function O_(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=eg(n,e);return t}function lR(n){var e="",t,i="";if(n==null||n["!ref"]==null)return[];var r=Vt(n["!ref"]),o="",l=[],u,f=[],m=Array.isArray(n);for(u=r.s.c;u<=r.e.c;++u)l[u]=Zn(u);for(var p=r.s.r;p<=r.e.r;++p)for(o=Wn(p),u=r.s.c;u<=r.e.c;++u)if(e=l[u]+o,t=m?(n[p]||[])[u]:n[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}f[f.length]=e+"="+i}return f}function M_(n,e,t){var i=t||{},r=+!i.skipHeader,o=n||{},l=0,u=0;if(o&&i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Nn(i.origin):i.origin;l=f.r,u=f.c}var m,p={s:{c:0,r:0},e:{c:u,r:l+e.length-1+r}};if(o["!ref"]){var v=Vt(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+e.length-1+r)}else l==-1&&(l=0,p.e.r=e.length-1+r);var x=i.header||[],S=0;e.forEach(function(b,T){Vn(b).forEach(function(w){(S=x.indexOf(w))==-1&&(x[S=x.length]=w);var A=b[w],C="z",N="",E=Nt({c:u+S,r:l+T+r});m=zc(o,E),A&&typeof A=="object"&&!(A instanceof Date)?o[E]=A:(typeof A=="number"?C="n":typeof A=="boolean"?C="b":typeof A=="string"?C="s":A instanceof Date?(C="d",i.cellDates||(C="n",A=_i(A)),N=i.dateNF||sn[14]):A===null&&i.nullError&&(C="e",A=0),m?(m.t=C,m.v=A,delete m.w,delete m.R,N&&(m.z=N)):o[E]=m={t:C,v:A},N&&(m.z=N))})}),p.e.c=Math.max(p.e.c,u+x.length-1);var _=Wn(l);if(r)for(S=0;S<x.length;++S)o[Zn(S+u)+_]={t:"s",v:x[S]};return o["!ref"]=gn(p),o}function cR(n,e){return M_(null,n,e)}function zc(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var i=Nn(e);return n[i.r]||(n[i.r]=[]),n[i.r][i.c]||(n[i.r][i.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?zc(n,Nt(e)):zc(n,Nt({r:e,c:t||0}))}function uR(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function dR(){return{SheetNames:[],Sheets:{}}}function fR(n,e,t,i){var r=1;if(!t)for(;r<=65535&&n.SheetNames.indexOf(t="Sheet"+r)!=-1;++r,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);r=o&&+o[2]||0;var l=o&&o[1]||t;for(++r;r<=65535&&n.SheetNames.indexOf(t=l+r)!=-1;++r);}if(__(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function hR(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=uR(n,e);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[i].Hidden=t}function mR(n,e){return n.z=e,n}function R_(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function pR(n,e,t){return R_(n,"#"+e,t)}function gR(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function vR(n,e,t,i){for(var r=typeof e!="string"?e:Vt(e),o=typeof e=="string"?e:gn(e),l=r.s.r;l<=r.e.r;++l)for(var u=r.s.c;u<=r.e.c;++u){var f=zc(n,l,u);f.t="n",f.F=o,delete f.v,l==r.s.r&&u==r.s.c&&(f.f=t,i&&(f.D=!0))}return n}var Bn={encode_col:Zn,encode_row:Wn,encode_cell:Nt,encode_range:gn,decode_col:Wp,decode_row:Hp,split_cell:M6,decode_cell:Nn,decode_range:Fi,format_cell:ma,sheet_add_aoa:RS,sheet_add_json:M_,sheet_add_dom:k_,aoa_to_sheet:nl,json_to_sheet:cR,table_to_sheet:C_,table_to_book:HM,sheet_to_csv:eg,sheet_to_txt:O_,sheet_to_json:nf,sheet_to_html:A_,sheet_to_formulae:lR,sheet_to_row_object_array:nf,sheet_get_cell:zc,book_new:dR,book_append_sheet:fR,book_set_sheet_visibility:hR,cell_set_number_format:mR,cell_set_hyperlink:R_,cell_set_internal_link:pR,cell_add_comment:gR,sheet_set_array_formula:vR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class yR{async exportReport(e,t,i,r,o){const l=Bn.book_new();if(o.includeSummary){const p=this.createSummarySheet(e,o);Bn.book_append_sheet(l,p,"Summary")}if(o.includeDetailedData){const p=this.createDetailedDataSheet(t,i,r);Bn.book_append_sheet(l,p,"Time Entries")}const u=this.createProjectsSheet(e,i);if(Bn.book_append_sheet(l,u,"Project Analysis"),o.includeTrends){const p=this.createTrendsSheet(e);Bn.book_append_sheet(l,p,"Daily Trends")}if(e.topClients&&e.topClients.length>0){const p=this.createClientsSheet(e);Bn.book_append_sheet(l,p,"Client Analysis")}const f=this.createEfficiencySheet(e);Bn.book_append_sheet(l,f,"Efficiency");const m=N_(l,{bookType:"xlsx",type:"array",cellStyles:!0});return new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}createSummarySheet(e,t){const i=[["TimeBeacon Analytics Report"],["Generated on:",new Date().toLocaleDateString()],["Report Period:",`${t.dateFormat||"Custom Range"}`],["Generated by:",t.generatedBy||"TimeBeacon User"],[],["📊 KEY METRICS"],["Metric","Value","Status"],["Total Hours Tracked",e.totalHours.toFixed(2),this.getStatusIndicator(e.totalHours,40,"hours")],["Billable Hours",e.billableHours.toFixed(2),this.getStatusIndicator(e.billableHours,30,"hours")],["Non-Billable Hours",e.nonBillableHours.toFixed(2),""],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`,this.getStatusIndicator(e.utilizationRate,75,"percentage")],["Productivity Score",`${e.productivityScore.toFixed(1)}%`,this.getStatusIndicator(e.productivityScore,80,"percentage")],["Average Session Length",`${e.averageSessionLength.toFixed(1)} min`,this.getStatusIndicator(e.averageSessionLength,120,"minutes")],["Total Sessions",e.totalSessions.toString(),""],[],["💼 TOP PROJECTS (by hours)"],["Rank","Project Name","Hours","Percentage"],...e.topProjects.slice(0,10).map((o,l)=>[l+1,o.name,o.hours.toFixed(2),`${o.percentage.toFixed(1)}%`]),[],["📈 PERFORMANCE INDICATORS"],["Indicator","Current","Target","Status"],["Daily Average Hours",(e.totalHours/30).toFixed(1),"8.0",this.getPerformanceStatus(e.totalHours/30,8)],["Consistency Score",(e.productivityScore/100).toFixed(2),"0.85",this.getPerformanceStatus(e.productivityScore/100,.85)],["Project Focus",e.topProjects.length>0?e.topProjects[0].percentage.toFixed(1)+"%":"0%","60%",""]],r=Bn.aoa_to_sheet(i);return this.applyBasicFormatting(r),r["!cols"]=[{width:25},{width:15},{width:12},{width:12}],r}createDetailedDataSheet(e,t,i){const r=["Date","Project","Client","Description","Start Time","End Time","Duration (hours)","Billable","Hourly Rate","Earnings","Status","Category","Tags"],o=[r,...e.map(u=>{const f=t.find(x=>x.id===u.projectId),m=i.find(x=>x.id===u.clientId),p=(u.duration||0)/60,v=p*(u.hourlyRate||0);return[new Date(u.date).toLocaleDateString(),f?.name||"Unknown Project",m?.name||"No Client",u.description||"",u.startTime||"",u.endTime||"",p.toFixed(2),u.billable?"Yes":"No",u.hourlyRate?.toFixed(2)||"0.00",v.toFixed(2),u.status||"Pending",f?.category||"",u.tags?.join(", ")||""]})],l=Bn.aoa_to_sheet(o);return this.applyTableFormatting(l,r.length),l["!cols"]=[{width:12},{width:20},{width:18},{width:30},{width:10},{width:10},{width:12},{width:10},{width:12},{width:12},{width:12},{width:15},{width:20}],l}createProjectsSheet(e,t){const i=[["Project Performance Analysis"],["Generated on:",new Date().toLocaleDateString()],[],["📋 PROJECT SUMMARY"],["Project Name","Hours Logged","Percentage","Status","Budget Used"],...e.topProjects.map(o=>{const l=t.find(f=>f.name===o.name),u=l?.budget?(o.hours*(l.hourlyRate||50)/l.budget*100).toFixed(1)+"%":"No Budget";return[o.name,o.hours.toFixed(2),`${o.percentage.toFixed(1)}%`,this.getProjectStatus(o.percentage),u]}),[],["⚡ EFFICIENCY ANALYSIS"],["Project","Planned Hours","Actual Hours","Efficiency %","Variance"],...e.projectEfficiency.map(o=>[o.project,o.plannedHours.toFixed(1),o.actualHours.toFixed(1),`${o.efficiency.toFixed(1)}%`,(o.plannedHours-o.actualHours).toFixed(1)])],r=Bn.aoa_to_sheet(i);return this.applyBasicFormatting(r),r["!cols"]=[{width:25},{width:15},{width:12},{width:15},{width:15}],r}createTrendsSheet(e){const t=[["Daily Productivity Trends"],["Analysis Period:",`${e.dailyTrends.length} days`],[],["Date","Hours Tracked","Sessions","Avg Session Length","Productivity Index"],...e.dailyTrends.map(r=>{const o=r.sessions>0?r.hours*60/r.sessions:0,l=this.calculateDailyProductivityIndex(r.hours,r.sessions);return[r.date,r.hours.toFixed(2),r.sessions.toString(),`${o.toFixed(1)} min`,l.toFixed(1)]}),[],["📊 TREND SUMMARY"],["Metric","Average","Best Day","Lowest Day"],["Daily Hours",(e.dailyTrends.reduce((r,o)=>r+o.hours,0)/e.dailyTrends.length).toFixed(2),Math.max(...e.dailyTrends.map(r=>r.hours)).toFixed(2),Math.min(...e.dailyTrends.map(r=>r.hours)).toFixed(2)],["Daily Sessions",(e.dailyTrends.reduce((r,o)=>r+o.sessions,0)/e.dailyTrends.length).toFixed(1),Math.max(...e.dailyTrends.map(r=>r.sessions)).toString(),Math.min(...e.dailyTrends.map(r=>r.sessions)).toString()]],i=Bn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:12},{width:15},{width:12},{width:18},{width:16}],i}createClientsSheet(e){const t=[["Client Performance Analysis"],[],["🏢 CLIENT METRICS"],["Client Name","Hours Logged","Revenue Generated","Avg Hourly Rate","Projects"],...e.topClients.map(r=>[r.name,r.hours.toFixed(2),`$${r.revenue.toFixed(2)}`,r.hours>0?`$${(r.revenue/r.hours).toFixed(2)}`:"$0.00","1"]),[],["💰 REVENUE BREAKDOWN"],["Revenue Tier","Client Count","Total Revenue","Percentage"],...this.analyzeRevenueDistribution(e.topClients)],i=Bn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:25},{width:15},{width:18},{width:16},{width:12}],i}createEfficiencySheet(e){const t=[["Efficiency & Performance Analysis"],[],["⚡ EFFICIENCY METRICS"],["Project","Planned Hours","Actual Hours","Efficiency %","Time Variance","Status"],...e.projectEfficiency.map(r=>[r.project,r.plannedHours.toFixed(1),r.actualHours.toFixed(1),`${r.efficiency.toFixed(1)}%`,`${(r.plannedHours-r.actualHours).toFixed(1)}h`,this.getEfficiencyStatus(r.efficiency)]),[],["📈 PRODUCTIVITY RECOMMENDATIONS"],["Area","Current Score","Target","Action Required"],["Session Management",`${e.averageSessionLength.toFixed(0)} min avg`,"90-120 min",e.averageSessionLength<90?"Increase focus time":"Optimal"],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`,">75%",e.utilizationRate<75?"Increase billable work":"Excellent"],["Project Focus",`${e.topProjects.length} active`,"<5 active",e.topProjects.length>5?"Reduce project count":"Good focus"]],i=Bn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:20},{width:15},{width:15},{width:12},{width:15},{width:20}],i}getStatusIndicator(e,t,i){const r=e/t;return r>=1?"🟢 Excellent":r>=.8?"🟡 Good":r>=.6?"🟠 Fair":"🔴 Needs Improvement"}getPerformanceStatus(e,t){const i=e/t;return i>=1?"✅ Target Met":i>=.9?"🎯 Close":"⚠️ Below Target"}getProjectStatus(e){return e>=30?"Primary Focus":e>=15?"Active":e>=5?"Minor":"Minimal"}getEfficiencyStatus(e){return e>=100?"🟢 On/Under Budget":e>=80?"🟡 Slight Overrun":"🔴 Over Budget"}calculateDailyProductivityIndex(e,t){const i=Math.min(e/8*100,100),r=t>0?Math.min(e*60/t/120*100,100):0;return i*.6+r*.4}analyzeRevenueDistribution(e){const t=[{name:"High Value (>$1000)",min:1e3,count:0,revenue:0},{name:"Medium Value ($500-$1000)",min:500,count:0,revenue:0},{name:"Low Value (<$500)",min:0,count:0,revenue:0}],i=e.reduce((r,o)=>r+o.revenue,0);return e.forEach(r=>{r.revenue>=1e3?(t[0].count++,t[0].revenue+=r.revenue):r.revenue>=500?(t[1].count++,t[1].revenue+=r.revenue):(t[2].count++,t[2].revenue+=r.revenue)}),t.map(r=>[r.name,r.count.toString(),`$${r.revenue.toFixed(2)}`,i>0?`${(r.revenue/i*100).toFixed(1)}%`:"0%"])}applyBasicFormatting(e){if(!e["!ref"])return;const t=Bn.decode_range(e["!ref"]);for(let i=t.s.r;i<=Math.min(t.s.r+3,t.e.r);i++)for(let r=t.s.c;r<=t.e.c;r++){const o=e[Bn.encode_cell({r:i,c:r})];o&&(o.s={font:{bold:!0}})}}applyTableFormatting(e,t){if(!e["!ref"])return;const i=Bn.decode_range(e["!ref"]);for(let r=i.s.c;r<t;r++){const o=e[Bn.encode_cell({r:0,c:r})];o&&(o.s={font:{bold:!0},fill:{fgColor:{rgb:"E5E5E5"}}})}}}const xR=new yR;class bR{generateAdvancedMetrics(e,t,i,r){const o=this.filterEntriesByDateRange(e,r),l=this.calculateTotalHours(o),u=this.calculateBillableHours(o),f=l-u,m=l>0?u/l*100:0,p=this.calculateProductivityScore(o),v=this.calculateAverageSessionLength(o),x=this.countUniqueSessions(o),S=this.getTopProjects(o,t),_=this.getTopClients(o,i),b=this.getDailyTrends(o,r),T=this.getWeeklyComparison(e,r),w=this.getProjectEfficiency(o,t);return{totalHours:l,billableHours:u,nonBillableHours:f,utilizationRate:m,productivityScore:p,averageSessionLength:v,totalSessions:x,topProjects:S,topClients:_,dailyTrends:b,weeklyComparison:T,projectEfficiency:w}}generateAdvancedCharts(e){return[{type:"doughnut",title:"Time Distribution",interactive:!0,drilldown:!0,data:{labels:["Billable Hours","Non-Billable Hours"],datasets:[{data:[e.billableHours,e.nonBillableHours],backgroundColor:["#10B981","#F59E0B"],borderWidth:0,hoverBorderWidth:2}]},options:{responsive:!0,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:t=>{const i=(t.parsed/e.totalHours*100).toFixed(1);return`${t.label}: ${t.parsed.toFixed(1)}h (${i}%)`}}}}}},{type:"line",title:"Daily Productivity Trends",interactive:!0,data:{labels:e.dailyTrends.map(t=>t.date),datasets:[{label:"Hours Tracked",data:e.dailyTrends.map(t=>t.hours),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4},{label:"Sessions",data:e.dailyTrends.map(t=>t.sessions),borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!1,yAxisID:"y1"}]},options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Hours"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Sessions"},grid:{drawOnChartArea:!1}}},plugins:{zoom:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0}},pan:{enabled:!0}}}}},{type:"bar",title:"Top Projects by Hours",interactive:!0,drilldown:!0,data:{labels:e.topProjects.map(t=>t.name),datasets:[{label:"Hours",data:e.topProjects.map(t=>t.hours),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#6366F1"],borderRadius:4}]},options:{responsive:!0,plugins:{tooltip:{callbacks:{afterLabel:t=>`${e.topProjects[t.dataIndex].percentage.toFixed(1)}% of total time`}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}},{type:"radar",title:"Project Efficiency Analysis",interactive:!0,data:{labels:e.projectEfficiency.map(t=>t.project),datasets:[{label:"Efficiency Score",data:e.projectEfficiency.map(t=>t.efficiency),backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"#3B82F6",pointBackgroundColor:"#3B82F6",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"#3B82F6"}]},options:{responsive:!0,scales:{r:{beginAtZero:!0,max:120,ticks:{stepSize:20,callback:t=>`${t}%`}}}}},{type:"bar",title:"Year-over-Year Comparison",interactive:!0,data:{labels:e.weeklyComparison.map(t=>t.week),datasets:[{label:"Current Year",data:e.weeklyComparison.map(t=>t.currentYear),backgroundColor:"#10B981"},{label:"Previous Year",data:e.weeklyComparison.map(t=>t.previousYear),backgroundColor:"#6B7280"}]},options:{responsive:!0,plugins:{tooltip:{callbacks:{afterBody:t=>{const i=t[0]?.parsed?.y||0,r=t[1]?.parsed?.y||0;return[`Change: ${r>0?((i-r)/r*100).toFixed(1):"N/A"}%`]}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}}]}async exportToExcel(e,t,i,r,o){return xR.exportReport(e,t,i,r,{includeCharts:o.includeCharts,includeSummary:!0,includeDetailedData:!0,includeTrends:!0,dateFormat:o.dateFormat||"Custom Range",reportTitle:"TimeBeacon Analytics Report",generatedBy:"TimeBeacon User"})}async exportToPDF(e,t,i){const r=this.generatePDFContent(e,t,i);return new Blob([r],{type:"text/html"})}subscribeToRealtimeUpdates(e,t=6e4){const i=setInterval(()=>{e({})},t);return()=>clearInterval(i)}scheduleReport(e){const t=crypto.randomUUID(),i=JSON.parse(localStorage.getItem("report_schedules")||"[]");return i.push({id:t,...e,createdAt:new Date().toISOString(),lastRun:null,nextRun:this.calculateNextRun(e.frequency,e.time)}),localStorage.setItem("report_schedules",JSON.stringify(i)),t}filterEntriesByDateRange(e,t){return e.filter(i=>{const r=new Date(i.date);return r>=t.start&&r<=t.end})}calculateTotalHours(e){return e.reduce((t,i)=>t+(i.duration||0),0)/60}calculateBillableHours(e){return e.filter(t=>t.billable).reduce((t,i)=>t+(i.duration||0),0)/60}calculateProductivityScore(e){const t=this.countUniqueSessions(e),i=this.calculateAverageSessionLength(e),r=this.calculateConsistencyScore(e),o=Math.min(t/8*100,100),l=Math.min(i/120*100,100),u=r*100;return o*.3+l*.4+u*.3}calculateAverageSessionLength(e){return e.length===0?0:e.reduce((i,r)=>i+(r.duration||0),0)/e.length}countUniqueSessions(e){const t=new Set;return e.forEach(i=>{const r=`${i.date}-${i.projectId}`;t.add(r)}),t.size}calculateConsistencyScore(e){const t=new Map;e.forEach(u=>{const f=u.date.split("T")[0],m=(u.duration||0)/60;t.set(f,(t.get(f)||0)+m)});const i=Array.from(t.values());if(i.length<2)return 1;const r=i.reduce((u,f)=>u+f,0)/i.length,o=i.reduce((u,f)=>u+Math.pow(f-r,2),0)/i.length,l=Math.sqrt(o);return Math.max(0,1-l/r)}getTopProjects(e,t){const i=new Map,r=this.calculateTotalHours(e);return e.forEach(o=>{const l=(o.duration||0)/60;i.set(o.projectId,(i.get(o.projectId)||0)+l)}),Array.from(i.entries()).map(([o,l])=>({name:t.find(f=>f.id===o)?.name||"Unknown Project",hours:l,percentage:l/r*100})).sort((o,l)=>l.hours-o.hours).slice(0,10)}getTopClients(e,t){const i=new Map;return e.forEach(r=>{if(r.clientId){const o=(r.duration||0)/60,l=o*(r.hourlyRate||0),u=i.get(r.clientId)||{hours:0,revenue:0};i.set(r.clientId,{hours:u.hours+o,revenue:u.revenue+l})}}),Array.from(i.entries()).map(([r,o])=>({name:t.find(u=>u.id===r)?.name||"Unknown Client",...o})).sort((r,o)=>o.hours-r.hours).slice(0,10)}getDailyTrends(e,t){const i=new Map,r=new Date(t.start);for(;r<=t.end;){const o=r.toISOString().split("T")[0];i.set(o,{hours:0,sessions:new Set}),r.setDate(r.getDate()+1)}return e.forEach(o=>{const l=o.date.split("T")[0],u=i.get(l);u&&(u.hours+=(o.duration||0)/60,u.sessions.add(`${o.projectId}-${o.startTime}`))}),Array.from(i.entries()).map(([o,l])=>({date:o,hours:l.hours,sessions:l.sessions.size})).sort((o,l)=>o.date.localeCompare(l.date))}getWeeklyComparison(e,t){return t.start.getFullYear(),[{week:"Week 1",currentYear:40,previousYear:35},{week:"Week 2",currentYear:42,previousYear:38},{week:"Week 3",currentYear:38,previousYear:40},{week:"Week 4",currentYear:45,previousYear:42}]}getProjectEfficiency(e,t){const i=new Map;return e.forEach(r=>{const o=(r.duration||0)/60;i.set(r.projectId,(i.get(r.projectId)||0)+o)}),Array.from(i.entries()).map(([r,o])=>{const l=t.find(m=>m.id===r),u=l?.estimatedHours||o*1.2,f=u>0?u/o*100:100;return{project:l?.name||"Unknown Project",plannedHours:u,actualHours:o,efficiency:Math.min(f,150)}}).slice(0,10)}generateSummarySheet(e){return[["Metric","Value"],["Total Hours",e.totalHours.toFixed(2)],["Billable Hours",e.billableHours.toFixed(2)],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`],["Productivity Score",`${e.productivityScore.toFixed(1)}%`],["Average Session Length",`${e.averageSessionLength.toFixed(1)} minutes`],["Total Sessions",e.totalSessions.toString()]]}generateDetailedSheet(e){const t=["Date","Project","Client","Description","Duration (hours)","Billable","Rate","Earnings"],i=e.map(r=>[r.date,r.projectId,r.clientId||"",r.description,((r.duration||0)/60).toFixed(2),r.billable?"Yes":"No",r.hourlyRate?.toFixed(2)||"",((r.duration||0)/60*(r.hourlyRate||0)).toFixed(2)]);return[t,...i]}generateChartsDataSheet(e){return[["Chart Type","Data"],["Top Projects",JSON.stringify(e.topProjects)],["Daily Trends",JSON.stringify(e.dailyTrends)],["Project Efficiency",JSON.stringify(e.projectEfficiency)]]}generateTrendsSheet(e){const t=["Date","Hours","Sessions"],i=e.dailyTrends.map(r=>[r.date,r.hours.toFixed(2),r.sessions.toString()]);return[t,...i]}generatePDFContent(e,t,i){return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>TimeBeacon Report</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; margin-bottom: 30px; }
          .metric { display: inline-block; margin: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
          .chart-container { margin: 20px 0; page-break-inside: avoid; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>TimeBeacon Analytics Report</h1>
          <p>Generated on ${new Date().toLocaleDateString()}</p>
        </div>
        
        <div class="metrics-summary">
          <div class="metric">
            <h3>Total Hours</h3>
            <p>${e.totalHours.toFixed(2)}</p>
          </div>
          <div class="metric">
            <h3>Utilization Rate</h3>
            <p>${e.utilizationRate.toFixed(1)}%</p>
          </div>
          <div class="metric">
            <h3>Productivity Score</h3>
            <p>${e.productivityScore.toFixed(1)}%</p>
          </div>
        </div>

        <div class="top-projects">
          <h2>Top Projects</h2>
          <table>
            <tr><th>Project</th><th>Hours</th><th>Percentage</th></tr>
            ${e.topProjects.map(r=>`<tr><td>${r.name}</td><td>${r.hours.toFixed(2)}</td><td>${r.percentage.toFixed(1)}%</td></tr>`).join("")}
          </table>
        </div>
      </body>
      </html>
    `}calculateNextRun(e,t){const i=new Date,r=new Date(i);switch(e){case"daily":r.setDate(i.getDate()+1);break;case"weekly":r.setDate(i.getDate()+7);break;case"monthly":r.setMonth(i.getMonth()+1);break}if(t){const[o,l]=t.split(":").map(Number);r.setHours(o,l,0,0)}return r}}const jd=new bR;lf.register(n5,r5,Ik,jk,Dk,xk,y5,Vk,Qk,Hk);const SR=()=>{const{user:n,checkPermission:e}=Vc(),{timeEntries:t,projects:i,clients:r}=eS(),[o,l]=W.useState({dateRange:{start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0],preset:"month"},selectedProjects:[],selectedClients:[],selectedTeamMembers:[],reportType:"overview"}),[u,f]=W.useState([]),[m,p]=W.useState(!1),[v,x]=W.useState("pdf"),S=W.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||n.role==="manager"||e("reports","read")),[n,e]);W.useEffect(()=>{if(S){const E=[{id:"user-1",visitorId:"10001",email:"john.doe@company.com",name:"John Doe",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Developer",department:"Engineering"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10002",email:"jane.smith@company.com",name:"Jane Smith",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Designer",department:"Design"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1}];f(E)}},[S,n]);const _=W.useMemo(()=>{let E=t;const I=new Date(o.dateRange.start),D=new Date(o.dateRange.end);return E=E.filter(z=>{const L=new Date(z.date);return L>=I&&L<=D}),o.selectedProjects.length>0&&(E=E.filter(z=>o.selectedProjects.includes(z.projectId))),o.selectedClients.length>0&&(E=E.filter(z=>z.clientId&&o.selectedClients.includes(z.clientId))),S&&o.selectedTeamMembers.length>0?E=E.filter(z=>o.selectedTeamMembers.includes(z.userId||n?.id||"")):S||(E=E.filter(z=>z.userId===n?.id)),E},[t,o,S,n]),b=W.useMemo(()=>{const E={start:new Date(o.dateRange.start),end:new Date(o.dateRange.end)};return jd.generateAdvancedMetrics(_,i,r,E)},[_,i,r,o.dateRange]),T=W.useMemo(()=>jd.generateAdvancedCharts(b),[b]),w=E=>{const I=new Date;let D=new Date,z=new Date;switch(E){case"today":D=new Date(I),z=new Date(I);break;case"week":D=new Date(I.getTime()-7*24*60*60*1e3);break;case"month":D=new Date(I.getFullYear(),I.getMonth(),1);break;case"quarter":const L=Math.floor(I.getMonth()/3);D=new Date(I.getFullYear(),L*3,1);break;case"year":D=new Date(I.getFullYear(),0,1);break;default:return}l(L=>({...L,dateRange:{start:D.toISOString().split("T")[0],end:z.toISOString().split("T")[0],preset:E}}))},A=async E=>{p(!0);try{let I,D;switch(E){case"pdf":I=await jd.exportToPDF(b,T,{format:"pdf",includeCharts:!0,template:"detailed"}),D=`timebeacon-report-${o.dateRange.start}-to-${o.dateRange.end}.pdf`;break;case"excel":I=await jd.exportToExcel(b,_,i,r,{format:"xlsx",includeCharts:!0,template:"detailed"}),D=`timebeacon-report-${o.dateRange.start}-to-${o.dateRange.end}.xlsx`;break;case"png":I=await C(),D=`timebeacon-charts-${o.dateRange.start}-to-${o.dateRange.end}.zip`;break;default:throw new Error("Unsupported export format")}const z=URL.createObjectURL(I),L=document.createElement("a");L.href=z,L.download=D,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(z)}catch(I){console.error("Export failed:",I),alert("Export failed. Please try again.")}finally{p(!1)}},C=async()=>{const E=JSON.stringify({message:"Chart images would be here"});return new Blob([E],{type:"application/json"})},N=(E,I)=>{const D={data:E.data,options:{...E.options,responsive:!0,maintainAspectRatio:!1}};switch(E.type){case"doughnut":return d.jsx(j5,{...D},I);case"line":return d.jsx(A5,{...D},I);case"bar":return d.jsx(k5,{...D},I);case"radar":return d.jsx(C5,{...D},I);default:return d.jsx("div",{children:"Unsupported chart type"},I)}};return d.jsxs("div",{className:"enhanced-reports",children:[d.jsxs("div",{className:"reports-header",children:[d.jsx("h1",{children:"Analytics & Reports"}),d.jsx("p",{children:"Comprehensive analytics and insights for your time tracking data"})]}),d.jsxs("div",{className:"reports-filters",children:[d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Date Range"}),d.jsx("div",{className:"date-presets",children:["today","week","month","quarter","year"].map(E=>d.jsx("button",{className:`preset-button ${o.dateRange.preset===E?"active":""}`,onClick:()=>w(E),children:E.charAt(0).toUpperCase()+E.slice(1)},E))}),d.jsxs("div",{className:"custom-date-range",children:[d.jsx("input",{type:"date",value:o.dateRange.start,onChange:E=>l(I=>({...I,dateRange:{...I.dateRange,start:E.target.value,preset:"custom"}}))}),d.jsx("span",{children:"to"}),d.jsx("input",{type:"date",value:o.dateRange.end,onChange:E=>l(I=>({...I,dateRange:{...I.dateRange,end:E.target.value,preset:"custom"}}))})]})]}),S&&u.length>0&&d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Team Members"}),d.jsxs("div",{className:"team-member-filters",children:[d.jsx("button",{className:`filter-button ${o.selectedTeamMembers.length===0?"active":""}`,onClick:()=>l(E=>({...E,selectedTeamMembers:[]})),children:"All Team Members"}),u.map(E=>d.jsxs("button",{className:`filter-button ${o.selectedTeamMembers.includes(E.id)?"active":""}`,onClick:()=>{l(I=>({...I,selectedTeamMembers:I.selectedTeamMembers.includes(E.id)?I.selectedTeamMembers.filter(D=>D!==E.id):[...I.selectedTeamMembers,E.id]}))},children:[E.name," (",E.profile?.jobTitle,")"]},E.id))]})]}),d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Projects"}),d.jsxs("div",{className:"project-filters",children:[d.jsx("button",{className:`filter-button ${o.selectedProjects.length===0?"active":""}`,onClick:()=>l(E=>({...E,selectedProjects:[]})),children:"All Projects"}),i.slice(0,8).map(E=>d.jsx("button",{className:`filter-button ${o.selectedProjects.includes(E.id)?"active":""}`,onClick:()=>{l(I=>({...I,selectedProjects:I.selectedProjects.includes(E.id)?I.selectedProjects.filter(D=>D!==E.id):[...I.selectedProjects,E.id]}))},children:E.name},E.id))]})]}),d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Export Reports"}),d.jsxs("div",{className:"export-controls",children:[d.jsxs("select",{value:v,onChange:E=>x(E.target.value),children:[d.jsx("option",{value:"pdf",children:"PDF Report"}),d.jsx("option",{value:"excel",children:"Excel Spreadsheet"}),d.jsx("option",{value:"png",children:"Chart Images"})]}),d.jsx("button",{className:"export-button",onClick:()=>A(v),disabled:m,children:m?"Exporting...":"Export"})]})]})]}),d.jsxs("div",{className:"summary-cards",children:[d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Total Hours"}),d.jsxs("div",{className:"metric-value",children:[b.totalHours.toFixed(1),"h"]}),d.jsxs("div",{className:"metric-subtitle",children:[b.billableHours.toFixed(1),"h billable"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Utilization"}),d.jsxs("div",{className:"metric-value",children:[b.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"metric-subtitle",children:b.utilizationRate>=75?"Excellent":b.utilizationRate>=50?"Good":"Needs Improvement"})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Productivity"}),d.jsxs("div",{className:"metric-value",children:[b.productivityScore.toFixed(1),"%"]}),d.jsxs("div",{className:"metric-subtitle",children:[b.totalSessions," sessions tracked"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Top Project"}),d.jsx("div",{className:"metric-value",children:b.topProjects[0]?.name||"No data"}),d.jsxs("div",{className:"metric-subtitle",children:[b.topProjects[0]?.hours.toFixed(1),"h logged"]})]})]}),d.jsx("div",{className:"charts-grid",children:T.map((E,I)=>d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{children:E.title}),d.jsx("div",{className:"chart-wrapper",children:N(E,I)})]},I))}),d.jsxs("div",{className:"data-table-section",children:[d.jsx("h3",{children:"Detailed Time Entries"}),d.jsxs("div",{className:"table-container",children:[d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Duration"}),d.jsx("th",{children:"Billable"}),S&&d.jsx("th",{children:"Team Member"}),d.jsx("th",{children:"Status"})]})}),d.jsx("tbody",{children:_.slice(0,50).map((E,I)=>d.jsxs("tr",{children:[d.jsx("td",{children:new Date(E.date).toLocaleDateString()}),d.jsx("td",{children:i.find(D=>D.id===E.projectId)?.name||"Unknown"}),d.jsx("td",{children:E.description}),d.jsxs("td",{children:[((E.duration||0)/60).toFixed(1),"h"]}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${E.billable?"billable":"non-billable"}`,children:E.billable?"Billable":"Non-billable"})}),S&&d.jsx("td",{children:u.find(D=>D.id===E.userId)?.name||"You"}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${E.status||"pending"}`,children:E.status||"pending"})})]},I))})]}),_.length>50&&d.jsx("div",{className:"table-footer",children:d.jsx("p",{children:"Showing first 50 entries. Export for complete data."})})]})]}),d.jsx("style",{jsx:!0,children:`
        .enhanced-reports {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }

        .reports-header {
          text-align: center;
          margin-bottom: 30px;
        }

        .reports-header h1 {
          font-size: 2.5rem;
          margin-bottom: 10px;
          color: #1f2937;
        }

        .reports-filters {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 30px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .filter-section {
          margin-bottom: 20px;
        }

        .filter-section h3 {
          margin-bottom: 10px;
          color: #374151;
          font-size: 1.1rem;
        }

        .date-presets, .team-member-filters, .project-filters {
          display: flex;
          gap: 8px;
          flex-wrap: wrap;
          margin-bottom: 10px;
        }

        .preset-button, .filter-button {
          padding: 8px 16px;
          border: 2px solid #e5e7eb;
          border-radius: 8px;
          background: white;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 0.9rem;
        }

        .preset-button:hover, .filter-button:hover {
          border-color: #3b82f6;
          background: #eff6ff;
        }

        .preset-button.active, .filter-button.active {
          background: #3b82f6;
          color: white;
          border-color: #3b82f6;
        }

        .custom-date-range {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-top: 10px;
        }

        .custom-date-range input {
          padding: 8px 12px;
          border: 1px solid #d1d5db;
          border-radius: 6px;
        }

        .export-controls {
          display: flex;
          gap: 10px;
          align-items: center;
        }

        .export-controls select {
          padding: 8px 12px;
          border: 1px solid #d1d5db;
          border-radius: 6px;
          background: white;
        }

        .export-button {
          padding: 8px 16px;
          background: #10b981;
          color: white;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          transition: background 0.2s;
        }

        .export-button:hover:not(:disabled) {
          background: #059669;
        }

        .export-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .summary-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .summary-card {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
          text-align: center;
        }

        .summary-card h3 {
          margin-bottom: 10px;
          color: #6b7280;
          font-size: 1rem;
        }

        .metric-value {
          font-size: 2rem;
          font-weight: bold;
          color: #1f2937;
          margin-bottom: 5px;
        }

        .metric-subtitle {
          color: #6b7280;
          font-size: 0.9rem;
        }

        .charts-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .chart-container {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .chart-container h3 {
          margin-bottom: 15px;
          color: #374151;
          text-align: center;
        }

        .chart-wrapper {
          height: 300px;
          position: relative;
        }

        .data-table-section {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .table-container {
          overflow-x: auto;
        }

        .data-table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
        }

        .data-table th,
        .data-table td {
          padding: 12px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .data-table th {
          background: #f9fafb;
          font-weight: 600;
          color: #374151;
        }

        .data-table tr:hover {
          background: #f9fafb;
        }

        .status-badge {
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 0.8rem;
          font-weight: 500;
        }

        .status-badge.billable {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.non-billable {
          background: #fef3c7;
          color: #92400e;
        }

        .status-badge.pending {
          background: #e0e7ff;
          color: #3730a3;
        }

        .status-badge.approved {
          background: #d1fae5;
          color: #065f46;
        }

        .table-footer {
          text-align: center;
          margin-top: 15px;
          color: #6b7280;
          font-style: italic;
        }

        @media (max-width: 768px) {
          .charts-grid {
            grid-template-columns: 1fr;
          }
          
          .summary-cards {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          }
          
          .date-presets, .team-member-filters, .project-filters {
            flex-direction: column;
          }
        }
      `})]})},_R=()=>{const{user:n,checkPermission:e}=Vc(),[t,i]=W.useState([]),[r,o]=W.useState(null),[l,u]=W.useState([]),[f,m]=W.useState([]),[p,v]=W.useState(!0),[x,S]=W.useState("roles"),_=W.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||e("users","manage")),[n,e]),b=W.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||n.role==="manager"||e("teams","manage")),[n,e]);W.useEffect(()=>{(_||b)&&T()},[_,b]);const T=async()=>{v(!0);try{const N=[{id:"user-1",visitorId:"10001",email:"john.doe@company.com",name:"John Doe",companyId:n?.companyId||"",role:"individual_contributor",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Senior Developer",department:"Engineering",manager:n?.id,accessLevel:"senior"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10002",email:"jane.smith@company.com",name:"Jane Smith",companyId:n?.companyId||"",role:"manager",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Engineering Manager",department:"Engineering",directReports:["user-1","user-3"],accessLevel:"elevated"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!0},{id:"user-3",visitorId:"10003",email:"mike.wilson@company.com",name:"Mike Wilson",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"Mike",lastName:"Wilson",jobTitle:"Junior Developer",department:"Engineering",manager:"user-2",accessLevel:"basic"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1}];i(N);const E=[{userId:"user-1",managerId:n?.id||"",department:"Engineering",startDate:"2024-01-01"},{userId:"user-3",managerId:"user-2",department:"Engineering",startDate:"2024-02-01"}];u(E);const I=[{id:"1",userId:"user-1",action:"granted",permission:"Project Lead Access",grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:"Promoted to Senior Developer"},{id:"2",userId:"user-2",action:"granted",permission:"Team Management",grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:"Assigned as Engineering Manager"}];m(I)}catch(N){console.error("Failed to load permissions data:",N)}finally{v(!1)}},w=async(N,E,I)=>{if(_)try{const D=t.find(H=>H.id===N);if(!D)return;const z={...D,role:E};i(H=>H.map(K=>K.id===N?z:K));const L={id:Date.now().toString(),userId:N,action:"modified",permission:`Role changed to ${Oo[E].title}`,grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:I};m(H=>[L,...H]),console.log(`✅ Updated ${D.name} role to ${E}`)}catch(D){console.error("Failed to update user role:",D)}},A=N=>[...cb[N.role]||[],...N.permissions],C=W.useMemo(()=>n?n.role==="owner"||n.role==="admin"?t:n.role==="manager"?t.filter(N=>N.profile?.manager===n.id):[]:[],[t,n]);return!_&&!b?d.jsx("div",{className:"permissions-manager",children:d.jsxs("div",{className:"access-denied",children:[d.jsx("h2",{children:"Access Denied"}),d.jsx("p",{children:"You don't have permission to manage user roles and permissions."})]})}):p?d.jsxs("div",{className:"permissions-manager loading",children:[d.jsx("div",{className:"loading-spinner"}),d.jsx("p",{children:"Loading permissions data..."})]}):d.jsxs("div",{className:"permissions-manager",children:[d.jsxs("div",{className:"permissions-header",children:[d.jsx("h1",{children:"Permissions & Team Management"}),d.jsx("p",{children:"Manage user roles, permissions, and team assignments"})]}),d.jsxs("div",{className:"permissions-tabs",children:[d.jsx("button",{className:`tab ${x==="roles"?"active":""}`,onClick:()=>S("roles"),children:"Roles & Users"}),d.jsx("button",{className:`tab ${x==="permissions"?"active":""}`,onClick:()=>S("permissions"),children:"Permissions"}),b&&d.jsx("button",{className:`tab ${x==="teams"?"active":""}`,onClick:()=>S("teams"),children:"Team Management"}),d.jsx("button",{className:`tab ${x==="audit"?"active":""}`,onClick:()=>S("audit"),children:"Audit Log"})]}),x==="roles"&&d.jsxs("div",{className:"roles-section",children:[d.jsx("h2",{children:"User Roles"}),d.jsxs("div",{className:"role-hierarchy",children:[d.jsx("h3",{children:"Role Hierarchy"}),d.jsx("div",{className:"role-cards",children:Object.entries(Oo).sort(([,N],[,E])=>E.level-N.level).map(([N,E])=>d.jsxs("div",{className:"role-card",children:[d.jsx("div",{className:"role-title",children:E.title}),d.jsxs("div",{className:"role-level",children:["Level ",E.level]}),d.jsx("div",{className:"role-description",children:E.description}),d.jsxs("div",{className:"role-count",children:[t.filter(I=>I.role===N).length," users"]})]},N))})]}),d.jsxs("div",{className:"users-list",children:[d.jsx("h3",{children:"Manage Users"}),d.jsx("div",{className:"users-table",children:d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Name"}),d.jsx("th",{children:"Email"}),d.jsx("th",{children:"Current Role"}),d.jsx("th",{children:"Department"}),d.jsx("th",{children:"Manager"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:C.map(N=>d.jsxs("tr",{children:[d.jsx("td",{children:d.jsxs("div",{className:"user-info",children:[d.jsx("strong",{children:N.name}),d.jsx("div",{className:"user-title",children:N.profile?.jobTitle})]})}),d.jsx("td",{children:N.email}),d.jsx("td",{children:d.jsx("span",{className:`role-badge ${N.role}`,children:Oo[N.role].title})}),d.jsx("td",{children:N.profile?.department||"Unassigned"}),d.jsx("td",{children:N.profile?.manager?t.find(E=>E.id===N.profile?.manager)?.name||"Unknown":"None"}),d.jsx("td",{children:d.jsxs("div",{className:"user-actions",children:[d.jsx("select",{value:N.role,onChange:E=>w(N.id,E.target.value,"Role change via admin panel"),disabled:!_,children:Object.entries(Oo).map(([E,I])=>d.jsx("option",{value:E,children:I.title},E))}),d.jsx("button",{className:"btn btn-sm",onClick:()=>o(N),children:"Details"})]})})]},N.id))})]})})]})]}),x==="permissions"&&d.jsxs("div",{className:"permissions-section",children:[d.jsx("h2",{children:"Detailed Permissions"}),r?d.jsxs("div",{className:"user-permissions",children:[d.jsxs("h3",{children:["Permissions for ",r.name]}),d.jsx("div",{className:"permission-categories",children:Object.entries(A(r).reduce((N,E)=>(N[E.resource]||(N[E.resource]=[]),N[E.resource].push(E),N),{})).map(([N,E])=>d.jsxs("div",{className:"permission-category",children:[d.jsx("h4",{children:N.charAt(0).toUpperCase()+N.slice(1)}),d.jsx("div",{className:"permission-actions",children:E.map((I,D)=>d.jsxs("div",{className:"permission-item",children:[d.jsx("div",{className:"permission-actions-list",children:I.actions.map(z=>d.jsx("span",{className:"action-badge",children:z},z))}),I.scope&&d.jsxs("div",{className:"permission-scope",children:["Scope: ",I.scope.all?"All":I.scope.own?"Own Data Only":I.scope.team?"Team Members":I.scope.department?"Department":"Limited"]})]},D))})]},N))}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>o(null),children:"Back to Users"})]}):d.jsx("div",{className:"select-user",children:d.jsx("p",{children:"Select a user from the Roles tab to view their detailed permissions."})})]}),x==="teams"&&b&&d.jsxs("div",{className:"teams-section",children:[d.jsx("h2",{children:"Team Assignments"}),d.jsxs("div",{className:"team-structure",children:[d.jsx("h3",{children:"Organizational Structure"}),d.jsx("div",{className:"org-chart",children:t.filter(N=>N.role==="manager"||N.role==="admin"||N.role==="owner").map(N=>d.jsxs("div",{className:"manager-group",children:[d.jsxs("div",{className:"manager-card",children:[d.jsx("h4",{children:N.name}),d.jsx("div",{className:"manager-role",children:Oo[N.role].title}),d.jsx("div",{className:"manager-department",children:N.profile?.department})]}),d.jsx("div",{className:"direct-reports",children:t.filter(E=>E.profile?.manager===N.id).map(E=>d.jsxs("div",{className:"report-card",children:[d.jsx("div",{className:"report-name",children:E.name}),d.jsx("div",{className:"report-role",children:Oo[E.role].title}),d.jsx("div",{className:"report-title",children:E.profile?.jobTitle})]},E.id))})]},N.id))})]}),d.jsxs("div",{className:"team-assignments",children:[d.jsx("h3",{children:"Team Assignments"}),d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Team Member"}),d.jsx("th",{children:"Manager"}),d.jsx("th",{children:"Department"}),d.jsx("th",{children:"Start Date"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:l.map(N=>{const E=t.find(D=>D.id===N.userId),I=t.find(D=>D.id===N.managerId);return d.jsxs("tr",{children:[d.jsx("td",{children:E?.name||"Unknown"}),d.jsx("td",{children:I?.name||"Unknown"}),d.jsx("td",{children:N.department}),d.jsx("td",{children:new Date(N.startDate).toLocaleDateString()}),d.jsx("td",{children:d.jsx("button",{className:"btn btn-sm btn-secondary",children:"Reassign"})})]},N.userId)})})]})]})]}),x==="audit"&&d.jsxs("div",{className:"audit-section",children:[d.jsx("h2",{children:"Permission Audit Log"}),d.jsx("div",{className:"audit-log",children:f.map(N=>d.jsxs("div",{className:"audit-entry",children:[d.jsxs("div",{className:"audit-header",children:[d.jsx("span",{className:`audit-action ${N.action}`,children:N.action.charAt(0).toUpperCase()+N.action.slice(1)}),d.jsx("span",{className:"audit-timestamp",children:new Date(N.timestamp).toLocaleString()})]}),d.jsxs("div",{className:"audit-details",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"User:"})," ",t.find(E=>E.id===N.userId)?.name||"Unknown"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Permission:"})," ",N.permission]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Changed by:"})," ",t.find(E=>E.id===N.grantedBy)?.name||"System"]}),N.reason&&d.jsxs("div",{children:[d.jsx("strong",{children:"Reason:"})," ",N.reason]})]})]},N.id))})]}),d.jsx("style",{jsx:!0,children:`
        .permissions-manager {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }

        .permissions-header {
          text-align: center;
          margin-bottom: 30px;
        }

        .permissions-header h1 {
          font-size: 2.5rem;
          margin-bottom: 10px;
          color: #1f2937;
        }

        .permissions-tabs {
          display: flex;
          border-bottom: 2px solid #e5e7eb;
          margin-bottom: 30px;
        }

        .tab {
          padding: 12px 24px;
          border: none;
          background: none;
          cursor: pointer;
          border-bottom: 3px solid transparent;
          font-weight: 500;
          transition: all 0.2s;
        }

        .tab:hover {
          background: #f3f4f6;
        }

        .tab.active {
          border-bottom-color: #3b82f6;
          color: #3b82f6;
        }

        .role-hierarchy {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 30px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .role-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 15px;
        }

        .role-card {
          border: 2px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
          text-align: center;
          transition: all 0.2s;
        }

        .role-card:hover {
          border-color: #3b82f6;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }

        .role-title {
          font-size: 1.1rem;
          font-weight: 600;
          margin-bottom: 5px;
        }

        .role-level {
          font-size: 0.9rem;
          color: #6b7280;
          margin-bottom: 8px;
        }

        .role-description {
          font-size: 0.85rem;
          color: #374151;
          margin-bottom: 8px;
          line-height: 1.4;
        }

        .role-count {
          font-size: 0.8rem;
          color: #059669;
          font-weight: 500;
        }

        .users-list {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .users-table {
          overflow-x: auto;
        }

        .users-table table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
        }

        .users-table th,
        .users-table td {
          padding: 12px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f9fafb;
          font-weight: 600;
          color: #374151;
        }

        .user-info strong {
          display: block;
          margin-bottom: 4px;
        }

        .user-title {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 0.8rem;
          font-weight: 500;
        }

        .role-badge.owner { background: #fef3c7; color: #92400e; }
        .role-badge.admin { background: #ddd6fe; color: #5b21b6; }
        .role-badge.manager { background: #d1fae5; color: #065f46; }
        .role-badge.individual_contributor { background: #e0e7ff; color: #3730a3; }
        .role-badge.employee { background: #e5e7eb; color: #374151; }
        .role-badge.viewer { background: #f3f4f6; color: #6b7280; }

        .user-actions {
          display: flex;
          gap: 8px;
          align-items: center;
        }

        .user-actions select {
          padding: 4px 8px;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 0.8rem;
        }

        .btn {
          padding: 8px 16px;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          font-weight: 500;
          transition: all 0.2s;
        }

        .btn-sm {
          padding: 4px 8px;
          font-size: 0.8rem;
        }

        .btn-secondary {
          background: #6b7280;
          color: white;
        }

        .btn-secondary:hover {
          background: #4b5563;
        }

        .permission-categories {
          display: grid;
          gap: 20px;
        }

        .permission-category {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .permission-category h4 {
          margin-bottom: 10px;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
          padding-bottom: 5px;
        }

        .permission-item {
          margin-bottom: 10px;
        }

        .permission-actions-list {
          display: flex;
          gap: 6px;
          flex-wrap: wrap;
          margin-bottom: 5px;
        }

        .action-badge {
          padding: 2px 6px;
          background: #3b82f6;
          color: white;
          border-radius: 4px;
          font-size: 0.7rem;
        }

        .permission-scope {
          font-size: 0.8rem;
          color: #6b7280;
          font-style: italic;
        }

        .org-chart {
          display: flex;
          flex-direction: column;
          gap: 20px;
        }

        .manager-group {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .manager-card {
          background: #f8fafc;
          border-radius: 6px;
          padding: 12px;
          margin-bottom: 15px;
        }

        .manager-card h4 {
          margin-bottom: 5px;
        }

        .manager-role, .manager-department {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .direct-reports {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
          gap: 10px;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 10px;
        }

        .report-name {
          font-weight: 500;
          margin-bottom: 4px;
        }

        .report-role, .report-title {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .audit-log {
          display: flex;
          flex-direction: column;
          gap: 15px;
        }

        .audit-entry {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .audit-header {
          display: flex;
          justify-content: between;
          align-items: center;
          margin-bottom: 10px;
        }

        .audit-action {
          font-weight: 600;
          margin-right: 10px;
        }

        .audit-action.granted { color: #059669; }
        .audit-action.revoked { color: #dc2626; }
        .audit-action.modified { color: #d97706; }

        .audit-timestamp {
          font-size: 0.8rem;
          color: #6b7280;
          margin-left: auto;
        }

        .audit-details {
          display: grid;
          gap: 4px;
          font-size: 0.9rem;
        }

        .access-denied, .select-user {
          text-align: center;
          padding: 40px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .loading {
          text-align: center;
          padding: 40px;
        }

        .loading-spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top: 4px solid #3b82f6;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin: 0 auto 20px;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .role-cards {
            grid-template-columns: 1fr;
          }
          
          .permissions-tabs {
            flex-wrap: wrap;
          }
          
          .direct-reports {
            grid-template-columns: 1fr;
          }
        }
      `})]})},Gx={profile:{name:"",email:"",company:"",jobTitle:"",phone:""},workingHours:{startTime:"09:00",endTime:"17:00",timezone:"America/New_York"},notifications:{browser:!1,email:!1,slack:!1,autoBreaks:!1}},TR=()=>{const[n,e]=W.useState(Gx),[t,i]=W.useState("idle");W.useEffect(()=>{try{const p=localStorage.getItem("timebeacon_settings_new");if(p){const v=JSON.parse(p);e({...Gx,...v})}}catch(p){console.error("Failed to load settings:",p)}},[]);const r=p=>{try{i("saving"),localStorage.setItem("timebeacon_settings_new",JSON.stringify(p)),e(p),i("saved"),setTimeout(()=>i("idle"),2e3),console.log("✅ Settings saved successfully")}catch(v){console.error("❌ Failed to save settings:",v),i("error"),setTimeout(()=>i("idle"),3e3)}},o=(p,v)=>{const x={...n,profile:{...n.profile,[p]:v}};r(x)},l=(p,v)=>{const x={...n,workingHours:{...n.workingHours,[p]:v}};r(x)},u=(p,v)=>{const x={...n,notifications:{...n.notifications,[p]:v}};r(x)},f=()=>{try{const p=JSON.parse(localStorage.getItem("timebeacon_entries_v6")||"[]");if(p.length===0){alert("No time entries found to export.");return}const v=["Date,Start Time,End Time,Duration (hrs),Project,Client,Description,Billable",...p.map(b=>`"${b.date}","${b.startTime}","${b.endTime}",${b.duration},"${b.project}","${b.client}","${b.description}",${b.billable?"Yes":"No"}`)].join("\\n"),x=new Blob([v],{type:"text/csv"}),S=URL.createObjectURL(x),_=document.createElement("a");_.href=S,_.download=`timebeacon-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(S),alert(`Successfully exported ${p.length} time entries!`)}catch(p){console.error("Export failed:",p),alert("Export failed. Please try again.")}},m=()=>{switch(t){case"saving":return"💾 Saving...";case"saved":return"✅ Saved";case"error":return"❌ Save failed";default:return""}};return d.jsxs("div",{children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsx("h1",{className:"dashboard-title",children:"Settings"}),d.jsx("p",{className:"dashboard-subtitle",children:"Configure your TimeBeacon preferences"}),t!=="idle"&&d.jsx("div",{style:{marginTop:"12px",padding:"8px 16px",borderRadius:"4px",fontSize:"14px",fontWeight:"500",backgroundColor:t==="saved"?"#f0f9ff":t==="error"?"#fef2f2":"#f9fafb",color:t==="saved"?"#0369a1":t==="error"?"#dc2626":"#6b7280"},children:m()})]}),d.jsxs("div",{style:{display:"grid",gap:"24px",maxWidth:"800px"},children:[d.jsxs("div",{className:"content-card",children:[d.jsx("div",{className:"card-header",children:d.jsx("h2",{className:"card-title",children:"Profile Information"})}),d.jsxs("div",{style:{padding:"24px"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"Full Name"}),d.jsx("input",{type:"text",value:n.profile.name,onChange:p=>o("name",p.target.value),placeholder:"Enter your full name",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db"})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"Email Address"}),d.jsx("input",{type:"email",value:n.profile.email,onChange:p=>o("email",p.target.value),placeholder:"Enter your email",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db"})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"Company"}),d.jsx("input",{type:"text",value:n.profile.company,onChange:p=>o("company",p.target.value),placeholder:"Enter your company",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db"})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"Job Title"}),d.jsx("input",{type:"text",value:n.profile.jobTitle,onChange:p=>o("jobTitle",p.target.value),placeholder:"Enter your job title",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"Phone Number"}),d.jsx("input",{type:"tel",value:n.profile.phone,onChange:p=>o("phone",p.target.value),placeholder:"Enter your phone number",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db"})]})]})]}),d.jsxs("div",{className:"content-card",children:[d.jsx("div",{className:"card-header",children:d.jsx("h2",{className:"card-title",children:"Working Hours"})}),d.jsxs("div",{style:{padding:"24px"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"Start Time"}),d.jsx("input",{type:"time",value:n.workingHours.startTime,onChange:p=>l("startTime",p.target.value),style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db"})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"End Time"}),d.jsx("input",{type:"time",value:n.workingHours.endTime,onChange:p=>l("endTime",p.target.value),style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{display:"block",marginBottom:"6px",fontWeight:"500",color:"#374151"},children:"Timezone"}),d.jsxs("select",{value:n.workingHours.timezone,onChange:p=>l("timezone",p.target.value),style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",backgroundColor:"white",transition:"border-color 0.2s",outline:"none"},onFocus:p=>p.target.style.borderColor="#3b82f6",onBlur:p=>p.target.style.borderColor="#d1d5db",children:[d.jsx("option",{value:"America/New_York",children:"Eastern Time (EST/EDT)"}),d.jsx("option",{value:"America/Chicago",children:"Central Time (CST/CDT)"}),d.jsx("option",{value:"America/Denver",children:"Mountain Time (MST/MDT)"}),d.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PST/PDT)"}),d.jsx("option",{value:"UTC",children:"UTC"})]})]})]})]}),d.jsxs("div",{className:"content-card",children:[d.jsx("div",{className:"card-header",children:d.jsx("h2",{className:"card-title",children:"Notifications"})}),d.jsx("div",{style:{padding:"24px"},children:d.jsxs("div",{style:{display:"grid",gap:"20px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",padding:"12px",borderRadius:"6px",transition:"background-color 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:p=>p.currentTarget.style.backgroundColor="transparent",children:[d.jsx("input",{type:"checkbox",checked:n.notifications.browser,onChange:p=>u("browser",p.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"500",color:"#374151"},children:"Browser Notifications"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Get notified in your browser for time tracking reminders"})]})]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",padding:"12px",borderRadius:"6px",transition:"background-color 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:p=>p.currentTarget.style.backgroundColor="transparent",children:[d.jsx("input",{type:"checkbox",checked:n.notifications.email,onChange:p=>u("email",p.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"500",color:"#374151"},children:"Email Notifications"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Receive daily summaries and approval reminders via email"})]})]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",padding:"12px",borderRadius:"6px",transition:"background-color 0.2s",border:n.notifications.slack?"2px solid #3b82f6":"2px solid transparent"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:p=>p.currentTarget.style.backgroundColor="transparent",children:[d.jsx("input",{type:"checkbox",checked:n.notifications.slack,onChange:p=>u("slack",p.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontWeight:"500",color:"#374151"},children:["Slack Notifications",n.notifications.slack&&d.jsx("span",{style:{color:"#3b82f6",marginLeft:"8px"},children:"✓ Enabled"})]}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Send time tracking updates and reminders to Slack"})]})]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",padding:"12px",borderRadius:"6px",transition:"background-color 0.2s"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:p=>p.currentTarget.style.backgroundColor="transparent",children:[d.jsx("input",{type:"checkbox",checked:n.notifications.autoBreaks,onChange:p=>u("autoBreaks",p.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"500",color:"#374151"},children:"Automatic Break Detection"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Automatically detect and suggest breaks during long work sessions"})]})]})]})})]}),d.jsxs("div",{className:"content-card",children:[d.jsx("div",{className:"card-header",children:d.jsx("h2",{className:"card-title",children:"Export & Tools"})}),d.jsx("div",{style:{padding:"24px"},children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px"},children:[d.jsxs("button",{onClick:f,style:{padding:"20px",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",transition:"all 0.2s",textAlign:"center"},onMouseEnter:p=>{p.currentTarget.style.borderColor="#3b82f6",p.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.1)"},onMouseLeave:p=>{p.currentTarget.style.borderColor="#d1d5db",p.currentTarget.style.boxShadow="none"},children:[d.jsx("div",{style:{fontSize:"32px"},children:"📊"}),d.jsx("div",{style:{fontWeight:"600",color:"#374151"},children:"Export to CSV"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Download all your time entries as a CSV file"})]}),d.jsxs("button",{onClick:()=>window.location.href="/integrations",style:{padding:"20px",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",transition:"all 0.2s",textAlign:"center"},onMouseEnter:p=>{p.currentTarget.style.borderColor="#3b82f6",p.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.1)"},onMouseLeave:p=>{p.currentTarget.style.borderColor="#d1d5db",p.currentTarget.style.boxShadow="none"},children:[d.jsx("div",{style:{fontSize:"32px"},children:"🔗"}),d.jsx("div",{style:{fontWeight:"600",color:"#374151"},children:"Integrations"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Connect with external tools and services"})]})]})})]})]})]})};class wR{accessToken=null;refreshToken=null;API_BASE_URL="http://localhost:3001";demoMode=!1;constructor(){this.loadStoredTokens()}loadStoredTokens(){try{const e=localStorage.getItem("google_tokens");if(e){const t=JSON.parse(e);this.accessToken=t.access_token,this.refreshToken=t.refresh_token,t.expiry_date&&Date.now()>t.expiry_date&&this.refreshAccessToken()}}catch(e){console.error("Error loading stored tokens:",e)}}async refreshAccessToken(){if(!this.refreshToken)return!1;try{const t=await(await fetch(`${this.API_BASE_URL}/auth/google/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:this.refreshToken})})).json();if(t.success)return this.accessToken=t.tokens.access_token,this.saveTokens({access_token:t.tokens.access_token,refresh_token:this.refreshToken,expiry_date:t.tokens.expiry_date}),!0}catch(e){console.error("Error refreshing token:",e)}return!1}saveTokens(e){try{localStorage.setItem("google_tokens",JSON.stringify(e))}catch(t){console.error("Error saving tokens:",t)}}async authenticateGoogle(){try{if(this.demoMode)return console.log("Demo mode: Simulating Google authentication"),this.accessToken="demo-token",localStorage.setItem("google_demo_token","demo-token"),await new Promise(e=>setTimeout(e,1e3)),!0;try{const t=await(await fetch(`${this.API_BASE_URL}/auth/google/url`)).json();if(!t.authUrl)throw new Error("Failed to get OAuth URL");const i=window.open(t.authUrl,"google-oauth","width=500,height=600,scrollbars=yes,resizable=yes");return new Promise(r=>{const o=setInterval(()=>{if(i?.closed){clearInterval(o);const l=localStorage.getItem("google_tokens");if(l){const u=JSON.parse(l);this.accessToken=u.access_token,this.refreshToken=u.refresh_token,r(!0)}else r(!1)}},1e3);setTimeout(()=>{clearInterval(o),i&&!i.closed&&i.close(),r(!1)},3e5)})}catch(e){return console.error("API authentication failed, falling back to demo mode:",e),this.accessToken="demo-token",localStorage.setItem("google_demo_token","demo-token"),!0}}catch(e){return console.error("Google authentication failed:",e),this.accessToken="demo-token",localStorage.setItem("google_demo_token","demo-token"),!0}}async isAuthenticated(){if(!this.accessToken){const e=localStorage.getItem("google_demo_token");return e?(this.accessToken=e,!0):!1}return this.accessToken==="demo-token"||this.demoMode,!0}async getGmailMessages(e=10){if(!this.accessToken)throw new Error("Not authenticated");if(this.accessToken==="demo-token"||this.demoMode)return[{id:"demo1",payload:{headers:[{name:"Subject",value:"Project Update - Q4 Deliverables"},{name:"From",value:"John Smith <john@salesforce.com>"},{name:"Date",value:new Date().toISOString()}]},snippet:"Project update and next steps for the Q4 deliverables..."},{id:"demo2",payload:{headers:[{name:"Subject",value:"Follow-up: Client Strategy Meeting"},{name:"From",value:"Sarah Johnson <sarah@hubspot.com>"},{name:"Date",value:new Date(Date.now()-36e5).toISOString()}]},snippet:"Meeting follow-up and action items from client call..."}];try{return(await(await fetch(`${this.API_BASE_URL}/gmail/messages?access_token=${this.accessToken}&maxResults=${e}`)).json()).messages||[]}catch(t){return console.error("Failed to fetch Gmail messages:",t),[]}}async getCalendarEvents(){if(!this.accessToken)throw new Error("Not authenticated");if(this.accessToken==="demo-token"||this.demoMode)return[{id:"demo-event-1",summary:"Client Strategy Meeting",start:{dateTime:new Date().toISOString()},end:{dateTime:new Date(Date.now()+36e5).toISOString()},attendees:[{email:"client@company.com",displayName:"Client Name"}]},{id:"demo-event-2",summary:"Project Review",start:{dateTime:new Date(Date.now()+72e5).toISOString()},end:{dateTime:new Date(Date.now()+108e5).toISOString()},creator:{email:"team@company.com",displayName:"Team Lead"}}];try{return(await(await fetch(`${this.API_BASE_URL}/calendar/events?access_token=${this.accessToken}`)).json()).events||[]}catch(e){return console.error("Failed to fetch calendar events:",e),[]}}async getDriveFiles(e){if(!this.accessToken)throw new Error("Not authenticated");if(this.accessToken==="demo-token"||this.demoMode)return{docs:[{id:"demo-doc-1",name:"Client Proposal - Q4 2024",modifiedTime:new Date().toISOString(),lastModifyingUser:{displayName:"You",emailAddress:"you@company.com"},webViewLink:"https://docs.google.com/document/d/demo-doc-1"}],sheets:[{id:"demo-sheet-1",name:"Project Timeline & Budget",modifiedTime:new Date(Date.now()-18e5).toISOString(),lastModifyingUser:{displayName:"Team Member",emailAddress:"team@company.com"},webViewLink:"https://docs.google.com/spreadsheets/d/demo-sheet-1"}],slides:[{id:"demo-slides-1",name:"Client Presentation - Strategy Overview",modifiedTime:new Date(Date.now()-36e5).toISOString(),lastModifyingUser:{displayName:"You",emailAddress:"you@company.com"},webViewLink:"https://docs.google.com/presentation/d/demo-slides-1"}]}[e]||[];try{return(await(await fetch(`${this.API_BASE_URL}/drive/files?access_token=${this.accessToken}&type=${e}`)).json()).files||[]}catch(t){return console.error(`Failed to fetch ${e} files:`,t),[]}}async trackActivity(e,t,i){if(i<.05)return;const r={date:new Date().toISOString().split("T")[0],startTime:new Date(Date.now()-i*60*60*1e3).toTimeString().slice(0,5),endTime:new Date().toTimeString().slice(0,5),duration:i,description:this.generateDescription(e,t),category:this.categorizeActivity(e,t),automated:!0,source:e,billable:this.shouldBeBillable(t),client:this.inferClient(t),project:this.inferProject(t)};await this.createTimeEntry(r)}generateDescription(e,t){switch(e){case"gmail":return`Email: ${t.subject||"Email Activity"}`;case"calendar":return`Meeting: ${t.summary||"Calendar Event"}`;case"docs":return`Document: ${t.name||"Google Doc"}`;case"sheets":return`Spreadsheet: ${t.name||"Google Sheet"}`;case"slides":return`Presentation: ${t.name||"Google Slides"}`;default:return`${e} activity`}}categorizeActivity(e,t){return{gmail:"communication",calendar:"meeting",docs:"documentation",sheets:"analysis",slides:"presentation"}[e]||"productivity"}shouldBeBillable(e){const t=["client","project","meeting","proposal","deliverable"],i=JSON.stringify(e).toLowerCase();return t.some(r=>i.includes(r))}inferClient(e){const t=JSON.stringify(e).toLowerCase();return t.includes("salesforce")?"Salesforce":t.includes("hubspot")?"HubSpot":t.includes("zendesk")?"Zendesk":"Unknown Client"}inferProject(e){const t=JSON.stringify(e).toLowerCase();return t.includes("implementation")?"Implementation Project":t.includes("strategy")?"Strategy Consulting":t.includes("review")?"Project Review":"General Work"}async createTimeEntry(e){console.log("Creating time entry from Google activity:",e);const t=JSON.parse(localStorage.getItem("timeEntries")||"[]"),i={...e,id:Date.now().toString(),status:"pending"};t.push(i),localStorage.setItem("timeEntries",JSON.stringify(t)),window.dispatchEvent(new CustomEvent("timeEntryCreated",{detail:i}))}disconnect(){this.accessToken=null,this.refreshToken=null,localStorage.removeItem("google_tokens"),localStorage.removeItem("google_demo_token")}}const Bo=new wR,ER={gmail:{name:"Gmail",icon:"📧",color:"#EA4335",features:["Email reading time detection","Automatic client identification","Smart project categorization","Billable time classification"]},calendar:{name:"Google Calendar",icon:"📅",color:"#4285F4",features:["Automatic meeting time tracking","Participant detection","Meeting type classification","Calendar block synchronization"]},docs:{name:"Google Docs",icon:"📝",color:"#4285F4",features:["Document editing time tracking","Collaboration time detection","Project document categorization","Client document identification"]},sheets:{name:"Google Sheets",icon:"📊",color:"#34A853",features:["Spreadsheet analysis time tracking","Data work categorization","Project sheet identification","Collaborative editing detection"]},slides:{name:"Google Slides",icon:"📈",color:"#FF6D01",features:["Presentation creation time tracking","Client presentation detection","Design work categorization","Collaboration time tracking"]}},AR=({service:n,onAuthSuccess:e,onAuthError:t})=>{const[i,r]=W.useState(!1),[o,l]=W.useState(!1),[u,f]=W.useState(0),m=ER[n];W.useEffect(()=>{p()},[]);const p=async()=>{try{const _=await Bo.isAuthenticated();l(_),_&&await v()}catch(_){console.error("Failed to check Google auth status:",_)}},v=async()=>{try{let _=0;switch(n){case"gmail":_=(await Bo.getGmailMessages(5)).length;break;case"calendar":_=(await Bo.getCalendarEvents()).length;break;case"docs":case"sheets":case"slides":_=(await Bo.getDriveFiles(n)).length;break}f(_)}catch(_){console.error(`Failed to load ${n} activity:`,_)}},x=async()=>{r(!0);try{await Bo.authenticateGoogle()?(l(!0),e(),await v()):t("Failed to authenticate with Google")}catch(_){t(`Authentication error: ${_}`)}finally{r(!1)}},S=()=>{Bo.disconnect(),l(!1),f(0)};return o?d.jsxs("div",{className:"google-auth-success",children:[d.jsxs("div",{className:"auth-status",children:[d.jsx("div",{className:"status-indicator connected"}),d.jsxs("div",{className:"status-info",children:[d.jsxs("h4",{children:[m.name," Connected"]}),d.jsx("p",{children:"Tracking activity automatically"}),d.jsxs("small",{children:[u," recent items processed"]})]})]}),d.jsx("div",{className:"auth-actions",children:d.jsx("button",{onClick:S,className:"btn btn-secondary btn-sm",children:"Disconnect"})}),d.jsxs("div",{className:"tracking-info",children:[d.jsx("h5",{children:"Active Tracking Features:"}),d.jsx("ul",{className:"feature-list",children:m.features.map((_,b)=>d.jsxs("li",{children:["✓ ",_]},b))})]}),d.jsxs("div",{className:"privacy-notice",children:[d.jsx("h5",{children:"🔒 Privacy & Security:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"✅ Read-only access only"}),d.jsx("li",{children:"✅ No content modification"}),d.jsx("li",{children:"✅ Encrypted data transmission"}),d.jsx("li",{children:"✅ You can disconnect anytime"})]})]})]}):d.jsxs("div",{className:"google-auth-setup",children:[d.jsxs("div",{className:"auth-header",children:[d.jsx("div",{className:"service-icon",style:{color:m.color},children:m.icon}),d.jsxs("div",{children:[d.jsxs("h4",{children:["Connect ",m.name]}),d.jsxs("p",{children:["Automatically track time spent on ",n==="gmail"?"email":n==="calendar"?"meetings":"documents"]})]})]}),d.jsxs("div",{className:"auth-benefits",children:[d.jsx("h5",{children:"Smart Tracking Features:"}),m.features.map((_,b)=>d.jsxs("div",{className:"benefit-item",children:[d.jsx("span",{className:"benefit-icon",children:"🎯"}),d.jsx("div",{children:_})]},b))]}),d.jsxs("div",{className:"auth-permissions",children:[d.jsx("h5",{children:"Required Permissions:"}),d.jsxs("ul",{children:[d.jsxs("li",{children:["Read ",n==="gmail"?"email headers and metadata":n==="calendar"?"calendar events and details":"document metadata and activity"]}),d.jsx("li",{children:"Access modification timestamps"}),d.jsx("li",{children:"No content reading or modification"})]})]}),d.jsx("button",{onClick:x,disabled:i,className:"btn btn-primary auth-button",style:{backgroundColor:m.color},children:i?"Connecting...":`Connect ${m.name}`}),d.jsx("div",{className:"privacy-note",children:d.jsxs("small",{children:["We only access metadata for time tracking. Your ",n==="gmail"?"email content":"document content","remains private and is never stored or transmitted."]})})]})},fc=[{id:"google-calendar",name:"Google Calendar",description:"Automatically create time entries from calendar meetings and events",icon:"📅",color:"#4285F4",category:"Calendar & Scheduling",status:"available",features:["Auto-import meetings as time entries","Detect meeting participants and duration","Categorize by meeting type","Sync calendar blocks as work time"],setupSteps:['Click "Connect Google Calendar" below',"Sign in to your Google account","Grant calendar read permissions","Configure automatic import settings"]},{id:"gmail",name:"Gmail",description:"Track time spent reading and writing emails with AI-powered categorization",icon:"📧",color:"#EA4335",category:"Communication",status:"available",features:["Automatic email reading time tracking","AI-powered client and project detection","Smart billable time classification","Real-time activity monitoring"],setupSteps:['Click "Connect Gmail" below',"Sign in to your Google account","Grant Gmail read permissions","Start automatic email tracking"]},{id:"slack",name:"Slack",description:"Track time spent in client channels, DMs, and meetings",icon:"💬",color:"#4A154B",category:"Communication",status:"coming-soon",features:["Track time in client channels","Detect client vs internal conversations","Log meeting time from Slack calls","Auto-categorize by workspace"]},{id:"zoom",name:"Zoom",description:"Auto-track meeting duration, participants, and context",icon:"🎥",color:"#2D8CFF",category:"Video Conferencing",status:"coming-soon",features:["Automatic meeting time tracking","Participant detection","Meeting recording integration","Client vs internal meeting classification"]},{id:"teams",name:"Microsoft Teams",description:"Track meetings, calls, and collaboration time in Teams",icon:"🟦",color:"#6264A7",category:"Video Conferencing",status:"coming-soon",features:["Meeting and call tracking","Channel activity monitoring","Integration with Office 365","Team collaboration time logging"]},{id:"github",name:"GitHub",description:"Track development time based on commits, PRs, and issues",icon:"⚫",color:"#24292e",category:"Development",status:"coming-soon",features:["Commit-based time tracking","Pull request review time","Issue resolution tracking","Repository activity monitoring"]},{id:"jira",name:"Jira",description:"Sync project tasks and track time against tickets",icon:"🔷",color:"#0052CC",category:"Project Management",status:"coming-soon",features:["Ticket-based time tracking","Project synchronization","Sprint time analysis","Automatic time logging from activity"]},{id:"asana",name:"Asana",description:"Connect tasks and projects for seamless time tracking",icon:"🔶",color:"#F06A6A",category:"Project Management",status:"coming-soon",features:["Task-based time entries","Project milestone tracking","Team collaboration insights","Automatic time allocation"]},{id:"notion",name:"Notion",description:"Track time spent on documents, projects, and databases",icon:"📝",color:"#000000",category:"Productivity",status:"coming-soon",features:["Document editing time tracking","Database activity monitoring","Project page time logging","Collaboration time insights"]}],kR=({integrations:n,onToggleIntegration:e})=>{const[t,i]=W.useState("all"),[r,o]=W.useState(null),l=["all",...Array.from(new Set(fc.map(v=>v.category)))],u=t==="all"?fc:fc.filter(v=>v.category===t),f=v=>{switch(v){case"connected":return d.jsx("span",{className:"status-badge connected",children:"✅ Connected"});case"error":return d.jsx("span",{className:"status-badge error",children:"❌ Error"});case"available":return d.jsx("span",{className:"status-badge available",children:"🔗 Available"});case"coming-soon":return d.jsx("span",{className:"status-badge coming-soon",children:"🚧 Coming Soon"});default:return null}},m=v=>{["google-calendar","gmail","google-docs","google-sheets","google-slides"].includes(v)?o(v):alert("This integration is coming soon! We'll notify you when it's available.")},p=()=>{alert("Google Calendar integration would be set up here. For demo purposes, this feature is not fully implemented."),o(null)};return d.jsxs("div",{className:"integrations-page",children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Integrations"}),d.jsx("p",{className:"dashboard-subtitle",children:"Connect your favorite tools to automatically track time and enhance productivity"})]}),d.jsxs("div",{className:"integration-stats",children:[d.jsxs("div",{className:"stat-item",children:[d.jsx("span",{className:"stat-value",children:fc.filter(v=>v.status==="connected").length}),d.jsx("span",{className:"stat-label",children:"Connected"})]}),d.jsxs("div",{className:"stat-item",children:[d.jsx("span",{className:"stat-value",children:fc.filter(v=>v.status==="available").length}),d.jsx("span",{className:"stat-label",children:"Available"})]})]})]}),d.jsx("div",{className:"category-filter",children:l.map(v=>d.jsx("button",{className:`category-btn ${t===v?"active":""}`,onClick:()=>i(v),children:v==="all"?"🌟 All":v},v))}),t==="all"&&d.jsx("div",{className:"featured-integration",children:d.jsxs("div",{className:"featured-content",children:[d.jsxs("div",{className:"featured-text",children:[d.jsx("h2",{children:"🎯 NEW: AI-Powered Gmail Integration"}),d.jsx("p",{children:"Automatically track time spent reading and writing emails with intelligent client and project detection. Perfect for professionals who handle extensive email communication."}),d.jsxs("div",{className:"featured-benefits",children:[d.jsxs("div",{className:"benefit-item",children:[d.jsx("div",{className:"benefit-icon",children:"🤖"}),d.jsx("div",{children:"AI automatically categorizes emails by client and project"})]}),d.jsxs("div",{className:"benefit-item",children:[d.jsx("div",{className:"benefit-icon",children:"📧"}),d.jsx("div",{children:"Track exact time spent on email activities"})]}),d.jsxs("div",{className:"benefit-item",children:[d.jsx("div",{className:"benefit-icon",children:"💰"}),d.jsx("div",{children:"Smart billable time detection"})]})]}),d.jsxs("div",{className:"featured-buttons",children:[d.jsx("button",{className:"btn btn-primary btn-large",onClick:()=>m("gmail"),children:"📧 Connect Gmail"}),d.jsx("button",{className:"btn btn-secondary btn-large",onClick:()=>m("google-calendar"),children:"📅 Connect Calendar"})]})]}),d.jsx("div",{className:"featured-visual",children:d.jsx("div",{className:"integration-preview",children:d.jsxs("div",{className:"preview-item",children:[d.jsx("div",{className:"preview-icon",children:"📧"}),d.jsxs("div",{className:"preview-text",children:[d.jsx("div",{className:"preview-title",children:"Client Proposal Review"}),d.jsx("div",{className:"preview-time",children:"Email from client@company.com"})]}),d.jsx("div",{className:"preview-arrow",children:"→"}),d.jsxs("div",{className:"preview-entry",children:[d.jsx("div",{className:"entry-badge",children:"⏱️ 0.3h"}),d.jsx("div",{className:"entry-label",children:"AI-tracked"})]})]})})})]})}),d.jsx("div",{className:"integrations-grid",children:u.map(v=>d.jsxs("div",{className:"integration-card",children:[d.jsxs("div",{className:"integration-header",children:[d.jsx("div",{className:"integration-icon",style:{backgroundColor:v.color+"20"},children:v.icon}),d.jsxs("div",{className:"integration-info",children:[d.jsx("h3",{className:"integration-name",children:v.name}),d.jsx("p",{className:"integration-category",children:v.category})]}),f(v.status)]}),d.jsx("p",{className:"integration-description",children:v.description}),d.jsxs("div",{className:"integration-features",children:[d.jsx("h4",{children:"Features:"}),d.jsx("ul",{children:v.features.map((x,S)=>d.jsx("li",{children:x},S))})]}),d.jsxs("div",{className:"integration-actions",children:[v.status==="available"&&d.jsxs("button",{className:"btn btn-primary",onClick:()=>m(v.id),children:["Connect ",v.name]}),v.status==="connected"&&d.jsxs("div",{className:"connected-actions",children:[d.jsx("button",{className:"btn btn-secondary",children:"Configure"}),d.jsx("button",{className:"btn btn-outline",children:"Disconnect"})]}),v.status==="coming-soon"&&d.jsx("button",{className:"btn btn-secondary",disabled:!0,children:"Coming Soon"}),v.status==="error"&&d.jsx("button",{className:"btn btn-warning",children:"Reconnect"})]})]},v.id))}),r&&d.jsx("div",{className:"modal-overlay",onClick:()=>o(null),children:d.jsxs("div",{className:"modal-content setup-modal",onClick:v=>v.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:r==="gmail"?"📧 Connect Gmail":"🔗 Connect Google Calendar"}),d.jsx("button",{className:"modal-close",onClick:()=>o(null),children:"×"})]}),d.jsx("div",{className:"modal-body",children:r&&["gmail","google-calendar","google-docs","google-sheets","google-slides"].includes(r)?d.jsx(AR,{service:r.replace("google-",""),onAuthSuccess:()=>{o(null)},onAuthError:v=>{console.error("Google auth error:",v),alert("Failed to connect Google service: "+v)}}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"setup-steps",children:[d.jsx("h4",{children:"Setup Steps:"}),d.jsxs("ol",{children:[d.jsx("li",{children:`Click "Authorize Access" below to open Google's authentication`}),d.jsx("li",{children:"Sign in to your Google account"}),d.jsx("li",{children:"Grant TimeBeacon permission to read your calendar"}),d.jsx("li",{children:"Configure which calendars to sync"}),d.jsx("li",{children:"Set automatic import preferences"})]})]}),d.jsxs("div",{className:"setup-security",children:[d.jsx("h4",{children:"🔒 Privacy & Security:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"✅ We only read calendar event titles, times, and attendees"}),d.jsx("li",{children:"✅ We never access email or other Google services"}),d.jsx("li",{children:"✅ You can disconnect at any time"}),d.jsx("li",{children:"✅ All data stays within your TimeBeacon account"})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>o(null),children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:p,children:"🔐 Authorize Access"})]})]})})]})}),d.jsxs("div",{className:"help-section",children:[d.jsxs("div",{className:"help-card",children:[d.jsx("h3",{children:"💡 Need Help?"}),d.jsx("p",{children:"Setting up integrations is easy, but if you need assistance:"}),d.jsxs("div",{className:"help-actions",children:[d.jsx("button",{className:"btn btn-outline",children:"📖 View Setup Guides"}),d.jsx("button",{className:"btn btn-outline",children:"💬 Contact Support"}),d.jsx("button",{className:"btn btn-outline",children:"🎥 Watch Tutorials"})]})]}),d.jsxs("div",{className:"help-card",children:[d.jsx("h3",{children:"🚀 Coming Soon"}),d.jsx("p",{children:"We're working on more integrations based on user feedback:"}),d.jsxs("div",{className:"roadmap-items",children:[d.jsxs("div",{className:"roadmap-item",children:[d.jsx("span",{className:"roadmap-icon",children:"🔜"}),d.jsx("span",{children:"Slack & Microsoft Teams"})]}),d.jsxs("div",{className:"roadmap-item",children:[d.jsx("span",{className:"roadmap-icon",children:"🔜"}),d.jsx("span",{children:"GitHub & GitLab"})]}),d.jsxs("div",{className:"roadmap-item",children:[d.jsx("span",{className:"roadmap-icon",children:"🔜"}),d.jsx("span",{children:"Jira & Linear"})]})]}),d.jsx("button",{className:"btn btn-outline",children:"📝 Request Integration"})]})]})]})},CR=({privacySettings:n,dataSources:e,auditLogs:t,onUpdatePrivacySettings:i,onExportData:r,onDeleteAllData:o})=>{const[l,u]=W.useState(!1),[f,m]=W.useState(""),p=()=>{i({...n,masterPauseEnabled:!n.masterPauseEnabled,dataProcessingEnabled:!n.masterPauseEnabled})},v=()=>{f==="DELETE MY DATA"&&(o(),u(!1),m(""))},x=e.filter(b=>b.enabled),S=t.length,_=t[0]?.timestamp||"Never";return d.jsxs("div",{children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Privacy & Data Ownership"}),d.jsx("p",{className:"dashboard-subtitle",children:"Your data, your control, your choice. TimeBeacon is your personal assistant, not surveillance software."})]}),d.jsx("div",{style:{display:"flex",gap:"12px"},children:d.jsx("button",{className:`btn ${n.masterPauseEnabled?"btn-danger":"btn-secondary"}`,onClick:p,children:n.masterPauseEnabled?"⏸️ Tracking Paused":"▶️ Pause All Tracking"})})]}),d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"linear-gradient(135deg, var(--brand-primary), var(--brand-accent))",color:"white",border:"none"},children:d.jsxs("div",{style:{padding:"48px 32px"},children:[d.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"24px",color:"white"},children:"🛡️ Built for Employee Privacy & Empowerment"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"32px"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:"🔒 Your Data Stays Yours"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"All content processing happens locally on your machine. Zero raw emails, messages, or documents ever leave your device. You own and control every bit of your data."})]}),d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:"✨ Personal Assistant, Not Surveillance"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"TimeBeacon helps you document your valuable work, not monitor you. Every feature is designed to empower you, not your employer. You control what gets tracked and shared."})]}),d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:"🚪 Effortless Exit"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"Want to leave? Export all your data or delete everything with one click. No hidden data, no retention policies, no questions asked. Your choice, your control."})]})]})]})}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:"🔌 Data Sources & Permissions"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"You explicitly control what TimeBeacon can access. Every connection requires your consent."})]}),d.jsx("div",{style:{padding:"32px"},children:e.length===0?d.jsxs("div",{style:{textAlign:"center",padding:"48px",color:"var(--text-secondary)"},children:[d.jsx("span",{style:{fontSize:"48px",marginBottom:"16px",display:"block"},children:"🔌"}),d.jsx("h3",{children:"No Data Sources Connected"}),d.jsx("p",{children:"TimeBeacon only accesses what you explicitly allow. Connect your tools when you're ready."})]}):d.jsx("div",{style:{display:"grid",gap:"24px"},children:e.map(b=>d.jsxs("div",{className:"integration-card",style:{border:b.enabled?"2px solid var(--success)":"1px solid var(--border)"},children:[d.jsx("div",{className:"integration-header",children:d.jsx("div",{className:"integration-info",children:d.jsxs("div",{className:"integration-icon-name",children:[d.jsxs("div",{className:"integration-icon",children:[b.type==="email"&&"📧",b.type==="calendar"&&"📅",b.type==="slack"&&"💬",b.type==="github"&&"🐙",b.type==="notion"&&"📝",b.type==="jira"&&"🎫",b.type==="linear"&&"📋"]}),d.jsxs("div",{children:[d.jsx("h3",{className:"integration-name",children:b.name}),d.jsx("p",{className:"integration-description",children:b.enabled?`✅ Active • Last accessed: ${b.lastAccessed?new Date(b.lastAccessed).toLocaleDateString():"Never"}`:"⏸️ Paused"})]})]})})}),d.jsx("div",{className:"integration-status",children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Total Accesses"}),d.jsx("span",{className:"status-value",children:b.totalAccessCount})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Consent Granted"}),d.jsx("span",{className:"status-value",children:new Date(b.consentGrantedAt).toLocaleDateString()})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Projects Tracked"}),d.jsx("span",{className:"status-value",children:b.permissions.allowedProjects?.length||"All"})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Approval Required"}),d.jsx("span",{className:`status-value ${b.permissions.requireApproval?"enabled":"disabled"}`,children:b.permissions.requireApproval?"Yes":"No"})]})]})}),d.jsxs("div",{style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid var(--border-light)"},children:[d.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"Permissions Granted"}),d.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[b.permissions.canReadMetadata&&d.jsx("span",{className:"integration-badge",children:"📊 Metadata"}),b.permissions.canReadContent&&d.jsx("span",{className:"integration-badge",children:"📄 Content (Local Only)"}),b.permissions.canReadAttachments&&d.jsx("span",{className:"integration-badge",children:"📎 Attachments"}),b.permissions.pausedUntil&&d.jsxs("span",{className:"integration-badge",style:{background:"var(--warning-light)",color:"var(--warning)"},children:["⏸️ Paused until ",new Date(b.permissions.pausedUntil).toLocaleDateString()]})]})]})]},b.id))})})]}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:"🔍 Transparency Dashboard"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"See exactly what TimeBeacon has accessed and analyzed. No hidden activity."})]}),d.jsxs("div",{style:{padding:"32px"},children:[d.jsxs("div",{className:"stats-grid",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Total Data Accesses"}),d.jsx("div",{className:"stat-value",children:S}),d.jsx("div",{className:"stat-change",children:"All logged and auditable"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Active Data Sources"}),d.jsx("div",{className:"stat-value",children:x.length}),d.jsx("div",{className:"stat-change",children:"You control each one"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Last Activity"}),d.jsx("div",{className:"stat-value",children:_==="Never"?"Never":new Date(_).toLocaleDateString()}),d.jsx("div",{className:"stat-change",children:"Real-time tracking"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Data Retention"}),d.jsxs("div",{className:"stat-value",children:[n.auditLogRetentionDays," days"]}),d.jsx("div",{className:"stat-change",children:n.autoDeleteOldData?"✅ Auto-delete enabled":"⚠️ Manual cleanup"})]})]}),t.length>0&&d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px"},children:"Recent Activity Log"}),d.jsx("div",{className:"table-container",children:d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Timestamp"}),d.jsx("th",{children:"Action"}),d.jsx("th",{children:"Source"}),d.jsx("th",{children:"Items Processed"}),d.jsx("th",{children:"Processing Time"})]})}),d.jsx("tbody",{children:t.slice(0,10).map(b=>d.jsxs("tr",{children:[d.jsxs("td",{className:"time-value",children:[new Date(b.timestamp).toLocaleDateString()," ",new Date(b.timestamp).toLocaleTimeString()]}),d.jsx("td",{style:{textTransform:"capitalize"},children:b.action.replace("_"," ")}),d.jsx("td",{children:d.jsx("span",{style:{textTransform:"capitalize"},children:b.source})}),d.jsx("td",{children:b.details.itemsAnalyzed||b.details.itemsAccessed||"-"}),d.jsx("td",{children:b.details.processingTimeMs?`${b.details.processingTimeMs}ms`:"-"})]},b.id))})]})})]})]})]}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:"🎛️ Data Control Center"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Complete control over your data. Export, delete, or modify anything at any time."})]}),d.jsx("div",{style:{padding:"32px"},children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"24px"},children:[d.jsxs("div",{style:{padding:"24px",border:"1px solid var(--border)",borderRadius:"12px",background:"var(--surface)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:"📦 Export Your Data"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"20px",fontSize:"14px"},children:"Download all your time entries, settings, and audit logs. Your data, your format."}),d.jsxs("div",{style:{display:"flex",gap:"8px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>r("json"),children:"Export JSON"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>r("csv"),children:"Export CSV"})]})]}),d.jsxs("div",{style:{padding:"24px",border:"1px solid var(--border)",borderRadius:"12px",background:"var(--surface)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:"⚙️ Privacy Controls"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.requireManualApproval,onChange:b=>i({...n,requireManualApproval:b.target.checked})}),"Require approval for all AI suggestions"]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.showDetailedAuditLogs,onChange:b=>i({...n,showDetailedAuditLogs:b.target.checked})}),"Show detailed audit logs"]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.autoDeleteOldData,onChange:b=>i({...n,autoDeleteOldData:b.target.checked})}),"Auto-delete old audit logs"]})]})]}),d.jsxs("div",{style:{padding:"24px",border:"2px solid var(--error)",borderRadius:"12px",background:"var(--error-light)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:"🚨 Emergency Controls"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"20px",fontSize:"14px"},children:"Need to stop everything immediately? These controls give you instant control."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsx("button",{className:"btn btn-danger",onClick:p,children:n.masterPauseEnabled?"▶️ Resume All Tracking":"⏸️ Pause All Tracking"}),d.jsx("button",{className:"btn btn-danger",onClick:()=>u(!0),children:"🗑️ Delete All Data"})]})]})]})})]}),l&&d.jsx("div",{className:"modal-overlay",onClick:()=>u(!1),children:d.jsxs("div",{className:"modal-content",onClick:b=>b.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:"⚠️ Delete All Data"}),d.jsx("button",{className:"modal-close",onClick:()=>u(!1),children:"×"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{background:"var(--error-light)",padding:"16px",borderRadius:"8px",marginBottom:"24px"},children:[d.jsx("p",{style:{color:"var(--error)",fontWeight:"600",marginBottom:"8px"},children:"This action cannot be undone!"}),d.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"This will permanently delete:"}),d.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px",color:"var(--text-secondary)",fontSize:"14px"},children:[d.jsx("li",{children:"All time entries and projects"}),d.jsx("li",{children:"All data source connections"}),d.jsx("li",{children:"All audit logs and analysis data"}),d.jsx("li",{children:"All settings and preferences"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{fontWeight:"600"},children:'Type "DELETE MY DATA" to confirm:'}),d.jsx("input",{type:"text",value:f,onChange:b=>m(b.target.value),className:"form-input",placeholder:"DELETE MY DATA",style:{marginTop:"8px"}})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>{u(!1),m("")},children:"Cancel"}),d.jsx("button",{className:"btn btn-danger",onClick:v,disabled:f!=="DELETE MY DATA",children:"Delete Everything"})]})]})}),d.jsx("div",{className:"content-card",style:{background:"var(--surface)",border:"1px solid var(--success)"},children:d.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--success)"},children:"🤝 Our Privacy Commitment"}),d.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[d.jsx("p",{style:{fontSize:"16px",lineHeight:"1.6",color:"var(--text-secondary)",marginBottom:"24px"},children:"TimeBeacon exists to empower you, not monitor you. We've designed every feature with your privacy and autonomy in mind. Your work is valuable, and you deserve tools that respect that value."}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",fontSize:"14px"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:"✅ Local Processing"}),d.jsx("br",{}),"Content never leaves your device"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"✅ Full Transparency"}),d.jsx("br",{}),"See exactly what we access"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"✅ Complete Control"}),d.jsx("br",{}),"Pause, export, or delete anytime"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"✅ No Hidden Data"}),d.jsx("br",{}),"What you see is what we have"]})]})]})]})})]})},jR=({onClose:n})=>{const[e,t]=W.useState(Ga.getStatus()),[i,r]=W.useState(tr.getStats()),[o,l]=W.useState(Rr.getStatus()),[u,f]=W.useState(!1),[m,p]=W.useState(null);W.useEffect(()=>{const _=setInterval(()=>{t(Ga.getStatus()),r(tr.getStats()),l(Rr.getStatus())},5e3);return()=>clearInterval(_)},[]);const v=async()=>{f(!0),p(null);try{const _=await Ga.testService();p(_)}catch{p({success:!1,error:"Test failed"})}finally{f(!1)}},x=async()=>{try{const _=await Rr.testConnection();console.log("Calendar test result:",_)}catch(_){console.error("Calendar test failed:",_)}},S=async()=>{try{const _=await Rr.forceSync();console.log("Force sync result:",_)}catch(_){console.error("Force sync failed:",_)}};return d.jsxs("div",{className:"content-card",children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:"🤖 AI Processing System"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Configure and monitor your local AI processing capabilities"}),n&&d.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Close"})]}),d.jsxs("div",{style:{padding:"32px"},children:[d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:"🧠 Local AI Engine (Ollama)"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"AI Service"}),d.jsx("div",{className:`status-value ${e.available?"status-success":"status-error"}`,children:e.available?"✅ Available":"❌ Not Available"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Model"}),d.jsx("div",{className:"status-value",children:e.model})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Processing"}),d.jsx("div",{className:`status-value ${e.enabled?"status-success":"status-warning"}`,children:e.enabled?"🟢 Enabled":"🟡 Disabled"})]})]}),!e.available&&d.jsxs("div",{className:"alert alert-info",children:[d.jsx("h4",{children:"🔧 Ollama Setup Required"}),d.jsx("p",{children:"To enable local AI processing, install Ollama and the required model:"}),d.jsx("div",{className:"code-block",children:d.jsxs("code",{children:["# Install Ollama (macOS/Linux)",d.jsx("br",{}),"curl -fsSL https://ollama.com/install.sh | sh",d.jsx("br",{}),d.jsx("br",{}),"# Pull the model",d.jsx("br",{}),"ollama pull llama3.2:3b",d.jsx("br",{}),d.jsx("br",{}),"# Start Ollama service",d.jsx("br",{}),"ollama serve"]})}),d.jsxs("p",{style:{marginTop:"16px"},children:[d.jsx("strong",{children:"Privacy Note:"})," All AI processing happens locally on your machine. No data is sent to external servers."]})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"16px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:v,disabled:u,children:u?"🔄 Testing...":"🧪 Test AI Service"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>Ga.checkOllamaAvailability(),children:"🔄 Refresh Status"})]}),m&&d.jsx("div",{className:`alert ${m.success?"alert-success":"alert-error"}`,style:{marginTop:"16px"},children:m.success?d.jsxs("p",{children:["✅ AI service test successful! Latency: ",m.latency,"ms"]}):d.jsxs("p",{children:["❌ AI service test failed: ",m.error]})})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:"📊 Content Analyzer"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Queue Length"}),d.jsx("div",{className:"status-value",children:i.queueLength})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Processing"}),d.jsx("div",{className:`status-value ${i.isProcessing?"status-warning":"status-success"}`,children:i.isProcessing?"🟡 Active":"🟢 Idle"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Cache Size"}),d.jsx("div",{className:"status-value",children:i.cacheSize})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Total Suggestions"}),d.jsx("div",{className:"status-value",children:i.totalSuggestions})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Pending Review"}),d.jsx("div",{className:"status-value",children:i.pendingSuggestions})]})]}),d.jsx("div",{style:{display:"flex",gap:"12px"},children:d.jsx("button",{className:"btn btn-secondary",onClick:()=>tr.clearOldSuggestions(7),children:"🧹 Clear Old Suggestions"})})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:"📅 Calendar Integration"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Status"}),d.jsx("div",{className:`status-value ${o.enabled?"status-success":"status-warning"}`,children:o.enabled?"✅ Connected":"⚠️ Disconnected"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Last Sync"}),d.jsx("div",{className:"status-value",children:o.lastSync?new Date(o.lastSync).toLocaleString():"Never"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Events Processed"}),d.jsx("div",{className:"status-value",children:o.processedEventsCount})]})]}),d.jsxs("div",{style:{display:"flex",gap:"12px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:x,children:"🧪 Test Connection"}),d.jsx("button",{className:"btn btn-secondary",onClick:S,children:"🔄 Force Sync"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>Rr.clearHistory(),children:"🧹 Clear History"})]})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:"🔒 Privacy & Security"}),d.jsxs("div",{className:"alert alert-success",children:[d.jsx("h4",{children:"✅ Privacy-First Architecture"}),d.jsxs("ul",{style:{margin:"12px 0",paddingLeft:"20px"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Local Processing:"})," All AI analysis happens on your device"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"No Data Transmission:"})," Raw content never leaves your computer"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Encrypted Storage:"})," Suggestions stored locally with encryption"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"User Control:"})," You approve every AI-generated time entry"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Audit Trail:"})," Complete visibility into AI decision-making"]})]})]}),d.jsxs("div",{className:"alert alert-info",children:[d.jsx("h4",{children:"🔧 What the AI Analyzes"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginTop:"12px"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:"📅 Calendar Events"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Meeting titles and descriptions"}),d.jsx("li",{children:"Attendee information"}),d.jsx("li",{children:"Meeting duration and timing"}),d.jsx("li",{children:"Location details"})]})]}),d.jsxs("div",{children:[d.jsx("strong",{children:"📧 Email Content (Future)"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Subject lines for project matching"}),d.jsx("li",{children:"Sender/recipient analysis"}),d.jsx("li",{children:"Project keywords and references"}),d.jsx("li",{children:"Time-related discussions"})]})]}),d.jsxs("div",{children:[d.jsx("strong",{children:"💬 Slack Messages (Future)"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Project channel discussions"}),d.jsx("li",{children:"Client interaction threads"}),d.jsx("li",{children:"Work status updates"}),d.jsx("li",{children:"Meeting coordination"})]})]})]})]})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:"⚡ Performance Optimization"}),d.jsxs("div",{className:"tips-grid",style:{display:"grid",gap:"16px"},children:[d.jsxs("div",{className:"tip-card",children:[d.jsx("h4",{children:"🚀 Speed Tips"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Use a smaller model (llama3.2:1b) for faster processing"}),d.jsx("li",{children:"Increase RAM allocation to Ollama for better performance"}),d.jsx("li",{children:"Close unnecessary applications when AI is processing"}),d.jsx("li",{children:"Process activities in batches for efficiency"})]})]}),d.jsxs("div",{className:"tip-card",children:[d.jsx("h4",{children:"🎯 Accuracy Tips"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Use descriptive meeting titles and descriptions"}),d.jsx("li",{children:"Maintain consistent project and client naming"}),d.jsx("li",{children:"Review and approve suggestions to train the system"}),d.jsx("li",{children:"Keep your project and client lists up to date"})]})]})]})]})]})]})},DR=({onApproveSuggestion:n,onRejectSuggestion:e,aiEnabled:t,onToggleAI:i})=>{const[r,o]=W.useState(null),[l,u]=W.useState([]),[f,m]=W.useState(!1),[p,v]=W.useState(Ga.getStatus()),[x,S]=W.useState(Rr.getStatus());W.useEffect(()=>{const E=()=>{const D=tr.getStoredSuggestions();u(D)};E();const I=setInterval(E,3e4);return()=>clearInterval(I)},[]),W.useEffect(()=>{const I=setInterval(()=>{v(Ga.getStatus()),S(Rr.getStatus())},5e3);return()=>clearInterval(I)},[]);const _=async(E,I)=>{try{await tr.approveSuggestion(E,I),u(tr.getStoredSuggestions()),n(E,I)}catch(D){console.error("Failed to approve suggestion:",D)}},b=async(E,I)=>{try{await tr.rejectSuggestion(E,I),u(tr.getStoredSuggestions()),e(E,I)}catch(D){console.error("Failed to reject suggestion:",D)}},T=async()=>{try{await Rr.forceSync(),setTimeout(()=>{u(tr.getStoredSuggestions())},2e3)}catch(E){console.error("Force sync failed:",E)}},w=l.filter(E=>E.status==="pending"),A=l.filter(E=>E.status!=="pending").slice(0,5),C=E=>E>=.8?"var(--success)":E>=.6?"var(--warning)":"var(--error)",N=E=>E>=.8?"High Confidence":E>=.6?"Medium Confidence":"Low Confidence";return d.jsxs("div",{children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"AI Insights"}),d.jsx("p",{className:"dashboard-subtitle",children:"AI-generated time entry suggestions • All processing happens locally on your device"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>m(!0),children:"⚙️ AI Settings"}),d.jsx("button",{className:"btn btn-secondary",onClick:T,disabled:!x.enabled,children:"🔄 Sync Calendar"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"var(--text-secondary)"},children:"AI Analysis"}),d.jsxs("div",{className:"toggle-switch",children:[d.jsx("input",{type:"checkbox",checked:t&&p.available,onChange:i,id:"ai-toggle",disabled:!p.available}),d.jsx("label",{htmlFor:"ai-toggle",className:"toggle-slider"})]})]})]})]}),!p.available&&d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"var(--warning-light)",border:"1px solid var(--warning)"},children:d.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[d.jsx("span",{style:{fontSize:"48px",marginBottom:"16px",display:"block"},children:"🔧"}),d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--warning-dark)"},children:"AI Service Setup Required"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",maxWidth:"500px",margin:"0 auto 24px"},children:"TimeBeacon uses Ollama for local AI processing. Install Ollama and the required model to enable intelligent time entry suggestions. All processing happens locally - your content never leaves this device."}),d.jsx("button",{className:"btn btn-primary",onClick:()=>m(!0),children:"Setup Instructions"})]})}),!t&&p.available&&d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"var(--info-light)",border:"1px solid var(--info)"},children:d.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[d.jsx("span",{style:{fontSize:"48px",marginBottom:"16px",display:"block"},children:"🤖"}),d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--info-dark)"},children:"AI Analysis Paused"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",maxWidth:"500px",margin:"0 auto 24px"},children:"Your AI assistant is ready but currently paused. Enable AI analysis to automatically generate time entry suggestions from your digital activities. All processing happens locally - your content never leaves this device."}),d.jsx("button",{className:"btn btn-primary",onClick:i,children:"Enable AI Analysis"})]})}),t&&p.available&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"var(--success-light)",border:"1px solid var(--success)"},children:d.jsxs("div",{style:{padding:"24px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",margin:0,color:"var(--success-dark)",display:"flex",alignItems:"center",gap:"8px"},children:"🔒 Privacy Protected - AI Active"}),d.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"14px"},children:[d.jsxs("span",{style:{color:"var(--text-secondary)"},children:["AI Model: ",d.jsx("strong",{children:p.model})]}),d.jsxs("span",{style:{color:"var(--text-secondary)"},children:["Calendar: ",d.jsx("strong",{children:x.enabled?"Connected":"Disconnected"})]})]})]}),d.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px",margin:0},children:"AI analysis runs entirely on your device using Ollama. Your emails, messages, and documents never leave your computer. Only approved time entry summaries are stored."})]})}),w.length>0&&d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsxs("h2",{className:"card-title",children:["Pending Suggestions (",w.length,")"]}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Review and approve AI-generated time entries"})]}),d.jsx("div",{style:{padding:"32px"},children:d.jsx("div",{style:{display:"grid",gap:"24px"},children:w.map(E=>d.jsx("div",{className:"content-card",style:{border:`2px solid ${C(E.confidence)}20`,background:"var(--surface-elevated)",cursor:"pointer"},onClick:()=>o(r===E.id?null:E.id),children:d.jsxs("div",{style:{padding:"24px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",margin:0,color:"var(--text-primary)"},children:E.suggestedProject}),d.jsxs("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:`${C(E.confidence)}20`,color:C(E.confidence)},children:[N(E.confidence)," (",Math.round(E.confidence*100),"%)"]})]}),d.jsxs("p",{style:{color:"var(--text-secondary)",margin:"0 0 12px 0"},children:[E.suggestedClient," • ",E.suggestedDuration,"h • ",new Date(E.suggestedDate).toLocaleDateString()]}),d.jsx("p",{style:{color:"var(--text-primary)",margin:0,lineHeight:"1.5"},children:E.suggestedDescription})]}),d.jsxs("div",{style:{display:"flex",gap:"8px",flexShrink:0,marginLeft:"16px"},children:[d.jsx("button",{className:"btn btn-success btn-small",onClick:I=>{I.stopPropagation(),_(E.id)},children:"✅ Approve"}),d.jsx("button",{className:"btn btn-danger btn-small",onClick:I=>{I.stopPropagation(),b(E.id,"User rejected")},children:"❌ Reject"})]})]}),r===E.id&&d.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:"16px",marginTop:"16px",background:"var(--background-secondary)",padding:"16px",borderRadius:"8px"},children:[d.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px",color:"var(--text-primary)"},children:"AI Analysis Details"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",fontSize:"13px"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Generated:"}),d.jsx("br",{}),d.jsx("span",{style:{color:"var(--text-primary)"},children:new Date(E.generatedAt).toLocaleString()})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Source:"}),d.jsx("br",{}),d.jsx("span",{style:{color:"var(--text-primary)",textTransform:"capitalize"},children:E.source})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Data Sources:"}),d.jsx("br",{}),d.jsx("span",{style:{color:"var(--text-primary)"},children:E.basedOnDataFrom.join(", ")})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Tags:"}),d.jsx("br",{}),d.jsx("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap",marginTop:"4px"},children:E.suggestedTags.map(I=>d.jsx("span",{style:{padding:"2px 6px",background:"var(--brand-primary-light)",color:"var(--brand-primary)",borderRadius:"4px",fontSize:"11px"},children:I},I))})]})]})]})]})},E.id))})})]}),A.length>0&&d.jsxs("div",{className:"content-card",children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:"Recently Processed"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Your recent AI suggestion decisions"})]}),d.jsx("div",{className:"table-container",children:d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Confidence"}),d.jsx("th",{children:"Decision"}),d.jsx("th",{children:"Processed"})]})}),d.jsx("tbody",{children:A.map(E=>d.jsxs("tr",{children:[d.jsx("td",{children:new Date(E.suggestedDate).toLocaleDateString()}),d.jsx("td",{children:E.suggestedProject}),d.jsx("td",{style:{maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis"},children:E.suggestedDescription}),d.jsx("td",{children:d.jsxs("span",{style:{color:C(E.confidence),fontWeight:"600"},children:[Math.round(E.confidence*100),"%"]})}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${E.status==="approved"?"status-approved":E.status==="rejected"?"status-rejected":"status-pending"}`,children:E.status})}),d.jsx("td",{className:"time-value",children:E.approvedAt?new Date(E.approvedAt).toLocaleDateString():E.rejectedAt?new Date(E.rejectedAt).toLocaleDateString():"-"})]},E.id))})]})})]}),w.length===0&&A.length===0&&d.jsx("div",{className:"content-card",children:d.jsxs("div",{style:{padding:"64px",textAlign:"center"},children:[d.jsx("span",{style:{fontSize:"64px",marginBottom:"24px",display:"block"},children:"🤖"}),d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--text-primary)"},children:"AI Learning Your Patterns"}),d.jsx("p",{style:{color:"var(--text-secondary)",maxWidth:"500px",margin:"0 auto",fontSize:"16px",lineHeight:"1.6"},children:"Your AI assistant is analyzing your digital activities to learn your work patterns. Suggestions will appear here as the AI identifies potential time entries from your calendar and other sources."}),d.jsxs("div",{style:{marginTop:"32px",display:"flex",gap:"12px",justifyContent:"center"},children:[d.jsx("button",{className:"btn btn-primary",onClick:T,children:"🔄 Sync Calendar Now"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>m(!0),children:"⚙️ Configure AI"})]}),d.jsxs("div",{style:{marginTop:"32px",padding:"24px",background:"var(--background-secondary)",borderRadius:"12px",maxWidth:"600px",margin:"32px auto 0"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"var(--text-primary)"},children:"What the AI Analyzes (Locally)"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",fontSize:"14px"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:"📅 Calendar Events"}),d.jsx("br",{}),"Meeting titles, attendees, durations (Active)"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"📧 Email Content"}),d.jsx("br",{}),"Project mentions, client names (Coming Soon)"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"💬 Slack Messages"}),d.jsx("br",{}),"Project discussions, client interactions (Coming Soon)"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"📝 Document Access"}),d.jsx("br",{}),"File names, project folders (Coming Soon)"]})]})]})]})})]}),f&&d.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:d.jsx("div",{style:{background:"var(--background)",borderRadius:"12px",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflow:"auto"},children:d.jsx(jR,{onClose:()=>m(!1)})})})]})},NR=n=>({defaultClients:[],defaultProjects:[],workingHours:{start:n.workingHours?.start||"09:00",end:n.workingHours?.end||"17:00",timezone:n.timezone||"UTC"},billableByDefault:!0,autoTrackMeetings:!0,autoTrackSlack:!1,minimumSessionLength:15,notifications:n.notifications?.enableDesktop||!0,autoBreaks:!1,theme:n.theme||"light",emailNotifications:{enabled:!1,dailyReviewTime:"17:00",approvalReminders:!0,weeklyDigest:!0,email:""},integrations:Object.entries(n.integrations||{}).map(([e,t])=>({id:e,name:e,enabled:t.enabled||!1,lastSync:t.lastSync,settings:t.settings||{}}))}),OR=()=>{const n=eS(),e=W.useCallback(S=>{const _={...S,id:crypto.randomUUID()};return n.addTimeEntry(S).catch(b=>{console.error("Failed to persist time entry:",b)}),_},[n]),t=W.useCallback((S,_)=>{n.updateTimeEntry(S,_).catch(b=>{console.error("Failed to update time entry:",b)})},[n]),i=W.useCallback(S=>{n.deleteTimeEntry(S).catch(_=>{console.error("Failed to delete time entry:",_)})},[n]),r=W.useCallback(S=>{const _={...S,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return n.addProject(S).catch(b=>{console.error("Failed to persist project:",b)}),_},[n]),o=W.useCallback((S,_)=>{n.updateProject(S,_).catch(b=>{console.error("Failed to update project:",b)})},[n]),l=W.useCallback(S=>{n.deleteProject(S).catch(_=>{console.error("Failed to delete project:",_)})},[n]),u=W.useCallback(S=>{const _={...S,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return n.addClient(S).catch(b=>{console.error("Failed to persist client:",b)}),_},[n]),f=W.useCallback((S,_)=>{n.updateClient(S,_).catch(b=>{console.error("Failed to update client:",b)})},[n]),m=W.useCallback(S=>{n.deleteClient(S).catch(_=>{console.error("Failed to delete client:",_)})},[n]),p=W.useCallback(S=>{const _={theme:S.theme,timezone:S.workingHours.timezone,workingHours:{start:S.workingHours.start,end:S.workingHours.end,workingDays:[1,2,3,4,5]},notifications:{enableDesktop:S.notifications,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:S.integrations.reduce((b,T)=>(b[T.id]={enabled:T.enabled,lastSync:T.lastSync,settings:T.settings},b),{})};n.setSettings(_).catch(b=>{console.error("Failed to update settings:",b)})},[n]),v=W.useCallback(S=>{n.toggleIntegration(S)},[n]),x=W.useMemo(()=>{const S=new Date().toISOString().split("T")[0],_=new Date,b=new Date(_.getFullYear(),_.getMonth(),_.getDate()-_.getDay()),T=new Date(_.getFullYear(),_.getMonth(),1),w=n.timeEntries.filter(L=>L.date===S),A=n.timeEntries.filter(L=>new Date(L.date)>=b),C=n.timeEntries.filter(L=>new Date(L.date)>=T),N=w.reduce((L,H)=>L+H.duration,0),E=A.reduce((L,H)=>L+H.duration,0),I=C.reduce((L,H)=>L+H.duration,0),D=n.timeEntries.filter(L=>L.billable&&L.status==="approved"),z=D.reduce((L,H)=>L+H.duration*100,0);return{todayHours:N,weekHours:E,monthHours:I,billableHours:D.reduce((L,H)=>L+H.duration,0),nonBillableHours:n.timeEntries.filter(L=>!L.billable).reduce((L,H)=>L+H.duration,0),pendingEntries:n.timeEntries.filter(L=>L.status==="pending").length,totalClients:n.clients.length,activeProjects:n.projects.filter(L=>L.active).length,totalEarnings:z,utilizationRate:E>0?D.filter(L=>A.includes(L)).reduce((L,H)=>L+H.duration,0)/E*100:0,automatedEntries:C.filter(L=>L.automated).length}},[n.timeEntries,n.projects,n.clients]);return{timeEntries:n.timeEntries,projects:n.projects,clients:n.clients,settings:NR(n.settings),stats:x,isLoading:n.isLoading,error:n.error,addTimeEntry:e,updateTimeEntry:t,deleteTimeEntry:i,addProject:r,updateProject:o,deleteProject:l,addClient:u,updateClient:f,deleteClient:m,setSettings:p,toggleIntegration:v,exportData:n.exportData,clearAllData:n.clearAllData}};function vi(){const n=Fr(),e=Jo(),[t,i]=W.useState(!1),[r,o]=W.useState(!0),l=OR(),u=()=>{const b=n.pathname;return b.includes("/reports")?"reports":b.includes("/ai-insights")?"ai-insights":b.includes("/permissions")?"permissions":b.includes("/settings")?"settings":b.includes("/privacy")?"privacy":b.includes("/integrations")?"integrations":"dashboard"},[f,m]=W.useState(u());W.useEffect(()=>{m(u())},[n.pathname]);const p=b=>{e(`/${b}`),m(b)},v=()=>{const b=!t;i(b),Ga.updateConfig({enabled:b}),console.log(b?"✨ AI analysis enabled":"⏸️ AI analysis paused")},x=async(b,T)=>{try{await tr.approveSuggestion(b,T),console.log("✅ Suggestion approved and time entry created")}catch(w){console.error("Failed to approve suggestion:",w)}},S=async(b,T)=>{try{await tr.rejectSuggestion(b,T),console.log("❌ Suggestion rejected:",T)}catch(w){console.error("Failed to reject suggestion:",w)}},_=()=>{switch(f){case"dashboard":return d.jsx(zv,{entries:l.timeEntries,projects:l.projects,onUpdateEntry:l.updateTimeEntry,onDeleteEntry:l.deleteTimeEntry,onAddEntry:l.addTimeEntry});case"reports":return r?d.jsx(SR,{}):d.jsx(ME,{entries:l.timeEntries,projects:l.projects});case"ai-insights":return d.jsx(DR,{onApproveSuggestion:x,onRejectSuggestion:S,aiEnabled:t,onToggleAI:v});case"integrations":return d.jsx(kR,{integrations:l.settings.integrations,onToggleIntegration:l.toggleIntegration});case"permissions":return d.jsx(_R,{});case"settings":return d.jsx(TR,{});case"privacy":return d.jsx(CR,{privacySettings:{dataProcessingEnabled:!0,auditLogRetentionDays:30,contentAnalysisRetentionDays:7,autoDeleteOldData:!0,aiAnalysisEnabled:!0,maxConfidenceThreshold:.7,requireManualApproval:!0,showDetailedAuditLogs:!0,notifyOnDataAccess:!1,exportFormat:"json",masterPauseEnabled:!1,emergencyWipeEnabled:!0},dataSources:[],auditLogs:[],onUpdatePrivacySettings:()=>{},onExportData:l.exportData,onDeleteAllData:l.clearAllData});default:return d.jsx(zv,{entries:l.timeEntries,projects:l.projects,onUpdateEntry:l.updateTimeEntry,onDeleteEntry:l.deleteTimeEntry,onAddEntry:l.addTimeEntry})}};return l.isLoading?d.jsx("div",{className:"app-container",children:d.jsxs("div",{className:"loading-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"24px",background:"var(--background)"},children:[d.jsx("div",{className:"loading-spinner",style:{width:"48px",height:"48px",border:"4px solid var(--border)",borderTop:"4px solid var(--brand-primary)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),d.jsxs("div",{style:{textAlign:"center",color:"var(--text-secondary)"},children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"8px",color:"var(--text-primary)"},children:"🚀 Initializing TimeBeacon"}),d.jsx("p",{children:"Setting up your local-first database..."})]})]})}):l.error?d.jsx("div",{className:"app-container",children:d.jsx("div",{className:"error-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"24px",background:"var(--background)",padding:"32px"},children:d.jsxs("div",{style:{textAlign:"center",maxWidth:"500px"},children:[d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--error)"},children:"⚠️ Database Error"}),d.jsxs("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",lineHeight:"1.6"},children:["Failed to initialize the local database: ",l.error]}),d.jsx("button",{className:"btn btn-primary",onClick:()=>window.location.reload(),children:"🔄 Retry"})]})})}):d.jsxs("div",{className:"app-container",children:[d.jsx(wE,{activeItem:f,onItemClick:p}),d.jsx("main",{className:"main-content","data-testid":"main-content",children:_()})]})}class MR{config;authWindow=null;constructor(){this.config={clientId:"829394557114-32bedmchkqvru4gvtg52ojgef7fssusn.apps.googleusercontent.com",clientSecret:"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",redirectUri:"http://localhost:3001/auth/google/callback",scopes:["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/calendar.readonly","https://www.googleapis.com/auth/gmail.readonly","https://www.googleapis.com/auth/documents.readonly","https://www.googleapis.com/auth/spreadsheets.readonly","https://www.googleapis.com/auth/drive.activity.readonly"]}}async authenticate(){return new Promise(async(e,t)=>{if(this.config.clientId==="demo-client-id"){setTimeout(()=>{const i={email:"user@company.com",name:"John Doe",picture:"https://via.placeholder.com/100",accessToken:"mock-access-token",refreshToken:"mock-refresh-token",expiresAt:Date.now()+36e5};this.storeAccount(i),e(i)},1e3);return}try{const o=await(await fetch("http://localhost:3001/auth/google/url")).json();if(!o.authUrl)throw new Error("Failed to get OAuth URL");this.authWindow=window.open(o.authUrl,"google-auth","width=500,height=600,scrollbars=yes,resizable=yes");const l=f=>{if(f.data.type==="GOOGLE_AUTH_SUCCESS"){window.removeEventListener("message",l),this.authWindow?.close();const m={email:"user@example.com",name:"User",picture:"",accessToken:f.data.tokens.access_token,refreshToken:f.data.tokens.refresh_token,expiresAt:f.data.tokens.expiry_date||Date.now()+3600*1e3};this.storeAccount(m),e(m)}else f.data.type==="GOOGLE_AUTH_ERROR"&&(window.removeEventListener("message",l),this.authWindow?.close(),t(new Error(f.data.error)))};window.addEventListener("message",l);const u=setInterval(()=>{if(this.authWindow?.closed){clearInterval(u),window.removeEventListener("message",l);const f=localStorage.getItem("google_tokens");if(f){const m=JSON.parse(f),p={email:"user@example.com",name:"User",picture:"",accessToken:m.access_token,refreshToken:m.refresh_token,expiresAt:m.expiry_date||Date.now()+3600*1e3};this.storeAccount(p),e(p)}else t(new Error("Authentication cancelled"))}},1e3);setTimeout(()=>{this.authWindow&&!this.authWindow.closed&&(this.authWindow.close(),window.removeEventListener("message",l),t(new Error("Authentication timeout")))},3e5)}catch(i){t(i)}})}buildAuthUrl(){return`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:this.config.clientId,redirect_uri:this.config.redirectUri,scope:this.config.scopes.join(" "),response_type:"code",access_type:"offline",prompt:"consent",state:crypto.randomUUID()})}`}async exchangeCodeForTokens(e){try{const i=await(await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:this.config.clientId,client_secret:this.config.clientSecret,code:e,grant_type:"authorization_code",redirect_uri:this.config.redirectUri})})).json(),o=await(await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${i.access_token}`}})).json(),l={email:o.email,name:o.name,picture:o.picture,accessToken:i.access_token,refreshToken:i.refresh_token,expiresAt:Date.now()+i.expires_in*1e3};return this.storeAccount(l),l}catch(t){throw console.error("Token exchange failed:",t),t}}storeAccount(e){localStorage.setItem("google_account",JSON.stringify(e))}getStoredAccount(){try{const e=localStorage.getItem("google_account");if(!e)return null;const t=JSON.parse(e);return Date.now()>t.expiresAt&&this.refreshToken(t),t}catch{return null}}async refreshToken(e){try{const i=await(await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:this.config.clientId,client_secret:this.config.clientSecret,refresh_token:e.refreshToken,grant_type:"refresh_token"})})).json();e.accessToken=i.access_token,e.expiresAt=Date.now()+i.expires_in*1e3,this.storeAccount(e)}catch(t){console.error("Token refresh failed:",t),this.disconnect()}}disconnect(){localStorage.removeItem("google_account")}isConnected(){const e=this.getStoredAccount();return e!==null&&Date.now()<e.expiresAt}async fetchGmailActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockGmailActivities();try{const i=t?`after:${Math.floor(t.getTime()/1e3)}`:"in:sent OR in:inbox",o=await(await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages?q=${encodeURIComponent(i)}&maxResults=50`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json(),l=[];for(const u of o.messages||[]){const m=await(await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${u.id}`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json(),p=this.parseGmailMessage(m);p&&l.push(p)}return l}catch(i){return console.error("Gmail fetch failed:",i),[]}}async fetchCalendarActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockCalendarActivities();try{const i=t?t.toISOString():new Date(Date.now()-6048e5).toISOString();return((await(await fetch(`https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=${i}&singleEvents=true&orderBy=startTime`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json()).items||[]).map(this.parseCalendarEvent).filter(Boolean)}catch(i){return console.error("Calendar fetch failed:",i),[]}}async fetchDocsActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockDocsActivities();try{const i=t?`modifiedTime > '${t.toISOString()}'`:"";return((await(await fetch(`https://www.googleapis.com/drive/v3/files?q=mimeType='application/vnd.google-apps.document'${i?` and ${i}`:""}&fields=files(id,name,modifiedTime,lastModifyingUser)&orderBy=modifiedTime desc`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json()).files||[]).map(this.parseDocsActivity).filter(Boolean)}catch(i){return console.error("Docs fetch failed:",i),[]}}async fetchSheetsActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockSheetsActivities();try{const i=t?`modifiedTime > '${t.toISOString()}'`:"";return((await(await fetch(`https://www.googleapis.com/drive/v3/files?q=mimeType='application/vnd.google-apps.spreadsheet'${i?` and ${i}`:""}&fields=files(id,name,modifiedTime,lastModifyingUser)&orderBy=modifiedTime desc`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json()).files||[]).map(this.parseSheetsActivity).filter(Boolean)}catch(i){return console.error("Sheets fetch failed:",i),[]}}async fetchAllActivities(e){const t=this.getStoredAccount();if(!t)return[];const[i,r,o,l]=await Promise.all([this.fetchGmailActivities(t,e),this.fetchCalendarActivities(t,e),this.fetchDocsActivities(t,e),this.fetchSheetsActivities(t,e)]);return[...i,...r,...o,...l].sort((u,f)=>new Date(f.startTime).getTime()-new Date(u.startTime).getTime())}parseGmailMessage(e){try{const t=e.payload.headers,i=t.find(u=>u.name==="Subject")?.value||"No Subject",r=t.find(u=>u.name==="From")?.value||"",o=t.find(u=>u.name==="To")?.value||"",l=t.find(u=>u.name==="Date")?.value;return{id:`gmail-${e.id}`,type:"gmail",title:`Email: ${i}`,description:`From: ${r}, To: ${o}`,startTime:new Date(l).toISOString(),duration:5,participants:[r,o].filter(Boolean),emailId:e.id,suggestedProject:this.suggestProject(i),suggestedClient:this.suggestClient(r+" "+o),confidence:.7,metadata:{subject:i,from:r,to:o,threadId:e.threadId}}}catch{return null}}parseCalendarEvent=e=>{try{const t=new Date(e.start?.dateTime||e.start?.date),i=new Date(e.end?.dateTime||e.end?.date),r=Math.round((i.getTime()-t.getTime())/(1e3*60));return{id:`calendar-${e.id}`,type:"calendar",title:e.summary||"Untitled Event",description:e.description||"",startTime:t.toISOString(),endTime:i.toISOString(),duration:r,participants:(e.attendees||[]).map(o=>o.email),calendarEventId:e.id,suggestedProject:this.suggestProject(e.summary||""),suggestedClient:this.suggestClient((e.attendees||[]).map(o=>o.email).join(" ")),confidence:.9,metadata:{location:e.location,hangoutLink:e.hangoutLink}}}catch{return null}};parseDocsActivity=e=>{try{const t=new Date(e.modifiedTime);return{id:`docs-${e.id}`,type:"docs",title:`Document: ${e.name}`,description:"Edited document",startTime:t.toISOString(),duration:30,documentId:e.id,suggestedProject:this.suggestProject(e.name),suggestedClient:this.suggestClient(e.name),confidence:.6,metadata:{fileName:e.name,lastModifyingUser:e.lastModifyingUser}}}catch{return null}};parseSheetsActivity=e=>{try{const t=new Date(e.modifiedTime);return{id:`sheets-${e.id}`,type:"sheets",title:`Spreadsheet: ${e.name}`,description:"Updated spreadsheet",startTime:t.toISOString(),duration:20,documentId:e.id,suggestedProject:this.suggestProject(e.name),suggestedClient:this.suggestClient(e.name),confidence:.6,metadata:{fileName:e.name,lastModifyingUser:e.lastModifyingUser}}}catch{return null}};suggestProject(e){const t={"project alpha":"Project Alpha",beta:"Project Beta",website:"Website Development",mobile:"Mobile App",api:"API Development",design:"Design Work",meeting:"Client Meetings",planning:"Project Planning"},i=e.toLowerCase();for(const[r,o]of Object.entries(t))if(i.includes(r))return o;return"General Work"}suggestClient(e){const t={acme:"Acme Corp",tech:"TechCorp",global:"Global Industries",startup:"Startup Inc",enterprise:"Enterprise Solutions"},i=e.toLowerCase();for(const[r,o]of Object.entries(t))if(i.includes(r))return o;return"Internal"}getMockGmailActivities(){return[{id:"gmail-1",type:"gmail",title:"Email: Project Alpha Status Update",description:"From: client@acme.com, To: me@company.com",startTime:new Date(Date.now()-2*60*60*1e3).toISOString(),duration:5,participants:["client@acme.com","me@company.com"],emailId:"msg-123",suggestedProject:"Project Alpha",suggestedClient:"Acme Corp",confidence:.8,metadata:{subject:"Project Alpha Status Update"}},{id:"gmail-2",type:"gmail",title:"Email: Meeting Follow-up",description:"From: me@company.com, To: team@techcorp.com",startTime:new Date(Date.now()-4*60*60*1e3).toISOString(),duration:3,participants:["me@company.com","team@techcorp.com"],emailId:"msg-124",suggestedProject:"Client Meetings",suggestedClient:"TechCorp",confidence:.7,metadata:{subject:"Meeting Follow-up"}}]}getMockCalendarActivities(){return[{id:"calendar-1",type:"calendar",title:"Project Alpha Planning Meeting",description:"Quarterly planning session for Project Alpha",startTime:new Date(Date.now()-1*60*60*1e3).toISOString(),endTime:new Date(Date.now()-0*60*60*1e3).toISOString(),duration:60,participants:["john@acme.com","sarah@acme.com"],calendarEventId:"cal-123",suggestedProject:"Project Alpha",suggestedClient:"Acme Corp",confidence:.9,metadata:{location:"Conference Room A"}}]}getMockDocsActivities(){return[{id:"docs-1",type:"docs",title:"Document: Project Specification",description:"Edited document",startTime:new Date(Date.now()-3*60*60*1e3).toISOString(),duration:45,documentId:"doc-123",suggestedProject:"Project Alpha",suggestedClient:"Acme Corp",confidence:.8,metadata:{fileName:"Project Specification"}}]}getMockSheetsActivities(){return[{id:"sheets-1",type:"sheets",title:"Spreadsheet: Budget Tracking",description:"Updated spreadsheet",startTime:new Date(Date.now()-5*60*60*1e3).toISOString(),duration:25,documentId:"sheet-123",suggestedProject:"Project Planning",suggestedClient:"Internal",confidence:.6,metadata:{fileName:"Budget Tracking"}}]}}const RR=new MR;function LR(){const[n,e]=W.useState("loading"),[t,i]=W.useState("Processing Google authentication..."),[r]=sE(),o=Jo();return W.useEffect(()=>{(async()=>{try{const u=r.get("code"),f=r.get("error"),m=r.get("state");if(f)throw new Error(`Authentication failed: ${f}`);if(!u)throw new Error("No authorization code received");const p=await RR.exchangeCodeForTokens(u);window.opener?(window.opener.postMessage({type:"GOOGLE_AUTH_SUCCESS",account:p},window.location.origin),window.close()):(e("success"),i("Google account connected successfully! Redirecting..."),setTimeout(()=>{o("/integrations")},2e3))}catch(u){console.error("OAuth callback error:",u),e("error"),i(u instanceof Error?u.message:"Authentication failed"),window.opener?(window.opener.postMessage({type:"GOOGLE_AUTH_ERROR",error:u instanceof Error?u.message:"Authentication failed"},window.location.origin),window.close()):setTimeout(()=>{o("/integrations")},3e3)}})()},[r,o]),d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center",children:[n==="loading"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connecting to Google"}),d.jsx("p",{className:"text-gray-600",children:t})]}),n==="success"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-green-100 rounded-full",children:d.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),d.jsx("h2",{className:"text-xl font-semibold text-green-900 mb-2",children:"Success!"}),d.jsx("p",{className:"text-green-600",children:t})]}),n==="error"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:d.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),d.jsx("h2",{className:"text-xl font-semibold text-red-900 mb-2",children:"Authentication Failed"}),d.jsx("p",{className:"text-red-600 mb-4",children:t}),d.jsx("button",{onClick:()=>o("/integrations"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Back to Integrations"})]})]})})}function IR(){return d.jsx(hE,{children:d.jsx(vE,{children:d.jsx(tE,{children:d.jsxs(Nw,{children:[d.jsx(jn,{path:"/login",element:d.jsx(_E,{})}),d.jsx(jn,{path:"/auth/google/callback",element:d.jsx(LR,{})}),d.jsx(jn,{path:"/:accountId/:visitorId/dashboard",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/reports",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/ai-insights",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/permissions",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/settings",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/privacy",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/integrations",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/dashboard",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/reports",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/ai-insights",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/permissions",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/settings",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/privacy",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/integrations",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/",element:d.jsx(tb,{to:"/dashboard",replace:!0})})]})})})})}zT.createRoot(document.getElementById("root")).render(d.jsx(zo.StrictMode,{children:d.jsx(IR,{})}));
