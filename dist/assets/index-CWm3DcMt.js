(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function op(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hm={exports:{}},tc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sv;function DT(){if(Sv)return tc;Sv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:n,type:i,key:l,ref:a!==void 0?a:null,props:o}}return tc.Fragment=e,tc.jsx=t,tc.jsxs=t,tc}var _v;function NT(){return _v||(_v=1,hm.exports=DT()),hm.exports}var d=NT(),mm={exports:{}},tt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tv;function OT(){if(Tv)return tt;Tv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function y(X){return X===null||typeof X!="object"?null:(X=v&&X[v]||X["@@iterator"],typeof X=="function"?X:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,x={};function T(X,pe,P){this.props=X,this.context=pe,this.refs=x,this.updater=P||S}T.prototype.isReactComponent={},T.prototype.setState=function(X,pe){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,pe,"setState")},T.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function w(){}w.prototype=T.prototype;function E(X,pe,P){this.props=X,this.context=pe,this.refs=x,this.updater=P||S}var C=E.prototype=new w;C.constructor=E,_(C,T.prototype),C.isPureReactComponent=!0;var N=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function D(X,pe,P,Y,V,q){return P=q.ref,{$$typeof:n,type:X,key:pe,ref:P!==void 0?P:null,props:q}}function z(X,pe){return D(X.type,pe,void 0,void 0,void 0,X.props)}function L(X){return typeof X=="object"&&X!==null&&X.$$typeof===n}function H(X){var pe={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(P){return pe[P]})}var K=/\/+/g;function ne(X,pe){return typeof X=="object"&&X!==null&&X.key!=null?H(""+X.key):pe.toString(36)}function xe(){}function He(X){switch(X.status){case"fulfilled":return X.value;case"rejected":throw X.reason;default:switch(typeof X.status=="string"?X.then(xe,xe):(X.status="pending",X.then(function(pe){X.status==="pending"&&(X.status="fulfilled",X.value=pe)},function(pe){X.status==="pending"&&(X.status="rejected",X.reason=pe)})),X.status){case"fulfilled":return X.value;case"rejected":throw X.reason}}throw X}function _e(X,pe,P,Y,V){var q=typeof X;(q==="undefined"||q==="boolean")&&(X=null);var re=!1;if(X===null)re=!0;else switch(q){case"bigint":case"string":case"number":re=!0;break;case"object":switch(X.$$typeof){case n:case e:re=!0;break;case p:return re=X._init,_e(re(X._payload),pe,P,Y,V)}}if(re)return V=V(X),re=Y===""?"."+ne(X,0):Y,N(V)?(P="",re!=null&&(P=re.replace(K,"$&/")+"/"),_e(V,pe,P,"",function(Le){return Le})):V!=null&&(L(V)&&(V=z(V,P+(V.key==null||X&&X.key===V.key?"":(""+V.key).replace(K,"$&/")+"/")+re)),pe.push(V)),1;re=0;var Me=Y===""?".":Y+":";if(N(X))for(var Ce=0;Ce<X.length;Ce++)Y=X[Ce],q=Me+ne(Y,Ce),re+=_e(Y,pe,P,q,V);else if(Ce=y(X),typeof Ce=="function")for(X=Ce.call(X),Ce=0;!(Y=X.next()).done;)Y=Y.value,q=Me+ne(Y,Ce++),re+=_e(Y,pe,P,q,V);else if(q==="object"){if(typeof X.then=="function")return _e(He(X),pe,P,Y,V);throw pe=String(X),Error("Objects are not valid as a React child (found: "+(pe==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":pe)+"). If you meant to render a collection of children, use an array instead.")}return re}function ie(X,pe,P){if(X==null)return X;var Y=[],V=0;return _e(X,Y,"","",function(q){return pe.call(P,q,V++)}),Y}function he(X){if(X._status===-1){var pe=X._result;pe=pe(),pe.then(function(P){(X._status===0||X._status===-1)&&(X._status=1,X._result=P)},function(P){(X._status===0||X._status===-1)&&(X._status=2,X._result=P)}),X._status===-1&&(X._status=0,X._result=pe)}if(X._status===1)return X._result.default;throw X._result}var Ne=typeof reportError=="function"?reportError:function(X){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof X=="object"&&X!==null&&typeof X.message=="string"?String(X.message):String(X),error:X});if(!window.dispatchEvent(pe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",X);return}console.error(X)};function Be(){}return tt.Children={map:ie,forEach:function(X,pe,P){ie(X,function(){pe.apply(this,arguments)},P)},count:function(X){var pe=0;return ie(X,function(){pe++}),pe},toArray:function(X){return ie(X,function(pe){return pe})||[]},only:function(X){if(!L(X))throw Error("React.Children.only expected to receive a single React element child.");return X}},tt.Component=T,tt.Fragment=t,tt.Profiler=a,tt.PureComponent=E,tt.StrictMode=i,tt.Suspense=f,tt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,tt.__COMPILER_RUNTIME={__proto__:null,c:function(X){return A.H.useMemoCache(X)}},tt.cache=function(X){return function(){return X.apply(null,arguments)}},tt.cloneElement=function(X,pe,P){if(X==null)throw Error("The argument must be a React element, but you passed "+X+".");var Y=_({},X.props),V=X.key,q=void 0;if(pe!=null)for(re in pe.ref!==void 0&&(q=void 0),pe.key!==void 0&&(V=""+pe.key),pe)!I.call(pe,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&pe.ref===void 0||(Y[re]=pe[re]);var re=arguments.length-2;if(re===1)Y.children=P;else if(1<re){for(var Me=Array(re),Ce=0;Ce<re;Ce++)Me[Ce]=arguments[Ce+2];Y.children=Me}return D(X.type,V,void 0,void 0,q,Y)},tt.createContext=function(X){return X={$$typeof:l,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null},X.Provider=X,X.Consumer={$$typeof:o,_context:X},X},tt.createElement=function(X,pe,P){var Y,V={},q=null;if(pe!=null)for(Y in pe.key!==void 0&&(q=""+pe.key),pe)I.call(pe,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(V[Y]=pe[Y]);var re=arguments.length-2;if(re===1)V.children=P;else if(1<re){for(var Me=Array(re),Ce=0;Ce<re;Ce++)Me[Ce]=arguments[Ce+2];V.children=Me}if(X&&X.defaultProps)for(Y in re=X.defaultProps,re)V[Y]===void 0&&(V[Y]=re[Y]);return D(X,q,void 0,void 0,null,V)},tt.createRef=function(){return{current:null}},tt.forwardRef=function(X){return{$$typeof:u,render:X}},tt.isValidElement=L,tt.lazy=function(X){return{$$typeof:p,_payload:{_status:-1,_result:X},_init:he}},tt.memo=function(X,pe){return{$$typeof:m,type:X,compare:pe===void 0?null:pe}},tt.startTransition=function(X){var pe=A.T,P={};A.T=P;try{var Y=X(),V=A.S;V!==null&&V(P,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(Be,Ne)}catch(q){Ne(q)}finally{A.T=pe}},tt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},tt.use=function(X){return A.H.use(X)},tt.useActionState=function(X,pe,P){return A.H.useActionState(X,pe,P)},tt.useCallback=function(X,pe){return A.H.useCallback(X,pe)},tt.useContext=function(X){return A.H.useContext(X)},tt.useDebugValue=function(){},tt.useDeferredValue=function(X,pe){return A.H.useDeferredValue(X,pe)},tt.useEffect=function(X,pe,P){var Y=A.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(X,pe)},tt.useId=function(){return A.H.useId()},tt.useImperativeHandle=function(X,pe,P){return A.H.useImperativeHandle(X,pe,P)},tt.useInsertionEffect=function(X,pe){return A.H.useInsertionEffect(X,pe)},tt.useLayoutEffect=function(X,pe){return A.H.useLayoutEffect(X,pe)},tt.useMemo=function(X,pe){return A.H.useMemo(X,pe)},tt.useOptimistic=function(X,pe){return A.H.useOptimistic(X,pe)},tt.useReducer=function(X,pe,P){return A.H.useReducer(X,pe,P)},tt.useRef=function(X){return A.H.useRef(X)},tt.useState=function(X){return A.H.useState(X)},tt.useSyncExternalStore=function(X,pe,P){return A.H.useSyncExternalStore(X,pe,P)},tt.useTransition=function(){return A.H.useTransition()},tt.version="19.1.0",tt}var wv;function lp(){return wv||(wv=1,mm.exports=OT()),mm.exports}var W=lp();const zo=op(W);var pm={exports:{}},nc={},gm={exports:{}},vm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ev;function RT(){return Ev||(Ev=1,function(n){function e(ie,he){var Ne=ie.length;ie.push(he);e:for(;0<Ne;){var Be=Ne-1>>>1,X=ie[Be];if(0<a(X,he))ie[Be]=he,ie[Ne]=X,Ne=Be;else break e}}function t(ie){return ie.length===0?null:ie[0]}function i(ie){if(ie.length===0)return null;var he=ie[0],Ne=ie.pop();if(Ne!==he){ie[0]=Ne;e:for(var Be=0,X=ie.length,pe=X>>>1;Be<pe;){var P=2*(Be+1)-1,Y=ie[P],V=P+1,q=ie[V];if(0>a(Y,Ne))V<X&&0>a(q,Y)?(ie[Be]=q,ie[V]=Ne,Be=V):(ie[Be]=Y,ie[P]=Ne,Be=P);else if(V<X&&0>a(q,Ne))ie[Be]=q,ie[V]=Ne,Be=V;else break e}}return he}function a(ie,he){var Ne=ie.sortIndex-he.sortIndex;return Ne!==0?Ne:ie.id-he.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var f=[],m=[],p=1,v=null,y=3,S=!1,_=!1,x=!1,T=!1,w=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function N(ie){for(var he=t(m);he!==null;){if(he.callback===null)i(m);else if(he.startTime<=ie)i(m),he.sortIndex=he.expirationTime,e(f,he);else break;he=t(m)}}function A(ie){if(x=!1,N(ie),!_)if(t(f)!==null)_=!0,I||(I=!0,ne());else{var he=t(m);he!==null&&_e(A,he.startTime-ie)}}var I=!1,D=-1,z=5,L=-1;function H(){return T?!0:!(n.unstable_now()-L<z)}function K(){if(T=!1,I){var ie=n.unstable_now();L=ie;var he=!0;try{e:{_=!1,x&&(x=!1,E(D),D=-1),S=!0;var Ne=y;try{t:{for(N(ie),v=t(f);v!==null&&!(v.expirationTime>ie&&H());){var Be=v.callback;if(typeof Be=="function"){v.callback=null,y=v.priorityLevel;var X=Be(v.expirationTime<=ie);if(ie=n.unstable_now(),typeof X=="function"){v.callback=X,N(ie),he=!0;break t}v===t(f)&&i(f),N(ie)}else i(f);v=t(f)}if(v!==null)he=!0;else{var pe=t(m);pe!==null&&_e(A,pe.startTime-ie),he=!1}}break e}finally{v=null,y=Ne,S=!1}he=void 0}}finally{he?ne():I=!1}}}var ne;if(typeof C=="function")ne=function(){C(K)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,He=xe.port2;xe.port1.onmessage=K,ne=function(){He.postMessage(null)}}else ne=function(){w(K,0)};function _e(ie,he){D=w(function(){ie(n.unstable_now())},he)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(ie){switch(y){case 1:case 2:case 3:var he=3;break;default:he=y}var Ne=y;y=he;try{return ie()}finally{y=Ne}},n.unstable_requestPaint=function(){T=!0},n.unstable_runWithPriority=function(ie,he){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Ne=y;y=ie;try{return he()}finally{y=Ne}},n.unstable_scheduleCallback=function(ie,he,Ne){var Be=n.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?Be+Ne:Be):Ne=Be,ie){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Ne+X,ie={id:p++,callback:he,priorityLevel:ie,startTime:Ne,expirationTime:X,sortIndex:-1},Ne>Be?(ie.sortIndex=Ne,e(m,ie),t(f)===null&&ie===t(m)&&(x?(E(D),D=-1):x=!0,_e(A,Ne-Be))):(ie.sortIndex=X,e(f,ie),_||S||(_=!0,I||(I=!0,ne()))),ie},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(ie){var he=y;return function(){var Ne=y;y=he;try{return ie.apply(this,arguments)}finally{y=Ne}}}}(vm)),vm}var Av;function MT(){return Av||(Av=1,gm.exports=RT()),gm.exports}var ym={exports:{}},$n={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function LT(){if(kv)return $n;kv=1;var n=lp();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,m,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:f,containerInfo:m,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return $n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,$n.createPortal=function(f,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(f,m,null,p)},$n.flushSync=function(f){var m=l.T,p=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=m,i.p=p,i.d.f()}},$n.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(f,m))},$n.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},$n.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?i.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:S}):p==="script"&&i.d.X(f,{crossOrigin:v,integrity:y,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},$n.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(f)},$n.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin);i.d.L(f,p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},$n.preloadModule=function(f,m){if(typeof f=="string")if(m){var p=u(m.as,m.crossOrigin);i.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(f)},$n.requestFormReset=function(f){i.d.r(f)},$n.unstable_batchedUpdates=function(f,m){return f(m)},$n.useFormState=function(f,m,p){return l.H.useFormState(f,m,p)},$n.useFormStatus=function(){return l.H.useHostTransitionStatus()},$n.version="19.1.0",$n}var Cv;function IT(){if(Cv)return ym.exports;Cv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ym.exports=LT(),ym.exports}var jv;function PT(){if(jv)return nc;jv=1;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=MT(),e=lp(),t=IT();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var s=r,c=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(c=s.return),r=s.return;while(r)}return s.tag===3?c:null}function l(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function u(r){if(o(r)!==r)throw Error(i(188))}function f(r){var s=r.alternate;if(!s){if(s=o(r),s===null)throw Error(i(188));return s!==r?null:r}for(var c=r,h=s;;){var g=c.return;if(g===null)break;var b=g.alternate;if(b===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===c)return u(g),r;if(b===h)return u(g),s;b=b.sibling}throw Error(i(188))}if(c.return!==h.return)c=g,h=b;else{for(var k=!1,O=g.child;O;){if(O===c){k=!0,c=g,h=b;break}if(O===h){k=!0,h=g,c=b;break}O=O.sibling}if(!k){for(O=b.child;O;){if(O===c){k=!0,c=b,h=g;break}if(O===h){k=!0,h=b,c=g;break}O=O.sibling}if(!k)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?r:s}function m(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=m(r),s!==null)return s;r=r.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),C=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function ne(r){return r===null||typeof r!="object"?null:(r=K&&r[K]||r["@@iterator"],typeof r=="function"?r:null)}var xe=Symbol.for("react.client.reference");function He(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===xe?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case _:return"Fragment";case T:return"Profiler";case x:return"StrictMode";case A:return"Suspense";case I:return"SuspenseList";case L:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case S:return"Portal";case C:return(r.displayName||"Context")+".Provider";case E:return(r._context.displayName||"Context")+".Consumer";case N:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case D:return s=r.displayName||null,s!==null?s:He(r.type)||"Memo";case z:s=r._payload,r=r._init;try{return He(r(s))}catch{}}return null}var _e=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne={pending:!1,data:null,method:null,action:null},Be=[],X=-1;function pe(r){return{current:r}}function P(r){0>X||(r.current=Be[X],Be[X]=null,X--)}function Y(r,s){X++,Be[X]=r.current,r.current=s}var V=pe(null),q=pe(null),re=pe(null),Me=pe(null);function Ce(r,s){switch(Y(re,s),Y(q,r),Y(V,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?q1(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=q1(s),r=K1(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}P(V),Y(V,r)}function Le(){P(V),P(q),P(re)}function Ae(r){r.memoizedState!==null&&Y(Me,r);var s=V.current,c=K1(s,r.type);s!==c&&(Y(q,r),Y(V,c))}function ct(r){q.current===r&&(P(V),P(q)),Me.current===r&&(P(Me),Kl._currentValue=Ne)}var Je=Object.prototype.hasOwnProperty,Ht=n.unstable_scheduleCallback,at=n.unstable_cancelCallback,Gn=n.unstable_shouldYield,gt=n.unstable_requestPaint,Re=n.unstable_now,wn=n.unstable_getCurrentPriorityLevel,Rn=n.unstable_ImmediatePriority,ei=n.unstable_UserBlockingPriority,ti=n.unstable_NormalPriority,Qe=n.unstable_LowPriority,Fe=n.unstable_IdlePriority,Ye=n.log,Ze=n.unstable_setDisableYieldValue,Ot=null,wt=null;function Wt(r){if(typeof Ye=="function"&&Ze(r),wt&&typeof wt.setStrictMode=="function")try{wt.setStrictMode(Ot,r)}catch{}}var J=Math.clz32?Math.clz32:Ve,ke=Math.log,$e=Math.LN2;function Ve(r){return r>>>=0,r===0?32:31-(ke(r)/$e|0)|0}var et=256,dt=4194304;function $t(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Yn(r,s,c){var h=r.pendingLanes;if(h===0)return 0;var g=0,b=r.suspendedLanes,k=r.pingedLanes;r=r.warmLanes;var O=h&134217727;return O!==0?(h=O&~b,h!==0?g=$t(h):(k&=O,k!==0?g=$t(k):c||(c=O&~r,c!==0&&(g=$t(c))))):(O=h&~b,O!==0?g=$t(O):k!==0?g=$t(k):c||(c=h&~r,c!==0&&(g=$t(c)))),g===0?0:s!==0&&s!==g&&(s&b)===0&&(b=g&-g,c=s&-s,b>=c||b===32&&(c&4194048)!==0)?s:g}function Ui(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function ut(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ra(){var r=et;return et<<=1,(et&4194048)===0&&(et=256),r}function wi(){var r=dt;return dt<<=1,(dt&62914560)===0&&(dt=4194304),r}function xa(r){for(var s=[],c=0;31>c;c++)s.push(r);return s}function qt(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function zi(r,s,c,h,g,b){var k=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var O=r.entanglements,G=r.expirationTimes,oe=r.hiddenUpdates;for(c=k&~c;0<c;){var ge=31-J(c),ye=1<<ge;O[ge]=0,G[ge]=-1;var ce=oe[ge];if(ce!==null)for(oe[ge]=null,ge=0;ge<ce.length;ge++){var fe=ce[ge];fe!==null&&(fe.lane&=-536870913)}c&=~ye}h!==0&&vr(r,h,0),b!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=b&~(k&~s))}function vr(r,s,c){r.pendingLanes|=s,r.suspendedLanes&=~s;var h=31-J(s);r.entangledLanes|=s,r.entanglements[h]=r.entanglements[h]|1073741824|c&4194090}function qs(r,s){var c=r.entangledLanes|=s;for(r=r.entanglements;c;){var h=31-J(c),g=1<<h;g&s|r[h]&s&&(r[h]|=s),c&=~g}}function rs(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ss(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ks(){var r=he.p;return r!==0?r:(r=window.event,r===void 0?32:pv(r.type))}function yn(r,s){var c=he.p;try{return he.p=r,s()}finally{he.p=c}}var li=Math.random().toString(36).slice(2),Jt="__reactFiber$"+li,en="__reactProps$"+li,ba="__reactContainer$"+li,os="__reactEvents$"+li,rl="__reactListeners$"+li,j="__reactHandles$"+li,U="__reactResources$"+li,R="__reactMarker$"+li;function M(r){delete r[Jt],delete r[en],delete r[os],delete r[rl],delete r[j]}function F(r){var s=r[Jt];if(s)return s;for(var c=r.parentNode;c;){if(s=c[ba]||c[Jt]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(r=ev(r);r!==null;){if(c=r[Jt])return c;r=ev(r)}return s}r=c,c=r.parentNode}return null}function B(r){if(r=r[Jt]||r[ba]){var s=r.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return r}return null}function se(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function ue(r){var s=r[U];return s||(s=r[U]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ee(r){r[R]=!0}var le=new Set,de={};function Se(r,s){Ee(r,s),Ee(r+"Capture",s)}function Ee(r,s){for(de[r]=s,r=0;r<s.length;r++)le.add(s[r])}var Ie=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Te={},Oe={};function Ge(r){return Je.call(Oe,r)?!0:Je.call(Te,r)?!1:Ie.test(r)?Oe[r]=!0:(Te[r]=!0,!1)}function vt(r,s,c){if(Ge(s))if(c===null)r.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+c)}}function yt(r,s,c){if(c===null)r.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+c)}}function ht(r,s,c,h){if(h===null)r.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(s,c,""+h)}}var ci,Ei;function ni(r){if(ci===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);ci=s&&s[1]||"",Ei=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ci+r+Ei}var ui=!1;function Ua(r,s){if(!r||ui)return"";ui=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(fe){var ce=fe}Reflect.construct(r,[],ye)}else{try{ye.call()}catch(fe){ce=fe}r.call(ye.prototype)}}else{try{throw Error()}catch(fe){ce=fe}(ye=r())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(fe){if(fe&&ce&&typeof fe.stack=="string")return[fe.stack,ce.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=h.DetermineComponentFrameRoot(),k=b[0],O=b[1];if(k&&O){var G=k.split(`
`),oe=O.split(`
`);for(g=h=0;h<G.length&&!G[h].includes("DetermineComponentFrameRoot");)h++;for(;g<oe.length&&!oe[g].includes("DetermineComponentFrameRoot");)g++;if(h===G.length||g===oe.length)for(h=G.length-1,g=oe.length-1;1<=h&&0<=g&&G[h]!==oe[g];)g--;for(;1<=h&&0<=g;h--,g--)if(G[h]!==oe[g]){if(h!==1||g!==1)do if(h--,g--,0>g||G[h]!==oe[g]){var ge=`
`+G[h].replace(" at new "," at ");return r.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",r.displayName)),ge}while(1<=h&&0<=g);break}}}finally{ui=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?ni(c):""}function ii(r){switch(r.tag){case 26:case 27:case 5:return ni(r.type);case 16:return ni("Lazy");case 13:return ni("Suspense");case 19:return ni("SuspenseList");case 0:case 15:return Ua(r.type,!1);case 11:return Ua(r.type.render,!1);case 1:return Ua(r.type,!0);case 31:return ni("Activity");default:return""}}function yr(r){try{var s="";do s+=ii(r),r=r.return;while(r);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function xn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function za(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function eu(r){var s=za(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),h=""+r[s];if(!r.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,b=c.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return g.call(this)},set:function(k){h=""+k,b.call(this,k)}}),Object.defineProperty(r,s,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(k){h=""+k},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ls(r){r._valueTracker||(r._valueTracker=eu(r))}function sl(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var c=s.getValue(),h="";return r&&(h=za(r)?r.checked?"true":"false":r.value),r=h,r!==c?(s.setValue(r),!0):!1}function xr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var tu=/[\n"\\]/g;function Mn(r){return r.replace(tu,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function br(r,s,c,h,g,b,k,O){r.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?r.type=k:r.removeAttribute("type"),s!=null?k==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+xn(s)):r.value!==""+xn(s)&&(r.value=""+xn(s)):k!=="submit"&&k!=="reset"||r.removeAttribute("value"),s!=null?Sa(r,k,xn(s)):c!=null?Sa(r,k,xn(c)):h!=null&&r.removeAttribute("value"),g==null&&b!=null&&(r.defaultChecked=!!b),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?r.name=""+xn(O):r.removeAttribute("name")}function Hi(r,s,c,h,g,b,k,O){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.type=b),s!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||s!=null))return;c=c!=null?""+xn(c):"",s=s!=null?""+xn(s):c,O||s===r.value||(r.value=s),r.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,r.checked=O?r.checked:!!h,r.defaultChecked=!!h,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(r.name=k)}function Sa(r,s,c){s==="number"&&xr(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function _a(r,s,c,h){if(r=r.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<r.length;c++)g=s.hasOwnProperty("$"+r[c].value),r[c].selected!==g&&(r[c].selected=g),g&&h&&(r[c].defaultSelected=!0)}else{for(c=""+xn(c),s=null,g=0;g<r.length;g++){if(r[g].value===c){r[g].selected=!0,h&&(r[g].defaultSelected=!0);return}s!==null||r[g].disabled||(s=r[g])}s!==null&&(s.selected=!0)}}function Zs(r,s,c){if(s!=null&&(s=""+xn(s),s!==r.value&&(r.value=s),c==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=c!=null?""+xn(c):""}function nu(r,s,c,h){if(s==null){if(h!=null){if(c!=null)throw Error(i(92));if(_e(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),s=c}c=xn(s),r.defaultValue=c,h=r.textContent,h===c&&h!==""&&h!==null&&(r.value=h)}function sa(r,s){if(s){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=s;return}}r.textContent=s}var Qs=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function iu(r,s,c){var h=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":h?r.setProperty(s,c):typeof c!="number"||c===0||Qs.has(s)?s==="float"?r.cssFloat=c:r[s]=(""+c).trim():r[s]=c+"px"}function Sr(r,s,c){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?r.setProperty(h,""):h==="float"?r.cssFloat="":r[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&c[g]!==h&&iu(r,g,h)}else for(var b in s)s.hasOwnProperty(b)&&iu(r,b,s[b])}function ol(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),un=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function oa(r){return un.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var ll=null;function Js(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ta=null,Ha=null;function cl(r){var s=B(r);if(s&&(r=s.stateNode)){var c=r[en]||null;e:switch(r=s.stateNode,s.type){case"input":if(br(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Mn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var h=c[s];if(h!==r&&h.form===r.form){var g=h[en]||null;if(!g)throw Error(i(90));br(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)h=c[s],h.form===r.form&&sl(h)}break e;case"textarea":Zs(r,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&_a(r,!!c.multiple,s,!1)}}}var ul=!1;function Ai(r,s,c){if(ul)return r(s,c);ul=!0;try{var h=r(s);return h}finally{if(ul=!1,(Ta!==null||Ha!==null)&&(Fu(),Ta&&(s=Ta,r=Ha,Ha=Ta=null,cl(s),r)))for(s=0;s<r.length;s++)cl(r[s])}}function Wi(r,s){var c=r.stateNode;if(c===null)return null;var h=c[en]||null;if(h===null)return null;c=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(i(231,s,typeof c));return c}var Vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eo=!1;if(Vi)try{var Wa={};Object.defineProperty(Wa,"passive",{get:function(){eo=!0}}),window.addEventListener("test",Wa,Wa),window.removeEventListener("test",Wa,Wa)}catch{eo=!1}var la=null,ki=null,cs=null;function dl(){if(cs)return cs;var r,s=ki,c=s.length,h,g="value"in la?la.value:la.textContent,b=g.length;for(r=0;r<c&&s[r]===g[r];r++);var k=c-r;for(h=1;h<=k&&s[c-h]===g[b-h];h++);return cs=g.slice(r,1<h?1-h:void 0)}function us(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function ds(){return!0}function au(){return!1}function Pe(r){function s(c,h,g,b,k){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=b,this.target=k,this.currentTarget=null;for(var O in r)r.hasOwnProperty(O)&&(c=r[O],this[O]=c?c(b):b[O]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?ds:au,this.isPropagationStopped=au,this}return p(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ds)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ds)},persist:function(){},isPersistent:ds}),s}var Z={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},we=Pe(Z),Ue=p({},Z,{view:0,detail:0}),Ft=Pe(Ue),dn,Kt,fn,di=p({},Ue,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==fn&&(fn&&r.type==="mousemove"?(dn=r.screenX-fn.screenX,Kt=r.screenY-fn.screenY):Kt=dn=0,fn=r),dn)},movementY:function(r){return"movementY"in r?r.movementY:Kt}}),_r=Pe(di),fl=p({},di,{dataTransfer:0}),En=Pe(fl),ru=p({},Ue,{relatedTarget:0}),to=Pe(ru),M_=p({},Z,{animationName:0,elapsedTime:0,pseudoElement:0}),L_=Pe(M_),I_=p({},Z,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),P_=Pe(I_),B_=p({},Z,{data:0}),ng=Pe(B_),F_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},U_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H_(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=z_[r])?!!s[r]:!1}function Sf(){return H_}var W_=p({},Ue,{key:function(r){if(r.key){var s=F_[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=us(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?U_[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sf,charCode:function(r){return r.type==="keypress"?us(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?us(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),V_=Pe(W_),G_=p({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ig=Pe(G_),Y_=p({},Ue,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sf}),X_=Pe(Y_),$_=p({},Z,{propertyName:0,elapsedTime:0,pseudoElement:0}),q_=Pe($_),K_=p({},di,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Z_=Pe(K_),Q_=p({},Z,{newState:0,oldState:0}),J_=Pe(Q_),e2=[9,13,27,32],_f=Vi&&"CompositionEvent"in window,hl=null;Vi&&"documentMode"in document&&(hl=document.documentMode);var t2=Vi&&"TextEvent"in window&&!hl,ag=Vi&&(!_f||hl&&8<hl&&11>=hl),rg=" ",sg=!1;function og(r,s){switch(r){case"keyup":return e2.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lg(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var no=!1;function n2(r,s){switch(r){case"compositionend":return lg(s);case"keypress":return s.which!==32?null:(sg=!0,rg);case"textInput":return r=s.data,r===rg&&sg?null:r;default:return null}}function i2(r,s){if(no)return r==="compositionend"||!_f&&og(r,s)?(r=dl(),cs=ki=la=null,no=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ag&&s.locale!=="ko"?null:s.data;default:return null}}var a2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cg(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!a2[r.type]:s==="textarea"}function ug(r,s,c,h){Ta?Ha?Ha.push(h):Ha=[h]:Ta=h,s=Gu(s,"onChange"),0<s.length&&(c=new we("onChange","change",null,c,h),r.push({event:c,listeners:s}))}var ml=null,pl=null;function r2(r){V1(r,0)}function su(r){var s=se(r);if(sl(s))return r}function dg(r,s){if(r==="change")return s}var fg=!1;if(Vi){var Tf;if(Vi){var wf="oninput"in document;if(!wf){var hg=document.createElement("div");hg.setAttribute("oninput","return;"),wf=typeof hg.oninput=="function"}Tf=wf}else Tf=!1;fg=Tf&&(!document.documentMode||9<document.documentMode)}function mg(){ml&&(ml.detachEvent("onpropertychange",pg),pl=ml=null)}function pg(r){if(r.propertyName==="value"&&su(pl)){var s=[];ug(s,pl,r,Js(r)),Ai(r2,s)}}function s2(r,s,c){r==="focusin"?(mg(),ml=s,pl=c,ml.attachEvent("onpropertychange",pg)):r==="focusout"&&mg()}function o2(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return su(pl)}function l2(r,s){if(r==="click")return su(s)}function c2(r,s){if(r==="input"||r==="change")return su(s)}function u2(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Ci=typeof Object.is=="function"?Object.is:u2;function gl(r,s){if(Ci(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var c=Object.keys(r),h=Object.keys(s);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!Je.call(s,g)||!Ci(r[g],s[g]))return!1}return!0}function gg(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function vg(r,s){var c=gg(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=s&&h>=s)return{node:c,offset:s-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=gg(c)}}function yg(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?yg(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function xg(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=xr(r.document);s instanceof r.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)r=s.contentWindow;else break;s=xr(r.document)}return s}function Ef(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var d2=Vi&&"documentMode"in document&&11>=document.documentMode,io=null,Af=null,vl=null,kf=!1;function bg(r,s,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;kf||io==null||io!==xr(h)||(h=io,"selectionStart"in h&&Ef(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),vl&&gl(vl,h)||(vl=h,h=Gu(Af,"onSelect"),0<h.length&&(s=new we("onSelect","select",null,s,c),r.push({event:s,listeners:h}),s.target=io)))}function fs(r,s){var c={};return c[r.toLowerCase()]=s.toLowerCase(),c["Webkit"+r]="webkit"+s,c["Moz"+r]="moz"+s,c}var ao={animationend:fs("Animation","AnimationEnd"),animationiteration:fs("Animation","AnimationIteration"),animationstart:fs("Animation","AnimationStart"),transitionrun:fs("Transition","TransitionRun"),transitionstart:fs("Transition","TransitionStart"),transitioncancel:fs("Transition","TransitionCancel"),transitionend:fs("Transition","TransitionEnd")},Cf={},Sg={};Vi&&(Sg=document.createElement("div").style,"AnimationEvent"in window||(delete ao.animationend.animation,delete ao.animationiteration.animation,delete ao.animationstart.animation),"TransitionEvent"in window||delete ao.transitionend.transition);function hs(r){if(Cf[r])return Cf[r];if(!ao[r])return r;var s=ao[r],c;for(c in s)if(s.hasOwnProperty(c)&&c in Sg)return Cf[r]=s[c];return r}var _g=hs("animationend"),Tg=hs("animationiteration"),wg=hs("animationstart"),f2=hs("transitionrun"),h2=hs("transitionstart"),m2=hs("transitioncancel"),Eg=hs("transitionend"),Ag=new Map,jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jf.push("scrollEnd");function ca(r,s){Ag.set(r,s),Se(s,[r])}var kg=new WeakMap;function Gi(r,s){if(typeof r=="object"&&r!==null){var c=kg.get(r);return c!==void 0?c:(s={value:r,source:s,stack:yr(s)},kg.set(r,s),s)}return{value:r,source:s,stack:yr(s)}}var Yi=[],ro=0,Df=0;function ou(){for(var r=ro,s=Df=ro=0;s<r;){var c=Yi[s];Yi[s++]=null;var h=Yi[s];Yi[s++]=null;var g=Yi[s];Yi[s++]=null;var b=Yi[s];if(Yi[s++]=null,h!==null&&g!==null){var k=h.pending;k===null?g.next=g:(g.next=k.next,k.next=g),h.pending=g}b!==0&&Cg(c,g,b)}}function lu(r,s,c,h){Yi[ro++]=r,Yi[ro++]=s,Yi[ro++]=c,Yi[ro++]=h,Df|=h,r.lanes|=h,r=r.alternate,r!==null&&(r.lanes|=h)}function Nf(r,s,c,h){return lu(r,s,c,h),cu(r)}function so(r,s){return lu(r,null,null,s),cu(r)}function Cg(r,s,c){r.lanes|=c;var h=r.alternate;h!==null&&(h.lanes|=c);for(var g=!1,b=r.return;b!==null;)b.childLanes|=c,h=b.alternate,h!==null&&(h.childLanes|=c),b.tag===22&&(r=b.stateNode,r===null||r._visibility&1||(g=!0)),r=b,b=b.return;return r.tag===3?(b=r.stateNode,g&&s!==null&&(g=31-J(c),r=b.hiddenUpdates,h=r[g],h===null?r[g]=[s]:h.push(s),s.lane=c|536870912),b):null}function cu(r){if(50<Hl)throw Hl=0,Ph=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var oo={};function p2(r,s,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ji(r,s,c,h){return new p2(r,s,c,h)}function Of(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Va(r,s){var c=r.alternate;return c===null?(c=ji(r.tag,s,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=s,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,s=r.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function jg(r,s){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,s=c.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function uu(r,s,c,h,g,b){var k=0;if(h=r,typeof r=="function")Of(r)&&(k=1);else if(typeof r=="string")k=vT(r,c,V.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case L:return r=ji(31,c,s,g),r.elementType=L,r.lanes=b,r;case _:return ms(c.children,g,b,s);case x:k=8,g|=24;break;case T:return r=ji(12,c,s,g|2),r.elementType=T,r.lanes=b,r;case A:return r=ji(13,c,s,g),r.elementType=A,r.lanes=b,r;case I:return r=ji(19,c,s,g),r.elementType=I,r.lanes=b,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case w:case C:k=10;break e;case E:k=9;break e;case N:k=11;break e;case D:k=14;break e;case z:k=16,h=null;break e}k=29,c=Error(i(130,r===null?"null":typeof r,"")),h=null}return s=ji(k,c,s,g),s.elementType=r,s.type=h,s.lanes=b,s}function ms(r,s,c,h){return r=ji(7,r,h,s),r.lanes=c,r}function Rf(r,s,c){return r=ji(6,r,null,s),r.lanes=c,r}function Mf(r,s,c){return s=ji(4,r.children!==null?r.children:[],r.key,s),s.lanes=c,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var lo=[],co=0,du=null,fu=0,Xi=[],$i=0,ps=null,Ga=1,Ya="";function gs(r,s){lo[co++]=fu,lo[co++]=du,du=r,fu=s}function Dg(r,s,c){Xi[$i++]=Ga,Xi[$i++]=Ya,Xi[$i++]=ps,ps=r;var h=Ga;r=Ya;var g=32-J(h)-1;h&=~(1<<g),c+=1;var b=32-J(s)+g;if(30<b){var k=g-g%5;b=(h&(1<<k)-1).toString(32),h>>=k,g-=k,Ga=1<<32-J(s)+g|c<<g|h,Ya=b+r}else Ga=1<<b|c<<g|h,Ya=r}function Lf(r){r.return!==null&&(gs(r,1),Dg(r,1,0))}function If(r){for(;r===du;)du=lo[--co],lo[co]=null,fu=lo[--co],lo[co]=null;for(;r===ps;)ps=Xi[--$i],Xi[$i]=null,Ya=Xi[--$i],Xi[$i]=null,Ga=Xi[--$i],Xi[$i]=null}var ai=null,tn=null,St=!1,vs=null,wa=!1,Pf=Error(i(519));function ys(r){var s=Error(i(418,""));throw bl(Gi(s,r)),Pf}function Ng(r){var s=r.stateNode,c=r.type,h=r.memoizedProps;switch(s[Jt]=r,s[en]=h,c){case"dialog":lt("cancel",s),lt("close",s);break;case"iframe":case"object":case"embed":lt("load",s);break;case"video":case"audio":for(c=0;c<Vl.length;c++)lt(Vl[c],s);break;case"source":lt("error",s);break;case"img":case"image":case"link":lt("error",s),lt("load",s);break;case"details":lt("toggle",s);break;case"input":lt("invalid",s),Hi(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),ls(s);break;case"select":lt("invalid",s);break;case"textarea":lt("invalid",s),nu(s,h.value,h.defaultValue,h.children),ls(s)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||h.suppressHydrationWarning===!0||$1(s.textContent,c)?(h.popover!=null&&(lt("beforetoggle",s),lt("toggle",s)),h.onScroll!=null&&lt("scroll",s),h.onScrollEnd!=null&&lt("scrollend",s),h.onClick!=null&&(s.onclick=Yu),s=!0):s=!1,s||ys(r)}function Og(r){for(ai=r.return;ai;)switch(ai.tag){case 5:case 13:wa=!1;return;case 27:case 3:wa=!0;return;default:ai=ai.return}}function yl(r){if(r!==ai)return!1;if(!St)return Og(r),St=!0,!1;var s=r.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||Jh(r.type,r.memoizedProps)),c=!c),c&&tn&&ys(r),Og(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8)if(c=r.data,c==="/$"){if(s===0){tn=da(r.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;r=r.nextSibling}tn=null}}else s===27?(s=tn,Br(r.type)?(r=im,im=null,tn=r):tn=s):tn=ai?da(r.stateNode.nextSibling):null;return!0}function xl(){tn=ai=null,St=!1}function Rg(){var r=vs;return r!==null&&(mi===null?mi=r:mi.push.apply(mi,r),vs=null),r}function bl(r){vs===null?vs=[r]:vs.push(r)}var Bf=pe(null),xs=null,Xa=null;function Tr(r,s,c){Y(Bf,s._currentValue),s._currentValue=c}function $a(r){r._currentValue=Bf.current,P(Bf)}function Ff(r,s,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),r===c)break;r=r.return}}function Uf(r,s,c,h){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var b=g.dependencies;if(b!==null){var k=g.child;b=b.firstContext;e:for(;b!==null;){var O=b;b=g;for(var G=0;G<s.length;G++)if(O.context===s[G]){b.lanes|=c,O=b.alternate,O!==null&&(O.lanes|=c),Ff(b.return,c,r),h||(k=null);break e}b=O.next}}else if(g.tag===18){if(k=g.return,k===null)throw Error(i(341));k.lanes|=c,b=k.alternate,b!==null&&(b.lanes|=c),Ff(k,c,r),k=null}else k=g.child;if(k!==null)k.return=g;else for(k=g;k!==null;){if(k===r){k=null;break}if(g=k.sibling,g!==null){g.return=k.return,k=g;break}k=k.return}g=k}}function Sl(r,s,c,h){r=null;for(var g=s,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var k=g.alternate;if(k===null)throw Error(i(387));if(k=k.memoizedProps,k!==null){var O=g.type;Ci(g.pendingProps.value,k.value)||(r!==null?r.push(O):r=[O])}}else if(g===Me.current){if(k=g.alternate,k===null)throw Error(i(387));k.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Kl):r=[Kl])}g=g.return}r!==null&&Uf(s,r,c,h),s.flags|=262144}function hu(r){for(r=r.firstContext;r!==null;){if(!Ci(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function bs(r){xs=r,Xa=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Xn(r){return Mg(xs,r)}function mu(r,s){return xs===null&&bs(r),Mg(r,s)}function Mg(r,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Xa===null){if(r===null)throw Error(i(308));Xa=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Xa=Xa.next=s;return c}var g2=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(c,h){r.push(h)}};this.abort=function(){s.aborted=!0,r.forEach(function(c){return c()})}},v2=n.unstable_scheduleCallback,y2=n.unstable_NormalPriority,bn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zf(){return{controller:new g2,data:new Map,refCount:0}}function _l(r){r.refCount--,r.refCount===0&&v2(y2,function(){r.controller.abort()})}var Tl=null,Hf=0,uo=0,fo=null;function x2(r,s){if(Tl===null){var c=Tl=[];Hf=0,uo=Vh(),fo={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Hf++,s.then(Lg,Lg),s}function Lg(){if(--Hf===0&&Tl!==null){fo!==null&&(fo.status="fulfilled");var r=Tl;Tl=null,uo=0,fo=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function b2(r,s){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return r.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var Ig=ie.S;ie.S=function(r,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&x2(r,s),Ig!==null&&Ig(r,s)};var Ss=pe(null);function Wf(){var r=Ss.current;return r!==null?r:Ut.pooledCache}function pu(r,s){s===null?Y(Ss,Ss.current):Y(Ss,s.pool)}function Pg(){var r=Wf();return r===null?null:{parent:bn._currentValue,pool:r}}var wl=Error(i(460)),Bg=Error(i(474)),gu=Error(i(542)),Vf={then:function(){}};function Fg(r){return r=r.status,r==="fulfilled"||r==="rejected"}function vu(){}function Ug(r,s,c){switch(c=r[c],c===void 0?r.push(s):c!==s&&(s.then(vu,vu),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,Hg(r),r;default:if(typeof s.status=="string")s.then(vu,vu);else{if(r=Ut,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,Hg(r),r}throw El=s,wl}}var El=null;function zg(){if(El===null)throw Error(i(459));var r=El;return El=null,r}function Hg(r){if(r===wl||r===gu)throw Error(i(483))}var wr=!1;function Gf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yf(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Er(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ar(r,s,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(Et&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=cu(r),Cg(r,null,c),s}return lu(r,h,s,c),cu(r)}function Al(r,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var h=s.lanes;h&=r.pendingLanes,c|=h,s.lanes=c,qs(r,c)}}function Xf(r,s){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?g=b=k:b=b.next=k,c=c.next}while(c!==null);b===null?g=b=s:b=b.next=s}else g=b=s;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:h.shared,callbacks:h.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=s:r.next=s,c.lastBaseUpdate=s}var $f=!1;function kl(){if($f){var r=fo;if(r!==null)throw r}}function Cl(r,s,c,h){$f=!1;var g=r.updateQueue;wr=!1;var b=g.firstBaseUpdate,k=g.lastBaseUpdate,O=g.shared.pending;if(O!==null){g.shared.pending=null;var G=O,oe=G.next;G.next=null,k===null?b=oe:k.next=oe,k=G;var ge=r.alternate;ge!==null&&(ge=ge.updateQueue,O=ge.lastBaseUpdate,O!==k&&(O===null?ge.firstBaseUpdate=oe:O.next=oe,ge.lastBaseUpdate=G))}if(b!==null){var ye=g.baseState;k=0,ge=oe=G=null,O=b;do{var ce=O.lane&-536870913,fe=ce!==O.lane;if(fe?(ft&ce)===ce:(h&ce)===ce){ce!==0&&ce===uo&&($f=!0),ge!==null&&(ge=ge.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ke=r,Xe=O;ce=s;var Lt=c;switch(Xe.tag){case 1:if(Ke=Xe.payload,typeof Ke=="function"){ye=Ke.call(Lt,ye,ce);break e}ye=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=Xe.payload,ce=typeof Ke=="function"?Ke.call(Lt,ye,ce):Ke,ce==null)break e;ye=p({},ye,ce);break e;case 2:wr=!0}}ce=O.callback,ce!==null&&(r.flags|=64,fe&&(r.flags|=8192),fe=g.callbacks,fe===null?g.callbacks=[ce]:fe.push(ce))}else fe={lane:ce,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ge===null?(oe=ge=fe,G=ye):ge=ge.next=fe,k|=ce;if(O=O.next,O===null){if(O=g.shared.pending,O===null)break;fe=O,O=fe.next,fe.next=null,g.lastBaseUpdate=fe,g.shared.pending=null}}while(!0);ge===null&&(G=ye),g.baseState=G,g.firstBaseUpdate=oe,g.lastBaseUpdate=ge,b===null&&(g.shared.lanes=0),Mr|=k,r.lanes=k,r.memoizedState=ye}}function Wg(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function Vg(r,s){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)Wg(c[r],s)}var ho=pe(null),yu=pe(0);function Gg(r,s){r=tr,Y(yu,r),Y(ho,s),tr=r|s.baseLanes}function qf(){Y(yu,tr),Y(ho,ho.current)}function Kf(){tr=yu.current,P(ho),P(yu)}var kr=0,rt=null,Rt=null,hn=null,xu=!1,mo=!1,_s=!1,bu=0,jl=0,po=null,S2=0;function on(){throw Error(i(321))}function Zf(r,s){if(s===null)return!1;for(var c=0;c<s.length&&c<r.length;c++)if(!Ci(r[c],s[c]))return!1;return!0}function Qf(r,s,c,h,g,b){return kr=b,rt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ie.H=r===null||r.memoizedState===null?C0:j0,_s=!1,b=c(h,g),_s=!1,mo&&(b=Xg(s,c,h,g)),Yg(r),b}function Yg(r){ie.H=Au;var s=Rt!==null&&Rt.next!==null;if(kr=0,hn=Rt=rt=null,xu=!1,jl=0,po=null,s)throw Error(i(300));r===null||An||(r=r.dependencies,r!==null&&hu(r)&&(An=!0))}function Xg(r,s,c,h){rt=r;var g=0;do{if(mo&&(po=null),jl=0,mo=!1,25<=g)throw Error(i(301));if(g+=1,hn=Rt=null,r.updateQueue!=null){var b=r.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}ie.H=C2,b=s(c,h)}while(mo);return b}function _2(){var r=ie.H,s=r.useState()[0];return s=typeof s.then=="function"?Dl(s):s,r=r.useState()[0],(Rt!==null?Rt.memoizedState:null)!==r&&(rt.flags|=1024),s}function Jf(){var r=bu!==0;return bu=0,r}function eh(r,s,c){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~c}function th(r){if(xu){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xu=!1}kr=0,hn=Rt=rt=null,mo=!1,jl=bu=0,po=null}function fi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?rt.memoizedState=hn=r:hn=hn.next=r,hn}function mn(){if(Rt===null){var r=rt.alternate;r=r!==null?r.memoizedState:null}else r=Rt.next;var s=hn===null?rt.memoizedState:hn.next;if(s!==null)hn=s,Rt=r;else{if(r===null)throw rt.alternate===null?Error(i(467)):Error(i(310));Rt=r,r={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},hn===null?rt.memoizedState=hn=r:hn=hn.next=r}return hn}function nh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dl(r){var s=jl;return jl+=1,po===null&&(po=[]),r=Ug(po,r,s),s=rt,(hn===null?s.memoizedState:hn.next)===null&&(s=s.alternate,ie.H=s===null||s.memoizedState===null?C0:j0),r}function Su(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Dl(r);if(r.$$typeof===C)return Xn(r)}throw Error(i(438,String(r)))}function ih(r){var s=null,c=rt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var h=rt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=nh(),rt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(r),h=0;h<r;h++)c[h]=H;return s.index++,c}function qa(r,s){return typeof s=="function"?s(r):s}function _u(r){var s=mn();return ah(s,Rt,r)}function ah(r,s,c){var h=r.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var g=r.baseQueue,b=h.pending;if(b!==null){if(g!==null){var k=g.next;g.next=b.next,b.next=k}s.baseQueue=g=b,h.pending=null}if(b=r.baseState,g===null)r.memoizedState=b;else{s=g.next;var O=k=null,G=null,oe=s,ge=!1;do{var ye=oe.lane&-536870913;if(ye!==oe.lane?(ft&ye)===ye:(kr&ye)===ye){var ce=oe.revertLane;if(ce===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),ye===uo&&(ge=!0);else if((kr&ce)===ce){oe=oe.next,ce===uo&&(ge=!0);continue}else ye={lane:0,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},G===null?(O=G=ye,k=b):G=G.next=ye,rt.lanes|=ce,Mr|=ce;ye=oe.action,_s&&c(b,ye),b=oe.hasEagerState?oe.eagerState:c(b,ye)}else ce={lane:ye,revertLane:oe.revertLane,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},G===null?(O=G=ce,k=b):G=G.next=ce,rt.lanes|=ye,Mr|=ye;oe=oe.next}while(oe!==null&&oe!==s);if(G===null?k=b:G.next=O,!Ci(b,r.memoizedState)&&(An=!0,ge&&(c=fo,c!==null)))throw c;r.memoizedState=b,r.baseState=k,r.baseQueue=G,h.lastRenderedState=b}return g===null&&(h.lanes=0),[r.memoizedState,h.dispatch]}function rh(r){var s=mn(),c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=r;var h=c.dispatch,g=c.pending,b=s.memoizedState;if(g!==null){c.pending=null;var k=g=g.next;do b=r(b,k.action),k=k.next;while(k!==g);Ci(b,s.memoizedState)||(An=!0),s.memoizedState=b,s.baseQueue===null&&(s.baseState=b),c.lastRenderedState=b}return[b,h]}function $g(r,s,c){var h=rt,g=mn(),b=St;if(b){if(c===void 0)throw Error(i(407));c=c()}else c=s();var k=!Ci((Rt||g).memoizedState,c);k&&(g.memoizedState=c,An=!0),g=g.queue;var O=Zg.bind(null,h,g,r);if(Nl(2048,8,O,[r]),g.getSnapshot!==s||k||hn!==null&&hn.memoizedState.tag&1){if(h.flags|=2048,go(9,Tu(),Kg.bind(null,h,g,c,s),null),Ut===null)throw Error(i(349));b||(kr&124)!==0||qg(h,s,c)}return c}function qg(r,s,c){r.flags|=16384,r={getSnapshot:s,value:c},s=rt.updateQueue,s===null?(s=nh(),rt.updateQueue=s,s.stores=[r]):(c=s.stores,c===null?s.stores=[r]:c.push(r))}function Kg(r,s,c,h){s.value=c,s.getSnapshot=h,Qg(s)&&Jg(r)}function Zg(r,s,c){return c(function(){Qg(s)&&Jg(r)})}function Qg(r){var s=r.getSnapshot;r=r.value;try{var c=s();return!Ci(r,c)}catch{return!0}}function Jg(r){var s=so(r,2);s!==null&&Mi(s,r,2)}function sh(r){var s=fi();if(typeof r=="function"){var c=r;if(r=c(),_s){Wt(!0);try{c()}finally{Wt(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:r},s}function e0(r,s,c,h){return r.baseState=c,ah(r,Rt,typeof h=="function"?h:qa)}function T2(r,s,c,h,g){if(Eu(r))throw Error(i(485));if(r=s.action,r!==null){var b={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){b.listeners.push(k)}};ie.T!==null?c(!0):b.isTransition=!1,h(b),c=s.pending,c===null?(b.next=s.pending=b,t0(s,b)):(b.next=c.next,s.pending=c.next=b)}}function t0(r,s){var c=s.action,h=s.payload,g=r.state;if(s.isTransition){var b=ie.T,k={};ie.T=k;try{var O=c(g,h),G=ie.S;G!==null&&G(k,O),n0(r,s,O)}catch(oe){oh(r,s,oe)}finally{ie.T=b}}else try{b=c(g,h),n0(r,s,b)}catch(oe){oh(r,s,oe)}}function n0(r,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){i0(r,s,h)},function(h){return oh(r,s,h)}):i0(r,s,c)}function i0(r,s,c){s.status="fulfilled",s.value=c,a0(s),r.state=c,s=r.pending,s!==null&&(c=s.next,c===s?r.pending=null:(c=c.next,s.next=c,t0(r,c)))}function oh(r,s,c){var h=r.pending;if(r.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=c,a0(s),s=s.next;while(s!==h)}r.action=null}function a0(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function r0(r,s){return s}function s0(r,s){if(St){var c=Ut.formState;if(c!==null){e:{var h=rt;if(St){if(tn){t:{for(var g=tn,b=wa;g.nodeType!==8;){if(!b){g=null;break t}if(g=da(g.nextSibling),g===null){g=null;break t}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){tn=da(g.nextSibling),h=g.data==="F!";break e}}ys(h)}h=!1}h&&(s=c[0])}}return c=fi(),c.memoizedState=c.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r0,lastRenderedState:s},c.queue=h,c=E0.bind(null,rt,h),h.dispatch=c,h=sh(!1),b=fh.bind(null,rt,!1,h.queue),h=fi(),g={state:s,dispatch:null,action:r,pending:null},h.queue=g,c=T2.bind(null,rt,g,b,c),g.dispatch=c,h.memoizedState=r,[s,c,!1]}function o0(r){var s=mn();return l0(s,Rt,r)}function l0(r,s,c){if(s=ah(r,s,r0)[0],r=_u(qa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Dl(s)}catch(k){throw k===wl?gu:k}else h=s;s=mn();var g=s.queue,b=g.dispatch;return c!==s.memoizedState&&(rt.flags|=2048,go(9,Tu(),w2.bind(null,g,c),null)),[h,b,r]}function w2(r,s){r.action=s}function c0(r){var s=mn(),c=Rt;if(c!==null)return l0(s,c,r);mn(),s=s.memoizedState,c=mn();var h=c.queue.dispatch;return c.memoizedState=r,[s,h,!1]}function go(r,s,c,h){return r={tag:r,create:c,deps:h,inst:s,next:null},s=rt.updateQueue,s===null&&(s=nh(),rt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,s.lastEffect=r),r}function Tu(){return{destroy:void 0,resource:void 0}}function u0(){return mn().memoizedState}function wu(r,s,c,h){var g=fi();h=h===void 0?null:h,rt.flags|=r,g.memoizedState=go(1|s,Tu(),c,h)}function Nl(r,s,c,h){var g=mn();h=h===void 0?null:h;var b=g.memoizedState.inst;Rt!==null&&h!==null&&Zf(h,Rt.memoizedState.deps)?g.memoizedState=go(s,b,c,h):(rt.flags|=r,g.memoizedState=go(1|s,b,c,h))}function d0(r,s){wu(8390656,8,r,s)}function f0(r,s){Nl(2048,8,r,s)}function h0(r,s){return Nl(4,2,r,s)}function m0(r,s){return Nl(4,4,r,s)}function p0(r,s){if(typeof s=="function"){r=r();var c=s(r);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function g0(r,s,c){c=c!=null?c.concat([r]):null,Nl(4,4,p0.bind(null,s,r),c)}function lh(){}function v0(r,s){var c=mn();s=s===void 0?null:s;var h=c.memoizedState;return s!==null&&Zf(s,h[1])?h[0]:(c.memoizedState=[r,s],r)}function y0(r,s){var c=mn();s=s===void 0?null:s;var h=c.memoizedState;if(s!==null&&Zf(s,h[1]))return h[0];if(h=r(),_s){Wt(!0);try{r()}finally{Wt(!1)}}return c.memoizedState=[h,s],h}function ch(r,s,c){return c===void 0||(kr&1073741824)!==0?r.memoizedState=s:(r.memoizedState=c,r=S1(),rt.lanes|=r,Mr|=r,c)}function x0(r,s,c,h){return Ci(c,s)?c:ho.current!==null?(r=ch(r,c,h),Ci(r,s)||(An=!0),r):(kr&42)===0?(An=!0,r.memoizedState=c):(r=S1(),rt.lanes|=r,Mr|=r,s)}function b0(r,s,c,h,g){var b=he.p;he.p=b!==0&&8>b?b:8;var k=ie.T,O={};ie.T=O,fh(r,!1,s,c);try{var G=g(),oe=ie.S;if(oe!==null&&oe(O,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var ge=b2(G,h);Ol(r,s,ge,Ri(r))}else Ol(r,s,h,Ri(r))}catch(ye){Ol(r,s,{then:function(){},status:"rejected",reason:ye},Ri())}finally{he.p=b,ie.T=k}}function E2(){}function uh(r,s,c,h){if(r.tag!==5)throw Error(i(476));var g=S0(r).queue;b0(r,g,s,Ne,c===null?E2:function(){return _0(r),c(h)})}function S0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Ne,baseState:Ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:Ne},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:c},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function _0(r){var s=S0(r).next.queue;Ol(r,s,{},Ri())}function dh(){return Xn(Kl)}function T0(){return mn().memoizedState}function w0(){return mn().memoizedState}function A2(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var c=Ri();r=Er(c);var h=Ar(s,r,c);h!==null&&(Mi(h,s,c),Al(h,s,c)),s={cache:zf()},r.payload=s;return}s=s.return}}function k2(r,s,c){var h=Ri();c={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Eu(r)?A0(s,c):(c=Nf(r,s,c,h),c!==null&&(Mi(c,r,h),k0(c,s,h)))}function E0(r,s,c){var h=Ri();Ol(r,s,c,h)}function Ol(r,s,c,h){var g={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Eu(r))A0(s,g);else{var b=r.alternate;if(r.lanes===0&&(b===null||b.lanes===0)&&(b=s.lastRenderedReducer,b!==null))try{var k=s.lastRenderedState,O=b(k,c);if(g.hasEagerState=!0,g.eagerState=O,Ci(O,k))return lu(r,s,g,0),Ut===null&&ou(),!1}catch{}finally{}if(c=Nf(r,s,g,h),c!==null)return Mi(c,r,h),k0(c,s,h),!0}return!1}function fh(r,s,c,h){if(h={lane:2,revertLane:Vh(),action:h,hasEagerState:!1,eagerState:null,next:null},Eu(r)){if(s)throw Error(i(479))}else s=Nf(r,c,h,2),s!==null&&Mi(s,r,2)}function Eu(r){var s=r.alternate;return r===rt||s!==null&&s===rt}function A0(r,s){mo=xu=!0;var c=r.pending;c===null?s.next=s:(s.next=c.next,c.next=s),r.pending=s}function k0(r,s,c){if((c&4194048)!==0){var h=s.lanes;h&=r.pendingLanes,c|=h,s.lanes=c,qs(r,c)}}var Au={readContext:Xn,use:Su,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useLayoutEffect:on,useInsertionEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useSyncExternalStore:on,useId:on,useHostTransitionStatus:on,useFormState:on,useActionState:on,useOptimistic:on,useMemoCache:on,useCacheRefresh:on},C0={readContext:Xn,use:Su,useCallback:function(r,s){return fi().memoizedState=[r,s===void 0?null:s],r},useContext:Xn,useEffect:d0,useImperativeHandle:function(r,s,c){c=c!=null?c.concat([r]):null,wu(4194308,4,p0.bind(null,s,r),c)},useLayoutEffect:function(r,s){return wu(4194308,4,r,s)},useInsertionEffect:function(r,s){wu(4,2,r,s)},useMemo:function(r,s){var c=fi();s=s===void 0?null:s;var h=r();if(_s){Wt(!0);try{r()}finally{Wt(!1)}}return c.memoizedState=[h,s],h},useReducer:function(r,s,c){var h=fi();if(c!==void 0){var g=c(s);if(_s){Wt(!0);try{c(s)}finally{Wt(!1)}}}else g=s;return h.memoizedState=h.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},h.queue=r,r=r.dispatch=k2.bind(null,rt,r),[h.memoizedState,r]},useRef:function(r){var s=fi();return r={current:r},s.memoizedState=r},useState:function(r){r=sh(r);var s=r.queue,c=E0.bind(null,rt,s);return s.dispatch=c,[r.memoizedState,c]},useDebugValue:lh,useDeferredValue:function(r,s){var c=fi();return ch(c,r,s)},useTransition:function(){var r=sh(!1);return r=b0.bind(null,rt,r.queue,!0,!1),fi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,c){var h=rt,g=fi();if(St){if(c===void 0)throw Error(i(407));c=c()}else{if(c=s(),Ut===null)throw Error(i(349));(ft&124)!==0||qg(h,s,c)}g.memoizedState=c;var b={value:c,getSnapshot:s};return g.queue=b,d0(Zg.bind(null,h,b,r),[r]),h.flags|=2048,go(9,Tu(),Kg.bind(null,h,b,c,s),null),c},useId:function(){var r=fi(),s=Ut.identifierPrefix;if(St){var c=Ya,h=Ga;c=(h&~(1<<32-J(h)-1)).toString(32)+c,s=""+s+"R"+c,c=bu++,0<c&&(s+="H"+c.toString(32)),s+=""}else c=S2++,s=""+s+"r"+c.toString(32)+"";return r.memoizedState=s},useHostTransitionStatus:dh,useFormState:s0,useActionState:s0,useOptimistic:function(r){var s=fi();s.memoizedState=s.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=fh.bind(null,rt,!0,c),c.dispatch=s,[r,s]},useMemoCache:ih,useCacheRefresh:function(){return fi().memoizedState=A2.bind(null,rt)}},j0={readContext:Xn,use:Su,useCallback:v0,useContext:Xn,useEffect:f0,useImperativeHandle:g0,useInsertionEffect:h0,useLayoutEffect:m0,useMemo:y0,useReducer:_u,useRef:u0,useState:function(){return _u(qa)},useDebugValue:lh,useDeferredValue:function(r,s){var c=mn();return x0(c,Rt.memoizedState,r,s)},useTransition:function(){var r=_u(qa)[0],s=mn().memoizedState;return[typeof r=="boolean"?r:Dl(r),s]},useSyncExternalStore:$g,useId:T0,useHostTransitionStatus:dh,useFormState:o0,useActionState:o0,useOptimistic:function(r,s){var c=mn();return e0(c,Rt,r,s)},useMemoCache:ih,useCacheRefresh:w0},C2={readContext:Xn,use:Su,useCallback:v0,useContext:Xn,useEffect:f0,useImperativeHandle:g0,useInsertionEffect:h0,useLayoutEffect:m0,useMemo:y0,useReducer:rh,useRef:u0,useState:function(){return rh(qa)},useDebugValue:lh,useDeferredValue:function(r,s){var c=mn();return Rt===null?ch(c,r,s):x0(c,Rt.memoizedState,r,s)},useTransition:function(){var r=rh(qa)[0],s=mn().memoizedState;return[typeof r=="boolean"?r:Dl(r),s]},useSyncExternalStore:$g,useId:T0,useHostTransitionStatus:dh,useFormState:c0,useActionState:c0,useOptimistic:function(r,s){var c=mn();return Rt!==null?e0(c,Rt,r,s):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:ih,useCacheRefresh:w0},vo=null,Rl=0;function ku(r){var s=Rl;return Rl+=1,vo===null&&(vo=[]),Ug(vo,r,s)}function Ml(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function Cu(r,s){throw s.$$typeof===v?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function D0(r){var s=r._init;return s(r._payload)}function N0(r){function s(te,Q){if(r){var ae=te.deletions;ae===null?(te.deletions=[Q],te.flags|=16):ae.push(Q)}}function c(te,Q){if(!r)return null;for(;Q!==null;)s(te,Q),Q=Q.sibling;return null}function h(te){for(var Q=new Map;te!==null;)te.key!==null?Q.set(te.key,te):Q.set(te.index,te),te=te.sibling;return Q}function g(te,Q){return te=Va(te,Q),te.index=0,te.sibling=null,te}function b(te,Q,ae){return te.index=ae,r?(ae=te.alternate,ae!==null?(ae=ae.index,ae<Q?(te.flags|=67108866,Q):ae):(te.flags|=67108866,Q)):(te.flags|=1048576,Q)}function k(te){return r&&te.alternate===null&&(te.flags|=67108866),te}function O(te,Q,ae,ve){return Q===null||Q.tag!==6?(Q=Rf(ae,te.mode,ve),Q.return=te,Q):(Q=g(Q,ae),Q.return=te,Q)}function G(te,Q,ae,ve){var ze=ae.type;return ze===_?ge(te,Q,ae.props.children,ve,ae.key):Q!==null&&(Q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===z&&D0(ze)===Q.type)?(Q=g(Q,ae.props),Ml(Q,ae),Q.return=te,Q):(Q=uu(ae.type,ae.key,ae.props,null,te.mode,ve),Ml(Q,ae),Q.return=te,Q)}function oe(te,Q,ae,ve){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ae.containerInfo||Q.stateNode.implementation!==ae.implementation?(Q=Mf(ae,te.mode,ve),Q.return=te,Q):(Q=g(Q,ae.children||[]),Q.return=te,Q)}function ge(te,Q,ae,ve,ze){return Q===null||Q.tag!==7?(Q=ms(ae,te.mode,ve,ze),Q.return=te,Q):(Q=g(Q,ae),Q.return=te,Q)}function ye(te,Q,ae){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Rf(""+Q,te.mode,ae),Q.return=te,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:return ae=uu(Q.type,Q.key,Q.props,null,te.mode,ae),Ml(ae,Q),ae.return=te,ae;case S:return Q=Mf(Q,te.mode,ae),Q.return=te,Q;case z:var ve=Q._init;return Q=ve(Q._payload),ye(te,Q,ae)}if(_e(Q)||ne(Q))return Q=ms(Q,te.mode,ae,null),Q.return=te,Q;if(typeof Q.then=="function")return ye(te,ku(Q),ae);if(Q.$$typeof===C)return ye(te,mu(te,Q),ae);Cu(te,Q)}return null}function ce(te,Q,ae,ve){var ze=Q!==null?Q.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ze!==null?null:O(te,Q,""+ae,ve);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:return ae.key===ze?G(te,Q,ae,ve):null;case S:return ae.key===ze?oe(te,Q,ae,ve):null;case z:return ze=ae._init,ae=ze(ae._payload),ce(te,Q,ae,ve)}if(_e(ae)||ne(ae))return ze!==null?null:ge(te,Q,ae,ve,null);if(typeof ae.then=="function")return ce(te,Q,ku(ae),ve);if(ae.$$typeof===C)return ce(te,Q,mu(te,ae),ve);Cu(te,ae)}return null}function fe(te,Q,ae,ve,ze){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return te=te.get(ae)||null,O(Q,te,""+ve,ze);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case y:return te=te.get(ve.key===null?ae:ve.key)||null,G(Q,te,ve,ze);case S:return te=te.get(ve.key===null?ae:ve.key)||null,oe(Q,te,ve,ze);case z:var st=ve._init;return ve=st(ve._payload),fe(te,Q,ae,ve,ze)}if(_e(ve)||ne(ve))return te=te.get(ae)||null,ge(Q,te,ve,ze,null);if(typeof ve.then=="function")return fe(te,Q,ae,ku(ve),ze);if(ve.$$typeof===C)return fe(te,Q,ae,mu(Q,ve),ze);Cu(Q,ve)}return null}function Ke(te,Q,ae,ve){for(var ze=null,st=null,We=Q,qe=Q=0,Cn=null;We!==null&&qe<ae.length;qe++){We.index>qe?(Cn=We,We=null):Cn=We.sibling;var xt=ce(te,We,ae[qe],ve);if(xt===null){We===null&&(We=Cn);break}r&&We&&xt.alternate===null&&s(te,We),Q=b(xt,Q,qe),st===null?ze=xt:st.sibling=xt,st=xt,We=Cn}if(qe===ae.length)return c(te,We),St&&gs(te,qe),ze;if(We===null){for(;qe<ae.length;qe++)We=ye(te,ae[qe],ve),We!==null&&(Q=b(We,Q,qe),st===null?ze=We:st.sibling=We,st=We);return St&&gs(te,qe),ze}for(We=h(We);qe<ae.length;qe++)Cn=fe(We,te,qe,ae[qe],ve),Cn!==null&&(r&&Cn.alternate!==null&&We.delete(Cn.key===null?qe:Cn.key),Q=b(Cn,Q,qe),st===null?ze=Cn:st.sibling=Cn,st=Cn);return r&&We.forEach(function(Wr){return s(te,Wr)}),St&&gs(te,qe),ze}function Xe(te,Q,ae,ve){if(ae==null)throw Error(i(151));for(var ze=null,st=null,We=Q,qe=Q=0,Cn=null,xt=ae.next();We!==null&&!xt.done;qe++,xt=ae.next()){We.index>qe?(Cn=We,We=null):Cn=We.sibling;var Wr=ce(te,We,xt.value,ve);if(Wr===null){We===null&&(We=Cn);break}r&&We&&Wr.alternate===null&&s(te,We),Q=b(Wr,Q,qe),st===null?ze=Wr:st.sibling=Wr,st=Wr,We=Cn}if(xt.done)return c(te,We),St&&gs(te,qe),ze;if(We===null){for(;!xt.done;qe++,xt=ae.next())xt=ye(te,xt.value,ve),xt!==null&&(Q=b(xt,Q,qe),st===null?ze=xt:st.sibling=xt,st=xt);return St&&gs(te,qe),ze}for(We=h(We);!xt.done;qe++,xt=ae.next())xt=fe(We,te,qe,xt.value,ve),xt!==null&&(r&&xt.alternate!==null&&We.delete(xt.key===null?qe:xt.key),Q=b(xt,Q,qe),st===null?ze=xt:st.sibling=xt,st=xt);return r&&We.forEach(function(jT){return s(te,jT)}),St&&gs(te,qe),ze}function Lt(te,Q,ae,ve){if(typeof ae=="object"&&ae!==null&&ae.type===_&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:e:{for(var ze=ae.key;Q!==null;){if(Q.key===ze){if(ze=ae.type,ze===_){if(Q.tag===7){c(te,Q.sibling),ve=g(Q,ae.props.children),ve.return=te,te=ve;break e}}else if(Q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===z&&D0(ze)===Q.type){c(te,Q.sibling),ve=g(Q,ae.props),Ml(ve,ae),ve.return=te,te=ve;break e}c(te,Q);break}else s(te,Q);Q=Q.sibling}ae.type===_?(ve=ms(ae.props.children,te.mode,ve,ae.key),ve.return=te,te=ve):(ve=uu(ae.type,ae.key,ae.props,null,te.mode,ve),Ml(ve,ae),ve.return=te,te=ve)}return k(te);case S:e:{for(ze=ae.key;Q!==null;){if(Q.key===ze)if(Q.tag===4&&Q.stateNode.containerInfo===ae.containerInfo&&Q.stateNode.implementation===ae.implementation){c(te,Q.sibling),ve=g(Q,ae.children||[]),ve.return=te,te=ve;break e}else{c(te,Q);break}else s(te,Q);Q=Q.sibling}ve=Mf(ae,te.mode,ve),ve.return=te,te=ve}return k(te);case z:return ze=ae._init,ae=ze(ae._payload),Lt(te,Q,ae,ve)}if(_e(ae))return Ke(te,Q,ae,ve);if(ne(ae)){if(ze=ne(ae),typeof ze!="function")throw Error(i(150));return ae=ze.call(ae),Xe(te,Q,ae,ve)}if(typeof ae.then=="function")return Lt(te,Q,ku(ae),ve);if(ae.$$typeof===C)return Lt(te,Q,mu(te,ae),ve);Cu(te,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,Q!==null&&Q.tag===6?(c(te,Q.sibling),ve=g(Q,ae),ve.return=te,te=ve):(c(te,Q),ve=Rf(ae,te.mode,ve),ve.return=te,te=ve),k(te)):c(te,Q)}return function(te,Q,ae,ve){try{Rl=0;var ze=Lt(te,Q,ae,ve);return vo=null,ze}catch(We){if(We===wl||We===gu)throw We;var st=ji(29,We,null,te.mode);return st.lanes=ve,st.return=te,st}finally{}}}var yo=N0(!0),O0=N0(!1),qi=pe(null),Ea=null;function Cr(r){var s=r.alternate;Y(Sn,Sn.current&1),Y(qi,r),Ea===null&&(s===null||ho.current!==null||s.memoizedState!==null)&&(Ea=r)}function R0(r){if(r.tag===22){if(Y(Sn,Sn.current),Y(qi,r),Ea===null){var s=r.alternate;s!==null&&s.memoizedState!==null&&(Ea=r)}}else jr()}function jr(){Y(Sn,Sn.current),Y(qi,qi.current)}function Ka(r){P(qi),Ea===r&&(Ea=null),P(Sn)}var Sn=pe(0);function ju(r){for(var s=r;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||nm(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function hh(r,s,c,h){s=r.memoizedState,c=c(h,s),c=c==null?s:p({},s,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var mh={enqueueSetState:function(r,s,c){r=r._reactInternals;var h=Ri(),g=Er(h);g.payload=s,c!=null&&(g.callback=c),s=Ar(r,g,h),s!==null&&(Mi(s,r,h),Al(s,r,h))},enqueueReplaceState:function(r,s,c){r=r._reactInternals;var h=Ri(),g=Er(h);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=Ar(r,g,h),s!==null&&(Mi(s,r,h),Al(s,r,h))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var c=Ri(),h=Er(c);h.tag=2,s!=null&&(h.callback=s),s=Ar(r,h,c),s!==null&&(Mi(s,r,c),Al(s,r,c))}};function M0(r,s,c,h,g,b,k){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,b,k):s.prototype&&s.prototype.isPureReactComponent?!gl(c,h)||!gl(g,b):!0}function L0(r,s,c,h){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,h),s.state!==r&&mh.enqueueReplaceState(s,s.state,null)}function Ts(r,s){var c=s;if("ref"in s){c={};for(var h in s)h!=="ref"&&(c[h]=s[h])}if(r=r.defaultProps){c===s&&(c=p({},c));for(var g in r)c[g]===void 0&&(c[g]=r[g])}return c}var Du=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function I0(r){Du(r)}function P0(r){console.error(r)}function B0(r){Du(r)}function Nu(r,s){try{var c=r.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function F0(r,s,c){try{var h=r.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function ph(r,s,c){return c=Er(c),c.tag=3,c.payload={element:null},c.callback=function(){Nu(r,s)},c}function U0(r){return r=Er(r),r.tag=3,r}function z0(r,s,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var b=h.value;r.payload=function(){return g(b)},r.callback=function(){F0(s,c,h)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(r.callback=function(){F0(s,c,h),typeof g!="function"&&(Lr===null?Lr=new Set([this]):Lr.add(this));var O=h.stack;this.componentDidCatch(h.value,{componentStack:O!==null?O:""})})}function j2(r,s,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=c.alternate,s!==null&&Sl(s,c,g,!0),c=qi.current,c!==null){switch(c.tag){case 13:return Ea===null?Fh():c.alternate===null&&nn===0&&(nn=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===Vf?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([h]):s.add(h),zh(r,h,g)),!1;case 22:return c.flags|=65536,h===Vf?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([h]):c.add(h)),zh(r,h,g)),!1}throw Error(i(435,c.tag))}return zh(r,h,g),Fh(),!1}if(St)return s=qi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==Pf&&(r=Error(i(422),{cause:h}),bl(Gi(r,c)))):(h!==Pf&&(s=Error(i(423),{cause:h}),bl(Gi(s,c))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,h=Gi(h,c),g=ph(r.stateNode,h,g),Xf(r,g),nn!==4&&(nn=2)),!1;var b=Error(i(520),{cause:h});if(b=Gi(b,c),zl===null?zl=[b]:zl.push(b),nn!==4&&(nn=2),s===null)return!0;h=Gi(h,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,r=g&-g,c.lanes|=r,r=ph(c.stateNode,h,r),Xf(c,r),!1;case 1:if(s=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Lr===null||!Lr.has(b))))return c.flags|=65536,g&=-g,c.lanes|=g,g=U0(g),z0(g,r,c,h),Xf(c,g),!1}c=c.return}while(c!==null);return!1}var H0=Error(i(461)),An=!1;function Ln(r,s,c,h){s.child=r===null?O0(s,null,c,h):yo(s,r.child,c,h)}function W0(r,s,c,h,g){c=c.render;var b=s.ref;if("ref"in h){var k={};for(var O in h)O!=="ref"&&(k[O]=h[O])}else k=h;return bs(s),h=Qf(r,s,c,k,b,g),O=Jf(),r!==null&&!An?(eh(r,s,g),Za(r,s,g)):(St&&O&&Lf(s),s.flags|=1,Ln(r,s,h,g),s.child)}function V0(r,s,c,h,g){if(r===null){var b=c.type;return typeof b=="function"&&!Of(b)&&b.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=b,G0(r,s,b,h,g)):(r=uu(c.type,null,h,s,s.mode,g),r.ref=s.ref,r.return=s,s.child=r)}if(b=r.child,!Th(r,g)){var k=b.memoizedProps;if(c=c.compare,c=c!==null?c:gl,c(k,h)&&r.ref===s.ref)return Za(r,s,g)}return s.flags|=1,r=Va(b,h),r.ref=s.ref,r.return=s,s.child=r}function G0(r,s,c,h,g){if(r!==null){var b=r.memoizedProps;if(gl(b,h)&&r.ref===s.ref)if(An=!1,s.pendingProps=h=b,Th(r,g))(r.flags&131072)!==0&&(An=!0);else return s.lanes=r.lanes,Za(r,s,g)}return gh(r,s,c,h,g)}function Y0(r,s,c){var h=s.pendingProps,g=h.children,b=r!==null?r.memoizedState:null;if(h.mode==="hidden"){if((s.flags&128)!==0){if(h=b!==null?b.baseLanes|c:c,r!==null){for(g=s.child=r.child,b=0;g!==null;)b=b|g.lanes|g.childLanes,g=g.sibling;s.childLanes=b&~h}else s.childLanes=0,s.child=null;return X0(r,s,h,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&pu(s,b!==null?b.cachePool:null),b!==null?Gg(s,b):qf(),R0(s);else return s.lanes=s.childLanes=536870912,X0(r,s,b!==null?b.baseLanes|c:c,c)}else b!==null?(pu(s,b.cachePool),Gg(s,b),jr(),s.memoizedState=null):(r!==null&&pu(s,null),qf(),jr());return Ln(r,s,g,c),s.child}function X0(r,s,c,h){var g=Wf();return g=g===null?null:{parent:bn._currentValue,pool:g},s.memoizedState={baseLanes:c,cachePool:g},r!==null&&pu(s,null),qf(),R0(s),r!==null&&Sl(r,s,h,!0),null}function Ou(r,s){var c=s.ref;if(c===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(r===null||r.ref!==c)&&(s.flags|=4194816)}}function gh(r,s,c,h,g){return bs(s),c=Qf(r,s,c,h,void 0,g),h=Jf(),r!==null&&!An?(eh(r,s,g),Za(r,s,g)):(St&&h&&Lf(s),s.flags|=1,Ln(r,s,c,g),s.child)}function $0(r,s,c,h,g,b){return bs(s),s.updateQueue=null,c=Xg(s,h,c,g),Yg(r),h=Jf(),r!==null&&!An?(eh(r,s,b),Za(r,s,b)):(St&&h&&Lf(s),s.flags|=1,Ln(r,s,c,b),s.child)}function q0(r,s,c,h,g){if(bs(s),s.stateNode===null){var b=oo,k=c.contextType;typeof k=="object"&&k!==null&&(b=Xn(k)),b=new c(h,b),s.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=mh,s.stateNode=b,b._reactInternals=s,b=s.stateNode,b.props=h,b.state=s.memoizedState,b.refs={},Gf(s),k=c.contextType,b.context=typeof k=="object"&&k!==null?Xn(k):oo,b.state=s.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(hh(s,c,k,h),b.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(k=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),k!==b.state&&mh.enqueueReplaceState(b,b.state,null),Cl(s,h,b,g),kl(),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(r===null){b=s.stateNode;var O=s.memoizedProps,G=Ts(c,O);b.props=G;var oe=b.context,ge=c.contextType;k=oo,typeof ge=="object"&&ge!==null&&(k=Xn(ge));var ye=c.getDerivedStateFromProps;ge=typeof ye=="function"||typeof b.getSnapshotBeforeUpdate=="function",O=s.pendingProps!==O,ge||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(O||oe!==k)&&L0(s,b,h,k),wr=!1;var ce=s.memoizedState;b.state=ce,Cl(s,h,b,g),kl(),oe=s.memoizedState,O||ce!==oe||wr?(typeof ye=="function"&&(hh(s,c,ye,h),oe=s.memoizedState),(G=wr||M0(s,c,G,h,ce,oe,k))?(ge||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=oe),b.props=h,b.state=oe,b.context=k,h=G):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{b=s.stateNode,Yf(r,s),k=s.memoizedProps,ge=Ts(c,k),b.props=ge,ye=s.pendingProps,ce=b.context,oe=c.contextType,G=oo,typeof oe=="object"&&oe!==null&&(G=Xn(oe)),O=c.getDerivedStateFromProps,(oe=typeof O=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(k!==ye||ce!==G)&&L0(s,b,h,G),wr=!1,ce=s.memoizedState,b.state=ce,Cl(s,h,b,g),kl();var fe=s.memoizedState;k!==ye||ce!==fe||wr||r!==null&&r.dependencies!==null&&hu(r.dependencies)?(typeof O=="function"&&(hh(s,c,O,h),fe=s.memoizedState),(ge=wr||M0(s,c,ge,h,ce,fe,G)||r!==null&&r.dependencies!==null&&hu(r.dependencies))?(oe||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,fe,G),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,fe,G)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||k===r.memoizedProps&&ce===r.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||k===r.memoizedProps&&ce===r.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=fe),b.props=h,b.state=fe,b.context=G,h=ge):(typeof b.componentDidUpdate!="function"||k===r.memoizedProps&&ce===r.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||k===r.memoizedProps&&ce===r.memoizedState||(s.flags|=1024),h=!1)}return b=h,Ou(r,s),h=(s.flags&128)!==0,b||h?(b=s.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:b.render(),s.flags|=1,r!==null&&h?(s.child=yo(s,r.child,null,g),s.child=yo(s,null,c,g)):Ln(r,s,c,g),s.memoizedState=b.state,r=s.child):r=Za(r,s,g),r}function K0(r,s,c,h){return xl(),s.flags|=256,Ln(r,s,c,h),s.child}var vh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yh(r){return{baseLanes:r,cachePool:Pg()}}function xh(r,s,c){return r=r!==null?r.childLanes&~c:0,s&&(r|=Ki),r}function Z0(r,s,c){var h=s.pendingProps,g=!1,b=(s.flags&128)!==0,k;if((k=b)||(k=r!==null&&r.memoizedState===null?!1:(Sn.current&2)!==0),k&&(g=!0,s.flags&=-129),k=(s.flags&32)!==0,s.flags&=-33,r===null){if(St){if(g?Cr(s):jr(),St){var O=tn,G;if(G=O){e:{for(G=O,O=wa;G.nodeType!==8;){if(!O){O=null;break e}if(G=da(G.nextSibling),G===null){O=null;break e}}O=G}O!==null?(s.memoizedState={dehydrated:O,treeContext:ps!==null?{id:Ga,overflow:Ya}:null,retryLane:536870912,hydrationErrors:null},G=ji(18,null,null,0),G.stateNode=O,G.return=s,s.child=G,ai=s,tn=null,G=!0):G=!1}G||ys(s)}if(O=s.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return nm(O)?s.lanes=32:s.lanes=536870912,null;Ka(s)}return O=h.children,h=h.fallback,g?(jr(),g=s.mode,O=Ru({mode:"hidden",children:O},g),h=ms(h,g,c,null),O.return=s,h.return=s,O.sibling=h,s.child=O,g=s.child,g.memoizedState=yh(c),g.childLanes=xh(r,k,c),s.memoizedState=vh,h):(Cr(s),bh(s,O))}if(G=r.memoizedState,G!==null&&(O=G.dehydrated,O!==null)){if(b)s.flags&256?(Cr(s),s.flags&=-257,s=Sh(r,s,c)):s.memoizedState!==null?(jr(),s.child=r.child,s.flags|=128,s=null):(jr(),g=h.fallback,O=s.mode,h=Ru({mode:"visible",children:h.children},O),g=ms(g,O,c,null),g.flags|=2,h.return=s,g.return=s,h.sibling=g,s.child=h,yo(s,r.child,null,c),h=s.child,h.memoizedState=yh(c),h.childLanes=xh(r,k,c),s.memoizedState=vh,s=g);else if(Cr(s),nm(O)){if(k=O.nextSibling&&O.nextSibling.dataset,k)var oe=k.dgst;k=oe,h=Error(i(419)),h.stack="",h.digest=k,bl({value:h,source:null,stack:null}),s=Sh(r,s,c)}else if(An||Sl(r,s,c,!1),k=(c&r.childLanes)!==0,An||k){if(k=Ut,k!==null&&(h=c&-c,h=(h&42)!==0?1:rs(h),h=(h&(k.suspendedLanes|c))!==0?0:h,h!==0&&h!==G.retryLane))throw G.retryLane=h,so(r,h),Mi(k,r,h),H0;O.data==="$?"||Fh(),s=Sh(r,s,c)}else O.data==="$?"?(s.flags|=192,s.child=r.child,s=null):(r=G.treeContext,tn=da(O.nextSibling),ai=s,St=!0,vs=null,wa=!1,r!==null&&(Xi[$i++]=Ga,Xi[$i++]=Ya,Xi[$i++]=ps,Ga=r.id,Ya=r.overflow,ps=s),s=bh(s,h.children),s.flags|=4096);return s}return g?(jr(),g=h.fallback,O=s.mode,G=r.child,oe=G.sibling,h=Va(G,{mode:"hidden",children:h.children}),h.subtreeFlags=G.subtreeFlags&65011712,oe!==null?g=Va(oe,g):(g=ms(g,O,c,null),g.flags|=2),g.return=s,h.return=s,h.sibling=g,s.child=h,h=g,g=s.child,O=r.child.memoizedState,O===null?O=yh(c):(G=O.cachePool,G!==null?(oe=bn._currentValue,G=G.parent!==oe?{parent:oe,pool:oe}:G):G=Pg(),O={baseLanes:O.baseLanes|c,cachePool:G}),g.memoizedState=O,g.childLanes=xh(r,k,c),s.memoizedState=vh,h):(Cr(s),c=r.child,r=c.sibling,c=Va(c,{mode:"visible",children:h.children}),c.return=s,c.sibling=null,r!==null&&(k=s.deletions,k===null?(s.deletions=[r],s.flags|=16):k.push(r)),s.child=c,s.memoizedState=null,c)}function bh(r,s){return s=Ru({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function Ru(r,s){return r=ji(22,r,null,s),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Sh(r,s,c){return yo(s,r.child,null,c),r=bh(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function Q0(r,s,c){r.lanes|=s;var h=r.alternate;h!==null&&(h.lanes|=s),Ff(r.return,s,c)}function _h(r,s,c,h,g){var b=r.memoizedState;b===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(b.isBackwards=s,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=c,b.tailMode=g)}function J0(r,s,c){var h=s.pendingProps,g=h.revealOrder,b=h.tail;if(Ln(r,s,h.children,c),h=Sn.current,(h&2)!==0)h=h&1|2,s.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Q0(r,c,s);else if(r.tag===19)Q0(r,c,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}switch(Y(Sn,h),g){case"forwards":for(c=s.child,g=null;c!==null;)r=c.alternate,r!==null&&ju(r)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),_h(s,!1,g,c,b);break;case"backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(r=g.alternate,r!==null&&ju(r)===null){s.child=g;break}r=g.sibling,g.sibling=c,c=g,g=r}_h(s,!0,c,null,b);break;case"together":_h(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Za(r,s,c){if(r!==null&&(s.dependencies=r.dependencies),Mr|=s.lanes,(c&s.childLanes)===0)if(r!==null){if(Sl(r,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,c=Va(r,r.pendingProps),s.child=c,c.return=s;r.sibling!==null;)r=r.sibling,c=c.sibling=Va(r,r.pendingProps),c.return=s;c.sibling=null}return s.child}function Th(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&hu(r)))}function D2(r,s,c){switch(s.tag){case 3:Ce(s,s.stateNode.containerInfo),Tr(s,bn,r.memoizedState.cache),xl();break;case 27:case 5:Ae(s);break;case 4:Ce(s,s.stateNode.containerInfo);break;case 10:Tr(s,s.type,s.memoizedProps.value);break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(Cr(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Z0(r,s,c):(Cr(s),r=Za(r,s,c),r!==null?r.sibling:null);Cr(s);break;case 19:var g=(r.flags&128)!==0;if(h=(c&s.childLanes)!==0,h||(Sl(r,s,c,!1),h=(c&s.childLanes)!==0),g){if(h)return J0(r,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Y(Sn,Sn.current),h)break;return null;case 22:case 23:return s.lanes=0,Y0(r,s,c);case 24:Tr(s,bn,r.memoizedState.cache)}return Za(r,s,c)}function e1(r,s,c){if(r!==null)if(r.memoizedProps!==s.pendingProps)An=!0;else{if(!Th(r,c)&&(s.flags&128)===0)return An=!1,D2(r,s,c);An=(r.flags&131072)!==0}else An=!1,St&&(s.flags&1048576)!==0&&Dg(s,fu,s.index);switch(s.lanes=0,s.tag){case 16:e:{r=s.pendingProps;var h=s.elementType,g=h._init;if(h=g(h._payload),s.type=h,typeof h=="function")Of(h)?(r=Ts(h,r),s.tag=1,s=q0(null,s,h,r,c)):(s.tag=0,s=gh(null,s,h,r,c));else{if(h!=null){if(g=h.$$typeof,g===N){s.tag=11,s=W0(null,s,h,r,c);break e}else if(g===D){s.tag=14,s=V0(null,s,h,r,c);break e}}throw s=He(h)||h,Error(i(306,s,""))}}return s;case 0:return gh(r,s,s.type,s.pendingProps,c);case 1:return h=s.type,g=Ts(h,s.pendingProps),q0(r,s,h,g,c);case 3:e:{if(Ce(s,s.stateNode.containerInfo),r===null)throw Error(i(387));h=s.pendingProps;var b=s.memoizedState;g=b.element,Yf(r,s),Cl(s,h,null,c);var k=s.memoizedState;if(h=k.cache,Tr(s,bn,h),h!==b.cache&&Uf(s,[bn],c,!0),kl(),h=k.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:k.cache},s.updateQueue.baseState=b,s.memoizedState=b,s.flags&256){s=K0(r,s,h,c);break e}else if(h!==g){g=Gi(Error(i(424)),s),bl(g),s=K0(r,s,h,c);break e}else{switch(r=s.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(tn=da(r.firstChild),ai=s,St=!0,vs=null,wa=!0,c=O0(s,null,h,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(xl(),h===g){s=Za(r,s,c);break e}Ln(r,s,h,c)}s=s.child}return s;case 26:return Ou(r,s),r===null?(c=av(s.type,null,s.pendingProps,null))?s.memoizedState=c:St||(c=s.type,r=s.pendingProps,h=Xu(re.current).createElement(c),h[Jt]=s,h[en]=r,Pn(h,c,r),ee(h),s.stateNode=h):s.memoizedState=av(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return Ae(s),r===null&&St&&(h=s.stateNode=tv(s.type,s.pendingProps,re.current),ai=s,wa=!0,g=tn,Br(s.type)?(im=g,tn=da(h.firstChild)):tn=g),Ln(r,s,s.pendingProps.children,c),Ou(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&St&&((g=h=tn)&&(h=aT(h,s.type,s.pendingProps,wa),h!==null?(s.stateNode=h,ai=s,tn=da(h.firstChild),wa=!1,g=!0):g=!1),g||ys(s)),Ae(s),g=s.type,b=s.pendingProps,k=r!==null?r.memoizedProps:null,h=b.children,Jh(g,b)?h=null:k!==null&&Jh(g,k)&&(s.flags|=32),s.memoizedState!==null&&(g=Qf(r,s,_2,null,null,c),Kl._currentValue=g),Ou(r,s),Ln(r,s,h,c),s.child;case 6:return r===null&&St&&((r=c=tn)&&(c=rT(c,s.pendingProps,wa),c!==null?(s.stateNode=c,ai=s,tn=null,r=!0):r=!1),r||ys(s)),null;case 13:return Z0(r,s,c);case 4:return Ce(s,s.stateNode.containerInfo),h=s.pendingProps,r===null?s.child=yo(s,null,h,c):Ln(r,s,h,c),s.child;case 11:return W0(r,s,s.type,s.pendingProps,c);case 7:return Ln(r,s,s.pendingProps,c),s.child;case 8:return Ln(r,s,s.pendingProps.children,c),s.child;case 12:return Ln(r,s,s.pendingProps.children,c),s.child;case 10:return h=s.pendingProps,Tr(s,s.type,h.value),Ln(r,s,h.children,c),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,bs(s),g=Xn(g),h=h(g),s.flags|=1,Ln(r,s,h,c),s.child;case 14:return V0(r,s,s.type,s.pendingProps,c);case 15:return G0(r,s,s.type,s.pendingProps,c);case 19:return J0(r,s,c);case 31:return h=s.pendingProps,c=s.mode,h={mode:h.mode,children:h.children},r===null?(c=Ru(h,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=Va(r.child,h),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return Y0(r,s,c);case 24:return bs(s),h=Xn(bn),r===null?(g=Wf(),g===null&&(g=Ut,b=zf(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=c),g=b),s.memoizedState={parent:h,cache:g},Gf(s),Tr(s,bn,g)):((r.lanes&c)!==0&&(Yf(r,s),Cl(s,null,null,c),kl()),g=r.memoizedState,b=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Tr(s,bn,h)):(h=b.cache,Tr(s,bn,h),h!==g.cache&&Uf(s,[bn],c,!0))),Ln(r,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Qa(r){r.flags|=4}function t1(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!cv(s)){if(s=qi.current,s!==null&&((ft&4194048)===ft?Ea!==null:(ft&62914560)!==ft&&(ft&536870912)===0||s!==Ea))throw El=Vf,Bg;r.flags|=8192}}function Mu(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?wi():536870912,r.lanes|=s,_o|=s)}function Ll(r,s){if(!St)switch(r.tailMode){case"hidden":s=r.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function Zt(r){var s=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(s)for(var g=r.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=h,r.childLanes=c,s}function N2(r,s,c){var h=s.pendingProps;switch(If(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(s),null;case 1:return Zt(s),null;case 3:return c=s.stateNode,h=null,r!==null&&(h=r.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),$a(bn),Le(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(yl(s)?Qa(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Rg())),Zt(s),null;case 26:return c=s.memoizedState,r===null?(Qa(s),c!==null?(Zt(s),t1(s,c)):(Zt(s),s.flags&=-16777217)):c?c!==r.memoizedState?(Qa(s),Zt(s),t1(s,c)):(Zt(s),s.flags&=-16777217):(r.memoizedProps!==h&&Qa(s),Zt(s),s.flags&=-16777217),null;case 27:ct(s),c=re.current;var g=s.type;if(r!==null&&s.stateNode!=null)r.memoizedProps!==h&&Qa(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Zt(s),null}r=V.current,yl(s)?Ng(s):(r=tv(g,h,c),s.stateNode=r,Qa(s))}return Zt(s),null;case 5:if(ct(s),c=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==h&&Qa(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Zt(s),null}if(r=V.current,yl(s))Ng(s);else{switch(g=Xu(re.current),r){case 1:r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":r=g.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?r.multiple=!0:h.size&&(r.size=h.size);break;default:r=typeof h.is=="string"?g.createElement(c,{is:h.is}):g.createElement(c)}}r[Jt]=s,r[en]=h;e:for(g=s.child;g!==null;){if(g.tag===5||g.tag===6)r.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===s)break e;for(;g.sibling===null;){if(g.return===null||g.return===s)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}s.stateNode=r;e:switch(Pn(r,c,h),c){case"button":case"input":case"select":case"textarea":r=!!h.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Qa(s)}}return Zt(s),s.flags&=-16777217,null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==h&&Qa(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(i(166));if(r=re.current,yl(s)){if(r=s.stateNode,c=s.memoizedProps,h=null,g=ai,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}r[Jt]=s,r=!!(r.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||$1(r.nodeValue,c)),r||ys(s)}else r=Xu(r).createTextNode(h),r[Jt]=s,s.stateNode=r}return Zt(s),null;case 13:if(h=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=yl(s),h!==null&&h.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Jt]=s}else xl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Zt(s),g=!1}else g=Rg(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Ka(s),s):(Ka(s),null)}if(Ka(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=h!==null,r=r!==null&&r.memoizedState!==null,c){h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var b=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==g&&(h.flags|=2048)}return c!==r&&c&&(s.child.flags|=8192),Mu(s,s.updateQueue),Zt(s),null;case 4:return Le(),r===null&&$h(s.stateNode.containerInfo),Zt(s),null;case 10:return $a(s.type),Zt(s),null;case 19:if(P(Sn),g=s.memoizedState,g===null)return Zt(s),null;if(h=(s.flags&128)!==0,b=g.rendering,b===null)if(h)Ll(g,!1);else{if(nn!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(b=ju(r),b!==null){for(s.flags|=128,Ll(g,!1),r=b.updateQueue,s.updateQueue=r,Mu(s,r),s.subtreeFlags=0,r=c,c=s.child;c!==null;)jg(c,r),c=c.sibling;return Y(Sn,Sn.current&1|2),s.child}r=r.sibling}g.tail!==null&&Re()>Pu&&(s.flags|=128,h=!0,Ll(g,!1),s.lanes=4194304)}else{if(!h)if(r=ju(b),r!==null){if(s.flags|=128,h=!0,r=r.updateQueue,s.updateQueue=r,Mu(s,r),Ll(g,!0),g.tail===null&&g.tailMode==="hidden"&&!b.alternate&&!St)return Zt(s),null}else 2*Re()-g.renderingStartTime>Pu&&c!==536870912&&(s.flags|=128,h=!0,Ll(g,!1),s.lanes=4194304);g.isBackwards?(b.sibling=s.child,s.child=b):(r=g.last,r!==null?r.sibling=b:s.child=b,g.last=b)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=Re(),s.sibling=null,r=Sn.current,Y(Sn,h?r&1|2:r&1),s):(Zt(s),null);case 22:case 23:return Ka(s),Kf(),h=s.memoizedState!==null,r!==null?r.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(c&536870912)!==0&&(s.flags&128)===0&&(Zt(s),s.subtreeFlags&6&&(s.flags|=8192)):Zt(s),c=s.updateQueue,c!==null&&Mu(s,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==c&&(s.flags|=2048),r!==null&&P(Ss),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),$a(bn),Zt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function O2(r,s){switch(If(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return $a(bn),Le(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return ct(s),null;case 13:if(Ka(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));xl()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return P(Sn),null;case 4:return Le(),null;case 10:return $a(s.type),null;case 22:case 23:return Ka(s),Kf(),r!==null&&P(Ss),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return $a(bn),null;case 25:return null;default:return null}}function n1(r,s){switch(If(s),s.tag){case 3:$a(bn),Le();break;case 26:case 27:case 5:ct(s);break;case 4:Le();break;case 13:Ka(s);break;case 19:P(Sn);break;case 10:$a(s.type);break;case 22:case 23:Ka(s),Kf(),r!==null&&P(Ss);break;case 24:$a(bn)}}function Il(r,s){try{var c=s.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&r)===r){h=void 0;var b=c.create,k=c.inst;h=b(),k.destroy=h}c=c.next}while(c!==g)}}catch(O){Bt(s,s.return,O)}}function Dr(r,s,c){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var b=g.next;h=b;do{if((h.tag&r)===r){var k=h.inst,O=k.destroy;if(O!==void 0){k.destroy=void 0,g=s;var G=c,oe=O;try{oe()}catch(ge){Bt(g,G,ge)}}}h=h.next}while(h!==b)}}catch(ge){Bt(s,s.return,ge)}}function i1(r){var s=r.updateQueue;if(s!==null){var c=r.stateNode;try{Vg(s,c)}catch(h){Bt(r,r.return,h)}}}function a1(r,s,c){c.props=Ts(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(h){Bt(r,s,h)}}function Pl(r,s){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var h=r.stateNode;break;case 30:h=r.stateNode;break;default:h=r.stateNode}typeof c=="function"?r.refCleanup=c(h):c.current=h}}catch(g){Bt(r,s,g)}}function Aa(r,s){var c=r.ref,h=r.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){Bt(r,s,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Bt(r,s,g)}else c.current=null}function r1(r){var s=r.type,c=r.memoizedProps,h=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){Bt(r,r.return,g)}}function wh(r,s,c){try{var h=r.stateNode;J2(h,r.type,c,s),h[en]=s}catch(g){Bt(r,r.return,g)}}function s1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Br(r.type)||r.tag===4}function Eh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||s1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Br(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ah(r,s,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(r),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Yu));else if(h!==4&&(h===27&&Br(r.type)&&(c=r.stateNode,s=null),r=r.child,r!==null))for(Ah(r,s,c),r=r.sibling;r!==null;)Ah(r,s,c),r=r.sibling}function Lu(r,s,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?c.insertBefore(r,s):c.appendChild(r);else if(h!==4&&(h===27&&Br(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(Lu(r,s,c),r=r.sibling;r!==null;)Lu(r,s,c),r=r.sibling}function o1(r){var s=r.stateNode,c=r.memoizedProps;try{for(var h=r.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Pn(s,h,c),s[Jt]=r,s[en]=c}catch(b){Bt(r,r.return,b)}}var Ja=!1,ln=!1,kh=!1,l1=typeof WeakSet=="function"?WeakSet:Set,kn=null;function R2(r,s){if(r=r.containerInfo,Zh=Ju,r=xg(r),Ef(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break e}var k=0,O=-1,G=-1,oe=0,ge=0,ye=r,ce=null;t:for(;;){for(var fe;ye!==c||g!==0&&ye.nodeType!==3||(O=k+g),ye!==b||h!==0&&ye.nodeType!==3||(G=k+h),ye.nodeType===3&&(k+=ye.nodeValue.length),(fe=ye.firstChild)!==null;)ce=ye,ye=fe;for(;;){if(ye===r)break t;if(ce===c&&++oe===g&&(O=k),ce===b&&++ge===h&&(G=k),(fe=ye.nextSibling)!==null)break;ye=ce,ce=ye.parentNode}ye=fe}c=O===-1||G===-1?null:{start:O,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(Qh={focusedElem:r,selectionRange:c},Ju=!1,kn=s;kn!==null;)if(s=kn,r=s.child,(s.subtreeFlags&1024)!==0&&r!==null)r.return=s,kn=r;else for(;kn!==null;){switch(s=kn,b=s.alternate,r=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&b!==null){r=void 0,c=s,g=b.memoizedProps,b=b.memoizedState,h=c.stateNode;try{var Ke=Ts(c.type,g,c.elementType===c.type);r=h.getSnapshotBeforeUpdate(Ke,b),h.__reactInternalSnapshotBeforeUpdate=r}catch(Xe){Bt(c,c.return,Xe)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,c=r.nodeType,c===9)tm(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":tm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,kn=r;break}kn=s.return}}function c1(r,s,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Nr(r,c),h&4&&Il(5,c);break;case 1:if(Nr(r,c),h&4)if(r=c.stateNode,s===null)try{r.componentDidMount()}catch(k){Bt(c,c.return,k)}else{var g=Ts(c.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(g,s,r.__reactInternalSnapshotBeforeUpdate)}catch(k){Bt(c,c.return,k)}}h&64&&i1(c),h&512&&Pl(c,c.return);break;case 3:if(Nr(r,c),h&64&&(r=c.updateQueue,r!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Vg(r,s)}catch(k){Bt(c,c.return,k)}}break;case 27:s===null&&h&4&&o1(c);case 26:case 5:Nr(r,c),s===null&&h&4&&r1(c),h&512&&Pl(c,c.return);break;case 12:Nr(r,c);break;case 13:Nr(r,c),h&4&&f1(r,c),h&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=H2.bind(null,c),sT(r,c))));break;case 22:if(h=c.memoizedState!==null||Ja,!h){s=s!==null&&s.memoizedState!==null||ln,g=Ja;var b=ln;Ja=h,(ln=s)&&!b?Or(r,c,(c.subtreeFlags&8772)!==0):Nr(r,c),Ja=g,ln=b}break;case 30:break;default:Nr(r,c)}}function u1(r){var s=r.alternate;s!==null&&(r.alternate=null,u1(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&M(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Gt=null,hi=!1;function er(r,s,c){for(c=c.child;c!==null;)d1(r,s,c),c=c.sibling}function d1(r,s,c){if(wt&&typeof wt.onCommitFiberUnmount=="function")try{wt.onCommitFiberUnmount(Ot,c)}catch{}switch(c.tag){case 26:ln||Aa(c,s),er(r,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:ln||Aa(c,s);var h=Gt,g=hi;Br(c.type)&&(Gt=c.stateNode,hi=!1),er(r,s,c),Yl(c.stateNode),Gt=h,hi=g;break;case 5:ln||Aa(c,s);case 6:if(h=Gt,g=hi,Gt=null,er(r,s,c),Gt=h,hi=g,Gt!==null)if(hi)try{(Gt.nodeType===9?Gt.body:Gt.nodeName==="HTML"?Gt.ownerDocument.body:Gt).removeChild(c.stateNode)}catch(b){Bt(c,s,b)}else try{Gt.removeChild(c.stateNode)}catch(b){Bt(c,s,b)}break;case 18:Gt!==null&&(hi?(r=Gt,J1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),ec(r)):J1(Gt,c.stateNode));break;case 4:h=Gt,g=hi,Gt=c.stateNode.containerInfo,hi=!0,er(r,s,c),Gt=h,hi=g;break;case 0:case 11:case 14:case 15:ln||Dr(2,c,s),ln||Dr(4,c,s),er(r,s,c);break;case 1:ln||(Aa(c,s),h=c.stateNode,typeof h.componentWillUnmount=="function"&&a1(c,s,h)),er(r,s,c);break;case 21:er(r,s,c);break;case 22:ln=(h=ln)||c.memoizedState!==null,er(r,s,c),ln=h;break;default:er(r,s,c)}}function f1(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ec(r)}catch(c){Bt(s,s.return,c)}}function M2(r){switch(r.tag){case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new l1),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new l1),s;default:throw Error(i(435,r.tag))}}function Ch(r,s){var c=M2(r);s.forEach(function(h){var g=W2.bind(null,r,h);c.has(h)||(c.add(h),h.then(g,g))})}function Di(r,s){var c=s.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],b=r,k=s,O=k;e:for(;O!==null;){switch(O.tag){case 27:if(Br(O.type)){Gt=O.stateNode,hi=!1;break e}break;case 5:Gt=O.stateNode,hi=!1;break e;case 3:case 4:Gt=O.stateNode.containerInfo,hi=!0;break e}O=O.return}if(Gt===null)throw Error(i(160));d1(b,k,g),Gt=null,hi=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)h1(s,r),s=s.sibling}var ua=null;function h1(r,s){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Di(s,r),Ni(r),h&4&&(Dr(3,r,r.return),Il(3,r),Dr(5,r,r.return));break;case 1:Di(s,r),Ni(r),h&512&&(ln||c===null||Aa(c,c.return)),h&64&&Ja&&(r=r.updateQueue,r!==null&&(h=r.callbacks,h!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=ua;if(Di(s,r),Ni(r),h&512&&(ln||c===null||Aa(c,c.return)),h&4){var b=c!==null?c.memoizedState:null;if(h=r.memoizedState,c===null)if(h===null)if(r.stateNode===null){e:{h=r.type,c=r.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":b=g.getElementsByTagName("title")[0],(!b||b[R]||b[Jt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(h),g.head.insertBefore(b,g.querySelector("head > title"))),Pn(b,h,c),b[Jt]=r,ee(b),h=b;break e;case"link":var k=ov("link","href",g).get(h+(c.href||""));if(k){for(var O=0;O<k.length;O++)if(b=k[O],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(O,1);break t}}b=g.createElement(h),Pn(b,h,c),g.head.appendChild(b);break;case"meta":if(k=ov("meta","content",g).get(h+(c.content||""))){for(O=0;O<k.length;O++)if(b=k[O],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(O,1);break t}}b=g.createElement(h),Pn(b,h,c),g.head.appendChild(b);break;default:throw Error(i(468,h))}b[Jt]=r,ee(b),h=b}r.stateNode=h}else lv(g,r.type,r.stateNode);else r.stateNode=sv(g,h,r.memoizedProps);else b!==h?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,h===null?lv(g,r.type,r.stateNode):sv(g,h,r.memoizedProps)):h===null&&r.stateNode!==null&&wh(r,r.memoizedProps,c.memoizedProps)}break;case 27:Di(s,r),Ni(r),h&512&&(ln||c===null||Aa(c,c.return)),c!==null&&h&4&&wh(r,r.memoizedProps,c.memoizedProps);break;case 5:if(Di(s,r),Ni(r),h&512&&(ln||c===null||Aa(c,c.return)),r.flags&32){g=r.stateNode;try{sa(g,"")}catch(fe){Bt(r,r.return,fe)}}h&4&&r.stateNode!=null&&(g=r.memoizedProps,wh(r,g,c!==null?c.memoizedProps:g)),h&1024&&(kh=!0);break;case 6:if(Di(s,r),Ni(r),h&4){if(r.stateNode===null)throw Error(i(162));h=r.memoizedProps,c=r.stateNode;try{c.nodeValue=h}catch(fe){Bt(r,r.return,fe)}}break;case 3:if(Ku=null,g=ua,ua=$u(s.containerInfo),Di(s,r),ua=g,Ni(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{ec(s.containerInfo)}catch(fe){Bt(r,r.return,fe)}kh&&(kh=!1,m1(r));break;case 4:h=ua,ua=$u(r.stateNode.containerInfo),Di(s,r),Ni(r),ua=h;break;case 12:Di(s,r),Ni(r);break;case 13:Di(s,r),Ni(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Mh=Re()),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Ch(r,h)));break;case 22:g=r.memoizedState!==null;var G=c!==null&&c.memoizedState!==null,oe=Ja,ge=ln;if(Ja=oe||g,ln=ge||G,Di(s,r),ln=ge,Ja=oe,Ni(r),h&8192)e:for(s=r.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||G||Ja||ln||ws(r)),c=null,s=r;;){if(s.tag===5||s.tag===26){if(c===null){G=c=s;try{if(b=G.stateNode,g)k=b.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{O=G.stateNode;var ye=G.memoizedProps.style,ce=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;O.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(fe){Bt(G,G.return,fe)}}}else if(s.tag===6){if(c===null){G=s;try{G.stateNode.nodeValue=g?"":G.memoizedProps}catch(fe){Bt(G,G.return,fe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=r.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Ch(r,c))));break;case 19:Di(s,r),Ni(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Ch(r,h)));break;case 30:break;case 21:break;default:Di(s,r),Ni(r)}}function Ni(r){var s=r.flags;if(s&2){try{for(var c,h=r.return;h!==null;){if(s1(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var g=c.stateNode,b=Eh(r);Lu(r,b,g);break;case 5:var k=c.stateNode;c.flags&32&&(sa(k,""),c.flags&=-33);var O=Eh(r);Lu(r,O,k);break;case 3:case 4:var G=c.stateNode.containerInfo,oe=Eh(r);Ah(r,oe,G);break;default:throw Error(i(161))}}catch(ge){Bt(r,r.return,ge)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function m1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;m1(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Nr(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)c1(r,s.alternate,s),s=s.sibling}function ws(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:Dr(4,s,s.return),ws(s);break;case 1:Aa(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&a1(s,s.return,c),ws(s);break;case 27:Yl(s.stateNode);case 26:case 5:Aa(s,s.return),ws(s);break;case 22:s.memoizedState===null&&ws(s);break;case 30:ws(s);break;default:ws(s)}r=r.sibling}}function Or(r,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=r,b=s,k=b.flags;switch(b.tag){case 0:case 11:case 15:Or(g,b,c),Il(4,b);break;case 1:if(Or(g,b,c),h=b,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(oe){Bt(h,h.return,oe)}if(h=b,g=h.updateQueue,g!==null){var O=h.stateNode;try{var G=g.shared.hiddenCallbacks;if(G!==null)for(g.shared.hiddenCallbacks=null,g=0;g<G.length;g++)Wg(G[g],O)}catch(oe){Bt(h,h.return,oe)}}c&&k&64&&i1(b),Pl(b,b.return);break;case 27:o1(b);case 26:case 5:Or(g,b,c),c&&h===null&&k&4&&r1(b),Pl(b,b.return);break;case 12:Or(g,b,c);break;case 13:Or(g,b,c),c&&k&4&&f1(g,b);break;case 22:b.memoizedState===null&&Or(g,b,c),Pl(b,b.return);break;case 30:break;default:Or(g,b,c)}s=s.sibling}}function jh(r,s){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&_l(c))}function Dh(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&_l(r))}function ka(r,s,c,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)p1(r,s,c,h),s=s.sibling}function p1(r,s,c,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:ka(r,s,c,h),g&2048&&Il(9,s);break;case 1:ka(r,s,c,h);break;case 3:ka(r,s,c,h),g&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&_l(r)));break;case 12:if(g&2048){ka(r,s,c,h),r=s.stateNode;try{var b=s.memoizedProps,k=b.id,O=b.onPostCommit;typeof O=="function"&&O(k,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){Bt(s,s.return,G)}}else ka(r,s,c,h);break;case 13:ka(r,s,c,h);break;case 23:break;case 22:b=s.stateNode,k=s.alternate,s.memoizedState!==null?b._visibility&2?ka(r,s,c,h):Bl(r,s):b._visibility&2?ka(r,s,c,h):(b._visibility|=2,xo(r,s,c,h,(s.subtreeFlags&10256)!==0)),g&2048&&jh(k,s);break;case 24:ka(r,s,c,h),g&2048&&Dh(s.alternate,s);break;default:ka(r,s,c,h)}}function xo(r,s,c,h,g){for(g=g&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var b=r,k=s,O=c,G=h,oe=k.flags;switch(k.tag){case 0:case 11:case 15:xo(b,k,O,G,g),Il(8,k);break;case 23:break;case 22:var ge=k.stateNode;k.memoizedState!==null?ge._visibility&2?xo(b,k,O,G,g):Bl(b,k):(ge._visibility|=2,xo(b,k,O,G,g)),g&&oe&2048&&jh(k.alternate,k);break;case 24:xo(b,k,O,G,g),g&&oe&2048&&Dh(k.alternate,k);break;default:xo(b,k,O,G,g)}s=s.sibling}}function Bl(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=r,h=s,g=h.flags;switch(h.tag){case 22:Bl(c,h),g&2048&&jh(h.alternate,h);break;case 24:Bl(c,h),g&2048&&Dh(h.alternate,h);break;default:Bl(c,h)}s=s.sibling}}var Fl=8192;function bo(r){if(r.subtreeFlags&Fl)for(r=r.child;r!==null;)g1(r),r=r.sibling}function g1(r){switch(r.tag){case 26:bo(r),r.flags&Fl&&r.memoizedState!==null&&xT(ua,r.memoizedState,r.memoizedProps);break;case 5:bo(r);break;case 3:case 4:var s=ua;ua=$u(r.stateNode.containerInfo),bo(r),ua=s;break;case 22:r.memoizedState===null&&(s=r.alternate,s!==null&&s.memoizedState!==null?(s=Fl,Fl=16777216,bo(r),Fl=s):bo(r));break;default:bo(r)}}function v1(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function Ul(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];kn=h,x1(h,r)}v1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)y1(r),r=r.sibling}function y1(r){switch(r.tag){case 0:case 11:case 15:Ul(r),r.flags&2048&&Dr(9,r,r.return);break;case 3:Ul(r);break;case 12:Ul(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,Iu(r)):Ul(r);break;default:Ul(r)}}function Iu(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];kn=h,x1(h,r)}v1(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:Dr(8,s,s.return),Iu(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,Iu(s));break;default:Iu(s)}r=r.sibling}}function x1(r,s){for(;kn!==null;){var c=kn;switch(c.tag){case 0:case 11:case 15:Dr(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:_l(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,kn=h;else e:for(c=r;kn!==null;){h=kn;var g=h.sibling,b=h.return;if(u1(h),h===c){kn=null;break e}if(g!==null){g.return=b,kn=g;break e}kn=b}}}var L2={getCacheForType:function(r){var s=Xn(bn),c=s.data.get(r);return c===void 0&&(c=r(),s.data.set(r,c)),c}},I2=typeof WeakMap=="function"?WeakMap:Map,Et=0,Ut=null,ot=null,ft=0,At=0,Oi=null,Rr=!1,So=!1,Nh=!1,tr=0,nn=0,Mr=0,Es=0,Oh=0,Ki=0,_o=0,zl=null,mi=null,Rh=!1,Mh=0,Pu=1/0,Bu=null,Lr=null,In=0,Ir=null,To=null,wo=0,Lh=0,Ih=null,b1=null,Hl=0,Ph=null;function Ri(){if((Et&2)!==0&&ft!==0)return ft&-ft;if(ie.T!==null){var r=uo;return r!==0?r:Vh()}return Ks()}function S1(){Ki===0&&(Ki=(ft&536870912)===0||St?ra():536870912);var r=qi.current;return r!==null&&(r.flags|=32),Ki}function Mi(r,s,c){(r===Ut&&(At===2||At===9)||r.cancelPendingCommit!==null)&&(Eo(r,0),Pr(r,ft,Ki,!1)),qt(r,c),((Et&2)===0||r!==Ut)&&(r===Ut&&((Et&2)===0&&(Es|=c),nn===4&&Pr(r,ft,Ki,!1)),Ca(r))}function _1(r,s,c){if((Et&6)!==0)throw Error(i(327));var h=!c&&(s&124)===0&&(s&r.expiredLanes)===0||Ui(r,s),g=h?F2(r,s):Uh(r,s,!0),b=h;do{if(g===0){So&&!h&&Pr(r,s,0,!1);break}else{if(c=r.current.alternate,b&&!P2(c)){g=Uh(r,s,!1),b=!1;continue}if(g===2){if(b=s,r.errorRecoveryDisabledLanes&b)var k=0;else k=r.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){s=k;e:{var O=r;g=zl;var G=O.current.memoizedState.isDehydrated;if(G&&(Eo(O,k).flags|=256),k=Uh(O,k,!1),k!==2){if(Nh&&!G){O.errorRecoveryDisabledLanes|=b,Es|=b,g=4;break e}b=mi,mi=g,b!==null&&(mi===null?mi=b:mi.push.apply(mi,b))}g=k}if(b=!1,g!==2)continue}}if(g===1){Eo(r,0),Pr(r,s,0,!0);break}e:{switch(h=r,b=g,b){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Pr(h,s,Ki,!Rr);break e;case 2:mi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=Mh+300-Re(),10<g)){if(Pr(h,s,Ki,!Rr),Yn(h,0,!0)!==0)break e;h.timeoutHandle=Z1(T1.bind(null,h,c,mi,Bu,Rh,s,Ki,Es,_o,Rr,b,2,-0,0),g);break e}T1(h,c,mi,Bu,Rh,s,Ki,Es,_o,Rr,b,0,-0,0)}}break}while(!0);Ca(r)}function T1(r,s,c,h,g,b,k,O,G,oe,ge,ye,ce,fe){if(r.timeoutHandle=-1,ye=s.subtreeFlags,(ye&8192||(ye&16785408)===16785408)&&(ql={stylesheets:null,count:0,unsuspend:yT},g1(s),ye=bT(),ye!==null)){r.cancelPendingCommit=ye(D1.bind(null,r,s,b,c,h,g,k,O,G,ge,1,ce,fe)),Pr(r,b,k,!oe);return}D1(r,s,b,c,h,g,k,O,G)}function P2(r){for(var s=r;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],b=g.getSnapshot;g=g.value;try{if(!Ci(b(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Pr(r,s,c,h){s&=~Oh,s&=~Es,r.suspendedLanes|=s,r.pingedLanes&=~s,h&&(r.warmLanes|=s),h=r.expirationTimes;for(var g=s;0<g;){var b=31-J(g),k=1<<b;h[b]=-1,g&=~k}c!==0&&vr(r,c,s)}function Fu(){return(Et&6)===0?(Wl(0),!1):!0}function Bh(){if(ot!==null){if(At===0)var r=ot.return;else r=ot,Xa=xs=null,th(r),vo=null,Rl=0,r=ot;for(;r!==null;)n1(r.alternate,r),r=r.return;ot=null}}function Eo(r,s){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,tT(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),Bh(),Ut=r,ot=c=Va(r.current,null),ft=s,At=0,Oi=null,Rr=!1,So=Ui(r,s),Nh=!1,_o=Ki=Oh=Es=Mr=nn=0,mi=zl=null,Rh=!1,(s&8)!==0&&(s|=s&32);var h=r.entangledLanes;if(h!==0)for(r=r.entanglements,h&=s;0<h;){var g=31-J(h),b=1<<g;s|=r[g],h&=~b}return tr=s,ou(),c}function w1(r,s){rt=null,ie.H=Au,s===wl||s===gu?(s=zg(),At=3):s===Bg?(s=zg(),At=4):At=s===H0?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Oi=s,ot===null&&(nn=1,Nu(r,Gi(s,r.current)))}function E1(){var r=ie.H;return ie.H=Au,r===null?Au:r}function A1(){var r=ie.A;return ie.A=L2,r}function Fh(){nn=4,Rr||(ft&4194048)!==ft&&qi.current!==null||(So=!0),(Mr&134217727)===0&&(Es&134217727)===0||Ut===null||Pr(Ut,ft,Ki,!1)}function Uh(r,s,c){var h=Et;Et|=2;var g=E1(),b=A1();(Ut!==r||ft!==s)&&(Bu=null,Eo(r,s)),s=!1;var k=nn;e:do try{if(At!==0&&ot!==null){var O=ot,G=Oi;switch(At){case 8:Bh(),k=6;break e;case 3:case 2:case 9:case 6:qi.current===null&&(s=!0);var oe=At;if(At=0,Oi=null,Ao(r,O,G,oe),c&&So){k=0;break e}break;default:oe=At,At=0,Oi=null,Ao(r,O,G,oe)}}B2(),k=nn;break}catch(ge){w1(r,ge)}while(!0);return s&&r.shellSuspendCounter++,Xa=xs=null,Et=h,ie.H=g,ie.A=b,ot===null&&(Ut=null,ft=0,ou()),k}function B2(){for(;ot!==null;)k1(ot)}function F2(r,s){var c=Et;Et|=2;var h=E1(),g=A1();Ut!==r||ft!==s?(Bu=null,Pu=Re()+500,Eo(r,s)):So=Ui(r,s);e:do try{if(At!==0&&ot!==null){s=ot;var b=Oi;t:switch(At){case 1:At=0,Oi=null,Ao(r,s,b,1);break;case 2:case 9:if(Fg(b)){At=0,Oi=null,C1(s);break}s=function(){At!==2&&At!==9||Ut!==r||(At=7),Ca(r)},b.then(s,s);break e;case 3:At=7;break e;case 4:At=5;break e;case 7:Fg(b)?(At=0,Oi=null,C1(s)):(At=0,Oi=null,Ao(r,s,b,7));break;case 5:var k=null;switch(ot.tag){case 26:k=ot.memoizedState;case 5:case 27:var O=ot;if(!k||cv(k)){At=0,Oi=null;var G=O.sibling;if(G!==null)ot=G;else{var oe=O.return;oe!==null?(ot=oe,Uu(oe)):ot=null}break t}}At=0,Oi=null,Ao(r,s,b,5);break;case 6:At=0,Oi=null,Ao(r,s,b,6);break;case 8:Bh(),nn=6;break e;default:throw Error(i(462))}}U2();break}catch(ge){w1(r,ge)}while(!0);return Xa=xs=null,ie.H=h,ie.A=g,Et=c,ot!==null?0:(Ut=null,ft=0,ou(),nn)}function U2(){for(;ot!==null&&!Gn();)k1(ot)}function k1(r){var s=e1(r.alternate,r,tr);r.memoizedProps=r.pendingProps,s===null?Uu(r):ot=s}function C1(r){var s=r,c=s.alternate;switch(s.tag){case 15:case 0:s=$0(c,s,s.pendingProps,s.type,void 0,ft);break;case 11:s=$0(c,s,s.pendingProps,s.type.render,s.ref,ft);break;case 5:th(s);default:n1(c,s),s=ot=jg(s,tr),s=e1(c,s,tr)}r.memoizedProps=r.pendingProps,s===null?Uu(r):ot=s}function Ao(r,s,c,h){Xa=xs=null,th(s),vo=null,Rl=0;var g=s.return;try{if(j2(r,g,s,c,ft)){nn=1,Nu(r,Gi(c,r.current)),ot=null;return}}catch(b){if(g!==null)throw ot=g,b;nn=1,Nu(r,Gi(c,r.current)),ot=null;return}s.flags&32768?(St||h===1?r=!0:So||(ft&536870912)!==0?r=!1:(Rr=r=!0,(h===2||h===9||h===3||h===6)&&(h=qi.current,h!==null&&h.tag===13&&(h.flags|=16384))),j1(s,r)):Uu(s)}function Uu(r){var s=r;do{if((s.flags&32768)!==0){j1(s,Rr);return}r=s.return;var c=N2(s.alternate,s,tr);if(c!==null){ot=c;return}if(s=s.sibling,s!==null){ot=s;return}ot=s=r}while(s!==null);nn===0&&(nn=5)}function j1(r,s){do{var c=O2(r.alternate,r);if(c!==null){c.flags&=32767,ot=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(r=r.sibling,r!==null)){ot=r;return}ot=r=c}while(r!==null);nn=6,ot=null}function D1(r,s,c,h,g,b,k,O,G){r.cancelPendingCommit=null;do zu();while(In!==0);if((Et&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(b=s.lanes|s.childLanes,b|=Df,zi(r,c,b,k,O,G),r===Ut&&(ot=Ut=null,ft=0),To=s,Ir=r,wo=c,Lh=b,Ih=g,b1=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,V2(ti,function(){return L1(),null})):(r.callbackNode=null,r.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=ie.T,ie.T=null,g=he.p,he.p=2,k=Et,Et|=4;try{R2(r,s,c)}finally{Et=k,he.p=g,ie.T=h}}In=1,N1(),O1(),R1()}}function N1(){if(In===1){In=0;var r=Ir,s=To,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=ie.T,ie.T=null;var h=he.p;he.p=2;var g=Et;Et|=4;try{h1(s,r);var b=Qh,k=xg(r.containerInfo),O=b.focusedElem,G=b.selectionRange;if(k!==O&&O&&O.ownerDocument&&yg(O.ownerDocument.documentElement,O)){if(G!==null&&Ef(O)){var oe=G.start,ge=G.end;if(ge===void 0&&(ge=oe),"selectionStart"in O)O.selectionStart=oe,O.selectionEnd=Math.min(ge,O.value.length);else{var ye=O.ownerDocument||document,ce=ye&&ye.defaultView||window;if(ce.getSelection){var fe=ce.getSelection(),Ke=O.textContent.length,Xe=Math.min(G.start,Ke),Lt=G.end===void 0?Xe:Math.min(G.end,Ke);!fe.extend&&Xe>Lt&&(k=Lt,Lt=Xe,Xe=k);var te=vg(O,Xe),Q=vg(O,Lt);if(te&&Q&&(fe.rangeCount!==1||fe.anchorNode!==te.node||fe.anchorOffset!==te.offset||fe.focusNode!==Q.node||fe.focusOffset!==Q.offset)){var ae=ye.createRange();ae.setStart(te.node,te.offset),fe.removeAllRanges(),Xe>Lt?(fe.addRange(ae),fe.extend(Q.node,Q.offset)):(ae.setEnd(Q.node,Q.offset),fe.addRange(ae))}}}}for(ye=[],fe=O;fe=fe.parentNode;)fe.nodeType===1&&ye.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<ye.length;O++){var ve=ye[O];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}Ju=!!Zh,Qh=Zh=null}finally{Et=g,he.p=h,ie.T=c}}r.current=s,In=2}}function O1(){if(In===2){In=0;var r=Ir,s=To,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=ie.T,ie.T=null;var h=he.p;he.p=2;var g=Et;Et|=4;try{c1(r,s.alternate,s)}finally{Et=g,he.p=h,ie.T=c}}In=3}}function R1(){if(In===4||In===3){In=0,gt();var r=Ir,s=To,c=wo,h=b1;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?In=5:(In=0,To=Ir=null,M1(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(Lr=null),ss(c),s=s.stateNode,wt&&typeof wt.onCommitFiberRoot=="function")try{wt.onCommitFiberRoot(Ot,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=ie.T,g=he.p,he.p=2,ie.T=null;try{for(var b=r.onRecoverableError,k=0;k<h.length;k++){var O=h[k];b(O.value,{componentStack:O.stack})}}finally{ie.T=s,he.p=g}}(wo&3)!==0&&zu(),Ca(r),g=r.pendingLanes,(c&4194090)!==0&&(g&42)!==0?r===Ph?Hl++:(Hl=0,Ph=r):Hl=0,Wl(0)}}function M1(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,_l(s)))}function zu(r){return N1(),O1(),R1(),L1()}function L1(){if(In!==5)return!1;var r=Ir,s=Lh;Lh=0;var c=ss(wo),h=ie.T,g=he.p;try{he.p=32>c?32:c,ie.T=null,c=Ih,Ih=null;var b=Ir,k=wo;if(In=0,To=Ir=null,wo=0,(Et&6)!==0)throw Error(i(331));var O=Et;if(Et|=4,y1(b.current),p1(b,b.current,k,c),Et=O,Wl(0,!1),wt&&typeof wt.onPostCommitFiberRoot=="function")try{wt.onPostCommitFiberRoot(Ot,b)}catch{}return!0}finally{he.p=g,ie.T=h,M1(r,s)}}function I1(r,s,c){s=Gi(c,s),s=ph(r.stateNode,s,2),r=Ar(r,s,2),r!==null&&(qt(r,2),Ca(r))}function Bt(r,s,c){if(r.tag===3)I1(r,r,c);else for(;s!==null;){if(s.tag===3){I1(s,r,c);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Lr===null||!Lr.has(h))){r=Gi(c,r),c=U0(2),h=Ar(s,c,2),h!==null&&(z0(c,h,s,r),qt(h,2),Ca(h));break}}s=s.return}}function zh(r,s,c){var h=r.pingCache;if(h===null){h=r.pingCache=new I2;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(c)||(Nh=!0,g.add(c),r=z2.bind(null,r,s,c),s.then(r,r))}function z2(r,s,c){var h=r.pingCache;h!==null&&h.delete(s),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,Ut===r&&(ft&c)===c&&(nn===4||nn===3&&(ft&62914560)===ft&&300>Re()-Mh?(Et&2)===0&&Eo(r,0):Oh|=c,_o===ft&&(_o=0)),Ca(r)}function P1(r,s){s===0&&(s=wi()),r=so(r,s),r!==null&&(qt(r,s),Ca(r))}function H2(r){var s=r.memoizedState,c=0;s!==null&&(c=s.retryLane),P1(r,c)}function W2(r,s){var c=0;switch(r.tag){case 13:var h=r.stateNode,g=r.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=r.stateNode;break;case 22:h=r.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(s),P1(r,c)}function V2(r,s){return Ht(r,s)}var Hu=null,ko=null,Hh=!1,Wu=!1,Wh=!1,As=0;function Ca(r){r!==ko&&r.next===null&&(ko===null?Hu=ko=r:ko=ko.next=r),Wu=!0,Hh||(Hh=!0,Y2())}function Wl(r,s){if(!Wh&&Wu){Wh=!0;do for(var c=!1,h=Hu;h!==null;){if(r!==0){var g=h.pendingLanes;if(g===0)var b=0;else{var k=h.suspendedLanes,O=h.pingedLanes;b=(1<<31-J(42|r)+1)-1,b&=g&~(k&~O),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,z1(h,b))}else b=ft,b=Yn(h,h===Ut?b:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(b&3)===0||Ui(h,b)||(c=!0,z1(h,b));h=h.next}while(c);Wh=!1}}function G2(){B1()}function B1(){Wu=Hh=!1;var r=0;As!==0&&(eT()&&(r=As),As=0);for(var s=Re(),c=null,h=Hu;h!==null;){var g=h.next,b=F1(h,s);b===0?(h.next=null,c===null?Hu=g:c.next=g,g===null&&(ko=c)):(c=h,(r!==0||(b&3)!==0)&&(Wu=!0)),h=g}Wl(r)}function F1(r,s){for(var c=r.suspendedLanes,h=r.pingedLanes,g=r.expirationTimes,b=r.pendingLanes&-62914561;0<b;){var k=31-J(b),O=1<<k,G=g[k];G===-1?((O&c)===0||(O&h)!==0)&&(g[k]=ut(O,s)):G<=s&&(r.expiredLanes|=O),b&=~O}if(s=Ut,c=ft,c=Yn(r,r===s?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h=r.callbackNode,c===0||r===s&&(At===2||At===9)||r.cancelPendingCommit!==null)return h!==null&&h!==null&&at(h),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Ui(r,c)){if(s=c&-c,s===r.callbackPriority)return s;switch(h!==null&&at(h),ss(c)){case 2:case 8:c=ei;break;case 32:c=ti;break;case 268435456:c=Fe;break;default:c=ti}return h=U1.bind(null,r),c=Ht(c,h),r.callbackPriority=s,r.callbackNode=c,s}return h!==null&&h!==null&&at(h),r.callbackPriority=2,r.callbackNode=null,2}function U1(r,s){if(In!==0&&In!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(zu()&&r.callbackNode!==c)return null;var h=ft;return h=Yn(r,r===Ut?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h===0?null:(_1(r,h,s),F1(r,Re()),r.callbackNode!=null&&r.callbackNode===c?U1.bind(null,r):null)}function z1(r,s){if(zu())return null;_1(r,s,!0)}function Y2(){nT(function(){(Et&6)!==0?Ht(Rn,G2):B1()})}function Vh(){return As===0&&(As=ra()),As}function H1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:oa(""+r)}function W1(r,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,r.id&&c.setAttribute("form",r.id),s.parentNode.insertBefore(c,s),r=new FormData(r),c.parentNode.removeChild(c),r}function X2(r,s,c,h,g){if(s==="submit"&&c&&c.stateNode===g){var b=H1((g[en]||null).action),k=h.submitter;k&&(s=(s=k[en]||null)?H1(s.formAction):k.getAttribute("formAction"),s!==null&&(b=s,k=null));var O=new we("action","action",null,h,g);r.push({event:O,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(As!==0){var G=k?W1(g,k):new FormData(g);uh(c,{pending:!0,data:G,method:g.method,action:b},null,G)}}else typeof b=="function"&&(O.preventDefault(),G=k?W1(g,k):new FormData(g),uh(c,{pending:!0,data:G,method:g.method,action:b},b,G))},currentTarget:g}]})}}for(var Gh=0;Gh<jf.length;Gh++){var Yh=jf[Gh],$2=Yh.toLowerCase(),q2=Yh[0].toUpperCase()+Yh.slice(1);ca($2,"on"+q2)}ca(_g,"onAnimationEnd"),ca(Tg,"onAnimationIteration"),ca(wg,"onAnimationStart"),ca("dblclick","onDoubleClick"),ca("focusin","onFocus"),ca("focusout","onBlur"),ca(f2,"onTransitionRun"),ca(h2,"onTransitionStart"),ca(m2,"onTransitionCancel"),ca(Eg,"onTransitionEnd"),Ee("onMouseEnter",["mouseout","mouseover"]),Ee("onMouseLeave",["mouseout","mouseover"]),Ee("onPointerEnter",["pointerout","pointerover"]),Ee("onPointerLeave",["pointerout","pointerover"]),Se("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Se("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Se("onBeforeInput",["compositionend","keypress","textInput","paste"]),Se("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),K2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vl));function V1(r,s){s=(s&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],g=h.event;h=h.listeners;e:{var b=void 0;if(s)for(var k=h.length-1;0<=k;k--){var O=h[k],G=O.instance,oe=O.currentTarget;if(O=O.listener,G!==b&&g.isPropagationStopped())break e;b=O,g.currentTarget=oe;try{b(g)}catch(ge){Du(ge)}g.currentTarget=null,b=G}else for(k=0;k<h.length;k++){if(O=h[k],G=O.instance,oe=O.currentTarget,O=O.listener,G!==b&&g.isPropagationStopped())break e;b=O,g.currentTarget=oe;try{b(g)}catch(ge){Du(ge)}g.currentTarget=null,b=G}}}}function lt(r,s){var c=s[os];c===void 0&&(c=s[os]=new Set);var h=r+"__bubble";c.has(h)||(G1(s,r,2,!1),c.add(h))}function Xh(r,s,c){var h=0;s&&(h|=4),G1(c,r,h,s)}var Vu="_reactListening"+Math.random().toString(36).slice(2);function $h(r){if(!r[Vu]){r[Vu]=!0,le.forEach(function(c){c!=="selectionchange"&&(K2.has(c)||Xh(c,!1,r),Xh(c,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Vu]||(s[Vu]=!0,Xh("selectionchange",!1,s))}}function G1(r,s,c,h){switch(pv(s)){case 2:var g=TT;break;case 8:g=wT;break;default:g=lm}c=g.bind(null,s,c,r),g=void 0,!eo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?r.addEventListener(s,c,{capture:!0,passive:g}):r.addEventListener(s,c,!0):g!==void 0?r.addEventListener(s,c,{passive:g}):r.addEventListener(s,c,!1)}function qh(r,s,c,h,g){var b=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var k=h.tag;if(k===3||k===4){var O=h.stateNode.containerInfo;if(O===g)break;if(k===4)for(k=h.return;k!==null;){var G=k.tag;if((G===3||G===4)&&k.stateNode.containerInfo===g)return;k=k.return}for(;O!==null;){if(k=F(O),k===null)return;if(G=k.tag,G===5||G===6||G===26||G===27){h=b=k;continue e}O=O.parentNode}}h=h.return}Ai(function(){var oe=b,ge=Js(c),ye=[];e:{var ce=Ag.get(r);if(ce!==void 0){var fe=we,Ke=r;switch(r){case"keypress":if(us(c)===0)break e;case"keydown":case"keyup":fe=V_;break;case"focusin":Ke="focus",fe=to;break;case"focusout":Ke="blur",fe=to;break;case"beforeblur":case"afterblur":fe=to;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=_r;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=En;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=X_;break;case _g:case Tg:case wg:fe=L_;break;case Eg:fe=q_;break;case"scroll":case"scrollend":fe=Ft;break;case"wheel":fe=Z_;break;case"copy":case"cut":case"paste":fe=P_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=ig;break;case"toggle":case"beforetoggle":fe=J_}var Xe=(s&4)!==0,Lt=!Xe&&(r==="scroll"||r==="scrollend"),te=Xe?ce!==null?ce+"Capture":null:ce;Xe=[];for(var Q=oe,ae;Q!==null;){var ve=Q;if(ae=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||ae===null||te===null||(ve=Wi(Q,te),ve!=null&&Xe.push(Gl(Q,ve,ae))),Lt)break;Q=Q.return}0<Xe.length&&(ce=new fe(ce,Ke,null,c,ge),ye.push({event:ce,listeners:Xe}))}}if((s&7)===0){e:{if(ce=r==="mouseover"||r==="pointerover",fe=r==="mouseout"||r==="pointerout",ce&&c!==ll&&(Ke=c.relatedTarget||c.fromElement)&&(F(Ke)||Ke[ba]))break e;if((fe||ce)&&(ce=ge.window===ge?ge:(ce=ge.ownerDocument)?ce.defaultView||ce.parentWindow:window,fe?(Ke=c.relatedTarget||c.toElement,fe=oe,Ke=Ke?F(Ke):null,Ke!==null&&(Lt=o(Ke),Xe=Ke.tag,Ke!==Lt||Xe!==5&&Xe!==27&&Xe!==6)&&(Ke=null)):(fe=null,Ke=oe),fe!==Ke)){if(Xe=_r,ve="onMouseLeave",te="onMouseEnter",Q="mouse",(r==="pointerout"||r==="pointerover")&&(Xe=ig,ve="onPointerLeave",te="onPointerEnter",Q="pointer"),Lt=fe==null?ce:se(fe),ae=Ke==null?ce:se(Ke),ce=new Xe(ve,Q+"leave",fe,c,ge),ce.target=Lt,ce.relatedTarget=ae,ve=null,F(ge)===oe&&(Xe=new Xe(te,Q+"enter",Ke,c,ge),Xe.target=ae,Xe.relatedTarget=Lt,ve=Xe),Lt=ve,fe&&Ke)t:{for(Xe=fe,te=Ke,Q=0,ae=Xe;ae;ae=Co(ae))Q++;for(ae=0,ve=te;ve;ve=Co(ve))ae++;for(;0<Q-ae;)Xe=Co(Xe),Q--;for(;0<ae-Q;)te=Co(te),ae--;for(;Q--;){if(Xe===te||te!==null&&Xe===te.alternate)break t;Xe=Co(Xe),te=Co(te)}Xe=null}else Xe=null;fe!==null&&Y1(ye,ce,fe,Xe,!1),Ke!==null&&Lt!==null&&Y1(ye,Lt,Ke,Xe,!0)}}e:{if(ce=oe?se(oe):window,fe=ce.nodeName&&ce.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ce.type==="file")var ze=dg;else if(cg(ce))if(fg)ze=c2;else{ze=o2;var st=s2}else fe=ce.nodeName,!fe||fe.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?oe&&ol(oe.elementType)&&(ze=dg):ze=l2;if(ze&&(ze=ze(r,oe))){ug(ye,ze,c,ge);break e}st&&st(r,ce,oe),r==="focusout"&&oe&&ce.type==="number"&&oe.memoizedProps.value!=null&&Sa(ce,"number",ce.value)}switch(st=oe?se(oe):window,r){case"focusin":(cg(st)||st.contentEditable==="true")&&(io=st,Af=oe,vl=null);break;case"focusout":vl=Af=io=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,bg(ye,c,ge);break;case"selectionchange":if(d2)break;case"keydown":case"keyup":bg(ye,c,ge)}var We;if(_f)e:{switch(r){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else no?og(r,c)&&(qe="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(qe="onCompositionStart");qe&&(ag&&c.locale!=="ko"&&(no||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&no&&(We=dl()):(la=ge,ki="value"in la?la.value:la.textContent,no=!0)),st=Gu(oe,qe),0<st.length&&(qe=new ng(qe,r,null,c,ge),ye.push({event:qe,listeners:st}),We?qe.data=We:(We=lg(c),We!==null&&(qe.data=We)))),(We=t2?n2(r,c):i2(r,c))&&(qe=Gu(oe,"onBeforeInput"),0<qe.length&&(st=new ng("onBeforeInput","beforeinput",null,c,ge),ye.push({event:st,listeners:qe}),st.data=We)),X2(ye,r,oe,c,ge)}V1(ye,s)})}function Gl(r,s,c){return{instance:r,listener:s,currentTarget:c}}function Gu(r,s){for(var c=s+"Capture",h=[];r!==null;){var g=r,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=Wi(r,c),g!=null&&h.unshift(Gl(r,g,b)),g=Wi(r,s),g!=null&&h.push(Gl(r,g,b))),r.tag===3)return h;r=r.return}return[]}function Co(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Y1(r,s,c,h,g){for(var b=s._reactName,k=[];c!==null&&c!==h;){var O=c,G=O.alternate,oe=O.stateNode;if(O=O.tag,G!==null&&G===h)break;O!==5&&O!==26&&O!==27||oe===null||(G=oe,g?(oe=Wi(c,b),oe!=null&&k.unshift(Gl(c,oe,G))):g||(oe=Wi(c,b),oe!=null&&k.push(Gl(c,oe,G)))),c=c.return}k.length!==0&&r.push({event:s,listeners:k})}var Z2=/\r\n?/g,Q2=/\u0000|\uFFFD/g;function X1(r){return(typeof r=="string"?r:""+r).replace(Z2,`
`).replace(Q2,"")}function $1(r,s){return s=X1(s),X1(r)===s}function Yu(){}function Mt(r,s,c,h,g,b){switch(c){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||sa(r,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&sa(r,""+h);break;case"className":yt(r,"class",h);break;case"tabIndex":yt(r,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":yt(r,c,h);break;case"style":Sr(r,h,b);break;case"data":if(s!=="object"){yt(r,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||c!=="href")){r.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(c);break}h=oa(""+h),r.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(s!=="input"&&Mt(r,s,"name",g.name,g,null),Mt(r,s,"formEncType",g.formEncType,g,null),Mt(r,s,"formMethod",g.formMethod,g,null),Mt(r,s,"formTarget",g.formTarget,g,null)):(Mt(r,s,"encType",g.encType,g,null),Mt(r,s,"method",g.method,g,null),Mt(r,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(c);break}h=oa(""+h),r.setAttribute(c,h);break;case"onClick":h!=null&&(r.onclick=Yu);break;case"onScroll":h!=null&&lt("scroll",r);break;case"onScrollEnd":h!=null&&lt("scrollend",r);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"multiple":r.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":r.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){r.removeAttribute("xlink:href");break}c=oa(""+h),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,""+h):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":h===!0?r.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(c,h):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?r.setAttribute(c,h):r.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?r.removeAttribute(c):r.setAttribute(c,h);break;case"popover":lt("beforetoggle",r),lt("toggle",r),vt(r,"popover",h);break;case"xlinkActuate":ht(r,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ht(r,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ht(r,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ht(r,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ht(r,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ht(r,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ht(r,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ht(r,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ht(r,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":vt(r,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=bf.get(c)||c,vt(r,c,h))}}function Kh(r,s,c,h,g,b){switch(c){case"style":Sr(r,h,b);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"children":typeof h=="string"?sa(r,h):(typeof h=="number"||typeof h=="bigint")&&sa(r,""+h);break;case"onScroll":h!=null&&lt("scroll",r);break;case"onScrollEnd":h!=null&&lt("scrollend",r);break;case"onClick":h!=null&&(r.onclick=Yu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!de.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),b=r[en]||null,b=b!=null?b[c]:null,typeof b=="function"&&r.removeEventListener(s,b,g),typeof h=="function")){typeof b!="function"&&b!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(s,h,g);break e}c in r?r[c]=h:h===!0?r.setAttribute(c,""):vt(r,c,h)}}}function Pn(r,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lt("error",r),lt("load",r);var h=!1,g=!1,b;for(b in c)if(c.hasOwnProperty(b)){var k=c[b];if(k!=null)switch(b){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Mt(r,s,b,k,c,null)}}g&&Mt(r,s,"srcSet",c.srcSet,c,null),h&&Mt(r,s,"src",c.src,c,null);return;case"input":lt("invalid",r);var O=b=k=g=null,G=null,oe=null;for(h in c)if(c.hasOwnProperty(h)){var ge=c[h];if(ge!=null)switch(h){case"name":g=ge;break;case"type":k=ge;break;case"checked":G=ge;break;case"defaultChecked":oe=ge;break;case"value":b=ge;break;case"defaultValue":O=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,s));break;default:Mt(r,s,h,ge,c,null)}}Hi(r,b,O,G,oe,k,g,!1),ls(r);return;case"select":lt("invalid",r),h=k=b=null;for(g in c)if(c.hasOwnProperty(g)&&(O=c[g],O!=null))switch(g){case"value":b=O;break;case"defaultValue":k=O;break;case"multiple":h=O;default:Mt(r,s,g,O,c,null)}s=b,c=k,r.multiple=!!h,s!=null?_a(r,!!h,s,!1):c!=null&&_a(r,!!h,c,!0);return;case"textarea":lt("invalid",r),b=g=h=null;for(k in c)if(c.hasOwnProperty(k)&&(O=c[k],O!=null))switch(k){case"value":h=O;break;case"defaultValue":g=O;break;case"children":b=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(91));break;default:Mt(r,s,k,O,c,null)}nu(r,h,g,b),ls(r);return;case"option":for(G in c)if(c.hasOwnProperty(G)&&(h=c[G],h!=null))switch(G){case"selected":r.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Mt(r,s,G,h,c,null)}return;case"dialog":lt("beforetoggle",r),lt("toggle",r),lt("cancel",r),lt("close",r);break;case"iframe":case"object":lt("load",r);break;case"video":case"audio":for(h=0;h<Vl.length;h++)lt(Vl[h],r);break;case"image":lt("error",r),lt("load",r);break;case"details":lt("toggle",r);break;case"embed":case"source":case"link":lt("error",r),lt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in c)if(c.hasOwnProperty(oe)&&(h=c[oe],h!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Mt(r,s,oe,h,c,null)}return;default:if(ol(s)){for(ge in c)c.hasOwnProperty(ge)&&(h=c[ge],h!==void 0&&Kh(r,s,ge,h,c,void 0));return}}for(O in c)c.hasOwnProperty(O)&&(h=c[O],h!=null&&Mt(r,s,O,h,c,null))}function J2(r,s,c,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,k=null,O=null,G=null,oe=null,ge=null;for(fe in c){var ye=c[fe];if(c.hasOwnProperty(fe)&&ye!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":G=ye;default:h.hasOwnProperty(fe)||Mt(r,s,fe,null,h,ye)}}for(var ce in h){var fe=h[ce];if(ye=c[ce],h.hasOwnProperty(ce)&&(fe!=null||ye!=null))switch(ce){case"type":b=fe;break;case"name":g=fe;break;case"checked":oe=fe;break;case"defaultChecked":ge=fe;break;case"value":k=fe;break;case"defaultValue":O=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,s));break;default:fe!==ye&&Mt(r,s,ce,fe,h,ye)}}br(r,k,O,G,oe,ge,b,g);return;case"select":fe=k=O=ce=null;for(b in c)if(G=c[b],c.hasOwnProperty(b)&&G!=null)switch(b){case"value":break;case"multiple":fe=G;default:h.hasOwnProperty(b)||Mt(r,s,b,null,h,G)}for(g in h)if(b=h[g],G=c[g],h.hasOwnProperty(g)&&(b!=null||G!=null))switch(g){case"value":ce=b;break;case"defaultValue":O=b;break;case"multiple":k=b;default:b!==G&&Mt(r,s,g,b,h,G)}s=O,c=k,h=fe,ce!=null?_a(r,!!c,ce,!1):!!h!=!!c&&(s!=null?_a(r,!!c,s,!0):_a(r,!!c,c?[]:"",!1));return;case"textarea":fe=ce=null;for(O in c)if(g=c[O],c.hasOwnProperty(O)&&g!=null&&!h.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Mt(r,s,O,null,h,g)}for(k in h)if(g=h[k],b=c[k],h.hasOwnProperty(k)&&(g!=null||b!=null))switch(k){case"value":ce=g;break;case"defaultValue":fe=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==b&&Mt(r,s,k,g,h,b)}Zs(r,ce,fe);return;case"option":for(var Ke in c)if(ce=c[Ke],c.hasOwnProperty(Ke)&&ce!=null&&!h.hasOwnProperty(Ke))switch(Ke){case"selected":r.selected=!1;break;default:Mt(r,s,Ke,null,h,ce)}for(G in h)if(ce=h[G],fe=c[G],h.hasOwnProperty(G)&&ce!==fe&&(ce!=null||fe!=null))switch(G){case"selected":r.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:Mt(r,s,G,ce,h,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in c)ce=c[Xe],c.hasOwnProperty(Xe)&&ce!=null&&!h.hasOwnProperty(Xe)&&Mt(r,s,Xe,null,h,ce);for(oe in h)if(ce=h[oe],fe=c[oe],h.hasOwnProperty(oe)&&ce!==fe&&(ce!=null||fe!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,s));break;default:Mt(r,s,oe,ce,h,fe)}return;default:if(ol(s)){for(var Lt in c)ce=c[Lt],c.hasOwnProperty(Lt)&&ce!==void 0&&!h.hasOwnProperty(Lt)&&Kh(r,s,Lt,void 0,h,ce);for(ge in h)ce=h[ge],fe=c[ge],!h.hasOwnProperty(ge)||ce===fe||ce===void 0&&fe===void 0||Kh(r,s,ge,ce,h,fe);return}}for(var te in c)ce=c[te],c.hasOwnProperty(te)&&ce!=null&&!h.hasOwnProperty(te)&&Mt(r,s,te,null,h,ce);for(ye in h)ce=h[ye],fe=c[ye],!h.hasOwnProperty(ye)||ce===fe||ce==null&&fe==null||Mt(r,s,ye,ce,h,fe)}var Zh=null,Qh=null;function Xu(r){return r.nodeType===9?r:r.ownerDocument}function q1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function K1(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function Jh(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var em=null;function eT(){var r=window.event;return r&&r.type==="popstate"?r===em?!1:(em=r,!0):(em=null,!1)}var Z1=typeof setTimeout=="function"?setTimeout:void 0,tT=typeof clearTimeout=="function"?clearTimeout:void 0,Q1=typeof Promise=="function"?Promise:void 0,nT=typeof queueMicrotask=="function"?queueMicrotask:typeof Q1<"u"?function(r){return Q1.resolve(null).then(r).catch(iT)}:Z1;function iT(r){setTimeout(function(){throw r})}function Br(r){return r==="head"}function J1(r,s){var c=s,h=0,g=0;do{var b=c.nextSibling;if(r.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(0<h&&8>h){c=h;var k=r.ownerDocument;if(c&1&&Yl(k.documentElement),c&2&&Yl(k.body),c&4)for(c=k.head,Yl(c),k=c.firstChild;k;){var O=k.nextSibling,G=k.nodeName;k[R]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&k.rel.toLowerCase()==="stylesheet"||c.removeChild(k),k=O}}if(g===0){r.removeChild(b),ec(s);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:h=c.charCodeAt(0)-48;else h=0;c=b}while(c);ec(s)}function tm(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":tm(c),M(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function aT(r,s,c,h){for(;r.nodeType===1;){var g=c;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(h){if(!r[R])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(b=r.getAttribute("rel"),b==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(b!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(b=r.getAttribute("src"),(b!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===b)return r}else return r;if(r=da(r.nextSibling),r===null)break}return null}function rT(r,s,c){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=da(r.nextSibling),r===null))return null;return r}function nm(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function sT(r,s){var c=r.ownerDocument;if(r.data!=="$?"||c.readyState==="complete")s();else{var h=function(){s(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),r._reactRetry=h}}function da(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return r}var im=null;function ev(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return r;s--}else c==="/$"&&s++}r=r.previousSibling}return null}function tv(r,s,c){switch(s=Xu(c),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Yl(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);M(r)}var Zi=new Map,nv=new Set;function $u(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var nr=he.d;he.d={f:oT,r:lT,D:cT,C:uT,L:dT,m:fT,X:mT,S:hT,M:pT};function oT(){var r=nr.f(),s=Fu();return r||s}function lT(r){var s=B(r);s!==null&&s.tag===5&&s.type==="form"?_0(s):nr.r(r)}var jo=typeof document>"u"?null:document;function iv(r,s,c){var h=jo;if(h&&typeof s=="string"&&s){var g=Mn(s);g='link[rel="'+r+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),nv.has(g)||(nv.add(g),r={rel:r,crossOrigin:c,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),Pn(s,"link",r),ee(s),h.head.appendChild(s)))}}function cT(r){nr.D(r),iv("dns-prefetch",r,null)}function uT(r,s){nr.C(r,s),iv("preconnect",r,s)}function dT(r,s,c){nr.L(r,s,c);var h=jo;if(h&&r&&s){var g='link[rel="preload"][as="'+Mn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Mn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Mn(c.imageSizes)+'"]')):g+='[href="'+Mn(r)+'"]';var b=g;switch(s){case"style":b=Do(r);break;case"script":b=No(r)}Zi.has(b)||(r=p({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:r,as:s},c),Zi.set(b,r),h.querySelector(g)!==null||s==="style"&&h.querySelector(Xl(b))||s==="script"&&h.querySelector($l(b))||(s=h.createElement("link"),Pn(s,"link",r),ee(s),h.head.appendChild(s)))}}function fT(r,s){nr.m(r,s);var c=jo;if(c&&r){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Mn(h)+'"][href="'+Mn(r)+'"]',b=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=No(r)}if(!Zi.has(b)&&(r=p({rel:"modulepreload",href:r},s),Zi.set(b,r),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector($l(b)))return}h=c.createElement("link"),Pn(h,"link",r),ee(h),c.head.appendChild(h)}}}function hT(r,s,c){nr.S(r,s,c);var h=jo;if(h&&r){var g=ue(h).hoistableStyles,b=Do(r);s=s||"default";var k=g.get(b);if(!k){var O={loading:0,preload:null};if(k=h.querySelector(Xl(b)))O.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":s},c),(c=Zi.get(b))&&am(r,c);var G=k=h.createElement("link");ee(G),Pn(G,"link",r),G._p=new Promise(function(oe,ge){G.onload=oe,G.onerror=ge}),G.addEventListener("load",function(){O.loading|=1}),G.addEventListener("error",function(){O.loading|=2}),O.loading|=4,qu(k,s,h)}k={type:"stylesheet",instance:k,count:1,state:O},g.set(b,k)}}}function mT(r,s){nr.X(r,s);var c=jo;if(c&&r){var h=ue(c).hoistableScripts,g=No(r),b=h.get(g);b||(b=c.querySelector($l(g)),b||(r=p({src:r,async:!0},s),(s=Zi.get(g))&&rm(r,s),b=c.createElement("script"),ee(b),Pn(b,"link",r),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function pT(r,s){nr.M(r,s);var c=jo;if(c&&r){var h=ue(c).hoistableScripts,g=No(r),b=h.get(g);b||(b=c.querySelector($l(g)),b||(r=p({src:r,async:!0,type:"module"},s),(s=Zi.get(g))&&rm(r,s),b=c.createElement("script"),ee(b),Pn(b,"link",r),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function av(r,s,c,h){var g=(g=re.current)?$u(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Do(c.href),c=ue(g).hoistableStyles,h=c.get(s),h||(h={type:"style",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=Do(c.href);var b=ue(g).hoistableStyles,k=b.get(r);if(k||(g=g.ownerDocument||g,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(r,k),(b=g.querySelector(Xl(r)))&&!b._p&&(k.instance=b,k.state.loading=5),Zi.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Zi.set(r,c),b||gT(g,r,c,k.state))),s&&h===null)throw Error(i(528,""));return k}if(s&&h!==null)throw Error(i(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=No(c),c=ue(g).hoistableScripts,h=c.get(s),h||(h={type:"script",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Do(r){return'href="'+Mn(r)+'"'}function Xl(r){return'link[rel="stylesheet"]['+r+"]"}function rv(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function gT(r,s,c,h){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=r.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Pn(s,"link",c),ee(s),r.head.appendChild(s))}function No(r){return'[src="'+Mn(r)+'"]'}function $l(r){return"script[async]"+r}function sv(r,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var h=r.querySelector('style[data-href~="'+Mn(c.href)+'"]');if(h)return s.instance=h,ee(h),h;var g=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(r.ownerDocument||r).createElement("style"),ee(h),Pn(h,"style",g),qu(h,c.precedence,r),s.instance=h;case"stylesheet":g=Do(c.href);var b=r.querySelector(Xl(g));if(b)return s.state.loading|=4,s.instance=b,ee(b),b;h=rv(c),(g=Zi.get(g))&&am(h,g),b=(r.ownerDocument||r).createElement("link"),ee(b);var k=b;return k._p=new Promise(function(O,G){k.onload=O,k.onerror=G}),Pn(b,"link",h),s.state.loading|=4,qu(b,c.precedence,r),s.instance=b;case"script":return b=No(c.src),(g=r.querySelector($l(b)))?(s.instance=g,ee(g),g):(h=c,(g=Zi.get(b))&&(h=p({},c),rm(h,g)),r=r.ownerDocument||r,g=r.createElement("script"),ee(g),Pn(g,"link",h),r.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,qu(h,c.precedence,r));return s.instance}function qu(r,s,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,b=g,k=0;k<h.length;k++){var O=h[k];if(O.dataset.precedence===s)b=O;else if(b!==g)break}b?b.parentNode.insertBefore(r,b.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(r,s.firstChild))}function am(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function rm(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Ku=null;function ov(r,s,c){if(Ku===null){var h=new Map,g=Ku=new Map;g.set(c,h)}else g=Ku,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(r))return h;for(h.set(r,null),c=c.getElementsByTagName(r),g=0;g<c.length;g++){var b=c[g];if(!(b[R]||b[Jt]||r==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var k=b.getAttribute(s)||"";k=r+k;var O=h.get(k);O?O.push(b):h.set(k,[b])}}return h}function lv(r,s,c){r=r.ownerDocument||r,r.head.insertBefore(c,s==="title"?r.querySelector("head > title"):null)}function vT(r,s,c){if(c===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return r=s.disabled,typeof s.precedence=="string"&&r==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function cv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var ql=null;function yT(){}function xT(r,s,c){if(ql===null)throw Error(i(475));var h=ql;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var g=Do(c.href),b=r.querySelector(Xl(g));if(b){r=b._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(h.count++,h=Zu.bind(h),r.then(h,h)),s.state.loading|=4,s.instance=b,ee(b);return}b=r.ownerDocument||r,c=rv(c),(g=Zi.get(g))&&am(c,g),b=b.createElement("link"),ee(b);var k=b;k._p=new Promise(function(O,G){k.onload=O,k.onerror=G}),Pn(b,"link",c),s.instance=b}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(s,r),(r=s.state.preload)&&(s.state.loading&3)===0&&(h.count++,s=Zu.bind(h),r.addEventListener("load",s),r.addEventListener("error",s))}}function bT(){if(ql===null)throw Error(i(475));var r=ql;return r.stylesheets&&r.count===0&&sm(r,r.stylesheets),0<r.count?function(s){var c=setTimeout(function(){if(r.stylesheets&&sm(r,r.stylesheets),r.unsuspend){var h=r.unsuspend;r.unsuspend=null,h()}},6e4);return r.unsuspend=s,function(){r.unsuspend=null,clearTimeout(c)}}:null}function Zu(){if(this.count--,this.count===0){if(this.stylesheets)sm(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Qu=null;function sm(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Qu=new Map,s.forEach(ST,r),Qu=null,Zu.call(r))}function ST(r,s){if(!(s.state.loading&4)){var c=Qu.get(r);if(c)var h=c.get(null);else{c=new Map,Qu.set(r,c);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var k=g[b];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),h=k)}h&&c.set(null,h)}g=s.instance,k=g.getAttribute("data-precedence"),b=c.get(k)||h,b===h&&c.set(null,g),c.set(k,g),this.count++,h=Zu.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),b?b.parentNode.insertBefore(g,b.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),s.state.loading|=4}}var Kl={$$typeof:C,Provider:null,Consumer:null,_currentValue:Ne,_currentValue2:Ne,_threadCount:0};function _T(r,s,c,h,g,b,k,O){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xa(0),this.hiddenUpdates=xa(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function uv(r,s,c,h,g,b,k,O,G,oe,ge,ye){return r=new _T(r,s,c,k,O,G,oe,ye),s=1,b===!0&&(s|=24),b=ji(3,null,null,s),r.current=b,b.stateNode=r,s=zf(),s.refCount++,r.pooledCache=s,s.refCount++,b.memoizedState={element:h,isDehydrated:c,cache:s},Gf(b),r}function dv(r){return r?(r=oo,r):oo}function fv(r,s,c,h,g,b){g=dv(g),h.context===null?h.context=g:h.pendingContext=g,h=Er(s),h.payload={element:c},b=b===void 0?null:b,b!==null&&(h.callback=b),c=Ar(r,h,s),c!==null&&(Mi(c,r,s),Al(c,r,s))}function hv(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<s?c:s}}function om(r,s){hv(r,s),(r=r.alternate)&&hv(r,s)}function mv(r){if(r.tag===13){var s=so(r,67108864);s!==null&&Mi(s,r,67108864),om(r,67108864)}}var Ju=!0;function TT(r,s,c,h){var g=ie.T;ie.T=null;var b=he.p;try{he.p=2,lm(r,s,c,h)}finally{he.p=b,ie.T=g}}function wT(r,s,c,h){var g=ie.T;ie.T=null;var b=he.p;try{he.p=8,lm(r,s,c,h)}finally{he.p=b,ie.T=g}}function lm(r,s,c,h){if(Ju){var g=cm(h);if(g===null)qh(r,s,h,ed,c),gv(r,h);else if(AT(g,r,s,c,h))h.stopPropagation();else if(gv(r,h),s&4&&-1<ET.indexOf(r)){for(;g!==null;){var b=B(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var k=$t(b.pendingLanes);if(k!==0){var O=b;for(O.pendingLanes|=2,O.entangledLanes|=2;k;){var G=1<<31-J(k);O.entanglements[1]|=G,k&=~G}Ca(b),(Et&6)===0&&(Pu=Re()+500,Wl(0))}}break;case 13:O=so(b,2),O!==null&&Mi(O,b,2),Fu(),om(b,2)}if(b=cm(h),b===null&&qh(r,s,h,ed,c),b===g)break;g=b}g!==null&&h.stopPropagation()}else qh(r,s,h,null,c)}}function cm(r){return r=Js(r),um(r)}var ed=null;function um(r){if(ed=null,r=F(r),r!==null){var s=o(r);if(s===null)r=null;else{var c=s.tag;if(c===13){if(r=l(s),r!==null)return r;r=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return ed=r,null}function pv(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wn()){case Rn:return 2;case ei:return 8;case ti:case Qe:return 32;case Fe:return 268435456;default:return 32}default:return 32}}var dm=!1,Fr=null,Ur=null,zr=null,Zl=new Map,Ql=new Map,Hr=[],ET="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function gv(r,s){switch(r){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Ur=null;break;case"mouseover":case"mouseout":zr=null;break;case"pointerover":case"pointerout":Zl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ql.delete(s.pointerId)}}function Jl(r,s,c,h,g,b){return r===null||r.nativeEvent!==b?(r={blockedOn:s,domEventName:c,eventSystemFlags:h,nativeEvent:b,targetContainers:[g]},s!==null&&(s=B(s),s!==null&&mv(s)),r):(r.eventSystemFlags|=h,s=r.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),r)}function AT(r,s,c,h,g){switch(s){case"focusin":return Fr=Jl(Fr,r,s,c,h,g),!0;case"dragenter":return Ur=Jl(Ur,r,s,c,h,g),!0;case"mouseover":return zr=Jl(zr,r,s,c,h,g),!0;case"pointerover":var b=g.pointerId;return Zl.set(b,Jl(Zl.get(b)||null,r,s,c,h,g)),!0;case"gotpointercapture":return b=g.pointerId,Ql.set(b,Jl(Ql.get(b)||null,r,s,c,h,g)),!0}return!1}function vv(r){var s=F(r.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){r.blockedOn=s,yn(r.priority,function(){if(c.tag===13){var h=Ri();h=rs(h);var g=so(c,h);g!==null&&Mi(g,c,h),om(c,h)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function td(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var c=cm(r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);ll=h,c.target.dispatchEvent(h),ll=null}else return s=B(c),s!==null&&mv(s),r.blockedOn=c,!1;s.shift()}return!0}function yv(r,s,c){td(r)&&c.delete(s)}function kT(){dm=!1,Fr!==null&&td(Fr)&&(Fr=null),Ur!==null&&td(Ur)&&(Ur=null),zr!==null&&td(zr)&&(zr=null),Zl.forEach(yv),Ql.forEach(yv)}function nd(r,s){r.blockedOn===s&&(r.blockedOn=null,dm||(dm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,kT)))}var id=null;function xv(r){id!==r&&(id=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){id===r&&(id=null);for(var s=0;s<r.length;s+=3){var c=r[s],h=r[s+1],g=r[s+2];if(typeof h!="function"){if(um(h||c)===null)continue;break}var b=B(c);b!==null&&(r.splice(s,3),s-=3,uh(b,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function ec(r){function s(G){return nd(G,r)}Fr!==null&&nd(Fr,r),Ur!==null&&nd(Ur,r),zr!==null&&nd(zr,r),Zl.forEach(s),Ql.forEach(s);for(var c=0;c<Hr.length;c++){var h=Hr[c];h.blockedOn===r&&(h.blockedOn=null)}for(;0<Hr.length&&(c=Hr[0],c.blockedOn===null);)vv(c),c.blockedOn===null&&Hr.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],b=c[h+1],k=g[en]||null;if(typeof b=="function")k||xv(c);else if(k){var O=null;if(b&&b.hasAttribute("formAction")){if(g=b,k=b[en]||null)O=k.formAction;else if(um(g)!==null)continue}else O=k.action;typeof O=="function"?c[h+1]=O:(c.splice(h,3),h-=3),xv(c)}}}function fm(r){this._internalRoot=r}ad.prototype.render=fm.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var c=s.current,h=Ri();fv(c,h,r,s,null,null)},ad.prototype.unmount=fm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;fv(r.current,2,null,r,null,null),Fu(),s[ba]=null}};function ad(r){this._internalRoot=r}ad.prototype.unstable_scheduleHydration=function(r){if(r){var s=Ks();r={blockedOn:null,target:r,priority:s};for(var c=0;c<Hr.length&&s!==0&&s<Hr[c].priority;c++);Hr.splice(c,0,r),c===0&&vv(r)}};var bv=e.version;if(bv!=="19.1.0")throw Error(i(527,bv,"19.1.0"));he.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=f(s),r=r!==null?m(r):null,r=r===null?null:r.stateNode,r};var CT={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{Ot=rd.inject(CT),wt=rd}catch{}}return nc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var c=!1,h="",g=I0,b=P0,k=B0,O=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(k=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(O=s.unstable_transitionCallbacks)),s=uv(r,1,!1,null,null,c,h,g,b,k,O,null),r[ba]=s.current,$h(r),new fm(s)},nc.hydrateRoot=function(r,s,c){if(!a(r))throw Error(i(299));var h=!1,g="",b=I0,k=P0,O=B0,G=null,oe=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(O=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(G=c.unstable_transitionCallbacks),c.formState!==void 0&&(oe=c.formState)),s=uv(r,1,!0,s,c??null,h,g,b,k,O,G,oe),s.context=dv(null),c=s.current,h=Ri(),h=rs(h),g=Er(h),g.callback=null,Ar(c,g,h),c=h,s.current.lanes=c,qt(s,c),Ca(s),r[ba]=s.current,$h(r),new ad(s)},nc.version="19.1.0",nc}var Dv;function BT(){if(Dv)return pm.exports;Dv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),pm.exports=PT(),pm.exports}var FT=BT();const UT=op(FT);/**
 * react-router v7.7.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Nv="popstate";function zT(n={}){function e(i,a){let{pathname:o,search:l,hash:u}=i.location;return Gm("",{pathname:o,search:l,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){return typeof a=="string"?a:Cc(a)}return WT(e,t,null,n)}function Xt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ia(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function HT(){return Math.random().toString(36).substring(2,10)}function Ov(n,e){return{usr:n.state,key:n.key,idx:e}}function Gm(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Ko(e):e,state:t,key:e&&e.key||i||HT()}}function Cc({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Ko(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function WT(n,e,t,i={}){let{window:a=document.defaultView,v5Compat:o=!1}=i,l=a.history,u="POP",f=null,m=p();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function p(){return(l.state||{idx:null}).idx}function v(){u="POP";let T=p(),w=T==null?null:T-m;m=T,f&&f({action:u,location:x.location,delta:w})}function y(T,w){u="PUSH";let E=Gm(x.location,T,w);m=p()+1;let C=Ov(E,m),N=x.createHref(E);try{l.pushState(C,"",N)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(N)}o&&f&&f({action:u,location:x.location,delta:1})}function S(T,w){u="REPLACE";let E=Gm(x.location,T,w);m=p();let C=Ov(E,m),N=x.createHref(E);l.replaceState(C,"",N),o&&f&&f({action:u,location:x.location,delta:0})}function _(T){return VT(T)}let x={get action(){return u},get location(){return n(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Nv,v),f=T,()=>{a.removeEventListener(Nv,v),f=null}},createHref(T){return e(a,T)},createURL:_,encodeLocation(T){let w=_(T);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:y,replace:S,go(T){return l.go(T)}};return x}function VT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Xt(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:Cc(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function Gx(n,e,t="/"){return GT(n,e,t,!1)}function GT(n,e,t,i){let a=typeof e=="string"?Ko(e):e,o=fr(a.pathname||"/",t);if(o==null)return null;let l=Yx(n);YT(l);let u=null;for(let f=0;u==null&&f<l.length;++f){let m=iw(o);u=tw(l[f],m,i)}return u}function Yx(n,e=[],t=[],i=""){let a=(o,l,u)=>{let f={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(Xt(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length));let m=lr([i,f.relativePath]),p=t.concat(f);o.children&&o.children.length>0&&(Xt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Yx(o.children,e,p,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:JT(m,o.index),routesMeta:p})};return n.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))a(o,l);else for(let u of Xx(o.path))a(o,l,u)}),e}function Xx(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return a?[o,""]:[o];let l=Xx(i.join("/")),u=[];return u.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&u.push(...l),u.map(f=>n.startsWith("/")&&f===""?"/":f)}function YT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:ew(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var XT=/^:[\w-]+$/,$T=3,qT=2,KT=1,ZT=10,QT=-2,Rv=n=>n==="*";function JT(n,e){let t=n.split("/"),i=t.length;return t.some(Rv)&&(i+=QT),e&&(i+=qT),t.filter(a=>!Rv(a)).reduce((a,o)=>a+(XT.test(o)?$T:o===""?KT:ZT),i)}function ew(n,e){return n.length===e.length&&n.slice(0,-1).every((i,a)=>i===e[a])?n[n.length-1]-e[e.length-1]:0}function tw(n,e,t=!1){let{routesMeta:i}=n,a={},o="/",l=[];for(let u=0;u<i.length;++u){let f=i[u],m=u===i.length-1,p=o==="/"?e:e.slice(o.length)||"/",v=Ld({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},p),y=f.route;if(!v&&m&&t&&!i[i.length-1].route.index&&(v=Ld({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!v)return null;Object.assign(a,v.params),l.push({params:a,pathname:lr([o,v.pathname]),pathnameBase:ow(lr([o,v.pathnameBase])),route:y}),v.pathnameBase!=="/"&&(o=lr([o,v.pathnameBase]))}return l}function Ld(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=nw(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:i.reduce((m,{paramName:p,isOptional:v},y)=>{if(p==="*"){let _=u[y]||"";l=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const S=u[y];return v&&!S?m[p]=void 0:m[p]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:n}}function nw(n,e=!1,t=!0){ia(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,f)=>(i.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function iw(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ia(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function fr(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function aw(n,e="/"){let{pathname:t,search:i="",hash:a=""}=typeof n=="string"?Ko(n):n;return{pathname:t?t.startsWith("/")?t:rw(t,e):e,search:lw(i),hash:cw(a)}}function rw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function xm(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sw(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function cp(n){let e=sw(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function up(n,e,t,i=!1){let a;typeof n=="string"?a=Ko(n):(a={...n},Xt(!a.pathname||!a.pathname.includes("?"),xm("?","pathname","search",a)),Xt(!a.pathname||!a.pathname.includes("#"),xm("#","pathname","hash",a)),Xt(!a.search||!a.search.includes("#"),xm("#","search","hash",a)));let o=n===""||a.pathname==="",l=o?"/":a.pathname,u;if(l==null)u=t;else{let v=e.length-1;if(!i&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),v-=1;a.pathname=y.join("/")}u=v>=0?e[v]:"/"}let f=aw(a,u),m=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(m||p)&&(f.pathname+="/"),f}var lr=n=>n.join("/").replace(/\/\/+/g,"/"),ow=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),lw=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,cw=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function uw(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var $x=["POST","PUT","PATCH","DELETE"];new Set($x);var dw=["GET",...$x];new Set(dw);var Zo=W.createContext(null);Zo.displayName="DataRouter";var rf=W.createContext(null);rf.displayName="DataRouterState";W.createContext(!1);var qx=W.createContext({isTransitioning:!1});qx.displayName="ViewTransition";var fw=W.createContext(new Map);fw.displayName="Fetchers";var hw=W.createContext(null);hw.displayName="Await";var ya=W.createContext(null);ya.displayName="Navigation";var Wc=W.createContext(null);Wc.displayName="Location";var Ba=W.createContext({outlet:null,matches:[],isDataRoute:!1});Ba.displayName="Route";var dp=W.createContext(null);dp.displayName="RouteError";function mw(n,{relative:e}={}){Xt(Qo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=W.useContext(ya),{hash:a,pathname:o,search:l}=Vc(n,{relative:e}),u=o;return t!=="/"&&(u=o==="/"?t:lr([t,o])),i.createHref({pathname:u,search:l,hash:a})}function Qo(){return W.useContext(Wc)!=null}function Fa(){return Xt(Qo(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(Wc).location}var Kx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Zx(n){W.useContext(ya).static||W.useLayoutEffect(n)}function Jo(){let{isDataRoute:n}=W.useContext(Ba);return n?kw():pw()}function pw(){Xt(Qo(),"useNavigate() may be used only in the context of a <Router> component.");let n=W.useContext(Zo),{basename:e,navigator:t}=W.useContext(ya),{matches:i}=W.useContext(Ba),{pathname:a}=Fa(),o=JSON.stringify(cp(i)),l=W.useRef(!1);return Zx(()=>{l.current=!0}),W.useCallback((f,m={})=>{if(ia(l.current,Kx),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=up(f,JSON.parse(o),a,m.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:lr([e,p.pathname])),(m.replace?t.replace:t.push)(p,m.state,m)},[e,t,o,a,n])}W.createContext(null);function Vc(n,{relative:e}={}){let{matches:t}=W.useContext(Ba),{pathname:i}=Fa(),a=JSON.stringify(cp(t));return W.useMemo(()=>up(n,JSON.parse(a),i,e==="path"),[n,a,i,e])}function gw(n,e){return Qx(n,e)}function Qx(n,e,t,i){Xt(Qo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=W.useContext(ya),{matches:o}=W.useContext(Ba),l=o[o.length-1],u=l?l.params:{},f=l?l.pathname:"/",m=l?l.pathnameBase:"/",p=l&&l.route;{let w=p&&p.path||"";Jx(f,!p||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let v=Fa(),y;if(e){let w=typeof e=="string"?Ko(e):e;Xt(m==="/"||w.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${w.pathname}" was given in the \`location\` prop.`),y=w}else y=v;let S=y.pathname||"/",_=S;if(m!=="/"){let w=m.replace(/^\//,"").split("/");_="/"+S.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=Gx(n,{pathname:_});ia(p||x!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),ia(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=Sw(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:lr([m,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?m:lr([m,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,t,i);return e&&T?W.createElement(Wc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function vw(){let n=Aw(),e=uw(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=W.createElement(W.Fragment,null,W.createElement("p",null," Hey developer "),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:o},"ErrorBoundary")," or"," ",W.createElement("code",{style:o},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},e),t?W.createElement("pre",{style:a},t):null,l)}var yw=W.createElement(vw,null),xw=class extends W.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?W.createElement(Ba.Provider,{value:this.props.routeContext},W.createElement(dp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function bw({routeContext:n,match:e,children:t}){let i=W.useContext(Zo);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),W.createElement(Ba.Provider,{value:n},t)}function Sw(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let f=a.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);Xt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,u=-1;if(t)for(let f=0;f<a.length;f++){let m=a[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:p,errors:v}=t,y=m.route.loader&&!p.hasOwnProperty(m.route.id)&&(!v||v[m.route.id]===void 0);if(m.route.lazy||y){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((f,m,p)=>{let v,y=!1,S=null,_=null;t&&(v=o&&m.route.id?o[m.route.id]:void 0,S=m.route.errorElement||yw,l&&(u<0&&p===0?(Jx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,_=null):u===p&&(y=!0,_=m.route.hydrateFallbackElement||null)));let x=e.concat(a.slice(0,p+1)),T=()=>{let w;return v?w=S:y?w=_:m.route.Component?w=W.createElement(m.route.Component,null):m.route.element?w=m.route.element:w=f,W.createElement(bw,{match:m,routeContext:{outlet:f,matches:x,isDataRoute:t!=null},children:w})};return t&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?W.createElement(xw,{location:t.location,revalidation:t.revalidation,component:S,error:v,children:T(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):T()},null)}function fp(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _w(n){let e=W.useContext(Zo);return Xt(e,fp(n)),e}function Tw(n){let e=W.useContext(rf);return Xt(e,fp(n)),e}function ww(n){let e=W.useContext(Ba);return Xt(e,fp(n)),e}function hp(n){let e=ww(n),t=e.matches[e.matches.length-1];return Xt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Ew(){return hp("useRouteId")}function Aw(){let n=W.useContext(dp),e=Tw("useRouteError"),t=hp("useRouteError");return n!==void 0?n:e.errors?.[t]}function kw(){let{router:n}=_w("useNavigate"),e=hp("useNavigate"),t=W.useRef(!1);return Zx(()=>{t.current=!0}),W.useCallback(async(a,o={})=>{ia(t.current,Kx),t.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:e,...o}))},[n,e])}var Mv={};function Jx(n,e,t){!e&&!Mv[n]&&(Mv[n]=!0,ia(!1,t))}W.memo(Cw);function Cw({routes:n,future:e,state:t}){return Qx(n,void 0,t,e)}function eb({to:n,replace:e,state:t,relative:i}){Xt(Qo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=W.useContext(ya);ia(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=W.useContext(Ba),{pathname:l}=Fa(),u=Jo(),f=up(n,cp(o),l,i==="path"),m=JSON.stringify(f);return W.useEffect(()=>{u(JSON.parse(m),{replace:e,state:t,relative:i})},[u,m,i,e,t]),null}function jn(n){Xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function jw({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:a,static:o=!1}){Xt(!Qo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=W.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Ko(t));let{pathname:f="/",search:m="",hash:p="",state:v=null,key:y="default"}=t,S=W.useMemo(()=>{let _=fr(f,l);return _==null?null:{location:{pathname:_,search:m,hash:p,state:v,key:y},navigationType:i}},[l,f,m,p,v,y,i]);return ia(S!=null,`<Router basename="${l}"> is not able to match the URL "${f}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:W.createElement(ya.Provider,{value:u},W.createElement(Wc.Provider,{children:e,value:S}))}function Dw({children:n,location:e}){return gw(Ym(n),e)}function Ym(n,e=[]){let t=[];return W.Children.forEach(n,(i,a)=>{if(!W.isValidElement(i))return;let o=[...e,a];if(i.type===W.Fragment){t.push.apply(t,Ym(i.props.children,o));return}Xt(i.type===jn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=Ym(i.props.children,o)),t.push(l)}),t}var Nd="get",Od="application/x-www-form-urlencoded";function sf(n){return n!=null&&typeof n.tagName=="string"}function Nw(n){return sf(n)&&n.tagName.toLowerCase()==="button"}function Ow(n){return sf(n)&&n.tagName.toLowerCase()==="form"}function Rw(n){return sf(n)&&n.tagName.toLowerCase()==="input"}function Mw(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Lw(n,e){return n.button===0&&(!e||e==="_self")&&!Mw(n)}function Xm(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(a=>[t,a]):[[t,i]])},[]))}function Iw(n,e){let t=Xm(n);return e&&e.forEach((i,a)=>{t.has(a)||e.getAll(a).forEach(o=>{t.append(a,o)})}),t}var sd=null;function Pw(){if(sd===null)try{new FormData(document.createElement("form"),0),sd=!1}catch{sd=!0}return sd}var Bw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bm(n){return n!=null&&!Bw.has(n)?(ia(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Od}"`),null):n}function Fw(n,e){let t,i,a,o,l;if(Ow(n)){let u=n.getAttribute("action");i=u?fr(u,e):null,t=n.getAttribute("method")||Nd,a=bm(n.getAttribute("enctype"))||Od,o=new FormData(n)}else if(Nw(n)||Rw(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||u.getAttribute("action");if(i=f?fr(f,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||Nd,a=bm(n.getAttribute("formenctype"))||bm(u.getAttribute("enctype"))||Od,o=new FormData(u,n),!Pw()){let{name:m,type:p,value:v}=n;if(p==="image"){let y=m?`${m}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else m&&o.append(m,v)}}else{if(sf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Nd,i=null,a=Od,l=n}return o&&a==="text/plain"&&(l=o,o=void 0),{action:i,method:t.toLowerCase(),encType:a,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function mp(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Uw(n,e,t){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return i.pathname==="/"?i.pathname=`_root.${t}`:e&&fr(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${t}`,i}async function zw(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Hw(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Ww(n,e,t){let i=await Promise.all(n.map(async a=>{let o=e.routes[a.route.id];if(o){let l=await zw(o,t);return l.links?l.links():[]}return[]}));return Xw(i.flat(1).filter(Hw).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Lv(n,e,t,i,a,o){let l=(f,m)=>t[m]?f.route.id!==t[m].route.id:!0,u=(f,m)=>t[m].pathname!==f.pathname||t[m].route.path?.endsWith("*")&&t[m].params["*"]!==f.params["*"];return o==="assets"?e.filter((f,m)=>l(f,m)||u(f,m)):o==="data"?e.filter((f,m)=>{let p=i.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,m)||u(f,m))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Vw(n,e,{includeHydrateFallback:t}={}){return Gw(n.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function Gw(n){return[...new Set(n)]}function Yw(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function Xw(n,e){let t=new Set;return new Set(e),n.reduce((i,a)=>{let o=JSON.stringify(Yw(a));return t.has(o)||(t.add(o),i.push({key:o,link:a})),i},[])}function tb(){let n=W.useContext(Zo);return mp(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function $w(){let n=W.useContext(rf);return mp(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var pp=W.createContext(void 0);pp.displayName="FrameworkContext";function nb(){let n=W.useContext(pp);return mp(n,"You must render this element inside a <HydratedRouter> element"),n}function qw(n,e){let t=W.useContext(pp),[i,a]=W.useState(!1),[o,l]=W.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:m,onMouseLeave:p,onTouchStart:v}=e,y=W.useRef(null);W.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let x=w=>{w.forEach(E=>{l(E.isIntersecting)})},T=new IntersectionObserver(x,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[n]),W.useEffect(()=>{if(i){let x=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(x)}}},[i]);let S=()=>{a(!0)},_=()=>{a(!1),l(!1)};return t?n!=="intent"?[o,y,{}]:[o,y,{onFocus:ic(u,S),onBlur:ic(f,_),onMouseEnter:ic(m,S),onMouseLeave:ic(p,_),onTouchStart:ic(v,S)}]:[!1,y,{}]}function ic(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Kw({page:n,...e}){let{router:t}=tb(),i=W.useMemo(()=>Gx(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?W.createElement(Qw,{page:n,matches:i,...e}):null}function Zw(n){let{manifest:e,routeModules:t}=nb(),[i,a]=W.useState([]);return W.useEffect(()=>{let o=!1;return Ww(n,e,t).then(l=>{o||a(l)}),()=>{o=!0}},[n,e,t]),i}function Qw({page:n,matches:e,...t}){let i=Fa(),{manifest:a,routeModules:o}=nb(),{basename:l}=tb(),{loaderData:u,matches:f}=$w(),m=W.useMemo(()=>Lv(n,e,f,a,i,"data"),[n,e,f,a,i]),p=W.useMemo(()=>Lv(n,e,f,a,i,"assets"),[n,e,f,a,i]),v=W.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let _=new Set,x=!1;if(e.forEach(w=>{let E=a.routes[w.route.id];!E||!E.hasLoader||(!m.some(C=>C.route.id===w.route.id)&&w.route.id in u&&o[w.route.id]?.shouldRevalidate||E.hasClientLoader?x=!0:_.add(w.route.id))}),_.size===0)return[];let T=Uw(n,l,"data");return x&&_.size>0&&T.searchParams.set("_routes",e.filter(w=>_.has(w.route.id)).map(w=>w.route.id).join(",")),[T.pathname+T.search]},[l,u,i,a,m,e,n,o]),y=W.useMemo(()=>Vw(p,a),[p,a]),S=Zw(p);return W.createElement(W.Fragment,null,v.map(_=>W.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...t})),y.map(_=>W.createElement("link",{key:_,rel:"modulepreload",href:_,...t})),S.map(({key:_,link:x})=>W.createElement("link",{key:_,...x})))}function Jw(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var ib=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ib&&(window.__reactRouterVersion="7.7.0")}catch{}function eE({basename:n,children:e,window:t}){let i=W.useRef();i.current==null&&(i.current=zT({window:t,v5Compat:!0}));let a=i.current,[o,l]=W.useState({action:a.action,location:a.location}),u=W.useCallback(f=>{W.startTransition(()=>l(f))},[l]);return W.useLayoutEffect(()=>a.listen(u),[a,u]),W.createElement(jw,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a})}var ab=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rb=W.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:a,reloadDocument:o,replace:l,state:u,target:f,to:m,preventScrollReset:p,viewTransition:v,...y},S){let{basename:_}=W.useContext(ya),x=typeof m=="string"&&ab.test(m),T,w=!1;if(typeof m=="string"&&x&&(T=m,ib))try{let L=new URL(window.location.href),H=m.startsWith("//")?new URL(L.protocol+m):new URL(m),K=fr(H.pathname,_);H.origin===L.origin&&K!=null?m=K+H.search+H.hash:w=!0}catch{ia(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=mw(m,{relative:a}),[C,N,A]=qw(i,y),I=aE(m,{replace:l,state:u,target:f,preventScrollReset:p,relative:a,viewTransition:v});function D(L){e&&e(L),L.defaultPrevented||I(L)}let z=W.createElement("a",{...y,...A,href:T||E,onClick:w||o?e:D,ref:Jw(S,N),target:f,"data-discover":!x&&t==="render"?"true":void 0});return C&&!x?W.createElement(W.Fragment,null,z,W.createElement(Kw,{page:E})):z});rb.displayName="Link";var tE=W.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:a=!1,style:o,to:l,viewTransition:u,children:f,...m},p){let v=Vc(l,{relative:m.relative}),y=Fa(),S=W.useContext(rf),{navigator:_,basename:x}=W.useContext(ya),T=S!=null&&uE(v)&&u===!0,w=_.encodeLocation?_.encodeLocation(v).pathname:v.pathname,E=y.pathname,C=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(E=E.toLowerCase(),C=C?C.toLowerCase():null,w=w.toLowerCase()),C&&x&&(C=fr(C,x)||C);const N=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let A=E===w||!a&&E.startsWith(w)&&E.charAt(N)==="/",I=C!=null&&(C===w||!a&&C.startsWith(w)&&C.charAt(w.length)==="/"),D={isActive:A,isPending:I,isTransitioning:T},z=A?e:void 0,L;typeof i=="function"?L=i(D):L=[i,A?"active":null,I?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let H=typeof o=="function"?o(D):o;return W.createElement(rb,{...m,"aria-current":z,className:L,ref:p,style:H,to:l,viewTransition:u},typeof f=="function"?f(D):f)});tE.displayName="NavLink";var nE=W.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:a,state:o,method:l=Nd,action:u,onSubmit:f,relative:m,preventScrollReset:p,viewTransition:v,...y},S)=>{let _=lE(),x=cE(u,{relative:m}),T=l.toLowerCase()==="get"?"get":"post",w=typeof u=="string"&&ab.test(u),E=C=>{if(f&&f(C),C.defaultPrevented)return;C.preventDefault();let N=C.nativeEvent.submitter,A=N?.getAttribute("formmethod")||l;_(N||C.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:a,state:o,relative:m,preventScrollReset:p,viewTransition:v})};return W.createElement("form",{ref:S,method:T,action:x,onSubmit:i?f:E,...y,"data-discover":!w&&n==="render"?"true":void 0})});nE.displayName="Form";function iE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sb(n){let e=W.useContext(Zo);return Xt(e,iE(n)),e}function aE(n,{target:e,replace:t,state:i,preventScrollReset:a,relative:o,viewTransition:l}={}){let u=Jo(),f=Fa(),m=Vc(n,{relative:o});return W.useCallback(p=>{if(Lw(p,e)){p.preventDefault();let v=t!==void 0?t:Cc(f)===Cc(m);u(n,{replace:v,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[f,u,m,t,i,e,n,a,o,l])}function rE(n){ia(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=W.useRef(Xm(n)),t=W.useRef(!1),i=Fa(),a=W.useMemo(()=>Iw(i.search,t.current?null:e.current),[i.search]),o=Jo(),l=W.useCallback((u,f)=>{const m=Xm(typeof u=="function"?u(new URLSearchParams(a)):u);t.current=!0,o("?"+m,f)},[o,a]);return[a,l]}var sE=0,oE=()=>`__${String(++sE)}__`;function lE(){let{router:n}=sb("useSubmit"),{basename:e}=W.useContext(ya),t=Ew();return W.useCallback(async(i,a={})=>{let{action:o,method:l,encType:u,formData:f,body:m}=Fw(i,e);if(a.navigate===!1){let p=a.fetcherKey||oE();await n.fetch(p,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:m,formMethod:a.method||l,formEncType:a.encType||u,flushSync:a.flushSync})}else await n.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:m,formMethod:a.method||l,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,e,t])}function cE(n,{relative:e}={}){let{basename:t}=W.useContext(ya),i=W.useContext(Ba);Xt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),o={...Vc(n||".",{relative:e})},l=Fa();if(n==null){o.search=l.search;let u=new URLSearchParams(o.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(v=>v).forEach(v=>u.append("index",v));let p=u.toString();o.search=p?`?${p}`:""}}return(!n||n===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:lr([t,o.pathname])),Cc(o)}function uE(n,e={}){let t=W.useContext(qx);Xt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=sb("useViewTransitionState"),a=Vc(n,{relative:e.relative});if(!t.isTransitioning)return!1;let o=fr(t.currentLocation.pathname,i)||t.currentLocation.pathname,l=fr(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ld(a.pathname,l)!=null||Ld(a.pathname,o)!=null}const ob=W.createContext(void 0),dE=()=>{const n=W.useContext(ob);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},fE=({children:n})=>{const[e,t]=W.useState(()=>localStorage.getItem("timebeacon-theme")||"light"),[i,a]=W.useState("light");W.useEffect(()=>{const l=()=>{if(e==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";a(u)}else a(e)};if(l(),e==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)");return u.addEventListener("change",l),()=>u.removeEventListener("change",l)}},[e]),W.useEffect(()=>{localStorage.setItem("timebeacon-theme",e),document.documentElement.setAttribute("data-theme",i)},[e,i]);const o={theme:e,effectiveTheme:i,setTheme:t};return d.jsx(ob.Provider,{value:o,children:n})},Oo={owner:{level:100,title:"Owner",description:"Full system access including billing and company management"},admin:{level:90,title:"Administrator",description:"User and project management, settings control"},manager:{level:70,title:"Manager",description:"Team oversight with scoped permissions for team members"},individual_contributor:{level:50,title:"Individual Contributor",description:"Senior employee with project leadership and limited team visibility"},employee:{level:30,title:"Employee",description:"Self-service time tracking and basic project access"},viewer:{level:10,title:"Viewer",description:"Read-only access to own data"}},lb={owner:[{id:"owner-company",resource:"company",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-users",resource:"users",actions:["create","read","update","delete","invite","manage"],scope:{all:!0}},{id:"owner-projects",resource:"projects",actions:["create","read","update","delete","assign","manage"],scope:{all:!0}},{id:"owner-timeEntries",resource:"timeEntries",actions:["create","read","update","delete","approve"],scope:{all:!0}},{id:"owner-reports",resource:"reports",actions:["create","read","export"],scope:{all:!0}},{id:"owner-analytics",resource:"analytics",actions:["read","export"],scope:{all:!0}},{id:"owner-billing",resource:"billing",actions:["read","update","manage"],scope:{all:!0}},{id:"owner-settings",resource:"settings",actions:["read","update","manage"],scope:{all:!0}},{id:"owner-integrations",resource:"integrations",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-teams",resource:"teams",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"owner-clients",resource:"clients",actions:["create","read","update","delete","manage"],scope:{all:!0}}],admin:[{id:"admin-company",resource:"company",actions:["read","update"],scope:{all:!0}},{id:"admin-users",resource:"users",actions:["create","read","update","invite","manage"],scope:{all:!0}},{id:"admin-projects",resource:"projects",actions:["create","read","update","delete","assign","manage"],scope:{all:!0}},{id:"admin-timeEntries",resource:"timeEntries",actions:["read","update","approve"],scope:{all:!0}},{id:"admin-reports",resource:"reports",actions:["create","read","export"],scope:{all:!0}},{id:"admin-analytics",resource:"analytics",actions:["read","export"],scope:{all:!0}},{id:"admin-settings",resource:"settings",actions:["read","update"],scope:{all:!0}},{id:"admin-integrations",resource:"integrations",actions:["create","read","update","delete"],scope:{all:!0}},{id:"admin-teams",resource:"teams",actions:["create","read","update","delete","manage"],scope:{all:!0}},{id:"admin-clients",resource:"clients",actions:["create","read","update","delete"],scope:{all:!0}}],manager:[{id:"manager-users",resource:"users",actions:["read"],scope:{team:[],department:[]}},{id:"manager-projects",resource:"projects",actions:["create","read","update","assign"],scope:{team:[],own:!0}},{id:"manager-timeEntries",resource:"timeEntries",actions:["read","approve","review"],scope:{team:[],own:!0}},{id:"manager-reports",resource:"reports",actions:["read","export"],scope:{team:[],own:!0}},{id:"manager-analytics",resource:"analytics",actions:["read"],scope:{team:[],own:!0}},{id:"manager-teams",resource:"teams",actions:["read","manage"],scope:{team:[]}},{id:"manager-clients",resource:"clients",actions:["read","update"],scope:{team:[],own:!0}},{id:"manager-own",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}}],individual_contributor:[{id:"ic-projects",resource:"projects",actions:["create","read","update"],scope:{own:!0}},{id:"ic-timeEntries",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}},{id:"ic-reports",resource:"reports",actions:["read","export"],scope:{own:!0}},{id:"ic-analytics",resource:"analytics",actions:["read"],scope:{own:!0}},{id:"ic-clients",resource:"clients",actions:["read","update"],scope:{own:!0}},{id:"ic-team-visibility",resource:"users",actions:["read"],scope:{team:[]}},{id:"ic-project-lead",resource:"projects",actions:["assign","review"],scope:{own:!0}}],employee:[{id:"employee-timeEntries",resource:"timeEntries",actions:["create","read","update"],scope:{own:!0}},{id:"employee-projects",resource:"projects",actions:["read"],scope:{own:!0}},{id:"employee-reports",resource:"reports",actions:["read"],scope:{own:!0}},{id:"employee-clients",resource:"clients",actions:["read"],scope:{own:!0}},{id:"employee-profile",resource:"users",actions:["read","update"],scope:{own:!0}}],viewer:[{id:"viewer-timeEntries",resource:"timeEntries",actions:["read"],scope:{own:!0}},{id:"viewer-projects",resource:"projects",actions:["read"],scope:{own:!0}},{id:"viewer-profile",resource:"users",actions:["read"],scope:{own:!0}}]};class hE{API_BASE="https://api.timebeacon.io";TOKEN_KEY="timebeacon_access_token";REFRESH_KEY="timebeacon_refresh_token";USER_KEY="timebeacon_user";COMPANY_KEY="timebeacon_company";async login(e){if(!e.email||!e.password)throw new Error("Email and password are required");if(!this.isValidEmail(e.email))throw new Error("Invalid email format");if(e.password.length<8)throw new Error("Password must be at least 8 characters");try{this.checkRateLimit(e.email)}catch(t){if(!e.email.includes("@demo.com"))throw t;console.warn("Rate limit reached for demo account, but allowing attempt")}try{return await this.secureLogin(e)}catch(t){return console.warn("Demo login failed, trying production:",t),this.productionLogin(e)}}async signup(e){if(!e.email||!e.password||!e.companyName)throw new Error("Email, password, and company name are required");if(!this.isValidEmail(e.email))throw new Error("Invalid email format");if(!this.isValidPassword(e.password))throw new Error("Password must be at least 8 characters with uppercase, lowercase, and numbers");return this.productionSignup(e)}async refreshToken(){const e=localStorage.getItem(this.REFRESH_KEY);if(!e)throw new Error("No refresh token available");try{const t=await fetch(`${this.API_BASE}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)throw new Error("Token refresh failed");const i=await t.json();return localStorage.setItem(this.TOKEN_KEY,i.accessToken),i.accessToken}catch(t){throw console.error("Token refresh error:",t),this.logout(),t}}async logout(){const e=localStorage.getItem(this.TOKEN_KEY);if(localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.REFRESH_KEY),localStorage.removeItem(this.USER_KEY),localStorage.removeItem(this.COMPANY_KEY),e)try{await fetch(`${this.API_BASE}/auth/logout`,{method:"POST",headers:{Authorization:`Bearer ${e}`}})}catch(t){console.warn("Failed to notify server of logout:",t)}}getAuthState(){const e=localStorage.getItem(this.TOKEN_KEY),t=localStorage.getItem(this.USER_KEY),i=localStorage.getItem(this.COMPANY_KEY);if(!e||!t||!i)return{user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]};try{const a=JSON.parse(t),o=JSON.parse(i),l=this.getUserPermissions(a.role,a.permissions);return{user:a,company:o,isAuthenticated:!0,isLoading:!1,permissions:l}}catch(a){return console.error("Error parsing auth state:",a),this.logout(),{user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]}}}hasPermission(e,t,i,a){return e.some(o=>o.resource!==t||!o.actions.includes(i)?!1:(o.scope&&(o.scope.own&&a||o.scope.all),!0))}getUserPermissions(e,t){return[...lb[e]||[],...t]}async inviteUser(e){const t=localStorage.getItem(this.TOKEN_KEY);if(!t)throw new Error("Not authenticated");try{const i=await fetch(`${this.API_BASE}/users/invite`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)});if(!i.ok){const a=await i.json();throw new Error(a.message||"Failed to invite user")}}catch(i){throw console.error("Invite user error:",i),i}}async getTeamMembers(){return this.mockTeamMembers()}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPassword(e){const i=/[A-Z]/.test(e),a=/[a-z]/.test(e),o=/\d/.test(e);return e.length>=8&&i&&a&&o}checkRateLimit(e){const t=`auth_attempts_${e}`,i=JSON.parse(localStorage.getItem(t)||"[]"),o=Date.now()-5*60*1e3,l=i.filter(m=>m>o),f=e.includes("@demo.com")?20:5;if(l.length>=f)throw new Error("Too many login attempts. Please try again in 5 minutes.")}clearRateLimit(e){const t=`auth_attempts_${e}`;localStorage.removeItem(t)}recordFailedAttempt(e){const t=`auth_attempts_${e}`,i=JSON.parse(localStorage.getItem(t)||"[]");i.push(Date.now()),localStorage.setItem(t,JSON.stringify(i))}async secureLogin(e){await new Promise(a=>setTimeout(a,300));const i=[{email:"admin@demo.com",password:"Admin123!",role:"owner"},{email:"manager@demo.com",password:"Manager123!",role:"manager"},{email:"employee@demo.com",password:"Employee123!",role:"employee"},{email:e.email,password:"Demo123!",role:"employee"}].find(a=>a.email===e.email&&a.password===e.password);if(!i)throw this.recordFailedAttempt(e.email),new Error("Invalid email or password. Try: admin@demo.com/Admin123!, manager@demo.com/Manager123!, or employee@demo.com/Employee123!");return this.clearRateLimit(e.email),this.createAuthResponse(e,i.role)}async productionLogin(e){try{const t=await fetch(`${this.API_BASE}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const a=await t.json();throw new Error(a.message||"Login failed")}const i=await t.json();return this.storeAuthData(i),i}catch(t){throw console.error("Login error:",t),t}}async secureSignup(e){return await new Promise(t=>setTimeout(t,1e3)),this.createAuthResponse({email:e.email,password:e.password},"owner")}async productionSignup(e){try{const t=await fetch(`${this.API_BASE}/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const a=await t.json();throw new Error(a.message||"Signup failed")}const i=await t.json();return this.storeAuthData(i),i}catch(t){throw console.error("Signup error:",t),t}}storeAuthData(e){localStorage.setItem(this.TOKEN_KEY,e.accessToken),localStorage.setItem(this.REFRESH_KEY,e.refreshToken),localStorage.setItem(this.USER_KEY,JSON.stringify(e.user)),localStorage.setItem(this.COMPANY_KEY,JSON.stringify(e.company))}generateSecureToken(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")}createAuthResponse(e,t){const i=crypto.randomUUID(),a=crypto.randomUUID(),o=this.generateSecureToken(),l={id:i,visitorId:this.generateVisitorId(),email:e.email,name:e.email.split("@")[0],companyId:a,role:t,permissions:[],profile:{firstName:e.email.split("@")[0],lastName:"User",jobTitle:"CEO",department:"Executive"},settings:{theme:"system",timezone:"America/New_York",workingHours:{start:"09:00",end:"17:00",workingDays:[1,2,3,4,5]},notifications:{enableDesktop:!0,reminderInterval:30,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:{}},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},u={id:a,accountId:this.generateAccountId(),name:"TimeBeacon Demo",slug:"demo",subscription:{id:crypto.randomUUID(),companyId:a,plan:"professional",status:"active",currentPeriodStart:new Date().toISOString(),currentPeriodEnd:new Date(Date.now()+30*24*60*60*1e3).toISOString(),pricePerUser:15,features:{maxUsers:50,aiInsights:!0,advancedReports:!0,integrations:["google-calendar","slack","zoom"],dataRetentionMonths:24,apiAccess:!0,ssoEnabled:!1,customBranding:!0,prioritySupport:!0}},settings:{workingHours:{start:"09:00",end:"17:00",timezone:"America/New_York",workingDays:[1,2,3,4,5]},billing:{currency:"USD",invoiceEmail:e.email},security:{requireMfa:!1,sessionTimeout:480,passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSymbols:!1}}},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),ownerId:l.id,activeUsers:1,maxUsers:50};return{user:l,company:u,accessToken:o,refreshToken:this.generateSecureToken(),expiresIn:3600}}generateAccountId(){return Math.floor(1e4+Math.random()*9e4).toString()}generateVisitorId(){return Math.floor(1e4+Math.random()*9e4).toString()}mockTeamMembers(){return[{id:"user-1",visitorId:"10002",email:"john.doe@demo.com",name:"John Doe",companyId:"mock-company-id",role:"manager",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Engineering Manager",department:"Engineering",hourlyRate:75},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10003",email:"jane.smith@demo.com",name:"Jane Smith",companyId:"mock-company-id",role:"employee",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Senior Developer",department:"Engineering",hourlyRate:65},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!0}]}}const ks=new hE;class mE{SESSION_KEY="timebeacon_session";SESSION_TIMEOUT=30*60*1e3;MAX_IDLE_TIME=15*60*1e3;activityTimer=null;setSession(e){const t={token:e.accessToken,refreshToken:e.refreshToken,user:e.user,company:e.company,expiresAt:Date.now()+e.expiresIn*1e3,lastActivity:Date.now()},i=this.encryptSession(t);localStorage.setItem(this.SESSION_KEY,i),this.startActivityMonitoring()}getSession(){try{const e=localStorage.getItem(this.SESSION_KEY);if(!e)return null;const t=this.decryptSession(e);return t?this.isSessionExpired(t)?(this.clearSession(),null):(t.lastActivity=Date.now(),this.setSession({accessToken:t.token,refreshToken:t.refreshToken,user:t.user,company:t.company,expiresIn:Math.floor((t.expiresAt-Date.now())/1e3)}),t):null}catch(e){return console.error("Error getting session:",e),this.clearSession(),null}}clearSession(){localStorage.removeItem(this.SESSION_KEY),this.activityTimer&&(clearTimeout(this.activityTimer),this.activityTimer=null)}isSessionValid(){const e=this.getSession();return e!==null&&!this.isSessionExpired(e)}refreshActivity(){const e=this.getSession();e&&(e.lastActivity=Date.now(),this.setSession({accessToken:e.token,refreshToken:e.refreshToken,user:e.user,company:e.company,expiresIn:Math.floor((e.expiresAt-Date.now())/1e3)}))}isSessionExpired(e){const t=Date.now(),i=t>e.expiresAt,a=t-e.lastActivity>this.MAX_IDLE_TIME;return i||a}encryptSession(e){const t=JSON.stringify(e),i=this.getEncryptionKey();let a="";for(let o=0;o<t.length;o++)a+=String.fromCharCode(t.charCodeAt(o)^i.charCodeAt(o%i.length));return btoa(a)}decryptSession(e){try{const t=atob(e),i=this.getEncryptionKey();let a="";for(let o=0;o<t.length;o++)a+=String.fromCharCode(t.charCodeAt(o)^i.charCodeAt(o%i.length));return JSON.parse(a)}catch(t){return console.error("Failed to decrypt session:",t),null}}getEncryptionKey(){return"timebeacon-session-key-2024"}startActivityMonitoring(){this.activityTimer&&clearTimeout(this.activityTimer);const e=["mousedown","mousemove","keypress","scroll","touchstart"],t=()=>this.refreshActivity();e.forEach(i=>{document.addEventListener(i,t,{passive:!0})}),this.activityTimer=setTimeout(()=>{this.clearSession(),window.location.href="/login?reason=idle"},this.MAX_IDLE_TIME)}}const Cs=new mE;class pE{BASE_URL="https://app.timebeacon.io";extractRouteParams(){const t=window.location.pathname.split("/").filter(Boolean);if(t.length>=2){const[i,a]=t;if(this.isNumericId(i)&&this.isNumericId(a))return{accountId:i,visitorId:a}}return null}generateUserUrl(e,t,i=""){const a=`/${e.accountId}/${t.visitorId}`,o=i?`${a}/${i.replace(/^\//,"")}`:a;return`${this.BASE_URL}${o}`}navigateToRoute(e,t,i){const a=this.generateUserUrl(e,t,i);window.history.pushState({},"",a)}validateCurrentRoute(e,t){const i=this.extractRouteParams();return i?i.accountId===e.accountId&&i.visitorId===t.visitorId:!1}redirectToUserContext(e,t){if(!this.validateCurrentRoute(e,t)){const i=this.generateUserUrl(e,t,"dashboard");window.location.href=i}}getAppRoutes(e,t){const i={accountId:e.accountId,visitorId:t.visitorId};return[{...i,path:"dashboard"},{...i,path:"reports"},{...i,path:"ai-insights"},{...i,path:"projects"},{...i,path:"team"},{...i,path:"settings"},{...i,path:"privacy"}]}generateAccountId(){return Math.floor(1e4+Math.random()*9e4).toString()}generateVisitorId(){return Math.floor(1e4+Math.random()*9e4).toString()}formatId(e,t=5){return e.toString().padStart(t,"0")}parseId(e){return parseInt(e,10)}isNumericId(e){return/^\d{4,6}$/.test(e)}generateSharingUrl(e,t,i,a,o){const l=this.generateUserUrl(e,t),u=new URLSearchParams({type:i,id:a,...o?.readonly&&{readonly:"true"},...o?.expires&&{expires:o.expires.toISOString()}});return`${l}/share?${u.toString()}`}generateCompanyUrl(e){return`${this.BASE_URL}/company/${e.slug}`}generateLoginUrl(e,t){const i=new URLSearchParams;e&&i.set("account",e),t&&i.set("visitor",t);const a=i.toString();return`${this.BASE_URL}/login${a?`?${a}`:""}`}handleDeepLink(e,t,i){return!t||!i?`/login?${new URLSearchParams({return:e}).toString()}`:e.startsWith(`/${t.accountId}/${i.visitorId}`)?e:this.generateUserUrl(t,i,e)}encodeForUrl(e){return btoa(JSON.stringify(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}decodeFromUrl(e){try{const t=e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"=");return JSON.parse(atob(t))}catch(t){return console.error("Failed to decode URL data:",t),null}}}const Iv=new pE,cb=W.createContext(void 0),Gc=()=>{const n=W.useContext(cb);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},gE=({children:n})=>{const[e,t]=W.useState({user:null,company:null,isAuthenticated:!1,isLoading:!0,permissions:[]}),[i,a]=W.useState(null);W.useEffect(()=>{o()},[]),W.useEffect(()=>{const v=Iv.extractRouteParams();a(v)},[window.location.pathname]);const o=()=>{try{const v=Cs.getSession();if(v&&Cs.isSessionValid()){const y=ks.hasPermission?ks.getUserPermissions?.(v.user.role,v.user.permissions||[])||[]:v.user.permissions||[];t({user:v.user,company:v.company,isAuthenticated:!0,isLoading:!1,permissions:y})}else Cs.clearSession(),t(y=>({...y,isLoading:!1}))}catch(v){console.error("Auth initialization failed:",v),Cs.clearSession(),t(y=>({...y,isLoading:!1}))}},p={...e,login:async(v,y)=>{t(S=>({...S,isLoading:!0}));try{const S=Iv.extractRouteParams(),_={email:v,password:y,accountId:S?.accountId,visitorId:S?.visitorId},x=await ks.login(_);Cs.setSession({accessToken:x.accessToken,refreshToken:x.refreshToken,user:x.user,company:x.company,expiresIn:x.expiresIn});const T=ks.hasPermission?ks.getUserPermissions?.(x.user.role,x.user.permissions||[])||[]:x.user.permissions||[],w={user:x.user,company:x.company,isAuthenticated:!0,isLoading:!1,permissions:T};return t(w),!0}catch(S){return console.error("Login failed:",S),t(_=>({..._,isLoading:!1})),!1}},logout:async()=>{try{await ks.logout()}catch(v){console.error("Logout error:",v)}Cs.clearSession(),t({user:null,company:null,isAuthenticated:!1,isLoading:!1,permissions:[]}),a(null),window.location.href="/login"},checkPermission:(v,y)=>e.user?ks.hasPermission(e.permissions,v,y,e.user.id):!1,currentRoute:i,refreshSession:()=>{Cs.refreshActivity()}};return d.jsx(cb.Provider,{value:p,children:n})};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */var Sm,Pv;function Bv(){if(Pv)return Sm;Pv=1;const{entries:n,setPrototypeOf:e,isFrozen:t,getPrototypeOf:i,getOwnPropertyDescriptor:a}=Object;let{freeze:o,seal:l,create:u}=Object,{apply:f,construct:m}=typeof Reflect<"u"&&Reflect;o||(o=function(Fe){return Fe}),l||(l=function(Fe){return Fe}),f||(f=function(Fe,Ye,Ze){return Fe.apply(Ye,Ze)}),m||(m=function(Fe,Ye){return new Fe(...Ye)});const p=z(Array.prototype.forEach),v=z(Array.prototype.lastIndexOf),y=z(Array.prototype.pop),S=z(Array.prototype.push),_=z(Array.prototype.splice),x=z(String.prototype.toLowerCase),T=z(String.prototype.toString),w=z(String.prototype.match),E=z(String.prototype.replace),C=z(String.prototype.indexOf),N=z(String.prototype.trim),A=z(Object.prototype.hasOwnProperty),I=z(RegExp.prototype.test),D=L(TypeError);function z(Qe){return function(Fe){Fe instanceof RegExp&&(Fe.lastIndex=0);for(var Ye=arguments.length,Ze=new Array(Ye>1?Ye-1:0),Ot=1;Ot<Ye;Ot++)Ze[Ot-1]=arguments[Ot];return f(Qe,Fe,Ze)}}function L(Qe){return function(){for(var Fe=arguments.length,Ye=new Array(Fe),Ze=0;Ze<Fe;Ze++)Ye[Ze]=arguments[Ze];return m(Qe,Ye)}}function H(Qe,Fe){let Ye=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x;e&&e(Qe,null);let Ze=Fe.length;for(;Ze--;){let Ot=Fe[Ze];if(typeof Ot=="string"){const wt=Ye(Ot);wt!==Ot&&(t(Fe)||(Fe[Ze]=wt),Ot=wt)}Qe[Ot]=!0}return Qe}function K(Qe){for(let Fe=0;Fe<Qe.length;Fe++)A(Qe,Fe)||(Qe[Fe]=null);return Qe}function ne(Qe){const Fe=u(null);for(const[Ye,Ze]of n(Qe))A(Qe,Ye)&&(Array.isArray(Ze)?Fe[Ye]=K(Ze):Ze&&typeof Ze=="object"&&Ze.constructor===Object?Fe[Ye]=ne(Ze):Fe[Ye]=Ze);return Fe}function xe(Qe,Fe){for(;Qe!==null;){const Ze=a(Qe,Fe);if(Ze){if(Ze.get)return z(Ze.get);if(typeof Ze.value=="function")return z(Ze.value)}Qe=i(Qe)}function Ye(){return null}return Ye}const He=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_e=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ie=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),he=o(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ne=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Be=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),X=o(["#text"]),pe=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),P=o(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Y=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),V=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),q=l(/\{\{[\w\W]*|[\w\W]*\}\}/gm),re=l(/<%[\w\W]*|[\w\W]*%>/gm),Me=l(/\$\{[\w\W]*/gm),Ce=l(/^data-[\-\w.\u00B7-\uFFFF]+$/),Le=l(/^aria-[\-\w]+$/),Ae=l(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ct=l(/^(?:\w+script|data):/i),Je=l(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ht=l(/^html$/i),at=l(/^[a-z][.\w]*(-[.\w]+)+$/i);var Gn=Object.freeze({__proto__:null,ARIA_ATTR:Le,ATTR_WHITESPACE:Je,CUSTOM_ELEMENT:at,DATA_ATTR:Ce,DOCTYPE_NAME:Ht,ERB_EXPR:re,IS_ALLOWED_URI:Ae,IS_SCRIPT_OR_DATA:ct,MUSTACHE_EXPR:q,TMPLIT_EXPR:Me});const gt={element:1,text:3,progressingInstruction:7,comment:8,document:9},Re=function(){return typeof window>"u"?null:window},wn=function(Fe,Ye){if(typeof Fe!="object"||typeof Fe.createPolicy!="function")return null;let Ze=null;const Ot="data-tt-policy-suffix";Ye&&Ye.hasAttribute(Ot)&&(Ze=Ye.getAttribute(Ot));const wt="dompurify"+(Ze?"#"+Ze:"");try{return Fe.createPolicy(wt,{createHTML(Wt){return Wt},createScriptURL(Wt){return Wt}})}catch{return console.warn("TrustedTypes policy "+wt+" could not be created."),null}},Rn=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ei(){let Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Re();const Fe=Pe=>ei(Pe);if(Fe.version="3.2.6",Fe.removed=[],!Qe||!Qe.document||Qe.document.nodeType!==gt.document||!Qe.Element)return Fe.isSupported=!1,Fe;let{document:Ye}=Qe;const Ze=Ye,Ot=Ze.currentScript,{DocumentFragment:wt,HTMLTemplateElement:Wt,Node:J,Element:ke,NodeFilter:$e,NamedNodeMap:Ve=Qe.NamedNodeMap||Qe.MozNamedAttrMap,HTMLFormElement:et,DOMParser:dt,trustedTypes:$t}=Qe,Yn=ke.prototype,Ui=xe(Yn,"cloneNode"),ut=xe(Yn,"remove"),ra=xe(Yn,"nextSibling"),wi=xe(Yn,"childNodes"),xa=xe(Yn,"parentNode");if(typeof Wt=="function"){const Pe=Ye.createElement("template");Pe.content&&Pe.content.ownerDocument&&(Ye=Pe.content.ownerDocument)}let qt,zi="";const{implementation:vr,createNodeIterator:qs,createDocumentFragment:rs,getElementsByTagName:ss}=Ye,{importNode:Ks}=Ze;let yn=Rn();Fe.isSupported=typeof n=="function"&&typeof xa=="function"&&vr&&vr.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:li,ERB_EXPR:Jt,TMPLIT_EXPR:en,DATA_ATTR:ba,ARIA_ATTR:os,IS_SCRIPT_OR_DATA:rl,ATTR_WHITESPACE:j,CUSTOM_ELEMENT:U}=Gn;let{IS_ALLOWED_URI:R}=Gn,M=null;const F=H({},[...He,..._e,...ie,...Ne,...X]);let B=null;const se=H({},[...pe,...P,...Y,...V]);let ue=Object.seal(u(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ee=null,le=null,de=!0,Se=!0,Ee=!1,Ie=!0,Te=!1,Oe=!0,Ge=!1,vt=!1,yt=!1,ht=!1,ci=!1,Ei=!1,ni=!0,ui=!1;const Ua="user-content-";let ii=!0,yr=!1,xn={},za=null;const eu=H({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ls=null;const sl=H({},["audio","video","img","source","image","track"]);let xr=null;const tu=H({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Mn="http://www.w3.org/1998/Math/MathML",br="http://www.w3.org/2000/svg",Hi="http://www.w3.org/1999/xhtml";let Sa=Hi,_a=!1,Zs=null;const nu=H({},[Mn,br,Hi],T);let sa=H({},["mi","mo","mn","ms","mtext"]),Qs=H({},["annotation-xml"]);const iu=H({},["title","style","font","a","script"]);let Sr=null;const ol=["application/xhtml+xml","text/html"],bf="text/html";let un=null,oa=null;const ll=Ye.createElement("form"),Js=function(Z){return Z instanceof RegExp||Z instanceof Function},Ta=function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(oa&&oa===Z)){if((!Z||typeof Z!="object")&&(Z={}),Z=ne(Z),Sr=ol.indexOf(Z.PARSER_MEDIA_TYPE)===-1?bf:Z.PARSER_MEDIA_TYPE,un=Sr==="application/xhtml+xml"?T:x,M=A(Z,"ALLOWED_TAGS")?H({},Z.ALLOWED_TAGS,un):F,B=A(Z,"ALLOWED_ATTR")?H({},Z.ALLOWED_ATTR,un):se,Zs=A(Z,"ALLOWED_NAMESPACES")?H({},Z.ALLOWED_NAMESPACES,T):nu,xr=A(Z,"ADD_URI_SAFE_ATTR")?H(ne(tu),Z.ADD_URI_SAFE_ATTR,un):tu,ls=A(Z,"ADD_DATA_URI_TAGS")?H(ne(sl),Z.ADD_DATA_URI_TAGS,un):sl,za=A(Z,"FORBID_CONTENTS")?H({},Z.FORBID_CONTENTS,un):eu,ee=A(Z,"FORBID_TAGS")?H({},Z.FORBID_TAGS,un):ne({}),le=A(Z,"FORBID_ATTR")?H({},Z.FORBID_ATTR,un):ne({}),xn=A(Z,"USE_PROFILES")?Z.USE_PROFILES:!1,de=Z.ALLOW_ARIA_ATTR!==!1,Se=Z.ALLOW_DATA_ATTR!==!1,Ee=Z.ALLOW_UNKNOWN_PROTOCOLS||!1,Ie=Z.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=Z.SAFE_FOR_TEMPLATES||!1,Oe=Z.SAFE_FOR_XML!==!1,Ge=Z.WHOLE_DOCUMENT||!1,ht=Z.RETURN_DOM||!1,ci=Z.RETURN_DOM_FRAGMENT||!1,Ei=Z.RETURN_TRUSTED_TYPE||!1,yt=Z.FORCE_BODY||!1,ni=Z.SANITIZE_DOM!==!1,ui=Z.SANITIZE_NAMED_PROPS||!1,ii=Z.KEEP_CONTENT!==!1,yr=Z.IN_PLACE||!1,R=Z.ALLOWED_URI_REGEXP||Ae,Sa=Z.NAMESPACE||Hi,sa=Z.MATHML_TEXT_INTEGRATION_POINTS||sa,Qs=Z.HTML_INTEGRATION_POINTS||Qs,ue=Z.CUSTOM_ELEMENT_HANDLING||{},Z.CUSTOM_ELEMENT_HANDLING&&Js(Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ue.tagNameCheck=Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&Js(Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ue.attributeNameCheck=Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&typeof Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ue.allowCustomizedBuiltInElements=Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(Se=!1),ci&&(ht=!0),xn&&(M=H({},X),B=[],xn.html===!0&&(H(M,He),H(B,pe)),xn.svg===!0&&(H(M,_e),H(B,P),H(B,V)),xn.svgFilters===!0&&(H(M,ie),H(B,P),H(B,V)),xn.mathMl===!0&&(H(M,Ne),H(B,Y),H(B,V))),Z.ADD_TAGS&&(M===F&&(M=ne(M)),H(M,Z.ADD_TAGS,un)),Z.ADD_ATTR&&(B===se&&(B=ne(B)),H(B,Z.ADD_ATTR,un)),Z.ADD_URI_SAFE_ATTR&&H(xr,Z.ADD_URI_SAFE_ATTR,un),Z.FORBID_CONTENTS&&(za===eu&&(za=ne(za)),H(za,Z.FORBID_CONTENTS,un)),ii&&(M["#text"]=!0),Ge&&H(M,["html","head","body"]),M.table&&(H(M,["tbody"]),delete ee.tbody),Z.TRUSTED_TYPES_POLICY){if(typeof Z.TRUSTED_TYPES_POLICY.createHTML!="function")throw D('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Z.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw D('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');qt=Z.TRUSTED_TYPES_POLICY,zi=qt.createHTML("")}else qt===void 0&&(qt=wn($t,Ot)),qt!==null&&typeof zi=="string"&&(zi=qt.createHTML(""));o&&o(Z),oa=Z}},Ha=H({},[..._e,...ie,...he]),cl=H({},[...Ne,...Be]),ul=function(Z){let we=xa(Z);(!we||!we.tagName)&&(we={namespaceURI:Sa,tagName:"template"});const Ue=x(Z.tagName),Ft=x(we.tagName);return Zs[Z.namespaceURI]?Z.namespaceURI===br?we.namespaceURI===Hi?Ue==="svg":we.namespaceURI===Mn?Ue==="svg"&&(Ft==="annotation-xml"||sa[Ft]):!!Ha[Ue]:Z.namespaceURI===Mn?we.namespaceURI===Hi?Ue==="math":we.namespaceURI===br?Ue==="math"&&Qs[Ft]:!!cl[Ue]:Z.namespaceURI===Hi?we.namespaceURI===br&&!Qs[Ft]||we.namespaceURI===Mn&&!sa[Ft]?!1:!cl[Ue]&&(iu[Ue]||!Ha[Ue]):!!(Sr==="application/xhtml+xml"&&Zs[Z.namespaceURI]):!1},Ai=function(Z){S(Fe.removed,{element:Z});try{xa(Z).removeChild(Z)}catch{ut(Z)}},Wi=function(Z,we){try{S(Fe.removed,{attribute:we.getAttributeNode(Z),from:we})}catch{S(Fe.removed,{attribute:null,from:we})}if(we.removeAttribute(Z),Z==="is")if(ht||ci)try{Ai(we)}catch{}else try{we.setAttribute(Z,"")}catch{}},Vi=function(Z){let we=null,Ue=null;if(yt)Z="<remove></remove>"+Z;else{const Kt=w(Z,/^[\r\n\t ]+/);Ue=Kt&&Kt[0]}Sr==="application/xhtml+xml"&&Sa===Hi&&(Z='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Z+"</body></html>");const Ft=qt?qt.createHTML(Z):Z;if(Sa===Hi)try{we=new dt().parseFromString(Ft,Sr)}catch{}if(!we||!we.documentElement){we=vr.createDocument(Sa,"template",null);try{we.documentElement.innerHTML=_a?zi:Ft}catch{}}const dn=we.body||we.documentElement;return Z&&Ue&&dn.insertBefore(Ye.createTextNode(Ue),dn.childNodes[0]||null),Sa===Hi?ss.call(we,Ge?"html":"body")[0]:Ge?we.documentElement:dn},eo=function(Z){return qs.call(Z.ownerDocument||Z,Z,$e.SHOW_ELEMENT|$e.SHOW_COMMENT|$e.SHOW_TEXT|$e.SHOW_PROCESSING_INSTRUCTION|$e.SHOW_CDATA_SECTION,null)},Wa=function(Z){return Z instanceof et&&(typeof Z.nodeName!="string"||typeof Z.textContent!="string"||typeof Z.removeChild!="function"||!(Z.attributes instanceof Ve)||typeof Z.removeAttribute!="function"||typeof Z.setAttribute!="function"||typeof Z.namespaceURI!="string"||typeof Z.insertBefore!="function"||typeof Z.hasChildNodes!="function")},la=function(Z){return typeof J=="function"&&Z instanceof J};function ki(Pe,Z,we){p(Pe,Ue=>{Ue.call(Fe,Z,we,oa)})}const cs=function(Z){let we=null;if(ki(yn.beforeSanitizeElements,Z,null),Wa(Z))return Ai(Z),!0;const Ue=un(Z.nodeName);if(ki(yn.uponSanitizeElement,Z,{tagName:Ue,allowedTags:M}),Oe&&Z.hasChildNodes()&&!la(Z.firstElementChild)&&I(/<[/\w!]/g,Z.innerHTML)&&I(/<[/\w!]/g,Z.textContent)||Z.nodeType===gt.progressingInstruction||Oe&&Z.nodeType===gt.comment&&I(/<[/\w]/g,Z.data))return Ai(Z),!0;if(!M[Ue]||ee[Ue]){if(!ee[Ue]&&us(Ue)&&(ue.tagNameCheck instanceof RegExp&&I(ue.tagNameCheck,Ue)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Ue)))return!1;if(ii&&!za[Ue]){const Ft=xa(Z)||Z.parentNode,dn=wi(Z)||Z.childNodes;if(dn&&Ft){const Kt=dn.length;for(let fn=Kt-1;fn>=0;--fn){const di=Ui(dn[fn],!0);di.__removalCount=(Z.__removalCount||0)+1,Ft.insertBefore(di,ra(Z))}}}return Ai(Z),!0}return Z instanceof ke&&!ul(Z)||(Ue==="noscript"||Ue==="noembed"||Ue==="noframes")&&I(/<\/no(script|embed|frames)/i,Z.innerHTML)?(Ai(Z),!0):(Te&&Z.nodeType===gt.text&&(we=Z.textContent,p([li,Jt,en],Ft=>{we=E(we,Ft," ")}),Z.textContent!==we&&(S(Fe.removed,{element:Z.cloneNode()}),Z.textContent=we)),ki(yn.afterSanitizeElements,Z,null),!1)},dl=function(Z,we,Ue){if(ni&&(we==="id"||we==="name")&&(Ue in Ye||Ue in ll))return!1;if(!(Se&&!le[we]&&I(ba,we))){if(!(de&&I(os,we))){if(!B[we]||le[we]){if(!(us(Z)&&(ue.tagNameCheck instanceof RegExp&&I(ue.tagNameCheck,Z)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Z))&&(ue.attributeNameCheck instanceof RegExp&&I(ue.attributeNameCheck,we)||ue.attributeNameCheck instanceof Function&&ue.attributeNameCheck(we))||we==="is"&&ue.allowCustomizedBuiltInElements&&(ue.tagNameCheck instanceof RegExp&&I(ue.tagNameCheck,Ue)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Ue))))return!1}else if(!xr[we]){if(!I(R,E(Ue,j,""))){if(!((we==="src"||we==="xlink:href"||we==="href")&&Z!=="script"&&C(Ue,"data:")===0&&ls[Z])){if(!(Ee&&!I(rl,E(Ue,j,"")))){if(Ue)return!1}}}}}}return!0},us=function(Z){return Z!=="annotation-xml"&&w(Z,U)},ds=function(Z){ki(yn.beforeSanitizeAttributes,Z,null);const{attributes:we}=Z;if(!we||Wa(Z))return;const Ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let Ft=we.length;for(;Ft--;){const dn=we[Ft],{name:Kt,namespaceURI:fn,value:di}=dn,_r=un(Kt),fl=di;let En=Kt==="value"?fl:N(fl);if(Ue.attrName=_r,Ue.attrValue=En,Ue.keepAttr=!0,Ue.forceKeepAttr=void 0,ki(yn.uponSanitizeAttribute,Z,Ue),En=Ue.attrValue,ui&&(_r==="id"||_r==="name")&&(Wi(Kt,Z),En=Ua+En),Oe&&I(/((--!?|])>)|<\/(style|title)/i,En)){Wi(Kt,Z);continue}if(Ue.forceKeepAttr)continue;if(!Ue.keepAttr){Wi(Kt,Z);continue}if(!Ie&&I(/\/>/i,En)){Wi(Kt,Z);continue}Te&&p([li,Jt,en],to=>{En=E(En,to," ")});const ru=un(Z.nodeName);if(!dl(ru,_r,En)){Wi(Kt,Z);continue}if(qt&&typeof $t=="object"&&typeof $t.getAttributeType=="function"&&!fn)switch($t.getAttributeType(ru,_r)){case"TrustedHTML":{En=qt.createHTML(En);break}case"TrustedScriptURL":{En=qt.createScriptURL(En);break}}if(En!==fl)try{fn?Z.setAttributeNS(fn,Kt,En):Z.setAttribute(Kt,En),Wa(Z)?Ai(Z):y(Fe.removed)}catch{Wi(Kt,Z)}}ki(yn.afterSanitizeAttributes,Z,null)},au=function Pe(Z){let we=null;const Ue=eo(Z);for(ki(yn.beforeSanitizeShadowDOM,Z,null);we=Ue.nextNode();)ki(yn.uponSanitizeShadowNode,we,null),cs(we),ds(we),we.content instanceof wt&&Pe(we.content);ki(yn.afterSanitizeShadowDOM,Z,null)};return Fe.sanitize=function(Pe){let Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},we=null,Ue=null,Ft=null,dn=null;if(_a=!Pe,_a&&(Pe="<!-->"),typeof Pe!="string"&&!la(Pe))if(typeof Pe.toString=="function"){if(Pe=Pe.toString(),typeof Pe!="string")throw D("dirty is not a string, aborting")}else throw D("toString is not a function");if(!Fe.isSupported)return Pe;if(vt||Ta(Z),Fe.removed=[],typeof Pe=="string"&&(yr=!1),yr){if(Pe.nodeName){const di=un(Pe.nodeName);if(!M[di]||ee[di])throw D("root node is forbidden and cannot be sanitized in-place")}}else if(Pe instanceof J)we=Vi("<!---->"),Ue=we.ownerDocument.importNode(Pe,!0),Ue.nodeType===gt.element&&Ue.nodeName==="BODY"||Ue.nodeName==="HTML"?we=Ue:we.appendChild(Ue);else{if(!ht&&!Te&&!Ge&&Pe.indexOf("<")===-1)return qt&&Ei?qt.createHTML(Pe):Pe;if(we=Vi(Pe),!we)return ht?null:Ei?zi:""}we&&yt&&Ai(we.firstChild);const Kt=eo(yr?Pe:we);for(;Ft=Kt.nextNode();)cs(Ft),ds(Ft),Ft.content instanceof wt&&au(Ft.content);if(yr)return Pe;if(ht){if(ci)for(dn=rs.call(we.ownerDocument);we.firstChild;)dn.appendChild(we.firstChild);else dn=we;return(B.shadowroot||B.shadowrootmode)&&(dn=Ks.call(Ze,dn,!0)),dn}let fn=Ge?we.outerHTML:we.innerHTML;return Ge&&M["!doctype"]&&we.ownerDocument&&we.ownerDocument.doctype&&we.ownerDocument.doctype.name&&I(Ht,we.ownerDocument.doctype.name)&&(fn="<!DOCTYPE "+we.ownerDocument.doctype.name+`>
`+fn),Te&&p([li,Jt,en],di=>{fn=E(fn,di," ")}),qt&&Ei?qt.createHTML(fn):fn},Fe.setConfig=function(){let Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ta(Pe),vt=!0},Fe.clearConfig=function(){oa=null,vt=!1},Fe.isValidAttribute=function(Pe,Z,we){oa||Ta({});const Ue=un(Pe),Ft=un(Z);return dl(Ue,Ft,we)},Fe.addHook=function(Pe,Z){typeof Z=="function"&&S(yn[Pe],Z)},Fe.removeHook=function(Pe,Z){if(Z!==void 0){const we=v(yn[Pe],Z);return we===-1?void 0:_(yn[Pe],we,1)[0]}return y(yn[Pe])},Fe.removeHooks=function(Pe){yn[Pe]=[]},Fe.removeAllHooks=function(){yn=Rn()},Fe}var ti=ei();return Sm=ti,Sm}var _m,Fv;function vE(){return Fv||(Fv=1,_m=window.DOMPurify||(window.DOMPurify=Bv().default||Bv())),_m}var yE=vE();const xE=op(yE);class bE{validateField(e,t){const i=[];let a=e;if(t.required&&this.isEmpty(e))return i.push(t.errorMessage||"This field is required"),{isValid:!1,errors:i};if(this.isEmpty(e)&&!t.required)return{isValid:!0,errors:[],sanitizedValue:""};if(t.type){const o=this.validateType(e,t.type);o.isValid||i.push(...o.errors),a=o.sanitizedValue||e}return t.minLength&&e.length<t.minLength&&i.push(`Must be at least ${t.minLength} characters long`),t.maxLength&&e.length>t.maxLength&&i.push(`Must be no more than ${t.maxLength} characters long`),t.pattern&&!t.pattern.test(e)&&i.push(t.errorMessage||"Invalid format"),t.customValidator&&!t.customValidator(e)&&i.push(t.errorMessage||"Invalid value"),{isValid:i.length===0,errors:i,sanitizedValue:a}}validateForm(e,t){const i={},a={};let o=!0;for(const[l,u]of Object.entries(t)){const f=this.validateField(e[l],u);f.isValid||(i[l]=f.errors,o=!1),a[l]=f.sanitizedValue}return{isValid:o,errors:i,sanitizedData:a}}sanitizeHtml(e){return xE.sanitize(e,{ALLOWED_TAGS:["p","br","strong","em","u","ol","ul","li"],ALLOWED_ATTR:[]})}sanitizeText(e){return e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}sanitizeSql(e){const t=[/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE)\b)/gi,/(--|\/\*|\*\/)/g,/(\bOR\b.*=.*\b)|(\bAND\b.*=.*\b)/gi,/(\bunion\b.*\bselect\b)/gi];let i=e;return t.forEach(a=>{i=i.replace(a,"")}),i.trim()}validateType(e,t){let i=e;const a=[];switch(t){case"email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||a.push("Please enter a valid email address"),i=this.sanitizeText(e);break;case"password":e.length<8&&a.push("Password must be at least 8 characters long"),/[A-Z]/.test(e)||a.push("Password must contain at least one uppercase letter"),/[a-z]/.test(e)||a.push("Password must contain at least one lowercase letter"),/\d/.test(e)||a.push("Password must contain at least one number"),i=e;break;case"text":i=this.sanitizeText(e);break;case"number":const l=Number(e);isNaN(l)&&a.push("Please enter a valid number"),i=l;break;case"url":try{new URL(e),i=this.sanitizeText(e)}catch{a.push("Please enter a valid URL")}break;case"phone":/^\+?[\d\s\-\(\)]+$/.test(e)||a.push("Please enter a valid phone number"),i=e.replace(/[^\d\+\-\(\)\s]/g,"");break;default:i=this.sanitizeText(e)}return{isValid:a.length===0,errors:a,sanitizedValue:i}}isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||typeof e=="object"&&Object.keys(e).length===0}validateTimeEntry(e){const t={description:{required:!0,type:"text",maxLength:500,errorMessage:"Description is required and must be less than 500 characters"},duration:{required:!0,type:"number",customValidator:i=>i>0&&i<=1440,errorMessage:"Duration must be between 1 minute and 24 hours"},projectId:{required:!0,errorMessage:"Project is required"},clientId:{required:!1}};return this.validateForm(e,t)}validateProject(e){const t={name:{required:!0,type:"text",maxLength:100,errorMessage:"Project name is required and must be less than 100 characters"},description:{required:!1,type:"text",maxLength:1e3},budget:{required:!1,type:"number",customValidator:i=>i>=0,errorMessage:"Budget must be a positive number"},hourlyRate:{required:!1,type:"number",customValidator:i=>i>=0,errorMessage:"Hourly rate must be a positive number"}};return this.validateForm(e,t)}validateClient(e){const t={name:{required:!0,type:"text",maxLength:100,errorMessage:"Client name is required and must be less than 100 characters"},email:{required:!1,type:"email"},phone:{required:!1,type:"phone"},website:{required:!1,type:"url"}};return this.validateForm(e,t)}}const Uv=new bE,SE=()=>{const[n,e]=W.useState(""),[t,i]=W.useState(""),[a,o]=W.useState(""),[l,u]=W.useState(!1),{login:f,isLoading:m}=Gc(),p=Jo(),v=async S=>{S.preventDefault(),o("");const _=Uv.validateField(n,{required:!0,type:"email",errorMessage:"Please enter a valid email address"}),x=Uv.validateField(t,{required:!0,minLength:8,errorMessage:"Password must be at least 8 characters"});if(!_.isValid){o(_.errors[0]);return}if(!x.isValid){o(x.errors[0]);return}try{await f(n,t)?p("/dashboard"):o("Invalid email or password")}catch(T){o(T.message||"Login failed. Please try again.")}},y=S=>{const _={admin:{email:"admin@demo.com",password:"Admin123!"},manager:{email:"manager@demo.com",password:"Manager123!"},employee:{email:"employee@demo.com",password:"Employee123!"}};e(_[S].email),i(_[S].password),u(!1)};return d.jsx("div",{className:"login-page",children:d.jsxs("div",{className:"login-container",children:[d.jsxs("div",{className:"login-header",children:[d.jsx("h1",{children:"TimeBeacon"}),d.jsx("p",{children:"Sign in to your account"})]}),d.jsxs("form",{onSubmit:v,className:"login-form",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"email",children:"Email"}),d.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),placeholder:"Enter your email",disabled:m})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"password",children:"Password"}),d.jsx("input",{type:"password",id:"password",value:t,onChange:S=>i(S.target.value),placeholder:"Enter your password",disabled:m})]}),a&&d.jsx("div",{className:"error-message",children:a}),d.jsx("button",{type:"submit",className:"login-button",disabled:m,children:m?"Signing in...":"Sign In"}),d.jsxs("div",{className:"demo-section",children:[d.jsxs("button",{type:"button",className:"demo-toggle-button",onClick:()=>u(!l),children:[l?"Hide":"Show"," Demo Credentials"]}),l&&d.jsxs("div",{className:"demo-credentials",children:[d.jsx("p",{children:"Try these demo accounts:"}),d.jsxs("div",{className:"demo-options",children:[d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>y("admin"),children:"Admin (Owner)"}),d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>y("manager"),children:"Manager"}),d.jsx("button",{type:"button",className:"demo-credential-button",onClick:()=>y("employee"),children:"Employee"})]})]})]})]}),d.jsxs("div",{className:"security-notice",children:[d.jsx("p",{children:" This demo uses enhanced security features including:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Input validation and sanitization"}),d.jsx("li",{children:"Rate limiting protection"}),d.jsx("li",{children:"Secure session management"}),d.jsx("li",{children:"CSRF protection"})]})]})]})})},pi=({children:n})=>{const{user:e,isLoading:t}=Gc();return t?d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"var(--text-secondary)"},children:"Loading..."}):!e&&!localStorage.getItem("timebeacon_user")?d.jsx(eb,{to:"/login",replace:!0}):d.jsx(d.Fragment,{children:n})},_E=n=>{const e=[{id:"dashboard",label:"Dashboard",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),d.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),d.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),d.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})},{id:"reports",label:"Analytics & Reports",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M3 3v18h18"}),d.jsx("path",{d:"M18 17V9"}),d.jsx("path",{d:"M13 17V5"}),d.jsx("path",{d:"M8 17v-3"})]})},{id:"ai-insights",label:"AI Insights",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M9 12l2 2 4-4"}),d.jsx("path",{d:"M21 12c.5 0 .9-.4.9-.9V6.1c0-.5-.4-.9-.9-.9H17"}),d.jsx("path",{d:"M3 12c-.5 0-.9-.4-.9-.9V6.1c0-.5.4-.9.9-.9H7"}),d.jsx("path",{d:"M12 3c0-.5.4-.9.9-.9h4.9c.5 0 .9.4.9.9V7"}),d.jsx("path",{d:"M12 21c0 .5-.4.9-.9.9H6.1c-.5 0-.9-.4-.9-.9V17"})]})},{id:"privacy",label:"Privacy & Data",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),d.jsx("path",{d:"M9 12l2 2 4-4"})]})},{id:"integrations",label:"Integrations",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),d.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}],t=[];n&&["owner","admin","manager"].includes(n)&&t.push({id:"permissions",label:"Team & Permissions",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),d.jsx("circle",{cx:"9",cy:"7",r:"4"}),d.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),d.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),d.jsx("line",{x1:"15",y1:"11",x2:"21",y2:"5"}),d.jsx("circle",{cx:"18",cy:"8",r:"3"})]})});const i={id:"settings",label:"Settings",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return[...e,...t,i]},TE=({activeItem:n,onItemClick:e})=>{const{theme:t,setTheme:i}=dE(),{logout:a,user:o}=Gc(),[l,u]=W.useState(!1),f=()=>{const p=["light","dark","system"],y=(p.indexOf(t)+1)%p.length;i(p[y])},m=()=>{switch(t){case"light":return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]});case"dark":return d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})});case"system":return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",ry:"2"}),d.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),d.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]});default:return d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]})}};return d.jsxs("div",{className:`sidebar ${l?"collapsed":""}`,children:[d.jsxs("div",{className:"sidebar-header",children:[d.jsxs("div",{className:"logo-container",children:[d.jsx("div",{className:"logo-icon",children:d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"drop-shadow(0 2px 4px rgba(99, 102, 241, 0.3))"},children:[d.jsx("defs",{children:d.jsxs("linearGradient",{id:"lightning-logo",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:1}}),d.jsx("stop",{offset:"50%",style:{stopColor:"#6366f1",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#3b82f6",stopOpacity:1}})]})}),d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",fill:"url(#lightning-logo)",stroke:"url(#lightning-logo)"})]})}),!l&&d.jsxs("div",{children:[d.jsx("h1",{className:"sidebar-title",children:"TimeBeacon"}),d.jsx("p",{className:"sidebar-subtitle",children:"AI-Powered Privacy-First"})]})]}),d.jsx("button",{className:"collapse-toggle",onClick:()=>u(!l),title:l?"Expand sidebar":"Collapse sidebar",children:l?d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"9,18 15,12 9,6"})}):d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"15,18 9,12 15,6"})})})]}),d.jsxs("nav",{className:"nav-menu",children:[_E(o?.role).map(p=>d.jsxs("a",{href:"#",className:`nav-item ${n===p.id?"active":""}`,onClick:v=>{v.preventDefault(),e(p.id)},title:l?p.label:"",children:[d.jsx("span",{className:"nav-icon",children:p.icon}),!l&&d.jsx("span",{className:"nav-label",children:p.label})]},p.id)),d.jsxs("div",{className:"nav-footer",children:[d.jsxs("button",{className:"theme-toggle",onClick:f,title:l?`Theme: ${t}`:`Current theme: ${t}`,children:[d.jsx("span",{className:"nav-icon",children:m()}),!l&&d.jsx("span",{className:"theme-label",children:t.charAt(0).toUpperCase()+t.slice(1)})]}),!l&&o&&d.jsx("div",{className:"user-info",children:d.jsxs("div",{className:"user-details",children:[d.jsx("span",{className:"user-name",children:o.name}),d.jsx("span",{className:"user-email",children:o.email})]})}),d.jsxs("button",{className:"logout-button",onClick:a,title:l?"Logout":"Sign out",children:[d.jsx("span",{className:"nav-icon",children:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),d.jsx("polyline",{points:"16,17 21,12 16,7"}),d.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})}),!l&&d.jsx("span",{className:"logout-label",children:"Sign Out"})]})]})]})]})},Tm=(n,e)=>{const t=i=>{const[a,o]=i.split(":"),l=parseInt(a),u=l>=12?"PM":"AM";return`${l===0?12:l>12?l-12:l}:${o} ${u}`};return`${t(n)} - ${t(e)}`};class wE{config={ollamaBaseUrl:"http://localhost:11434",model:"llama3.2:3b",maxTokens:512,temperature:.1,confidenceThreshold:.7,enabled:!1};isAvailable=!1;constructor(){this.checkOllamaAvailability()}async checkOllamaAvailability(){try{const e=await fetch(`${this.config.ollamaBaseUrl}/api/tags`);if(e.ok){const i=(await e.json()).models?.some(a=>a.name.includes(this.config.model.split(":")[0]));return this.isAvailable=i,this.config.enabled=i,i?console.log(" Ollama AI service available with model:",this.config.model):console.log(" Ollama available but model not found. Install with:",`ollama pull ${this.config.model}`),this.isAvailable}}catch{console.log(" Ollama not available. Install from https://ollama.com for AI features."),this.isAvailable=!1,this.config.enabled=!1}return!1}async analyzeContent(e){if(!this.isAvailable||!this.config.enabled)return this.fallbackAnalysis(e);try{const t=this.buildAnalysisPrompt(e),i=await this.callOllama(t);return this.parseAnalysisResponse(i,e)}catch(t){return console.error("AI analysis failed:",t),this.fallbackAnalysis(e)}}buildAnalysisPrompt(e){const{title:t,description:i,participants:a,location:o,source:l,context:u}=e,f=u?.projects.map(p=>`${p.name} (${p.client})`).join(", ")||"No projects available",m=u?.clients.map(p=>p.name).join(", ")||"No clients available";return`You are an AI assistant helping categorize work activities for time tracking. Analyze the following activity and suggest appropriate categorization.

ACTIVITY TO ANALYZE:
Title: ${t}
Description: ${i||"No description"}
Participants: ${a?.join(", ")||"Not specified"}
Location: ${o||"Not specified"}
Source: ${l}

AVAILABLE CONTEXT:
Projects: ${f}
Clients: ${m}

INSTRUCTIONS:
1. Suggest the most appropriate project and client from the available options
2. Determine if this is billable work (client work = billable, internal = non-billable)
3. Categorize as: client, internal, admin, sales, or marketing
4. If it's a meeting, classify type: kickoff, discovery, implementation, support, training, check-in, or escalation
5. Extract relevant tags or keywords
6. Provide your confidence level (0.0 to 1.0)
7. Explain your reasoning briefly

RESPOND IN THIS EXACT JSON FORMAT:
{
  "confidence": 0.85,
  "suggestedProject": "Project Name",
  "suggestedClient": "Client Name",
  "suggestedDescription": "Enhanced description if needed",
  "suggestedCategory": "client",
  "suggestedBillable": true,
  "meetingType": "implementation",
  "tags": ["keyword1", "keyword2"],
  "reasoning": "Brief explanation of categorization logic"
}

Only respond with valid JSON. If uncertain, lower the confidence score.`}async callOllama(e){const t=await fetch(`${this.config.ollamaBaseUrl}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.config.model,prompt:e,stream:!1,options:{temperature:this.config.temperature,num_predict:this.config.maxTokens}})});if(!t.ok)throw new Error(`Ollama API error: ${t.status}`);return(await t.json()).response}parseAnalysisResponse(e,t){try{const i=e.match(/\{[\s\S]*\}/);if(!i)throw new Error("No JSON found in response");const a=JSON.parse(i[0]);return{confidence:Math.max(0,Math.min(1,a.confidence||.5)),suggestedProject:this.validateProject(a.suggestedProject,t.context?.projects),suggestedClient:this.validateClient(a.suggestedClient,t.context?.clients),suggestedDescription:a.suggestedDescription||t.title,suggestedCategory:this.validateCategory(a.suggestedCategory),suggestedBillable:!!a.suggestedBillable,meetingType:this.validateMeetingType(a.meetingType),tags:Array.isArray(a.tags)?a.tags.slice(0,5):[],reasoning:a.reasoning||"AI analysis completed"}}catch(i){return console.error("Failed to parse AI response:",i),this.fallbackAnalysis(t)}}validateProject(e,t){if(!e||!t)return;const i=t.find(o=>o.name.toLowerCase()===e.toLowerCase());return i?i.name:t.find(o=>o.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(o.name.toLowerCase()))?.name}validateClient(e,t){if(!e||!t)return;const i=t.find(o=>o.name.toLowerCase()===e.toLowerCase());return i?i.name:t.find(o=>o.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(o.name.toLowerCase()))?.name}validateCategory(e){return["client","internal","admin","meeting"].includes(e)?e:"client"}validateMeetingType(e){return e&&["kickoff","discovery","implementation","support","training","check-in","escalation"].includes(e)?e:void 0}fallbackAnalysis(e){const t=e.title.toLowerCase(),i=e.description?.toLowerCase()||"";let a="client",o=!0,l;t.includes("internal")||t.includes("team")||t.includes("standup")?(a="internal",o=!1):t.includes("meeting")||t.includes("demo")?a="meeting":(t.includes("admin")||t.includes("setup")||t.includes("configuration"))&&(a="admin",o=!1),t.includes("kickoff")?l="kickoff":t.includes("discovery")?l="discovery":t.includes("implementation")?l="implementation":t.includes("support")?l="support":t.includes("training")?l="training":(t.includes("check-in")||t.includes("checkin"))&&(l="check-in");const u=this.findClientByKeywords(t+" "+i,e.context?.clients);return{confidence:.6,suggestedProject:this.findProjectByKeywords(t+" "+i,e.context?.projects),suggestedClient:u,suggestedDescription:e.title,suggestedCategory:a,suggestedBillable:o,meetingType:l,tags:this.extractKeywords(t+" "+i),reasoning:"Rule-based analysis (AI not available)"}}findClientByKeywords(e,t){if(t)return t.find(i=>e.toLowerCase().includes(i.name.toLowerCase()))?.name}findProjectByKeywords(e,t){if(t)return t.find(i=>e.toLowerCase().includes(i.name.toLowerCase())||e.toLowerCase().includes(i.client.toLowerCase()))?.name}extractKeywords(e){const t=e.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(i=>i.length>3).filter(i=>!["with","from","this","that","will","have","been","they","them","were"].includes(i));return[...new Set(t)].slice(0,5)}updateConfig(e){this.config={...this.config,...e},(e.ollamaBaseUrl||e.model)&&this.checkOllamaAvailability()}getStatus(){return{available:this.isAvailable,model:this.config.model,enabled:this.config.enabled}}async testService(){const e=Date.now();try{const t={title:"Team standup meeting",description:"Daily team sync with engineering",source:"calendar",timestamp:new Date().toISOString(),context:{projects:[{id:"1",name:"Internal Tools",client:"Internal",color:"#000",active:!0,createdAt:""}],clients:[{id:"1",name:"Internal",color:"#000",active:!0,createdAt:""}],recentEntries:[]}},i=await this.analyzeContent(t),a=Date.now()-e;return{success:i.confidence>0,latency:a}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown error"}}}}const Gr=new wE;class EE{db=null;dbName="TimeBeaconDB";version=1;stores=["timeEntries","projects","clients","settings","syncMetadata"];constructor(){this.init()}async init(){return new Promise((e,t)=>{const i=indexedDB.open(this.dbName,this.version);i.onerror=a=>{console.error("Database failed to open:",a),console.log(" Database issue detected. Please refresh the page or clear browser cache."),t(new Error("Failed to open database"))},i.onsuccess=()=>{this.db=i.result,console.log(" TimeBeacon Database initialized"),e()},i.onupgradeneeded=a=>{const o=a.target.result;if(!o.objectStoreNames.contains("timeEntries")){const l=o.createObjectStore("timeEntries",{keyPath:"id"});l.createIndex("date","date",{unique:!1}),l.createIndex("project","project",{unique:!1}),l.createIndex("client","client",{unique:!1}),l.createIndex("status","status",{unique:!1})}if(!o.objectStoreNames.contains("projects")){const l=o.createObjectStore("projects",{keyPath:"id"});l.createIndex("name","name",{unique:!0}),l.createIndex("client","client",{unique:!1})}o.objectStoreNames.contains("clients")||o.createObjectStore("clients",{keyPath:"id"}).createIndex("name","name",{unique:!0}),o.objectStoreNames.contains("settings")||o.createObjectStore("settings",{keyPath:"key"}),o.objectStoreNames.contains("syncMetadata")||o.createObjectStore("syncMetadata",{keyPath:"id"}),console.log(" Database schema created")}})}async performOperation(e,t,i="readonly"){return this.db||await this.init(),new Promise((a,o)=>{const u=this.db.transaction([e],i).objectStore(e),f=t(u);f.onsuccess=()=>a(f.result),f.onerror=()=>o(f.error)})}async addTimeEntry(e){await this.performOperation("timeEntries",t=>t.add(e),"readwrite"),console.log(" Time entry added:",e.id)}async updateTimeEntry(e,t){const i=await this.getTimeEntry(e);if(!i)throw new Error(`Time entry ${e} not found`);const a={...i,...t};await this.performOperation("timeEntries",o=>o.put(a),"readwrite"),console.log(" Time entry updated:",e)}async deleteTimeEntry(e){await this.performOperation("timeEntries",t=>t.delete(e),"readwrite"),console.log(" Time entry deleted:",e)}async getTimeEntry(e){return await this.performOperation("timeEntries",i=>i.get(e))||null}async getAllTimeEntries(){return await this.performOperation("timeEntries",e=>e.getAll())}async getTimeEntriesByDateRange(e,t){return(await this.getAllTimeEntries()).filter(a=>a.date>=e&&a.date<=t)}async addProject(e){await this.performOperation("projects",t=>t.add(e),"readwrite"),console.log(" Project added:",e.name)}async updateProject(e,t){const i=await this.getProject(e);if(!i)throw new Error(`Project ${e} not found`);const a={...i,...t};await this.performOperation("projects",o=>o.put(a),"readwrite"),console.log(" Project updated:",e)}async deleteProject(e){await this.performOperation("projects",t=>t.delete(e),"readwrite"),console.log(" Project deleted:",e)}async getProject(e){return await this.performOperation("projects",i=>i.get(e))||null}async getAllProjects(){return await this.performOperation("projects",e=>e.getAll())}async addClient(e){await this.performOperation("clients",t=>t.add(e),"readwrite"),console.log(" Client added:",e.name)}async updateClient(e,t){const i=await this.getClient(e);if(!i)throw new Error(`Client ${e} not found`);const a={...i,...t};await this.performOperation("clients",o=>o.put(a),"readwrite"),console.log(" Client updated:",e)}async deleteClient(e){await this.performOperation("clients",t=>t.delete(e),"readwrite"),console.log(" Client deleted:",e)}async getClient(e){return await this.performOperation("clients",i=>i.get(e))||null}async getAllClients(){return await this.performOperation("clients",e=>e.getAll())}async updateSettings(e){await this.performOperation("settings",t=>t.put({key:"userSettings",value:e}),"readwrite"),console.log(" Settings updated")}async getSettings(){return(await this.performOperation("settings",t=>t.get("userSettings")))?.value||null}async updateSyncMetadata(e){await this.performOperation("syncMetadata",t=>t.put({id:"sync",...e}),"readwrite")}async getSyncMetadata(){return await this.performOperation("syncMetadata",t=>t.get("sync"))||null}async exportAllData(){const[e,t,i,a,o]=await Promise.all([this.getAllTimeEntries(),this.getAllProjects(),this.getAllClients(),this.getSettings(),this.getSyncMetadata()]);return{timeEntries:e,projects:t,clients:i,settings:a||{},syncMetadata:o||{lastSync:"",version:1,deviceId:crypto.randomUUID()}}}async importData(e){const t=this.db.transaction(this.stores,"readwrite");try{if(e.timeEntries){const i=t.objectStore("timeEntries");for(const a of e.timeEntries)await new Promise((o,l)=>{const u=i.put(a);u.onsuccess=()=>o(void 0),u.onerror=()=>l(u.error)})}if(e.projects){const i=t.objectStore("projects");for(const a of e.projects)await new Promise((o,l)=>{const u=i.put(a);u.onsuccess=()=>o(void 0),u.onerror=()=>l(u.error)})}if(e.clients){const i=t.objectStore("clients");for(const a of e.clients)await new Promise((o,l)=>{const u=i.put(a);u.onsuccess=()=>o(void 0),u.onerror=()=>l(u.error)})}console.log(" Data import completed")}catch(i){throw console.error(" Data import failed:",i),i}}async clearAllData(){const e=this.db.transaction(this.stores,"readwrite");for(const t of this.stores){const i=e.objectStore(t);await new Promise((a,o)=>{const l=i.clear();l.onsuccess=()=>a(void 0),l.onerror=()=>o(l.error)})}console.log(" All data cleared")}async getStats(){const[e,t,i]=await Promise.all([this.getAllTimeEntries(),this.getAllProjects(),this.getAllClients()]),o=`${(JSON.stringify({timeEntries:e,projects:t,clients:i}).length/1024).toFixed(2)} KB`;return{timeEntries:e.length,projects:t.length,clients:i.length,dbSize:o}}}const It=new EE;class AE{processingQueue=[];isProcessing=!1;analysisCache=new Map;constructor(){setInterval(()=>this.processQueue(),3e4)}async addActivity(e){this.processingQueue.push(e),console.log(` Added activity for analysis: ${e.title}`),(this.processingQueue.length>=5||this.isHighPriority(e))&&await this.processQueue()}async processQueue(){if(!(this.isProcessing||this.processingQueue.length===0)){this.isProcessing=!0,console.log(` Processing ${this.processingQueue.length} activities...`);try{const e=await this.buildAnalysisContext(),t=[...this.processingQueue];this.processingQueue=[];for(const i of t)await this.analyzeActivity(i,e)}catch(e){console.error("Content analysis failed:",e)}finally{this.isProcessing=!1}}}async analyzeActivity(e,t){try{const i=this.getCacheKey(e);let a=this.analysisCache.get(i);if(!a){const o={title:e.title,description:e.description,participants:e.participants,location:e.location,source:e.source,timestamp:e.timestamp,context:{projects:t.projects,clients:t.clients,recentEntries:t.recentEntries.slice(0,10)}};a=await Gr.analyzeContent(o),this.analysisCache.set(i,a),setTimeout(()=>this.analysisCache.delete(i),36e5)}a.confidence>=.5?await this.createSuggestion(e,a,t):console.log(` Low confidence (${a.confidence}) for activity: ${e.title}`)}catch(i){console.error(`Failed to analyze activity ${e.id}:`,i)}}async createSuggestion(e,t,i){const a={id:`suggestion-${e.id}-${Date.now()}`,analysisId:`analysis-${e.id}`,source:e.source,suggestedDate:e.startTime.split("T")[0],suggestedStartTime:this.extractTime(e.startTime),suggestedDuration:this.calculateDuration(e,t),suggestedProject:t.suggestedProject||"Unknown Project",suggestedClient:t.suggestedClient||"Unknown Client",suggestedDescription:t.suggestedDescription||e.title,suggestedTags:t.tags||[],confidence:t.confidence,basedOnDataFrom:[e.source],generatedAt:new Date().toISOString(),status:"pending"};await this.storeSuggestion(a),console.log(` Created suggestion: ${a.suggestedProject} - ${a.suggestedDescription} (${Math.round(a.confidence*100)}% confidence)`),t.confidence>=i.userPreferences.autoApproveThreshold&&await this.autoApproveSuggestion(a)}calculateDuration(e,t){if(e.duration)return e.duration;if(e.startTime&&e.endTime){const a=new Date(e.startTime);return(new Date(e.endTime).getTime()-a.getTime())/(1e3*60*60)}const i=e.title.toLowerCase();return i.includes("standup")||i.includes("daily")?.25:i.includes("check-in")||i.includes("quick")?.5:i.includes("kickoff")||i.includes("discovery")?2:i.includes("training")||i.includes("workshop")?4:1}extractTime(e){return new Date(e).toTimeString().slice(0,5)}async buildAnalysisContext(){const[e,t,i]=await Promise.all([It.getAllProjects(),It.getAllClients(),It.getAllTimeEntries()]),a=new Date;a.setDate(a.getDate()-30);const o=i.filter(l=>new Date(l.date)>=a).sort((l,u)=>new Date(u.date).getTime()-new Date(l.date).getTime());return{projects:e.filter(l=>l.active),clients:t.filter(l=>l.active),recentEntries:o.slice(0,50),userPreferences:{defaultDuration:1,autoApproveThreshold:.85,preferredCategories:["client","implementation"]}}}async storeSuggestion(e){const t=this.getStoredSuggestions();t.push(e),localStorage.setItem("timebeacon_suggestions",JSON.stringify(t))}getStoredSuggestions(){try{const e=localStorage.getItem("timebeacon_suggestions");return e?JSON.parse(e):[]}catch{return[]}}async updateSuggestion(e,t){const i=this.getStoredSuggestions(),a=i.findIndex(o=>o.id===e);a>=0&&(i[a]={...i[a],...t},localStorage.setItem("timebeacon_suggestions",JSON.stringify(i)))}async approveSuggestion(e,t){const a=this.getStoredSuggestions().find(l=>l.id===e);if(!a)throw new Error("Suggestion not found");const o={date:a.suggestedDate,startTime:a.suggestedStartTime,endTime:this.calculateEndTime(a.suggestedStartTime,a.suggestedDuration),duration:a.suggestedDuration,client:a.suggestedClient,project:a.suggestedProject,description:a.suggestedDescription,category:"client",status:"pending",automated:!0,source:"ai_suggested",billable:!0,tags:a.suggestedTags,generatedFromSuggestion:a.id,aiConfidence:a.confidence,dataSourcesUsed:a.basedOnDataFrom,...t};await It.addTimeEntry({...o,id:crypto.randomUUID()}),await this.updateSuggestion(e,{status:"approved",approvedAt:new Date().toISOString()}),console.log(` Approved suggestion and created time entry: ${a.suggestedProject}`)}async rejectSuggestion(e,t){await this.updateSuggestion(e,{status:"rejected",rejectedAt:new Date().toISOString(),rejectionReason:t}),console.log(` Rejected suggestion: ${t}`)}async autoApproveSuggestion(e){try{await this.approveSuggestion(e.id),console.log(` Auto-approved high confidence suggestion: ${e.suggestedProject}`)}catch(t){console.error("Auto-approval failed:",t)}}calculateEndTime(e,t){const[i,a]=e.split(":").map(Number),o=i*60+a+t*60,l=Math.floor(o/60)%24,u=o%60;return`${l.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}isHighPriority(e){const t=e.title.toLowerCase();return t.includes("urgent")||t.includes("escalation")||t.includes("emergency")}getCacheKey(e){return`${e.source}-${e.title}-${e.startTime}`}async clearOldSuggestions(e=30){const t=this.getStoredSuggestions(),i=new Date;i.setDate(i.getDate()-e);const a=t.filter(o=>new Date(o.generatedAt)>i||o.status==="pending");localStorage.setItem("timebeacon_suggestions",JSON.stringify(a)),console.log(` Cleaned up ${t.length-a.length} old suggestions`)}getStats(){const e=this.getStoredSuggestions(),t=e.filter(i=>i.status==="pending");return{queueLength:this.processingQueue.length,isProcessing:this.isProcessing,cacheSize:this.analysisCache.size,totalSuggestions:e.length,pendingSuggestions:t.length}}}const ta=new AE;class kE{oauth2Client;config;STORAGE_KEY="timebeacon_google_auth";constructor(){this.config={clientId:"829394557114-32bedmchkqvru4gvtg52ojgef7fssusn.apps.googleusercontent.com",clientSecret:"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",redirectUri:`${window.location.origin}/auth/google/callback`,scopes:["https://www.googleapis.com/auth/calendar.readonly","https://www.googleapis.com/auth/userinfo.email"]},this.initializeOAuth2Client()}initializeOAuth2Client(){console.log("Google Calendar auth disabled for production")}getAuthUrl(){return this.oauth2Client.generateAuthUrl({access_type:"offline",scope:this.config.scopes,prompt:"consent"})}async exchangeCodeForTokens(e){try{const{tokens:t}=await this.oauth2Client.getToken(e);return this.oauth2Client.setCredentials(t),this.storeTokens(t),console.log(" Google Calendar authentication successful"),{success:!0}}catch(t){return console.error("Google Calendar auth failed:",t),{success:!1,error:t instanceof Error?t.message:"Authentication failed"}}}isAuthenticated(){const e=this.getStoredTokens();return!!(e&&e.access_token)}getCalendarClient(){return console.warn("Google Calendar disabled in production"),null}async refreshAccessToken(){try{const e=this.getStoredTokens();if(!e||!e.refresh_token)return console.log("No refresh token available, need to re-authenticate"),!1;this.oauth2Client.setCredentials(e);const{credentials:t}=await this.oauth2Client.refreshAccessToken(),i={...e,...t};return this.storeTokens(i),this.oauth2Client.setCredentials(i),console.log(" Google Calendar token refreshed"),!0}catch(e){return console.error("Failed to refresh token:",e),this.clearStoredTokens(),!1}}async testConnection(){try{if(!this.isAuthenticated())return{success:!1,error:"Not authenticated"};const e=this.getStoredTokens();return e&&e.expiry_date&&e.expiry_date<Date.now()&&!await this.refreshAccessToken()?{success:!1,error:"Token refresh failed"}:{success:!0,userEmail:{data:{email:"disabled@example.com"}}.data.email||void 0}}catch(e){return console.error("Google Calendar connection test failed:",e),{success:!1,error:e instanceof Error?e.message:"Connection test failed"}}}signOut(){this.clearStoredTokens(),this.oauth2Client.setCredentials({}),console.log(" Signed out from Google Calendar")}async getUserInfo(){try{if(!this.isAuthenticated())return null;const e={data:{email:"disabled@example.com",name:"Google Auth Disabled"}};return{email:e.data.email||void 0,name:e.data.name||void 0}}catch(e){return console.error("Failed to get user info:",e),null}}storeTokens(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){console.error("Failed to store auth tokens:",t)}}getStoredTokens(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):null}catch(e){return console.error("Failed to load stored tokens:",e),null}}clearStoredTokens(){try{localStorage.removeItem(this.STORAGE_KEY)}catch(e){console.error("Failed to clear stored tokens:",e)}}isConfigured(){return!!(this.config.clientId&&this.config.clientSecret)}getOAuth2Client(){return this.oauth2Client}}const wm=new kE;class CE{config={enabled:!1,autoTrackMeetings:!0,minimumDuration:15,excludeAllDay:!0,excludePersonal:!0,excludeCalendars:[],includeCalendars:[],trackingKeywords:["meeting","call","sync","review","demo","training"],excludeKeywords:["personal","lunch","break","vacation","holiday","blocked"]};lastSyncTimestamp=null;processedEvents=new Set;constructor(){this.loadConfig(),this.config.enabled&&this.startBackgroundSync()}async initialize(){try{return await this.checkCalendarAccess()?(this.config.enabled=!0,this.saveConfig(),this.startBackgroundSync(),console.log(" Calendar integration initialized"),{success:!0}):{success:!1,error:"Calendar access not available. Please enable calendar integration in settings."}}catch(e){return console.error("Calendar initialization failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async checkCalendarAccess(){return!0}startBackgroundSync(){setInterval(()=>{this.syncCalendarEvents()},5*60*1e3),this.syncCalendarEvents()}async syncCalendarEvents(){if(this.config.enabled)try{console.log(" Syncing calendar events...");const t=(await this.fetchCalendarEvents()).filter(i=>!this.processedEvents.has(i.id));console.log(`Found ${t.length} new calendar events to process`);for(const i of t)this.shouldProcessEvent(i)&&(await this.processCalendarEvent(i),this.processedEvents.add(i.id));this.lastSyncTimestamp=new Date().toISOString(),this.saveConfig()}catch(e){console.error("Calendar sync failed:",e)}}async fetchCalendarEvents(){try{if(!wm.isAuthenticated())return console.log("Not authenticated with Google Calendar, using mock data"),this.getMockEvents();const e=await wm.testConnection();if(!e.success)return console.log("Google Calendar connection failed, using mock data:",e.error),this.getMockEvents();let t;try{t=wm.getCalendarClient()}catch(f){return console.warn("Calendar client not available:",f),[]}if(!t)return console.warn("Calendar client not available"),[];const i=new Date;i.setHours(i.getHours()-24);const a=new Date,o=await t.events.list({calendarId:"primary",timeMin:i.toISOString(),timeMax:a.toISOString(),maxResults:50,singleEvents:!0,orderBy:"startTime"});if(!o||!o.data)return console.warn("No response data from Google Calendar API"),[];const u=(o.data.items||[]).map(f=>({id:f.id||"",title:f.summary||"Untitled Event",description:f.description||void 0,start:f.start?.dateTime||f.start?.date||new Date().toISOString(),end:f.end?.dateTime||f.end?.date||new Date().toISOString(),attendees:f.attendees?.map(m=>m.email||"")||[],location:f.location||void 0,organizer:f.organizer?.email||void 0,status:this.mapEventStatus(f.status||void 0),isAllDay:!!f.start?.date,recurrence:f.recurrence?.join(", ")||void 0,calendarId:"primary",calendarName:"Google Calendar"})).filter(f=>f.start&&f.end);return console.log(` Fetched ${u.length} events from Google Calendar`),u}catch(e){return console.error("Failed to fetch Google Calendar events:",e),console.log("Falling back to mock data"),this.getMockEvents()}}getMockEvents(){return[{id:"event-1",title:"Client Discovery Call - Acme Corp",description:"Initial discovery session to understand requirements",start:new Date(Date.now()-72e5).toISOString(),end:new Date(Date.now()-36e5).toISOString(),attendees:["john@acme.com","sarah@acme.com"],location:"Zoom",status:"confirmed",calendarId:"primary",calendarName:"Work Calendar"},{id:"event-2",title:"Team Standup",description:"Daily team sync",start:new Date(Date.now()-18e5).toISOString(),end:new Date(Date.now()-9e5).toISOString(),attendees:["team@company.com"],status:"confirmed",calendarId:"primary",calendarName:"Work Calendar"}].filter(t=>new Date(t.end)<new Date)}mapEventStatus(e){switch(e){case"confirmed":return"confirmed";case"tentative":return"tentative";case"cancelled":return"cancelled";default:return"confirmed"}}shouldProcessEvent(e){if(this.processedEvents.has(e.id)||e.status==="cancelled"||e.isAllDay&&this.config.excludeAllDay||(new Date(e.end).getTime()-new Date(e.start).getTime())/(1e3*60)<this.config.minimumDuration||this.config.includeCalendars.length>0&&!this.config.includeCalendars.includes(e.calendarId)||this.config.excludeCalendars.includes(e.calendarId))return!1;const i=`${e.title} ${e.description||""}`.toLowerCase();return this.config.excludeKeywords.some(a=>i.includes(a))?!1:this.config.trackingKeywords.length>0?this.config.trackingKeywords.some(a=>i.includes(a)):!0}async processCalendarEvent(e){try{const t={id:`calendar-${e.id}`,title:e.title,description:e.description,startTime:e.start,endTime:e.end,duration:this.calculateDuration(e.start,e.end),participants:e.attendees,location:e.location,source:"calendar",sourceId:e.id,timestamp:e.start,rawData:e};await ta.addActivity(t),console.log(` Processed calendar event: ${e.title}`)}catch(t){console.error(`Failed to process calendar event ${e.id}:`,t)}}calculateDuration(e,t){const i=new Date(e);return(new Date(t).getTime()-i.getTime())/(1e3*60*60)}updateConfig(e){this.config={...this.config,...e},this.saveConfig(),e.enabled!==void 0&&e.enabled&&!this.config.enabled&&this.startBackgroundSync()}getConfig(){return{...this.config}}getStatus(){return{enabled:this.config.enabled,lastSync:this.lastSyncTimestamp,processedEventsCount:this.processedEvents.size,isConnected:this.config.enabled}}async forceSync(){try{const e=this.processedEvents.size;return await this.syncCalendarEvents(),{success:!0,eventsProcessed:this.processedEvents.size-e}}catch(e){return{success:!1,eventsProcessed:0,error:e instanceof Error?e.message:"Sync failed"}}}clearHistory(){this.processedEvents.clear(),this.lastSyncTimestamp=null,this.saveConfig(),console.log(" Cleared calendar sync history")}loadConfig(){try{const e=localStorage.getItem("timebeacon_calendar_config");if(e){const t=JSON.parse(e);this.config={...this.config,...t};const i=localStorage.getItem("timebeacon_processed_events");i&&(this.processedEvents=new Set(JSON.parse(i))),this.lastSyncTimestamp=localStorage.getItem("timebeacon_last_sync")}}catch(e){console.error("Failed to load calendar config:",e)}}saveConfig(){try{localStorage.setItem("timebeacon_calendar_config",JSON.stringify(this.config)),localStorage.setItem("timebeacon_processed_events",JSON.stringify([...this.processedEvents])),this.lastSyncTimestamp&&localStorage.setItem("timebeacon_last_sync",this.lastSyncTimestamp)}catch(e){console.error("Failed to save calendar config:",e)}}async testConnection(){try{return{success:!0,eventsFound:(await this.fetchCalendarEvents()).length}}catch(e){return{success:!1,eventsFound:0,error:e instanceof Error?e.message:"Connection test failed"}}}}const Ma=new CE,jE=()=>{const[n,e]=W.useState([]),[t,i]=W.useState(!1),[a,o]=W.useState(null),l=async()=>{i(!0),o(null);try{const m=await Ma.forceSync();m.success?(console.log(`Calendar sync completed. Processed ${m.eventsProcessed} new events.`),e([])):o(m.error||"Failed to sync calendar events")}catch(m){o(m instanceof Error?m.message:"Failed to fetch calendar events")}finally{i(!1)}},u=m=>n.filter(p=>new Date(p.start).toISOString().split("T")[0]===m),f=()=>Ma.getStatus();return W.useEffect(()=>{l();const m=setInterval(l,5*60*1e3);return()=>clearInterval(m)},[]),{events:n,isLoading:t,error:a,fetchEvents:l,getEventsForDate:u,getIntegrationStatus:f}},DE=n=>{const e=["Monday","Tuesday","Wednesday","Thursday","Friday"],i=new Date(n+"T00:00:00").getDay(),o={1:0,2:1,3:2,4:3,5:4}[i];return o!==void 0?e[o]:null},NE=n=>{const e=[],t=new Date(n);t.setHours(0,0,0,0);const i=t.getDay();let a;i===0?a=6:a=i-1;const o=new Date(t);o.setDate(t.getDate()-a);for(let l=0;l<5;l++){const u=new Date(o);u.setDate(o.getDate()+l);const f=u.getFullYear(),m=String(u.getMonth()+1).padStart(2,"0"),p=String(u.getDate()).padStart(2,"0");e.push(`${f}-${m}-${p}`)}return e},OE=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"}),zv=({entries:n,projects:e,onUpdateEntry:t,onDeleteEntry:i,onAddEntry:a})=>{const[o,l]=W.useState(new Date),[u,f]=W.useState(null),[m,p]=W.useState(!1),[v,y]=W.useState(0),[S,_]=W.useState(""),[x,T]=W.useState(!1),[w,E]=W.useState(new Set),[C,N]=W.useState(!1),[A,I]=W.useState(null),[D,z]=W.useState({frequency:"weekly",count:4,skipWeekends:!1}),[L,H]=W.useState(!1),[K,ne]=W.useState({date:new Date().toISOString().split("T")[0],startTime:"09:00",duration:1,project:"",description:"",billable:!0,createSeries:!1,frequency:"weekly",repeatCount:4,skipWeekends:!1}),xe=zo.useCallback(J=>{ne(ke=>({...ke,...J}))},[]),He=zo.useCallback(()=>{T(!1)},[]),_e=zo.useCallback(()=>{L||(N(!1),I(null))},[L]),{getEventsForDate:ie}=jE(),he=NE(o),Ne=J=>{const ke=new Date(o);ke.setDate(ke.getDate()+(J==="next"?7:-7)),l(ke)},Be=()=>{l(new Date)},X=()=>{const ke=new Date().toISOString().split("T")[0];return he.includes(ke)},pe=J=>n.filter(ke=>ke.date===J).sort((ke,$e)=>ke.startTime.localeCompare($e.startTime)),P=J=>{const ke=new Date(J.start).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),$e=new Date(J.end).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),Ve=(new Date(J.end).getTime()-new Date(J.start).getTime())/(1e3*60*60);return d.jsxs("div",{className:"calendar-event-card",children:[d.jsxs("div",{className:"entry-header",children:[d.jsxs("div",{className:"entry-time",children:[ke," - ",$e]}),d.jsx("div",{className:"entry-duration",children:Y(Ve)})]}),d.jsxs("div",{className:"entry-content",children:[d.jsxs("div",{className:"entry-source",children:[d.jsx("div",{className:"source-dot",style:{backgroundColor:"#4285F4"}}),d.jsxs("span",{className:"source-name",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Calendar Event"]})]}),d.jsx("div",{className:"entry-project",children:J.title}),J.description&&d.jsx("div",{className:"entry-description",children:J.description}),d.jsxs("div",{className:"entry-meta",children:[d.jsxs("div",{className:"source-badge",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),d.jsx("span",{children:"Google Calendar"})]}),J.attendees&&J.attendees.length>0&&d.jsxs("span",{className:"meeting-attendees",children:[J.attendees.length," attendees"]}),J.location&&d.jsxs("span",{className:"meeting-location",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),d.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),J.location]})]})]}),d.jsx("div",{className:"entry-actions",children:d.jsxs("button",{className:"btn btn-small btn-primary",onClick:()=>wn(J),title:"Convert to time entry",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),d.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),"Track Time"]})})]},`calendar-${J.id}`)},Y=J=>{const ke=Math.floor(J),$e=Math.round((J-ke)*60);return`${ke}h ${$e}m`},V=J=>pe(J).reduce((ke,$e)=>ke+$e.duration,0),q=()=>he.reduce((J,ke)=>J+V(ke),0),re=(J,ke)=>{t(J,{status:ke})},Me=J=>{f(J),y(J.duration),_(J.description),p(!0)},Ce=()=>{if(u&&S.trim()&&v>0){const J=Le(u.startTime,v);t(u.id,{description:S.trim(),duration:v,endTime:J}),p(!1),f(null),_(""),y(0)}},Le=(J,ke)=>{const[$e,Ve]=J.split(":").map(Number),et=$e*60+Ve+ke*60,dt=Math.floor(et/60)%24,$t=et%60;return`${dt.toString().padStart(2,"0")}:${$t.toString().padStart(2,"0")}`},Ae=J=>{const ke=Math.max(.25,v+J);y(Math.round(ke*4)/4)},ct=(J,ke)=>{const $e=[],Ve=new Date(J.date);for(let et=0;et<ke.count;et++){const dt=new Date(Ve);switch(ke.frequency){case"daily":dt.setDate(Ve.getDate()+et);break;case"weekly":dt.setDate(Ve.getDate()+et*7);break;case"monthly":dt.setMonth(Ve.getMonth()+et);break}if(ke.skipWeekends&&(dt.getDay()===0||dt.getDay()===6)){const $t=dt.getDay()===0?1:2;dt.setDate(dt.getDate()+$t)}$e.push({...J,date:dt.toISOString().split("T")[0]})}return $e},Je=J=>{if(J.preventDefault(),!a)return;const ke=Le(K.startTime,K.duration);K.createSeries?ct({date:K.date,startTime:K.startTime,endTime:ke,duration:K.duration,client:K.client,project:K.project,description:K.description,category:"client",status:"pending",automated:!1,billable:K.billable},{frequency:K.frequency,count:K.repeatCount,skipWeekends:K.skipWeekends}).forEach(Ve=>a(Ve)):a({date:K.date,startTime:K.startTime,endTime:ke,duration:K.duration,client:K.client,project:K.project,description:K.description,category:"client",status:"pending",automated:!1,billable:K.billable}),ne({date:new Date().toISOString().split("T")[0],startTime:"09:00",duration:1,client:"",project:"",description:"",billable:!0,createSeries:!1,frequency:"weekly",repeatCount:4,skipWeekends:!1}),T(!1)},Ht=(J,ke)=>{const $e=new Set(w);ke?$e.add(J):$e.delete(J),E($e)},at=J=>{w.forEach(ke=>{t(ke,{status:J})}),E(new Set)},Gn=J=>{I(J),z({frequency:"weekly",count:4,skipWeekends:!1}),N(!0)},gt=async()=>{if(!(!A||!a)){H(!0);try{const J=[],ke=new Date(A.date);let $e=0;for(let Ve=1;Ve<=D.count&&$e<D.count;Ve++){const et=new Date(ke);switch(D.frequency){case"daily":et.setDate(ke.getDate()+Ve);break;case"weekly":et.setDate(ke.getDate()+Ve*7);break;case"monthly":et.setMonth(ke.getMonth()+Ve);break}if(D.skipWeekends){const dt=et.getDay();if(dt===0||dt===6)continue}J.push({...A,date:et.toISOString().split("T")[0],status:"pending"}),$e++}for(const Ve of J)a(Ve),await new Promise(et=>setTimeout(et,50));setTimeout(()=>{N(!1),I(null),H(!1)},200)}catch(J){console.error("Error generating duplicates:",J),H(!1)}}},Re=()=>{if(!A)return[];const J=new Date(A.date),ke=[];let $e=0;for(let Ve=1;Ve<=D.count&&$e<Math.min(D.count,5);Ve++){const et=new Date(J);switch(D.frequency){case"daily":et.setDate(J.getDate()+Ve);break;case"weekly":et.setDate(J.getDate()+Ve*7);break;case"monthly":et.setMonth(J.getMonth()+Ve);break}if(D.skipWeekends){const dt=et.getDay();if(dt===0||dt===6)continue}ke.push(et),$e++}return ke},wn=J=>{if(!a){console.warn("onAddEntry prop not provided, cannot convert calendar event");return}const ke=new Date(J.start),$e=new Date(J.end),Ve=($e.getTime()-ke.getTime())/(1e3*60*60),{client:et,project:dt}=Rn(J),$t={date:ke.toISOString().split("T")[0],startTime:ke.toTimeString().slice(0,5),endTime:$e.toTimeString().slice(0,5),duration:Ve,client:et,project:dt,description:J.description||J.title,category:"meeting",status:"pending",automated:!0,source:"calendar",meetingType:ei(J),billable:!0,tags:J.attendees?[`${J.attendees.length} attendees`]:void 0};a($t),console.log(" Converted calendar event to time entry:",J.title)},Rn=J=>{const ke=J.title.toLowerCase(),$e=e.find(Ve=>ke.includes(Ve.name.toLowerCase()));if($e)return{client:"",project:$e.name};if(J.attendees&&J.attendees.length>0)for(const Ve of J.attendees){const et=Ve.split("@")[1];if(et){const dt=et.split(".")[0];return{client:"",project:`${dt.charAt(0).toUpperCase()+dt.slice(1)} - Meeting`}}}return{client:"",project:"Calendar Meeting"}},ei=J=>{const ke=J.title.toLowerCase(),$e=(J.description||"").toLowerCase(),Ve=`${ke} ${$e}`;return Ve.includes("kickoff")||Ve.includes("kick-off")?"kickoff":Ve.includes("discovery")||Ve.includes("discovery")?"discovery":Ve.includes("implementation")||Ve.includes("implement")?"implementation":Ve.includes("support")||Ve.includes("help")?"support":Ve.includes("training")||Ve.includes("onboarding")?"training":Ve.includes("check-in")||Ve.includes("checkin")||Ve.includes("status")?"check-in":Ve.includes("escalation")||Ve.includes("urgent")?"escalation":"check-in"},ti=J=>{const ke=Math.floor(J),$e=Math.round((J-ke)*60);return`${ke}h ${$e}m`},Qe=J=>{switch(J){case"pending":return"#f59e0b";case"submitted":return"#3b82f6";case"approved":return"#10b981";case"rejected":return"#ef4444";default:return"#6b7280"}},Fe=()=>n.filter(J=>he.includes(J.date)&&J.status==="pending").length,Ye=()=>{const J=n.filter(ke=>he.includes(ke.date));return J.length>0&&J.every(ke=>ke.status==="approved")},Ze=()=>{n.filter(ke=>he.includes(ke.date)&&ke.status==="approved").forEach(ke=>{t(ke.id,{status:"submitted"})})},Ot=new Date(he[0]),wt=new Date(he[4]),Wt=`${Ot.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${wt.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`;return d.jsxs("div",{children:[d.jsx("div",{className:"dashboard-header",children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",width:"100%"},children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Dashboard"}),d.jsx("p",{className:"dashboard-subtitle",children:"Your weekly time tracking overview with smart automation"})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>Ne("prev"),children:"Previous Week"}),d.jsx("span",{style:{fontWeight:"600",fontSize:"16px",minWidth:"200px",textAlign:"center"},children:Wt}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>Ne("next"),children:"Next Week"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[d.jsx("button",{className:"btn btn-primary",onClick:()=>T(!0),children:"Add Entry"}),!X()&&d.jsx("button",{className:"btn btn-secondary",onClick:Be,children:"Current Week"})]})]})]})}),w.size>0&&d.jsx("div",{className:"content-card",style:{marginBottom:"24px",background:"var(--brand-primary-light)",border:"2px solid var(--brand-primary)"},children:d.jsxs("div",{style:{padding:"16px",display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},children:[d.jsxs("span",{style:{fontWeight:"600",color:"var(--brand-primary)"},children:[w.size," entries selected"]}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>at("pending"),children:"Mark as Pending"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>at("approved"),children:"Mark as Approved"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>E(new Set),children:"Clear Selection"})]})}),d.jsxs("div",{className:"week-summary",children:[d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Total Hours This Week"}),d.jsx("div",{className:"summary-value",children:Y(q())})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Customer-Focused Hours"}),d.jsx("div",{className:"summary-value",children:Y(n.filter(J=>he.includes(J.date)&&J.billable).reduce((J,ke)=>J+ke.duration,0))})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Utilization Rate"}),d.jsxs("div",{className:"summary-value",children:[q()>0?(n.filter(J=>he.includes(J.date)&&J.billable).reduce((J,ke)=>J+ke.duration,0)/q()*100).toFixed(1):0,"%"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("div",{className:"summary-label",children:"Automated Entries"}),d.jsx("div",{className:"summary-value",children:n.filter(J=>he.includes(J.date)&&J.automated).length})]}),d.jsx("div",{className:"submit-actions",children:X()?d.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[d.jsx("button",{className:`btn ${Ye()?"btn-primary":"btn-secondary"}`,onClick:Ye()?Ze:void 0,disabled:!Ye(),title:Ye()?"Submit all approved entries for manager review":`You have ${Fe()} pending entries. Please approve all entries before submitting.`,children:Ye()?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M9 11l3 3 8-8"}),d.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.18 0 2.3.23 3.32.64"})]}),"Submit Week for Review"]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("polyline",{points:"12,6 12,12 16,14"})]}),Fe()," Pending Entries"]})}),!Ye()&&Fe()>0&&d.jsx("div",{className:"tooltip-warning",style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"var(--warning)",color:"white",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",whiteSpace:"nowrap",marginBottom:"8px",opacity:0,animation:"fadeIn 0.3s ease-in-out 2s forwards"},children:"Please approve all entries before submitting"})]}):d.jsx("button",{className:"btn btn-secondary",disabled:!0,children:he[0]>new Date().toISOString().split("T")[0]?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Future Week"]}):n.filter(J=>he.includes(J.date)&&J.status==="submitted").length>0?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M9 11l3 3 8-8"}),d.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.18 0 2.3.23 3.32.64"})]}),"Submitted"]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),d.jsx("polyline",{points:"22,4 12,14.01 9,11.01"})]}),"Past Week"]})})})]}),d.jsx("div",{className:"weekly-grid",children:he.map((J,ke)=>{const $e=pe(J),Ve=ie(J),et=V(J),dt=J===new Date().toISOString().split("T")[0],$t=J<new Date().toISOString().split("T")[0],Yn=J>new Date().toISOString().split("T")[0],Ui=DE(J);return Ui?d.jsxs("div",{className:`day-column ${dt?"today":""} ${$t?"past":""} ${Yn?"future":""}`,children:[d.jsxs("div",{className:"day-header",children:[d.jsxs("div",{className:"day-info",children:[d.jsx("div",{className:"day-name",children:Ui}),d.jsx("div",{className:"day-date",children:OE(J)})]}),d.jsxs("div",{className:"day-total",children:[$e.length>0&&d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"12px",marginBottom:"4px"},children:[d.jsx("input",{type:"checkbox",checked:$e.every(ut=>w.has(ut.id)),onChange:ut=>{$e.forEach(ra=>Ht(ra.id,ut.target.checked))},style:{margin:0}}),"All"]}),et>0&&d.jsx("span",{className:"hours-badge",children:Y(et)}),Yn&&et===0&&d.jsx("span",{className:"future-indicator",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})]})]}),d.jsxs("div",{className:"day-entries",children:[Ve.map(ut=>P(ut)),$e.length===0&&Ve.length===0?d.jsx("div",{className:"no-entries",children:Yn?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),d.jsx("p",{children:"Upcoming - no meetings scheduled"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",ry:"2"}),d.jsx("circle",{cx:"12",cy:"5",r:"2"}),d.jsx("path",{d:"m12 7-3 4 3 4 3-4-3-4z"}),d.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"16"}),d.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"16"})]}),d.jsx("p",{children:"No automated entries detected"})]})}):$e.map(ut=>{const ra=e.find(wi=>wi.name===ut.project);return d.jsxs("div",{className:"time-entry-card",children:[d.jsxs("div",{className:"entry-header",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("input",{type:"checkbox",checked:w.has(ut.id),onChange:wi=>Ht(ut.id,wi.target.checked),style:{margin:0}}),d.jsx("div",{className:"entry-time",children:Tm(ut.startTime,ut.endTime)})]}),d.jsx("div",{className:"entry-duration",children:Y(ut.duration)})]}),d.jsxs("div",{className:"entry-content",children:[d.jsxs("div",{className:"entry-project-info",children:[d.jsx("div",{className:"project-dot",style:{backgroundColor:ra?.color||"#6366f1"}}),d.jsx("span",{className:"project-name",children:ut.project})]}),d.jsx("div",{className:"entry-description",children:ut.description}),d.jsxs("div",{className:"entry-meta",children:[ut.automated&&d.jsxs("div",{className:"source-badge",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",ry:"2"}),d.jsx("circle",{cx:"12",cy:"5",r:"2"}),d.jsx("path",{d:"m12 7-3 4 3 4 3-4-3-4z"}),d.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"16"}),d.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"16"})]}),d.jsx("span",{children:ut.source||"Auto"})]}),ut.meetingType&&d.jsx("span",{className:"meeting-type",children:ut.meetingType.replace("-"," ")}),d.jsx("span",{className:`billable-badge ${ut.billable?"billable":"non-billable"}`,children:ut.billable?"Billable":"Non-billable"})]})]}),d.jsxs("div",{className:"entry-actions",children:[d.jsxs("select",{value:ut.status==="submitted"||ut.status==="rejected"?"approved":ut.status,onChange:wi=>re(ut.id,wi.target.value),className:"status-select",style:{borderColor:Qe(ut.status)},children:[d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"approved",children:"Approved"})]}),d.jsx("button",{className:"btn btn-small btn-secondary",onClick:()=>Me(ut),title:"Edit entry",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),d.jsx("path",{d:"m15 5 4 4"})]})}),d.jsx("button",{className:"btn btn-small btn-secondary",onClick:()=>Gn(ut),title:"Duplicate for recurring meetings",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),d.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"})]})}),d.jsx("button",{className:"btn btn-small btn-danger",onClick:()=>{confirm("Delete this entry?")&&i(ut.id)},children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3,6 5,6 21,6"}),d.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]},ut.id)})]})]},J):null})}),m&&u&&d.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:d.jsxs("div",{className:"modal-content",onClick:J=>J.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"8px"},children:[d.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),d.jsx("path",{d:"m15 5 4 4"})]}),"Edit Time Entry"]}),d.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:""})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{background:"var(--background-secondary)",padding:"16px",borderRadius:"8px",marginBottom:"24px"},children:[d.jsxs("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",color:"var(--text-primary)"},children:[u.project,"  ",u.client]}),d.jsxs("div",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:[new Date(u.date).toLocaleDateString(),"  ",Tm(u.startTime,u.endTime)]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"24px"},children:[d.jsx("label",{style:{fontWeight:"600",marginBottom:"8px",display:"block"},children:"Description:"}),d.jsx("textarea",{value:S,onChange:J=>_(J.target.value),className:"form-input",rows:3,placeholder:"Describe what you worked on...",style:{width:"100%",resize:"vertical"}})]}),d.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:"24px"},children:[d.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",color:"var(--text-primary)"},children:"Duration"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"var(--brand-primary)",marginBottom:"16px",textAlign:"center"},children:ti(v)}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsxs("div",{style:{marginBottom:"12px"},children:[d.jsx("label",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",display:"block",textAlign:"center"},children:"Subtract Time"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>Ae(-.25),disabled:v<=.25,style:{fontSize:"12px",padding:"8px 4px"},children:" 15min"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>Ae(-.5),disabled:v<=.5,style:{fontSize:"12px",padding:"8px 4px"},children:" 30min"}),d.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>Ae(-1),disabled:v<=1,style:{fontSize:"12px",padding:"8px 4px"},children:" 1hr"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",display:"block",textAlign:"center"},children:"Add Time"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>Ae(.25),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 15min"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>Ae(.5),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 30min"}),d.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>Ae(1),style:{fontSize:"12px",padding:"8px 4px"},children:"+ 1hr"})]})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{fontWeight:"600",marginBottom:"8px",display:"block"},children:"Exact duration (hours):"}),d.jsx("input",{type:"number",min:"0.25",max:"24",step:"0.25",value:v,onChange:J=>{const ke=parseFloat(J.target.value)||.25;y(Math.max(.25,Math.round(ke*4)/4))},className:"form-input",style:{textAlign:"center"}})]}),d.jsx("div",{style:{background:"var(--info-light)",padding:"12px",borderRadius:"8px",marginTop:"12px"},children:d.jsxs("p",{style:{fontSize:"14px",color:"var(--info-dark)",margin:0,textAlign:"center"},children:[d.jsx("strong",{children:"New time:"})," ",u.startTime," - ",Le(u.startTime,v)]})})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>p(!1),children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:Ce,disabled:!S.trim()||v<=0,children:"Save Changes"})]})]})}),x&&d.jsx("div",{className:"modal-overlay",onClick:He,children:d.jsxs("div",{className:"modal-content",onClick:J=>J.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsxs("h3",{children:[d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"8px",filter:"drop-shadow(0 2px 4px rgba(99, 102, 241, 0.3))"},children:[d.jsx("defs",{children:d.jsxs("linearGradient",{id:"lightning-dashboard",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:1}}),d.jsx("stop",{offset:"50%",style:{stopColor:"#6366f1",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#3b82f6",stopOpacity:1}})]})}),d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",fill:"url(#lightning-dashboard)",stroke:"url(#lightning-dashboard)"})]}),"Quick Time Entry"]}),d.jsx("button",{className:"modal-close",onClick:He,children:""})]}),d.jsx("div",{className:"modal-body",children:d.jsxs("form",{onSubmit:Je,children:[d.jsxs("div",{className:"form-group",style:{marginBottom:"24px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",display:"block"},children:"How long did you work?"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px",marginBottom:"16px"},children:[.5,1,2,4].map(J=>d.jsx("button",{type:"button",className:`btn ${K.duration===J?"btn-primary":"btn-secondary"}`,onClick:()=>ne({...K,duration:J}),style:{padding:"12px 8px",fontSize:"14px",fontWeight:"600"},children:J===.5?"30min":`${J}h`},J))}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[6,8,"custom"].map(J=>d.jsx("button",{type:"button",className:`btn ${J==="custom"?[.5,1,2,4,6,8].includes(K.duration)?"btn-secondary":"btn-primary":K.duration===J?"btn-primary":"btn-secondary"}`,onClick:()=>{if(J==="custom"){const ke=prompt("Enter duration in hours (e.g., 1.5):");ke&&!isNaN(parseFloat(ke))&&ne({...K,duration:parseFloat(ke)})}else ne({...K,duration:J})},style:{padding:"12px 8px",fontSize:"14px",fontWeight:"600"},children:J==="custom"?"Other":`${J}h`},J))}),![.5,1,2,4,6,8].includes(K.duration)&&d.jsxs("div",{style:{marginTop:"12px",padding:"8px 12px",background:"var(--brand-primary-light)",borderRadius:"6px",textAlign:"center",fontSize:"14px",fontWeight:"600",color:"var(--brand-primary)"},children:[K.duration,"h selected"]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"Project"}),d.jsxs("select",{value:K.project,onChange:J=>ne({...K,project:J.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"},children:[d.jsx("option",{value:"",children:"Select project..."}),e.filter(J=>J.active).map(J=>d.jsx("option",{value:J.name,children:J.name},J.id))]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"When did this happen?"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Date"}),d.jsx("input",{type:"date",value:K.date,onChange:J=>xe({date:J.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Start Time"}),d.jsx("input",{type:"time",value:K.startTime,onChange:J=>ne({...K,startTime:J.target.value}),className:"form-input",required:!0,style:{fontSize:"14px"}})]})]})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsx("label",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"8px",display:"block"},children:"What did you work on?"}),d.jsx("textarea",{value:K.description,onChange:J=>ne({...K,description:J.target.value}),className:"form-input",rows:2,placeholder:"Brief description of work completed...",required:!0,style:{fontSize:"14px"}})]}),d.jsxs("div",{className:"form-group",style:{marginBottom:"20px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"600",marginBottom:"12px"},children:[d.jsx("input",{type:"checkbox",checked:K.createSeries||!1,onChange:J=>ne({...K,createSeries:J.target.checked})}),d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("polyline",{points:"23,4 23,10 17,10"}),d.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),"Create recurring entries"]}),K.createSeries&&d.jsxs("div",{style:{padding:"16px",background:"var(--brand-primary-light)",borderRadius:"8px",border:"1px solid var(--brand-primary)"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Frequency"}),d.jsxs("select",{value:K.frequency||"weekly",onChange:J=>ne({...K,frequency:J.target.value}),className:"form-input",style:{fontSize:"14px"},children:[d.jsx("option",{value:"daily",children:"Daily"}),d.jsx("option",{value:"weekly",children:"Weekly"}),d.jsx("option",{value:"monthly",children:"Monthly"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{fontSize:"14px",marginBottom:"4px",display:"block"},children:"Count"}),d.jsx("input",{type:"number",min:"2",max:"52",value:K.repeatCount||4,onChange:J=>ne({...K,repeatCount:parseInt(J.target.value)||4}),className:"form-input",style:{fontSize:"14px"}})]}),d.jsx("div",{style:{display:"flex",alignItems:"end"},children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:K.skipWeekends||!0,onChange:J=>ne({...K,skipWeekends:J.target.checked})}),"Skip weekends"]})})]}),d.jsxs("div",{style:{fontSize:"13px",color:"var(--brand-primary)",fontWeight:"500",textAlign:"center"},children:["Will create ",K.repeatCount||4," entries ",K.frequency==="daily"?"daily":K.frequency==="weekly"?"weekly":"monthly",K.skipWeekends?", skipping weekends":""]})]})]}),d.jsxs("details",{style:{marginBottom:"20px"},children:[d.jsxs("summary",{style:{cursor:"pointer",fontSize:"14px",color:"var(--text-secondary)",marginBottom:"12px"},children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),"Additional Options"]}),d.jsx("div",{style:{padding:"12px",background:"var(--background-secondary)",borderRadius:"8px"},children:d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:K.billable,onChange:J=>ne({...K,billable:J.target.checked})}),"Billable to client"]})})})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{type:"button",className:"btn btn-secondary",onClick:He,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"btn btn-primary",style:{fontSize:"16px",padding:"12px 24px"},children:[d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"4px"},children:d.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Create Entry"]})]})]})})]})}),C&&A&&d.jsx("div",{className:"modal-overlay",onClick:_e,children:d.jsxs("div",{className:"modal-content duplicate-modal",onClick:J=>J.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:" Create Recurring Time Entries"}),d.jsx("button",{className:"modal-close",onClick:_e,disabled:L,children:""})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{className:"duplicate-preview-card",children:[d.jsxs("div",{className:"preview-header",children:[d.jsx("span",{className:"preview-icon",children:""}),d.jsxs("div",{children:[d.jsxs("h4",{className:"preview-title",children:[A.project,"  ",A.client]}),d.jsxs("div",{className:"preview-details",children:[new Date(A.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"}),"  ",Tm(A.startTime,A.endTime),"  ",Y(A.duration)]})]})]}),d.jsx("div",{className:"preview-description",children:A.description})]}),d.jsxs("div",{className:"duplicate-settings",children:[d.jsxs("div",{className:"settings-grid",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:" Frequency"}),d.jsxs("select",{value:D.frequency,onChange:J=>z({...D,frequency:J.target.value}),className:"form-input",disabled:L,children:[d.jsx("option",{value:"daily",children:" Daily"}),d.jsx("option",{value:"weekly",children:" Weekly"}),d.jsx("option",{value:"monthly",children:" Monthly"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{children:" Count"}),d.jsxs("div",{className:"count-input-wrapper",children:[d.jsx("input",{type:"number",min:"1",max:"52",value:D.count,onChange:J=>z({...D,count:parseInt(J.target.value)||1}),className:"form-input",disabled:L}),d.jsx("span",{className:"count-label",children:"occurrences"})]})]})]}),d.jsx("div",{className:"form-group",children:d.jsxs("label",{className:"checkbox-label",children:[d.jsx("input",{type:"checkbox",checked:D.skipWeekends,onChange:J=>z({...D,skipWeekends:J.target.checked}),disabled:L}),d.jsx("span",{className:"checkbox-text",children:" Skip weekends (Saturday & Sunday)"})]})})]}),d.jsxs("div",{className:"dates-preview",children:[d.jsx("h4",{className:"preview-section-title",children:" Upcoming dates preview:"}),d.jsxs("div",{className:"dates-list",children:[Re().map((J,ke)=>d.jsxs("div",{className:"date-item",children:[d.jsx("span",{className:"date-number",children:ke+1}),d.jsx("span",{className:"date-text",children:J.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]},ke)),D.count>5&&d.jsxs("div",{className:"date-item more-dates",children:[d.jsx("span",{className:"date-number",children:"..."}),d.jsxs("span",{className:"date-text",children:["+",D.count-5," more dates"]})]})]})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:_e,disabled:L,children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:gt,disabled:L,children:L?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"spinner",children:""}),"Creating..."]}):d.jsxs(d.Fragment,{children:[" Create ",D.count," Duplicates"]})})]})]})})]})},fa=n=>{const e=Math.floor(n),t=Math.round((n-e)*60);return`${e}h ${t}m`},ac=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),RE=({entries:n,projects:e})=>{const[t,i]=W.useState("thisWeek"),[a,o]=W.useState(""),[l,u]=W.useState(""),[f,m]=W.useState([]),[p,v]=W.useState("overview"),y=()=>{const E=new Date;let C,N;switch(t){case"today":C=N=new Date(E);break;case"yesterday":C=N=new Date(E.getTime()-24*60*60*1e3);break;case"thisWeek":const A=new Date(E);A.setDate(E.getDate()-E.getDay()+1),C=A,N=new Date(A.getTime()+4*24*60*60*1e3);break;case"lastWeek":const I=new Date(E);I.setDate(E.getDate()-E.getDay()-6),C=I,N=new Date(I.getTime()+4*24*60*60*1e3);break;case"thisMonth":C=new Date(E.getFullYear(),E.getMonth(),1),N=new Date(E.getFullYear(),E.getMonth()+1,0);break;case"lastMonth":C=new Date(E.getFullYear(),E.getMonth()-1,1),N=new Date(E.getFullYear(),E.getMonth(),0);break;case"custom":C=a?new Date(a):new Date,N=l?new Date(l):new Date;break;default:C=N=E}return{start:C.toISOString().split("T")[0],end:N.toISOString().split("T")[0]}},S=W.useMemo(()=>{const E=y();return n.filter(C=>{const N=C.date,A=N>=E.start&&N<=E.end,I=f.length===0||f.includes(C.project);return A&&I})},[n,t,a,l,f]),_=W.useMemo(()=>{const E=S.reduce((L,H)=>L+H.duration,0),C=S.filter(L=>L.billable).reduce((L,H)=>L+H.duration,0),N=S.filter(L=>L.status==="approved"&&L.billable).reduce((L,H)=>{const K=e.find(xe=>xe.name===H.project),ne=H.rate||K?.rate||0;return L+H.duration*ne},0),A=E>0?C/E*100:0,I=E/Math.max(1,new Set(S.map(L=>L.date)).size),D=S.reduce((L,H)=>{if(L[H.project]||(L[H.project]={hours:0,earnings:0,count:0}),L[H.project].hours+=H.duration,L[H.project].count+=1,H.status==="approved"&&H.billable){const K=e.find(xe=>xe.name===H.project),ne=H.rate||K?.rate||0;L[H.project].earnings+=H.duration*ne}return L},{}),z=S.reduce((L,H)=>(L[H.status]=(L[H.status]||0)+H.duration,L),{});return{totalHours:E,billableHours:C,totalEarnings:N,utilizationRate:A,avgHoursPerDay:I,projectStats:D,statusStats:z,totalEntries:S.length,automatedEntries:S.filter(L=>L.automated).length}},[S,e]),x=()=>{const E=["Date","Start","End","Duration","Client","Project","Description","Status","Billable","Earnings"],C=S.map(D=>{const z=e.find(K=>K.name===D.project),L=D.rate||z?.rate||0,H=D.status==="approved"&&D.billable?D.duration*L:0;return[D.date,D.startTime,D.endTime,D.duration,D.client,D.project,`"${D.description.replace(/"/g,'""')}"`,D.status,D.billable?"Yes":"No",H.toFixed(2)]}),N=[E.join(","),...C.map(D=>D.join(","))].join(`
`),A=new Blob([N],{type:"text/csv"}),I=document.createElement("a");I.href=URL.createObjectURL(A),I.download=`timebeacon-report-${y().start}-to-${y().end}.csv`,I.click()},T=({data:E,title:C,total:N})=>{const A=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];let I=0;return d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{className:"chart-title",children:C}),d.jsxs("div",{className:"donut-chart-wrapper",children:[d.jsxs("svg",{width:"200",height:"200",viewBox:"0 0 200 200",children:[Object.entries(E).sort(([,D],[,z])=>z-D).slice(0,6).map(([D,z],L)=>{const K=z/N*100/100*360,ne=K>180?1:0,xe=I*Math.PI/180,He=(I+K)*Math.PI/180,_e=100+70*Math.cos(xe),ie=100+70*Math.sin(xe),he=100+70*Math.cos(He),Ne=100+70*Math.sin(He),Be=["M 100 100",`L ${_e} ${ie}`,`A 70 70 0 ${ne} 1 ${he} ${Ne}`,"Z"].join(" ");return I+=K,d.jsx("path",{d:Be,fill:A[L%A.length],stroke:"white",strokeWidth:"2"},D)}),d.jsx("circle",{cx:"100",cy:"100",r:"35",fill:"white"}),d.jsx("text",{x:"100",y:"95",textAnchor:"middle",fontSize:"14",fontWeight:"bold",children:fa(N)}),d.jsx("text",{x:"100",y:"110",textAnchor:"middle",fontSize:"12",fill:"#666",children:"Total"})]}),d.jsx("div",{className:"chart-legend",children:Object.entries(E).sort(([,D],[,z])=>z-D).slice(0,6).map(([D,z],L)=>d.jsxs("div",{className:"legend-item",children:[d.jsx("div",{className:"legend-color",style:{backgroundColor:A[L%A.length]}}),d.jsx("span",{className:"legend-label",children:D}),d.jsxs("span",{className:"legend-value",children:[fa(z)," (",(z/N*100).toFixed(1),"%)"]})]},D))})]})]})},w=({data:E,title:C,type:N="hours"})=>{const A=Math.max(...Object.values(E).map(D=>N==="hours"?D.hours||D:D.earnings||D)),I=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];return d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{className:"chart-title",children:C}),d.jsx("div",{className:"bar-chart",children:Object.entries(E).sort(([,D],[,z])=>{const L=N==="hours"?D.hours||D:D.earnings||D;return(N==="hours"?z.hours||z:z.earnings||z)-L}).slice(0,8).map(([D,z],L)=>{const H=N==="hours"?z.hours||z:z.earnings||z,K=H/A*150;return d.jsxs("div",{className:"bar-item",children:[d.jsx("div",{className:"bar-label",children:D.length>12?D.substring(0,12)+"...":D}),d.jsx("div",{className:"bar-container",children:d.jsx("div",{className:"bar-fill",style:{height:`${K}px`,backgroundColor:I[L%I.length]}})}),d.jsx("div",{className:"bar-value",children:N==="hours"?fa(H):ac(H)})]},D)})})]})};return d.jsxs("div",{className:"reports-page",children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Reports & Analytics"}),d.jsx("p",{className:"dashboard-subtitle",children:"Comprehensive insights into your time tracking"})]}),d.jsx("div",{className:"header-actions",children:d.jsx("button",{className:"btn btn-secondary",onClick:x,children:" Export CSV"})})]}),d.jsxs("div",{className:"content-card filters-card",children:[d.jsx("div",{className:"card-header",children:d.jsx("h2",{className:"card-title",children:"Filters & Date Range"})}),d.jsxs("div",{className:"filters-content",children:[d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:"Time Period"}),d.jsx("div",{className:"date-range-buttons",children:[{key:"today",label:"Today"},{key:"yesterday",label:"Yesterday"},{key:"thisWeek",label:"This Week"},{key:"lastWeek",label:"Last Week"},{key:"thisMonth",label:"This Month"},{key:"lastMonth",label:"Last Month"},{key:"custom",label:"Custom"}].map(E=>d.jsx("button",{className:`btn ${t===E.key?"btn-primary":"btn-secondary"}`,onClick:()=>i(E.key),children:E.label},E.key))}),t==="custom"&&d.jsxs("div",{className:"custom-date-inputs",children:[d.jsx("input",{type:"date",value:a,onChange:E=>o(E.target.value),className:"form-input"}),d.jsx("span",{children:"to"}),d.jsx("input",{type:"date",value:l,onChange:E=>u(E.target.value),className:"form-input"})]})]}),d.jsxs("div",{className:"filter-group",children:[d.jsx("label",{children:"Projects"}),d.jsxs("select",{multiple:!0,value:f,onChange:E=>m(Array.from(E.target.selectedOptions,C=>C.value)),className:"form-input projects-select",children:[d.jsx("option",{value:"",children:"All Projects"}),e.map(E=>d.jsxs("option",{value:E.name,children:[E.name," (",E.client,")"]},E.name))]}),d.jsx("small",{children:"Hold Ctrl/Cmd to select multiple projects"})]})]})]}),d.jsxs("div",{className:"metrics-grid",children:[d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:fa(_.totalHours)}),d.jsx("div",{className:"metric-label",children:"Total Hours"}),d.jsxs("div",{className:"metric-detail",children:[_.totalEntries," entries"]})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:ac(_.totalEarnings)}),d.jsx("div",{className:"metric-label",children:"Total Earnings"}),d.jsxs("div",{className:"metric-detail",children:[fa(_.billableHours)," billable"]})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsxs("div",{className:"metric-value",children:[_.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"metric-label",children:"Utilization Rate"}),d.jsx("div",{className:"metric-detail",children:"Billable vs total time"})]})]}),d.jsxs("div",{className:"metric-card",children:[d.jsx("div",{className:"metric-icon",children:""}),d.jsxs("div",{className:"metric-content",children:[d.jsx("div",{className:"metric-value",children:fa(_.avgHoursPerDay)}),d.jsx("div",{className:"metric-label",children:"Avg. Hours/Day"}),d.jsxs("div",{className:"metric-detail",children:[_.automatedEntries," automated"]})]})]})]}),d.jsx("div",{className:"chart-navigation",children:[{key:"overview",label:" Overview",desc:"Key metrics and summaries"},{key:"projects",label:" Projects",desc:"Time breakdown by project"},{key:"status",label:" Status",desc:"Entry status analysis"},{key:"trends",label:" Trends",desc:"Daily and weekly patterns"},{key:"utilization",label:" Utilization",desc:"Billable vs non-billable"}].map(E=>d.jsxs("button",{className:`chart-nav-btn ${p===E.key?"active":""}`,onClick:()=>v(E.key),children:[d.jsx("div",{className:"chart-nav-label",children:E.label}),d.jsx("div",{className:"chart-nav-desc",children:E.desc})]},E.key))}),d.jsxs("div",{className:"chart-display-area",children:[p==="overview"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(T,{data:Object.fromEntries(Object.entries(_.projectStats).map(([E,C])=>[E,C.hours])),title:"Hours by Project",total:_.totalHours}),d.jsx(w,{data:_.projectStats,title:"Earnings by Project",type:"currency"})]}),p==="projects"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(w,{data:_.projectStats,title:"Hours by Project",type:"hours"}),d.jsxs("div",{className:"project-details-table",children:[d.jsx("h3",{children:"Project Details"}),d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Hours"}),d.jsx("th",{children:"Entries"}),d.jsx("th",{children:"Earnings"}),d.jsx("th",{children:"Avg Rate"})]})}),d.jsx("tbody",{children:Object.entries(_.projectStats).sort(([,E],[,C])=>C.hours-E.hours).map(([E,C])=>d.jsxs("tr",{children:[d.jsx("td",{children:E}),d.jsx("td",{children:fa(C.hours)}),d.jsx("td",{children:C.count}),d.jsx("td",{children:ac(C.earnings)}),d.jsx("td",{children:C.hours>0?ac(C.earnings/C.hours):"$0"})]},E))})]})]})]}),p==="status"&&d.jsxs("div",{className:"charts-grid",children:[d.jsx(T,{data:_.statusStats,title:"Hours by Status",total:_.totalHours}),d.jsxs("div",{className:"status-details",children:[d.jsx("h3",{children:"Status Breakdown"}),d.jsx("div",{className:"status-cards",children:Object.entries(_.statusStats).sort(([,E],[,C])=>C-E).map(([E,C])=>d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-name",children:E.charAt(0).toUpperCase()+E.slice(1)}),d.jsx("div",{className:"status-hours",children:fa(C)}),d.jsxs("div",{className:"status-percentage",children:[(C/_.totalHours*100).toFixed(1),"%"]})]},E))})]})]}),p==="utilization"&&d.jsxs("div",{className:"utilization-analysis",children:[d.jsxs("div",{className:"utilization-overview",children:[d.jsx("div",{className:"utilization-gauge",children:d.jsx("div",{className:"gauge-container",children:d.jsx("div",{className:"gauge-fill",style:{background:`conic-gradient(#3b82f6 0deg ${_.utilizationRate/100*360}deg, #e5e7eb ${_.utilizationRate/100*360}deg 360deg)`},children:d.jsxs("div",{className:"gauge-center",children:[d.jsxs("div",{className:"gauge-value",children:[_.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"gauge-label",children:"Utilization"})]})})})}),d.jsxs("div",{className:"utilization-breakdown",children:[d.jsxs("div",{className:"breakdown-item billable",children:[d.jsx("div",{className:"breakdown-color"}),d.jsx("div",{className:"breakdown-label",children:"Billable Hours"}),d.jsx("div",{className:"breakdown-value",children:fa(_.billableHours)})]}),d.jsxs("div",{className:"breakdown-item non-billable",children:[d.jsx("div",{className:"breakdown-color"}),d.jsx("div",{className:"breakdown-label",children:"Non-billable Hours"}),d.jsx("div",{className:"breakdown-value",children:fa(_.totalHours-_.billableHours)})]})]})]}),d.jsxs("div",{className:"utilization-tips",children:[d.jsx("h4",{children:" Optimization Tips"}),d.jsxs("div",{className:"tips-list",children:[_.utilizationRate<60&&d.jsx("div",{className:"tip warning",children:" Low utilization rate. Consider focusing more time on billable client work."}),_.utilizationRate>=80&&d.jsx("div",{className:"tip success",children:" Excellent utilization rate! You're maximizing billable time."}),_.automatedEntries/_.totalEntries>.7&&d.jsxs("div",{className:"tip info",children:[" Great automation usage! ",(_.automatedEntries/_.totalEntries*100).toFixed(0),"% of entries are automated."]})]})]})]})]}),d.jsxs("div",{className:"content-card data-table-card",children:[d.jsx("div",{className:"card-header",children:d.jsxs("h2",{className:"card-title",children:["Time Entries (",S.length,")"]})}),d.jsxs("div",{className:"table-container",children:[d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Time"}),d.jsx("th",{children:"Duration"}),d.jsx("th",{children:"Client"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Billable"}),d.jsx("th",{children:"Earnings"})]})}),d.jsx("tbody",{children:S.sort((E,C)=>new Date(C.date+" "+C.startTime).getTime()-new Date(E.date+" "+E.startTime).getTime()).slice(0,100).map((E,C)=>{const N=e.find(D=>D.name===E.project),A=E.rate||N?.rate||0,I=E.status==="approved"&&E.billable?E.duration*A:0;return d.jsxs("tr",{children:[d.jsx("td",{children:new Date(E.date).toLocaleDateString()}),d.jsxs("td",{className:"time-cell",children:[E.startTime," - ",E.endTime]}),d.jsx("td",{children:fa(E.duration)}),d.jsx("td",{children:E.client}),d.jsx("td",{children:E.project}),d.jsx("td",{className:"description-cell",children:E.description}),d.jsx("td",{children:d.jsx("span",{className:`status-badge status-${E.status}`,children:E.status})}),d.jsx("td",{children:d.jsx("span",{className:`billable-badge ${E.billable?"billable":"non-billable"}`,children:E.billable?"Yes":"No"})}),d.jsx("td",{children:ac(I)})]},E.id||C)})})]}),S.length>100&&d.jsxs("div",{className:"table-footer",children:["Showing first 100 of ",S.length," entries. Export to CSV for complete data."]})]})]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Yc(n){return n+.5|0}const Yr=(n,e,t)=>Math.max(Math.min(n,t),e);function mc(n){return Yr(Yc(n*2.55),0,255)}function Zr(n){return Yr(Yc(n*255),0,255)}function sr(n){return Yr(Yc(n/2.55)/100,0,1)}function Hv(n){return Yr(Yc(n*100),0,100)}const Qi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},$m=[..."0123456789ABCDEF"],ME=n=>$m[n&15],LE=n=>$m[(n&240)>>4]+$m[n&15],od=n=>(n&240)>>4===(n&15),IE=n=>od(n.r)&&od(n.g)&&od(n.b)&&od(n.a);function PE(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Qi[n[1]]*17,g:255&Qi[n[2]]*17,b:255&Qi[n[3]]*17,a:e===5?Qi[n[4]]*17:255}:(e===7||e===9)&&(t={r:Qi[n[1]]<<4|Qi[n[2]],g:Qi[n[3]]<<4|Qi[n[4]],b:Qi[n[5]]<<4|Qi[n[6]],a:e===9?Qi[n[7]]<<4|Qi[n[8]]:255})),t}const BE=(n,e)=>n<255?e(n):"";function FE(n){var e=IE(n)?ME:LE;return n?"#"+e(n.r)+e(n.g)+e(n.b)+BE(n.a,e):void 0}const UE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function ub(n,e,t){const i=e*Math.min(t,1-t),a=(o,l=(o+n/30)%12)=>t-i*Math.max(Math.min(l-3,9-l,1),-1);return[a(0),a(8),a(4)]}function zE(n,e,t){const i=(a,o=(a+n/60)%6)=>t-t*e*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function HE(n,e,t){const i=ub(n,1,.5);let a;for(e+t>1&&(a=1/(e+t),e*=a,t*=a),a=0;a<3;a++)i[a]*=1-e-t,i[a]+=e;return i}function WE(n,e,t,i,a){return n===a?(e-t)/i+(e<t?6:0):e===a?(t-n)/i+2:(n-e)/i+4}function gp(n){const t=n.r/255,i=n.g/255,a=n.b/255,o=Math.max(t,i,a),l=Math.min(t,i,a),u=(o+l)/2;let f,m,p;return o!==l&&(p=o-l,m=u>.5?p/(2-o-l):p/(o+l),f=WE(t,i,a,p,o),f=f*60+.5),[f|0,m||0,u]}function vp(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(Zr)}function yp(n,e,t){return vp(ub,n,e,t)}function VE(n,e,t){return vp(HE,n,e,t)}function GE(n,e,t){return vp(zE,n,e,t)}function db(n){return(n%360+360)%360}function YE(n){const e=UE.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?mc(+e[5]):Zr(+e[5]));const a=db(+e[2]),o=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?i=VE(a,o,l):e[1]==="hsv"?i=GE(a,o,l):i=yp(a,o,l),{r:i[0],g:i[1],b:i[2],a:t}}function XE(n,e){var t=gp(n);t[0]=db(t[0]+e),t=yp(t),n.r=t[0],n.g=t[1],n.b=t[2]}function $E(n){if(!n)return;const e=gp(n),t=e[0],i=Hv(e[1]),a=Hv(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${a}%, ${sr(n.a)})`:`hsl(${t}, ${i}%, ${a}%)`}const Wv={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Vv={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qE(){const n={},e=Object.keys(Vv),t=Object.keys(Wv);let i,a,o,l,u;for(i=0;i<e.length;i++){for(l=u=e[i],a=0;a<t.length;a++)o=t[a],u=u.replace(o,Wv[o]);o=parseInt(Vv[l],16),n[u]=[o>>16&255,o>>8&255,o&255]}return n}let ld;function KE(n){ld||(ld=qE(),ld.transparent=[0,0,0,0]);const e=ld[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const ZE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function QE(n){const e=ZE.exec(n);let t=255,i,a,o;if(e){if(e[7]!==i){const l=+e[7];t=e[8]?mc(l):Yr(l*255,0,255)}return i=+e[1],a=+e[3],o=+e[5],i=255&(e[2]?mc(i):Yr(i,0,255)),a=255&(e[4]?mc(a):Yr(a,0,255)),o=255&(e[6]?mc(o):Yr(o,0,255)),{r:i,g:a,b:o,a:t}}}function JE(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${sr(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Em=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Ro=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function e4(n,e,t){const i=Ro(sr(n.r)),a=Ro(sr(n.g)),o=Ro(sr(n.b));return{r:Zr(Em(i+t*(Ro(sr(e.r))-i))),g:Zr(Em(a+t*(Ro(sr(e.g))-a))),b:Zr(Em(o+t*(Ro(sr(e.b))-o))),a:n.a+t*(e.a-n.a)}}function cd(n,e,t){if(n){let i=gp(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=yp(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function fb(n,e){return n&&Object.assign(e||{},n)}function Gv(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Zr(n[3]))):(e=fb(n,{r:0,g:0,b:0,a:1}),e.a=Zr(e.a)),e}function t4(n){return n.charAt(0)==="r"?QE(n):YE(n)}class jc{constructor(e){if(e instanceof jc)return e;const t=typeof e;let i;t==="object"?i=Gv(e):t==="string"&&(i=PE(e)||KE(e)||t4(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=fb(this._rgb);return e&&(e.a=sr(e.a)),e}set rgb(e){this._rgb=Gv(e)}rgbString(){return this._valid?JE(this._rgb):void 0}hexString(){return this._valid?FE(this._rgb):void 0}hslString(){return this._valid?$E(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,a=e.rgb;let o;const l=t===o?.5:t,u=2*l-1,f=i.a-a.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;o=1-m,i.r=255&m*i.r+o*a.r+.5,i.g=255&m*i.g+o*a.g+.5,i.b=255&m*i.b+o*a.b+.5,i.a=l*i.a+(1-l)*a.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=e4(this._rgb,e._rgb,t)),this}clone(){return new jc(this.rgb)}alpha(e){return this._rgb.a=Zr(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Yc(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return cd(this._rgb,2,e),this}darken(e){return cd(this._rgb,2,-e),this}saturate(e){return cd(this._rgb,1,e),this}desaturate(e){return cd(this._rgb,1,-e),this}rotate(e){return XE(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function ir(){}const n4=(()=>{let n=0;return()=>n++})();function mt(n){return n==null}function Qt(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function pt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Si(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function ja(n,e){return Si(n)?n:e}function it(n,e){return typeof n>"u"?e:n}const i4=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,hb=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function zt(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function jt(n,e,t,i){let a,o,l;if(Qt(n))for(o=n.length,a=0;a<o;a++)e.call(t,n[a],a);else if(pt(n))for(l=Object.keys(n),o=l.length,a=0;a<o;a++)e.call(t,n[l[a]],l[a])}function Id(n,e){let t,i,a,o;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(a=n[t],o=e[t],a.datasetIndex!==o.datasetIndex||a.index!==o.index)return!1;return!0}function Pd(n){if(Qt(n))return n.map(Pd);if(pt(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let a=0;for(;a<i;++a)e[t[a]]=Pd(n[t[a]]);return e}return n}function mb(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function a4(n,e,t,i){if(!mb(n))return;const a=e[n],o=t[n];pt(a)&&pt(o)?Dc(a,o,i):e[n]=Pd(o)}function Dc(n,e,t){const i=Qt(e)?e:[e],a=i.length;if(!pt(n))return n;t=t||{};const o=t.merger||a4;let l;for(let u=0;u<a;++u){if(l=i[u],!pt(l))continue;const f=Object.keys(l);for(let m=0,p=f.length;m<p;++m)o(f[m],n,l,t)}return n}function yc(n,e){return Dc(n,e,{merger:r4})}function r4(n,e,t){if(!mb(n))return;const i=e[n],a=t[n];pt(i)&&pt(a)?yc(i,a):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Pd(a))}const Yv={"":n=>n,x:n=>n.x,y:n=>n.y};function s4(n){const e=n.split("."),t=[];let i="";for(const a of e)i+=a,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function o4(n){const e=s4(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function Qr(n,e){return(Yv[e]||(Yv[e]=o4(e)))(n)}function xp(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Nc=n=>typeof n<"u",Jr=n=>typeof n=="function",Xv=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function l4(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Tt=Math.PI,Yt=2*Tt,c4=Yt+Tt,Bd=Number.POSITIVE_INFINITY,u4=Tt/180,cn=Tt/2,js=Tt/4,$v=Tt*2/3,pb=Math.log10,Ia=Math.sign;function xc(n,e,t){return Math.abs(n-e)<t}function qv(n){const e=Math.round(n);n=xc(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(pb(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function d4(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((a,o)=>a-o).pop(),e}function f4(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Oc(n){return!f4(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function h4(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function m4(n,e,t){let i,a,o;for(i=0,a=n.length;i<a;i++)o=n[i][t],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function La(n){return n*(Tt/180)}function bp(n){return n*(180/Tt)}function Kv(n){if(!Si(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function gb(n,e){const t=e.x-n.x,i=e.y-n.y,a=Math.sqrt(t*t+i*i);let o=Math.atan2(i,t);return o<-.5*Tt&&(o+=Yt),{angle:o,distance:a}}function qm(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function p4(n,e){return(n-e+c4)%Yt-Tt}function yi(n){return(n%Yt+Yt)%Yt}function Rc(n,e,t,i){const a=yi(n),o=yi(e),l=yi(t),u=yi(o-a),f=yi(l-a),m=yi(a-o),p=yi(a-l);return a===o||a===l||i&&o===l||u>f&&m<p}function Kn(n,e,t){return Math.max(e,Math.min(t,n))}function g4(n){return Kn(n,-32768,32767)}function Xr(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function Sp(n,e,t){t=t||(l=>n[l]<e);let i=n.length-1,a=0,o;for(;i-a>1;)o=a+i>>1,t(o)?a=o:i=o;return{lo:a,hi:i}}const Ls=(n,e,t,i)=>Sp(n,t,i?a=>{const o=n[a][e];return o<t||o===t&&n[a+1][e]===t}:a=>n[a][e]<t),v4=(n,e,t)=>Sp(n,t,i=>n[i][e]>=t);function y4(n,e,t){let i=0,a=n.length;for(;i<a&&n[i]<e;)i++;for(;a>i&&n[a-1]>t;)a--;return i>0||a<n.length?n.slice(i,a):n}const vb=["push","pop","shift","splice","unshift"];function x4(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),vb.forEach(t=>{const i="_onData"+xp(t),a=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...o){const l=a.apply(this,o);return n._chartjs.listeners.forEach(u=>{typeof u[i]=="function"&&u[i](...o)}),l}})})}function Zv(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,a=i.indexOf(e);a!==-1&&i.splice(a,1),!(i.length>0)&&(vb.forEach(o=>{delete n[o]}),delete n._chartjs)}function yb(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const xb=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function bb(n,e){let t=[],i=!1;return function(...a){t=a,i||(i=!0,xb.call(window,()=>{i=!1,n.apply(e,t)}))}}function b4(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const _p=n=>n==="start"?"left":n==="end"?"right":"center",qn=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,S4=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function _4(n,e,t){const i=e.length;let a=0,o=i;if(n._sorted){const{iScale:l,vScale:u,_parsed:f}=n,m=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,p=l.axis,{min:v,max:y,minDefined:S,maxDefined:_}=l.getUserBounds();if(S){if(a=Math.min(Ls(f,p,v).lo,t?i:Ls(e,p,l.getPixelForValue(v)).lo),m){const x=f.slice(0,a+1).reverse().findIndex(T=>!mt(T[u.axis]));a-=Math.max(0,x)}a=Kn(a,0,i-1)}if(_){let x=Math.max(Ls(f,l.axis,y,!0).hi+1,t?0:Ls(e,p,l.getPixelForValue(y),!0).hi+1);if(m){const T=f.slice(x-1).findIndex(w=>!mt(w[u.axis]));x+=Math.max(0,T)}o=Kn(x,a,i)-a}else o=i-a}return{start:a,count:o}}function T4(n){const{xScale:e,yScale:t,_scaleRanges:i}=n,a={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=a,!0;const o=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,a),o}const ud=n=>n===0||n===1,Qv=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Yt/t)),Jv=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Yt/t)+1,bc={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*cn)+1,easeOutSine:n=>Math.sin(n*cn),easeInOutSine:n=>-.5*(Math.cos(Tt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>ud(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>ud(n)?n:Qv(n,.075,.3),easeOutElastic:n=>ud(n)?n:Jv(n,.075,.3),easeInOutElastic(n){return ud(n)?n:n<.5?.5*Qv(n*2,.1125,.45):.5+.5*Jv(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-bc.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?bc.easeInBounce(n*2)*.5:bc.easeOutBounce(n*2-1)*.5+.5};function Tp(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function ey(n){return Tp(n)?n:new jc(n)}function Am(n){return Tp(n)?n:new jc(n).saturate(.5).darken(.1).hexString()}const w4=["x","y","borderWidth","radius","tension"],E4=["color","borderColor","backgroundColor"];function A4(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:E4},numbers:{type:"number",properties:w4}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function k4(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ty=new Map;function C4(n,e){e=e||{};const t=n+JSON.stringify(e);let i=ty.get(t);return i||(i=new Intl.NumberFormat(n,e),ty.set(t,i)),i}function wp(n,e,t){return C4(e,t).format(n)}const j4={values(n){return Qt(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let a,o=n;if(t.length>1){const m=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(m<1e-4||m>1e15)&&(a="scientific"),o=D4(n,t)}const l=pb(Math.abs(o)),u=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),f={notation:a,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),wp(n,i,f)}};function D4(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var Ep={formatters:j4};function N4(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ep.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Fs=Object.create(null),Km=Object.create(null);function Sc(n,e){if(!e)return n;const t=e.split(".");for(let i=0,a=t.length;i<a;++i){const o=t[i];n=n[o]||(n[o]=Object.create(null))}return n}function km(n,e,t){return typeof e=="string"?Dc(Sc(n,e),t):Dc(Sc(n,""),e)}class O4{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,a)=>Am(a.backgroundColor),this.hoverBorderColor=(i,a)=>Am(a.borderColor),this.hoverColor=(i,a)=>Am(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return km(this,e,t)}get(e){return Sc(this,e)}describe(e,t){return km(Km,e,t)}override(e,t){return km(Fs,e,t)}route(e,t,i,a){const o=Sc(this,e),l=Sc(this,i),u="_"+t;Object.defineProperties(o,{[u]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const f=this[u],m=l[a];return pt(f)?Object.assign({},m,f):it(f,m)},set(f){this[u]=f}}})}apply(e){e.forEach(t=>t(this))}}var rn=new O4({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[A4,k4,N4]);function R4(n){return!n||mt(n.size)||mt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Fd(n,e,t,i,a){let o=e[a];return o||(o=e[a]=n.measureText(a).width,t.push(a)),o>i&&(i=o),i}function M4(n,e,t,i){i=i||{};let a=i.data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(a=i.data={},o=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let l=0;const u=t.length;let f,m,p,v,y;for(f=0;f<u;f++)if(v=t[f],v!=null&&!Qt(v))l=Fd(n,a,o,l,v);else if(Qt(v))for(m=0,p=v.length;m<p;m++)y=v[m],y!=null&&!Qt(y)&&(l=Fd(n,a,o,l,y));n.restore();const S=o.length/2;if(S>t.length){for(f=0;f<S;f++)delete a[o[f]];o.splice(0,S)}return l}function Ds(n,e,t){const i=n.currentDevicePixelRatio,a=t!==0?Math.max(t/2,.5):0;return Math.round((e-a)*i)/i+a}function ny(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function Zm(n,e,t,i){Sb(n,e,t,i,null)}function Sb(n,e,t,i,a){let o,l,u,f,m,p,v,y;const S=e.pointStyle,_=e.rotation,x=e.radius;let T=(_||0)*u4;if(S&&typeof S=="object"&&(o=S.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(T),n.drawImage(S,-S.width/2,-S.height/2,S.width,S.height),n.restore();return}if(!(isNaN(x)||x<=0)){switch(n.beginPath(),S){default:a?n.ellipse(t,i,a/2,x,0,0,Yt):n.arc(t,i,x,0,Yt),n.closePath();break;case"triangle":p=a?a/2:x,n.moveTo(t+Math.sin(T)*p,i-Math.cos(T)*x),T+=$v,n.lineTo(t+Math.sin(T)*p,i-Math.cos(T)*x),T+=$v,n.lineTo(t+Math.sin(T)*p,i-Math.cos(T)*x),n.closePath();break;case"rectRounded":m=x*.516,f=x-m,l=Math.cos(T+js)*f,v=Math.cos(T+js)*(a?a/2-m:f),u=Math.sin(T+js)*f,y=Math.sin(T+js)*(a?a/2-m:f),n.arc(t-v,i-u,m,T-Tt,T-cn),n.arc(t+y,i-l,m,T-cn,T),n.arc(t+v,i+u,m,T,T+cn),n.arc(t-y,i+l,m,T+cn,T+Tt),n.closePath();break;case"rect":if(!_){f=Math.SQRT1_2*x,p=a?a/2:f,n.rect(t-p,i-f,2*p,2*f);break}T+=js;case"rectRot":v=Math.cos(T)*(a?a/2:x),l=Math.cos(T)*x,u=Math.sin(T)*x,y=Math.sin(T)*(a?a/2:x),n.moveTo(t-v,i-u),n.lineTo(t+y,i-l),n.lineTo(t+v,i+u),n.lineTo(t-y,i+l),n.closePath();break;case"crossRot":T+=js;case"cross":v=Math.cos(T)*(a?a/2:x),l=Math.cos(T)*x,u=Math.sin(T)*x,y=Math.sin(T)*(a?a/2:x),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+y,i-l),n.lineTo(t-y,i+l);break;case"star":v=Math.cos(T)*(a?a/2:x),l=Math.cos(T)*x,u=Math.sin(T)*x,y=Math.sin(T)*(a?a/2:x),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+y,i-l),n.lineTo(t-y,i+l),T+=js,v=Math.cos(T)*(a?a/2:x),l=Math.cos(T)*x,u=Math.sin(T)*x,y=Math.sin(T)*(a?a/2:x),n.moveTo(t-v,i-u),n.lineTo(t+v,i+u),n.moveTo(t+y,i-l),n.lineTo(t-y,i+l);break;case"line":l=a?a/2:Math.cos(T)*x,u=Math.sin(T)*x,n.moveTo(t-l,i-u),n.lineTo(t+l,i+u);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(T)*(a?a/2:x),i+Math.sin(T)*x);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function or(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Ap(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function kp(n){n.restore()}function L4(n,e,t,i,a){if(!e)return n.lineTo(t.x,t.y);if(a==="middle"){const o=(e.x+t.x)/2;n.lineTo(o,e.y),n.lineTo(o,t.y)}else a==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function I4(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function P4(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),mt(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function B4(n,e,t,i,a){if(a.strikethrough||a.underline){const o=n.measureText(i),l=e-o.actualBoundingBoxLeft,u=e+o.actualBoundingBoxRight,f=t-o.actualBoundingBoxAscent,m=t+o.actualBoundingBoxDescent,p=a.strikethrough?(f+m)/2:m;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=a.decorationWidth||2,n.moveTo(l,p),n.lineTo(u,p),n.stroke()}}function F4(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Us(n,e,t,i,a,o={}){const l=Qt(e)?e:[e],u=o.strokeWidth>0&&o.strokeColor!=="";let f,m;for(n.save(),n.font=a.string,P4(n,o),f=0;f<l.length;++f)m=l[f],o.backdrop&&F4(n,o.backdrop),u&&(o.strokeColor&&(n.strokeStyle=o.strokeColor),mt(o.strokeWidth)||(n.lineWidth=o.strokeWidth),n.strokeText(m,t,i,o.maxWidth)),n.fillText(m,t,i,o.maxWidth),B4(n,t,i,m,o),i+=Number(a.lineHeight);n.restore()}function Mc(n,e){const{x:t,y:i,w:a,h:o,radius:l}=e;n.arc(t+l.topLeft,i+l.topLeft,l.topLeft,1.5*Tt,Tt,!0),n.lineTo(t,i+o-l.bottomLeft),n.arc(t+l.bottomLeft,i+o-l.bottomLeft,l.bottomLeft,Tt,cn,!0),n.lineTo(t+a-l.bottomRight,i+o),n.arc(t+a-l.bottomRight,i+o-l.bottomRight,l.bottomRight,cn,0,!0),n.lineTo(t+a,i+l.topRight),n.arc(t+a-l.topRight,i+l.topRight,l.topRight,0,-cn,!0),n.lineTo(t+l.topLeft,i)}const U4=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,z4=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function H4(n,e){const t=(""+n).match(U4);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const W4=n=>+n||0;function Cp(n,e){const t={},i=pt(e),a=i?Object.keys(e):e,o=pt(n)?i?l=>it(n[l],n[e[l]]):l=>n[l]:()=>n;for(const l of a)t[l]=W4(o(l));return t}function _b(n){return Cp(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Is(n){return Cp(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Jn(n){const e=_b(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Tn(n,e){n=n||{},e=e||rn.font;let t=it(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=it(n.style,e.style);i&&!(""+i).match(z4)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const a={family:it(n.family,e.family),lineHeight:H4(it(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:it(n.weight,e.weight),string:""};return a.string=R4(a),a}function dd(n,e,t,i){let a,o,l;for(a=0,o=n.length;a<o;++a)if(l=n[a],l!==void 0&&l!==void 0)return l}function V4(n,e,t){const{min:i,max:a}=n,o=hb(e,(a-i)/2),l=(u,f)=>t&&u===0?0:u+f;return{min:l(i,-Math.abs(o)),max:l(a,o)}}function is(n,e){return Object.assign(Object.create(n),e)}function jp(n,e=[""],t,i,a=()=>n[0]){const o=t||n;typeof i>"u"&&(i=Ab("_fallback",n));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:o,_fallback:i,_getTarget:a,override:u=>jp([u,...n],e,o,i)};return new Proxy(l,{deleteProperty(u,f){return delete u[f],delete u._keys,delete n[0][f],!0},get(u,f){return wb(u,f,()=>Q4(f,e,n,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(u,f){return ay(u).includes(f)},ownKeys(u){return ay(u)},set(u,f,m){const p=u._storage||(u._storage=a());return u[f]=p[f]=m,delete u._keys,!0}})}function Xo(n,e,t,i){const a={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:Tb(n,i),setContext:o=>Xo(n,o,t,i),override:o=>Xo(n.override(o),e,t,i)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete n[l],!0},get(o,l,u){return wb(o,l,()=>Y4(o,l,u))},getOwnPropertyDescriptor(o,l){return o._descriptors.allKeys?Reflect.has(n,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,l)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(o,l){return Reflect.has(n,l)},ownKeys(){return Reflect.ownKeys(n)},set(o,l,u){return n[l]=u,delete o[l],!0}})}function Tb(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:a=e.allKeys}=n;return{allKeys:a,scriptable:t,indexable:i,isScriptable:Jr(t)?t:()=>t,isIndexable:Jr(i)?i:()=>i}}const G4=(n,e)=>n?n+xp(e):e,Dp=(n,e)=>pt(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function wb(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const i=t();return n[e]=i,i}function Y4(n,e,t){const{_proxy:i,_context:a,_subProxy:o,_descriptors:l}=n;let u=i[e];return Jr(u)&&l.isScriptable(e)&&(u=X4(e,u,n,t)),Qt(u)&&u.length&&(u=$4(e,u,n,l.isIndexable)),Dp(e,u)&&(u=Xo(u,a,o&&o[e],l)),u}function X4(n,e,t,i){const{_proxy:a,_context:o,_subProxy:l,_stack:u}=t;if(u.has(n))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+n);u.add(n);let f=e(o,l||i);return u.delete(n),Dp(n,f)&&(f=Np(a._scopes,a,n,f)),f}function $4(n,e,t,i){const{_proxy:a,_context:o,_subProxy:l,_descriptors:u}=t;if(typeof o.index<"u"&&i(n))return e[o.index%e.length];if(pt(e[0])){const f=e,m=a._scopes.filter(p=>p!==f);e=[];for(const p of f){const v=Np(m,a,n,p);e.push(Xo(v,o,l&&l[n],u))}}return e}function Eb(n,e,t){return Jr(n)?n(e,t):n}const q4=(n,e)=>n===!0?e:typeof n=="string"?Qr(e,n):void 0;function K4(n,e,t,i,a){for(const o of e){const l=q4(t,o);if(l){n.add(l);const u=Eb(l._fallback,t,a);if(typeof u<"u"&&u!==t&&u!==i)return u}else if(l===!1&&typeof i<"u"&&t!==i)return null}return!1}function Np(n,e,t,i){const a=e._rootScopes,o=Eb(e._fallback,t,i),l=[...n,...a],u=new Set;u.add(i);let f=iy(u,l,t,o||t,i);return f===null||typeof o<"u"&&o!==t&&(f=iy(u,l,o,f,i),f===null)?!1:jp(Array.from(u),[""],a,o,()=>Z4(e,t,i))}function iy(n,e,t,i,a){for(;t;)t=K4(n,e,t,i,a);return t}function Z4(n,e,t){const i=n._getTarget();e in i||(i[e]={});const a=i[e];return Qt(a)&&pt(t)?t:a||{}}function Q4(n,e,t,i){let a;for(const o of e)if(a=Ab(G4(o,n),t),typeof a<"u")return Dp(n,a)?Np(t,i,n,a):a}function Ab(n,e){for(const t of e){if(!t)continue;const i=t[n];if(typeof i<"u")return i}}function ay(n){let e=n._keys;return e||(e=n._keys=J4(n._scopes)),e}function J4(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(a=>!a.startsWith("_")))e.add(i);return Array.from(e)}function eA(n,e,t,i){const{iScale:a}=n,{key:o="r"}=this._parsing,l=new Array(i);let u,f,m,p;for(u=0,f=i;u<f;++u)m=u+t,p=e[m],l[u]={r:a.parse(Qr(p,o),m)};return l}const tA=Number.EPSILON||1e-14,$o=(n,e)=>e<n.length&&!n[e].skip&&n[e],kb=n=>n==="x"?"y":"x";function nA(n,e,t,i){const a=n.skip?e:n,o=e,l=t.skip?e:t,u=qm(o,a),f=qm(l,o);let m=u/(u+f),p=f/(u+f);m=isNaN(m)?0:m,p=isNaN(p)?0:p;const v=i*m,y=i*p;return{previous:{x:o.x-v*(l.x-a.x),y:o.y-v*(l.y-a.y)},next:{x:o.x+y*(l.x-a.x),y:o.y+y*(l.y-a.y)}}}function iA(n,e,t){const i=n.length;let a,o,l,u,f,m=$o(n,0);for(let p=0;p<i-1;++p)if(f=m,m=$o(n,p+1),!(!f||!m)){if(xc(e[p],0,tA)){t[p]=t[p+1]=0;continue}a=t[p]/e[p],o=t[p+1]/e[p],u=Math.pow(a,2)+Math.pow(o,2),!(u<=9)&&(l=3/Math.sqrt(u),t[p]=a*l*e[p],t[p+1]=o*l*e[p])}}function aA(n,e,t="x"){const i=kb(t),a=n.length;let o,l,u,f=$o(n,0);for(let m=0;m<a;++m){if(l=u,u=f,f=$o(n,m+1),!u)continue;const p=u[t],v=u[i];l&&(o=(p-l[t])/3,u[`cp1${t}`]=p-o,u[`cp1${i}`]=v-o*e[m]),f&&(o=(f[t]-p)/3,u[`cp2${t}`]=p+o,u[`cp2${i}`]=v+o*e[m])}}function rA(n,e="x"){const t=kb(e),i=n.length,a=Array(i).fill(0),o=Array(i);let l,u,f,m=$o(n,0);for(l=0;l<i;++l)if(u=f,f=m,m=$o(n,l+1),!!f){if(m){const p=m[e]-f[e];a[l]=p!==0?(m[t]-f[t])/p:0}o[l]=u?m?Ia(a[l-1])!==Ia(a[l])?0:(a[l-1]+a[l])/2:a[l-1]:a[l]}iA(n,a,o),aA(n,o,e)}function fd(n,e,t){return Math.max(Math.min(n,t),e)}function sA(n,e){let t,i,a,o,l,u=or(n[0],e);for(t=0,i=n.length;t<i;++t)l=o,o=u,u=t<i-1&&or(n[t+1],e),o&&(a=n[t],l&&(a.cp1x=fd(a.cp1x,e.left,e.right),a.cp1y=fd(a.cp1y,e.top,e.bottom)),u&&(a.cp2x=fd(a.cp2x,e.left,e.right),a.cp2y=fd(a.cp2y,e.top,e.bottom)))}function oA(n,e,t,i,a){let o,l,u,f;if(e.spanGaps&&(n=n.filter(m=>!m.skip)),e.cubicInterpolationMode==="monotone")rA(n,a);else{let m=i?n[n.length-1]:n[0];for(o=0,l=n.length;o<l;++o)u=n[o],f=nA(m,u,n[Math.min(o+1,l-(i?0:1))%l],e.tension),u.cp1x=f.previous.x,u.cp1y=f.previous.y,u.cp2x=f.next.x,u.cp2y=f.next.y,m=u}e.capBezierPoints&&sA(n,t)}function Op(){return typeof window<"u"&&typeof document<"u"}function Rp(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Ud(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const of=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function lA(n,e){return of(n).getPropertyValue(e)}const cA=["top","right","bottom","left"];function Ps(n,e,t){const i={};t=t?"-"+t:"";for(let a=0;a<4;a++){const o=cA[a];i[o]=parseFloat(n[e+"-"+o+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const uA=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function dA(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:a,offsetY:o}=i;let l=!1,u,f;if(uA(a,o,n.target))u=a,f=o;else{const m=e.getBoundingClientRect();u=i.clientX-m.left,f=i.clientY-m.top,l=!0}return{x:u,y:f,box:l}}function Os(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,a=of(t),o=a.boxSizing==="border-box",l=Ps(a,"padding"),u=Ps(a,"border","width"),{x:f,y:m,box:p}=dA(n,t),v=l.left+(p&&u.left),y=l.top+(p&&u.top);let{width:S,height:_}=e;return o&&(S-=l.width+u.width,_-=l.height+u.height),{x:Math.round((f-v)/S*t.width/i),y:Math.round((m-y)/_*t.height/i)}}function fA(n,e,t){let i,a;if(e===void 0||t===void 0){const o=n&&Rp(n);if(!o)e=n.clientWidth,t=n.clientHeight;else{const l=o.getBoundingClientRect(),u=of(o),f=Ps(u,"border","width"),m=Ps(u,"padding");e=l.width-m.width-f.width,t=l.height-m.height-f.height,i=Ud(u.maxWidth,o,"clientWidth"),a=Ud(u.maxHeight,o,"clientHeight")}}return{width:e,height:t,maxWidth:i||Bd,maxHeight:a||Bd}}const hd=n=>Math.round(n*10)/10;function hA(n,e,t,i){const a=of(n),o=Ps(a,"margin"),l=Ud(a.maxWidth,n,"clientWidth")||Bd,u=Ud(a.maxHeight,n,"clientHeight")||Bd,f=fA(n,e,t);let{width:m,height:p}=f;if(a.boxSizing==="content-box"){const y=Ps(a,"border","width"),S=Ps(a,"padding");m-=S.width+y.width,p-=S.height+y.height}return m=Math.max(0,m-o.width),p=Math.max(0,i?m/i:p-o.height),m=hd(Math.min(m,l,f.maxWidth)),p=hd(Math.min(p,u,f.maxHeight)),m&&!p&&(p=hd(m/2)),(e!==void 0||t!==void 0)&&i&&f.height&&p>f.height&&(p=f.height,m=hd(Math.floor(p*i))),{width:m,height:p}}function ry(n,e,t){const i=e||1,a=Math.floor(n.height*i),o=Math.floor(n.width*i);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const l=n.canvas;return l.style&&(t||!l.style.height&&!l.style.width)&&(l.style.height=`${n.height}px`,l.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||l.height!==a||l.width!==o?(n.currentDevicePixelRatio=i,l.height=a,l.width=o,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const mA=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};Op()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function sy(n,e){const t=lA(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Rs(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function pA(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function gA(n,e,t,i){const a={x:n.cp2x,y:n.cp2y},o={x:e.cp1x,y:e.cp1y},l=Rs(n,a,t),u=Rs(a,o,t),f=Rs(o,e,t),m=Rs(l,u,t),p=Rs(u,f,t);return Rs(m,p,t)}const vA=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},yA=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Ho(n,e,t){return n?vA(e,t):yA()}function Cb(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function jb(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function Db(n){return n==="angle"?{between:Rc,compare:p4,normalize:yi}:{between:Xr,compare:(e,t)=>e-t,normalize:e=>e}}function oy({start:n,end:e,count:t,loop:i,style:a}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:a}}function xA(n,e,t){const{property:i,start:a,end:o}=t,{between:l,normalize:u}=Db(i),f=e.length;let{start:m,end:p,loop:v}=n,y,S;if(v){for(m+=f,p+=f,y=0,S=f;y<S&&l(u(e[m%f][i]),a,o);++y)m--,p--;m%=f,p%=f}return p<m&&(p+=f),{start:m,end:p,loop:v,style:n.style}}function bA(n,e,t){if(!t)return[n];const{property:i,start:a,end:o}=t,l=e.length,{compare:u,between:f,normalize:m}=Db(i),{start:p,end:v,loop:y,style:S}=xA(n,e,t),_=[];let x=!1,T=null,w,E,C;const N=()=>f(a,C,w)&&u(a,C)!==0,A=()=>u(o,w)===0||f(o,C,w),I=()=>x||N(),D=()=>!x||A();for(let z=p,L=p;z<=v;++z)E=e[z%l],!E.skip&&(w=m(E[i]),w!==C&&(x=f(w,a,o),T===null&&I()&&(T=u(w,a)===0?z:L),T!==null&&D()&&(_.push(oy({start:T,end:z,loop:y,count:l,style:S})),T=null),L=z,C=w));return T!==null&&_.push(oy({start:T,end:v,loop:y,count:l,style:S})),_}function SA(n,e){const t=[],i=n.segments;for(let a=0;a<i.length;a++){const o=bA(i[a],n.points,e);o.length&&t.push(...o)}return t}function _A(n,e,t,i){let a=0,o=e-1;if(t&&!i)for(;a<e&&!n[a].skip;)a++;for(;a<e&&n[a].skip;)a++;for(a%=e,t&&(o+=a);o>a&&n[o%e].skip;)o--;return o%=e,{start:a,end:o}}function TA(n,e,t,i){const a=n.length,o=[];let l=e,u=n[e],f;for(f=e+1;f<=t;++f){const m=n[f%a];m.skip||m.stop?u.skip||(i=!1,o.push({start:e%a,end:(f-1)%a,loop:i}),e=l=m.stop?f:null):(l=f,u.skip&&(e=f)),u=m}return l!==null&&o.push({start:e%a,end:l%a,loop:i}),o}function wA(n,e){const t=n.points,i=n.options.spanGaps,a=t.length;if(!a)return[];const o=!!n._loop,{start:l,end:u}=_A(t,a,o,i);if(i===!0)return ly(n,[{start:l,end:u,loop:o}],t,e);const f=u<l?u+a:u,m=!!n._fullLoop&&l===0&&u===a-1;return ly(n,TA(t,l,f,m),t,e)}function ly(n,e,t,i){return!i||!i.setContext||!t?e:EA(n,e,t,i)}function EA(n,e,t,i){const a=n._chart.getContext(),o=cy(n.options),{_datasetIndex:l,options:{spanGaps:u}}=n,f=t.length,m=[];let p=o,v=e[0].start,y=v;function S(_,x,T,w){const E=u?-1:1;if(_!==x){for(_+=f;t[_%f].skip;)_-=E;for(;t[x%f].skip;)x+=E;_%f!==x%f&&(m.push({start:_%f,end:x%f,loop:T,style:w}),p=w,v=x%f)}}for(const _ of e){v=u?v:_.start;let x=t[v%f],T;for(y=v+1;y<=_.end;y++){const w=t[y%f];T=cy(i.setContext(is(a,{type:"segment",p0:x,p1:w,p0DataIndex:(y-1)%f,p1DataIndex:y%f,datasetIndex:l}))),AA(T,p)&&S(v,y-1,_.loop,p),x=w,p=T}v<y-1&&S(v,y-1,_.loop,p)}return m}function cy(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function AA(n,e){if(!e)return!1;const t=[],i=function(a,o){return Tp(o)?(t.includes(o)||t.push(o),t.indexOf(o)):o};return JSON.stringify(n,i)!==JSON.stringify(e,i)}function md(n,e,t){return n.options.clip?n[t]:e[t]}function kA(n,e){const{xScale:t,yScale:i}=n;return t&&i?{left:md(t,e,"left"),right:md(t,e,"right"),top:md(i,e,"top"),bottom:md(i,e,"bottom")}:e}function CA(n,e){const t=e._clip;if(t.disabled)return!1;const i=kA(e,n.chartArea);return{left:t.left===!1?0:i.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:i.right+(t.right===!0?0:t.right),top:t.top===!1?0:i.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:i.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class jA{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,a){const o=t.listeners[a],l=t.duration;o.forEach(u=>u({chart:e,initial:t.initial,numSteps:l,currentStep:Math.min(i-t.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=xb.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,a)=>{if(!i.running||!i.items.length)return;const o=i.items;let l=o.length-1,u=!1,f;for(;l>=0;--l)f=o[l],f._active?(f._total>i.duration&&(i.duration=f._total),f.tick(e),u=!0):(o[l]=o[o.length-1],o.pop());u&&(a.draw(),this._notify(a,i,e,"progress")),o.length||(i.running=!1,this._notify(a,i,e,"complete"),i.initial=!1),t+=o.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,a)=>Math.max(i,a._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let a=i.length-1;for(;a>=0;--a)i[a].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ar=new jA;const uy="transparent",DA={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=ey(n||uy),a=i.valid&&ey(e||uy);return a&&a.valid?a.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class NA{constructor(e,t,i,a){const o=t[i];a=dd([e.to,a,o,e.from]);const l=dd([e.from,o,a]);this._active=!0,this._fn=e.fn||DA[e.type||typeof l],this._easing=bc[e.easing]||bc.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=l,this._to=a,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const a=this._target[this._prop],o=i-this._start,l=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=dd([e.to,t,a,e.from]),this._from=dd([e.from,a,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,a=this._prop,o=this._from,l=this._loop,u=this._to;let f;if(this._active=o!==u&&(l||t<i),!this._active){this._target[a]=u,this._notify(!0);return}if(t<0){this._target[a]=o;return}f=t/i%2,f=l&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[a]=this._fn(o,u,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let a=0;a<i.length;a++)i[a][t]()}}class Nb{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!pt(e))return;const t=Object.keys(rn.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(a=>{const o=e[a];if(!pt(o))return;const l={};for(const u of t)l[u]=o[u];(Qt(o.properties)&&o.properties||[a]).forEach(u=>{(u===a||!i.has(u))&&i.set(u,l)})})}_animateOptions(e,t){const i=t.options,a=RA(e,i);if(!a)return[];const o=this._createAnimations(a,i);return i.$shared&&OA(e.options.$animations,i).then(()=>{e.options=i},()=>{}),o}_createAnimations(e,t){const i=this._properties,a=[],o=e.$animations||(e.$animations={}),l=Object.keys(t),u=Date.now();let f;for(f=l.length-1;f>=0;--f){const m=l[f];if(m.charAt(0)==="$")continue;if(m==="options"){a.push(...this._animateOptions(e,t));continue}const p=t[m];let v=o[m];const y=i.get(m);if(v)if(y&&v.active()){v.update(y,p,u);continue}else v.cancel();if(!y||!y.duration){e[m]=p;continue}o[m]=v=new NA(y,e,m,p),a.push(v)}return a}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return ar.add(this._chart,i),!0}}function OA(n,e){const t=[],i=Object.keys(e);for(let a=0;a<i.length;a++){const o=n[i[a]];o&&o.active()&&t.push(o.wait())}return Promise.all(t)}function RA(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function dy(n,e){const t=n&&n.options||{},i=t.reverse,a=t.min===void 0?e:0,o=t.max===void 0?e:0;return{start:i?o:a,end:i?a:o}}function MA(n,e,t){if(t===!1)return!1;const i=dy(n,t),a=dy(e,t);return{top:a.end,right:i.end,bottom:a.start,left:i.start}}function LA(n){let e,t,i,a;return pt(n)?(e=n.top,t=n.right,i=n.bottom,a=n.left):e=t=i=a=n,{top:e,right:t,bottom:i,left:a,disabled:n===!1}}function Ob(n,e){const t=[],i=n._getSortedDatasetMetas(e);let a,o;for(a=0,o=i.length;a<o;++a)t.push(i[a].index);return t}function fy(n,e,t,i={}){const a=n.keys,o=i.mode==="single";let l,u,f,m;if(e===null)return;let p=!1;for(l=0,u=a.length;l<u;++l){if(f=+a[l],f===t){if(p=!0,i.all)continue;break}m=n.values[f],Si(m)&&(o||e===0||Ia(e)===Ia(m))&&(e+=m)}return!p&&!i.all?0:e}function IA(n,e){const{iScale:t,vScale:i}=e,a=t.axis==="x"?"x":"y",o=i.axis==="x"?"x":"y",l=Object.keys(n),u=new Array(l.length);let f,m,p;for(f=0,m=l.length;f<m;++f)p=l[f],u[f]={[a]:p,[o]:n[p]};return u}function Cm(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function PA(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function BA(n){const{min:e,max:t,minDefined:i,maxDefined:a}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:a?t:Number.POSITIVE_INFINITY}}function FA(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function hy(n,e,t,i){for(const a of e.getMatchingVisibleMetas(i).reverse()){const o=n[a.index];if(t&&o>0||!t&&o<0)return a.index}return null}function my(n,e){const{chart:t,_cachedMeta:i}=n,a=t._stacks||(t._stacks={}),{iScale:o,vScale:l,index:u}=i,f=o.axis,m=l.axis,p=PA(o,l,i),v=e.length;let y;for(let S=0;S<v;++S){const _=e[S],{[f]:x,[m]:T}=_,w=_._stacks||(_._stacks={});y=w[m]=FA(a,p,x),y[u]=T,y._top=hy(y,l,!0,i.type),y._bottom=hy(y,l,!1,i.type);const E=y._visualValues||(y._visualValues={});E[u]=T}}function jm(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function UA(n,e){return is(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function zA(n,e,t){return is(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function rc(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const a of e){const o=a._stacks;if(!o||o[i]===void 0||o[i][t]===void 0)return;delete o[i][t],o[i]._visualValues!==void 0&&o[i]._visualValues[t]!==void 0&&delete o[i]._visualValues[t]}}}const Dm=n=>n==="reset"||n==="none",py=(n,e)=>e?n:Object.assign({},n),HA=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:Ob(t,!0),values:null};class Xc{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Cm(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&rc(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),a=(v,y,S,_)=>v==="x"?y:v==="r"?_:S,o=t.xAxisID=it(i.xAxisID,jm(e,"x")),l=t.yAxisID=it(i.yAxisID,jm(e,"y")),u=t.rAxisID=it(i.rAxisID,jm(e,"r")),f=t.indexAxis,m=t.iAxisID=a(f,o,l,u),p=t.vAxisID=a(f,l,o,u);t.xScale=this.getScaleForId(o),t.yScale=this.getScaleForId(l),t.rScale=this.getScaleForId(u),t.iScale=this.getScaleForId(m),t.vScale=this.getScaleForId(p)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Zv(this._data,this),e._stacked&&rc(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(pt(t)){const a=this._cachedMeta;this._data=IA(t,a)}else if(i!==t){if(i){Zv(i,this);const a=this._cachedMeta;rc(a),a._parsed=[]}t&&Object.isExtensible(t)&&x4(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let a=!1;this._dataCheck();const o=t._stacked;t._stacked=Cm(t.vScale,t),t.stack!==i.stack&&(a=!0,rc(t),t.stack=i.stack),this._resyncElements(e),(a||o!==t._stacked)&&(my(this,t._parsed),t._stacked=Cm(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:a}=this,{iScale:o,_stacked:l}=i,u=o.axis;let f=e===0&&t===a.length?!0:i._sorted,m=e>0&&i._parsed[e-1],p,v,y;if(this._parsing===!1)i._parsed=a,i._sorted=!0,y=a;else{Qt(a[e])?y=this.parseArrayData(i,a,e,t):pt(a[e])?y=this.parseObjectData(i,a,e,t):y=this.parsePrimitiveData(i,a,e,t);const S=()=>v[u]===null||m&&v[u]<m[u];for(p=0;p<t;++p)i._parsed[p+e]=v=y[p],f&&(S()&&(f=!1),m=v);i._sorted=f}l&&my(this,y)}parsePrimitiveData(e,t,i,a){const{iScale:o,vScale:l}=e,u=o.axis,f=l.axis,m=o.getLabels(),p=o===l,v=new Array(a);let y,S,_;for(y=0,S=a;y<S;++y)_=y+i,v[y]={[u]:p||o.parse(m[_],_),[f]:l.parse(t[_],_)};return v}parseArrayData(e,t,i,a){const{xScale:o,yScale:l}=e,u=new Array(a);let f,m,p,v;for(f=0,m=a;f<m;++f)p=f+i,v=t[p],u[f]={x:o.parse(v[0],p),y:l.parse(v[1],p)};return u}parseObjectData(e,t,i,a){const{xScale:o,yScale:l}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(a);let p,v,y,S;for(p=0,v=a;p<v;++p)y=p+i,S=t[y],m[p]={x:o.parse(Qr(S,u),y),y:l.parse(Qr(S,f),y)};return m}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const a=this.chart,o=this._cachedMeta,l=t[e.axis],u={keys:Ob(a,!0),values:t._stacks[e.axis]._visualValues};return fy(u,l,o.index,{mode:i})}updateRangeFromParsed(e,t,i,a){const o=i[t.axis];let l=o===null?NaN:o;const u=a&&i._stacks[t.axis];a&&u&&(a.values=u,l=fy(a,o,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,t){const i=this._cachedMeta,a=i._parsed,o=i._sorted&&e===i.iScale,l=a.length,u=this._getOtherScale(e),f=HA(t,i,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:p,max:v}=BA(u);let y,S;function _(){S=a[y];const x=S[u.axis];return!Si(S[e.axis])||p>x||v<x}for(y=0;y<l&&!(!_()&&(this.updateRangeFromParsed(m,e,S,f),o));++y);if(o){for(y=l-1;y>=0;--y)if(!_()){this.updateRangeFromParsed(m,e,S,f);break}}return m}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let a,o,l;for(a=0,o=t.length;a<o;++a)l=t[a][e.axis],Si(l)&&i.push(l);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,a=t.vScale,o=this.getParsed(e);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:a?""+a.getLabelForValue(o[a.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=LA(it(this.options.clip,MA(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,a=i.data||[],o=t.chartArea,l=[],u=this._drawStart||0,f=this._drawCount||a.length-u,m=this.options.drawActiveElementsOnTop;let p;for(i.dataset&&i.dataset.draw(e,o,u,f),p=u;p<u+f;++p){const v=a[p];v.hidden||(v.active&&m?l.push(v):v.draw(e,o))}for(p=0;p<l.length;++p)l[p].draw(e,o)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const a=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];o=l.$context||(l.$context=zA(this.getContext(),e,l)),o.parsed=this.getParsed(e),o.raw=a.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=UA(this.chart.getContext(),this.index)),o.dataset=a,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=i,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const a=t==="active",o=this._cachedDataOpts,l=e+"-"+t,u=o[l],f=this.enableOptionSharing&&Nc(i);if(u)return py(u,f);const m=this.chart.config,p=m.datasetElementScopeKeys(this._type,e),v=a?[`${e}Hover`,"hover",e,""]:[e,""],y=m.getOptionScopes(this.getDataset(),p),S=Object.keys(rn.elements[e]),_=()=>this.getContext(i,a,t),x=m.resolveNamedOptions(y,S,_,v);return x.$shared&&(x.$shared=f,o[l]=Object.freeze(py(x,f))),x}_resolveAnimations(e,t,i){const a=this.chart,o=this._cachedDataOpts,l=`animation-${t}`,u=o[l];if(u)return u;let f;if(a.options.animation!==!1){const p=this.chart.config,v=p.datasetAnimationScopeKeys(this._type,t),y=p.getOptionScopes(this.getDataset(),v);f=p.createResolver(y,this.getContext(e,i,t))}const m=new Nb(a,f&&f.animations);return f&&f._cacheable&&(o[l]=Object.freeze(m)),m}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Dm(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),a=this._sharedOptions,o=this.getSharedOptions(i),l=this.includeOptions(t,o)||o!==a;return this.updateSharedOptions(o,t,i),{sharedOptions:o,includeOptions:l}}updateElement(e,t,i,a){Dm(a)?Object.assign(e,i):this._resolveAnimations(t,a).update(e,i)}updateSharedOptions(e,t,i){e&&!Dm(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,a){e.active=a;const o=this.getStyle(t,a);this._resolveAnimations(t,i,a).update(e,{options:!a&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];const a=i.length,o=t.length,l=Math.min(o,a);l&&this.parse(0,l),o>a?this._insertElements(a,o-a,e):o<a&&this._removeElements(o,a-o)}_insertElements(e,t,i=!0){const a=this._cachedMeta,o=a.data,l=e+t;let u;const f=m=>{for(m.length+=t,u=m.length-1;u>=l;u--)m[u]=m[u-t]};for(f(o),u=e;u<l;++u)o[u]=new this.dataElementType;this._parsing&&f(a._parsed),this.parse(e,t),i&&this.updateElements(o,e,t,"reset")}updateElements(e,t,i,a){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const a=i._parsed.splice(e,t);i._stacked&&rc(i,a)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,a]=e;this[t](i,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function WA(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let a=0,o=t.length;a<o;a++)i=i.concat(t[a].controller.getAllParsedValues(n));n._cache.$bar=yb(i.sort((a,o)=>a-o))}return n._cache.$bar}function VA(n){const e=n.iScale,t=WA(e,n.type);let i=e._length,a,o,l,u;const f=()=>{l===32767||l===-32768||(Nc(u)&&(i=Math.min(i,Math.abs(l-u)||i)),u=l)};for(a=0,o=t.length;a<o;++a)l=e.getPixelForValue(t[a]),f();for(u=void 0,a=0,o=e.ticks.length;a<o;++a)l=e.getPixelForTick(a),f();return i}function GA(n,e,t,i){const a=t.barThickness;let o,l;return mt(a)?(o=e.min*t.categoryPercentage,l=t.barPercentage):(o=a*i,l=1),{chunk:o/i,ratio:l,start:e.pixels[n]-o/2}}function YA(n,e,t,i){const a=e.pixels,o=a[n];let l=n>0?a[n-1]:null,u=n<a.length-1?a[n+1]:null;const f=t.categoryPercentage;l===null&&(l=o-(u===null?e.end-e.start:u-o)),u===null&&(u=o+o-l);const m=o-(o-Math.min(l,u))/2*f;return{chunk:Math.abs(u-l)/2*f/i,ratio:t.barPercentage,start:m}}function XA(n,e,t,i){const a=t.parse(n[0],i),o=t.parse(n[1],i),l=Math.min(a,o),u=Math.max(a,o);let f=l,m=u;Math.abs(l)>Math.abs(u)&&(f=u,m=l),e[t.axis]=m,e._custom={barStart:f,barEnd:m,start:a,end:o,min:l,max:u}}function Rb(n,e,t,i){return Qt(n)?XA(n,e,t,i):e[t.axis]=t.parse(n,i),e}function gy(n,e,t,i){const a=n.iScale,o=n.vScale,l=a.getLabels(),u=a===o,f=[];let m,p,v,y;for(m=t,p=t+i;m<p;++m)y=e[m],v={},v[a.axis]=u||a.parse(l[m],m),f.push(Rb(y,v,o,m));return f}function Nm(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function $A(n,e,t){return n!==0?Ia(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function qA(n){let e,t,i,a,o;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(a="end",o="start"):(a="start",o="end"),{start:t,end:i,reverse:e,top:a,bottom:o}}function KA(n,e,t,i){let a=e.borderSkipped;const o={};if(!a){n.borderSkipped=o;return}if(a===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:u,reverse:f,top:m,bottom:p}=qA(n);a==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?a=m:(t._bottom||0)===i?a=p:(o[vy(p,l,u,f)]=!0,a=m)),o[vy(a,l,u,f)]=!0,n.borderSkipped=o}function vy(n,e,t,i){return i?(n=ZA(n,e,t),n=yy(n,t,e)):n=yy(n,e,t),n}function ZA(n,e,t){return n===e?t:n===t?e:n}function yy(n,e,t){return n==="start"?e:n==="end"?t:n}function QA(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class JA extends Xc{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,i,a){return gy(e,t,i,a)}parseArrayData(e,t,i,a){return gy(e,t,i,a)}parseObjectData(e,t,i,a){const{iScale:o,vScale:l}=e,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=o.axis==="x"?u:f,p=l.axis==="x"?u:f,v=[];let y,S,_,x;for(y=i,S=i+a;y<S;++y)x=t[y],_={},_[o.axis]=o.parse(Qr(x,m),y),v.push(Rb(Qr(x,p),_,l,y));return v}updateRangeFromParsed(e,t,i,a){super.updateRangeFromParsed(e,t,i,a);const o=i._custom;o&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:a}=t,o=this.getParsed(e),l=o._custom,u=Nm(l)?"["+l.start+", "+l.end+"]":""+a.getLabelForValue(o[a.axis]);return{label:""+i.getLabelForValue(o[i.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,a){const o=a==="reset",{index:l,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),p=this._getRuler(),{sharedOptions:v,includeOptions:y}=this._getSharedOptions(t,a);for(let S=t;S<t+i;S++){const _=this.getParsed(S),x=o||mt(_[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(S),T=this._calculateBarIndexPixels(S,p),w=(_._stacks||{})[u.axis],E={horizontal:m,base:x.base,enableBorderRadius:!w||Nm(_._custom)||l===w._top||l===w._bottom,x:m?x.head:T.center,y:m?T.center:x.head,height:m?T.size:Math.abs(x.size),width:m?Math.abs(x.size):T.size};y&&(E.options=v||this.resolveDataElementOptions(S,e[S].active?"active":a));const C=E.options||e[S].options;KA(E,C,w,l),QA(E,C,p.ratio),this.updateElement(e[S],S,E,a)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,a=i.getMatchingVisibleMetas(this._type).filter(p=>p.controller.options.grouped),o=i.options.stacked,l=[],u=this._cachedMeta.controller.getParsed(t),f=u&&u[i.axis],m=p=>{const v=p._parsed.find(S=>S[i.axis]===f),y=v&&v[p.vScale.axis];if(mt(y)||isNaN(y))return!0};for(const p of a)if(!(t!==void 0&&m(p))&&((o===!1||l.indexOf(p.stack)===-1||o===void 0&&p.stack===void 0)&&l.push(p.stack),p.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(i=>e[i].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)e[it(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,i){const a=this._getStacks(e,i),o=t!==void 0?a.indexOf(t):-1;return o===-1?a.length-1:o}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,a=[];let o,l;for(o=0,l=t.data.length;o<l;++o)a.push(i.getPixelForValue(this.getParsed(o)[i.axis],o));const u=e.barThickness;return{min:u||VA(t),pixels:a,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i,index:a},options:{base:o,minBarLength:l}}=this,u=o||0,f=this.getParsed(e),m=f._custom,p=Nm(m);let v=f[t.axis],y=0,S=i?this.applyStack(t,f,i):v,_,x;S!==v&&(y=S-v,S=v),p&&(v=m.barStart,S=m.barEnd-m.barStart,v!==0&&Ia(v)!==Ia(m.barEnd)&&(y=0),y+=v);const T=!mt(o)&&!p?o:y;let w=t.getPixelForValue(T);if(this.chart.getDataVisibility(e)?_=t.getPixelForValue(y+S):_=w,x=_-w,Math.abs(x)<l){x=$A(x,t,u)*l,v===u&&(w-=x/2);const E=t.getPixelForDecimal(0),C=t.getPixelForDecimal(1),N=Math.min(E,C),A=Math.max(E,C);w=Math.max(Math.min(w,A),N),_=w+x,i&&!p&&(f._stacks[t.axis]._visualValues[a]=t.getValueForPixel(_)-t.getValueForPixel(w))}if(w===t.getPixelForValue(u)){const E=Ia(x)*t.getLineWidthForValue(u)/2;w+=E,x-=E}return{size:x,base:w,head:_,center:_+x/2}}_calculateBarIndexPixels(e,t){const i=t.scale,a=this.options,o=a.skipNull,l=it(a.maxBarThickness,1/0);let u,f;const m=this._getAxisCount();if(t.grouped){const p=o?this._getStackCount(e):t.stackCount,v=a.barThickness==="flex"?YA(e,t,a,p*m):GA(e,t,a,p*m),y=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,S=this._getAxis().indexOf(it(y,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0)+S;u=v.start+v.chunk*_+v.chunk/2,f=Math.min(l,v.chunk*v.ratio)}else u=i.getPixelForValue(this.getParsed(e)[i.axis],e),f=Math.min(l,t.min*t.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,a=i.length;let o=0;for(;o<a;++o)this.getParsed(o)[t.axis]!==null&&!i[o].hidden&&i[o].draw(this._ctx)}}function e3(n,e,t){let i=1,a=1,o=0,l=0;if(e<Yt){const u=n,f=u+e,m=Math.cos(u),p=Math.sin(u),v=Math.cos(f),y=Math.sin(f),S=(C,N,A)=>Rc(C,u,f,!0)?1:Math.max(N,N*t,A,A*t),_=(C,N,A)=>Rc(C,u,f,!0)?-1:Math.min(N,N*t,A,A*t),x=S(0,m,v),T=S(cn,p,y),w=_(Tt,m,v),E=_(Tt+cn,p,y);i=(x-w)/2,a=(T-E)/2,o=-(x+w)/2,l=-(T+E)/2}return{ratioX:i,ratioY:a,offsetX:o,offsetY:l}}class t3 extends Xc{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:i,color:a}}=e.legend.options;return t.labels.map((o,l)=>{const f=e.getDatasetMeta(0).controller.getStyle(l);return{text:o,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:a,lineWidth:f.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,t,i){i.chart.toggleDataVisibility(t.index),i.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=i;else{let o=f=>+i[f];if(pt(i[e])){const{key:f="value"}=this._parsing;o=m=>+Qr(i[m],f)}let l,u;for(l=e,u=e+t;l<u;++l)a._parsed[l]=o(l)}}_getRotation(){return La(this.options.rotation-90)}_getCircumference(){return La(this.options.circumference)}_getRotationExtents(){let e=Yt,t=-Yt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const a=this.chart.getDatasetMeta(i).controller,o=a._getRotation(),l=a._getCircumference();e=Math.min(e,o),t=Math.max(t,o+l)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,a=this._cachedMeta,o=a.data,l=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,u=Math.max((Math.min(i.width,i.height)-l)/2,0),f=Math.min(i4(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:p,rotation:v}=this._getRotationExtents(),{ratioX:y,ratioY:S,offsetX:_,offsetY:x}=e3(v,p,f),T=(i.width-l)/y,w=(i.height-l)/S,E=Math.max(Math.min(T,w)/2,0),C=hb(this.options.radius,E),N=Math.max(C*f,0),A=(C-N)/this._getVisibleDatasetWeightTotal();this.offsetX=_*C,this.offsetY=x*C,a.total=this.calculateTotal(),this.outerRadius=C-A*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-A*m,0),this.updateElements(o,0,o.length,e)}_circumference(e,t){const i=this.options,a=this._cachedMeta,o=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||a._parsed[e]===null||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*o/Yt)}updateElements(e,t,i,a){const o=a==="reset",l=this.chart,u=l.chartArea,m=l.options.animation,p=(u.left+u.right)/2,v=(u.top+u.bottom)/2,y=o&&m.animateScale,S=y?0:this.innerRadius,_=y?0:this.outerRadius,{sharedOptions:x,includeOptions:T}=this._getSharedOptions(t,a);let w=this._getRotation(),E;for(E=0;E<t;++E)w+=this._circumference(E,o);for(E=t;E<t+i;++E){const C=this._circumference(E,o),N=e[E],A={x:p+this.offsetX,y:v+this.offsetY,startAngle:w,endAngle:w+C,circumference:C,outerRadius:_,innerRadius:S};T&&(A.options=x||this.resolveDataElementOptions(E,N.active?"active":a)),w+=C,this.updateElement(N,E,A,a)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,a;for(a=0;a<t.length;a++){const o=e._parsed[a];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(a)&&!t[a].hidden&&(i+=Math.abs(o))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Yt*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,a=i.data.labels||[],o=wp(t._parsed[e],i.options.locale);return{label:a[e]||"",value:o}}getMaxBorderWidth(e){let t=0;const i=this.chart;let a,o,l,u,f;if(!e){for(a=0,o=i.data.datasets.length;a<o;++a)if(i.isDatasetVisible(a)){l=i.getDatasetMeta(a),e=l.data,u=l.controller;break}}if(!e)return 0;for(a=0,o=e.length;a<o;++a)f=u.resolveDataElementOptions(a),f.borderAlign!=="inner"&&(t=Math.max(t,f.borderWidth||0,f.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,a=e.length;i<a;++i){const o=this.resolveDataElementOptions(i);t=Math.max(t,o.offset||0,o.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(it(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class n3 extends Xc{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:a=[],_dataset:o}=t,l=this.chart._animationsDisabled;let{start:u,count:f}=_4(t,a,l);this._drawStart=u,this._drawCount=f,T4(t)&&(u=0,f=a.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=a;const m=this.resolveDatasetElementOptions(e);this.options.showLine||(m.borderWidth=0),m.segment=this.options.segment,this.updateElement(i,void 0,{animated:!l,options:m},e),this.updateElements(a,u,f,e)}updateElements(e,t,i,a){const o=a==="reset",{iScale:l,vScale:u,_stacked:f,_dataset:m}=this._cachedMeta,{sharedOptions:p,includeOptions:v}=this._getSharedOptions(t,a),y=l.axis,S=u.axis,{spanGaps:_,segment:x}=this.options,T=Oc(_)?_:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||o||a==="none",E=t+i,C=e.length;let N=t>0&&this.getParsed(t-1);for(let A=0;A<C;++A){const I=e[A],D=w?I:{};if(A<t||A>=E){D.skip=!0;continue}const z=this.getParsed(A),L=mt(z[S]),H=D[y]=l.getPixelForValue(z[y],A),K=D[S]=o||L?u.getBasePixel():u.getPixelForValue(f?this.applyStack(u,z,f):z[S],A);D.skip=isNaN(H)||isNaN(K)||L,D.stop=A>0&&Math.abs(z[y]-N[y])>T,x&&(D.parsed=z,D.raw=m.data[A]),v&&(D.options=p||this.resolveDataElementOptions(A,I.active?"active":a)),w||this.updateElement(I,A,D,a),N=z}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,a=e.data||[];if(!a.length)return i;const o=a[0].size(this.resolveDataElementOptions(0)),l=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(i,o,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class i3 extends Xc{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,a){return eA.bind(this)(e,t,i,a)}update(e){const t=this._cachedMeta,i=t.dataset,a=t.data||[],o=t.iScale.getLabels();if(i.points=a,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const u={_loop:!0,_fullLoop:o.length===a.length,options:l};this.updateElement(i,void 0,u,e)}this.updateElements(a,0,a.length,e)}updateElements(e,t,i,a){const o=this._cachedMeta.rScale,l=a==="reset";for(let u=t;u<t+i;u++){const f=e[u],m=this.resolveDataElementOptions(u,f.active?"active":a),p=o.getPointPositionForValue(u,this.getParsed(u).r),v=l?o.xCenter:p.x,y=l?o.yCenter:p.y,S={x:v,y,angle:p.angle,skip:isNaN(v)||isNaN(y),options:m};this.updateElement(f,u,S,a)}}}function Ns(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Mp{static override(e){Object.assign(Mp.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Ns()}parse(){return Ns()}format(){return Ns()}add(){return Ns()}diff(){return Ns()}startOf(){return Ns()}endOf(){return Ns()}}var a3={_date:Mp};function r3(n,e,t,i){const{controller:a,data:o,_sorted:l}=n,u=a._cachedMeta.iScale,f=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(u&&e===u.axis&&e!=="r"&&l&&o.length){const m=u._reversePixels?v4:Ls;if(i){if(a._sharedOptions){const p=o[0],v=typeof p.getRange=="function"&&p.getRange(e);if(v){const y=m(o,e,t-v),S=m(o,e,t+v);return{lo:y.lo,hi:S.hi}}}}else{const p=m(o,e,t);if(f){const{vScale:v}=a._cachedMeta,{_parsed:y}=n,S=y.slice(0,p.lo+1).reverse().findIndex(x=>!mt(x[v.axis]));p.lo-=Math.max(0,S);const _=y.slice(p.hi).findIndex(x=>!mt(x[v.axis]));p.hi+=Math.max(0,_)}return p}}return{lo:0,hi:o.length-1}}function lf(n,e,t,i,a){const o=n.getSortedVisibleDatasetMetas(),l=t[e];for(let u=0,f=o.length;u<f;++u){const{index:m,data:p}=o[u],{lo:v,hi:y}=r3(o[u],e,l,a);for(let S=v;S<=y;++S){const _=p[S];_.skip||i(_,m,S)}}}function s3(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,a){const o=e?Math.abs(i.x-a.x):0,l=t?Math.abs(i.y-a.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(l,2))}}function Om(n,e,t,i,a){const o=[];return!a&&!n.isPointInArea(e)||lf(n,t,e,function(u,f,m){!a&&!or(u,n.chartArea,0)||u.inRange(e.x,e.y,i)&&o.push({element:u,datasetIndex:f,index:m})},!0),o}function o3(n,e,t,i){let a=[];function o(l,u,f){const{startAngle:m,endAngle:p}=l.getProps(["startAngle","endAngle"],i),{angle:v}=gb(l,{x:e.x,y:e.y});Rc(v,m,p)&&a.push({element:l,datasetIndex:u,index:f})}return lf(n,t,e,o),a}function l3(n,e,t,i,a,o){let l=[];const u=s3(t);let f=Number.POSITIVE_INFINITY;function m(p,v,y){const S=p.inRange(e.x,e.y,a);if(i&&!S)return;const _=p.getCenterPoint(a);if(!(!!o||n.isPointInArea(_))&&!S)return;const T=u(e,_);T<f?(l=[{element:p,datasetIndex:v,index:y}],f=T):T===f&&l.push({element:p,datasetIndex:v,index:y})}return lf(n,t,e,m),l}function Rm(n,e,t,i,a,o){return!o&&!n.isPointInArea(e)?[]:t==="r"&&!i?o3(n,e,t,a):l3(n,e,t,i,a,o)}function xy(n,e,t,i,a){const o=[],l=t==="x"?"inXRange":"inYRange";let u=!1;return lf(n,t,e,(f,m,p)=>{f[l]&&f[l](e[t],a)&&(o.push({element:f,datasetIndex:m,index:p}),u=u||f.inRange(e.x,e.y,a))}),i&&!u?[]:o}var c3={modes:{index(n,e,t,i){const a=Os(e,n),o=t.axis||"x",l=t.includeInvisible||!1,u=t.intersect?Om(n,a,o,i,l):Rm(n,a,o,!1,i,l),f=[];return u.length?(n.getSortedVisibleDatasetMetas().forEach(m=>{const p=u[0].index,v=m.data[p];v&&!v.skip&&f.push({element:v,datasetIndex:m.index,index:p})}),f):[]},dataset(n,e,t,i){const a=Os(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;let u=t.intersect?Om(n,a,o,i,l):Rm(n,a,o,!1,i,l);if(u.length>0){const f=u[0].datasetIndex,m=n.getDatasetMeta(f).data;u=[];for(let p=0;p<m.length;++p)u.push({element:m[p],datasetIndex:f,index:p})}return u},point(n,e,t,i){const a=Os(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return Om(n,a,o,i,l)},nearest(n,e,t,i){const a=Os(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return Rm(n,a,o,t.intersect,i,l)},x(n,e,t,i){const a=Os(e,n);return xy(n,a,"x",t.intersect,i)},y(n,e,t,i){const a=Os(e,n);return xy(n,a,"y",t.intersect,i)}}};const Mb=["left","top","right","bottom"];function sc(n,e){return n.filter(t=>t.pos===e)}function by(n,e){return n.filter(t=>Mb.indexOf(t.pos)===-1&&t.box.axis===e)}function oc(n,e){return n.sort((t,i)=>{const a=e?i:t,o=e?t:i;return a.weight===o.weight?a.index-o.index:a.weight-o.weight})}function u3(n){const e=[];let t,i,a,o,l,u;for(t=0,i=(n||[]).length;t<i;++t)a=n[t],{position:o,options:{stack:l,stackWeight:u=1}}=a,e.push({index:t,box:a,pos:o,horizontal:a.isHorizontal(),weight:a.weight,stack:l&&o+l,stackWeight:u});return e}function d3(n){const e={};for(const t of n){const{stack:i,pos:a,stackWeight:o}=t;if(!i||!Mb.includes(a))continue;const l=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=o}return e}function f3(n,e){const t=d3(n),{vBoxMaxWidth:i,hBoxMaxHeight:a}=e;let o,l,u;for(o=0,l=n.length;o<l;++o){u=n[o];const{fullSize:f}=u.box,m=t[u.stack],p=m&&u.stackWeight/m.weight;u.horizontal?(u.width=p?p*i:f&&e.availableWidth,u.height=a):(u.width=i,u.height=p?p*a:f&&e.availableHeight)}return t}function h3(n){const e=u3(n),t=oc(e.filter(m=>m.box.fullSize),!0),i=oc(sc(e,"left"),!0),a=oc(sc(e,"right")),o=oc(sc(e,"top"),!0),l=oc(sc(e,"bottom")),u=by(e,"x"),f=by(e,"y");return{fullSize:t,leftAndTop:i.concat(o),rightAndBottom:a.concat(f).concat(l).concat(u),chartArea:sc(e,"chartArea"),vertical:i.concat(a).concat(f),horizontal:o.concat(l).concat(u)}}function Sy(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function Lb(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function m3(n,e,t,i){const{pos:a,box:o}=t,l=n.maxPadding;if(!pt(a)){t.size&&(n[a]-=t.size);const v=i[t.stack]||{size:0,count:1};v.size=Math.max(v.size,t.horizontal?o.height:o.width),t.size=v.size/v.count,n[a]+=t.size}o.getPadding&&Lb(l,o.getPadding());const u=Math.max(0,e.outerWidth-Sy(l,n,"left","right")),f=Math.max(0,e.outerHeight-Sy(l,n,"top","bottom")),m=u!==n.w,p=f!==n.h;return n.w=u,n.h=f,t.horizontal?{same:m,other:p}:{same:p,other:m}}function p3(n){const e=n.maxPadding;function t(i){const a=Math.max(e[i]-n[i],0);return n[i]+=a,a}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function g3(n,e){const t=e.maxPadding;function i(a){const o={left:0,top:0,right:0,bottom:0};return a.forEach(l=>{o[l]=Math.max(e[l],t[l])}),o}return i(n?["left","right"]:["top","bottom"])}function pc(n,e,t,i){const a=[];let o,l,u,f,m,p;for(o=0,l=n.length,m=0;o<l;++o){u=n[o],f=u.box,f.update(u.width||e.w,u.height||e.h,g3(u.horizontal,e));const{same:v,other:y}=m3(e,t,u,i);m|=v&&a.length,p=p||y,f.fullSize||a.push(u)}return m&&pc(a,e,t,i)||p}function pd(n,e,t,i,a){n.top=t,n.left=e,n.right=e+i,n.bottom=t+a,n.width=i,n.height=a}function _y(n,e,t,i){const a=t.padding;let{x:o,y:l}=e;for(const u of n){const f=u.box,m=i[u.stack]||{placed:0,weight:1},p=u.stackWeight/m.weight||1;if(u.horizontal){const v=e.w*p,y=m.size||f.height;Nc(m.start)&&(l=m.start),f.fullSize?pd(f,a.left,l,t.outerWidth-a.right-a.left,y):pd(f,e.left+m.placed,l,v,y),m.start=l,m.placed+=v,l=f.bottom}else{const v=e.h*p,y=m.size||f.width;Nc(m.start)&&(o=m.start),f.fullSize?pd(f,o,a.top,y,t.outerHeight-a.bottom-a.top):pd(f,o,e.top+m.placed,y,v),m.start=o,m.placed+=v,o=f.right}}e.x=o,e.y=l}var na={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const a=Jn(n.options.layout.padding),o=Math.max(e-a.width,0),l=Math.max(t-a.height,0),u=h3(n.boxes),f=u.vertical,m=u.horizontal;jt(n.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const p=f.reduce((x,T)=>T.box.options&&T.box.options.display===!1?x:x+1,0)||1,v=Object.freeze({outerWidth:e,outerHeight:t,padding:a,availableWidth:o,availableHeight:l,vBoxMaxWidth:o/2/p,hBoxMaxHeight:l/2}),y=Object.assign({},a);Lb(y,Jn(i));const S=Object.assign({maxPadding:y,w:o,h:l,x:a.left,y:a.top},a),_=f3(f.concat(m),v);pc(u.fullSize,S,v,_),pc(f,S,v,_),pc(m,S,v,_)&&pc(f,S,v,_),p3(S),_y(u.leftAndTop,S,v,_),S.x+=S.w,S.y+=S.h,_y(u.rightAndBottom,S,v,_),n.chartArea={left:S.left,top:S.top,right:S.left+S.w,bottom:S.top+S.h,height:S.h,width:S.w},jt(u.chartArea,x=>{const T=x.box;Object.assign(T,n.chartArea),T.update(S.w,S.h,{left:0,top:0,right:0,bottom:0})})}};class Ib{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,a){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,a?Math.floor(t/a):i)}}isAttached(e){return!0}updateConfig(e){}}class v3 extends Ib{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Rd="$chartjs",y3={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ty=n=>n===null||n==="";function x3(n,e){const t=n.style,i=n.getAttribute("height"),a=n.getAttribute("width");if(n[Rd]={initial:{height:i,width:a,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Ty(a)){const o=sy(n,"width");o!==void 0&&(n.width=o)}if(Ty(i))if(n.style.height==="")n.height=n.width/(e||2);else{const o=sy(n,"height");o!==void 0&&(n.height=o)}return n}const Pb=mA?{passive:!0}:!1;function b3(n,e,t){n&&n.addEventListener(e,t,Pb)}function S3(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,Pb)}function _3(n,e){const t=y3[n.type]||n.type,{x:i,y:a}=Os(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:a!==void 0?a:null}}function zd(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function T3(n,e,t){const i=n.canvas,a=new MutationObserver(o=>{let l=!1;for(const u of o)l=l||zd(u.addedNodes,i),l=l&&!zd(u.removedNodes,i);l&&t()});return a.observe(document,{childList:!0,subtree:!0}),a}function w3(n,e,t){const i=n.canvas,a=new MutationObserver(o=>{let l=!1;for(const u of o)l=l||zd(u.removedNodes,i),l=l&&!zd(u.addedNodes,i);l&&t()});return a.observe(document,{childList:!0,subtree:!0}),a}const Lc=new Map;let wy=0;function Bb(){const n=window.devicePixelRatio;n!==wy&&(wy=n,Lc.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function E3(n,e){Lc.size||window.addEventListener("resize",Bb),Lc.set(n,e)}function A3(n){Lc.delete(n),Lc.size||window.removeEventListener("resize",Bb)}function k3(n,e,t){const i=n.canvas,a=i&&Rp(i);if(!a)return;const o=bb((u,f)=>{const m=a.clientWidth;t(u,f),m<a.clientWidth&&t()},window),l=new ResizeObserver(u=>{const f=u[0],m=f.contentRect.width,p=f.contentRect.height;m===0&&p===0||o(m,p)});return l.observe(a),E3(n,o),l}function Mm(n,e,t){t&&t.disconnect(),e==="resize"&&A3(n)}function C3(n,e,t){const i=n.canvas,a=bb(o=>{n.ctx!==null&&t(_3(o,n))},n);return b3(i,e,a),a}class j3 extends Ib{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(x3(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[Rd])return!1;const i=t[Rd].initial;["height","width"].forEach(o=>{const l=i[o];mt(l)?t.removeAttribute(o):t.setAttribute(o,l)});const a=i.style||{};return Object.keys(a).forEach(o=>{t.style[o]=a[o]}),t.width=t.width,delete t[Rd],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const a=e.$proxies||(e.$proxies={}),l={attach:T3,detach:w3,resize:k3}[t]||C3;a[t]=l(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),a=i[t];if(!a)return;({attach:Mm,detach:Mm,resize:Mm}[t]||S3)(e,t,a),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,a){return hA(e,t,i,a)}isAttached(e){const t=e&&Rp(e);return!!(t&&t.isConnected)}}function D3(n){return!Op()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?v3:j3}class pr{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return Oc(this.x)&&Oc(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const a={};return e.forEach(o=>{a[o]=i[o]&&i[o].active()?i[o]._to:this[o]}),a}}function N3(n,e){const t=n.options.ticks,i=O3(n),a=Math.min(t.maxTicksLimit||i,i),o=t.major.enabled?M3(e):[],l=o.length,u=o[0],f=o[l-1],m=[];if(l>a)return L3(e,m,o,l/a),m;const p=R3(o,e,a);if(l>0){let v,y;const S=l>1?Math.round((f-u)/(l-1)):null;for(gd(e,m,p,mt(S)?0:u-S,u),v=0,y=l-1;v<y;v++)gd(e,m,p,o[v],o[v+1]);return gd(e,m,p,f,mt(S)?e.length:f+S),m}return gd(e,m,p),m}function O3(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),a=n._maxLength/t;return Math.floor(Math.min(i,a))}function R3(n,e,t){const i=I3(n),a=e.length/t;if(!i)return Math.max(a,1);const o=d4(i);for(let l=0,u=o.length-1;l<u;l++){const f=o[l];if(f>a)return f}return Math.max(a,1)}function M3(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function L3(n,e,t,i){let a=0,o=t[0],l;for(i=Math.ceil(i),l=0;l<n.length;l++)l===o&&(e.push(n[l]),a++,o=t[a*i])}function gd(n,e,t,i,a){const o=it(i,0),l=Math.min(it(a,n.length),n.length);let u=0,f,m,p;for(t=Math.ceil(t),a&&(f=a-i,t=f/Math.floor(f/t)),p=o;p<0;)u++,p=Math.round(o+u*t);for(m=Math.max(o,0);m<l;m++)m===p&&(e.push(n[m]),u++,p=Math.round(o+u*t))}function I3(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const P3=n=>n==="left"?"right":n==="right"?"left":n,Ey=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,Ay=(n,e)=>Math.min(e||n,n);function ky(n,e){const t=[],i=n.length/e,a=n.length;let o=0;for(;o<a;o+=i)t.push(n[Math.floor(o)]);return t}function B3(n,e,t){const i=n.ticks.length,a=Math.min(e,i-1),o=n._startPixel,l=n._endPixel,u=1e-6;let f=n.getPixelForTick(a),m;if(!(t&&(i===1?m=Math.max(f-o,l-f):e===0?m=(n.getPixelForTick(1)-f)/2:m=(f-n.getPixelForTick(a-1))/2,f+=a<e?m:-m,f<o-u||f>l+u)))return f}function F3(n,e){jt(n,t=>{const i=t.gc,a=i.length/2;let o;if(a>e){for(o=0;o<a;++o)delete t.data[i[o]];i.splice(0,a)}})}function lc(n){return n.drawTicks?n.tickLength:0}function Cy(n,e){if(!n.display)return 0;const t=Tn(n.font,e),i=Jn(n.padding);return(Qt(n.text)?n.text.length:1)*t.lineHeight+i.height}function U3(n,e){return is(n,{scale:e,type:"scale"})}function z3(n,e,t){return is(n,{tick:t,index:e,type:"tick"})}function H3(n,e,t){let i=_p(n);return(t&&e!=="right"||!t&&e==="right")&&(i=P3(i)),i}function W3(n,e,t,i){const{top:a,left:o,bottom:l,right:u,chart:f}=n,{chartArea:m,scales:p}=f;let v=0,y,S,_;const x=l-a,T=u-o;if(n.isHorizontal()){if(S=qn(i,o,u),pt(t)){const w=Object.keys(t)[0],E=t[w];_=p[w].getPixelForValue(E)+x-e}else t==="center"?_=(m.bottom+m.top)/2+x-e:_=Ey(n,t,e);y=u-o}else{if(pt(t)){const w=Object.keys(t)[0],E=t[w];S=p[w].getPixelForValue(E)-T+e}else t==="center"?S=(m.left+m.right)/2-T+e:S=Ey(n,t,e);_=qn(i,l,a),v=t==="left"?-cn:cn}return{titleX:S,titleY:_,maxWidth:y,rotation:v}}class el extends pr{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:a}=this;return e=ja(e,Number.POSITIVE_INFINITY),t=ja(t,Number.NEGATIVE_INFINITY),i=ja(i,Number.POSITIVE_INFINITY),a=ja(a,Number.NEGATIVE_INFINITY),{min:ja(e,i),max:ja(t,a),minDefined:Si(e),maxDefined:Si(t)}}getMinMax(e){let{min:t,max:i,minDefined:a,maxDefined:o}=this.getUserBounds(),l;if(a&&o)return{min:t,max:i};const u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)l=u[f].controller.getMinMax(this,e),a||(t=Math.min(t,l.min)),o||(i=Math.max(i,l.max));return t=o&&t>i?i:t,i=a&&t>i?t:i,{min:ja(t,ja(i,t)),max:ja(i,ja(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){zt(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:a,grace:o,ticks:l}=this.options,u=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=V4(this,o,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?ky(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=N3(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){zt(this.options.afterUpdate,[this])}beforeSetDimensions(){zt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){zt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),zt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){zt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,a,o;for(i=0,a=e.length;i<a;i++)o=e[i],o.label=zt(t.callback,[o.value,i,e],this)}afterTickToLabelConversion(){zt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){zt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=Ay(this.ticks.length,e.ticks.maxTicksLimit),a=t.minRotation||0,o=t.maxRotation;let l=a,u,f,m;if(!this._isVisible()||!t.display||a>=o||i<=1||!this.isHorizontal()){this.labelRotation=a;return}const p=this._getLabelSizes(),v=p.widest.width,y=p.highest.height,S=Kn(this.chart.width-v,0,this.maxWidth);u=e.offset?this.maxWidth/i:S/(i-1),v+6>u&&(u=S/(i-(e.offset?.5:1)),f=this.maxHeight-lc(e.grid)-t.padding-Cy(e.title,this.chart.options.font),m=Math.sqrt(v*v+y*y),l=bp(Math.min(Math.asin(Kn((p.highest.height+6)/u,-1,1)),Math.asin(Kn(f/m,-1,1))-Math.asin(Kn(y/m,-1,1)))),l=Math.max(a,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){zt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){zt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:a,grid:o}}=this,l=this._isVisible(),u=this.isHorizontal();if(l){const f=Cy(a,t.options.font);if(u?(e.width=this.maxWidth,e.height=lc(o)+f):(e.height=this.maxHeight,e.width=lc(o)+f),i.display&&this.ticks.length){const{first:m,last:p,widest:v,highest:y}=this._getLabelSizes(),S=i.padding*2,_=La(this.labelRotation),x=Math.cos(_),T=Math.sin(_);if(u){const w=i.mirror?0:T*v.width+x*y.height;e.height=Math.min(this.maxHeight,e.height+w+S)}else{const w=i.mirror?0:x*v.width+T*y.height;e.width=Math.min(this.maxWidth,e.width+w+S)}this._calculatePadding(m,p,T,x)}}this._handleMargins(),u?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,a){const{ticks:{align:o,padding:l},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const p=this.getPixelForTick(0)-this.left,v=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,S=0;f?m?(y=a*e.width,S=i*t.height):(y=i*e.height,S=a*t.width):o==="start"?S=t.width:o==="end"?y=e.width:o!=="inner"&&(y=e.width/2,S=t.width/2),this.paddingLeft=Math.max((y-p+l)*this.width/(this.width-p),0),this.paddingRight=Math.max((S-v+l)*this.width/(this.width-v),0)}else{let p=t.height/2,v=e.height/2;o==="start"?(p=0,v=e.height):o==="end"&&(p=t.height,v=0),this.paddingTop=p+l,this.paddingBottom=v+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){zt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)mt(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=ky(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,i){const{ctx:a,_longestTextCache:o}=this,l=[],u=[],f=Math.floor(t/Ay(t,i));let m=0,p=0,v,y,S,_,x,T,w,E,C,N,A;for(v=0;v<t;v+=f){if(_=e[v].label,x=this._resolveTickFontOptions(v),a.font=T=x.string,w=o[T]=o[T]||{data:{},gc:[]},E=x.lineHeight,C=N=0,!mt(_)&&!Qt(_))C=Fd(a,w.data,w.gc,C,_),N=E;else if(Qt(_))for(y=0,S=_.length;y<S;++y)A=_[y],!mt(A)&&!Qt(A)&&(C=Fd(a,w.data,w.gc,C,A),N+=E);l.push(C),u.push(N),m=Math.max(C,m),p=Math.max(N,p)}F3(o,t);const I=l.indexOf(m),D=u.indexOf(p),z=L=>({width:l[L]||0,height:u[L]||0});return{first:z(0),last:z(t-1),widest:z(I),highest:z(D),widths:l,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return g4(this._alignToPixels?Ds(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=z3(this.getContext(),e,i))}return this.$context||(this.$context=U3(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=La(this.labelRotation),i=Math.abs(Math.cos(t)),a=Math.abs(Math.sin(t)),o=this._getLabelSizes(),l=e.autoSkipPadding||0,u=o?o.widest.width+l:0,f=o?o.highest.height+l:0;return this.isHorizontal()?f*i>u*a?u/i:f/a:f*a<u*i?f/i:u/a}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,a=this.options,{grid:o,position:l,border:u}=a,f=o.offset,m=this.isHorizontal(),v=this.ticks.length+(f?1:0),y=lc(o),S=[],_=u.setContext(this.getContext()),x=_.display?_.width:0,T=x/2,w=function(ie){return Ds(i,ie,x)};let E,C,N,A,I,D,z,L,H,K,ne,xe;if(l==="top")E=w(this.bottom),D=this.bottom-y,L=E-T,K=w(e.top)+T,xe=e.bottom;else if(l==="bottom")E=w(this.top),K=e.top,xe=w(e.bottom)-T,D=E+T,L=this.top+y;else if(l==="left")E=w(this.right),I=this.right-y,z=E-T,H=w(e.left)+T,ne=e.right;else if(l==="right")E=w(this.left),H=e.left,ne=w(e.right)-T,I=E+T,z=this.left+y;else if(t==="x"){if(l==="center")E=w((e.top+e.bottom)/2+.5);else if(pt(l)){const ie=Object.keys(l)[0],he=l[ie];E=w(this.chart.scales[ie].getPixelForValue(he))}K=e.top,xe=e.bottom,D=E+T,L=D+y}else if(t==="y"){if(l==="center")E=w((e.left+e.right)/2);else if(pt(l)){const ie=Object.keys(l)[0],he=l[ie];E=w(this.chart.scales[ie].getPixelForValue(he))}I=E-T,z=I-y,H=e.left,ne=e.right}const He=it(a.ticks.maxTicksLimit,v),_e=Math.max(1,Math.ceil(v/He));for(C=0;C<v;C+=_e){const ie=this.getContext(C),he=o.setContext(ie),Ne=u.setContext(ie),Be=he.lineWidth,X=he.color,pe=Ne.dash||[],P=Ne.dashOffset,Y=he.tickWidth,V=he.tickColor,q=he.tickBorderDash||[],re=he.tickBorderDashOffset;N=B3(this,C,f),N!==void 0&&(A=Ds(i,N,Be),m?I=z=H=ne=A:D=L=K=xe=A,S.push({tx1:I,ty1:D,tx2:z,ty2:L,x1:H,y1:K,x2:ne,y2:xe,width:Be,color:X,borderDash:pe,borderDashOffset:P,tickWidth:Y,tickColor:V,tickBorderDash:q,tickBorderDashOffset:re}))}return this._ticksLength=v,this._borderValue=E,S}_computeLabelItems(e){const t=this.axis,i=this.options,{position:a,ticks:o}=i,l=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:p,mirror:v}=o,y=lc(i.grid),S=y+p,_=v?-p:S,x=-La(this.labelRotation),T=[];let w,E,C,N,A,I,D,z,L,H,K,ne,xe="middle";if(a==="top")I=this.bottom-_,D=this._getXAxisLabelAlignment();else if(a==="bottom")I=this.top+_,D=this._getXAxisLabelAlignment();else if(a==="left"){const _e=this._getYAxisLabelAlignment(y);D=_e.textAlign,A=_e.x}else if(a==="right"){const _e=this._getYAxisLabelAlignment(y);D=_e.textAlign,A=_e.x}else if(t==="x"){if(a==="center")I=(e.top+e.bottom)/2+S;else if(pt(a)){const _e=Object.keys(a)[0],ie=a[_e];I=this.chart.scales[_e].getPixelForValue(ie)+S}D=this._getXAxisLabelAlignment()}else if(t==="y"){if(a==="center")A=(e.left+e.right)/2-S;else if(pt(a)){const _e=Object.keys(a)[0],ie=a[_e];A=this.chart.scales[_e].getPixelForValue(ie)}D=this._getYAxisLabelAlignment(y).textAlign}t==="y"&&(f==="start"?xe="top":f==="end"&&(xe="bottom"));const He=this._getLabelSizes();for(w=0,E=u.length;w<E;++w){C=u[w],N=C.label;const _e=o.setContext(this.getContext(w));z=this.getPixelForTick(w)+o.labelOffset,L=this._resolveTickFontOptions(w),H=L.lineHeight,K=Qt(N)?N.length:1;const ie=K/2,he=_e.color,Ne=_e.textStrokeColor,Be=_e.textStrokeWidth;let X=D;l?(A=z,D==="inner"&&(w===E-1?X=this.options.reverse?"left":"right":w===0?X=this.options.reverse?"right":"left":X="center"),a==="top"?m==="near"||x!==0?ne=-K*H+H/2:m==="center"?ne=-He.highest.height/2-ie*H+H:ne=-He.highest.height+H/2:m==="near"||x!==0?ne=H/2:m==="center"?ne=He.highest.height/2-ie*H:ne=He.highest.height-K*H,v&&(ne*=-1),x!==0&&!_e.showLabelBackdrop&&(A+=H/2*Math.sin(x))):(I=z,ne=(1-K)*H/2);let pe;if(_e.showLabelBackdrop){const P=Jn(_e.backdropPadding),Y=He.heights[w],V=He.widths[w];let q=ne-P.top,re=0-P.left;switch(xe){case"middle":q-=Y/2;break;case"bottom":q-=Y;break}switch(D){case"center":re-=V/2;break;case"right":re-=V;break;case"inner":w===E-1?re-=V:w>0&&(re-=V/2);break}pe={left:re,top:q,width:V+P.width,height:Y+P.height,color:_e.backdropColor}}T.push({label:N,font:L,textOffset:ne,options:{rotation:x,color:he,strokeColor:Ne,strokeWidth:Be,textAlign:X,textBaseline:xe,translation:[A,I],backdrop:pe}})}return T}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-La(this.labelRotation))return e==="top"?"left":"right";let a="center";return t.align==="start"?a="left":t.align==="end"?a="right":t.align==="inner"&&(a="inner"),a}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:a,padding:o}}=this.options,l=this._getLabelSizes(),u=e+o,f=l.widest.width;let m,p;return t==="left"?a?(p=this.right+o,i==="near"?m="left":i==="center"?(m="center",p+=f/2):(m="right",p+=f)):(p=this.right-u,i==="near"?m="right":i==="center"?(m="center",p-=f/2):(m="left",p=this.left)):t==="right"?a?(p=this.left+o,i==="near"?m="right":i==="center"?(m="center",p-=f/2):(m="left",p-=f)):(p=this.left+u,i==="near"?m="left":i==="center"?(m="center",p+=f/2):(m="right",p=this.right)):m="right",{textAlign:m,x:p}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:a,width:o,height:l}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,a,o,l),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const a=this.ticks.findIndex(o=>o.value===e);return a>=0?t.setContext(this.getContext(a)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,l;const u=(f,m,p)=>{!p.width||!p.color||(i.save(),i.lineWidth=p.width,i.strokeStyle=p.color,i.setLineDash(p.borderDash||[]),i.lineDashOffset=p.borderDashOffset,i.beginPath(),i.moveTo(f.x,f.y),i.lineTo(m.x,m.y),i.stroke(),i.restore())};if(t.display)for(o=0,l=a.length;o<l;++o){const f=a[o];t.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),t.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:i,grid:a}}=this,o=i.setContext(this.getContext()),l=i.display?o.width:0;if(!l)return;const u=a.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,p,v,y;this.isHorizontal()?(m=Ds(e,this.left,l)-l/2,p=Ds(e,this.right,u)+u/2,v=y=f):(v=Ds(e,this.top,l)-l/2,y=Ds(e,this.bottom,u)+u/2,m=p=f),t.save(),t.lineWidth=o.width,t.strokeStyle=o.color,t.beginPath(),t.moveTo(m,v),t.lineTo(p,y),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,a=this._computeLabelArea();a&&Ap(i,a);const o=this.getLabelItems(e);for(const l of o){const u=l.options,f=l.font,m=l.label,p=l.textOffset;Us(i,m,0,p,f,u)}a&&kp(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:a}}=this;if(!i.display)return;const o=Tn(i.font),l=Jn(i.padding),u=i.align;let f=o.lineHeight/2;t==="bottom"||t==="center"||pt(t)?(f+=l.bottom,Qt(i.text)&&(f+=o.lineHeight*(i.text.length-1))):f+=l.top;const{titleX:m,titleY:p,maxWidth:v,rotation:y}=W3(this,f,t,u);Us(e,i.text,0,0,o,{color:i.color,maxWidth:v,rotation:y,textAlign:H3(u,t,a),textBaseline:"middle",translation:[m,p]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=it(e.grid&&e.grid.z,-1),a=it(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==el.prototype.draw?[{z:t,draw:o=>{this.draw(o)}}]:[{z:i,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:t,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",a=[];let o,l;for(o=0,l=t.length;o<l;++o){const u=t[o];u[i]===this.id&&(!e||u.type===e)&&a.push(u)}return a}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Tn(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class vd{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;Y3(t)&&(i=this.register(t));const a=this.items,o=e.id,l=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in a||(a[o]=e,V3(e,l,i),this.override&&rn.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,a=this.scope;i in t&&delete t[i],a&&i in rn[a]&&(delete rn[a][i],this.override&&delete Fs[i])}}function V3(n,e,t){const i=Dc(Object.create(null),[t?rn.get(t):{},rn.get(e),n.defaults]);rn.set(e,i),n.defaultRoutes&&G3(e,n.defaultRoutes),n.descriptors&&rn.describe(e,n.descriptors)}function G3(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),a=i.pop(),o=[n].concat(i).join("."),l=e[t].split("."),u=l.pop(),f=l.join(".");rn.route(o,a,f,u)})}function Y3(n){return"id"in n&&"defaults"in n}class X3{constructor(){this.controllers=new vd(Xc,"datasets",!0),this.elements=new vd(pr,"elements"),this.plugins=new vd(Object,"plugins"),this.scales=new vd(el,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(a=>{const o=i||this._getRegistryForType(a);i||o.isForType(a)||o===this.plugins&&a.id?this._exec(e,o,a):jt(a,l=>{const u=i||this._getRegistryForType(l);this._exec(e,u,l)})})}_exec(e,t,i){const a=xp(e);zt(i["before"+a],[],i),t[e](i),zt(i["after"+a],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const a=t.get(e);if(a===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return a}}var Ra=new X3;class $3{constructor(){this._init=[]}notify(e,t,i,a){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=a?this._descriptors(e).filter(a):this._descriptors(e),l=this._notify(o,e,t,i);return t==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),l}_notify(e,t,i,a){a=a||{};for(const o of e){const l=o.plugin,u=l[i],f=[t,a,o.options];if(zt(u,f,l)===!1&&a.cancelable)return!1}return!0}invalidate(){mt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,a=it(i.options&&i.options.plugins,{}),o=q3(i);return a===!1&&!t?[]:Z3(e,o,a,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,a=(o,l)=>o.filter(u=>!l.some(f=>u.plugin.id===f.plugin.id));this._notify(a(t,i),e,"stop"),this._notify(a(i,t),e,"start")}}function q3(n){const e={},t=[],i=Object.keys(Ra.plugins.items);for(let o=0;o<i.length;o++)t.push(Ra.getPlugin(i[o]));const a=n.plugins||[];for(let o=0;o<a.length;o++){const l=a[o];t.indexOf(l)===-1&&(t.push(l),e[l.id]=!0)}return{plugins:t,localIds:e}}function K3(n,e){return!e&&n===!1?null:n===!0?{}:n}function Z3(n,{plugins:e,localIds:t},i,a){const o=[],l=n.getContext();for(const u of e){const f=u.id,m=K3(i[f],a);m!==null&&o.push({plugin:u,options:Q3(n.config,{plugin:u,local:t[f]},m,l)})}return o}function Q3(n,{plugin:e,local:t},i,a){const o=n.pluginScopeKeys(e),l=n.getOptionScopes(i,o);return t&&e.defaults&&l.push(e.defaults),n.createResolver(l,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Qm(n,e){const t=rn.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function J3(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function ek(n,e){return n===e?"_index_":"_value_"}function jy(n){if(n==="x"||n==="y"||n==="r")return n}function tk(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Jm(n,...e){if(jy(n))return n;for(const t of e){const i=t.axis||tk(t.position)||n.length>1&&jy(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function Dy(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function nk(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(t.length)return Dy(n,"x",t[0])||Dy(n,"y",t[0])}return{}}function ik(n,e){const t=Fs[n.type]||{scales:{}},i=e.scales||{},a=Qm(n.type,e),o=Object.create(null);return Object.keys(i).forEach(l=>{const u=i[l];if(!pt(u))return console.error(`Invalid scale configuration for scale: ${l}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const f=Jm(l,u,nk(l,n),rn.scales[u.type]),m=ek(f,a),p=t.scales||{};o[l]=yc(Object.create(null),[{axis:f},u,p[f],p[m]])}),n.data.datasets.forEach(l=>{const u=l.type||n.type,f=l.indexAxis||Qm(u,e),p=(Fs[u]||{}).scales||{};Object.keys(p).forEach(v=>{const y=J3(v,f),S=l[y+"AxisID"]||y;o[S]=o[S]||Object.create(null),yc(o[S],[{axis:y},i[S],p[v]])})}),Object.keys(o).forEach(l=>{const u=o[l];yc(u,[rn.scales[u.type],rn.scale])}),o}function Fb(n){const e=n.options||(n.options={});e.plugins=it(e.plugins,{}),e.scales=ik(n,e)}function Ub(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function ak(n){return n=n||{},n.data=Ub(n.data),Fb(n),n}const Ny=new Map,zb=new Set;function yd(n,e){let t=Ny.get(n);return t||(t=e(),Ny.set(n,t),zb.add(t)),t}const cc=(n,e,t)=>{const i=Qr(e,t);i!==void 0&&n.add(i)};class rk{constructor(e){this._config=ak(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Ub(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Fb(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return yd(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return yd(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return yd(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return yd(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let a=i.get(e);return(!a||t)&&(a=new Map,i.set(e,a)),a}getOptionScopes(e,t,i){const{options:a,type:o}=this,l=this._cachedScopes(e,i),u=l.get(t);if(u)return u;const f=new Set;t.forEach(p=>{e&&(f.add(e),p.forEach(v=>cc(f,e,v))),p.forEach(v=>cc(f,a,v)),p.forEach(v=>cc(f,Fs[o]||{},v)),p.forEach(v=>cc(f,rn,v)),p.forEach(v=>cc(f,Km,v))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),zb.has(t)&&l.set(t,m),m}chartOptionScopes(){const{options:e,type:t}=this;return[e,Fs[t]||{},rn.datasets[t]||{},{type:t},rn,Km]}resolveNamedOptions(e,t,i,a=[""]){const o={$shared:!0},{resolver:l,subPrefixes:u}=Oy(this._resolverCache,e,a);let f=l;if(ok(l,t)){o.$shared=!1,i=Jr(i)?i():i;const m=this.createResolver(e,i,u);f=Xo(l,i,m)}for(const m of t)o[m]=f[m];return o}createResolver(e,t,i=[""],a){const{resolver:o}=Oy(this._resolverCache,e,i);return pt(t)?Xo(o,t,void 0,a):o}}function Oy(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const a=t.join();let o=i.get(a);return o||(o={resolver:jp(e,t),subPrefixes:t.filter(u=>!u.toLowerCase().includes("hover"))},i.set(a,o)),o}const sk=n=>pt(n)&&Object.getOwnPropertyNames(n).some(e=>Jr(n[e]));function ok(n,e){const{isScriptable:t,isIndexable:i}=Tb(n);for(const a of e){const o=t(a),l=i(a),u=(l||o)&&n[a];if(o&&(Jr(u)||sk(u))||l&&Qt(u))return!0}return!1}var lk="4.5.0";const ck=["top","bottom","left","right","chartArea"];function Ry(n,e){return n==="top"||n==="bottom"||ck.indexOf(n)===-1&&e==="x"}function My(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function Ly(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),zt(t&&t.onComplete,[n],e)}function uk(n){const e=n.chart,t=e.options.animation;zt(t&&t.onProgress,[n],e)}function Hb(n){return Op()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Md={},Iy=n=>{const e=Hb(n);return Object.values(Md).filter(t=>t.canvas===e).pop()};function dk(n,e,t){const i=Object.keys(n);for(const a of i){const o=+a;if(o>=e){const l=n[a];delete n[a],(t>0||o>e)&&(n[o+t]=l)}}}function fk(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}let cf=class{static defaults=rn;static instances=Md;static overrides=Fs;static registry=Ra;static version=lk;static getChart=Iy;static register(...e){Ra.add(...e),Py()}static unregister(...e){Ra.remove(...e),Py()}constructor(e,t){const i=this.config=new rk(t),a=Hb(e),o=Iy(a);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const l=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||D3(a)),this.platform.updateConfig(i);const u=this.platform.acquireContext(a,l.aspectRatio),f=u&&u.canvas,m=f&&f.height,p=f&&f.width;if(this.id=n4(),this.ctx=u,this.canvas=f,this.width=p,this.height=m,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new $3,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=b4(v=>this.update(v),l.resizeDelay||0),this._dataChanges=[],Md[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}ar.listen(this,"complete",Ly),ar.listen(this,"progress",uk),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:a,_aspectRatio:o}=this;return mt(e)?t&&o?o:a?i/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ra}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():ry(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ny(this.canvas,this.ctx),this}stop(){return ar.stop(this),this}resize(e,t){ar.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,a=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(a,e,t,o),u=i.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,ry(this,u,!0)&&(this.notifyPlugins("resize",{size:l}),zt(i.onResize,[this,l],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};jt(t,(i,a)=>{i.id=a})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,a=Object.keys(i).reduce((l,u)=>(l[u]=!1,l),{});let o=[];t&&(o=o.concat(Object.keys(t).map(l=>{const u=t[l],f=Jm(l,u),m=f==="r",p=f==="x";return{options:u,dposition:m?"chartArea":p?"bottom":"left",dtype:m?"radialLinear":p?"category":"linear"}}))),jt(o,l=>{const u=l.options,f=u.id,m=Jm(f,u),p=it(u.type,l.dtype);(u.position===void 0||Ry(u.position,m)!==Ry(l.dposition))&&(u.position=l.dposition),a[f]=!0;let v=null;if(f in i&&i[f].type===p)v=i[f];else{const y=Ra.getScale(p);v=new y({id:f,type:p,ctx:this.ctx,chart:this}),i[v.id]=v}v.init(u,e)}),jt(a,(l,u)=>{l||delete i[u]}),jt(i,l=>{na.configure(this,l,l.options),na.addBox(this,l)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((a,o)=>a.index-o.index),i>t){for(let a=t;a<i;++a)this._destroyDatasetMeta(a);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(My("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,a)=>{t.filter(o=>o===i._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,a;for(this._removeUnreferencedMetasets(),i=0,a=t.length;i<a;i++){const o=t[i];let l=this.getDatasetMeta(i);const u=o.type||this.config.type;if(l.type&&l.type!==u&&(this._destroyDatasetMeta(i),l=this.getDatasetMeta(i)),l.type=u,l.indexAxis=o.indexAxis||Qm(u,this.options),l.order=o.order||0,l.index=i,l.label=""+o.label,l.visible=this.isDatasetVisible(i),l.controller)l.controller.updateIndex(i),l.controller.linkScales();else{const f=Ra.getController(u),{datasetElementType:m,dataElementType:p}=rn.datasets[u];Object.assign(f,{dataElementType:Ra.getElement(p),datasetElementType:m&&Ra.getElement(m)}),l.controller=new f(this,i),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){jt(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let m=0,p=this.data.datasets.length;m<p;m++){const{controller:v}=this.getDatasetMeta(m),y=!a&&o.indexOf(v)===-1;v.buildOrUpdateElements(y),l=Math.max(+v.getMaxOverflow(),l)}l=this._minPadding=i.layout.autoPadding?l:0,this._updateLayout(l),a||jt(o,m=>{m.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(My("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){jt(this.scales,e=>{na.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!Xv(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:a,count:o}of t){const l=i==="_removeElements"?-o:o;dk(e,a,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=o=>new Set(e.filter(l=>l[0]===o).map((l,u)=>u+","+l.splice(1).join(","))),a=i(0);for(let o=1;o<t;o++)if(!Xv(a,i(o)))return;return Array.from(a).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;na.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],jt(this.boxes,a=>{i&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,o)=>{a._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,Jr(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),a={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(i.controller._update(t),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ar.has(this)?this.attached&&!ar.running(this)&&ar.start(this):(this.draw(),Ly({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:a}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,a)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let a,o;for(a=0,o=t.length;a<o;++a){const l=t[a];(!e||l.visible)&&i.push(l)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i={meta:e,index:e.index,cancelable:!0},a=CA(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(a&&Ap(t,a),e.controller.draw(),a&&kp(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return or(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,a){const o=c3.modes[t];return typeof o=="function"?o(this,e,i,a):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let a=i.filter(o=>o&&o._dataset===t).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(a)),a}getContext(){return this.$context||(this.$context=is(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const a=i?"show":"hide",o=this.getDatasetMeta(e),l=o.controller._resolveAnimations(void 0,a);Nc(t)?(o.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),l.update(o,{visible:i}),this.update(u=>u.datasetIndex===e?a:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ar.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ny(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Md[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(o,l)=>{t.addEventListener(this,o,l),e[o]=l},a=(o,l,u)=>{o.offsetX=l,o.offsetY=u,this._eventHandler(o)};jt(this.options.events,o=>i(o,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(f,m)=>{t.addEventListener(this,f,m),e[f]=m},a=(f,m)=>{e[f]&&(t.removeEventListener(this,f,m),delete e[f])},o=(f,m)=>{this.canvas&&this.resize(f,m)};let l;const u=()=>{a("attach",u),this.attached=!0,this.resize(),i("resize",o),i("detach",l)};l=()=>{this.attached=!1,a("resize",o),this._stop(),this._resize(0,0),i("attach",u)},t.isAttached(this.canvas)?u():l()}unbindEvents(){jt(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},jt(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const a=i?"set":"remove";let o,l,u,f;for(t==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+a+"DatasetHoverStyle"]()),u=0,f=e.length;u<f;++u){l=e[u];const m=l&&this.getDatasetMeta(l.datasetIndex).controller;m&&m[a+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:o,index:l})=>{const u=this.getDatasetMeta(o);if(!u)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:u.data[l],index:l}});!Id(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const a=this.options.hover,o=(f,m)=>f.filter(p=>!m.some(v=>p.datasetIndex===v.datasetIndex&&p.index===v.index)),l=o(t,e),u=i?e:o(e,t);l.length&&this.updateHoverStyle(l,a.mode,!1),u.length&&a.mode&&this.updateHoverStyle(u,a.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},a=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,a)===!1)return;const o=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,a),(o||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:a=[],options:o}=this,l=t,u=this._getActiveElements(e,a,i,l),f=l4(e),m=fk(e,this._lastEvent,i,f);i&&(this._lastEvent=null,zt(o.onHover,[e,u,this],this),f&&zt(o.onClick,[e,u,this],this));const p=!Id(u,a);return(p||t)&&(this._active=u,this._updateHoverStyles(u,a,t)),this._lastEvent=m,p}_getActiveElements(e,t,i,a){if(e.type==="mouseout")return[];if(!i)return t;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,a)}};function Py(){return jt(cf.instances,n=>n._plugins.invalidate())}function hk(n,e,t){const{startAngle:i,x:a,y:o,outerRadius:l,innerRadius:u,options:f}=e,{borderWidth:m,borderJoinStyle:p}=f,v=Math.min(m/l,yi(i-t));if(n.beginPath(),n.arc(a,o,l-m/2,i+v/2,t-v/2),u>0){const y=Math.min(m/u,yi(i-t));n.arc(a,o,u+m/2,t-y/2,i+y/2,!0)}else{const y=Math.min(m/2,l*yi(i-t));if(p==="round")n.arc(a,o,y,t-Tt/2,i+Tt/2,!0);else if(p==="bevel"){const S=2*y*y,_=-S*Math.cos(t+Tt/2)+a,x=-S*Math.sin(t+Tt/2)+o,T=S*Math.cos(i+Tt/2)+a,w=S*Math.sin(i+Tt/2)+o;n.lineTo(_,x),n.lineTo(T,w)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function mk(n,e,t){const{startAngle:i,pixelMargin:a,x:o,y:l,outerRadius:u,innerRadius:f}=e;let m=a/u;n.beginPath(),n.arc(o,l,u,i-m,t+m),f>a?(m=a/f,n.arc(o,l,f,t+m,i-m,!0)):n.arc(o,l,a,t+cn,i-cn),n.closePath(),n.clip()}function pk(n){return Cp(n,["outerStart","outerEnd","innerStart","innerEnd"])}function gk(n,e,t,i){const a=pk(n.options.borderRadius),o=(t-e)/2,l=Math.min(o,i*e/2),u=f=>{const m=(t-Math.min(o,f))*i/2;return Kn(f,0,Math.min(o,m))};return{outerStart:u(a.outerStart),outerEnd:u(a.outerEnd),innerStart:Kn(a.innerStart,0,l),innerEnd:Kn(a.innerEnd,0,l)}}function Mo(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function Hd(n,e,t,i,a,o){const{x:l,y:u,startAngle:f,pixelMargin:m,innerRadius:p}=e,v=Math.max(e.outerRadius+i+t-m,0),y=p>0?p+i+t+m:0;let S=0;const _=a-f;if(i){const _e=p>0?p-i:0,ie=v>0?v-i:0,he=(_e+ie)/2,Ne=he!==0?_*he/(he+i):_;S=(_-Ne)/2}const x=Math.max(.001,_*v-t/Tt)/v,T=(_-x)/2,w=f+T+S,E=a-T-S,{outerStart:C,outerEnd:N,innerStart:A,innerEnd:I}=gk(e,y,v,E-w),D=v-C,z=v-N,L=w+C/D,H=E-N/z,K=y+A,ne=y+I,xe=w+A/K,He=E-I/ne;if(n.beginPath(),o){const _e=(L+H)/2;if(n.arc(l,u,v,L,_e),n.arc(l,u,v,_e,H),N>0){const Be=Mo(z,H,l,u);n.arc(Be.x,Be.y,N,H,E+cn)}const ie=Mo(ne,E,l,u);if(n.lineTo(ie.x,ie.y),I>0){const Be=Mo(ne,He,l,u);n.arc(Be.x,Be.y,I,E+cn,He+Math.PI)}const he=(E-I/y+(w+A/y))/2;if(n.arc(l,u,y,E-I/y,he,!0),n.arc(l,u,y,he,w+A/y,!0),A>0){const Be=Mo(K,xe,l,u);n.arc(Be.x,Be.y,A,xe+Math.PI,w-cn)}const Ne=Mo(D,w,l,u);if(n.lineTo(Ne.x,Ne.y),C>0){const Be=Mo(D,L,l,u);n.arc(Be.x,Be.y,C,w-cn,L)}}else{n.moveTo(l,u);const _e=Math.cos(L)*v+l,ie=Math.sin(L)*v+u;n.lineTo(_e,ie);const he=Math.cos(H)*v+l,Ne=Math.sin(H)*v+u;n.lineTo(he,Ne)}n.closePath()}function vk(n,e,t,i,a){const{fullCircles:o,startAngle:l,circumference:u}=e;let f=e.endAngle;if(o){Hd(n,e,t,i,f,a);for(let m=0;m<o;++m)n.fill();isNaN(u)||(f=l+(u%Yt||Yt))}return Hd(n,e,t,i,f,a),n.fill(),f}function yk(n,e,t,i,a){const{fullCircles:o,startAngle:l,circumference:u,options:f}=e,{borderWidth:m,borderJoinStyle:p,borderDash:v,borderDashOffset:y,borderRadius:S}=f,_=f.borderAlign==="inner";if(!m)return;n.setLineDash(v||[]),n.lineDashOffset=y,_?(n.lineWidth=m*2,n.lineJoin=p||"round"):(n.lineWidth=m,n.lineJoin=p||"bevel");let x=e.endAngle;if(o){Hd(n,e,t,i,x,a);for(let T=0;T<o;++T)n.stroke();isNaN(u)||(x=l+(u%Yt||Yt))}_&&mk(n,e,x),f.selfJoin&&x-l>=Tt&&S===0&&p!=="miter"&&hk(n,e,x),o||(Hd(n,e,t,i,x,a),n.stroke())}class xk extends pr{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const a=this.getProps(["x","y"],i),{angle:o,distance:l}=gb(a,{x:e,y:t}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:p,circumference:v}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),y=(this.options.spacing+this.options.borderWidth)/2,S=it(v,f-u),_=Rc(o,u,f)&&u!==f,x=S>=Yt||_,T=Xr(l,m+y,p+y);return x&&T}getCenterPoint(e){const{x:t,y:i,startAngle:a,endAngle:o,innerRadius:l,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:f,spacing:m}=this.options,p=(a+o)/2,v=(l+u+m+f)/2;return{x:t+Math.cos(p)*v,y:i+Math.sin(p)*v}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,a=(t.offset||0)/4,o=(t.spacing||0)/2,l=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=i>Yt?Math.floor(i/Yt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const u=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(u)*a,Math.sin(u)*a);const f=1-Math.sin(Math.min(Tt,i||0)),m=a*f;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,vk(e,this,m,o,l),yk(e,this,m,o,l),e.restore()}}function Wb(n,e,t=e){n.lineCap=it(t.borderCapStyle,e.borderCapStyle),n.setLineDash(it(t.borderDash,e.borderDash)),n.lineDashOffset=it(t.borderDashOffset,e.borderDashOffset),n.lineJoin=it(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=it(t.borderWidth,e.borderWidth),n.strokeStyle=it(t.borderColor,e.borderColor)}function bk(n,e,t){n.lineTo(t.x,t.y)}function Sk(n){return n.stepped?L4:n.tension||n.cubicInterpolationMode==="monotone"?I4:bk}function Vb(n,e,t={}){const i=n.length,{start:a=0,end:o=i-1}=t,{start:l,end:u}=e,f=Math.max(a,l),m=Math.min(o,u),p=a<l&&o<l||a>u&&o>u;return{count:i,start:f,loop:e.loop,ilen:m<f&&!p?i+m-f:m-f}}function _k(n,e,t,i){const{points:a,options:o}=e,{count:l,start:u,loop:f,ilen:m}=Vb(a,t,i),p=Sk(o);let{move:v=!0,reverse:y}=i||{},S,_,x;for(S=0;S<=m;++S)_=a[(u+(y?m-S:S))%l],!_.skip&&(v?(n.moveTo(_.x,_.y),v=!1):p(n,x,_,y,o.stepped),x=_);return f&&(_=a[(u+(y?m:0))%l],p(n,x,_,y,o.stepped)),!!f}function Tk(n,e,t,i){const a=e.points,{count:o,start:l,ilen:u}=Vb(a,t,i),{move:f=!0,reverse:m}=i||{};let p=0,v=0,y,S,_,x,T,w;const E=N=>(l+(m?u-N:N))%o,C=()=>{x!==T&&(n.lineTo(p,T),n.lineTo(p,x),n.lineTo(p,w))};for(f&&(S=a[E(0)],n.moveTo(S.x,S.y)),y=0;y<=u;++y){if(S=a[E(y)],S.skip)continue;const N=S.x,A=S.y,I=N|0;I===_?(A<x?x=A:A>T&&(T=A),p=(v*p+N)/++v):(C(),n.lineTo(N,A),_=I,v=0,x=T=A),w=A}C()}function ep(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?Tk:_k}function wk(n){return n.stepped?pA:n.tension||n.cubicInterpolationMode==="monotone"?gA:Rs}function Ek(n,e,t,i){let a=e._path;a||(a=e._path=new Path2D,e.path(a,t,i)&&a.closePath()),Wb(n,e.options),n.stroke(a)}function Ak(n,e,t,i){const{segments:a,options:o}=e,l=ep(e);for(const u of a)Wb(n,o,u.style),n.beginPath(),l(n,e,u,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const kk=typeof Path2D=="function";function Ck(n,e,t,i){kk&&!e.options.segment?Ek(n,e,t,i):Ak(n,e,t,i)}class jk extends pr{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const a=i.spanGaps?this._loop:this._fullLoop;oA(this._points,i,e,a,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=wA(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,a=e[t],o=this.points,l=SA(this,{property:t,start:a,end:a});if(!l.length)return;const u=[],f=wk(i);let m,p;for(m=0,p=l.length;m<p;++m){const{start:v,end:y}=l[m],S=o[v],_=o[y];if(S===_){u.push(S);continue}const x=Math.abs((a-S[t])/(_[t]-S[t])),T=f(S,_,x,i.stepped);T[t]=e[t],u.push(T)}return u.length===1?u[0]:u}pathSegment(e,t,i){return ep(this)(e,this,t,i)}path(e,t,i){const a=this.segments,o=ep(this);let l=this._loop;t=t||0,i=i||this.points.length-t;for(const u of a)l&=o(e,this,u,{start:t,end:t+i-1});return!!l}draw(e,t,i,a){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(e.save(),Ck(e,this,i,a),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function By(n,e,t,i){const a=n.options,{[t]:o}=n.getProps([t],i);return Math.abs(e-o)<a.radius+a.hitRadius}class Dk extends pr{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const a=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(e-o,2)+Math.pow(t-l,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(e,t){return By(this,e,"x",t)}inYRange(e,t){return By(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const i=t&&e.borderWidth||0;return(t+i)*2}draw(e,t){const i=this.options;this.skip||i.radius<.1||!or(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Zm(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Gb(n,e){const{x:t,y:i,base:a,width:o,height:l}=n.getProps(["x","y","base","width","height"],e);let u,f,m,p,v;return n.horizontal?(v=l/2,u=Math.min(t,a),f=Math.max(t,a),m=i-v,p=i+v):(v=o/2,u=t-v,f=t+v,m=Math.min(i,a),p=Math.max(i,a)),{left:u,top:m,right:f,bottom:p}}function $r(n,e,t,i){return n?0:Kn(e,t,i)}function Nk(n,e,t){const i=n.options.borderWidth,a=n.borderSkipped,o=_b(i);return{t:$r(a.top,o.top,0,t),r:$r(a.right,o.right,0,e),b:$r(a.bottom,o.bottom,0,t),l:$r(a.left,o.left,0,e)}}function Ok(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),a=n.options.borderRadius,o=Is(a),l=Math.min(e,t),u=n.borderSkipped,f=i||pt(a);return{topLeft:$r(!f||u.top||u.left,o.topLeft,0,l),topRight:$r(!f||u.top||u.right,o.topRight,0,l),bottomLeft:$r(!f||u.bottom||u.left,o.bottomLeft,0,l),bottomRight:$r(!f||u.bottom||u.right,o.bottomRight,0,l)}}function Rk(n){const e=Gb(n),t=e.right-e.left,i=e.bottom-e.top,a=Nk(n,t/2,i/2),o=Ok(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:o},inner:{x:e.left+a.l,y:e.top+a.t,w:t-a.l-a.r,h:i-a.t-a.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,o.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(a.b,a.r))}}}}function Lm(n,e,t,i){const a=e===null,o=t===null,u=n&&!(a&&o)&&Gb(n,i);return u&&(a||Xr(e,u.left,u.right))&&(o||Xr(t,u.top,u.bottom))}function Mk(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Lk(n,e){n.rect(e.x,e.y,e.w,e.h)}function Im(n,e,t={}){const i=n.x!==t.x?-e:0,a=n.y!==t.y?-e:0,o=(n.x+n.w!==t.x+t.w?e:0)-i,l=(n.y+n.h!==t.y+t.h?e:0)-a;return{x:n.x+i,y:n.y+a,w:n.w+o,h:n.h+l,radius:n.radius}}class Ik extends pr{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:a}}=this,{inner:o,outer:l}=Rk(this),u=Mk(l.radius)?Mc:Lk;e.save(),(l.w!==o.w||l.h!==o.h)&&(e.beginPath(),u(e,Im(l,t,o)),e.clip(),u(e,Im(o,-t,l)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),u(e,Im(o,t)),e.fillStyle=a,e.fill(),e.restore()}inRange(e,t,i){return Lm(this,e,t,i)}inXRange(e,t){return Lm(this,e,null,t)}inYRange(e,t){return Lm(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:a,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(t+a)/2:t,y:o?i:(i+a)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const Fy=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},Pk=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class Uy extends pr{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=zt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,a)=>e.sort(i,a,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,a=Tn(i.font),o=a.size,l=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Fy(i,o);let m,p;t.font=a.string,this.isHorizontal()?(m=this.maxWidth,p=this._fitRows(l,o,u,f)+10):(p=this.maxHeight,m=this._fitCols(l,a,u,f)+10),this.width=Math.min(m,e.maxWidth||this.maxWidth),this.height=Math.min(p,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,a){const{ctx:o,maxWidth:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],p=a+u;let v=e;o.textAlign="left",o.textBaseline="middle";let y=-1,S=-p;return this.legendItems.forEach((_,x)=>{const T=i+t/2+o.measureText(_.text).width;(x===0||m[m.length-1]+T+2*u>l)&&(v+=p,m[m.length-(x>0?0:1)]=0,S+=p,y++),f[x]={left:0,top:S,row:y,width:T,height:a},m[m.length-1]+=T+u}),v}_fitCols(e,t,i,a){const{ctx:o,maxHeight:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],p=l-e;let v=u,y=0,S=0,_=0,x=0;return this.legendItems.forEach((T,w)=>{const{itemWidth:E,itemHeight:C}=Bk(i,t,o,T,a);w>0&&S+C+2*u>p&&(v+=y+u,m.push({width:y,height:S}),_+=y+u,x++,y=S=0),f[w]={left:_,top:S,col:x,width:E,height:C},y=Math.max(y,E),S+=C+u}),v+=y,m.push({width:y,height:S}),v}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:a},rtl:o}}=this,l=Ho(o,this.left,this.width);if(this.isHorizontal()){let u=0,f=qn(i,this.left+a,this.right-this.lineWidths[u]);for(const m of t)u!==m.row&&(u=m.row,f=qn(i,this.left+a,this.right-this.lineWidths[u])),m.top+=this.top+e+a,m.left=l.leftForLtr(l.x(f),m.width),f+=m.width+a}else{let u=0,f=qn(i,this.top+e+a,this.bottom-this.columnSizes[u].height);for(const m of t)m.col!==u&&(u=m.col,f=qn(i,this.top+e+a,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+a,m.left=l.leftForLtr(l.x(m.left),m.width),f+=m.height+a}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Ap(e,this),this._draw(),kp(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:a}=this,{align:o,labels:l}=e,u=rn.color,f=Ho(e.rtl,this.left,this.width),m=Tn(l.font),{padding:p}=l,v=m.size,y=v/2;let S;this.drawTitle(),a.textAlign=f.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=m.string;const{boxWidth:_,boxHeight:x,itemHeight:T}=Fy(l,v),w=function(I,D,z){if(isNaN(_)||_<=0||isNaN(x)||x<0)return;a.save();const L=it(z.lineWidth,1);if(a.fillStyle=it(z.fillStyle,u),a.lineCap=it(z.lineCap,"butt"),a.lineDashOffset=it(z.lineDashOffset,0),a.lineJoin=it(z.lineJoin,"miter"),a.lineWidth=L,a.strokeStyle=it(z.strokeStyle,u),a.setLineDash(it(z.lineDash,[])),l.usePointStyle){const H={radius:x*Math.SQRT2/2,pointStyle:z.pointStyle,rotation:z.rotation,borderWidth:L},K=f.xPlus(I,_/2),ne=D+y;Sb(a,H,K,ne,l.pointStyleWidth&&_)}else{const H=D+Math.max((v-x)/2,0),K=f.leftForLtr(I,_),ne=Is(z.borderRadius);a.beginPath(),Object.values(ne).some(xe=>xe!==0)?Mc(a,{x:K,y:H,w:_,h:x,radius:ne}):a.rect(K,H,_,x),a.fill(),L!==0&&a.stroke()}a.restore()},E=function(I,D,z){Us(a,z.text,I,D+T/2,m,{strikethrough:z.hidden,textAlign:f.textAlign(z.textAlign)})},C=this.isHorizontal(),N=this._computeTitleHeight();C?S={x:qn(o,this.left+p,this.right-i[0]),y:this.top+p+N,line:0}:S={x:this.left+p,y:qn(o,this.top+N+p,this.bottom-t[0].height),line:0},Cb(this.ctx,e.textDirection);const A=T+p;this.legendItems.forEach((I,D)=>{a.strokeStyle=I.fontColor,a.fillStyle=I.fontColor;const z=a.measureText(I.text).width,L=f.textAlign(I.textAlign||(I.textAlign=l.textAlign)),H=_+y+z;let K=S.x,ne=S.y;f.setWidth(this.width),C?D>0&&K+H+p>this.right&&(ne=S.y+=A,S.line++,K=S.x=qn(o,this.left+p,this.right-i[S.line])):D>0&&ne+A>this.bottom&&(K=S.x=K+t[S.line].width+p,S.line++,ne=S.y=qn(o,this.top+N+p,this.bottom-t[S.line].height));const xe=f.x(K);if(w(xe,ne,I),K=S4(L,K+_+y,C?K+H:this.right,e.rtl),E(f.x(K),ne,I),C)S.x+=H+p;else if(typeof I.text!="string"){const He=m.lineHeight;S.y+=Yb(I,He)+p}else S.y+=A}),jb(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=Tn(t.font),a=Jn(t.padding);if(!t.display)return;const o=Ho(e.rtl,this.left,this.width),l=this.ctx,u=t.position,f=i.size/2,m=a.top+f;let p,v=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),p=this.top+m,v=qn(e.align,v,this.right-y);else{const _=this.columnSizes.reduce((x,T)=>Math.max(x,T.height),0);p=m+qn(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const S=qn(u,v,v+y);l.textAlign=o.textAlign(_p(u)),l.textBaseline="middle",l.strokeStyle=t.color,l.fillStyle=t.color,l.font=i.string,Us(l,t.text,S,p,i)}_computeTitleHeight(){const e=this.options.title,t=Tn(e.font),i=Jn(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,a,o;if(Xr(e,this.left,this.right)&&Xr(t,this.top,this.bottom)){for(o=this.legendHitBoxes,i=0;i<o.length;++i)if(a=o[i],Xr(e,a.left,a.left+a.width)&&Xr(t,a.top,a.top+a.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!zk(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const a=this._hoveredItem,o=Pk(a,i);a&&!o&&zt(t.onLeave,[e,a,this],this),this._hoveredItem=i,i&&!o&&zt(t.onHover,[e,i,this],this)}else i&&zt(t.onClick,[e,i,this],this)}}function Bk(n,e,t,i,a){const o=Fk(i,n,e,t),l=Uk(a,i,e.lineHeight);return{itemWidth:o,itemHeight:l}}function Fk(n,e,t,i){let a=n.text;return a&&typeof a!="string"&&(a=a.reduce((o,l)=>o.length>l.length?o:l)),e+t.size/2+i.measureText(a).width}function Uk(n,e,t){let i=n;return typeof e.text!="string"&&(i=Yb(e,t)),i}function Yb(n,e){const t=n.text?n.text.length:0;return e*t}function zk(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var Hk={id:"legend",_element:Uy,start(n,e,t){const i=n.legend=new Uy({ctx:n.ctx,options:t,chart:n});na.configure(n,i,t),na.addBox(n,i)},stop(n){na.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;na.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,a=t.chart;a.isDatasetVisible(i)?(a.hide(i),e.hidden=!0):(a.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:a,color:o,useBorderRadius:l,borderRadius:u}}=n.legend.options;return n._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(t?0:void 0),p=Jn(m.borderWidth);return{text:e[f.index].label,fillStyle:m.backgroundColor,fontColor:o,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:m.borderColor,pointStyle:i||m.pointStyle,rotation:m.rotation,textAlign:a||m.textAlign,borderRadius:l&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class Xb extends pr{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const a=Qt(i.text)?i.text.length:1;this._padding=Jn(i.padding);const o=a*Tn(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:a,right:o,options:l}=this,u=l.align;let f=0,m,p,v;return this.isHorizontal()?(p=qn(u,i,o),v=t+e,m=o-i):(l.position==="left"?(p=i+e,v=qn(u,a,t),f=Tt*-.5):(p=o-e,v=qn(u,t,a),f=Tt*.5),m=a-t),{titleX:p,titleY:v,maxWidth:m,rotation:f}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=Tn(t.font),o=i.lineHeight/2+this._padding.top,{titleX:l,titleY:u,maxWidth:f,rotation:m}=this._drawArgs(o);Us(e,t.text,0,0,i,{color:t.color,maxWidth:f,rotation:m,textAlign:_p(t.align),textBaseline:"middle",translation:[l,u]})}}function Wk(n,e){const t=new Xb({ctx:n.ctx,options:e,chart:n});na.configure(n,t,e),na.addBox(n,t),n.titleBlock=t}var Vk={id:"title",_element:Xb,start(n,e,t){Wk(n,t)},stop(n){const e=n.titleBlock;na.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;na.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const gc={average(n){if(!n.length)return!1;let e,t,i=new Set,a=0,o=0;for(e=0,t=n.length;e<t;++e){const u=n[e].element;if(u&&u.hasValue()){const f=u.tooltipPosition();i.add(f.x),a+=f.y,++o}}return o===0||i.size===0?!1:{x:[...i].reduce((u,f)=>u+f)/i.size,y:a/o}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,a=Number.POSITIVE_INFINITY,o,l,u;for(o=0,l=n.length;o<l;++o){const f=n[o].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),p=qm(e,m);p<a&&(a=p,u=f)}}if(u){const f=u.tooltipPosition();t=f.x,i=f.y}return{x:t,y:i}}};function Da(n,e){return e&&(Qt(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function rr(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function Gk(n,e){const{element:t,datasetIndex:i,index:a}=e,o=n.getDatasetMeta(i).controller,{label:l,value:u}=o.getLabelAndValue(a);return{chart:n,label:l,parsed:o.getParsed(a),raw:n.data.datasets[i].data[a],formattedValue:u,dataset:o.getDataset(),dataIndex:a,datasetIndex:i,element:t}}function zy(n,e){const t=n.chart.ctx,{body:i,footer:a,title:o}=n,{boxWidth:l,boxHeight:u}=e,f=Tn(e.bodyFont),m=Tn(e.titleFont),p=Tn(e.footerFont),v=o.length,y=a.length,S=i.length,_=Jn(e.padding);let x=_.height,T=0,w=i.reduce((N,A)=>N+A.before.length+A.lines.length+A.after.length,0);if(w+=n.beforeBody.length+n.afterBody.length,v&&(x+=v*m.lineHeight+(v-1)*e.titleSpacing+e.titleMarginBottom),w){const N=e.displayColors?Math.max(u,f.lineHeight):f.lineHeight;x+=S*N+(w-S)*f.lineHeight+(w-1)*e.bodySpacing}y&&(x+=e.footerMarginTop+y*p.lineHeight+(y-1)*e.footerSpacing);let E=0;const C=function(N){T=Math.max(T,t.measureText(N).width+E)};return t.save(),t.font=m.string,jt(n.title,C),t.font=f.string,jt(n.beforeBody.concat(n.afterBody),C),E=e.displayColors?l+2+e.boxPadding:0,jt(i,N=>{jt(N.before,C),jt(N.lines,C),jt(N.after,C)}),E=0,t.font=p.string,jt(n.footer,C),t.restore(),T+=_.width,{width:T,height:x}}function Yk(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function Xk(n,e,t,i){const{x:a,width:o}=i,l=t.caretSize+t.caretPadding;if(n==="left"&&a+o+l>e.width||n==="right"&&a-o-l<0)return!0}function $k(n,e,t,i){const{x:a,width:o}=t,{width:l,chartArea:{left:u,right:f}}=n;let m="center";return i==="center"?m=a<=(u+f)/2?"left":"right":a<=o/2?m="left":a>=l-o/2&&(m="right"),Xk(m,n,e,t)&&(m="center"),m}function Hy(n,e,t){const i=t.yAlign||e.yAlign||Yk(n,t);return{xAlign:t.xAlign||e.xAlign||$k(n,e,t,i),yAlign:i}}function qk(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function Kk(n,e,t){let{y:i,height:a}=n;return e==="top"?i+=t:e==="bottom"?i-=a+t:i-=a/2,i}function Wy(n,e,t,i){const{caretSize:a,caretPadding:o,cornerRadius:l}=n,{xAlign:u,yAlign:f}=t,m=a+o,{topLeft:p,topRight:v,bottomLeft:y,bottomRight:S}=Is(l);let _=qk(e,u);const x=Kk(e,f,m);return f==="center"?u==="left"?_+=m:u==="right"&&(_-=m):u==="left"?_-=Math.max(p,y)+a:u==="right"&&(_+=Math.max(v,S)+a),{x:Kn(_,0,i.width-e.width),y:Kn(x,0,i.height-e.height)}}function xd(n,e,t){const i=Jn(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function Vy(n){return Da([],rr(n))}function Zk(n,e,t){return is(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function Gy(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const $b={beforeTitle:ir,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:ir,beforeBody:ir,beforeLabel:ir,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return mt(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ir,afterBody:ir,beforeFooter:ir,footer:ir,afterFooter:ir};function gi(n,e,t,i){const a=n[e].call(t,i);return typeof a>"u"?$b[e].call(t,i):a}class Yy extends pr{static positioners=gc;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),a=i.enabled&&t.options.animation&&i.animations,o=new Nb(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=Zk(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,a=gi(i,"beforeTitle",this,e),o=gi(i,"title",this,e),l=gi(i,"afterTitle",this,e);let u=[];return u=Da(u,rr(a)),u=Da(u,rr(o)),u=Da(u,rr(l)),u}getBeforeBody(e,t){return Vy(gi(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:i}=t,a=[];return jt(e,o=>{const l={before:[],lines:[],after:[]},u=Gy(i,o);Da(l.before,rr(gi(u,"beforeLabel",this,o))),Da(l.lines,gi(u,"label",this,o)),Da(l.after,rr(gi(u,"afterLabel",this,o))),a.push(l)}),a}getAfterBody(e,t){return Vy(gi(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:i}=t,a=gi(i,"beforeFooter",this,e),o=gi(i,"footer",this,e),l=gi(i,"afterFooter",this,e);let u=[];return u=Da(u,rr(a)),u=Da(u,rr(o)),u=Da(u,rr(l)),u}_createItems(e){const t=this._active,i=this.chart.data,a=[],o=[],l=[];let u=[],f,m;for(f=0,m=t.length;f<m;++f)u.push(Gk(this.chart,t[f]));return e.filter&&(u=u.filter((p,v,y)=>e.filter(p,v,y,i))),e.itemSort&&(u=u.sort((p,v)=>e.itemSort(p,v,i))),jt(u,p=>{const v=Gy(e.callbacks,p);a.push(gi(v,"labelColor",this,p)),o.push(gi(v,"labelPointStyle",this,p)),l.push(gi(v,"labelTextColor",this,p))}),this.labelColors=a,this.labelPointStyles=o,this.labelTextColors=l,this.dataPoints=u,u}update(e,t){const i=this.options.setContext(this.getContext()),a=this._active;let o,l=[];if(!a.length)this.opacity!==0&&(o={opacity:0});else{const u=gc[i.position].call(this,a,this._eventPosition);l=this._createItems(i),this.title=this.getTitle(l,i),this.beforeBody=this.getBeforeBody(l,i),this.body=this.getBody(l,i),this.afterBody=this.getAfterBody(l,i),this.footer=this.getFooter(l,i);const f=this._size=zy(this,i),m=Object.assign({},u,f),p=Hy(this.chart,i,m),v=Wy(i,m,p,this.chart);this.xAlign=p.xAlign,this.yAlign=p.yAlign,o={opacity:1,x:v.x,y:v.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=l,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,a){const o=this.getCaretPosition(e,i,a);t.lineTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.lineTo(o.x3,o.y3)}getCaretPosition(e,t,i){const{xAlign:a,yAlign:o}=this,{caretSize:l,cornerRadius:u}=i,{topLeft:f,topRight:m,bottomLeft:p,bottomRight:v}=Is(u),{x:y,y:S}=e,{width:_,height:x}=t;let T,w,E,C,N,A;return o==="center"?(N=S+x/2,a==="left"?(T=y,w=T-l,C=N+l,A=N-l):(T=y+_,w=T+l,C=N-l,A=N+l),E=T):(a==="left"?w=y+Math.max(f,p)+l:a==="right"?w=y+_-Math.max(m,v)-l:w=this.caretX,o==="top"?(C=S,N=C-l,T=w-l,E=w+l):(C=S+x,N=C+l,T=w+l,E=w-l),A=C),{x1:T,x2:w,x3:E,y1:C,y2:N,y3:A}}drawTitle(e,t,i){const a=this.title,o=a.length;let l,u,f;if(o){const m=Ho(i.rtl,this.x,this.width);for(e.x=xd(this,i.titleAlign,i),t.textAlign=m.textAlign(i.titleAlign),t.textBaseline="middle",l=Tn(i.titleFont),u=i.titleSpacing,t.fillStyle=i.titleColor,t.font=l.string,f=0;f<o;++f)t.fillText(a[f],m.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+u,f+1===o&&(e.y+=i.titleMarginBottom-u)}}_drawColorBox(e,t,i,a,o){const l=this.labelColors[i],u=this.labelPointStyles[i],{boxHeight:f,boxWidth:m}=o,p=Tn(o.bodyFont),v=xd(this,"left",o),y=a.x(v),S=f<p.lineHeight?(p.lineHeight-f)/2:0,_=t.y+S;if(o.usePointStyle){const x={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},T=a.leftForLtr(y,m)+m/2,w=_+f/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,Zm(e,x,T,w),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,Zm(e,x,T,w)}else{e.lineWidth=pt(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const x=a.leftForLtr(y,m),T=a.leftForLtr(a.xPlus(y,1),m-2),w=Is(l.borderRadius);Object.values(w).some(E=>E!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,Mc(e,{x,y:_,w:m,h:f,radius:w}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),Mc(e,{x:T,y:_+1,w:m-2,h:f-2,radius:w}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(x,_,m,f),e.strokeRect(x,_,m,f),e.fillStyle=l.backgroundColor,e.fillRect(T,_+1,m-2,f-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:a}=this,{bodySpacing:o,bodyAlign:l,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:p}=i,v=Tn(i.bodyFont);let y=v.lineHeight,S=0;const _=Ho(i.rtl,this.x,this.width),x=function(z){t.fillText(z,_.x(e.x+S),e.y+y/2),e.y+=y+o},T=_.textAlign(l);let w,E,C,N,A,I,D;for(t.textAlign=l,t.textBaseline="middle",t.font=v.string,e.x=xd(this,T,i),t.fillStyle=i.bodyColor,jt(this.beforeBody,x),S=u&&T!=="right"?l==="center"?m/2+p:m+2+p:0,N=0,I=a.length;N<I;++N){for(w=a[N],E=this.labelTextColors[N],t.fillStyle=E,jt(w.before,x),C=w.lines,u&&C.length&&(this._drawColorBox(t,e,N,_,i),y=Math.max(v.lineHeight,f)),A=0,D=C.length;A<D;++A)x(C[A]),y=v.lineHeight;jt(w.after,x)}S=0,y=v.lineHeight,jt(this.afterBody,x),e.y-=o}drawFooter(e,t,i){const a=this.footer,o=a.length;let l,u;if(o){const f=Ho(i.rtl,this.x,this.width);for(e.x=xd(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=f.textAlign(i.footerAlign),t.textBaseline="middle",l=Tn(i.footerFont),t.fillStyle=i.footerColor,t.font=l.string,u=0;u<o;++u)t.fillText(a[u],f.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+i.footerSpacing}}drawBackground(e,t,i,a){const{xAlign:o,yAlign:l}=this,{x:u,y:f}=e,{width:m,height:p}=i,{topLeft:v,topRight:y,bottomLeft:S,bottomRight:_}=Is(a.cornerRadius);t.fillStyle=a.backgroundColor,t.strokeStyle=a.borderColor,t.lineWidth=a.borderWidth,t.beginPath(),t.moveTo(u+v,f),l==="top"&&this.drawCaret(e,t,i,a),t.lineTo(u+m-y,f),t.quadraticCurveTo(u+m,f,u+m,f+y),l==="center"&&o==="right"&&this.drawCaret(e,t,i,a),t.lineTo(u+m,f+p-_),t.quadraticCurveTo(u+m,f+p,u+m-_,f+p),l==="bottom"&&this.drawCaret(e,t,i,a),t.lineTo(u+S,f+p),t.quadraticCurveTo(u,f+p,u,f+p-S),l==="center"&&o==="left"&&this.drawCaret(e,t,i,a),t.lineTo(u,f+v),t.quadraticCurveTo(u,f,u+v,f),t.closePath(),t.fill(),a.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,a=i&&i.x,o=i&&i.y;if(a||o){const l=gc[e.position].call(this,this._active,this._eventPosition);if(!l)return;const u=this._size=zy(this,e),f=Object.assign({},l,this._size),m=Hy(t,e,f),p=Wy(e,f,m,t);(a._to!==p.x||o._to!==p.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,p))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const a={width:this.width,height:this.height},o={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const l=Jn(t.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&u&&(e.save(),e.globalAlpha=i,this.drawBackground(o,e,a,t),Cb(e,t.textDirection),o.y+=l.top,this.drawTitle(o,e,t),this.drawBody(o,e,t),this.drawFooter(o,e,t),jb(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,a=e.map(({datasetIndex:u,index:f})=>{const m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),o=!Id(i,a),l=this._positionChanged(a,t);(o||l)&&(this._active=a,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const a=this.options,o=this._active||[],l=this._getActiveElements(e,o,t,i),u=this._positionChanged(l,e),f=t||!Id(l,o)||u;return f&&(this._active=l,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),f}_getActiveElements(e,t,i,a){const o=this.options;if(e.type==="mouseout")return[];if(!a)return t.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,o.mode,o,i);return o.reverse&&l.reverse(),l}_positionChanged(e,t){const{caretX:i,caretY:a,options:o}=this,l=gc[o.position].call(this,e,t);return l!==!1&&(i!==l.x||a!==l.y)}}var Qk={id:"tooltip",_element:Yy,positioners:gc,afterInit(n,e,t){t&&(n.tooltip=new Yy({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:$b},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Jk=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function e6(n,e,t,i){const a=n.indexOf(e);if(a===-1)return Jk(n,e,t,i);const o=n.lastIndexOf(e);return a!==o?t:a}const t6=(n,e)=>n===null?null:Kn(Math.round(n),0,e);function Xy(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class n6 extends el{static id="category";static defaults={ticks:{callback:Xy}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:a,label:o}of t)i[a]===o&&i.splice(a,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(mt(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:e6(i,e,it(t,e),this._addedLabels),t6(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(a=this.getLabels().length-1)),this.min=i,this.max=a}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,a=[];let o=this.getLabels();o=e===0&&t===o.length-1?o:o.slice(e,t+1),this._valueRange=Math.max(o.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let l=e;l<=t;l++)a.push({value:l});return a}getLabelForValue(e){return Xy.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function i6(n,e){const t=[],{bounds:a,step:o,min:l,max:u,precision:f,count:m,maxTicks:p,maxDigits:v,includeBounds:y}=n,S=o||1,_=p-1,{min:x,max:T}=e,w=!mt(l),E=!mt(u),C=!mt(m),N=(T-x)/(v+1);let A=qv((T-x)/_/S)*S,I,D,z,L;if(A<1e-14&&!w&&!E)return[{value:x},{value:T}];L=Math.ceil(T/A)-Math.floor(x/A),L>_&&(A=qv(L*A/_/S)*S),mt(f)||(I=Math.pow(10,f),A=Math.ceil(A*I)/I),a==="ticks"?(D=Math.floor(x/A)*A,z=Math.ceil(T/A)*A):(D=x,z=T),w&&E&&o&&h4((u-l)/o,A/1e3)?(L=Math.round(Math.min((u-l)/A,p)),A=(u-l)/L,D=l,z=u):C?(D=w?l:D,z=E?u:z,L=m-1,A=(z-D)/L):(L=(z-D)/A,xc(L,Math.round(L),A/1e3)?L=Math.round(L):L=Math.ceil(L));const H=Math.max(Kv(A),Kv(D));I=Math.pow(10,mt(f)?H:f),D=Math.round(D*I)/I,z=Math.round(z*I)/I;let K=0;for(w&&(y&&D!==l?(t.push({value:l}),D<l&&K++,xc(Math.round((D+K*A)*I)/I,l,$y(l,N,n))&&K++):D<l&&K++);K<L;++K){const ne=Math.round((D+K*A)*I)/I;if(E&&ne>u)break;t.push({value:ne})}return E&&y&&z!==u?t.length&&xc(t[t.length-1].value,u,$y(u,N,n))?t[t.length-1].value=u:t.push({value:u}):(!E||z===u)&&t.push({value:z}),t}function $y(n,e,{horizontal:t,minRotation:i}){const a=La(i),o=(t?Math.sin(a):Math.cos(a))||.001,l=.75*e*(""+n).length;return Math.min(e/o,l)}class tp extends el{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return mt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:a,max:o}=this;const l=f=>a=t?a:f,u=f=>o=i?o:f;if(e){const f=Ia(a),m=Ia(o);f<0&&m<0?u(0):f>0&&m>0&&l(0)}if(a===o){let f=o===0?1:Math.abs(o*.05);u(o+f),e||l(a-f)}this.min=a,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,a;return i?(a=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,a>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${a} ticks. Limiting to 1000.`),a=1e3)):(a=this.computeTickLimit(),t=t||11),t&&(a=Math.min(t,a)),a}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const a={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},o=this._range||this,l=i6(a,o);return e.bounds==="ticks"&&m4(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const a=(i-t)/Math.max(e.length-1,1)/2;t-=a,i+=a}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return wp(e,this.chart.options.locale,this.options.ticks.format)}}class a6 extends tp{static id="linear";static defaults={ticks:{callback:Ep.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Si(e)?e:0,this.max=Si(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=La(this.options.ticks.minRotation),a=(e?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,o.lineHeight/a))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}function np(n){const e=n.ticks;if(e.display&&n.display){const t=Jn(e.backdropPadding);return it(e.font&&e.font.size,rn.font.size)+t.height}return 0}function r6(n,e,t){return t=Qt(t)?t:[t],{w:M4(n,e.string,t),h:t.length*e.lineHeight}}function qy(n,e,t,i,a){return n===i||n===a?{start:e-t/2,end:e+t/2}:n<i||n>a?{start:e-t,end:e}:{start:e,end:e+t}}function s6(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],a=[],o=n._pointLabels.length,l=n.options.pointLabels,u=l.centerPointLabels?Tt/o:0;for(let f=0;f<o;f++){const m=l.setContext(n.getPointLabelContext(f));a[f]=m.padding;const p=n.getPointPosition(f,n.drawingArea+a[f],u),v=Tn(m.font),y=r6(n.ctx,v,n._pointLabels[f]);i[f]=y;const S=yi(n.getIndexAngle(f)+u),_=Math.round(bp(S)),x=qy(_,p.x,y.w,0,180),T=qy(_,p.y,y.h,90,270);o6(t,e,S,x,T)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=u6(n,i,a)}function o6(n,e,t,i,a){const o=Math.abs(Math.sin(t)),l=Math.abs(Math.cos(t));let u=0,f=0;i.start<e.l?(u=(e.l-i.start)/o,n.l=Math.min(n.l,e.l-u)):i.end>e.r&&(u=(i.end-e.r)/o,n.r=Math.max(n.r,e.r+u)),a.start<e.t?(f=(e.t-a.start)/l,n.t=Math.min(n.t,e.t-f)):a.end>e.b&&(f=(a.end-e.b)/l,n.b=Math.max(n.b,e.b+f))}function l6(n,e,t){const i=n.drawingArea,{extra:a,additionalAngle:o,padding:l,size:u}=t,f=n.getPointPosition(e,i+a+l,o),m=Math.round(bp(yi(f.angle+cn))),p=h6(f.y,u.h,m),v=d6(m),y=f6(f.x,u.w,v);return{visible:!0,x:f.x,y:p,textAlign:v,left:y,top:p,right:y+u.w,bottom:p+u.h}}function c6(n,e){if(!e)return!0;const{left:t,top:i,right:a,bottom:o}=n;return!(or({x:t,y:i},e)||or({x:t,y:o},e)||or({x:a,y:i},e)||or({x:a,y:o},e))}function u6(n,e,t){const i=[],a=n._pointLabels.length,o=n.options,{centerPointLabels:l,display:u}=o.pointLabels,f={extra:np(o)/2,additionalAngle:l?Tt/a:0};let m;for(let p=0;p<a;p++){f.padding=t[p],f.size=e[p];const v=l6(n,p,f);i.push(v),u==="auto"&&(v.visible=c6(v,m),v.visible&&(m=v))}return i}function d6(n){return n===0||n===180?"center":n<180?"left":"right"}function f6(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function h6(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function m6(n,e,t){const{left:i,top:a,right:o,bottom:l}=t,{backdropColor:u}=e;if(!mt(u)){const f=Is(e.borderRadius),m=Jn(e.backdropPadding);n.fillStyle=u;const p=i-m.left,v=a-m.top,y=o-i+m.width,S=l-a+m.height;Object.values(f).some(_=>_!==0)?(n.beginPath(),Mc(n,{x:p,y:v,w:y,h:S,radius:f}),n.fill()):n.fillRect(p,v,y,S)}}function p6(n,e){const{ctx:t,options:{pointLabels:i}}=n;for(let a=e-1;a>=0;a--){const o=n._pointLabelItems[a];if(!o.visible)continue;const l=i.setContext(n.getPointLabelContext(a));m6(t,l,o);const u=Tn(l.font),{x:f,y:m,textAlign:p}=o;Us(t,n._pointLabels[a],f,m+u.lineHeight/2,u,{color:l.color,textAlign:p,textBaseline:"middle"})}}function qb(n,e,t,i){const{ctx:a}=n;if(t)a.arc(n.xCenter,n.yCenter,e,0,Yt);else{let o=n.getPointPosition(0,e);a.moveTo(o.x,o.y);for(let l=1;l<i;l++)o=n.getPointPosition(l,e),a.lineTo(o.x,o.y)}}function g6(n,e,t,i,a){const o=n.ctx,l=e.circular,{color:u,lineWidth:f}=e;!l&&!i||!u||!f||t<0||(o.save(),o.strokeStyle=u,o.lineWidth=f,o.setLineDash(a.dash||[]),o.lineDashOffset=a.dashOffset,o.beginPath(),qb(n,t,l,i),o.closePath(),o.stroke(),o.restore())}function v6(n,e,t){return is(n,{label:t,index:e,type:"pointLabel"})}class y6 extends tp{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ep.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Jn(np(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Si(e)&&!isNaN(e)?e:0,this.max=Si(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/np(this.options))}generateTickLabels(e){tp.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const a=zt(this.options.pointLabels.callback,[t,i],this);return a||a===0?a:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?s6(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,a){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-a)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,a))}getIndexAngle(e){const t=Yt/(this._pointLabels.length||1),i=this.options.startAngle||0;return yi(e*t+La(i))}getDistanceFromCenterForValue(e){if(mt(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(mt(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return v6(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const a=this.getIndexAngle(e)-cn+i;return{x:Math.cos(a)*t+this.xCenter,y:Math.sin(a)*t+this.yCenter,angle:a}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:a,bottom:o}=this._pointLabelItems[e];return{left:t,top:i,right:a,bottom:o}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),qb(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:a,border:o}=t,l=this._pointLabels.length;let u,f,m;if(t.pointLabels.display&&p6(this,l),a.display&&this.ticks.forEach((p,v)=>{if(v!==0||v===0&&this.min<0){f=this.getDistanceFromCenterForValue(p.value);const y=this.getContext(v),S=a.setContext(y),_=o.setContext(y);g6(this,S,f,l,_)}}),i.display){for(e.save(),u=l-1;u>=0;u--){const p=i.setContext(this.getPointLabelContext(u)),{color:v,lineWidth:y}=p;!y||!v||(e.lineWidth=y,e.strokeStyle=v,e.setLineDash(p.borderDash),e.lineDashOffset=p.borderDashOffset,f=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),m=this.getPointPosition(u,f),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(m.x,m.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const a=this.getIndexAngle(0);let o,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(a),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((u,f)=>{if(f===0&&this.min>=0&&!t.reverse)return;const m=i.setContext(this.getContext(f)),p=Tn(m.font);if(o=this.getDistanceFromCenterForValue(this.ticks[f].value),m.showLabelBackdrop){e.font=p.string,l=e.measureText(u.label).width,e.fillStyle=m.backdropColor;const v=Jn(m.backdropPadding);e.fillRect(-l/2-v.left,-o-p.size/2-v.top,l+v.width,p.size+v.height)}Us(e,u.label,0,-o,p,{color:m.color,strokeColor:m.textStrokeColor,strokeWidth:m.textStrokeWidth})}),e.restore()}drawTitle(){}}const uf={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},xi=Object.keys(uf);function Ky(n,e){return n-e}function Zy(n,e){if(mt(e))return null;const t=n._adapter,{parser:i,round:a,isoWeekday:o}=n._parseOpts;let l=e;return typeof i=="function"&&(l=i(l)),Si(l)||(l=typeof i=="string"?t.parse(l,i):t.parse(l)),l===null?null:(a&&(l=a==="week"&&(Oc(o)||o===!0)?t.startOf(l,"isoWeek",o):t.startOf(l,a)),+l)}function Qy(n,e,t,i){const a=xi.length;for(let o=xi.indexOf(n);o<a-1;++o){const l=uf[xi[o]],u=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((t-e)/(u*l.size))<=i)return xi[o]}return xi[a-1]}function x6(n,e,t,i,a){for(let o=xi.length-1;o>=xi.indexOf(t);o--){const l=xi[o];if(uf[l].common&&n._adapter.diff(a,i,l)>=e-1)return l}return xi[t?xi.indexOf(t):0]}function b6(n){for(let e=xi.indexOf(n)+1,t=xi.length;e<t;++e)if(uf[xi[e]].common)return xi[e]}function Jy(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:a}=Sp(t,e),o=t[i]>=e?t[i]:t[a];n[o]=!0}}function S6(n,e,t,i){const a=n._adapter,o=+a.startOf(e[0].value,i),l=e[e.length-1].value;let u,f;for(u=o;u<=l;u=+a.add(u,1,i))f=t[u],f>=0&&(e[f].major=!0);return e}function ex(n,e,t){const i=[],a={},o=e.length;let l,u;for(l=0;l<o;++l)u=e[l],a[u]=l,i.push({value:u,major:!1});return o===0||!t?i:S6(n,i,a,t)}class tx extends el{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),a=this._adapter=new a3._date(e.adapters.date);a.init(t),yc(i.displayFormats,a.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:Zy(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:a,max:o,minDefined:l,maxDefined:u}=this.getUserBounds();function f(m){!l&&!isNaN(m.min)&&(a=Math.min(a,m.min)),!u&&!isNaN(m.max)&&(o=Math.max(o,m.max))}(!l||!u)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),a=Si(a)&&!isNaN(a)?a:+t.startOf(Date.now(),i),o=Si(o)&&!isNaN(o)?o:+t.endOf(Date.now(),i)+1,this.min=Math.min(a,o-1),this.max=Math.max(a+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,a=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);const o=this.min,l=this.max,u=y4(a,o,l);return this._unit=t.unit||(i.autoSkip?Qy(t.minUnit,this.min,this.max,this._getLabelCapacity(o)):x6(this,u.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:b6(this._unit),this.initOffsets(a),e.reverse&&u.reverse(),ex(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,a,o;this.options.offset&&e.length&&(a=this.getDecimalForValue(e[0]),e.length===1?t=1-a:t=(this.getDecimalForValue(e[1])-a)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?i=o:i=(o-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;t=Kn(t,0,l),i=Kn(i,0,l),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,a=this.options,o=a.time,l=o.unit||Qy(o.minUnit,t,i,this._getLabelCapacity(t)),u=it(a.ticks.stepSize,1),f=l==="week"?o.isoWeekday:!1,m=Oc(f)||f===!0,p={};let v=t,y,S;if(m&&(v=+e.startOf(v,"isoWeek",f)),v=+e.startOf(v,m?"day":l),e.diff(i,t,l)>1e5*u)throw new Error(t+" and "+i+" are too far apart with stepSize of "+u+" "+l);const _=a.ticks.source==="data"&&this.getDataTimestamps();for(y=v,S=0;y<i;y=+e.add(y,u,l),S++)Jy(p,y,_);return(y===i||a.bounds==="ticks"||S===1)&&Jy(p,y,_),Object.keys(p).sort(Ky).map(x=>+x)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const a=this.options.time.displayFormats,o=this._unit,l=t||a[o];return this._adapter.format(e,l)}_tickFormatFunction(e,t,i,a){const o=this.options,l=o.ticks.callback;if(l)return zt(l,[e,t,i],this);const u=o.time.displayFormats,f=this._unit,m=this._majorUnit,p=f&&u[f],v=m&&u[m],y=i[t],S=m&&v&&y&&y.major;return this._adapter.format(e,a||(S?v:p))}generateTickLabels(e){let t,i,a;for(t=0,i=e.length;t<i;++t)a=e[t],a.label=this._tickFormatFunction(a.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,a=La(this.isHorizontal()?t.maxRotation:t.minRotation),o=Math.cos(a),l=Math.sin(a),u=this._resolveTickFontOptions(0).size;return{w:i*o+u*l,h:i*l+u*o}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,a=i[t.unit]||i.millisecond,o=this._tickFormatFunction(e,0,ex(this,[e],this._majorUnit),a),l=this._getLabelSize(o),u=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(t=0,i=a.length;t<i;++t)e=e.concat(a[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const a=this.getLabels();for(t=0,i=a.length;t<i;++t)e.push(Zy(this,a[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return yb(e.sort(Ky))}}function bd(n,e,t){let i=0,a=n.length-1,o,l,u,f;t?(e>=n[i].pos&&e<=n[a].pos&&({lo:i,hi:a}=Ls(n,"pos",e)),{pos:o,time:u}=n[i],{pos:l,time:f}=n[a]):(e>=n[i].time&&e<=n[a].time&&({lo:i,hi:a}=Ls(n,"time",e)),{time:o,pos:u}=n[i],{time:l,pos:f}=n[a]);const m=l-o;return m?u+(f-u)*(e-o)/m:u}class BM extends tx{static id="timeseries";static defaults=tx.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=bd(t,this.min),this._tableRange=bd(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,a=[],o=[];let l,u,f,m,p;for(l=0,u=e.length;l<u;++l)m=e[l],m>=t&&m<=i&&a.push(m);if(a.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(l=0,u=a.length;l<u;++l)p=a[l+1],f=a[l-1],m=a[l],Math.round((p+f)/2)!==m&&o.push({time:m,pos:l/(u-1)});return o}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((a,o)=>a-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(bd(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return bd(this._table,i*this._tableRange+this._minPos,!0)}}const Kb="label";function nx(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function _6(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function Zb(n,e){n.labels=e}function Qb(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Kb;const i=[];n.datasets=e.map(a=>{const o=n.datasets.find(l=>l[t]===a[t]);return!o||!a.data||i.includes(o)?{...a}:(i.push(o),Object.assign(o,a),o)})}function T6(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kb;const t={labels:[],datasets:[]};return Zb(t,n.labels),Qb(t,n.datasets,e),t}function w6(n,e){const{height:t=150,width:i=300,redraw:a=!1,datasetIdKey:o,type:l,data:u,options:f,plugins:m=[],fallbackContent:p,updateMode:v,...y}=n,S=W.useRef(null),_=W.useRef(null),x=()=>{S.current&&(_.current=new cf(S.current,{type:l,data:T6(u,o),options:f&&{...f},plugins:m}),nx(e,_.current))},T=()=>{nx(e,null),_.current&&(_.current.destroy(),_.current=null)};return W.useEffect(()=>{!a&&_.current&&f&&_6(_.current,f)},[a,f]),W.useEffect(()=>{!a&&_.current&&Zb(_.current.config.data,u.labels)},[a,u.labels]),W.useEffect(()=>{!a&&_.current&&u.datasets&&Qb(_.current.config.data,u.datasets,o)},[a,u.datasets]),W.useEffect(()=>{_.current&&(a?(T(),setTimeout(x)):_.current.update(v))},[a,f,u.labels,u.datasets,v]),W.useEffect(()=>{_.current&&(T(),setTimeout(x))},[l]),W.useEffect(()=>(x(),()=>T()),[]),zo.createElement("canvas",{ref:S,role:"img",height:t,width:i,...y},p)}const E6=W.forwardRef(w6);function df(n,e){return cf.register(e),W.forwardRef((t,i)=>zo.createElement(E6,{...t,ref:i,type:n}))}const A6=df("line",n3),k6=df("bar",JA),C6=df("radar",i3),j6=df("doughnut",t3),ix=[{id:"1",name:"Enterprise CRM Implementation",client:"Salesforce",clientId:"1",color:"#00a1e0",rate:285,description:"Full Salesforce deployment for global enterprise sales team",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-01-15",expectedEndDate:"2025-05-30",createdAt:"2025-01-15"},{id:"2",name:"Marketing Automation Platform",client:"HubSpot",clientId:"2",color:"#ff7a59",rate:265,description:"HubSpot marketing automation setup for lead nurturing campaigns",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-02-01",expectedEndDate:"2025-06-15",createdAt:"2025-02-01"},{id:"3",name:"Customer Support Portal Migration",client:"Zendesk",clientId:"3",color:"#03363d",rate:225,description:"Migrate legacy support system to Zendesk with custom workflows",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-12-01",expectedEndDate:"2025-04-15",createdAt:"2025-12-01"},{id:"4",name:"Project Management Rollout",client:"Monday.com",clientId:"4",color:"#ff3d57",rate:195,description:"Monday.com deployment across 15 departments with custom workflows",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-03-15",expectedEndDate:"2025-04-30",createdAt:"2025-03-05"},{id:"5",name:"Identity & Access Management",client:"Okta",clientId:"5",color:"#007dc1",rate:295,description:"Okta SSO implementation with multi-factor authentication",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-08-12",expectedEndDate:"2025-02-28",createdAt:"2025-08-12"},{id:"6",name:"Enterprise Communication Platform",client:"Slack",clientId:"6",color:"#4a154b",rate:275,description:"Slack Enterprise Grid setup for 5,000+ employees",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-09-18",expectedEndDate:"2025-03-31",createdAt:"2025-09-18"},{id:"7",name:"Digital Signature Workflow",client:"DocuSign",clientId:"7",color:"#ffb900",rate:215,description:"DocuSign integration with existing contract management system",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-01-25",expectedEndDate:"2025-05-15",createdAt:"2025-01-25"},{id:"8",name:"Video Communications Platform",client:"Zoom",clientId:"8",color:"#2d8cff",rate:255,description:"Zoom Enterprise deployment with webinar and phone integration",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-12-08",expectedEndDate:"2025-04-30",createdAt:"2025-12-08"},{id:"9",name:"Developer Toolchain Modernization",client:"Atlassian",clientId:"9",color:"#0052cc",rate:270,description:"Atlassian suite implementation: Jira, Confluence, Bitbucket",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2023-10-14",expectedEndDate:"2025-03-31",createdAt:"2025-10-14"},{id:"10",name:"Communication API Integration",client:"Twilio",clientId:"10",color:"#f22f46",rate:235,description:"Twilio API integration for SMS/voice notifications",category:"implementation",status:"active",active:!0,billable:!0,startDate:"2025-02-12",expectedEndDate:"2025-05-30",createdAt:"2025-02-12"},{id:"11",name:"Internal Operations",client:"Internal",clientId:"11",color:"#6b7280",rate:0,description:"Internal meetings, team development, and administrative tasks",category:"ongoing-support",status:"active",active:!0,billable:!1,startDate:"2025-01-01",createdAt:"2025-01-01"}],D6=[{id:"1",name:"google-calendar",enabled:!0,connectedAt:"2024-01-10T10:00:00Z",lastSync:"2024-06-28T14:30:00Z",settings:{autoCreateEntries:!0,defaultCategory:"client",syncCalendars:["primary","work@company.com"]}},{id:"2",name:"slack",enabled:!0,connectedAt:"2024-01-10T10:00:00Z",lastSync:"2024-06-28T14:25:00Z",settings:{trackDMs:!0,trackChannels:["#customer-success","#implementations"],minimumDuration:5}},{id:"3",name:"zoom",enabled:!0,connectedAt:"2024-01-12T09:00:00Z",lastSync:"2024-06-28T13:45:00Z",settings:{autoTrackMeetings:!0,excludePersonalMeetings:!0}},{id:"4",name:"teams",enabled:!1,settings:{}},{id:"5",name:"salesforce",enabled:!0,connectedAt:"2024-02-01T11:00:00Z",lastSync:"2024-06-28T15:00:00Z",settings:{syncOpportunities:!0,autoCreateProjects:!0}}],ax=[{id:"1",date:"2025-07-13",startTime:"09:00",endTime:"10:30",duration:1.5,client:"Salesforce",project:"Enterprise CRM Implementation",description:"Project kickoff with Salesforce stakeholders - scope and timeline review",category:"client",status:"pending",automated:!0,source:"calendar",meetingType:"kickoff",billable:!0,rate:285,tags:["kickoff","stakeholders","planning"]},{id:"2",date:"2025-07-13",startTime:"10:45",endTime:"11:15",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"1:1 with manager Jessica - quarterly goal alignment and feedback",category:"internal",status:"pending",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["1:1","manager","goals","feedback"]},{id:"3",date:"2025-07-13",startTime:"13:00",endTime:"14:00",duration:1,client:"HubSpot",project:"Marketing Automation Platform",description:"Discovery session with HubSpot marketing team for lead scoring workflows",category:"client",status:"pending",automated:!0,source:"zoom",meetingType:"discovery",billable:!0,rate:265,tags:["discovery","marketing","lead-scoring"]},{id:"4",date:"2025-07-13",startTime:"15:30",endTime:"16:30",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"All-hands company meeting - Q2 results and new product roadmap",category:"internal",status:"pending",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["all-hands","q2-results","roadmap"]},{id:"5",date:"2025-07-12",startTime:"09:00",endTime:"10:00",duration:1,client:"Zendesk",project:"Customer Support Portal Migration",description:"Technical requirements review with Zendesk integration team",category:"client",status:"submitted",automated:!0,source:"calendar",meetingType:"discovery",billable:!0,rate:225,tags:["technical","requirements","integration"]},{id:"6",date:"2025-07-12",startTime:"10:30",endTime:"11:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Daily standup - sprint retrospective and planning for next iteration",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["standup","sprint","retrospective"]},{id:"7",date:"2025-07-12",startTime:"14:00",endTime:"15:30",duration:1.5,client:"Monday.com",project:"Project Management Rollout",description:"Training session for department heads on Monday.com workflows",category:"client",status:"submitted",automated:!0,source:"zoom",meetingType:"training",billable:!0,rate:195,tags:["training","workflows","department-heads"]},{id:"8",date:"2025-07-11",startTime:"16:00",endTime:"16:45",duration:.75,client:"Okta",project:"Identity & Access Management",description:"Slack discussion thread - troubleshooting SSO configuration issues",category:"client",status:"submitted",automated:!0,source:"slack",billable:!0,rate:295,tags:["support","sso","troubleshooting"]},{id:"9",date:"2025-07-10",startTime:"09:00",endTime:"10:30",duration:1.5,client:"Slack Technologies",project:"Enterprise Communication Platform",description:"Monthly business review with Slack executive team",category:"client",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!0,rate:275,tags:["mbr","executive","monthly-review"]},{id:"10",date:"2025-07-10",startTime:"11:00",endTime:"12:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Customer Success team standup - pipeline review and account updates",category:"internal",status:"approved",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["cs-team","pipeline","accounts"]},{id:"11",date:"2025-07-10",startTime:"13:30",endTime:"14:30",duration:1,client:"DocuSign",project:"Digital Signature Workflow",description:"Implementation planning session with DocuSign product team",category:"client",status:"approved",automated:!0,source:"zoom",meetingType:"implementation",billable:!0,rate:215,tags:["implementation","planning","product-team"]},{id:"12",date:"2025-07-10",startTime:"15:30",endTime:"16:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Expense report submission and timesheet review",category:"admin",status:"approved",automated:!1,billable:!1,tags:["admin","expenses","timesheet"]},{id:"13",date:"2025-07-09",startTime:"10:00",endTime:"11:30",duration:1.5,client:"Zoom Video Communications",project:"Video Communications Platform",description:"Training session with Zoom admins on enterprise features and webinars",category:"client",status:"approved",automated:!0,source:"zoom",meetingType:"training",billable:!0,rate:255,tags:["training","enterprise","webinars"]},{id:"14",date:"2025-07-09",startTime:"14:00",endTime:"15:00",duration:1,client:"Atlassian",project:"Developer Toolchain Modernization",description:"Escalation call with Atlassian CTO - critical integration blockers",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"escalation",billable:!0,rate:270,tags:["escalation","cto","blockers"]},{id:"15",date:"2025-07-09",startTime:"16:30",endTime:"17:00",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"1:1 with direct report Alex - career development and project assignments",category:"internal",status:"approved",automated:!0,source:"calendar",meetingType:"check-in",billable:!1,tags:["1:1","direct-report","career-development"]},{id:"16",date:"2025-07-08",startTime:"09:00",endTime:"09:30",duration:.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Daily team standup - sprint planning and impediment review",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["standup","sprint","impediments"]},{id:"17",date:"2025-07-08",startTime:"11:00",endTime:"12:00",duration:1,client:"Twilio",project:"Communication API Integration",description:"Discovery session for SMS and voice notification requirements",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"discovery",billable:!0,rate:235,tags:["discovery","sms","voice","notifications"]},{id:"18",date:"2025-07-08",startTime:"15:00",endTime:"16:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Engineering sync - technical debt review and architecture decisions",category:"internal",status:"approved",automated:!0,source:"slack",meetingType:"check-in",billable:!1,tags:["engineering","tech-debt","architecture"]},{id:"19",date:"2025-07-07",startTime:"09:30",endTime:"10:30",duration:1,client:"HubSpot",project:"Marketing Automation Platform",description:"Support escalation - campaign automation not triggering properly",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"support",billable:!0,rate:265,tags:["support","automation","campaigns"]},{id:"20",date:"2025-07-07",startTime:"13:00",endTime:"14:30",duration:1.5,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Quarterly all-hands - company strategy and new hiring initiatives",category:"internal",status:"approved",automated:!0,source:"teams",meetingType:"check-in",billable:!1,tags:["quarterly","all-hands","strategy","hiring"]},{id:"21",date:"2025-07-06",startTime:"10:00",endTime:"11:00",duration:1,client:"Salesforce",project:"Enterprise CRM Implementation",description:"Weekly implementation status meeting with project stakeholders",category:"client",status:"approved",automated:!0,source:"calendar",meetingType:"implementation",billable:!0,rate:285,tags:["weekly","status","stakeholders"]},{id:"22",date:"2025-07-06",startTime:"14:00",endTime:"15:00",duration:1,client:"Internal - TimeBeacon",project:"Internal Operations",description:"Team retrospective - process improvements and workflow optimization",category:"internal",status:"approved",automated:!0,source:"zoom",meetingType:"check-in",billable:!1,tags:["retrospective","process","optimization"]}],uc={workingHours:{start:"09:00",end:"17:00"},notifications:!0,theme:"light",integrations:D6},Sd={theme:"light",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,workingHours:{start:"09:00",end:"17:00",workingDays:[1,2,3,4,5]},notifications:{enableDesktop:!0,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:{}},Jb=()=>{const[n,e]=W.useState({timeEntries:[],projects:[],clients:[],settings:Sd,isLoading:!0,error:null});W.useEffect(()=>{(async()=>{try{e(A=>({...A,isLoading:!0,error:null})),await It.init();const[w,E,C,N]=await Promise.all([It.getAllTimeEntries(),It.getAllProjects(),It.getAllClients(),It.getSettings()]);if(w.length===0){console.log(" No time entries found. Loading mock data..."),await It.clearAllData(),await t();const[A,I,D]=await Promise.all([It.getAllTimeEntries(),It.getAllProjects(),It.getAllClients()]);e({timeEntries:A,projects:I,clients:D,settings:N||Sd,isLoading:!1,error:null})}else e({timeEntries:w,projects:E,clients:C,settings:N||Sd,isLoading:!1,error:null});console.log(" Data loaded from database")}catch(w){console.error(" Failed to load data:",w),e(E=>({...E,isLoading:!1,error:w instanceof Error?w.message:"Failed to load data"}))}})()},[]);const t=async()=>{console.log(" Creating initial data with mock entries...");for(const w of ix)await It.addProject(w);for(const w of ax)await It.addTimeEntry(w);const T={theme:uc.theme,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,workingHours:{start:uc.workingHours.start,end:uc.workingHours.end,workingDays:[1,2,3,4,5]},notifications:{enableDesktop:uc.notifications,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:uc.integrations.reduce((w,E)=>(w[E.name]={enabled:E.enabled,lastSync:E.lastSync,connectedAt:E.connectedAt,settings:E.settings},w),{})};await It.updateSettings(T),console.log(" Initial data created with",ax.length,"time entries and",ix.length,"projects")},i=W.useCallback(async T=>{try{const w={...T,id:crypto.randomUUID()};return await It.addTimeEntry(w),e(E=>({...E,timeEntries:[...E.timeEntries,w]})),w}catch(w){throw console.error(" Failed to add time entry:",w),w}},[]),a=W.useCallback(async(T,w)=>{try{await It.updateTimeEntry(T,w),e(E=>({...E,timeEntries:E.timeEntries.map(C=>C.id===T?{...C,...w}:C)}))}catch(E){throw console.error(" Failed to update time entry:",E),E}},[]),o=W.useCallback(async T=>{try{await It.deleteTimeEntry(T),e(w=>({...w,timeEntries:w.timeEntries.filter(E=>E.id!==T)}))}catch(w){throw console.error(" Failed to delete time entry:",w),w}},[]),l=W.useCallback(async T=>{try{const w={...T,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return await It.addProject(w),e(E=>({...E,projects:[...E.projects,w]})),w}catch(w){throw console.error(" Failed to add project:",w),w}},[]),u=W.useCallback(async(T,w)=>{try{await It.updateProject(T,w),e(E=>({...E,projects:E.projects.map(C=>C.id===T?{...C,...w}:C)}))}catch(E){throw console.error(" Failed to update project:",E),E}},[]),f=W.useCallback(async T=>{try{await It.deleteProject(T),e(w=>({...w,projects:w.projects.filter(E=>E.id!==T)}))}catch(w){throw console.error(" Failed to delete project:",w),w}},[]),m=W.useCallback(async T=>{try{const w={...T,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return await It.addClient(w),e(E=>({...E,clients:[...E.clients,w]})),w}catch(w){throw console.error(" Failed to add client:",w),w}},[]),p=W.useCallback(async(T,w)=>{try{await It.updateClient(T,w),e(E=>({...E,clients:E.clients.map(C=>C.id===T?{...C,...w}:C)}))}catch(E){throw console.error(" Failed to update client:",E),E}},[]),v=W.useCallback(async T=>{try{await It.deleteClient(T),e(w=>({...w,clients:w.clients.filter(E=>E.id!==T)}))}catch(w){throw console.error(" Failed to delete client:",w),w}},[]),y=W.useCallback(async T=>{try{await It.updateSettings(T),e(w=>({...w,settings:T}))}catch(w){throw console.error(" Failed to update settings:",w),w}},[]),S=W.useCallback(T=>{console.log(" Toggle integration:",T),e(w=>({...w,settings:{...w.settings,integrations:{...w.settings.integrations,[T]:{enabled:!w.settings.integrations[T]?.enabled,lastSync:new Date().toISOString()}}}}))},[]),_=W.useCallback(async T=>{try{const w=await It.exportAllData();if(T==="json"){const E=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),C=URL.createObjectURL(E),N=document.createElement("a");N.href=C,N.download=`timebeacon-backup-${new Date().toISOString().split("T")[0]}.json`,N.click(),URL.revokeObjectURL(C)}else{const E=["Date,Start Time,End Time,Duration,Client,Project,Description,Status,Billable",...w.timeEntries.map(I=>[I.date,I.startTime,I.endTime,I.duration,I.client,I.project,`"${I.description.replace(/"/g,'""')}"`,I.status,I.billable?"Yes":"No"].join(","))].join(`
`),C=new Blob([E],{type:"text/csv"}),N=URL.createObjectURL(C),A=document.createElement("a");A.href=N,A.download=`timebeacon-entries-${new Date().toISOString().split("T")[0]}.csv`,A.click(),URL.revokeObjectURL(N)}console.log(" Data exported successfully")}catch(w){throw console.error(" Failed to export data:",w),w}},[]),x=W.useCallback(async()=>{try{await It.clearAllData(),e({timeEntries:[],projects:[],clients:[],settings:Sd,isLoading:!1,error:null}),console.log(" All data cleared")}catch(T){throw console.error(" Failed to clear data:",T),T}},[]);return{timeEntries:n.timeEntries,projects:n.projects,clients:n.clients,settings:n.settings,isLoading:n.isLoading,error:n.error,addTimeEntry:i,updateTimeEntry:a,deleteTimeEntry:o,addProject:l,updateProject:u,deleteProject:f,addClient:m,updateClient:p,deleteClient:v,setSettings:y,toggleIntegration:S,exportData:_,clearAllData:x}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wd={};Wd.version="0.18.5";var eS=1252,N6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],tS=function(n){N6.indexOf(n)!=-1&&(eS=n)};function O6(){tS(1252)}var Ic=function(n){tS(n)};function R6(){Ic(1200),O6()}var _d=function(e){return String.fromCharCode(e)},rx=function(e){return String.fromCharCode(e)},Vd,qr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pc(n){for(var e="",t=0,i=0,a=0,o=0,l=0,u=0,f=0,m=0;m<n.length;)t=n.charCodeAt(m++),o=t>>2,i=n.charCodeAt(m++),l=(t&3)<<4|i>>4,a=n.charCodeAt(m++),u=(i&15)<<2|a>>6,f=a&63,isNaN(i)?u=f=64:isNaN(a)&&(f=64),e+=qr.charAt(o)+qr.charAt(l)+qr.charAt(u)+qr.charAt(f);return e}function hr(n){var e="",t=0,i=0,a=0,o=0,l=0,u=0,f=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<n.length;)o=qr.indexOf(n.charAt(m++)),l=qr.indexOf(n.charAt(m++)),t=o<<2|l>>4,e+=String.fromCharCode(t),u=qr.indexOf(n.charAt(m++)),i=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(i)),f=qr.indexOf(n.charAt(m++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var _t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),gr=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function zs(n){return _t?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function sx(n){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var pa=function(e){return _t?gr(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function ff(n){if(typeof ArrayBuffer>"u")return pa(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),i=0;i!=n.length;++i)t[i]=n.charCodeAt(i)&255;return e}function $c(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function M6(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var zn=_t?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:gr(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var i=new Uint8Array(t),a=0;for(e=0,t=0;e<n.length;t+=a,++e)if(a=n[e].length,n[e]instanceof Uint8Array)i.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";i.set(new Uint8Array(n[e]),t)}return i}return[].concat.apply([],n.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function L6(n){for(var e=[],t=0,i=n.length+250,a=zs(n.length+255),o=0;o<n.length;++o){var l=n.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=n.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|u>>6&15|(l&3)<<4,a[t++]=128|u&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>i&&(e.push(a.slice(0,t)),t=0,a=zs(65535),i=65530)}return e.push(a.slice(0,t)),zn(e)}var _c=/\u0000/g,Td=/[\u0001-\u0006]/g;function Wo(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function ga(n,e){var t=""+n;return t.length>=e?t:an("0",e-t.length)+t}function Lp(n,e){var t=""+n;return t.length>=e?t:an(" ",e-t.length)+t}function Gd(n,e){var t=""+n;return t.length>=e?t:t+an(" ",e-t.length)}function I6(n,e){var t=""+Math.round(n);return t.length>=e?t:an("0",e-t.length)+t}function P6(n,e){var t=""+n;return t.length>=e?t:an("0",e-t.length)+t}var ox=Math.pow(2,32);function Lo(n,e){if(n>ox||n<-ox)return I6(n,e);var t=Math.round(n);return P6(t,e)}function Yd(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var lx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function B6(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var sn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},cx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},F6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xd(n,e,t){for(var i=n<0?-1:1,a=n*i,o=0,l=1,u=0,f=1,m=0,p=0,v=Math.floor(a);m<e&&(v=Math.floor(a),u=v*l+o,p=v*m+f,!(a-v<5e-8));)a=1/(a-v),o=l,l=u,f=m,m=p;if(p>e&&(m>e?(p=f,u=o):(p=m,u=l)),!t)return[0,i*u,p];var y=Math.floor(i*u/p);return[y,i*u-y*p,p]}function wd(n,e,t){if(n>2958465||n<0)return null;var i=n|0,a=Math.floor(86400*(n-i)),o=0,l=[],u={D:i,T:a,u:86400*(n-i)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(i+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++i,++u.D)),i===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(i===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{i>60&&--i;var f=new Date(1900,0,1);f.setDate(f.getDate()+i-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),i<60&&(o=(o+6)%7),t&&(o=Y6(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var nS=new Date(1899,11,31,0,0,0),U6=nS.getTime(),z6=new Date(1900,2,1,0,0,0);function iS(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=z6&&(t+=24*60*60*1e3),(t-(U6+(n.getTimezoneOffset()-nS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ip(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function H6(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function W6(n){var e=n<0?12:11,t=Ip(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function V6(n){var e=Ip(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function G6(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=W6(n):e===10?t=n.toFixed(10).substr(0,12):t=V6(n),Ip(H6(t.toUpperCase()))}function ip(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):G6(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return es(14,iS(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function Y6(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function X6(n,e,t,i){var a="",o=0,l=0,u=t.y,f,m=0;switch(n){case 98:u=t.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,m=2;break;default:f=u%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:f=t.m,m=e.length;break;case 3:return Pm[t.m-1][1];case 5:return Pm[t.m-1][0];default:return Pm[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=t.d,m=e.length;break;case 3:return lx[t.q][0];default:return lx[t.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(t.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=t.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=t.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?ga(t.S,e.length):(i>=2?l=i===3?1e3:100:l=i===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(a=ga(o,2+i),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:f=u,m=1;break}var p=m>0?ga(f,m):"";return p}function Kr(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,i=n.substr(0,t);t!=n.length;t+=e)i+=(i.length>0?",":"")+n.substr(t,e);return i}var aS=/%/g;function $6(n,e,t){var i=e.replace(aS,""),a=e.length-i.length;return cr(n,i,t*Math.pow(10,2*a))+an("%",a)}function q6(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return cr(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function rS(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+rS(n,-e);var a=n.indexOf(".");a===-1&&(a=n.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(e/Math.pow(10,o)).toPrecision(i+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var sS=/# (\?+)( ?)\/( ?)(\d+)/;function K6(n,e,t){var i=parseInt(n[4],10),a=Math.round(e*i),o=Math.floor(a/i),l=a-o*i,u=i;return t+(o===0?"":""+o)+" "+(l===0?an(" ",n[1].length+1+n[4].length):Lp(l,n[1].length)+n[2]+"/"+n[3]+ga(u,n[4].length))}function Z6(n,e,t){return t+(e===0?"":""+e)+an(" ",n[1].length+2+n[4].length)}var oS=/^#*0*\.([0#]+)/,lS=/\).*[0#]/,cS=/\(###\) ###\\?-####/;function ri(n){for(var e="",t,i=0;i!=n.length;++i)switch(t=n.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function ux(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function dx(n,e){var t=n-Math.floor(n),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function Q6(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function J6(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ji(n,e,t){if(n.charCodeAt(0)===40&&!e.match(lS)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ji("n",i,t):"("+Ji("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return q6(n,e,t);if(e.indexOf("%")!==-1)return $6(n,e,t);if(e.indexOf("E")!==-1)return rS(e,t);if(e.charCodeAt(0)===36)return"$"+Ji(n,e.substr(e.charAt(1)==" "?2:1),t);var a,o,l,u,f=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+Lo(f,e.length);if(e.match(/^[#?]+$/))return a=Lo(t,0),a==="0"&&(a=""),a.length>e.length?a:ri(e.substr(0,e.length-a.length))+a;if(o=e.match(sS))return K6(o,f,m);if(e.match(/^#+0+$/))return m+Lo(f,e.length-e.indexOf("0"));if(o=e.match(oS))return a=ux(t,o[1].length).replace(/^([^\.]+)$/,"$1."+ri(o[1])).replace(/\.$/,"."+ri(o[1])).replace(/\.(\d*)$/,function(_,x){return"."+x+an("0",ri(o[1]).length-x.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+ux(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+Kr(Lo(f,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ji(n,e,-t):Kr(""+(Math.floor(t)+Q6(t,o[1].length)))+"."+ga(dx(t,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Ji(n,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wo(Ji(n,e.replace(/[\\-]/g,""),t)),l=0,Wo(Wo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return l<a.length?a.charAt(l++):_==="0"?"0":""}));if(e.match(cS))return a=Ji(n,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Xd(f,Math.pow(10,l)-1,!1),a=""+m,p=cr("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Gd(u[2],l),p.length<o[4].length&&(p=ri(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Xd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Lp(u[1],l)+o[2]+"/"+o[3]+Gd(u[2],l):an(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=Lo(t,0),e.length<=a.length?a:ri(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,y=e.length-a.length-v;return ri(e.substr(0,v)+a+e.substr(e.length-y))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=dx(t,o[1].length),t<0?"-"+Ji(n,e,-t):Kr(J6(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?ga(0,3-_.length):"")+_})+"."+ga(l,o[1].length);switch(e){case"###,##0.00":return Ji(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var S=Kr(Lo(f,0));return S!=="0"?m+S:"";case"###,###.00":return Ji(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ji(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function e5(n,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return cr(n,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function t5(n,e,t){var i=e.replace(aS,""),a=e.length-i.length;return cr(n,i,t*Math.pow(10,2*a))+an("%",a)}function uS(n,e){var t,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+uS(n,-e);var a=n.indexOf(".");a===-1&&(a=n.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(e/Math.pow(10,o)).toPrecision(i+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,m,p){return f+m+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=e.toExponential(i);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Na(n,e,t){if(n.charCodeAt(0)===40&&!e.match(lS)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Na("n",i,t):"("+Na("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return e5(n,e,t);if(e.indexOf("%")!==-1)return t5(n,e,t);if(e.indexOf("E")!==-1)return uS(e,t);if(e.charCodeAt(0)===36)return"$"+Na(n,e.substr(e.charAt(1)==" "?2:1),t);var a,o,l,u,f=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+ga(f,e.length);if(e.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>e.length?a:ri(e.substr(0,e.length-a.length))+a;if(o=e.match(sS))return Z6(o,f,m);if(e.match(/^#+0+$/))return m+ga(f,e.length-e.indexOf("0"));if(o=e.match(oS))return a=(""+t).replace(/^([^\.]+)$/,"$1."+ri(o[1])).replace(/\.$/,"."+ri(o[1])),a=a.replace(/\.(\d*)$/,function(_,x){return"."+x+an("0",ri(o[1]).length-x.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+Kr(""+f);if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Na(n,e,-t):Kr(""+t)+"."+an("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Na(n,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wo(Na(n,e.replace(/[\\-]/g,""),t)),l=0,Wo(Wo(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return l<a.length?a.charAt(l++):_==="0"?"0":""}));if(e.match(cS))return a=Na(n,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Xd(f,Math.pow(10,l)-1,!1),a=""+m,p=cr("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Gd(u[2],l),p.length<o[4].length&&(p=ri(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Xd(f,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Lp(u[1],l)+o[2]+"/"+o[3]+Gd(u[2],l):an(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+t,e.length<=a.length?a:ri(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,y=e.length-a.length-v;return ri(e.substr(0,v)+a+e.substr(e.length-y))}if(o=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Na(n,e,-t):Kr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?ga(0,3-_.length):"")+_})+"."+ga(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var S=Kr(""+f);return S!=="0"?m+S:"";default:if(e.match(/\.[0#?]*$/))return Na(n,e.slice(0,e.lastIndexOf(".")),t)+ri(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function cr(n,e,t){return(t|0)===t?Na(n,e,t):Ji(n,e,t)}function n5(n){for(var e=[],t=!1,i=0,a=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=n.substr(a,i-a),a=i+1}if(e[e.length]=n.substr(a),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var dS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fS(n){for(var e=0,t="",i="";e<n.length;)switch(t=n.charAt(e)){case"G":Yd(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=t;n.charAt(e++)!=="]"&&e<n.length;)i+=n.charAt(e);if(i.match(dS))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function i5(n,e,t,i){for(var a=[],o="",l=0,u="",f="t",m,p,v,y="H";l<n.length;)switch(u=n.charAt(l)){case"G":if(!Yd(n,l))throw new Error("unrecognized character "+u+" in "+n);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=n.charCodeAt(++l))!==34&&l<n.length;)o+=String.fromCharCode(v);a[a.length]={t:"t",v:o},++l;break;case"\\":var S=n.charAt(++l),_=S==="("||S===")"?S:"t";a[a.length]={t:_,v:S},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(n.charAt(l+1)==="1"||n.charAt(l+1)==="2"){if(m==null&&(m=wd(e,t,n.charAt(l+1)==="2"),m==null))return"";a[a.length]={t:"X",v:n.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=wd(e,t),m==null))return"";for(o=u;++l<n.length&&n.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:o},f=u;break;case"A":case"a":case"":var x={t:u,v:u};if(m==null&&(m=wd(e,t)),n.substr(l,3).toUpperCase()==="A/P"?(m!=null&&(x.v=m.H>=12?"P":"A"),x.t="T",y="h",l+=3):n.substr(l,5).toUpperCase()==="AM/PM"?(m!=null&&(x.v=m.H>=12?"PM":"AM"),x.t="T",l+=5,y="h"):n.substr(l,5).toUpperCase()==="/"?(m!=null&&(x.v=m.H>=12?"":""),x.t="T",l+=5,y="h"):(x.t="t",++l),m==null&&x.t==="T")return"";a[a.length]=x,f=u;break;case"[":for(o=u;n.charAt(l++)!=="]"&&l<n.length;)o+=n.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(dS)){if(m==null&&(m=wd(e,t),m==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",fS(n)||(a[a.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=u;++l<n.length&&(u=n.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<n.length&&"0#?.,E+-%".indexOf(u=n.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;n.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},f=u;break;case"*":++l,(n.charAt(l)==" "||n.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:i===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<n.length&&"0123456789".indexOf(n.charAt(++l))>-1;)o+=n.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+n);a[a.length]={t:"t",v:u},++l;break}var T=0,w=0,E;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=y,f="h",T<1&&(T=1);break;case"s":(E=a[l].v.match(/\.0+$/))&&(w=Math.max(w,E[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&a[l].v.match(/[Hh]/)&&(T=1),T<2&&a[l].v.match(/[Mm]/)&&(T=2),T<3&&a[l].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var C="",N;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=X6(a[l].t.charCodeAt(0),a[l].v,m,w),a[l].t="t";break;case"n":case"?":for(N=l+1;a[N]!=null&&((u=a[N].t)==="?"||u==="D"||(u===" "||u==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[l].v+=a[N].v,a[N]={v:"",t:";"},++N;C+=a[l].v,l=N-1;break;case"G":a[l].t="t",a[l].v=ip(e,t);break}var A="",I,D;if(C.length>0){C.charCodeAt(0)==40?(I=e<0&&C.charCodeAt(0)===45?-e:e,D=cr("n",C,I)):(I=e<0&&i>1?-e:e,D=cr("n",C,I),I<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),N=D.length-1;var z=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){z=l;break}var L=a.length;if(z===a.length&&D.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(N>=a[l].v.length-1?(N-=a[l].v.length,a[l].v=D.substr(N+1,a[l].v.length)):N<0?a[l].v="":(a[l].v=D.substr(0,N+1),N=-1),a[l].t="t",L=l);N>=0&&L<a.length&&(a[L].v=D.substr(0,N+1)+a[L].v)}else if(z!==a.length&&D.indexOf("E")===-1){for(N=D.indexOf(".")-1,l=z;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===z?a[l].v.indexOf(".")-1:a[l].v.length-1,A=a[l].v.substr(p+1);p>=0;--p)N>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(A=D.charAt(N--)+A);a[l].v=A,a[l].t="t",L=l}for(N>=0&&L<a.length&&(a[L].v=D.substr(0,N+1)+a[L].v),N=D.indexOf(".")+1,l=z;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==z)){for(p=a[l].v.indexOf(".")>-1&&l===z?a[l].v.indexOf(".")+1:0,A=a[l].v.substr(0,p);p<a[l].v.length;++p)N<D.length&&(A+=D.charAt(N++));a[l].v=A,a[l].t="t",L=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(I=i>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=cr(a[l].t,a[l].v,I),a[l].t="t");var H="";for(l=0;l!==a.length;++l)a[l]!=null&&(H+=a[l].v);return H}var fx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function hx(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function a5(n,e){var t=n5(n),i=t.length,a=t[i-1].indexOf("@");if(i<4&&a>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(fx),u=t[1].match(fx);return hx(e,l)?[i,t[0]]:hx(e,u)?[i,t[1]]:[i,t[l!=null&&u!=null?2:1]]}return[i,o]}function es(n,e,t){t==null&&(t={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?i=t.dateNF:i=n;break;case"number":n==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:sn)[n],i==null&&(i=t.table&&t.table[cx[n]]||sn[cx[n]]),i==null&&(i=F6[n]||"General");break}if(Yd(i,0))return ip(e,t);e instanceof Date&&(e=iS(e,t.date1904));var a=a5(i,e);if(Yd(a[1]))return ip(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return i5(a[1],e,t,a[0])}function hS(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(sn[t]==null){e<0&&(e=t);continue}if(sn[t]==n){e=t;break}}e<0&&(e=391)}return sn[e]=n,e}function hf(n){for(var e=0;e!=392;++e)n[e]!==void 0&&hS(n[e],e)}function mf(){sn=B6()}var mS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function r5(n){var e=typeof n=="number"?sn[n]:n;return e=e.replace(mS,"(\\d+)"),new RegExp("^"+e+"$")}function s5(n,e,t){var i=-1,a=-1,o=-1,l=-1,u=-1,f=-1;(e.match(mS)||[]).forEach(function(v,y){var S=parseInt(t[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":i=S;break;case"d":o=S;break;case"h":l=S;break;case"s":f=S;break;case"m":l>=0?u=S:a=S;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var m=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?m:i==-1&&a==-1&&o==-1?p:m+"T"+p}var o5=function(){var n={};n.version="1.2.0";function e(){for(var D=0,z=new Array(256),L=0;L!=256;++L)D=L,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,z[L]=D;return typeof Int32Array<"u"?new Int32Array(z):z}var t=e();function i(D){var z=0,L=0,H=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)K[H]=D[H];for(H=0;H!=256;++H)for(L=D[H],z=256+H;z<4096;z+=256)L=K[z]=L>>>8^D[L&255];var ne=[];for(H=1;H!=16;++H)ne[H-1]=typeof Int32Array<"u"?K.subarray(H*256,H*256+256):K.slice(H*256,H*256+256);return ne}var a=i(t),o=a[0],l=a[1],u=a[2],f=a[3],m=a[4],p=a[5],v=a[6],y=a[7],S=a[8],_=a[9],x=a[10],T=a[11],w=a[12],E=a[13],C=a[14];function N(D,z){for(var L=z^-1,H=0,K=D.length;H<K;)L=L>>>8^t[(L^D.charCodeAt(H++))&255];return~L}function A(D,z){for(var L=z^-1,H=D.length-15,K=0;K<H;)L=C[D[K++]^L&255]^E[D[K++]^L>>8&255]^w[D[K++]^L>>16&255]^T[D[K++]^L>>>24]^x[D[K++]]^_[D[K++]]^S[D[K++]]^y[D[K++]]^v[D[K++]]^p[D[K++]]^m[D[K++]]^f[D[K++]]^u[D[K++]]^l[D[K++]]^o[D[K++]]^t[D[K++]];for(H+=15;K<H;)L=L>>>8^t[(L^D[K++])&255];return~L}function I(D,z){for(var L=z^-1,H=0,K=D.length,ne=0,xe=0;H<K;)ne=D.charCodeAt(H++),ne<128?L=L>>>8^t[(L^ne)&255]:ne<2048?(L=L>>>8^t[(L^(192|ne>>6&31))&255],L=L>>>8^t[(L^(128|ne&63))&255]):ne>=55296&&ne<57344?(ne=(ne&1023)+64,xe=D.charCodeAt(H++)&1023,L=L>>>8^t[(L^(240|ne>>8&7))&255],L=L>>>8^t[(L^(128|ne>>2&63))&255],L=L>>>8^t[(L^(128|xe>>6&15|(ne&3)<<4))&255],L=L>>>8^t[(L^(128|xe&63))&255]):(L=L>>>8^t[(L^(224|ne>>12&15))&255],L=L>>>8^t[(L^(128|ne>>6&63))&255],L=L>>>8^t[(L^(128|ne&63))&255]);return~L}return n.table=t,n.bstr=N,n.buf=A,n.str=I,n}(),Pt=function(){var e={};e.version="1.2.1";function t(j,U){for(var R=j.split("/"),M=U.split("/"),F=0,B=0,se=Math.min(R.length,M.length);F<se;++F){if(B=R[F].length-M[F].length)return B;if(R[F]!=M[F])return R[F]<M[F]?-1:1}return R.length-M.length}function i(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:i(j.slice(0,-1));var U=j.lastIndexOf("/");return U===-1?j:j.slice(0,U+1)}function a(j){if(j.charAt(j.length-1)=="/")return a(j.slice(0,-1));var U=j.lastIndexOf("/");return U===-1?j:j.slice(U+1)}function o(j,U){typeof U=="string"&&(U=new Date(U));var R=U.getHours();R=R<<6|U.getMinutes(),R=R<<5|U.getSeconds()>>>1,j.write_shift(2,R);var M=U.getFullYear()-1980;M=M<<4|U.getMonth()+1,M=M<<5|U.getDate(),j.write_shift(2,M)}function l(j){var U=j.read_shift(2)&65535,R=j.read_shift(2)&65535,M=new Date,F=R&31;R>>>=5;var B=R&15;R>>>=4,M.setMilliseconds(0),M.setFullYear(R+1980),M.setMonth(B-1),M.setDate(F);var se=U&31;U>>>=5;var ue=U&63;return U>>>=6,M.setHours(U),M.setMinutes(ue),M.setSeconds(se<<1),M}function u(j){Ii(j,0);for(var U={},R=0;j.l<=j.length-4;){var M=j.read_shift(2),F=j.read_shift(2),B=j.l+F,se={};switch(M){case 21589:R=j.read_shift(1),R&1&&(se.mtime=j.read_shift(4)),F>5&&(R&2&&(se.atime=j.read_shift(4)),R&4&&(se.ctime=j.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}j.l=B,U[M]=se}return U}var f;function m(){return f||(f={})}function p(j,U){if(j[0]==80&&j[1]==75)return wi(j,U);if((j[0]|32)==109&&(j[1]|32)==105)return yn(j,U);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var R=3,M=512,F=0,B=0,se=0,ue=0,ee=0,le=[],de=j.slice(0,512);Ii(de,0);var Se=v(de);switch(R=Se[0],R){case 3:M=512;break;case 4:M=4096;break;case 0:if(Se[1]==0)return wi(j,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}M!==512&&(de=j.slice(0,M),Ii(de,28));var Ee=j.slice(0,M);y(de,R);var Ie=de.read_shift(4,"i");if(R===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);de.l+=4,se=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ue=de.read_shift(4,"i"),F=de.read_shift(4,"i"),ee=de.read_shift(4,"i"),B=de.read_shift(4,"i");for(var Te=-1,Oe=0;Oe<109&&(Te=de.read_shift(4,"i"),!(Te<0));++Oe)le[Oe]=Te;var Ge=S(j,M);T(ee,B,Ge,M,le);var vt=E(Ge,se,le,M);vt[se].name="!Directory",F>0&&ue!==xe&&(vt[ue].name="!MiniFAT"),vt[le[0]].name="!FAT",vt.fat_addrs=le,vt.ssz=M;var yt={},ht=[],ci=[],Ei=[];C(se,vt,Ge,ht,F,yt,ci,ue),_(ci,Ei,ht),ht.shift();var ni={FileIndex:ci,FullPaths:Ei};return U&&U.raw&&(ni.raw={header:Ee,sectors:Ge}),ni}function v(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(He,"Header Signature: "),j.l+=16;var U=j.read_shift(2,"u");return[j.read_shift(2,"u"),U]}function y(j,U){var R=9;switch(j.l+=2,R=j.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function S(j,U){for(var R=Math.ceil(j.length/U)-1,M=[],F=1;F<R;++F)M[F-1]=j.slice(F*U,(F+1)*U);return M[R-1]=j.slice(R*U),M}function _(j,U,R){for(var M=0,F=0,B=0,se=0,ue=0,ee=R.length,le=[],de=[];M<ee;++M)le[M]=de[M]=M,U[M]=R[M];for(;ue<de.length;++ue)M=de[ue],F=j[M].L,B=j[M].R,se=j[M].C,le[M]===M&&(F!==-1&&le[F]!==F&&(le[M]=le[F]),B!==-1&&le[B]!==B&&(le[M]=le[B])),se!==-1&&(le[se]=M),F!==-1&&M!=le[M]&&(le[F]=le[M],de.lastIndexOf(F)<ue&&de.push(F)),B!==-1&&M!=le[M]&&(le[B]=le[M],de.lastIndexOf(B)<ue&&de.push(B));for(M=1;M<ee;++M)le[M]===M&&(B!==-1&&le[B]!==B?le[M]=le[B]:F!==-1&&le[F]!==F&&(le[M]=le[F]));for(M=1;M<ee;++M)if(j[M].type!==0){if(ue=M,ue!=le[ue])do ue=le[ue],U[M]=U[ue]+"/"+U[M];while(ue!==0&&le[ue]!==-1&&ue!=le[ue]);le[M]=-1}for(U[0]+="/",M=1;M<ee;++M)j[M].type!==2&&(U[M]+="/")}function x(j,U,R){for(var M=j.start,F=j.size,B=[],se=M;R&&F>0&&se>=0;)B.push(U.slice(se*ne,se*ne+ne)),F-=ne,se=Ms(R,se*4);return B.length===0?me(0):zn(B).slice(0,j.size)}function T(j,U,R,M,F){var B=xe;if(j===xe){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var se=R[j],ue=(M>>>2)-1;if(!se)return;for(var ee=0;ee<ue&&(B=Ms(se,ee*4))!==xe;++ee)F.push(B);T(Ms(se,M-4),U-1,R,M,F)}}function w(j,U,R,M,F){var B=[],se=[];F||(F=[]);var ue=M-1,ee=0,le=0;for(ee=U;ee>=0;){F[ee]=!0,B[B.length]=ee,se.push(j[ee]);var de=R[Math.floor(ee*4/M)];if(le=ee*4&ue,M<4+le)throw new Error("FAT boundary crossed: "+ee+" 4 "+M);if(!j[de])break;ee=Ms(j[de],le)}return{nodes:B,data:Sx([se])}}function E(j,U,R,M){var F=j.length,B=[],se=[],ue=[],ee=[],le=M-1,de=0,Se=0,Ee=0,Ie=0;for(de=0;de<F;++de)if(ue=[],Ee=de+U,Ee>=F&&(Ee-=F),!se[Ee]){ee=[];var Te=[];for(Se=Ee;Se>=0;){Te[Se]=!0,se[Se]=!0,ue[ue.length]=Se,ee.push(j[Se]);var Oe=R[Math.floor(Se*4/M)];if(Ie=Se*4&le,M<4+Ie)throw new Error("FAT boundary crossed: "+Se+" 4 "+M);if(!j[Oe]||(Se=Ms(j[Oe],Ie),Te[Se]))break}B[Ee]={nodes:ue,data:Sx([ee])}}return B}function C(j,U,R,M,F,B,se,ue){for(var ee=0,le=M.length?2:0,de=U[j].data,Se=0,Ee=0,Ie;Se<de.length;Se+=128){var Te=de.slice(Se,Se+128);Ii(Te,64),Ee=Te.read_shift(2),Ie=zp(Te,0,Ee-le),M.push(Ie);var Oe={name:Ie,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},Ge=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);Ge!==0&&(Oe.ct=N(Te,Te.l-8));var vt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);vt!==0&&(Oe.mt=N(Te,Te.l-8)),Oe.start=Te.read_shift(4,"i"),Oe.size=Te.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=xe,Oe.name=""),Oe.type===5?(ee=Oe.start,F>0&&ee!==xe&&(U[ee].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",U[Oe.start]===void 0&&(U[Oe.start]=w(R,Oe.start,U.fat_addrs,U.ssz)),U[Oe.start].name=Oe.name,Oe.content=U[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:ee!==xe&&Oe.start!==xe&&U[ee]&&(Oe.content=x(Oe,U[ee].data,(U[ue]||{}).data))),Oe.content&&Ii(Oe.content,0),B[Ie]=Oe,se.push(Oe)}}function N(j,U){return new Date((Bi(j,U+4)/1e7*Math.pow(2,32)+Bi(j,U)/1e7-11644473600)*1e3)}function A(j,U){return m(),p(f.readFileSync(j),U)}function I(j,U){var R=U&&U.type;switch(R||_t&&Buffer.isBuffer(j)&&(R="buffer"),R||"base64"){case"file":return A(j,U);case"base64":return p(pa(hr(j)),U);case"binary":return p(pa(j),U)}return p(j,U)}function D(j,U){var R=U||{},M=R.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=M+"/",j.FileIndex[0]={name:M,type:5}),R.CLSID&&(j.FileIndex[0].clsid=R.CLSID),z(j)}function z(j){var U="Sh33tJ5";if(!Pt.find(j,"/"+U)){var R=me(4);R[0]=55,R[1]=R[3]=50,R[2]=54,j.FileIndex.push({name:U,type:2,content:R,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+U),L(j)}}function L(j,U){D(j);for(var R=!1,M=!1,F=j.FullPaths.length-1;F>=0;--F){var B=j.FileIndex[F];switch(B.type){case 0:M?R=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(B.R*B.L*B.C)&&(R=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!U)){var se=new Date(1987,1,19),ue=0,ee=Object.create?Object.create(null):{},le=[];for(F=0;F<j.FullPaths.length;++F)ee[j.FullPaths[F]]=!0,j.FileIndex[F].type!==0&&le.push([j.FullPaths[F],j.FileIndex[F]]);for(F=0;F<le.length;++F){var de=i(le[F][0]);M=ee[de],M||(le.push([de,{name:a(de).replace("/",""),type:1,clsid:ie,ct:se,mt:se,content:null}]),ee[de]=!0)}for(le.sort(function(Ie,Te){return t(Ie[0],Te[0])}),j.FullPaths=[],j.FileIndex=[],F=0;F<le.length;++F)j.FullPaths[F]=le[F][0],j.FileIndex[F]=le[F][1];for(F=0;F<le.length;++F){var Se=j.FileIndex[F],Ee=j.FullPaths[F];if(Se.name=a(Ee).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||ie,F===0)Se.C=le.length>1?1:-1,Se.size=0,Se.type=5;else if(Ee.slice(-1)=="/"){for(ue=F+1;ue<le.length&&i(j.FullPaths[ue])!=Ee;++ue);for(Se.C=ue>=le.length?-1:ue,ue=F+1;ue<le.length&&i(j.FullPaths[ue])!=i(Ee);++ue);Se.R=ue>=le.length?-1:ue,Se.type=1}else i(j.FullPaths[F+1]||"")==i(Ee)&&(Se.R=F+1),Se.type=2}}}function H(j,U){var R=U||{};if(R.fileType=="mad")return li(j,R);switch(L(j),R.fileType){case"zip":return qt(j,R)}var M=function(Ie){for(var Te=0,Oe=0,Ge=0;Ge<Ie.FileIndex.length;++Ge){var vt=Ie.FileIndex[Ge];if(vt.content){var yt=vt.content.length;yt>0&&(yt<4096?Te+=yt+63>>6:Oe+=yt+511>>9)}}for(var ht=Ie.FullPaths.length+3>>2,ci=Te+7>>3,Ei=Te+127>>7,ni=ci+Oe+ht+Ei,ui=ni+127>>7,Ua=ui<=109?0:Math.ceil((ui-109)/127);ni+ui+Ua+127>>7>ui;)Ua=++ui<=109?0:Math.ceil((ui-109)/127);var ii=[1,Ua,ui,Ei,ht,Oe,Te,0];return Ie.FileIndex[0].size=Te<<6,ii[7]=(Ie.FileIndex[0].start=ii[0]+ii[1]+ii[2]+ii[3]+ii[4]+ii[5])+(ii[6]+7>>3),ii}(j),F=me(M[7]<<9),B=0,se=0;{for(B=0;B<8;++B)F.write_shift(1,_e[B]);for(B=0;B<8;++B)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),B=0;B<3;++B)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,M[2]),F.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:xe),F.write_shift(4,M[3]),F.write_shift(-4,M[1]?M[0]-1:xe),F.write_shift(4,M[1]),B=0;B<109;++B)F.write_shift(-4,B<M[2]?M[1]+B:-1)}if(M[1])for(se=0;se<M[1];++se){for(;B<236+se*127;++B)F.write_shift(-4,B<M[2]?M[1]+B:-1);F.write_shift(-4,se===M[1]-1?xe:se+1)}var ue=function(Ie){for(se+=Ie;B<se-1;++B)F.write_shift(-4,B+1);Ie&&(++B,F.write_shift(-4,xe))};for(se=B=0,se+=M[1];B<se;++B)F.write_shift(-4,he.DIFSECT);for(se+=M[2];B<se;++B)F.write_shift(-4,he.FATSECT);ue(M[3]),ue(M[4]);for(var ee=0,le=0,de=j.FileIndex[0];ee<j.FileIndex.length;++ee)de=j.FileIndex[ee],de.content&&(le=de.content.length,!(le<4096)&&(de.start=se,ue(le+511>>9)));for(ue(M[6]+7>>3);F.l&511;)F.write_shift(-4,he.ENDOFCHAIN);for(se=B=0,ee=0;ee<j.FileIndex.length;++ee)de=j.FileIndex[ee],de.content&&(le=de.content.length,!(!le||le>=4096)&&(de.start=se,ue(le+63>>6)));for(;F.l&511;)F.write_shift(-4,he.ENDOFCHAIN);for(B=0;B<M[4]<<2;++B){var Se=j.FullPaths[B];if(!Se||Se.length===0){for(ee=0;ee<17;++ee)F.write_shift(4,0);for(ee=0;ee<3;++ee)F.write_shift(4,-1);for(ee=0;ee<12;++ee)F.write_shift(4,0);continue}de=j.FileIndex[B],B===0&&(de.start=de.size?de.start-1:xe);var Ee=B===0&&R.root||de.name;if(le=2*(Ee.length+1),F.write_shift(64,Ee,"utf16le"),F.write_shift(2,le),F.write_shift(1,de.type),F.write_shift(1,de.color),F.write_shift(-4,de.L),F.write_shift(-4,de.R),F.write_shift(-4,de.C),de.clsid)F.write_shift(16,de.clsid,"hex");else for(ee=0;ee<4;++ee)F.write_shift(4,0);F.write_shift(4,de.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,de.start),F.write_shift(4,de.size),F.write_shift(4,0)}for(B=1;B<j.FileIndex.length;++B)if(de=j.FileIndex[B],de.size>=4096)if(F.l=de.start+1<<9,_t&&Buffer.isBuffer(de.content))de.content.copy(F,F.l,0,de.size),F.l+=de.size+511&-512;else{for(ee=0;ee<de.size;++ee)F.write_shift(1,de.content[ee]);for(;ee&511;++ee)F.write_shift(1,0)}for(B=1;B<j.FileIndex.length;++B)if(de=j.FileIndex[B],de.size>0&&de.size<4096)if(_t&&Buffer.isBuffer(de.content))de.content.copy(F,F.l,0,de.size),F.l+=de.size+63&-64;else{for(ee=0;ee<de.size;++ee)F.write_shift(1,de.content[ee]);for(;ee&63;++ee)F.write_shift(1,0)}if(_t)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function K(j,U){var R=j.FullPaths.map(function(ee){return ee.toUpperCase()}),M=R.map(function(ee){var le=ee.split("/");return le[le.length-(ee.slice(-1)=="/"?2:1)]}),F=!1;U.charCodeAt(0)===47?(F=!0,U=R[0].slice(0,-1)+U):F=U.indexOf("/")!==-1;var B=U.toUpperCase(),se=F===!0?R.indexOf(B):M.indexOf(B);if(se!==-1)return j.FileIndex[se];var ue=!B.match(Td);for(B=B.replace(_c,""),ue&&(B=B.replace(Td,"!")),se=0;se<R.length;++se)if((ue?R[se].replace(Td,"!"):R[se]).replace(_c,"")==B||(ue?M[se].replace(Td,"!"):M[se]).replace(_c,"")==B)return j.FileIndex[se];return null}var ne=64,xe=-2,He="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:xe,FREESECT:-1,HEADER_SIGNATURE:He,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ne(j,U,R){m();var M=H(j,R);f.writeFileSync(U,M)}function Be(j){for(var U=new Array(j.length),R=0;R<j.length;++R)U[R]=String.fromCharCode(j[R]);return U.join("")}function X(j,U){var R=H(j,U);switch(U&&U.type||"buffer"){case"file":return m(),f.writeFileSync(U.filename,R),R;case"binary":return typeof R=="string"?R:Be(R);case"base64":return Pc(typeof R=="string"?R:Be(R));case"buffer":if(_t)return Buffer.isBuffer(R)?R:gr(R);case"array":return typeof R=="string"?pa(R):R}return R}var pe;function P(j){try{var U=j.InflateRaw,R=new U;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)pe=j;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function Y(j,U){if(!pe)return ut(j,U);var R=pe.InflateRaw,M=new R,F=M._processChunk(j.slice(j.l),M._finishFlushFlag);return j.l+=M.bytesRead,F}function V(j){return pe?pe.deflateRawSync(j):ke(j)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(j){var U=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(U>>16|U>>8|U)&255}for(var Le=typeof Uint8Array<"u",Ae=Le?new Uint8Array(256):[],ct=0;ct<256;++ct)Ae[ct]=Ce(ct);function Je(j,U){var R=Ae[j&255];return U<=8?R>>>8-U:(R=R<<8|Ae[j>>8&255],U<=16?R>>>16-U:(R=R<<8|Ae[j>>16&255],R>>>24-U))}function Ht(j,U){var R=U&7,M=U>>>3;return(j[M]|(R<=6?0:j[M+1]<<8))>>>R&3}function at(j,U){var R=U&7,M=U>>>3;return(j[M]|(R<=5?0:j[M+1]<<8))>>>R&7}function Gn(j,U){var R=U&7,M=U>>>3;return(j[M]|(R<=4?0:j[M+1]<<8))>>>R&15}function gt(j,U){var R=U&7,M=U>>>3;return(j[M]|(R<=3?0:j[M+1]<<8))>>>R&31}function Re(j,U){var R=U&7,M=U>>>3;return(j[M]|(R<=1?0:j[M+1]<<8))>>>R&127}function wn(j,U,R){var M=U&7,F=U>>>3,B=(1<<R)-1,se=j[F]>>>M;return R<8-M||(se|=j[F+1]<<8-M,R<16-M)||(se|=j[F+2]<<16-M,R<24-M)||(se|=j[F+3]<<24-M),se&B}function Rn(j,U,R){var M=U&7,F=U>>>3;return M<=5?j[F]|=(R&7)<<M:(j[F]|=R<<M&255,j[F+1]=(R&7)>>8-M),U+3}function ei(j,U,R){var M=U&7,F=U>>>3;return R=(R&1)<<M,j[F]|=R,U+1}function ti(j,U,R){var M=U&7,F=U>>>3;return R<<=M,j[F]|=R&255,R>>>=8,j[F+1]=R,U+8}function Qe(j,U,R){var M=U&7,F=U>>>3;return R<<=M,j[F]|=R&255,R>>>=8,j[F+1]=R&255,j[F+2]=R>>>8,U+16}function Fe(j,U){var R=j.length,M=2*R>U?2*R:U+5,F=0;if(R>=U)return j;if(_t){var B=sx(M);if(j.copy)j.copy(B);else for(;F<j.length;++F)B[F]=j[F];return B}else if(Le){var se=new Uint8Array(M);if(se.set)se.set(j);else for(;F<R;++F)se[F]=j[F];return se}return j.length=M,j}function Ye(j){for(var U=new Array(j),R=0;R<j;++R)U[R]=0;return U}function Ze(j,U,R){var M=1,F=0,B=0,se=0,ue=0,ee=j.length,le=Le?new Uint16Array(32):Ye(32);for(B=0;B<32;++B)le[B]=0;for(B=ee;B<R;++B)j[B]=0;ee=j.length;var de=Le?new Uint16Array(ee):Ye(ee);for(B=0;B<ee;++B)le[F=j[B]]++,M<F&&(M=F),de[B]=0;for(le[0]=0,B=1;B<=M;++B)le[B+16]=ue=ue+le[B-1]<<1;for(B=0;B<ee;++B)ue=j[B],ue!=0&&(de[B]=le[ue+16]++);var Se=0;for(B=0;B<ee;++B)if(Se=j[B],Se!=0)for(ue=Je(de[B],M)>>M-Se,se=(1<<M+4-Se)-1;se>=0;--se)U[ue|se<<Se]=Se&15|B<<4;return M}var Ot=Le?new Uint16Array(512):Ye(512),wt=Le?new Uint16Array(32):Ye(32);if(!Le){for(var Wt=0;Wt<512;++Wt)Ot[Wt]=0;for(Wt=0;Wt<32;++Wt)wt[Wt]=0}(function(){for(var j=[],U=0;U<32;U++)j.push(5);Ze(j,wt,32);var R=[];for(U=0;U<=143;U++)R.push(8);for(;U<=255;U++)R.push(9);for(;U<=279;U++)R.push(7);for(;U<=287;U++)R.push(8);Ze(R,Ot,288)})();var J=function(){for(var U=Le?new Uint8Array(32768):[],R=0,M=0;R<Me.length-1;++R)for(;M<Me[R+1];++M)U[M]=R;for(;M<32768;++M)U[M]=29;var F=Le?new Uint8Array(259):[];for(R=0,M=0;R<re.length-1;++R)for(;M<re[R+1];++M)F[M]=R;function B(ue,ee){for(var le=0;le<ue.length;){var de=Math.min(65535,ue.length-le),Se=le+de==ue.length;for(ee.write_shift(1,+Se),ee.write_shift(2,de),ee.write_shift(2,~de&65535);de-- >0;)ee[ee.l++]=ue[le++]}return ee.l}function se(ue,ee){for(var le=0,de=0,Se=Le?new Uint16Array(32768):[];de<ue.length;){var Ee=Math.min(65535,ue.length-de);if(Ee<10){for(le=Rn(ee,le,+(de+Ee==ue.length)),le&7&&(le+=8-(le&7)),ee.l=le/8|0,ee.write_shift(2,Ee),ee.write_shift(2,~Ee&65535);Ee-- >0;)ee[ee.l++]=ue[de++];le=ee.l*8;continue}le=Rn(ee,le,+(de+Ee==ue.length)+2);for(var Ie=0;Ee-- >0;){var Te=ue[de];Ie=(Ie<<5^Te)&32767;var Oe=-1,Ge=0;if((Oe=Se[Ie])&&(Oe|=de&-32768,Oe>de&&(Oe-=32768),Oe<de))for(;ue[Oe+Ge]==ue[de+Ge]&&Ge<250;)++Ge;if(Ge>2){Te=F[Ge],Te<=22?le=ti(ee,le,Ae[Te+1]>>1)-1:(ti(ee,le,3),le+=5,ti(ee,le,Ae[Te-23]>>5),le+=3);var vt=Te<8?0:Te-4>>2;vt>0&&(Qe(ee,le,Ge-re[Te]),le+=vt),Te=U[de-Oe],le=ti(ee,le,Ae[Te]>>3),le-=3;var yt=Te<4?0:Te-2>>1;yt>0&&(Qe(ee,le,de-Oe-Me[Te]),le+=yt);for(var ht=0;ht<Ge;++ht)Se[Ie]=de&32767,Ie=(Ie<<5^ue[de])&32767,++de;Ee-=Ge-1}else Te<=143?Te=Te+48:le=ei(ee,le,1),le=ti(ee,le,Ae[Te]),Se[Ie]=de&32767,++de}le=ti(ee,le,0)-1}return ee.l=(le+7)/8|0,ee.l}return function(ee,le){return ee.length<8?B(ee,le):se(ee,le)}}();function ke(j){var U=me(50+Math.floor(j.length*1.1)),R=J(j,U);return U.slice(0,R)}var $e=Le?new Uint16Array(32768):Ye(32768),Ve=Le?new Uint16Array(32768):Ye(32768),et=Le?new Uint16Array(128):Ye(128),dt=1,$t=1;function Yn(j,U){var R=gt(j,U)+257;U+=5;var M=gt(j,U)+1;U+=5;var F=Gn(j,U)+4;U+=4;for(var B=0,se=Le?new Uint8Array(19):Ye(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,le=Le?new Uint8Array(8):Ye(8),de=Le?new Uint8Array(8):Ye(8),Se=se.length,Ee=0;Ee<F;++Ee)se[q[Ee]]=B=at(j,U),ee<B&&(ee=B),le[B]++,U+=3;var Ie=0;for(le[0]=0,Ee=1;Ee<=ee;++Ee)de[Ee]=Ie=Ie+le[Ee-1]<<1;for(Ee=0;Ee<Se;++Ee)(Ie=se[Ee])!=0&&(ue[Ee]=de[Ie]++);var Te=0;for(Ee=0;Ee<Se;++Ee)if(Te=se[Ee],Te!=0){Ie=Ae[ue[Ee]]>>8-Te;for(var Oe=(1<<7-Te)-1;Oe>=0;--Oe)et[Ie|Oe<<Te]=Te&7|Ee<<3}var Ge=[];for(ee=1;Ge.length<R+M;)switch(Ie=et[Re(j,U)],U+=Ie&7,Ie>>>=3){case 16:for(B=3+Ht(j,U),U+=2,Ie=Ge[Ge.length-1];B-- >0;)Ge.push(Ie);break;case 17:for(B=3+at(j,U),U+=3;B-- >0;)Ge.push(0);break;case 18:for(B=11+Re(j,U),U+=7;B-- >0;)Ge.push(0);break;default:Ge.push(Ie),ee<Ie&&(ee=Ie);break}var vt=Ge.slice(0,R),yt=Ge.slice(R);for(Ee=R;Ee<286;++Ee)vt[Ee]=0;for(Ee=M;Ee<30;++Ee)yt[Ee]=0;return dt=Ze(vt,$e,286),$t=Ze(yt,Ve,30),U}function Ui(j,U){if(j[0]==3&&!(j[1]&3))return[zs(U),2];for(var R=0,M=0,F=sx(U||1<<18),B=0,se=F.length>>>0,ue=0,ee=0;(M&1)==0;){if(M=at(j,R),R+=3,M>>>1)M>>1==1?(ue=9,ee=5):(R=Yn(j,R),ue=dt,ee=$t);else{R&7&&(R+=8-(R&7));var le=j[R>>>3]|j[(R>>>3)+1]<<8;if(R+=32,le>0)for(!U&&se<B+le&&(F=Fe(F,B+le),se=F.length);le-- >0;)F[B++]=j[R>>>3],R+=8;continue}for(;;){!U&&se<B+32767&&(F=Fe(F,B+32767),se=F.length);var de=wn(j,R,ue),Se=M>>>1==1?Ot[de]:$e[de];if(R+=Se&15,Se>>>=4,(Se>>>8&255)===0)F[B++]=Se;else{if(Se==256)break;Se-=257;var Ee=Se<8?0:Se-4>>2;Ee>5&&(Ee=0);var Ie=B+re[Se];Ee>0&&(Ie+=wn(j,R,Ee),R+=Ee),de=wn(j,R,ee),Se=M>>>1==1?wt[de]:Ve[de],R+=Se&15,Se>>>=4;var Te=Se<4?0:Se-2>>1,Oe=Me[Se];for(Te>0&&(Oe+=wn(j,R,Te),R+=Te),!U&&se<Ie&&(F=Fe(F,Ie+100),se=F.length);B<Ie;)F[B]=F[B-Oe],++B}}}return U?[F,R+7>>>3]:[F.slice(0,B),R+7>>>3]}function ut(j,U){var R=j.slice(j.l||0),M=Ui(R,U);return j.l+=M[1],M[0]}function ra(j,U){if(j)typeof console<"u"&&console.error(U);else throw new Error(U)}function wi(j,U){var R=j;Ii(R,0);var M=[],F=[],B={FileIndex:M,FullPaths:F};D(B,{root:U.root});for(var se=R.length-4;(R[se]!=80||R[se+1]!=75||R[se+2]!=5||R[se+3]!=6)&&se>=0;)--se;R.l=se+4,R.l+=4;var ue=R.read_shift(2);R.l+=6;var ee=R.read_shift(4);for(R.l=ee,se=0;se<ue;++se){R.l+=20;var le=R.read_shift(4),de=R.read_shift(4),Se=R.read_shift(2),Ee=R.read_shift(2),Ie=R.read_shift(2);R.l+=8;var Te=R.read_shift(4),Oe=u(R.slice(R.l+Se,R.l+Se+Ee));R.l+=Se+Ee+Ie;var Ge=R.l;R.l=Te+4,xa(R,le,de,B,Oe),R.l=Ge}return B}function xa(j,U,R,M,F){j.l+=2;var B=j.read_shift(2),se=j.read_shift(2),ue=l(j);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var ee=j.read_shift(4),le=j.read_shift(4),de=j.read_shift(4),Se=j.read_shift(2),Ee=j.read_shift(2),Ie="",Te=0;Te<Se;++Te)Ie+=String.fromCharCode(j[j.l++]);if(Ee){var Oe=u(j.slice(j.l,j.l+Ee));(Oe[21589]||{}).mt&&(ue=Oe[21589].mt),((F||{})[21589]||{}).mt&&(ue=F[21589].mt)}j.l+=Ee;var Ge=j.slice(j.l,j.l+le);switch(se){case 8:Ge=Y(j,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var vt=!1;B&8&&(ee=j.read_shift(4),ee==134695760&&(ee=j.read_shift(4),vt=!0),le=j.read_shift(4),de=j.read_shift(4)),le!=U&&ra(vt,"Bad compressed size: "+U+" != "+le),de!=R&&ra(vt,"Bad uncompressed size: "+R+" != "+de),en(M,Ie,Ge,{unsafe:!0,mt:ue})}function qt(j,U){var R=U||{},M=[],F=[],B=me(1),se=R.compression?8:0,ue=0,ee=0,le=0,de=0,Se=0,Ee=j.FullPaths[0],Ie=Ee,Te=j.FileIndex[0],Oe=[],Ge=0;for(ee=1;ee<j.FullPaths.length;++ee)if(Ie=j.FullPaths[ee].slice(Ee.length),Te=j.FileIndex[ee],!(!Te.size||!Te.content||Ie=="Sh33tJ5")){var vt=de,yt=me(Ie.length);for(le=0;le<Ie.length;++le)yt.write_shift(1,Ie.charCodeAt(le)&127);yt=yt.slice(0,yt.l),Oe[Se]=o5.buf(Te.content,0);var ht=Te.content;se==8&&(ht=V(ht)),B=me(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,ue),B.write_shift(2,se),Te.mt?o(B,Te.mt):B.write_shift(4,0),B.write_shift(-4,Oe[Se]),B.write_shift(4,ht.length),B.write_shift(4,Te.content.length),B.write_shift(2,yt.length),B.write_shift(2,0),de+=B.length,M.push(B),de+=yt.length,M.push(yt),de+=ht.length,M.push(ht),B=me(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,ue),B.write_shift(2,se),B.write_shift(4,0),B.write_shift(-4,Oe[Se]),B.write_shift(4,ht.length),B.write_shift(4,Te.content.length),B.write_shift(2,yt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,vt),Ge+=B.l,F.push(B),Ge+=yt.length,F.push(yt),++Se}return B=me(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,Se),B.write_shift(2,Se),B.write_shift(4,Ge),B.write_shift(4,de),B.write_shift(2,0),zn([zn(M),zn(F),B])}var zi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vr(j,U){if(j.ctype)return j.ctype;var R=j.name||"",M=R.match(/\.([^\.]+)$/);return M&&zi[M[1]]||U&&(M=(R=U).match(/[\.\\]([^\.\\])+$/),M&&zi[M[1]])?zi[M[1]]:"application/octet-stream"}function qs(j){for(var U=Pc(j),R=[],M=0;M<U.length;M+=76)R.push(U.slice(M,M+76));return R.join(`\r
`)+`\r
`}function rs(j){var U=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var de=le.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],M=U.split(`\r
`),F=0;F<M.length;++F){var B=M[F];if(B.length==0){R.push("");continue}for(var se=0;se<B.length;){var ue=76,ee=B.slice(se,se+ue);ee.charAt(ue-1)=="="?ue--:ee.charAt(ue-2)=="="?ue-=2:ee.charAt(ue-3)=="="&&(ue-=3),ee=B.slice(se,se+ue),se+=ue,se<B.length&&(ee+="="),R.push(ee)}}return R.join(`\r
`)}function ss(j){for(var U=[],R=0;R<j.length;++R){for(var M=j[R];R<=j.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+j[++R];U.push(M)}for(var F=0;F<U.length;++F)U[F]=U[F].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return pa(U.join(`\r
`))}function Ks(j,U,R){for(var M="",F="",B="",se,ue=0;ue<10;++ue){var ee=U[ue];if(!ee||ee.match(/^\s*$/))break;var le=ee.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":M=le[2].trim();break;case"content-type":B=le[2].trim();break;case"content-transfer-encoding":F=le[2].trim();break}}switch(++ue,F.toLowerCase()){case"base64":se=pa(hr(U.slice(ue).join("")));break;case"quoted-printable":se=ss(U.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var de=en(j,M.slice(R.length),se,{unsafe:!0});B&&(de.ctype=B)}function yn(j,U){if(Be(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=U&&U.root||"",M=(_t&&Buffer.isBuffer(j)?j.toString("binary"):Be(j)).split(`\r
`),F=0,B="";for(F=0;F<M.length;++F)if(B=M[F],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),R||(R=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),B.slice(0,R.length)!=R););var se=(M[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ue="--"+(se[1]||""),ee=[],le=[],de={FileIndex:ee,FullPaths:le};D(de);var Se,Ee=0;for(F=0;F<M.length;++F){var Ie=M[F];Ie!==ue&&Ie!==ue+"--"||(Ee++&&Ks(de,M.slice(Se,F),R),Se=F)}return de}function li(j,U){var R=U||{},M=R.boundary||"SheetJS";M="------="+M;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],B=j.FullPaths[0],se=B,ue=j.FileIndex[0],ee=1;ee<j.FullPaths.length;++ee)if(se=j.FullPaths[ee].slice(B.length),ue=j.FileIndex[ee],!(!ue.size||!ue.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var le=ue.content,de=_t&&Buffer.isBuffer(le)?le.toString("binary"):Be(le),Se=0,Ee=Math.min(1024,de.length),Ie=0,Te=0;Te<=Ee;++Te)(Ie=de.charCodeAt(Te))>=32&&Ie<128&&++Se;var Oe=Se>=Ee*4/5;F.push(M),F.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+se),F.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),F.push("Content-Type: "+vr(ue,se)),F.push(""),F.push(Oe?rs(de):qs(de))}return F.push(M+`--\r
`),F.join(`\r
`)}function Jt(j){var U={};return D(U,j),U}function en(j,U,R,M){var F=M&&M.unsafe;F||D(j);var B=!F&&Pt.find(j,U);if(!B){var se=j.FullPaths[0];U.slice(0,se.length)==se?se=U:(se.slice(-1)!="/"&&(se+="/"),se=(se+U).replace("//","/")),B={name:a(U),type:2},j.FileIndex.push(B),j.FullPaths.push(se),F||Pt.utils.cfb_gc(j)}return B.content=R,B.size=R?R.length:0,M&&(M.CLSID&&(B.clsid=M.CLSID),M.mt&&(B.mt=M.mt),M.ct&&(B.ct=M.ct)),B}function ba(j,U){D(j);var R=Pt.find(j,U);if(R){for(var M=0;M<j.FileIndex.length;++M)if(j.FileIndex[M]==R)return j.FileIndex.splice(M,1),j.FullPaths.splice(M,1),!0}return!1}function os(j,U,R){D(j);var M=Pt.find(j,U);if(M){for(var F=0;F<j.FileIndex.length;++F)if(j.FileIndex[F]==M)return j.FileIndex[F].name=a(R),j.FullPaths[F]=R,!0}return!1}function rl(j){L(j,!0)}return e.find=K,e.read=I,e.parse=p,e.write=X,e.writeFile=Ne,e.utils={cfb_new:Jt,cfb_add:en,cfb_del:ba,cfb_mov:os,cfb_gc:rl,ReadShift:wc,CheckField:OS,prep_blob:Ii,bconcat:zn,use_zlib:P,_deflateRaw:ke,_inflateRaw:ut,consts:he},e}();function l5(n){return typeof n=="string"?ff(n):Array.isArray(n)?M6(n):n}function qc(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=ff(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var i=t=="utf8"?Fc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var a=new Blob([l5(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,n);if(typeof saveAs<"u")return saveAs(a,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:n,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=n,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=$c(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+n)}function Vn(n){for(var e=Object.keys(n),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(n,e[i])&&t.push(e[i]);return t}function mx(n,e){for(var t=[],i=Vn(n),a=0;a!==i.length;++a)t[n[i[a]][e]]==null&&(t[n[i[a]][e]]=i[a]);return t}function Pp(n){for(var e=[],t=Vn(n),i=0;i!==t.length;++i)e[n[t[i]]]=t[i];return e}function pf(n){for(var e=[],t=Vn(n),i=0;i!==t.length;++i)e[n[t[i]]]=parseInt(t[i],10);return e}function c5(n){for(var e=[],t=Vn(n),i=0;i!==t.length;++i)e[n[t[i]]]==null&&(e[n[t[i]]]=[]),e[n[t[i]]].push(t[i]);return e}var $d=new Date(1899,11,30,0,0,0);function _i(n,e){var t=n.getTime(),i=$d.getTime()+(n.getTimezoneOffset()-$d.getTimezoneOffset())*6e4;return(t-i)/(24*60*60*1e3)}var pS=new Date,u5=$d.getTime()+(pS.getTimezoneOffset()-$d.getTimezoneOffset())*6e4,px=pS.getTimezoneOffset();function gS(n){var e=new Date;return e.setTime(n*24*60*60*1e3+u5),e.getTimezoneOffset()!==px&&e.setTime(e.getTime()+(e.getTimezoneOffset()-px)*6e4),e}var gx=new Date("2017-02-19T19:06:09.000Z"),vS=isNaN(gx.getFullYear())?new Date("2/19/17"):gx,d5=vS.getFullYear()==2017;function oi(n,e){var t=new Date(n);if(d5)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(vS.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return n.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var a=n.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return n.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function gf(n,e){if(_t&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var i=[],a=0;a!=n.length;++a)i.push(String.fromCharCode(n[a]));return i.join("")}function Ti(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ti(n[t]));return e}function an(n,e){for(var t="";t.length<e;)t+=n;return t}function ur(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(e=Number(i)))?e/t:e}var f5=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bc(n){var e=new Date(n),t=new Date(NaN),i=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return t;var l=n.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&f5.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return i<0||i>8099?t:(a>0||o>1)&&i!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function nt(n,e,t){if(n.FullPaths){if(typeof t=="string"){var i;return _t?i=gr(t):i=L6(t),Pt.utils.cfb_add(n,e,i)}Pt.utils.cfb_add(n,e,t)}else n.file(e,t)}function Bp(){return Pt.utils.cfb_new()}var vn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,h5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Fp=Pp(h5),Up=/[&<>'"]/g,m5=/[\u0000-\u0008\u000b-\u001f]/g;function Dt(n){var e=n+"";return e.replace(Up,function(t){return Fp[t]}).replace(m5,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function vx(n){return Dt(n).replace(/ /g,"_x0020_")}var yS=/[\u0000-\u001f]/g;function p5(n){var e=n+"";return e.replace(Up,function(t){return Fp[t]}).replace(/\n/g,"<br/>").replace(yS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function g5(n){var e=n+"";return e.replace(Up,function(t){return Fp[t]}).replace(yS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function v5(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function y5(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bm(n){for(var e="",t=0,i=0,a=0,o=0,l=0,u=0;t<n.length;){if(i=n.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(a=n.charCodeAt(t++),i>191&&i<224){l=(i&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(o=n.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63);continue}l=n.charCodeAt(t++),u=((i&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function yx(n){var e=zs(2*n.length),t,i,a=1,o=0,l=0,u;for(i=0;i<n.length;i+=a)a=1,(u=n.charCodeAt(i))<128?t=u:u<224?(t=(u&31)*64+(n.charCodeAt(i+1)&63),a=2):u<240?(t=(u&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),a=3):(a=4,t=(u&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=t%256,e[o++]=t>>>8;return e.slice(0,o).toString("ucs2")}function xx(n){return gr(n,"binary").toString("utf8")}var Ed="foo bar baz",Tc=_t&&(xx(Ed)==Bm(Ed)&&xx||yx(Ed)==Bm(Ed)&&yx)||Bm,Fc=_t?function(n){return gr(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,i=0,a=0;t<n.length;)switch(i=n.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,a=n.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},x5=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<n.length;++a)i=i.replace(n[a][0],n[a][1]);return i}}(),xS=/(^\s|\s$|\n)/;function Hn(n,e){return"<"+n+(e.match(xS)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Uc(n){return Vn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function je(n,e,t){return"<"+n+(t!=null?Uc(t):"")+(e!=null?(e.match(xS)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function ap(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function b5(n,e){switch(typeof n){case"string":var t=je("vt:lpwstr",Dt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return je((n|0)==n?"vt:i4":"vt:r8",Dt(String(n)));case"boolean":return je("vt:bool",n?"true":"false")}if(n instanceof Date)return je("vt:filetime",ap(n));throw new Error("Unable to serialize "+n)}var Dn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},tl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function S5(n,e){for(var t=1-2*(n[e+7]>>>7),i=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),a=n[e+6]&15,o=5;o>=0;--o)a=a*256+n[e+o];return i==2047?a==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,a+=Math.pow(2,52)),t*Math.pow(2,i-52)*a)}function _5(n,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,l=i?-e:e;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)n[t+u]=o&255;n[t+6]=(a&15)<<4|o&15,n[t+7]=a>>4|i}var bx=function(n){for(var e=[],t=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var a=0,o=n[0][i].length;a<o;a+=t)e.push.apply(e,n[0][i].slice(a,a+t));return e},Sx=_t?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:gr(e)})):bx(n)}:bx,_x=function(n,e,t){for(var i=[],a=e;a<t;a+=2)i.push(String.fromCharCode(vc(n,a)));return i.join("").replace(_c,"")},zp=_t?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(_c,""):_x(n,e,t)}:_x,Tx=function(n,e,t){for(var i=[],a=e;a<e+t;++a)i.push(("0"+n[a].toString(16)).slice(-2));return i.join("")},bS=_t?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):Tx(n,e,t)}:Tx,wx=function(n,e,t){for(var i=[],a=e;a<t;a++)i.push(String.fromCharCode(Fo(n,a)));return i.join("")},Kc=_t?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):wx(e,t,i)}:wx,SS=function(n,e){var t=Bi(n,e);return t>0?Kc(n,e+4,e+4+t-1):""},_S=SS,TS=function(n,e){var t=Bi(n,e);return t>0?Kc(n,e+4,e+4+t-1):""},wS=TS,ES=function(n,e){var t=2*Bi(n,e);return t>0?Kc(n,e+4,e+4+t-1):""},AS=ES,kS=function(e,t){var i=Bi(e,t);return i>0?zp(e,t+4,t+4+i):""},CS=kS,jS=function(n,e){var t=Bi(n,e);return t>0?Kc(n,e+4,e+4+t):""},DS=jS,NS=function(n,e){return S5(n,e)},qd=NS,Hp=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};_t&&(_S=function(e,t){if(!Buffer.isBuffer(e))return SS(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},wS=function(e,t){if(!Buffer.isBuffer(e))return TS(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},AS=function(e,t){if(!Buffer.isBuffer(e))return ES(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},CS=function(e,t){if(!Buffer.isBuffer(e))return kS(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},DS=function(e,t){if(!Buffer.isBuffer(e))return jS(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},qd=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):NS(e,t)},Hp=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Fo=function(n,e){return n[e]},vc=function(n,e){return n[e+1]*256+n[e]},T5=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Bi=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Ms=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},w5=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function wc(n,e){var t="",i,a,o=[],l,u,f,m;switch(e){case"dbcs":if(m=this.l,_t&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(f=0;f<n;++f)t+=String.fromCharCode(vc(this,m)),m+=2;n*=2;break;case"utf8":t=Kc(this,this.l,this.l+n);break;case"utf16le":n*=2,t=zp(this,this.l,this.l+n);break;case"wstr":return wc.call(this,n,"dbcs");case"lpstr-ansi":t=_S(this,this.l),n=4+Bi(this,this.l);break;case"lpstr-cp":t=wS(this,this.l),n=4+Bi(this,this.l);break;case"lpwstr":t=AS(this,this.l),n=4+2*Bi(this,this.l);break;case"lpp4":n=4+Bi(this,this.l),t=CS(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Bi(this,this.l),t=DS(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(l=Fo(this,this.l+n++))!==0;)o.push(_d(l));t=o.join("");break;case"_wstr":for(n=0,t="";(l=vc(this,this.l+n))!==0;)o.push(_d(l)),n+=2;n+=2,t=o.join("");break;case"dbcs-cont":for(t="",m=this.l,f=0;f<n;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Fo(this,m),this.l=m+1,u=wc.call(this,n-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(_d(vc(this,m))),m+=2}t=o.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,f=0;f!=n;++f){if(this.lens&&this.lens.indexOf(m)!==-1)return l=Fo(this,m),this.l=m+1,u=wc.call(this,n-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(_d(Fo(this,m))),m+=1}t=o.join("");break;default:switch(n){case 1:return i=Fo(this,this.l),this.l++,i;case 2:return i=(e==="i"?T5:vc)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(i=(n>0?Ms:w5)(this,this.l),this.l+=4,i):(a=Bi(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return n==8?a=qd(this,this.l):a=qd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;n=8;case 16:t=bS(this,this.l,n);break}}return this.l+=n,t}var E5=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},A5=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},k5=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function C5(n,e,t){var i=0,a=0;if(t==="dbcs"){for(a=0;a!=e.length;++a)k5(this,e.charCodeAt(a),this.l+2*a);i=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;i=e.length}else if(t==="hex"){for(;a<n;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+n,this.length);for(a=0;a<Math.min(e.length,n);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,E5(this,e,this.l);break;case 8:if(i=8,t==="f"){_5(this,e,this.l);break}case 16:break;case-4:i=4,A5(this,e,this.l);break}return this.l+=i,this}function OS(n,e){var t=bS(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Ii(n,e){n.l=e,n.read_shift=wc,n.chk=OS,n.write_shift=C5}function Pa(n,e){n.l+=e}function me(n){var e=zs(n);return Ii(e,0),e}function bi(){var n=[],e=_t?256:2048,t=function(m){var p=me(m);return Ii(p,0),p},i=t(e),a=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i),i=null)},o=function(m){return i&&m<i.length-i.l?i:(a(),i=t(Math.max(m+1,e)))},l=function(){return a(),zn(n)},u=function(m){a(),i=m,i.l==null&&(i.l=i.length),o(e)};return{next:o,push:u,end:l,_bufs:n}}function be(n,e,t,i){var a=+e,o;if(!isNaN(a)){i||(i=SR[a].p||(t||[]).length||0),o=1+(a>=128?1:0)+1,i>=128&&++o,i>=16384&&++o,i>=2097152&&++o;var l=n.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(i>=128)l.write_shift(1,(i&127)+128),i>>=7;else{l.write_shift(1,i);break}i>0&&Hp(t)&&n.push(t)}}function Ec(n,e,t){var i=Ti(n);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Ex(n,e,t){var i=Ti(n);return i.s=Ec(i.s,e.s,t),i.e=Ec(i.e,e.s,t),i}function Ac(n,e){if(n.cRel&&n.c<0)for(n=Ti(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=Ti(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Nt(n);return!n.cRel&&n.cRel!=null&&(t=N5(t)),!n.rRel&&n.rRel!=null&&(t=j5(t)),t}function Fm(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Zn(n.s.c)+":"+(n.e.cRel?"":"$")+Zn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Wn(n.s.r)+":"+(n.e.rRel?"":"$")+Wn(n.e.r):Ac(n.s,e.biff)+":"+Ac(n.e,e.biff)}function Wp(n){return parseInt(D5(n),10)-1}function Wn(n){return""+(n+1)}function j5(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function D5(n){return n.replace(/\$(\d+)$/,"$1")}function Vp(n){for(var e=O5(n),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function Zn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function N5(n){return n.replace(/^([A-Z])/,"$$$1")}function O5(n){return n.replace(/^\$([A-Z])/,"$1")}function R5(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nn(n){for(var e=0,t=0,i=0;i<n.length;++i){var a=n.charCodeAt(i);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:e-1}}function Nt(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Fi(n){var e=n.indexOf(":");return e==-1?{s:Nn(n),e:Nn(n)}:{s:Nn(n.slice(0,e)),e:Nn(n.slice(e+1))}}function gn(n,e){return typeof e>"u"||typeof e=="number"?gn(n.s,n.e):(typeof n!="string"&&(n=Nt(n)),typeof e!="string"&&(e=Nt(e)),n==e?n:n+":"+e)}function Vt(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,a=0,o=n.length;for(t=0;i<o&&!((a=n.charCodeAt(i)-64)<1||a>26);++i)t=26*t+a;for(e.s.c=--t,t=0;i<o&&!((a=n.charCodeAt(i)-48)<0||a>9);++i)t=10*t+a;if(e.s.r=--t,i===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=o&&!((a=n.charCodeAt(i)-64)<1||a>26);++i)t=26*t+a;for(e.e.c=--t,t=0;i!=o&&!((a=n.charCodeAt(i)-48)<0||a>9);++i)t=10*t+a;return e.e.r=--t,e}function Ax(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=es(n.z,t?_i(e):e)}catch{}try{return n.w=es((n.XF||{}).numFmtId||(t?14:0),t?_i(e):e)}catch{return""+e}}function mr(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?Zc[n.v]||n.v:e==null?Ax(n,n.v):Ax(n,e))}function Vs(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=n,{SheetNames:[t],Sheets:i}}function RS(n,e,t){var i=t||{},a=n?Array.isArray(n):i.dense,o=n||(a?[]:{}),l=0,u=0;if(o&&i.origin!=null){if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Nn(i.origin):i.origin;l=f.r,u=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Vt(o["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(m.e.r=l=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[v].length;++y)if(!(typeof e[v][y]>"u")){var S={v:e[v][y]},_=l+v,x=u+y;if(m.s.r>_&&(m.s.r=_),m.s.c>x&&(m.s.c=x),m.e.r<_&&(m.e.r=_),m.e.c<x&&(m.e.c=x),e[v][y]&&typeof e[v][y]=="object"&&!Array.isArray(e[v][y])&&!(e[v][y]instanceof Date))S=e[v][y];else if(Array.isArray(S.v)&&(S.f=e[v][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(i.nullError)S.t="e",S.v=0;else if(i.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=i.dateNF||sn[14],i.cellDates?(S.t="d",S.w=es(S.z,_i(S.v))):(S.t="n",S.v=_i(S.v),S.w=es(S.z,S.v))):S.t="s";if(a)o[_]||(o[_]=[]),o[_][x]&&o[_][x].z&&(S.z=o[_][x].z),o[_][x]=S;else{var T=Nt({c:x,r:_});o[T]&&o[T].z&&(S.z=o[T].z),o[T]=S}}}return m.s.c<1e7&&(o["!ref"]=gn(m)),o}function nl(n,e){return RS(null,n,e)}function M5(n){return n.read_shift(4,"i")}function va(n,e){return e||(e=me(4)),e.write_shift(4,n),e}function Qn(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function On(n,e){var t=!1;return e==null&&(t=!0,e=me(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function L5(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function I5(n,e){return e||(e=me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Gp(n,e){var t=n.l,i=n.read_shift(1),a=Qn(n),o=[],l={t:a,h:a};if((i&1)!==0){for(var u=n.read_shift(4),f=0;f!=u;++f)o.push(L5(n));l.r=o}else l.r=[{ich:0,ifnt:0}];return n.l=t+e,l}function P5(n,e){var t=!1;return e==null&&(t=!0,e=me(15+4*n.t.length)),e.write_shift(1,0),On(n.t,e),t?e.slice(0,e.l):e}var B5=Gp;function F5(n,e){var t=!1;return e==null&&(t=!0,e=me(23+4*n.t.length)),e.write_shift(1,1),On(n.t,e),e.write_shift(4,1),I5({},e),t?e.slice(0,e.l):e}function aa(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Gs(n,e){return e==null&&(e=me(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function Ys(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Xs(n,e){return e==null&&(e=me(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var U5=Qn,MS=On;function Yp(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function Kd(n,e){var t=!1;return e==null&&(t=!0,e=me(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var z5=Qn,rp=Yp,Xp=Kd;function LS(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,i=e[0]&2;n.l+=4;var a=i===0?qd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ms(e,0)>>2;return t?a/100:a}function IS(n,e){e==null&&(e=me(4));var t=0,i=0,a=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(i=1,t=1),i)e.write_shift(-4,((t?a:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function PS(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function H5(n,e){return e||(e=me(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var $s=PS,il=H5;function al(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Hs(n,e){return(e||me(8)).write_shift(8,n,"f")}function W5(n){var e={},t=n.read_shift(1),i=t>>>1,a=n.read_shift(1),o=n.read_shift(2,"i"),l=n.read_shift(1),u=n.read_shift(1),f=n.read_shift(1);switch(n.l++,i){case 0:e.auto=1;break;case 1:e.index=a;var m=Q5[a];m&&(e.rgb=Px(m));break;case 2:e.rgb=Px([l,u,f]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function Zd(n,e){if(e||(e=me(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function V5(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function G5(n,e){e||(e=me(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var BS=2,Li=3,Ad=11,Qd=19,kd=64,Y5=65,X5=71,$5=4108,q5=4126,Un=80,kx={1:{n:"CodePage",t:BS},2:{n:"Category",t:Un},3:{n:"PresentationFormat",t:Un},4:{n:"ByteCount",t:Li},5:{n:"LineCount",t:Li},6:{n:"ParagraphCount",t:Li},7:{n:"SlideCount",t:Li},8:{n:"NoteCount",t:Li},9:{n:"HiddenCount",t:Li},10:{n:"MultimediaClipCount",t:Li},11:{n:"ScaleCrop",t:Ad},12:{n:"HeadingPairs",t:$5},13:{n:"TitlesOfParts",t:q5},14:{n:"Manager",t:Un},15:{n:"Company",t:Un},16:{n:"LinksUpToDate",t:Ad},17:{n:"CharacterCount",t:Li},19:{n:"SharedDoc",t:Ad},22:{n:"HyperlinksChanged",t:Ad},23:{n:"AppVersion",t:Li,p:"version"},24:{n:"DigSig",t:Y5},26:{n:"ContentType",t:Un},27:{n:"ContentStatus",t:Un},28:{n:"Language",t:Un},29:{n:"Version",t:Un},255:{},2147483648:{n:"Locale",t:Qd},2147483651:{n:"Behavior",t:Qd},1919054434:{}},Cx={1:{n:"CodePage",t:BS},2:{n:"Title",t:Un},3:{n:"Subject",t:Un},4:{n:"Author",t:Un},5:{n:"Keywords",t:Un},6:{n:"Comments",t:Un},7:{n:"Template",t:Un},8:{n:"LastAuthor",t:Un},9:{n:"RevNumber",t:Un},10:{n:"EditTime",t:kd},11:{n:"LastPrinted",t:kd},12:{n:"CreatedDate",t:kd},13:{n:"ModifiedDate",t:kd},14:{n:"PageCount",t:Li},15:{n:"WordCount",t:Li},16:{n:"CharCount",t:Li},17:{n:"Thumbnail",t:X5},18:{n:"Application",t:Un},19:{n:"DocSecurity",t:Li},255:{},2147483648:{n:"Locale",t:Qd},2147483651:{n:"Behavior",t:Qd},1919054434:{}};function K5(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Z5=K5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Q5=Ti(Z5),Zc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},J5={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Cd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function FS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function US(n,e){var t=c5(J5),i=[],a;i[i.length]=vn,i[i.length]=je("Types",null,{xmlns:Dn.CT,"xmlns:xsd":Dn.xsd,"xmlns:xsi":Dn.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return je("Default",null,{Extension:f[0],ContentType:f[1]})}));var o=function(f){n[f]&&n[f].length>0&&(a=n[f][0],i[i.length]=je("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Cd[f][e.bookType]||Cd[f].xlsx}))},l=function(f){(n[f]||[]).forEach(function(m){i[i.length]=je("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:Cd[f][e.bookType]||Cd[f].xlsx})})},u=function(f){(n[f]||[]).forEach(function(m){i[i.length]=je("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[f][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zS(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function Vo(n){var e=[vn,je("Relationships",null,{xmlns:Dn.RELS})];return Vn(n["!id"]).forEach(function(t){e[e.length]=je("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ct(n,e,t,i,a,o){if(a||(a={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,a.Id="rId"+e,a.Type=i,a.Target=t,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),n["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][a.Id]=a,n[("/"+a.Target).replace("//","/")]=a,e}function eC(n){var e=[vn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function jx(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function tC(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function nC(n){var e=[vn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(jx(n[t][0],n[t][1])),e.push(tC("",n[t][0]));return e.push(jx("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function HS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wd.version+"</meta:generator></office:meta></office:document-meta>"}var Bs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Um(n,e,t,i,a){a[n]!=null||e==null||e===""||(a[n]=e,e=Dt(e),i[i.length]=t?je(n,e,t):Hn(n,e))}function WS(n,e){var t=e||{},i=[vn,je("cp:coreProperties",null,{"xmlns:cp":Dn.CORE_PROPS,"xmlns:dc":Dn.dc,"xmlns:dcterms":Dn.dcterms,"xmlns:dcmitype":Dn.dcmitype,"xmlns:xsi":Dn.xsi})],a={};if(!n&&!t.Props)return i.join("");n&&(n.CreatedDate!=null&&Um("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:ap(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,a),n.ModifiedDate!=null&&Um("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:ap(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,a));for(var o=0;o!=Bs.length;++o){var l=Bs[o],u=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:n?n[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Um(l[0],u,null,i,a)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Go=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],VS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function GS(n){var e=[],t=je;return n||(n={}),n.Application="SheetJS",e[e.length]=vn,e[e.length]=je("Properties",null,{xmlns:Dn.EXT_PROPS,"xmlns:vt":Dn.vt}),Go.forEach(function(i){if(n[i[1]]!==void 0){var a;switch(i[2]){case"string":a=Dt(String(n[i[1]]));break;case"bool":a=n[i[1]]?"true":"false";break}a!==void 0&&(e[e.length]=t(i[0],a))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+Dt(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function YS(n){var e=[vn,je("Properties",null,{xmlns:Dn.CUST_PROPS,"xmlns:vt":Dn.vt})];if(!n)return e.join("");var t=1;return Vn(n).forEach(function(a){++t,e[e.length]=je("property",b5(n[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Dt(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Dx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function iC(n,e){var t=[];return Vn(Dx).map(function(i){for(var a=0;a<Bs.length;++a)if(Bs[a][1]==i)return Bs[a];for(a=0;a<Go.length;++a)if(Go[a][1]==i)return Go[a];throw i}).forEach(function(i){if(n[i[1]]!=null){var a=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:n[i[1]];switch(i[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(Hn(Dx[i[1]]||i[1],a))}}),je("DocumentProperties",t.join(""),{xmlns:Pi.o})}function aC(n,e){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",a=[];return n&&Vn(n).forEach(function(o){if(Object.prototype.hasOwnProperty.call(n,o)){for(var l=0;l<Bs.length;++l)if(o==Bs[l][1])return;for(l=0;l<Go.length;++l)if(o==Go[l][1])return;for(l=0;l<t.length;++l)if(o==t[l])return;var u=n[o],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(je(vx(o),u,{"dt:dt":f}))}}),e&&Vn(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(n&&Object.prototype.hasOwnProperty.call(n,o))){var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(je(vx(o),l,{"dt:dt":u}))}}),"<"+i+' xmlns="'+Pi.o+'">'+a.join("")+"</"+i+">"}function rC(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,i=t%Math.pow(2,32),a=(t-i)/Math.pow(2,32);i*=1e7,a*=1e7;var o=i/Math.pow(2,32)|0;o>0&&(i=i%Math.pow(2,32),a+=o);var l=me(8);return l.write_shift(4,i),l.write_shift(4,a),l}function Nx(n,e){var t=me(4),i=me(4);switch(t.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,e);break;case 5:i=me(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=rC(e);break;case 31:case 80:for(i=me(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return zn([t,i])}var XS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function sC(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function Ox(n,e,t){var i=me(8),a=[],o=[],l=8,u=0,f=me(8),m=me(8);if(f.write_shift(4,2),f.write_shift(4,1200),m.write_shift(4,1),o.push(f),a.push(m),l+=8+f.length,!e){m=me(8),m.write_shift(4,0),a.unshift(m);var p=[me(4)];for(p[0].write_shift(4,n.length),u=0;u<n.length;++u){var v=n[u][0];for(f=me(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);p.push(f)}f=zn(p),o.unshift(f),l+=8+f.length}for(u=0;u<n.length;++u)if(!(e&&!e[n[u][0]])&&!(XS.indexOf(n[u][0])>-1||VS.indexOf(n[u][0])>-1)&&n[u][1]!=null){var y=n[u][1],S=0;if(e){S=+e[n[u][0]];var _=t[S];if(_.p=="version"&&typeof y=="string"){var x=y.split(".");y=(+x[0]<<16)+(+x[1]||0)}f=Nx(_.t,y)}else{var T=sC(y);T==-1&&(T=31,y=String(y)),f=Nx(T,y)}o.push(f),m=me(8),m.write_shift(4,e?S:2+u),a.push(m),l+=8+f.length}var w=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,w),w+=o[u].length;return i.write_shift(4,l),i.write_shift(4,o.length),zn([i].concat(a).concat(o))}function Rx(n,e,t,i,a,o){var l=me(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Pt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var f=Ox(n,t,i);if(u.push(f),a){var m=Ox(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+f.length),u.push(m)}return zn(u)}function oC(n,e){e||(e=me(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function lC(n,e){return n.read_shift(e)===1}function si(n,e){return e||(e=me(2)),e.write_shift(2,+!!n),e}function $S(n){return n.read_shift(2,"u")}function ea(n,e){return e||(e=me(2)),e.write_shift(2,n),e}function qS(n,e,t){return t||(t=me(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function KS(n,e,t){var i=n.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=n.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=i?n.read_shift(i,a):"";return l}function cC(n){var e=n.t||"",t=me(3);t.write_shift(2,e.length),t.write_shift(1,1);var i=me(2*e.length);i.write_shift(2*e.length,e,"utf16le");var a=[t,i];return zn(a)}function uC(n,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var a=n.read_shift(1);return a===0?i=n.read_shift(e,"sbcs-cont"):i=n.read_shift(e,"dbcs-cont"),i}function dC(n,e,t){var i=n.read_shift(t&&t.biff==2?1:2);return i===0?(n.l++,""):uC(n,i,t)}function fC(n,e,t){if(t.biff>5)return dC(n,e,t);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function ZS(n,e,t){return t||(t=me(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function Mx(n,e){e||(e=me(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function hC(n){var e=me(512),t=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var a=i.indexOf("#"),o=a>-1?31:23;switch(i.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)e.write_shift(4,l[t]);if(o==28)i=i.slice(1),Mx(i,e);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));var u=a>-1?i.slice(0,a):i;for(e.write_shift(4,2*(u.length+1)),t=0;t<u.length;++t)e.write_shift(2,u.charCodeAt(t));e.write_shift(2,0),o&8&&Mx(a>-1?i.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));for(var f=0;i.slice(f*3,f*3+3)=="../"||i.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,i.length-3*f+1),t=0;t<i.length-3*f;++t)e.write_shift(1,i.charCodeAt(t+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Ws(n,e,t,i){return i||(i=me(6)),i.write_shift(2,n),i.write_shift(2,e),i.write_shift(2,t||0),i}function mC(n,e,t){var i=t.biff>8?4:2,a=n.read_shift(i),o=n.read_shift(i,"i"),l=n.read_shift(i,"i");return[a,o,l]}function pC(n){var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(2),a=n.read_shift(2);return{s:{c:i,r:e},e:{c:a,r:t}}}function QS(n,e){return e||(e=me(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function $p(n,e,t){var i=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,a=8;break;case"biff4":i=4,a=6;break;case"biff3":i=3,a=6;break;case"biff2":i=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=me(a);return o.write_shift(2,i),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function gC(n,e){var t=!e||e.biff==8,i=me(t?112:54);for(i.write_shift(e.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function vC(n,e){var t=!e||e.biff>=8?2:1,i=me(8+t*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var a=i.slice(0,i.l);return a.l=i.l,a}function yC(n,e){var t=me(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var i=[],a=0;a<n.length;++a)i[a]=cC(n[a]);var o=zn([t].concat(i));return o.parts=[t.length].concat(i.map(function(l){return l.length})),o}function xC(){var n=me(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function bC(n){var e=me(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function SC(n,e){var t=n.name||"Arial",i=e&&e.biff==5,a=i?15+t.length:16+2*t.length,o=me(a);return o.write_shift(2,n.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),i||o.write_shift(1,1),o.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),o}function _C(n,e,t,i){var a=me(10);return Ws(n,e,i,a),a.write_shift(4,t),a}function TC(n,e,t,i,a){var o=!a||a.biff==8,l=me(8+ +o+(1+o)*t.length);return Ws(n,e,i,l),l.write_shift(2,t.length),o&&l.write_shift(1,1),l.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),l}function wC(n,e,t,i){var a=t&&t.biff==5;i||(i=me(a?3+e.length:5+2*e.length)),i.write_shift(2,n),i.write_shift(a?1:2,e.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=i.length>i.l?i.slice(0,i.l):i;return o.l==null&&(o.l=o.length),o}function EC(n,e){var t=e.biff==8||!e.biff?4:2,i=me(2*t+6);return i.write_shift(t,n.s.r),i.write_shift(t,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function Lx(n,e,t,i){var a=t&&t.biff==5;i||(i=me(a?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,e<<4));var o=0;return n.numFmtId>0&&a&&(o|=1024),i.write_shift(4,o),i.write_shift(4,0),a||i.write_shift(4,0),i.write_shift(2,0),i}function AC(n){var e=me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function kC(n,e,t,i,a,o){var l=me(8);return Ws(n,e,i,l),qS(t,o,l),l}function CC(n,e,t,i){var a=me(14);return Ws(n,e,i,a),Hs(t,a),a}function jC(n,e,t){if(t.biff<8)return DC(n,e,t);for(var i=[],a=n.l+e,o=n.read_shift(t.biff>8?4:2);o--!==0;)i.push(mC(n,t.biff>8?12:6,t));if(n.l!=a)throw new Error("Bad ExternSheet: "+n.l+" != "+a);return i}function DC(n,e,t){n[n.l+1]==3&&n[n.l]++;var i=KS(n,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function NC(n){var e=me(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)QS(n[t],e);return e}function OC(n){var e=me(24),t=Nn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(i[a],16));return zn([e,hC(n[1])])}function RC(n){var e=n[1].Tooltip,t=me(10+2*(e.length+1));t.write_shift(2,2048);var i=Nn(n[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var a=0;a<e.length;++a)t.write_shift(2,e.charCodeAt(a));return t.write_shift(2,0),t}function MC(n){return n||(n=me(4)),n.write_shift(2,1),n.write_shift(2,1),n}function LC(n,e,t){if(!t.cellStyles)return Pa(n,e);var i=t&&t.biff>=12?4:2,a=n.read_shift(i),o=n.read_shift(i),l=n.read_shift(i),u=n.read_shift(i),f=n.read_shift(2);i==2&&(n.l+=2);var m={s:a,e:o,w:l,ixfe:u,flags:f};return(t.biff>=5||!t.biff)&&(m.level=f>>8&7),m}function IC(n,e){var t=me(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var i=0;return n.hidden&&(i|=1),t.write_shift(1,i),i=n.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function PC(n){for(var e=me(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function BC(n,e,t){var i=me(15);return Jc(i,n,e),i.write_shift(8,t,"f"),i}function FC(n,e,t){var i=me(9);return Jc(i,n,e),i.write_shift(2,t),i}var UC=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Pp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,f){var m=[],p=zs(1);switch(f.type){case"base64":p=pa(hr(u));break;case"binary":p=pa(u);break;case"buffer":case"array":p=u;break}Ii(p,0);var v=p.read_shift(1),y=!!(v&136),S=!1,_=!1;switch(v){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var x=0,T=521;v==2&&(x=p.read_shift(2)),p.l+=3,v!=2&&(x=p.read_shift(4)),x>1048576&&(x=1e6),v!=2&&(T=p.read_shift(2));var w=p.read_shift(2),E=f.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(E=n[p[p.l]]),p.l+=1,p.l+=2),_&&(p.l+=36);for(var C=[],N={},A=Math.min(p.length,v==2?521:T-10-(S?264:0)),I=_?32:11;p.l<A&&p[p.l]!=13;)switch(N={},N.name=Vd.utils.decode(E,p.slice(p.l,p.l+I)).replace(/[\u0000\r\n].*$/g,""),p.l+=I,N.type=String.fromCharCode(p.read_shift(1)),v!=2&&!_&&(N.offset=p.read_shift(4)),N.len=p.read_shift(1),v==2&&(N.offset=p.read_shift(2)),N.dec=p.read_shift(1),N.name.length&&C.push(N),v!=2&&(p.l+=_?13:14),N.type){case"B":(!S||N.len!=8)&&f.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(p[p.l]!==13&&(p.l=T-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=T;var D=0,z=0;for(m[0]=[],z=0;z!=C.length;++z)m[0][z]=C[z].name;for(;x-- >0;){if(p[p.l]===42){p.l+=w;continue}for(++p.l,m[++D]=[],z=0,z=0;z!=C.length;++z){var L=p.slice(p.l,p.l+C[z].len);p.l+=C[z].len,Ii(L,0);var H=Vd.utils.decode(E,L);switch(C[z].type){case"C":H.trim().length&&(m[D][z]=H.replace(/\s+$/,""));break;case"D":H.length===8?m[D][z]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):m[D][z]=H;break;case"F":m[D][z]=parseFloat(H.trim());break;case"+":case"I":m[D][z]=_?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":m[D][z]=!0;break;case"N":case"F":m[D][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[D][z]="##MEMO##"+(_?parseInt(H.trim(),10):L.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(m[D][z]=+H||0);break;case"@":m[D][z]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":m[D][z]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":m[D][z]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[D][z]=-L.read_shift(-8,"f");break;case"B":if(S&&C[z].len==8){m[D][z]=L.read_shift(8,"f");break}case"G":case"P":L.l+=C[z].len;break;case"0":if(C[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[z].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(m=m.slice(0,f.sheetRows)),f.DBF=C,m}function i(u,f){var m=f||{};m.dateNF||(m.dateNF="yyyymmdd");var p=nl(t(u,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function a(u,f){try{return Vs(i(u,f),f)}catch(m){if(f&&f.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var m=f||{};if(+m.codepage>=0&&Ic(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=bi(),v=af(u,{header:1,raw:!0,cellDates:!0}),y=v[0],S=v.slice(1),_=u["!cols"]||[],x=0,T=0,w=0,E=1;for(x=0;x<y.length;++x){if(((_[x]||{}).DBF||{}).name){y[x]=_[x].DBF.name,++w;continue}if(y[x]!=null){if(++w,typeof y[x]=="number"&&(y[x]=y[x].toString(10)),typeof y[x]!="string")throw new Error("DBF Invalid column name "+y[x]+" |"+typeof y[x]+"|");if(y.indexOf(y[x])!==x){for(T=0;T<1024;++T)if(y.indexOf(y[x]+"_"+T)==-1){y[x]+="_"+T;break}}}}var C=Vt(u["!ref"]),N=[],A=[],I=[];for(x=0;x<=C.e.c-C.s.c;++x){var D="",z="",L=0,H=[];for(T=0;T<S.length;++T)S[T][x]!=null&&H.push(S[T][x]);if(H.length==0||y[x]==null){N[x]="?";continue}for(T=0;T<H.length;++T){switch(typeof H[T]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=H[T]instanceof Date?"D":"C";break;default:z="C"}L=Math.max(L,String(H[T]).length),D=D&&D!=z?"C":z}L>250&&(L=250),z=((_[x]||{}).DBF||{}).type,z=="C"&&_[x].DBF.len>L&&(L=_[x].DBF.len),D=="B"&&z=="N"&&(D="N",I[x]=_[x].DBF.dec,L=_[x].DBF.len),A[x]=D=="C"||z=="N"?L:o[D]||0,E+=A[x],N[x]=D}var K=p.next(32);for(K.write_shift(4,318902576),K.write_shift(4,S.length),K.write_shift(2,296+32*w),K.write_shift(2,E),x=0;x<4;++x)K.write_shift(4,0);for(K.write_shift(4,0|(+e[eS]||3)<<8),x=0,T=0;x<y.length;++x)if(y[x]!=null){var ne=p.next(32),xe=(y[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ne.write_shift(1,xe,"sbcs"),ne.write_shift(1,N[x]=="?"?"C":N[x],"sbcs"),ne.write_shift(4,T),ne.write_shift(1,A[x]||o[N[x]]||0),ne.write_shift(1,I[x]||0),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(1,0),ne.write_shift(4,0),ne.write_shift(4,0),T+=A[x]||o[N[x]]||0}var He=p.next(264);for(He.write_shift(4,13),x=0;x<65;++x)He.write_shift(4,0);for(x=0;x<S.length;++x){var _e=p.next(E);for(_e.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(N[T]){case"L":_e.write_shift(1,S[x][T]==null?63:S[x][T]?84:70);break;case"B":_e.write_shift(8,S[x][T]||0,"f");break;case"N":var ie="0";for(typeof S[x][T]=="number"&&(ie=S[x][T].toFixed(I[T]||0)),w=0;w<A[T]-ie.length;++w)_e.write_shift(1,32);_e.write_shift(1,ie,"sbcs");break;case"D":S[x][T]?(_e.write_shift(4,("0000"+S[x][T].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(S[x][T].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+S[x][T].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var he=String(S[x][T]!=null?S[x][T]:"").slice(0,A[T]);for(_e.write_shift(1,he,"sbcs"),w=0;w<A[T]-he.length;++w)_e.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:i,from_sheet:l}}(),zC=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Vn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,S){var _=n[S];return typeof _=="number"?rx(_):_},i=function(y,S,_){var x=S.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return x==59?y:rx(x)};n["|"]=254;function a(y,S){switch(S.type){case"base64":return o(hr(y),S);case"binary":return o(y,S);case"buffer":return o(_t&&Buffer.isBuffer(y)?y.toString("binary"):$c(y),S);case"array":return o(gf(y),S)}throw new Error("Unrecognized type "+S.type)}function o(y,S){var _=y.split(/[\n\r]+/),x=-1,T=-1,w=0,E=0,C=[],N=[],A=null,I={},D=[],z=[],L=[],H=0,K;for(+S.codepage>=0&&Ic(+S.codepage);w!==_.length;++w){H=0;var ne=_[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),xe=ne.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),He=xe[0],_e;if(ne.length>0)switch(He){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":xe[1].charAt(0)=="P"&&N.push(ne.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,he=!1,Ne=!1,Be=!1,X=-1,pe=-1;for(E=1;E<xe.length;++E)switch(xe[E].charAt(0)){case"A":break;case"X":T=parseInt(xe[E].slice(1))-1,he=!0;break;case"Y":for(x=parseInt(xe[E].slice(1))-1,he||(T=0),K=C.length;K<=x;++K)C[K]=[];break;case"K":_e=xe[E].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(ur(_e))?isNaN(Bc(_e).getDate())||(_e=oi(_e)):(_e=ur(_e),A!==null&&fS(A)&&(_e=gS(_e))),ie=!0;break;case"E":Be=!0;var P=Fj(xe[E].slice(1),{r:x,c:T});C[x][T]=[C[x][T],P];break;case"S":Ne=!0,C[x][T]=[C[x][T],"S5S"];break;case"G":break;case"R":X=parseInt(xe[E].slice(1))-1;break;case"C":pe=parseInt(xe[E].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}if(ie&&(C[x][T]&&C[x][T].length==2?C[x][T][0]=_e:C[x][T]=_e,A=null),Ne){if(Be)throw new Error("SYLK shared formula cannot have own formula");var Y=X>-1&&C[X][pe];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");C[x][T][1]=Uj(Y[1],{r:x-X,c:T-pe})}break;case"F":var V=0;for(E=1;E<xe.length;++E)switch(xe[E].charAt(0)){case"X":T=parseInt(xe[E].slice(1))-1,++V;break;case"Y":for(x=parseInt(xe[E].slice(1))-1,K=C.length;K<=x;++K)C[K]=[];break;case"M":H=parseInt(xe[E].slice(1))/20;break;case"F":break;case"G":break;case"P":A=N[parseInt(xe[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=xe[E].slice(1).split(" "),K=parseInt(L[0],10);K<=parseInt(L[1],10);++K)H=parseInt(L[2],10),z[K-1]=H===0?{hidden:!0}:{wch:H},qp(z[K-1]);break;case"C":T=parseInt(xe[E].slice(1))-1,z[T]||(z[T]={});break;case"R":x=parseInt(xe[E].slice(1))-1,D[x]||(D[x]={}),H>0?(D[x].hpt=H,D[x].hpx=i_(H)):H===0&&(D[x].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}V<1&&(A=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}}return D.length>0&&(I["!rows"]=D),z.length>0&&(I["!cols"]=z),S&&S.sheetRows&&(C=C.slice(0,S.sheetRows)),[C,I]}function l(y,S){var _=a(y,S),x=_[0],T=_[1],w=nl(x,S);return Vn(T).forEach(function(E){w[E]=T[E]}),w}function u(y,S){return Vs(l(y,S),S)}function f(y,S,_,x){var T="C;Y"+(_+1)+";X"+(x+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+Zp(y.f,{r:_,c:x}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function m(y,S){S.forEach(function(_,x){var T="F;W"+(x+1)+" "+(x+1)+" ";_.hidden?T+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Jd(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=ef(_.wpx)),typeof _.wch=="number"&&(T+=Math.round(_.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function p(y,S){S.forEach(function(_,x){var T="F;";_.hidden?T+="M0;":_.hpt?T+="M"+20*_.hpt+";":_.hpx&&(T+="M"+20*tf(_.hpx)+";"),T.length>2&&y.push(T+"R"+(x+1))})}function v(y,S){var _=["ID;PWXL;N;E"],x=[],T=Vt(y["!ref"]),w,E=Array.isArray(y),C=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),y["!cols"]&&m(_,y["!cols"]),y["!rows"]&&p(_,y["!rows"]),_.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var N=T.s.r;N<=T.e.r;++N)for(var A=T.s.c;A<=T.e.c;++A){var I=Nt({r:N,c:A});w=E?(y[N]||[])[A]:y[I],!(!w||w.v==null&&(!w.f||w.F))&&x.push(f(w,y,N,A))}return _.join(C)+C+x.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:l,from_sheet:v}}(),HC=function(){function n(o,l){switch(l.type){case"base64":return e(hr(o),l);case"binary":return e(o,l);case"buffer":return e(_t&&Buffer.isBuffer(o)?o.toString("binary"):$c(o),l);case"array":return e(gf(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),f=-1,m=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++f]=[],m=0;continue}if(!(f<0)){var y=u[p].trim().split(","),S=y[0],_=y[1];++p;for(var x=u[p]||"";(x.match(/["]/g)||[]).length&1&&p<u.length-1;)x+=`
`+u[++p];switch(x=x.trim(),+S){case-1:if(x==="BOT"){v[++f]=[],m=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?v[f][m]=!0:x==="FALSE"?v[f][m]=!1:isNaN(ur(_))?isNaN(Bc(_).getDate())?v[f][m]=_:v[f][m]=oi(_):v[f][m]=ur(_),++m;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),v[f][m++]=x!==""?x:null;break}if(x==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function t(o,l){return nl(n(o,l),l)}function i(o,l){return Vs(t(o,l),l)}var a=function(){var o=function(f,m,p,v,y){f.push(m),f.push(p+","+v),f.push('"'+y.replace(/"/g,'""')+'"')},l=function(f,m,p,v){f.push(m+","+p),f.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var m=[],p=Vt(f["!ref"]),v,y=Array.isArray(f);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,p.e.r-p.s.r+1,""),o(m,"TUPLES",0,p.e.c-p.s.c+1,""),o(m,"DATA",0,0,"");for(var S=p.s.r;S<=p.e.r;++S){l(m,-1,0,"BOT");for(var _=p.s.c;_<=p.e.c;++_){var x=Nt({r:S,c:_});if(v=y?(f[S]||[])[_]:f[x],!v){l(m,1,0,"");continue}switch(v.t){case"n":var T=v.w;!T&&v.v!=null&&(T=v.v),T==null?v.f&&!v.F?l(m,1,0,"="+v.f):l(m,1,0,""):l(m,0,T,"V");break;case"b":l(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=es(v.z||sn[14],_i(oi(v.v)))),l(m,0,v.w,"V");break;default:l(m,1,0,"")}}}l(m,-1,0,"EOD");var w=`\r
`,E=m.join(w);return E}}();return{to_workbook:i,to_sheet:t,from_sheet:a}}(),JS=function(){function n(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,y){for(var S=v.split(`
`),_=-1,x=-1,T=0,w=[];T!==S.length;++T){var E=S[T].trim().split(":");if(E[0]==="cell"){var C=Nn(E[1]);if(w.length<=C.r)for(_=w.length;_<=C.r;++_)w[_]||(w[_]=[]);switch(_=C.r,x=C.c,E[2]){case"t":w[_][x]=n(E[3]);break;case"v":w[_][x]=+E[3];break;case"vtf":var N=E[E.length-1];case"vtc":switch(E[3]){case"nl":w[_][x]=!!+E[4];break;default:w[_][x]=+E[4];break}E[2]=="vtf"&&(w[_][x]=[w[_][x],N])}}}return y&&y.sheetRows&&(w=w.slice(0,y.sheetRows)),w}function i(v,y){return nl(t(v,y),y)}function a(v,y){return Vs(i(v,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var y=[],S=[],_,x="",T=Fi(v["!ref"]),w=Array.isArray(v),E=T.s.r;E<=T.e.r;++E)for(var C=T.s.c;C<=T.e.c;++C)if(x=Nt({r:E,c:C}),_=w?(v[E]||[])[C]:v[x],!(!_||_.v==null||_.t==="z")){switch(S=["cell",x,"t"],_.t){case"s":case"str":S.push(e(_.v));break;case"n":_.f?(S[2]="vtf",S[3]="n",S[4]=_.v,S[5]=e(_.f)):(S[2]="v",S[3]=_.v);break;case"b":S[2]="vt"+(_.f?"f":"c"),S[3]="nl",S[4]=_.v?"1":"0",S[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var N=_i(oi(_.v));S[2]="vtc",S[3]="nd",S[4]=""+N,S[5]=_.w||es(_.z||sn[14],N);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(v){return[o,l,u,l,m(v),f].join(`
`)}return{to_workbook:a,to_sheet:i,from_sheet:p}}(),WC=function(){function n(p,v,y,S,_){_.raw?v[y][S]=p:p===""||(p==="TRUE"?v[y][S]=!0:p==="FALSE"?v[y][S]=!1:isNaN(ur(p))?isNaN(Bc(p).getDate())?v[y][S]=p:v[y][S]=oi(p):v[y][S]=ur(p))}function e(p,v){var y=v||{},S=[];if(!p||p.length===0)return S;for(var _=p.split(/[\r\n]/),x=_.length-1;x>=0&&_[x].length===0;)--x;for(var T=10,w=0,E=0;E<=x;++E)w=_[E].indexOf(" "),w==-1?w=_[E].length:w++,T=Math.max(T,w);for(E=0;E<=x;++E){S[E]=[];var C=0;for(n(_[E].slice(0,T).trim(),S,E,C,y),C=1;C<=(_[E].length-T)/10+1;++C)n(_[E].slice(T+(C-1)*10,T+C*10).trim(),S,E,C,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function a(p){for(var v={},y=!1,S=0,_=0;S<p.length;++S)(_=p.charCodeAt(S))==34?y=!y:!y&&_ in t&&(v[_]=(v[_]||0)+1);_=[];for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&_.push([v[S],S]);if(!_.length){v=i;for(S in v)Object.prototype.hasOwnProperty.call(v,S)&&_.push([v[S],S])}return _.sort(function(x,T){return x[0]-T[0]||i[x[1]]-i[T[1]]}),t[_.pop()[1]]||44}function o(p,v){var y=v||{},S="",_=y.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(S=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(S=p.charAt(4),p=p.slice(6)):S=a(p.slice(0,1024)):y&&y.FS?S=y.FS:S=a(p.slice(0,1024));var T=0,w=0,E=0,C=0,N=0,A=S.charCodeAt(0),I=!1,D=0,z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var L=y.dateNF!=null?r5(y.dateNF):null;function H(){var K=p.slice(C,N),ne={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)ne.t="z";else if(y.raw)ne.t="s",ne.v=K;else if(K.trim().length===0)ne.t="s",ne.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(ne.t="s",ne.v=K.slice(2,-1).replace(/""/g,'"')):zj(K)?(ne.t="n",ne.f=K.slice(1)):(ne.t="s",ne.v=K);else if(K=="TRUE")ne.t="b",ne.v=!0;else if(K=="FALSE")ne.t="b",ne.v=!1;else if(!isNaN(E=ur(K)))ne.t="n",y.cellText!==!1&&(ne.w=K),ne.v=E;else if(!isNaN(Bc(K).getDate())||L&&K.match(L)){ne.z=y.dateNF||sn[14];var xe=0;L&&K.match(L)&&(K=s5(K,y.dateNF,K.match(L)||[]),xe=1),y.cellDates?(ne.t="d",ne.v=oi(K,xe)):(ne.t="n",ne.v=_i(oi(K,xe))),y.cellText!==!1&&(ne.w=es(ne.z,ne.v instanceof Date?_i(ne.v):ne.v)),y.cellNF||delete ne.z}else ne.t="s",ne.v=K;if(ne.t=="z"||(y.dense?(_[T]||(_[T]=[]),_[T][w]=ne):_[Nt({c:w,r:T})]=ne),C=N+1,z=p.charCodeAt(C),x.e.c<w&&(x.e.c=w),x.e.r<T&&(x.e.r=T),D==A)++w;else if(w=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;N<p.length;++N)switch(D=p.charCodeAt(N)){case 34:z===34&&(I=!I);break;case A:case 10:case 13:if(!I&&H())break e;break}return N-C>0&&H(),_["!ref"]=gn(x),_}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):nl(e(p,v),v)}function u(p,v){var y="",S=v.type=="string"?[0,0,0,0]:tM(p,v);switch(v.type){case"base64":y=hr(p);break;case"binary":y=p;break;case"buffer":v.codepage==65001?y=p.toString("utf8"):v.codepage&&typeof Vd<"u"||(y=_t&&Buffer.isBuffer(p)?p.toString("binary"):$c(p));break;case"array":y=gf(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+v.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=Tc(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=Tc(y):v.type=="binary"&&typeof Vd<"u",y.slice(0,19)=="socialcalc:version:"?JS.to_sheet(v.type=="string"?y:Tc(y),v):l(y,v)}function f(p,v){return Vs(u(p,v),v)}function m(p){for(var v=[],y=Vt(p["!ref"]),S,_=Array.isArray(p),x=y.s.r;x<=y.e.r;++x){for(var T=[],w=y.s.c;w<=y.e.c;++w){var E=Nt({r:x,c:w});if(S=_?(p[x]||[])[w]:p[E],!S||S.v==null){T.push("          ");continue}for(var C=(S.w||(mr(S),S.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(w===0?" ":""))}v.push(T.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:m}}(),Ix=function(){function n(P,Y,V){if(P){Ii(P,P.l||0);for(var q=V.Enum||X;P.l<P.length;){var re=P.read_shift(2),Me=q[re]||q[65535],Ce=P.read_shift(2),Le=P.l+Ce,Ae=Me.f&&Me.f(P,Ce,V);if(P.l=Le,Y(Ae,Me,re))return}}}function e(P,Y){switch(Y.type){case"base64":return t(pa(hr(P)),Y);case"binary":return t(pa(P),Y);case"buffer":case"array":return t(P,Y)}throw"Unsupported type "+Y.type}function t(P,Y){if(!P)return P;var V=Y||{},q=V.dense?[]:{},re="Sheet1",Me="",Ce=0,Le={},Ae=[],ct=[],Je={s:{r:0,c:0},e:{r:0,c:0}},Ht=V.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)V.Enum=X,n(P,function(Re,wn,Rn){switch(Rn){case 0:V.vers=Re,Re>=4096&&(V.qpro=!0);break;case 6:Je=Re;break;case 204:Re&&(Me=Re);break;case 222:Me=Re;break;case 15:case 51:V.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Rn==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=V.dateNF||sn[14],V.cellDates&&(Re[1].t="d",Re[1].v=gS(Re[1].v))),V.qpro&&Re[3]>Ce&&(q["!ref"]=gn(Je),Le[re]=q,Ae.push(re),q=V.dense?[]:{},Je={s:{r:0,c:0},e:{r:0,c:0}},Ce=Re[3],re=Me||"Sheet"+(Ce+1),Me="");var ei=V.dense?(q[Re[0].r]||[])[Re[0].c]:q[Nt(Re[0])];if(ei){ei.t=Re[1].t,ei.v=Re[1].v,Re[1].z!=null&&(ei.z=Re[1].z),Re[1].f!=null&&(ei.f=Re[1].f);break}V.dense?(q[Re[0].r]||(q[Re[0].r]=[]),q[Re[0].r][Re[0].c]=Re[1]):q[Nt(Re[0])]=Re[1];break}},V);else if(P[2]==26||P[2]==14)V.Enum=pe,P[2]==14&&(V.qpro=!0,P.l=0),n(P,function(Re,wn,Rn){switch(Rn){case 204:re=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>Ce&&(q["!ref"]=gn(Je),Le[re]=q,Ae.push(re),q=V.dense?[]:{},Je={s:{r:0,c:0},e:{r:0,c:0}},Ce=Re[3],re="Sheet"+(Ce+1)),Ht>0&&Re[0].r>=Ht)break;V.dense?(q[Re[0].r]||(q[Re[0].r]=[]),q[Re[0].r][Re[0].c]=Re[1]):q[Nt(Re[0])]=Re[1],Je.e.c<Re[0].c&&(Je.e.c=Re[0].c),Je.e.r<Re[0].r&&(Je.e.r=Re[0].r);break;case 27:Re[14e3]&&(ct[Re[14e3][0]]=Re[14e3][1]);break;case 1537:ct[Re[0]]=Re[1],Re[0]==Ce&&(re=Re[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(q["!ref"]=gn(Je),Le[Me||re]=q,Ae.push(Me||re),!ct.length)return{SheetNames:Ae,Sheets:Le};for(var at={},Gn=[],gt=0;gt<ct.length;++gt)Le[Ae[gt]]?(Gn.push(ct[gt]||Ae[gt]),at[ct[gt]]=Le[ct[gt]]||Le[Ae[gt]]):(Gn.push(ct[gt]),at[ct[gt]]={"!ref":"A1"});return{SheetNames:Gn,Sheets:at}}function i(P,Y){var V=Y||{};if(+V.codepage>=0&&Ic(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var q=bi(),re=Vt(P["!ref"]),Me=Array.isArray(P),Ce=[];De(q,0,o(1030)),De(q,6,f(re));for(var Le=Math.min(re.e.r,8191),Ae=re.s.r;Ae<=Le;++Ae)for(var ct=Wn(Ae),Je=re.s.c;Je<=re.e.c;++Je){Ae===re.s.r&&(Ce[Je]=Zn(Je));var Ht=Ce[Je]+ct,at=Me?(P[Ae]||[])[Je]:P[Ht];if(!(!at||at.t=="z"))if(at.t=="n")(at.v|0)==at.v&&at.v>=-32768&&at.v<=32767?De(q,13,S(Ae,Je,at.v)):De(q,14,x(Ae,Je,at.v));else{var Gn=mr(at);De(q,15,v(Ae,Je,Gn.slice(0,239)))}}return De(q,1),q.end()}function a(P,Y){var V=Y||{};if(+V.codepage>=0&&Ic(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var q=bi();De(q,0,l(P));for(var re=0,Me=0;re<P.SheetNames.length;++re)(P.Sheets[P.SheetNames[re]]||{})["!ref"]&&De(q,27,Be(P.SheetNames[re],Me++));var Ce=0;for(re=0;re<P.SheetNames.length;++re){var Le=P.Sheets[P.SheetNames[re]];if(!(!Le||!Le["!ref"])){for(var Ae=Vt(Le["!ref"]),ct=Array.isArray(Le),Je=[],Ht=Math.min(Ae.e.r,8191),at=Ae.s.r;at<=Ht;++at)for(var Gn=Wn(at),gt=Ae.s.c;gt<=Ae.e.c;++gt){at===Ae.s.r&&(Je[gt]=Zn(gt));var Re=Je[gt]+Gn,wn=ct?(Le[at]||[])[gt]:Le[Re];if(!(!wn||wn.t=="z"))if(wn.t=="n")De(q,23,H(at,gt,Ce,wn.v));else{var Rn=mr(wn);De(q,22,D(at,gt,Ce,Rn.slice(0,239)))}}++Ce}}return De(q,1),q.end()}function o(P){var Y=me(2);return Y.write_shift(2,P),Y}function l(P){var Y=me(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var V=0,q=0,re=0,Me=0;Me<P.SheetNames.length;++Me){var Ce=P.SheetNames[Me],Le=P.Sheets[Ce];if(!(!Le||!Le["!ref"])){++re;var Ae=Fi(Le["!ref"]);V<Ae.e.r&&(V=Ae.e.r),q<Ae.e.c&&(q=Ae.e.c)}}return V>8191&&(V=8191),Y.write_shift(2,V),Y.write_shift(1,re),Y.write_shift(1,q),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function u(P,Y,V){var q={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&V.qpro?(q.s.c=P.read_shift(1),P.l++,q.s.r=P.read_shift(2),q.e.c=P.read_shift(1),P.l++,q.e.r=P.read_shift(2),q):(q.s.c=P.read_shift(2),q.s.r=P.read_shift(2),Y==12&&V.qpro&&(P.l+=2),q.e.c=P.read_shift(2),q.e.r=P.read_shift(2),Y==12&&V.qpro&&(P.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function f(P){var Y=me(8);return Y.write_shift(2,P.s.c),Y.write_shift(2,P.s.r),Y.write_shift(2,P.e.c),Y.write_shift(2,P.e.r),Y}function m(P,Y,V){var q=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(q[0].c=P.read_shift(1),q[3]=P.read_shift(1),q[0].r=P.read_shift(2),P.l+=2):(q[2]=P.read_shift(1),q[0].c=P.read_shift(2),q[0].r=P.read_shift(2)),q}function p(P,Y,V){var q=P.l+Y,re=m(P,Y,V);if(re[1].t="s",V.vers==20768){P.l++;var Me=P.read_shift(1);return re[1].v=P.read_shift(Me,"utf8"),re}return V.qpro&&P.l++,re[1].v=P.read_shift(q-P.l,"cstr"),re}function v(P,Y,V){var q=me(7+V.length);q.write_shift(1,255),q.write_shift(2,Y),q.write_shift(2,P),q.write_shift(1,39);for(var re=0;re<q.length;++re){var Me=V.charCodeAt(re);q.write_shift(1,Me>=128?95:Me)}return q.write_shift(1,0),q}function y(P,Y,V){var q=m(P,Y,V);return q[1].v=P.read_shift(2,"i"),q}function S(P,Y,V){var q=me(7);return q.write_shift(1,255),q.write_shift(2,Y),q.write_shift(2,P),q.write_shift(2,V,"i"),q}function _(P,Y,V){var q=m(P,Y,V);return q[1].v=P.read_shift(8,"f"),q}function x(P,Y,V){var q=me(13);return q.write_shift(1,255),q.write_shift(2,Y),q.write_shift(2,P),q.write_shift(8,V,"f"),q}function T(P,Y,V){var q=P.l+Y,re=m(P,Y,V);if(re[1].v=P.read_shift(8,"f"),V.qpro)P.l=q;else{var Me=P.read_shift(2);N(P.slice(P.l,P.l+Me),re),P.l+=Me}return re}function w(P,Y,V){var q=Y&32768;return Y&=-32769,Y=(q?P:0)+(Y>=8192?Y-16384:Y),(q?"":"$")+(V?Zn(Y):Wn(Y))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(P,Y){Ii(P,0);for(var V=[],q=0,re="",Me="",Ce="",Le="";P.l<P.length;){var Ae=P[P.l++];switch(Ae){case 0:V.push(P.read_shift(8,"f"));break;case 1:Me=w(Y[0].c,P.read_shift(2),!0),re=w(Y[0].r,P.read_shift(2),!1),V.push(Me+re);break;case 2:{var ct=w(Y[0].c,P.read_shift(2),!0),Je=w(Y[0].r,P.read_shift(2),!1);Me=w(Y[0].c,P.read_shift(2),!0),re=w(Y[0].r,P.read_shift(2),!1),V.push(ct+Je+":"+Me+re)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(P.read_shift(2));break;case 6:{for(var Ht="";Ae=P[P.l++];)Ht+=String.fromCharCode(Ae);V.push('"'+Ht.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Le=V.pop(),Ce=V.pop(),V.push(["AND","OR"][Ae-20]+"("+Ce+","+Le+")");break;default:if(Ae<32&&C[Ae])Le=V.pop(),Ce=V.pop(),V.push(Ce+C[Ae]+Le);else if(E[Ae]){if(q=E[Ae][1],q==69&&(q=P[P.l++]),q>V.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+V.join("|")+"|");return}var at=V.slice(-q);V.length-=q,V.push(E[Ae][0]+"("+at.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}V.length==1?Y[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function A(P){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=P.read_shift(2),Y[3]=P[P.l++],Y[0].c=P[P.l++],Y}function I(P,Y){var V=A(P);return V[1].t="s",V[1].v=P.read_shift(Y-4,"cstr"),V}function D(P,Y,V,q){var re=me(6+q.length);re.write_shift(2,P),re.write_shift(1,V),re.write_shift(1,Y),re.write_shift(1,39);for(var Me=0;Me<q.length;++Me){var Ce=q.charCodeAt(Me);re.write_shift(1,Ce>=128?95:Ce)}return re.write_shift(1,0),re}function z(P,Y){var V=A(P);V[1].v=P.read_shift(2);var q=V[1].v>>1;if(V[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return V[1].v=q,V}function L(P,Y){var V=A(P),q=P.read_shift(4),re=P.read_shift(4),Me=P.read_shift(2);if(Me==65535)return q===0&&re===3221225472?(V[1].t="e",V[1].v=15):q===0&&re===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var Ce=Me&32768;return Me=(Me&32767)-16446,V[1].v=(1-Ce*2)*(re*Math.pow(2,Me+32)+q*Math.pow(2,Me)),V}function H(P,Y,V,q){var re=me(14);if(re.write_shift(2,P),re.write_shift(1,V),re.write_shift(1,Y),q==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var Me=0,Ce=0,Le=0,Ae=0;return q<0&&(Me=1,q=-q),Ce=Math.log2(q)|0,q/=Math.pow(2,Ce-31),Ae=q>>>0,(Ae&2147483648)==0&&(q/=2,++Ce,Ae=q>>>0),q-=Ae,Ae|=2147483648,Ae>>>=0,q*=Math.pow(2,32),Le=q>>>0,re.write_shift(4,Le),re.write_shift(4,Ae),Ce+=16383+(Me?32768:0),re.write_shift(2,Ce),re}function K(P,Y){var V=L(P);return P.l+=Y-14,V}function ne(P,Y){var V=A(P),q=P.read_shift(4);return V[1].v=q>>6,V}function xe(P,Y){var V=A(P),q=P.read_shift(8,"f");return V[1].v=q,V}function He(P,Y){var V=xe(P);return P.l+=Y-10,V}function _e(P,Y){return P[P.l+Y-1]==0?P.read_shift(Y,"cstr"):""}function ie(P,Y){var V=P[P.l++];V>Y-1&&(V=Y-1);for(var q="";q.length<V;)q+=String.fromCharCode(P[P.l++]);return q}function he(P,Y,V){if(!(!V.qpro||Y<21)){var q=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var re=P.read_shift(Y-21,"cstr");return[q,re]}}function Ne(P,Y){for(var V={},q=P.l+Y;P.l<q;){var re=P.read_shift(2);if(re==14e3){for(V[re]=[0,""],V[re][0]=P.read_shift(2);P[P.l];)V[re][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return V}function Be(P,Y){var V=me(5+P.length);V.write_shift(2,14e3),V.write_shift(2,Y);for(var q=0;q<P.length;++q){var re=P.charCodeAt(q);V[V.l++]=re>127?95:re}return V[V.l++]=0,V}var X={0:{n:"BOF",f:$S},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ne},38:{n:"??"},39:{n:"NUMBER27",f:xe},40:{n:"FORMULA28",f:He},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:a,to_workbook:e}}(),VC=/^\s|\s$|[\t\n\r]/;function e_(n,e){if(!e.bookSST)return"";var t=[vn];t[t.length]=je("sst",null,{xmlns:tl[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var a=n[i],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(VC)&&(o+=' xml:space="preserve"'),o+=">"+Dt(a.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function GC(n){return[n.read_shift(4),n.read_shift(4)]}function YC(n,e){return e||(e=me(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var XC=P5;function $C(n){var e=bi();be(e,159,YC(n));for(var t=0;t<n.length;++t)be(e,19,XC(n[t]));return be(e,160),e.end()}function qC(n){for(var e=[],t=n.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function t_(n){var e=0,t,i=qC(n),a=i.length+1,o,l,u,f,m;for(t=zs(a),t[0]=i.length,o=1;o!=a;++o)t[o]=i[o-1];for(o=a-1;o>=0;--o)l=t[o],u=(e&16384)===0?0:1,f=e<<1&32767,m=u|f,e=m^l;return e^52811}var KC=function(){function n(a,o){switch(o.type){case"base64":return e(hr(a),o);case"binary":return e(a,o);case"buffer":return e(_t&&Buffer.isBuffer(a)?a.toString("binary"):$c(a),o);case"array":return e(gf(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var l=o||{},u=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var y=/\\\w+\b/g,S=0,_,x=-1;_=y.exec(p);){switch(_[0]){case"\\cell":var T=p.slice(S,y.lastIndex-_[0].length);if(T[0]==" "&&(T=T.slice(1)),++x,T.length){var w={v:T,t:"s"};Array.isArray(u)?u[v][x]=w:u[Nt({r:v,c:x})]=w}break}S=y.lastIndex}x>m.e.c&&(m.e.c=x)}),u["!ref"]=gn(m),u}function t(a,o){return Vs(n(a,o),o)}function i(a){for(var o=["{\\rtf1\\ansi"],l=Vt(a["!ref"]),u,f=Array.isArray(a),m=l.s.r;m<=l.e.r;++m){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=Nt({r:m,c:p});u=f?(a[m]||[])[p]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(mr(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:i}}();function Px(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var ZC=6,dr=ZC;function Jd(n){return Math.floor((n+Math.round(128/dr)/256)*dr)}function ef(n){return Math.floor((n-5)/dr*100+.5)/100}function sp(n){return Math.round((n*dr+5)/dr*256)/256}function qp(n){n.width?(n.wpx=Jd(n.width),n.wch=ef(n.wpx),n.MDW=dr):n.wpx?(n.wch=ef(n.wpx),n.width=sp(n.wch),n.MDW=dr):typeof n.wch=="number"&&(n.width=sp(n.wch),n.wpx=Jd(n.width),n.MDW=dr),n.customWidth&&delete n.customWidth}var QC=96,n_=QC;function tf(n){return n*96/n_}function i_(n){return n*n_/96}function JC(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)n[i]!=null&&(e[e.length]=je("numFmt",null,{numFmtId:i,formatCode:Dt(n[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=je("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function ej(n){var e=[];return e[e.length]=je("cellXfs",null),n.forEach(function(t){e[e.length]=je("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=je("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function a_(n,e){var t=[vn,je("styleSheet",null,{xmlns:tl[0],"xmlns:vt":Dn.vt})],i;return n.SSF&&(i=JC(n.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=ej(e.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function tj(n,e){var t=n.read_shift(2),i=Qn(n);return[t,i]}function nj(n,e,t){t||(t=me(6+4*e.length)),t.write_shift(2,n),On(e,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function ij(n,e,t){var i={};i.sz=n.read_shift(2)/20;var a=V5(n);a.fItalic&&(i.italic=1),a.fCondense&&(i.condense=1),a.fExtend&&(i.extend=1),a.fShadow&&(i.shadow=1),a.fOutline&&(i.outline=1),a.fStrikeout&&(i.strike=1);var o=n.read_shift(2);switch(o===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var l=n.read_shift(1);l!=0&&(i.underline=l);var u=n.read_shift(1);u>0&&(i.family=u);var f=n.read_shift(1);switch(f>0&&(i.charset=f),n.l++,i.color=W5(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Qn(n),i}function aj(n,e){e||(e=me(25+4*32)),e.write_shift(2,n.sz*20),G5(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Zd(n.color,e);var i=0;return i=2,e.write_shift(1,i),On(n.name,e),e.length>e.l?e.slice(0,e.l):e}var rj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zm,sj=Pa;function Bx(n,e){e||(e=me(4*3+8*7+16*1)),zm||(zm=Pp(rj));var t=zm[n.patternType];t==null&&(t=40),e.write_shift(4,t);var i=0;if(t!=40)for(Zd({auto:1},e),Zd({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function oj(n,e){var t=n.l+e,i=n.read_shift(2),a=n.read_shift(2);return n.l=t,{ixfe:i,numFmtId:a}}function r_(n,e,t){t||(t=me(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function dc(n,e){return e||(e=me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var lj=Pa;function cj(n,e){return e||(e=me(51)),e.write_shift(1,0),dc(null,e),dc(null,e),dc(null,e),dc(null,e),dc(null,e),e.length>e.l?e.slice(0,e.l):e}function uj(n,e){return e||(e=me(12+4*10)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Kd(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function dj(n,e,t){var i=me(2052);return i.write_shift(4,n),Kd(e,i),Kd(t,i),i.length>i.l?i.slice(0,i.l):i}function fj(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var a=i[0];a<=i[1];++a)e[a]!=null&&++t}),t!=0&&(be(n,615,va(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var a=i[0];a<=i[1];++a)e[a]!=null&&be(n,44,nj(a,e[a]))}),be(n,616))}}function hj(n){var e=1;be(n,611,va(e)),be(n,43,aj({sz:12,color:{theme:1},name:"Calibri",family:2})),be(n,612)}function mj(n){var e=2;be(n,603,va(e)),be(n,45,Bx({patternType:"none"})),be(n,45,Bx({patternType:"gray125"})),be(n,604)}function pj(n){var e=1;be(n,613,va(e)),be(n,46,cj()),be(n,614)}function gj(n){var e=1;be(n,626,va(e)),be(n,47,r_({numFmtId:0},65535)),be(n,627)}function vj(n,e){be(n,617,va(e.length)),e.forEach(function(t){be(n,47,r_(t,0))}),be(n,618)}function yj(n){var e=1;be(n,619,va(e)),be(n,48,uj({xfId:0,name:"Normal"})),be(n,620)}function xj(n){var e=0;be(n,505,va(e)),be(n,506)}function bj(n){var e=0;be(n,508,dj(e,"TableStyleMedium9","PivotStyleMedium4")),be(n,509)}function Sj(n,e){var t=bi();return be(t,278),fj(t,n.SSF),hj(t),mj(t),pj(t),gj(t),vj(t,e.cellXfs),yj(t),xj(t),bj(t),be(t,279),t.end()}function s_(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[vn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function _j(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:Qn(n)}}function Tj(n){var e=me(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),On(n.name,e),e.slice(0,e.l)}function wj(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function Ej(n){var e=me(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function Aj(n,e){var t=me(8+2*e.length);return t.write_shift(4,n),On(e,t),t.slice(0,t.l)}function kj(n){return n.l+=4,n.read_shift(4)!=0}function Cj(n,e){var t=me(8);return t.write_shift(4,n),t.write_shift(4,1),t}function jj(){var n=bi();return be(n,332),be(n,334,va(1)),be(n,335,Tj({name:"XLDAPR",version:12e4,flags:3496657072})),be(n,336),be(n,339,Aj(1,"XLDAPR")),be(n,52),be(n,35,va(514)),be(n,4096,va(0)),be(n,4097,ea(1)),be(n,36),be(n,53),be(n,340),be(n,337,Cj(1)),be(n,51,Ej([[1,0]])),be(n,338),be(n,333),n.end()}function o_(){var n=[vn];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function Dj(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Nt(t);var i=n.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}var Uo=1024;function l_(n,e){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[je("xml",null,{"xmlns:v":Pi.v,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:mv":Pi.mv}).replace(/\/>/,">"),je("o:shapelayout",je("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),je("v:shapetype",[je("v:stroke",null,{joinstyle:"miter"}),je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Uo<n*1e3;)Uo+=1e3;return e.forEach(function(o){var l=Nn(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=je("v:fill",f,u),p={on:"t",obscured:"t"};++Uo,a=a.concat(["<v:shape"+Uc({id:"_x0000_s"+Uo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,je("v:shadow",null,p),je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Hn("x:AutoFill","False"),Hn("x:Row",String(l.r)),Hn("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function c_(n){var e=[vn,je("comments",null,{xmlns:tl[0]})],t=[];return e.push("<authors>"),n.forEach(function(i){i[1].forEach(function(a){var o=Dt(a.a);t.indexOf(o)==-1&&(t.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(i){var a=0,o=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?a=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(f){f.a&&(a=t.indexOf(Dt(f.a))),o.push(f.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(Hn("t",Dt(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;e.push(Hn("t",Dt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Nj(n,e,t){var i=[vn,je("ThreadedComments",null,{xmlns:Dn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};u==0?o=f.id:f.parentId=o,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),i.push(je("threadedComment",Hn("text",l.t||""),f))})}),i.push("</ThreadedComments>"),i.join("")}function Oj(n){var e=[vn,je("personList",null,{xmlns:Dn.TCMNT,"xmlns:x":tl[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,i){e.push(je("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Rj(n){var e={};e.iauthor=n.read_shift(4);var t=$s(n);return e.rfx=t.s,e.ref=Nt(t.s),n.l+=16,e}function Mj(n,e){return e==null&&(e=me(36)),e.write_shift(4,n[1].iauthor),il(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Lj=Qn;function Ij(n){return On(n.slice(0,54))}function Pj(n){var e=bi(),t=[];return be(e,628),be(e,630),n.forEach(function(i){i[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),be(e,632,Ij(a.a)))})}),be(e,631),be(e,633),n.forEach(function(i){i[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var o={s:Nn(i[0]),e:Nn(i[0])};be(e,635,Mj([o,a])),a.t&&a.t.length>0&&be(e,637,F5(a)),be(e,636),delete a.iauthor})}),be(e,634),be(e,629),e.end()}function Bj(n,e){e.FullPaths.forEach(function(t,i){if(i!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Pt.utils.cfb_add(n,a,e.FileIndex[i].content)}})}var u_=["xlsb","xlsm","xlam","biff8","xla"],Fj=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,a,o,l){var u=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=e.c:--p,f?m+=e.r:--m,a+(u?"":"$")+Zn(p)+(f?"":"$")+Wn(m)}return function(a,o){return e=o,a.replace(n,t)}}(),Kp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Zp=function(){return function(e,t){return e.replace(Kp,function(i,a,o,l,u,f){var m=Vp(l)-(o?0:t.c),p=Wp(f)-(u?0:t.r),v=p==0?"":u?p+1:"["+p+"]",y=m==0?"":o?m+1:"["+m+"]";return a+"R"+v+"C"+y})}}();function Uj(n,e){return n.replace(Kp,function(t,i,a,o,l,u){return i+(a=="$"?a+o:Zn(Vp(o)+e.c))+(l=="$"?l+u:Wn(Wp(u)+e.r))})}function zj(n){return n.length!=1}function pn(n){n.l+=1}function ts(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function d_(n,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return f_(n);t.biff==12&&(i=4)}var a=n.read_shift(i),o=n.read_shift(i),l=ts(n),u=ts(n);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function f_(n){var e=ts(n),t=ts(n),i=n.read_shift(1),a=n.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function Hj(n,e,t){if(t.biff<8)return f_(n);var i=n.read_shift(t.biff==12?4:2),a=n.read_shift(t.biff==12?4:2),o=ts(n),l=ts(n);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function h_(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return Wj(n);var i=n.read_shift(t&&t.biff==12?4:2),a=ts(n);return{r:i,c:a[0],cRel:a[1],rRel:a[2]}}function Wj(n){var e=ts(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Vj(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Gj(n,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return Yj(n);var a=n.read_shift(i>=12?4:2),o=n.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function Yj(n){var e=n.read_shift(2),t=n.read_shift(1),i=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),a==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:a,rRel:i}}function Xj(n,e,t){var i=(n[n.l++]&96)>>5,a=d_(n,t.biff>=2&&t.biff<=5?6:8,t);return[i,a]}function $j(n,e,t){var i=(n[n.l++]&96)>>5,a=n.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:n.l+=12,o=6;break;case 12:o=12;break}var l=d_(n,o,t);return[i,a,l]}function qj(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function Kj(n,e,t){var i=(n[n.l++]&96)>>5,a=n.read_shift(2),o=8;if(t)switch(t.biff){case 5:n.l+=12,o=6;break;case 12:o=12;break}return n.l+=o,[i,a]}function Zj(n,e,t){var i=(n[n.l++]&96)>>5,a=Hj(n,e-1,t);return[i,a]}function Qj(n,e,t){var i=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[i]}function Fx(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function Jj(n,e,t){n.l+=2;for(var i=n.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=i;++o)a.push(n.read_shift(t&&t.biff==2?1:2));return a}function eD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function tD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(t&&t.biff==2?1:2)]}function nD(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function iD(n,e,t){var i=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[i]}function m_(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function aD(n){return n.read_shift(2),m_(n)}function rD(n){return n.read_shift(2),m_(n)}function sD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var a=h_(n,0,t);return[i,a]}function oD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var a=Gj(n,0,t);return[i,a]}function lD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var a=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var o=h_(n,0,t);return[i,a,o]}function cD(n,e,t){var i=(n[n.l]&96)>>5;n.l+=1;var a=n.read_shift(t&&t.biff<=3?1:2);return[cN[a],v_[a],i]}function uD(n,e,t){var i=n[n.l++],a=n.read_shift(1),o=t&&t.biff<=3?[i==88?-1:0,n.read_shift(1)]:dD(n);return[a,(o[0]===0?v_:lN)[o[1]]]}function dD(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function fD(n,e,t){n.l+=t&&t.biff==2?3:4}function hD(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),a=n.read_shift(t&&t.biff==2?1:2);return[i,a]}function mD(n){return n.l++,Zc[n.read_shift(1)]}function pD(n){return n.l++,n.read_shift(2)}function gD(n){return n.l++,n.read_shift(1)!==0}function vD(n){return n.l++,al(n)}function yD(n,e,t){return n.l++,KS(n,e-1,t)}function xD(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=lC(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=Zc[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=al(n);break;case 2:t[1]=fC(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function bD(n,e,t){for(var i=n.read_shift(t.biff==12?4:2),a=[],o=0;o!=i;++o)a.push((t.biff==12?$s:pC)(n));return a}function SD(n,e,t){var i=0,a=0;t.biff==12?(i=n.read_shift(4),a=n.read_shift(4)):(a=1+n.read_shift(1),i=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--a==0&&(a=256));for(var o=0,l=[];o!=i&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=xD(n,t.biff);return l}function _D(n,e,t){var i=n.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=n.read_shift(a);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,o]}function TD(n,e,t){if(t.biff==5)return wD(n);var i=n.read_shift(1)>>>5&3,a=n.read_shift(2),o=n.read_shift(4);return[i,a,o]}function wD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[e,t,i]}function ED(n,e,t){var i=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var a=n.read_shift(t&&t.biff==2?1:2);return[i,a]}function AD(n,e,t){var i=n.read_shift(1)>>>5&3,a=n.read_shift(t&&t.biff==2?1:2);return[i,a]}function kD(n,e,t){var i=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[i]}function CD(n,e,t){var i=(n[n.l++]&96)>>5,a=n.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return n.l+=o,[i,a]}var jD=Pa,DD=Pa,ND=Pa;function Qc(n,e,t){return n.l+=2,[Vj(n)]}function Qp(n){return n.l+=6,[]}var OD=Qc,RD=Qp,MD=Qp,LD=Qc;function p_(n){return n.l+=2,[$S(n),n.read_shift(2)&1]}var ID=Qc,PD=p_,BD=Qp,FD=Qc,UD=Qc,zD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function HD(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),i=n.read_shift(4),a=n.read_shift(2),o=n.read_shift(2),l=zD[t>>2&31];return{ixti:e,coltype:t&3,rt:l,idx:i,c:a,C:o}}function WD(n){return n.l+=2,[n.read_shift(4)]}function VD(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function GD(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function YD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function XD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function $D(n){return n.l+=4,[0,0]}var Ux={1:{n:"PtgExp",f:hD},2:{n:"PtgTbl",f:ND},3:{n:"PtgAdd",f:pn},4:{n:"PtgSub",f:pn},5:{n:"PtgMul",f:pn},6:{n:"PtgDiv",f:pn},7:{n:"PtgPower",f:pn},8:{n:"PtgConcat",f:pn},9:{n:"PtgLt",f:pn},10:{n:"PtgLe",f:pn},11:{n:"PtgEq",f:pn},12:{n:"PtgGe",f:pn},13:{n:"PtgGt",f:pn},14:{n:"PtgNe",f:pn},15:{n:"PtgIsect",f:pn},16:{n:"PtgUnion",f:pn},17:{n:"PtgRange",f:pn},18:{n:"PtgUplus",f:pn},19:{n:"PtgUminus",f:pn},20:{n:"PtgPercent",f:pn},21:{n:"PtgParen",f:pn},22:{n:"PtgMissArg",f:pn},23:{n:"PtgStr",f:yD},26:{n:"PtgSheet",f:VD},27:{n:"PtgEndSheet",f:GD},28:{n:"PtgErr",f:mD},29:{n:"PtgBool",f:gD},30:{n:"PtgInt",f:pD},31:{n:"PtgNum",f:vD},32:{n:"PtgArray",f:Qj},33:{n:"PtgFunc",f:cD},34:{n:"PtgFuncVar",f:uD},35:{n:"PtgName",f:_D},36:{n:"PtgRef",f:sD},37:{n:"PtgArea",f:Xj},38:{n:"PtgMemArea",f:ED},39:{n:"PtgMemErr",f:jD},40:{n:"PtgMemNoMem",f:DD},41:{n:"PtgMemFunc",f:AD},42:{n:"PtgRefErr",f:kD},43:{n:"PtgAreaErr",f:qj},44:{n:"PtgRefN",f:oD},45:{n:"PtgAreaN",f:Zj},46:{n:"PtgMemAreaN",f:YD},47:{n:"PtgMemNoMemN",f:XD},57:{n:"PtgNameX",f:TD},58:{n:"PtgRef3d",f:lD},59:{n:"PtgArea3d",f:$j},60:{n:"PtgRefErr3d",f:CD},61:{n:"PtgAreaErr3d",f:Kj},255:{}},qD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},KD={1:{n:"PtgElfLel",f:p_},2:{n:"PtgElfRw",f:FD},3:{n:"PtgElfCol",f:OD},6:{n:"PtgElfRwV",f:UD},7:{n:"PtgElfColV",f:LD},10:{n:"PtgElfRadical",f:ID},11:{n:"PtgElfRadicalS",f:BD},13:{n:"PtgElfColS",f:RD},15:{n:"PtgElfColSV",f:MD},16:{n:"PtgElfRadicalLel",f:PD},25:{n:"PtgList",f:HD},29:{n:"PtgSxName",f:WD},255:{}},ZD={0:{n:"PtgAttrNoop",f:$D},1:{n:"PtgAttrSemi",f:iD},2:{n:"PtgAttrIf",f:tD},4:{n:"PtgAttrChoose",f:Jj},8:{n:"PtgAttrGoto",f:eD},16:{n:"PtgAttrSum",f:fD},32:{n:"PtgAttrBaxcel",f:Fx},33:{n:"PtgAttrBaxcel",f:Fx},64:{n:"PtgAttrSpace",f:aD},65:{n:"PtgAttrSpaceSemi",f:rD},128:{n:"PtgAttrIfError",f:nD},255:{}};function QD(n,e,t,i){if(i.biff<8)return Pa(n,e);for(var a=n.l+e,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=SD(n,0,i),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=bD(n,t[l][1],i),o.push(t[l][2]);break;case"PtgExp":i&&i.biff==12&&(t[l][1][1]=n.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return e=a-n.l,e!==0&&o.push(Pa(n,e)),o}function JD(n,e,t){for(var i=n.l+e,a,o,l=[];i!=n.l;)e=i-n.l,o=n[n.l],a=Ux[o]||Ux[qD[o]],(o===24||o===25)&&(a=(o===24?KD:ZD)[n[n.l+1]]),!a||!a.f?Pa(n,e):l.push([a.n,a.f(n,e,t)]);return l}function eN(n){for(var e=[],t=0;t<n.length;++t){for(var i=n[t],a=[],o=0;o<i.length;++o){var l=i[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var tN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nN(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function g_(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!i)return"SH33TJSERR1";var a="";if(t.biff>8)switch(n[i[0]][0]){case 357:return a=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?a:a+":"+n.SheetNames[i[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[i[0]][0];case 355:default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return a=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?a:a+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return n[i[0]][0][3]?(a=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?a:a+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function zx(n,e,t){var i=g_(n,e,t);return i=="#REF"?i:nN(i,t)}function qo(n,e,t,i,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],f,m,p,v=0,y=0,S,_="";if(!n[0]||!n[0][0])return"";for(var x=-1,T="",w=0,E=n[0].length;w<E;++w){var C=n[0][w];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),m=u.pop(),x>=0){switch(n[0][x][1][0]){case 0:T=an(" ",n[0][x][1][1]);break;case 1:T=an("\r",n[0][x][1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}m=m+T,x=-1}u.push(m+tN[C[0]]+f);break;case"PtgIsect":f=u.pop(),m=u.pop(),u.push(m+" "+f);break;case"PtgUnion":f=u.pop(),m=u.pop(),u.push(m+","+f);break;case"PtgRange":f=u.pop(),m=u.pop(),u.push(m+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Ec(C[1][1],l,a),u.push(Ac(p,o));break;case"PtgRefN":p=t?Ec(C[1][1],t,a):C[1][1],u.push(Ac(p,o));break;case"PtgRef3d":v=C[1][1],p=Ec(C[1][2],l,a),_=zx(i,v,a),u.push(_+"!"+Ac(p,o));break;case"PtgFunc":case"PtgFuncVar":var N=C[1][0],A=C[1][1];N||(N=0),N&=127;var I=N==0?[]:u.slice(-N);u.length-=N,A==="User"&&(A=I.shift()),u.push(A+"("+I.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":S=Ex(C[1][1],t?{s:t}:l,a),u.push(Fm(S,a));break;case"PtgArea":S=Ex(C[1][1],l,a),u.push(Fm(S,a));break;case"PtgArea3d":v=C[1][1],S=C[1][2],_=zx(i,v,a),u.push(_+"!"+Fm(S,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var D=(i.names||[])[y-1]||(i[0]||[])[y],z=D?D.Name:"SH33TJSNAME"+String(y);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),u.push(z);break;case"PtgNameX":var L=C[1][1];y=C[1][2];var H;if(a.biff<=5)L<0&&(L=-L),i[L]&&(H=i[L][y]);else{var K="";if(((i[L]||[])[0]||[])[0]==14849||(((i[L]||[])[0]||[])[0]==1025?i[L][y]&&i[L][y].itab>0&&(K=i.SheetNames[i[L][y].itab-1]+"!"):K=i.SheetNames[y-1]+"!"),i[L]&&i[L][y])K+=i[L][y].Name;else if(i[0]&&i[0][y])K+=i[0][y].Name;else{var ne=(g_(i,L,a)||"").split(";;");ne[y-1]?K=ne[y-1]:K+="SH33TJSERRX"}u.push(K);break}H||(H={Name:"SH33TJSERRY"}),u.push(H.Name);break;case"PtgParen":var xe="(",He=")";if(x>=0){switch(T="",n[0][x][1][0]){case 2:xe=an(" ",n[0][x][1][1])+xe;break;case 3:xe=an("\r",n[0][x][1][1])+xe;break;case 4:He=an(" ",n[0][x][1][1])+He;break;case 5:He=an("\r",n[0][x][1][1])+He;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}u.push(xe+u.pop()+He);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var _e={c:t.c,r:t.r};if(i.sharedf[Nt(p)]){var ie=i.sharedf[Nt(p)];u.push(qo(ie,l,_e,i,a))}else{var he=!1;for(f=0;f!=i.arrayf.length;++f)if(m=i.arrayf[f],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(qo(m[1],l,_e,i,a)),he=!0;break}he||u.push(C[1])}break;case"PtgArray":u.push("{"+eN(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&Ne.indexOf(n[0][w][0])==-1){C=n[0][x];var Be=!0;switch(C[1][0]){case 4:Be=!1;case 0:T=an(" ",C[1][1]);break;case 5:Be=!1;case 1:T=an("\r",C[1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((Be?T:"")+u.pop()+(Be?"":T)),x=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function iN(n){if(n==null){var e=me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Hs(n);return Hs(0)}function aN(n,e,t,i,a){var o=Ws(e,t,a),l=iN(n.v),u=me(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var m=me(n.bf.length),p=0;p<n.bf.length;++p)m[p]=n.bf[p];var v=zn([o,l,u,m]);return v}function vf(n,e,t){var i=n.read_shift(4),a=JD(n,i,t),o=n.read_shift(4),l=o>0?QD(n,o,a,t):null;return[a,l]}var rN=vf,yf=vf,sN=vf,oN=vf,lN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},v_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uN(n){var e="of:="+n.replace(Kp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function dN(n){return n.replace(/\./,"!")}var kc=typeof Map<"u";function Jp(n,e,t){var i=0,a=n.length;if(t){if(kc?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var o=kc?t.get(e):t[e];i<o.length;++i)if(n[o[i]].t===e)return n.Count++,o[i]}}else for(;i<a;++i)if(n[i].t===e)return n.Count++,i;return n[a]={t:e},n.Count++,n.Unique++,t&&(kc?(t.has(e)||t.set(e,[]),t.get(e).push(a)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(a))),a}function xf(n,e){var t={min:n+1,max:n+1},i=-1;return e.MDW&&(dr=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?i=ef(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(t.width=sp(i),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function y_(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function as(n,e,t){var i=t.revssf[e.z!=null?e.z:"General"],a=60,o=n.length;if(i==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){hS(e.z,a),t.ssf[a]=e.z,t.revssf[e.z]=i=a;break}}for(a=0;a!=o;++a)if(n[a].numFmtId===i)return a;return n[o]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function fN(n,e,t){if(n&&n["!ref"]){var i=Vt(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function hN(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+gn(n[t])+'"/>';return e+"</mergeCells>"}function mN(n,e,t,i,a){var o=!1,l={},u=null;if(i.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[t];try{e.Workbook&&(f=e.Workbook.Sheets[t].CodeName||f)}catch{}o=!0,l.codeName=Fc(Dt(f))}if(n&&n["!outline"]){var m={summaryBelow:1,summaryRight:1};n["!outline"].above&&(m.summaryBelow=0),n["!outline"].left&&(m.summaryRight=0),u=(u||"")+je("outlinePr",null,m)}!o&&!u||(a[a.length]=je("sheetPr",u,l))}var pN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gN=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vN(n){var e={sheet:1};return pN.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),gN.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=t_(n.password).toString(16).toUpperCase()),je("sheetProtection",null,e)}function yN(n){return y_(n),je("pageMargins",null,n)}function xN(n,e){for(var t=["<cols>"],i,a=0;a!=e.length;++a)(i=e[a])&&(t[t.length]=je("col",null,xf(a,i)));return t[t.length]="</cols>",t.join("")}function bN(n,e,t,i){var a=typeof n.ref=="string"?n.ref:gn(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=Fi(a);l.s.r==l.e.r&&(l.e.r=Fi(e["!ref"]).e.r,a=gn(l));for(var u=0;u<o.length;++u){var f=o[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref="'"+t.SheetNames[i]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+a}),je("autoFilter",null,{ref:a})}function SN(n,e,t,i){var a={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),je("sheetViews",je("sheetView",null,a),{})}function _N(n,e,t,i){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var a="",o=n.t,l=n.v;if(n.t!=="z")switch(n.t){case"b":a=n.v?"1":"0";break;case"n":a=""+n.v;break;case"e":a=Zc[n.v];break;case"d":i&&i.cellDates?a=oi(n.v,-1).toISOString():(n=Ti(n),n.t="n",a=""+(n.v=_i(oi(n.v)))),typeof n.z>"u"&&(n.z=sn[14]);break;default:a=n.v;break}var u=Hn("v",Dt(a)),f={r:e},m=as(i.cellXfs,n,i);switch(m!==0&&(f.s=m),n.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){u=Hn("v",""+Jp(i.Strings,n.v,i.revStrings)),f.t="s";break}f.t="str";break}if(n.t!=o&&(n.t=o,n.v=l),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;u=je("f",Dt(n.f),p)+(n.v!=null?u:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(f.cm=1),je("c",u,f)}function TN(n,e,t,i){var a=[],o=[],l=Vt(n["!ref"]),u="",f,m="",p=[],v=0,y=0,S=n["!rows"],_=Array.isArray(n),x={r:m},T,w=-1;for(y=l.s.c;y<=l.e.c;++y)p[y]=Zn(y);for(v=l.s.r;v<=l.e.r;++v){for(o=[],m=Wn(v),y=l.s.c;y<=l.e.c;++y){f=p[y]+m;var E=_?(n[v]||[])[y]:n[f];E!==void 0&&(u=_N(E,f,n,e))!=null&&o.push(u)}(o.length>0||S&&S[v])&&(x={r:m},S&&S[v]&&(T=S[v],T.hidden&&(x.hidden=1),w=-1,T.hpx?w=tf(T.hpx):T.hpt&&(w=T.hpt),w>-1&&(x.ht=w,x.customHeight=1),T.level&&(x.outlineLevel=T.level)),a[a.length]=je("row",o.join(""),x))}if(S)for(;v<S.length;++v)S&&S[v]&&(x={r:v+1},T=S[v],T.hidden&&(x.hidden=1),w=-1,T.hpx?w=tf(T.hpx):T.hpt&&(w=T.hpt),w>-1&&(x.ht=w,x.customHeight=1),T.level&&(x.outlineLevel=T.level),a[a.length]=je("row","",x));return a.join("")}function x_(n,e,t,i){var a=[vn,je("worksheet",null,{xmlns:tl[0],"xmlns:r":Dn.r})],o=t.SheetNames[n],l=0,u="",f=t.Sheets[o];f==null&&(f={});var m=f["!ref"]||"A1",p=Vt(m);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),m=gn(p)}i||(i={}),f["!comments"]=[];var v=[];mN(f,t,n,e,a),a[a.length]=je("dimension",null,{ref:m}),a[a.length]=SN(f,e,n,t),e.sheetFormat&&(a[a.length]=je("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=xN(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=TN(f,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=vN(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=bN(f["!autofilter"],f,t,n)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=hN(f["!merges"]));var y=-1,S,_=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(x){x[1].Target&&(S={ref:x[0]},x[1].Target.charAt(0)!="#"&&(_=Ct(i,-1,Dt(x[1].Target).replace(/#.*$/,""),bt.HLINK),S["r:id"]="rId"+_),(y=x[1].Target.indexOf("#"))>-1&&(S.location=Dt(x[1].Target.slice(y+1))),x[1].Tooltip&&(S.tooltip=Dt(x[1].Tooltip)),a[a.length]=je("hyperlink",null,S))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=yN(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Hn("ignoredErrors",je("ignoredError",null,{numberStoredAsText:1,sqref:m}))),v.length>0&&(_=Ct(i,-1,"../drawings/drawing"+(n+1)+".xml",bt.DRAW),a[a.length]=je("drawing",null,{"r:id":"rId"+_}),f["!drawing"]=v),f["!comments"].length>0&&(_=Ct(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",bt.VML),a[a.length]=je("legacyDrawing",null,{"r:id":"rId"+_}),f["!legacy"]=_),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function wN(n,e){var t={},i=n.l+e;t.r=n.read_shift(4),n.l+=4;var a=n.read_shift(2);n.l+=1;var o=n.read_shift(1);return n.l=i,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}function EN(n,e,t){var i=me(145),a=(t["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var o=320;a.hpx?o=tf(a.hpx)*20:a.hpt&&(o=a.hpt*20),i.write_shift(2,o),i.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),i.write_shift(1,l),i.write_shift(1,0);var u=0,f=i.l;i.l+=4;for(var m={r:n,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,y=-1,S=p<<10;S<p+1<<10;++S){m.c=S;var _=Array.isArray(t)?(t[m.r]||[])[m.c]:t[Nt(m)];_&&(v<0&&(v=S),y=S)}v<0||(++u,i.write_shift(4,v),i.write_shift(4,y))}var x=i.l;return i.l=f,i.write_shift(4,u),i.l=x,i.length>i.l?i.slice(0,i.l):i}function AN(n,e,t,i){var a=EN(i,t,e);(a.length>17||(e["!rows"]||[])[i])&&be(n,0,a)}var kN=$s,CN=il;function jN(){}function DN(n,e){var t={},i=n[n.l];return++n.l,t.above=!(i&64),t.left=!(i&128),n.l+=18,t.name=U5(n),t}function NN(n,e,t){t==null&&(t=me(84+4*n.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),t.write_shift(1,i);for(var a=1;a<3;++a)t.write_shift(1,0);return Zd({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),MS(n,t),t.slice(0,t.l)}function ON(n){var e=aa(n);return[e]}function RN(n,e,t){return t==null&&(t=me(8)),Gs(e,t)}function MN(n){var e=Ys(n);return[e]}function LN(n,e,t){return t==null&&(t=me(4)),Xs(e,t)}function IN(n){var e=aa(n),t=n.read_shift(1);return[e,t,"b"]}function PN(n,e,t){return t==null&&(t=me(9)),Gs(e,t),t.write_shift(1,n.v?1:0),t}function BN(n){var e=Ys(n),t=n.read_shift(1);return[e,t,"b"]}function FN(n,e,t){return t==null&&(t=me(5)),Xs(e,t),t.write_shift(1,n.v?1:0),t}function UN(n){var e=aa(n),t=n.read_shift(1);return[e,t,"e"]}function zN(n,e,t){return t==null&&(t=me(9)),Gs(e,t),t.write_shift(1,n.v),t}function HN(n){var e=Ys(n),t=n.read_shift(1);return[e,t,"e"]}function WN(n,e,t){return t==null&&(t=me(8)),Xs(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function VN(n){var e=aa(n),t=n.read_shift(4);return[e,t,"s"]}function GN(n,e,t){return t==null&&(t=me(12)),Gs(e,t),t.write_shift(4,e.v),t}function YN(n){var e=Ys(n),t=n.read_shift(4);return[e,t,"s"]}function XN(n,e,t){return t==null&&(t=me(8)),Xs(e,t),t.write_shift(4,e.v),t}function $N(n){var e=aa(n),t=al(n);return[e,t,"n"]}function qN(n,e,t){return t==null&&(t=me(16)),Gs(e,t),Hs(n.v,t),t}function KN(n){var e=Ys(n),t=al(n);return[e,t,"n"]}function ZN(n,e,t){return t==null&&(t=me(12)),Xs(e,t),Hs(n.v,t),t}function QN(n){var e=aa(n),t=LS(n);return[e,t,"n"]}function JN(n,e,t){return t==null&&(t=me(12)),Gs(e,t),IS(n.v,t),t}function eO(n){var e=Ys(n),t=LS(n);return[e,t,"n"]}function tO(n,e,t){return t==null&&(t=me(8)),Xs(e,t),IS(n.v,t),t}function nO(n){var e=aa(n),t=Gp(n);return[e,t,"is"]}function iO(n){var e=aa(n),t=Qn(n);return[e,t,"str"]}function aO(n,e,t){return t==null&&(t=me(12+4*n.v.length)),Gs(e,t),On(n.v,t),t.length>t.l?t.slice(0,t.l):t}function rO(n){var e=Ys(n),t=Qn(n);return[e,t,"str"]}function sO(n,e,t){return t==null&&(t=me(8+4*n.v.length)),Xs(e,t),On(n.v,t),t.length>t.l?t.slice(0,t.l):t}function oO(n,e,t){var i=n.l+e,a=aa(n);a.r=t["!row"];var o=n.read_shift(1),l=[a,o,"b"];if(t.cellFormula){n.l+=2;var u=yf(n,i-n.l,t);l[3]=qo(u,null,a,t.supbooks,t)}else n.l=i;return l}function lO(n,e,t){var i=n.l+e,a=aa(n);a.r=t["!row"];var o=n.read_shift(1),l=[a,o,"e"];if(t.cellFormula){n.l+=2;var u=yf(n,i-n.l,t);l[3]=qo(u,null,a,t.supbooks,t)}else n.l=i;return l}function cO(n,e,t){var i=n.l+e,a=aa(n);a.r=t["!row"];var o=al(n),l=[a,o,"n"];if(t.cellFormula){n.l+=2;var u=yf(n,i-n.l,t);l[3]=qo(u,null,a,t.supbooks,t)}else n.l=i;return l}function uO(n,e,t){var i=n.l+e,a=aa(n);a.r=t["!row"];var o=Qn(n),l=[a,o,"str"];if(t.cellFormula){n.l+=2;var u=yf(n,i-n.l,t);l[3]=qo(u,null,a,t.supbooks,t)}else n.l=i;return l}var dO=$s,fO=il;function hO(n,e){return e==null&&(e=me(4)),e.write_shift(4,n),e}function mO(n,e){var t=n.l+e,i=$s(n),a=Yp(n),o=Qn(n),l=Qn(n),u=Qn(n);n.l=t;var f={rfx:i,relId:a,loc:o,display:u};return l&&(f.Tooltip=l),f}function pO(n,e){var t=me(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));il({s:Nn(n[0]),e:Nn(n[0])},t),Xp("rId"+e,t);var i=n[1].Target.indexOf("#"),a=i==-1?"":n[1].Target.slice(i+1);return On(a||"",t),On(n[1].Tooltip||"",t),On("",t),t.slice(0,t.l)}function gO(){}function vO(n,e,t){var i=n.l+e,a=PS(n),o=n.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var u=rN(n,i-n.l,t);l[1]=u}else n.l=i;return l}function yO(n,e,t){var i=n.l+e,a=$s(n),o=[a];if(t.cellFormula){var l=oN(n,i-n.l,t);o[1]=l,n.l=i}else n.l=i;return o}function xO(n,e,t){t==null&&(t=me(18));var i=xf(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof i.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),t.write_shift(2,a),t}var b_=["left","right","top","bottom","header","footer"];function bO(n){var e={};return b_.forEach(function(t){e[t]=al(n)}),e}function SO(n,e){return e==null&&(e=me(6*8)),y_(n),b_.forEach(function(t){Hs(n[t],e)}),e}function _O(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function TO(n,e,t){t==null&&(t=me(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function wO(n){var e=me(24);return e.write_shift(4,4),e.write_shift(4,1),il(n,e),e}function EO(n,e){return e==null&&(e=me(16*4+2)),e.write_shift(2,n.password?t_(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function AO(){}function kO(){}function CO(n,e,t,i,a,o,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=Ti(e),e.z=e.z||sn[14],e.v=_i(oi(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r:t,c:i};switch(f.s=as(a.cellXfs,e,a),e.l&&o["!links"].push([Nt(f),e.l]),e.c&&o["!comments"].push([Nt(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=Jp(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,l?be(n,18,XN(e,f)):be(n,7,GN(e,f))):(f.t="str",l?be(n,17,sO(e,f)):be(n,6,aO(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?be(n,13,tO(e,f)):be(n,2,JN(e,f)):l?be(n,16,ZN(e,f)):be(n,5,qN(e,f)),!0;case"b":return f.t="b",l?be(n,15,FN(e,f)):be(n,4,PN(e,f)),!0;case"e":return f.t="e",l?be(n,14,WN(e,f)):be(n,3,zN(e,f)),!0}return l?be(n,12,LN(e,f)):be(n,1,RN(e,f)),!0}function jO(n,e,t,i){var a=Vt(e["!ref"]||"A1"),o,l="",u=[];be(n,145);var f=Array.isArray(e),m=a.e.r;e["!rows"]&&(m=Math.max(a.e.r,e["!rows"].length-1));for(var p=a.s.r;p<=m;++p){l=Wn(p),AN(n,e,a,p);var v=!1;if(p<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){p===a.s.r&&(u[y]=Zn(y)),o=u[y]+l;var S=f?(e[p]||[])[y]:e[o];if(!S){v=!1;continue}v=CO(n,S,p,y,i,e,v)}}be(n,146)}function DO(n,e){!e||!e["!merges"]||(be(n,177,hO(e["!merges"].length)),e["!merges"].forEach(function(t){be(n,176,fO(t))}),be(n,178))}function NO(n,e){!e||!e["!cols"]||(be(n,390),e["!cols"].forEach(function(t,i){t&&be(n,60,xO(i,t))}),be(n,391))}function OO(n,e){!e||!e["!ref"]||(be(n,648),be(n,649,wO(Vt(e["!ref"]))),be(n,650))}function RO(n,e,t){e["!links"].forEach(function(i){if(i[1].Target){var a=Ct(t,-1,i[1].Target.replace(/#.*$/,""),bt.HLINK);be(n,494,pO(i,a))}}),delete e["!links"]}function MO(n,e,t,i){if(e["!comments"].length>0){var a=Ct(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",bt.VML);be(n,551,Xp("rId"+a)),e["!legacy"]=a}}function LO(n,e,t,i){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:gn(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,u=Fi(o);u.s.r==u.e.r&&(u.e.r=Fi(e["!ref"]).e.r,o=gn(u));for(var f=0;f<l.length;++f){var m=l[f];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==i){m.Ref="'"+t.SheetNames[i]+"'!"+o;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+o}),be(n,161,il(Vt(o))),be(n,162)}}function IO(n,e,t){be(n,133),be(n,137,TO(e,t)),be(n,138),be(n,134)}function PO(n,e){e["!protect"]&&be(n,535,EO(e["!protect"]))}function BO(n,e,t,i){var a=bi(),o=t.SheetNames[n],l=t.Sheets[o]||{},u=o;try{t&&t.Workbook&&(u=t.Workbook.Sheets[n].CodeName||u)}catch{}var f=Vt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],be(a,129),(t.vbaraw||l["!outline"])&&be(a,147,NN(u,l["!outline"])),be(a,148,CN(f)),IO(a,l,t.Workbook),NO(a,l),jO(a,l,n,e),PO(a,l),LO(a,l,t,n),DO(a,l),RO(a,l,i),l["!margins"]&&be(a,476,SO(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&OO(a,l),MO(a,l,n,i),be(a,130),a.end()}function FO(n,e){n.l+=10;var t=Qn(n);return{name:t}}var UO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function zO(n){return!n.Workbook||!n.Workbook.WBProps?"false":y5(n.Workbook.WBProps.date1904)?"true":"false"}var HO="][*?/\\".split("");function S_(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return HO.forEach(function(i){if(n.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function WO(n,e,t){n.forEach(function(i,a){S_(i);for(var o=0;o<a;++o)if(i==n[o])throw new Error("Duplicate Sheet Name: "+i);if(t){var l=e&&e[a]&&e[a].CodeName||i;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function VO(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];WO(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)fN(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function __(n){var e=[vn];e[e.length]=je("workbook",null,{xmlns:tl[0],"xmlns:r":Dn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(UO.forEach(function(u){n.Workbook.WBProps[u[0]]!=null&&n.Workbook.WBProps[u[0]]!=u[1]&&(i[u[0]]=n.Workbook.WBProps[u[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=je("workbookPr",null,i);var a=n.Workbook&&n.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=n.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==n.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=n.SheetNames.length;++o){var l={name:Dt(n.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=je("sheet",null,l)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=je("definedName",Dt(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function GO(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=rp(n),t.name=Qn(n),t}function YO(n,e){return e||(e=me(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),Xp(n.strRelID,e),On(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function XO(n,e){var t={},i=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var a=e>8?Qn(n):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function $O(n,e){e||(e=me(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),MS(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function qO(n,e,t){var i=n.l+e;n.l+=4,n.l+=1;var a=n.read_shift(4),o=z5(n),l=sN(n,0,t),u=Yp(n);n.l=i;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function KO(n,e){be(n,143);for(var t=0;t!=e.SheetNames.length;++t){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,a={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};be(n,156,YO(a))}be(n,144)}function ZO(n,e){e||(e=me(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return On("SheetJS",e),On(Wd.version,e),On(Wd.version,e),On("7262",e),e.length>e.l?e.slice(0,e.l):e}function QO(n,e){e||(e=me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function JO(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,i=0,a=-1,o=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&a==-1?a=i:t[i].Hidden==1&&o==-1&&(o=i);o>a||(be(n,135),be(n,158,QO(a)),be(n,136))}}function eR(n,e){var t=bi();return be(t,131),be(t,128,ZO()),be(t,153,$O(n.Workbook&&n.Workbook.WBProps||null)),JO(t,n),KO(t,n),be(t,132),t.end()}function tR(n,e,t){return(e.slice(-4)===".bin"?eR:__)(n)}function nR(n,e,t,i,a){return(e.slice(-4)===".bin"?BO:x_)(n,t,i,a)}function iR(n,e,t){return(e.slice(-4)===".bin"?Sj:a_)(n,t)}function aR(n,e,t){return(e.slice(-4)===".bin"?$C:e_)(n,t)}function rR(n,e,t){return(e.slice(-4)===".bin"?Pj:c_)(n)}function sR(n){return(n.slice(-4)===".bin"?jj:o_)()}function oR(n,e){var t=[];return n.Props&&t.push(iC(n.Props,e)),n.Custprops&&t.push(aC(n.Props,n.Custprops)),t.join("")}function lR(){return""}function cR(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,a){var o=[];o.push(je("NumberFormat",null,{"ss:Format":Dt(sn[i.numFmtId])}));var l={"ss:ID":"s"+(21+a)};t.push(je("Style",o.join(""),l))}),je("Styles",t.join(""))}function T_(n){return je("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Zp(n.Ref,{r:0,c:0})})}function uR(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],i=0;i<e.length;++i){var a=e[i];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(T_(a)))}return je("Names",t.join(""))}function dR(n,e,t,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var a=i.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==t&&(u.Name.match(/^_xlfn\./)||o.push(T_(u)))}return o.join("")}function fR(n,e,t,i){if(!n)return"";var a=[];if(n["!margins"]&&(a.push("<PageSetup>"),n["!margins"].header&&a.push(je("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&a.push(je("Footer",null,{"x:Margin":n["!margins"].footer})),a.push(je("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),a.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)a.push(je("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(i.Workbook.Sheets[o]&&!i.Workbook.Sheets[o].Hidden);++o);o==t&&a.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),n["!protect"]&&(a.push(Hn("ProtectContents","True")),n["!protect"].objects&&a.push(Hn("ProtectObjects","True")),n["!protect"].scenarios&&a.push(Hn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?a.push(Hn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&a.push(Hn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){n["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":je("WorksheetOptions",a.join(""),{xmlns:Pi.x})}function hR(n){return n.map(function(e){var t=v5(e.t||""),i=je("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return je("Comment",i,{"ss:Author":e.a})}).join("")}function mR(n,e,t,i,a,o,l){if(!n||n.v==null&&n.f==null)return"";var u={};if(n.f&&(u["ss:Formula"]="="+Dt(Zp(n.f,l))),n.F&&n.F.slice(0,e.length)==e){var f=Nn(n.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(n.l&&n.l.Target&&(u["ss:HRef"]=Dt(n.l.Target),n.l.Tooltip&&(u["x:HRefScreenTip"]=Dt(n.l.Tooltip))),t["!merges"])for(var m=t["!merges"],p=0;p!=m.length;++p)m[p].s.c!=l.c||m[p].s.r!=l.r||(m[p].e.c>m[p].s.c&&(u["ss:MergeAcross"]=m[p].e.c-m[p].s.c),m[p].e.r>m[p].s.r&&(u["ss:MergeDown"]=m[p].e.r-m[p].s.r));var v="",y="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":v="Number",y=String(n.v);break;case"b":v="Boolean",y=n.v?"1":"0";break;case"e":v="Error",y=Zc[n.v];break;case"d":v="DateTime",y=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||sn[14]);break;case"s":v="String",y=g5(n.v||"");break}var S=as(i.cellXfs,n,i);u["ss:StyleID"]="s"+(21+S),u["ss:Index"]=l.c+1;var _=n.v!=null?y:"",x=n.t=="z"?"":'<Data ss:Type="'+v+'">'+_+"</Data>";return(n.c||[]).length>0&&(x+=hR(n.c)),je("Cell",x,u)}function pR(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=i_(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function gR(n,e,t,i){if(!n["!ref"])return"";var a=Vt(n["!ref"]),o=n["!merges"]||[],l=0,u=[];n["!cols"]&&n["!cols"].forEach(function(T,w){qp(T);var E=!!T.width,C=xf(w,T),N={"ss:Index":w+1};E&&(N["ss:Width"]=Jd(C.width)),T.hidden&&(N["ss:Hidden"]="1"),u.push(je("Column",null,N))});for(var f=Array.isArray(n),m=a.s.r;m<=a.e.r;++m){for(var p=[pR(m,(n["!rows"]||[])[m])],v=a.s.c;v<=a.e.c;++v){var y=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>m)&&!(o[l].e.c<v)&&!(o[l].e.r<m)){(o[l].s.c!=v||o[l].s.r!=m)&&(y=!0);break}if(!y){var S={r:m,c:v},_=Nt(S),x=f?(n[m]||[])[v]:n[_];p.push(mR(x,_,n,e,t,i,S))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function vR(n,e,t){var i=[],a=t.SheetNames[n],o=t.Sheets[a],l=o?dR(o,e,n,t):"";return l.length>0&&i.push("<Names>"+l+"</Names>"),l=o?gR(o,e,n,t):"",l.length>0&&i.push("<Table>"+l+"</Table>"),i.push(fR(o,e,n,t)),i.join("")}function yR(n,e){e||(e={}),n.SSF||(n.SSF=Ti(sn)),n.SSF&&(mf(),hf(n.SSF),e.revssf=pf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],as(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(oR(n,e)),t.push(lR()),t.push(""),t.push("");for(var i=0;i<n.SheetNames.length;++i)t.push(je("Worksheet",vR(i,e,n),{"ss:Name":Dt(n.SheetNames[i])}));return t[2]=cR(n,e),t[3]=uR(n),vn+je("Workbook",t.join(""),{xmlns:Pi.ss,"xmlns:o":Pi.o,"xmlns:x":Pi.x,"xmlns:ss":Pi.ss,"xmlns:dt":Pi.dt,"xmlns:html":Pi.html})}var Hm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xR(n,e){var t=[],i=[],a=[],o=0,l,u=mx(kx,"n"),f=mx(Cx,"n");if(n.Props)for(l=Vn(n.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?t:Object.prototype.hasOwnProperty.call(f,l[o])?i:a).push([l[o],n.Props[l[o]]]);if(n.Custprops)for(l=Vn(n.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(n.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?t:Object.prototype.hasOwnProperty.call(f,l[o])?i:a).push([l[o],n.Custprops[l[o]]]);var m=[];for(o=0;o<a.length;++o)XS.indexOf(a[o][0])>-1||VS.indexOf(a[o][0])>-1||a[o][1]!=null&&m.push(a[o]);i.length&&Pt.utils.cfb_add(e,"/SummaryInformation",Rx(i,Hm.SI,f,Cx)),(t.length||m.length)&&Pt.utils.cfb_add(e,"/DocumentSummaryInformation",Rx(t,Hm.DSI,u,kx,m.length?m:null,Hm.UDI))}function bR(n,e){var t=e||{},i=Pt.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Pt.utils.cfb_add(i,a,w_(n,t)),t.biff==8&&(n.Props||n.Custprops)&&xR(n,i),t.biff==8&&n.vbaraw&&Bj(i,Pt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var SR={0:{f:wN},1:{f:ON},2:{f:QN},3:{f:UN},4:{f:IN},5:{f:$N},6:{f:iO},7:{f:VN},8:{f:uO},9:{f:cO},10:{f:oO},11:{f:lO},12:{f:MN},13:{f:eO},14:{f:HN},15:{f:BN},16:{f:KN},17:{f:rO},18:{f:YN},19:{f:Gp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:qO},40:{},42:{},43:{f:ij},44:{f:tj},45:{f:sj},46:{f:lj},47:{f:oj},48:{},49:{f:M5},50:{},51:{f:wj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:LC},62:{f:nO},63:{f:Dj},64:{f:AO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_O},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DN},148:{f:kN,p:16},151:{f:gO},152:{},153:{f:XO},154:{},155:{},156:{f:GO},157:{},158:{},159:{T:1,f:GC},160:{T:-1},161:{T:1,f:$s},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_j},336:{T:-1},337:{f:kj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:rp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vO},427:{f:yO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:mO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:rp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Lj},633:{T:1},634:{T:-1},635:{T:1,f:Rj},636:{T:-1},637:{f:B5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function De(n,e,t,i){var a=e;if(!isNaN(a)){var o=i||(t||[]).length||0,l=n.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&Hp(t)&&n.push(t)}}function _R(n,e,t,i){var a=(t||[]).length||0;if(a<=8224)return De(n,e,t,a);var o=e;if(!isNaN(o)){for(var l=t.parts||[],u=0,f=0,m=0;m+(l[u]||8224)<=8224;)m+=l[u]||8224,u++;var p=n.next(4);for(p.write_shift(2,o),p.write_shift(2,m),n.push(t.slice(f,f+m)),f+=m;f<a;){for(p=n.next(4),p.write_shift(2,60),m=0;m+(l[u]||8224)<=8224;)m+=l[u]||8224,u++;p.write_shift(2,m),n.push(t.slice(f,f+m)),f+=m}}}function Jc(n,e,t){return n||(n=me(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function TR(n,e,t,i){var a=me(9);return Jc(a,n,e),qS(t,i||"b",a),a}function wR(n,e,t){var i=me(8+2*t.length);return Jc(i,n,e),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function ER(n,e,t,i){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?_i(oi(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?De(n,2,FC(t,i,a)):De(n,3,BC(t,i,a));return;case"b":case"e":De(n,5,TR(t,i,e.v,e.t));return;case"s":case"str":De(n,4,wR(t,i,(e.v||"").slice(0,255)));return}De(n,1,Jc(null,t,i))}function AR(n,e,t,i){var a=Array.isArray(e),o=Vt(e["!ref"]||"A1"),l,u="",f=[];if(o.e.c>255||o.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=gn(o)}for(var m=o.s.r;m<=o.e.r;++m){u=Wn(m);for(var p=o.s.c;p<=o.e.c;++p){m===o.s.r&&(f[p]=Zn(p)),l=f[p]+u;var v=a?(e[m]||[])[p]:e[l];v&&ER(n,v,m,p)}}}function kR(n,e){for(var t=e||{},i=bi(),a=0,o=0;o<n.SheetNames.length;++o)n.SheetNames[o]==t.sheet&&(a=o);if(a==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return De(i,t.biff==4?1033:t.biff==3?521:9,$p(n,16,t)),AR(i,n.Sheets[n.SheetNames[a]],a,t),De(i,10),i.end()}function CR(n,e,t){De(n,49,SC({sz:12,name:"Arial"},t))}function jR(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var a=i[0];a<=i[1];++a)e[a]!=null&&De(n,1054,wC(a,e[a],t))})}function DR(n,e){var t=me(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),De(n,2151,t),t=me(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),QS(Vt(e["!ref"]||"A1"),t),t.write_shift(4,4),De(n,2152,t)}function NR(n,e){for(var t=0;t<16;++t)De(n,224,Lx({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){De(n,224,Lx(i,0,e))})}function OR(n,e){for(var t=0;t<e["!links"].length;++t){var i=e["!links"][t];De(n,440,OC(i)),i[1].Tooltip&&De(n,2048,RC(i))}delete e["!links"]}function RR(n,e){if(e){var t=0;e.forEach(function(i,a){++t<=256&&i&&De(n,125,IC(xf(a,i),a))})}}function MR(n,e,t,i,a){var o=16+as(a.cellXfs,e,a);if(e.v==null&&!e.bf){De(n,513,Ws(t,i,o));return}if(e.bf)De(n,6,aN(e,t,i,a,o));else switch(e.t){case"d":case"n":var l=e.t=="d"?_i(oi(e.v)):e.v;De(n,515,CC(t,i,l,o));break;case"b":case"e":De(n,517,kC(t,i,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var u=Jp(a.Strings,e.v,a.revStrings);De(n,253,_C(t,i,u,o))}else De(n,516,TC(t,i,(e.v||"").slice(0,255),o,a));break;default:De(n,513,Ws(t,i,o))}}function LR(n,e,t){var i=bi(),a=t.SheetNames[n],o=t.Sheets[a]||{},l=(t||{}).Workbook||{},u=(l.Sheets||[])[n]||{},f=Array.isArray(o),m=e.biff==8,p,v="",y=[],S=Vt(o["!ref"]||"A1"),_=m?65536:16384;if(S.e.c>255||S.e.r>=_){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,_-1)}De(i,2057,$p(t,16,e)),De(i,13,ea(1)),De(i,12,ea(100)),De(i,15,si(!0)),De(i,17,si(!1)),De(i,16,Hs(.001)),De(i,95,si(!0)),De(i,42,si(!1)),De(i,43,si(!1)),De(i,130,ea(1)),De(i,128,AC()),De(i,131,si(!1)),De(i,132,si(!1)),m&&RR(i,o["!cols"]),De(i,512,EC(S,e)),m&&(o["!links"]=[]);for(var x=S.s.r;x<=S.e.r;++x){v=Wn(x);for(var T=S.s.c;T<=S.e.c;++T){x===S.s.r&&(y[T]=Zn(T)),p=y[T]+v;var w=f?(o[x]||[])[T]:o[p];w&&(MR(i,w,x,T,e),m&&w.l&&o["!links"].push([p,w.l]))}}var E=u.CodeName||u.name||a;return m&&De(i,574,bC((l.Views||[])[0])),m&&(o["!merges"]||[]).length&&De(i,229,NC(o["!merges"])),m&&OR(i,o),De(i,442,ZS(E)),m&&DR(i,o),De(i,10),i.end()}function IR(n,e,t){var i=bi(),a=(n||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=t.biff==8,f=t.biff==5;if(De(i,2057,$p(n,5,t)),t.bookType=="xla"&&De(i,135),De(i,225,u?ea(1200):null),De(i,193,oC(2)),f&&De(i,191),f&&De(i,192),De(i,226),De(i,92,gC("SheetJS",t)),De(i,66,ea(u?1200:1252)),u&&De(i,353,ea(0)),u&&De(i,448),De(i,317,PC(n.SheetNames.length)),u&&n.vbaraw&&De(i,211),u&&n.vbaraw){var m=l.CodeName||"ThisWorkbook";De(i,442,ZS(m))}De(i,156,ea(17)),De(i,25,si(!1)),De(i,18,si(!1)),De(i,19,ea(0)),u&&De(i,431,si(!1)),u&&De(i,444,ea(0)),De(i,61,xC()),De(i,64,si(!1)),De(i,141,ea(0)),De(i,34,si(zO(n)=="true")),De(i,14,si(!0)),u&&De(i,439,si(!1)),De(i,218,ea(0)),CR(i,n,t),jR(i,n.SSF,t),NR(i,t),u&&De(i,352,si(!1));var p=i.end(),v=bi();u&&De(v,140,MC()),u&&t.Strings&&_R(v,252,yC(t.Strings)),De(v,10);var y=v.end(),S=bi(),_=0,x=0;for(x=0;x<n.SheetNames.length;++x)_+=(u?12:11)+(u?2:1)*n.SheetNames[x].length;var T=p.length+_+y.length;for(x=0;x<n.SheetNames.length;++x){var w=o[x]||{};De(S,133,vC({pos:T,hs:w.Hidden||0,dt:0,name:n.SheetNames[x]},t)),T+=e[x].length}var E=S.end();if(_!=E.length)throw new Error("BS8 "+_+" != "+E.length);var C=[];return p.length&&C.push(p),E.length&&C.push(E),y.length&&C.push(y),zn(C)}function PR(n,e){var t=e||{},i=[];n&&!n.SSF&&(n.SSF=Ti(sn)),n&&n.SSF&&(mf(),hf(n.SSF),t.revssf=pf(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,eg(t),t.cellXfs=[],as(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var a=0;a<n.SheetNames.length;++a)i[i.length]=LR(a,t,n);return i.unshift(IR(n,i,t)),zn(i)}function w_(n,e){for(var t=0;t<=n.SheetNames.length;++t){var i=n.Sheets[n.SheetNames[t]];if(!(!i||!i["!ref"])){var a=Fi(i["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return PR(n,e);case 4:case 3:case 2:return kR(n,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function BR(n,e,t,i){for(var a=n["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,m=0;m<a.length;++m)if(!(a[m].s.r>t||a[m].s.c>l)&&!(a[m].e.r<t||a[m].e.c<l)){if(a[m].s.r<t||a[m].s.c<l){u=-1;break}u=a[m].e.r-a[m].s.r+1,f=a[m].e.c-a[m].s.c+1;break}if(!(u<0)){var p=Nt({r:t,c:l}),v=i.dense?(n[t]||[])[l]:n[p],y=v&&v.v!=null&&(v.h||p5(v.w||(mr(v),v.w)||""))||"",S={};u>1&&(S.rowspan=u),f>1&&(S.colspan=f),i.editable?y='<span contenteditable="true">'+y+"</span>":v&&(S["data-t"]=v&&v.t||"z",v.v!=null&&(S["data-v"]=v.v),v.z!=null&&(S["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),S.id=(i.id||"sjs")+"-"+p,o.push(je("td",y,S))}}var _="<tr>";return _+o.join("")+"</tr>"}var FR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',UR="</body></html>";function zR(n,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function E_(n,e){var t=e||{},i=t.header!=null?t.header:FR,a=t.footer!=null?t.footer:UR,o=[i],l=Fi(n["!ref"]);t.dense=Array.isArray(n),o.push(zR(n,l,t));for(var u=l.s.r;u<=l.e.r;++u)o.push(BR(n,l,u,t));return o.push("</table>"+a),o.join("")}function A_(n,e,t){var i=t||{},a=0,o=0;if(i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?Nn(i.origin):i.origin;a=l.r,o=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(i.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:a,c:o}};if(n["!ref"]){var p=Fi(n["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),a==-1&&(m.e.r=a=p.e.r+1)}var v=[],y=0,S=n["!rows"]||(n["!rows"]=[]),_=0,x=0,T=0,w=0,E=0,C=0;for(n["!cols"]||(n["!cols"]=[]);_<u.length&&x<f;++_){var N=u[_];if(Hx(N)){if(i.display)continue;S[x]={hidden:!0}}var A=N.children;for(T=w=0;T<A.length;++T){var I=A[T];if(!(i.display&&Hx(I))){var D=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):x5(I.innerHTML),z=I.getAttribute("data-z")||I.getAttribute("z");for(y=0;y<v.length;++y){var L=v[y];L.s.c==w+o&&L.s.r<x+a&&x+a<=L.e.r&&(w=L.e.c+1-o,y=-1)}C=+I.getAttribute("colspan")||1,((E=+I.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:x+a,c:w+o},e:{r:x+a+(E||1)-1,c:w+o+(C||1)-1}});var H={t:"s",v:D},K=I.getAttribute("data-t")||I.getAttribute("t")||"";D!=null&&(D.length==0?H.t=K||"z":i.raw||D.trim().length==0||K=="s"||(D==="TRUE"?H={t:"b",v:!0}:D==="FALSE"?H={t:"b",v:!1}:isNaN(ur(D))?isNaN(Bc(D).getDate())||(H={t:"d",v:oi(D)},i.cellDates||(H={t:"n",v:_i(H.v)}),H.z=i.dateNF||sn[14]):H={t:"n",v:ur(D)})),H.z===void 0&&z!=null&&(H.z=z);var ne="",xe=I.getElementsByTagName("A");if(xe&&xe.length)for(var He=0;He<xe.length&&!(xe[He].hasAttribute("href")&&(ne=xe[He].getAttribute("href"),ne.charAt(0)!="#"));++He);ne&&ne.charAt(0)!="#"&&(H.l={Target:ne}),i.dense?(n[x+a]||(n[x+a]=[]),n[x+a][w+o]=H):n[Nt({c:w+o,r:x+a})]=H,m.e.c<w+o&&(m.e.c=w+o),w+=C}}++x}return v.length&&(n["!merges"]=(n["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,x-1+a),n["!ref"]=gn(m),x>=f&&(n["!fullref"]=gn((m.e.r=u.length-_+x-1+a,m))),n}function k_(n,e){var t=e||{},i=t.dense?[]:{};return A_(i,n,e)}function HR(n,e){return Vs(k_(n,e),e)}function Hx(n){var e="",t=WR(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function WR(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var VR=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Uc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return vn+e}}(),Wx=function(){var n=function(o){return Dt(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(o,l,u){var f=[];f.push('      <table:table table:name="'+Dt(l.SheetNames[u])+`" table:style-name="ta1">
`);var m=0,p=0,v=Fi(o["!ref"]||"A1"),y=o["!merges"]||[],S=0,_=Array.isArray(o);if(o["!cols"])for(p=0;p<=v.e.c;++p)f.push("        <table:table-column"+(o["!cols"][p]?' table:style-name="co'+o["!cols"][p].ods+'"':"")+`></table:table-column>
`);var x="",T=o["!rows"]||[];for(m=0;m<v.s.r;++m)x=T[m]?' table:style-name="ro'+T[m].ods+'"':"",f.push("        <table:table-row"+x+`></table:table-row>
`);for(;m<=v.e.r;++m){for(x=T[m]?' table:style-name="ro'+T[m].ods+'"':"",f.push("        <table:table-row"+x+`>
`),p=0;p<v.s.c;++p)f.push(e);for(;p<=v.e.c;++p){var w=!1,E={},C="";for(S=0;S!=y.length;++S)if(!(y[S].s.c>p)&&!(y[S].s.r>m)&&!(y[S].e.c<p)&&!(y[S].e.r<m)){(y[S].s.c!=p||y[S].s.r!=m)&&(w=!0),E["table:number-columns-spanned"]=y[S].e.c-y[S].s.c+1,E["table:number-rows-spanned"]=y[S].e.r-y[S].s.r+1;break}if(w){f.push(t);continue}var N=Nt({r:m,c:p}),A=_?(o[m]||[])[p]:o[N];if(A&&A.f&&(E["table:formula"]=Dt(uN(A.f)),A.F&&A.F.slice(0,N.length)==N)){var I=Fi(A.F);E["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,E["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!A){f.push(e);continue}switch(A.t){case"b":C=A.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=A.v?"true":"false";break;case"n":C=A.w||String(A.v||0),E["office:value-type"]="float",E["office:value"]=A.v||0;break;case"s":case"str":C=A.v==null?"":A.v,E["office:value-type"]="string";break;case"d":C=A.w||oi(A.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=oi(A.v).toISOString(),E["table:style-name"]="ce1";break;default:f.push(e);continue}var D=n(C);if(A.l&&A.l.Target){var z=A.l.Target;z=z.charAt(0)=="#"?"#"+dN(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),D=je("text:a",D,{"xlink:href":z.replace(/&/g,"&amp;")})}f.push("          "+je("table:table-cell",je("text:p",D,{}),E)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var p=0;p<m["!cols"].length;++p)if(m["!cols"][p]){var v=m["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;qp(v),v.ods=u;var y=m["!cols"][p].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var p=0;p<m["!rows"].length;++p)if(m["!rows"][p]){m["!rows"][p].ods=f;var v=m["!rows"][p].hpx+"px";o.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++f}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var f=[vn],m=Uc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Uc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+m+p+`>
`),f.push(HS().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+m+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)f.push(i(l.Sheets[l.SheetNames[v]],l,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function C_(n,e){if(e.bookType=="fods")return Wx(n,e);var t=Bp(),i="",a=[],o=[];return i="mimetype",nt(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",nt(t,i,Wx(n,e)),a.push([i,"text/xml"]),o.push([i,"ContentFile"]),i="styles.xml",nt(t,i,VR(n,e)),a.push([i,"text/xml"]),o.push([i,"StylesFile"]),i="meta.xml",nt(t,i,vn+HS()),a.push([i,"text/xml"]),o.push([i,"MetadataFile"]),i="manifest.rdf",nt(t,i,nC(o)),a.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",nt(t,i,eC(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nf(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function GR(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):pa(Fc(n))}function YR(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var i=0;i<e.length;++i)if(n[t+i]!=e[i])continue e;return!0}return!1}function ns(n){var e=n.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(e),i=0;return n.forEach(function(a){t.set(a,i),i+=a.length}),t}function XR(n,e,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,i-6176);n[e+15]|=i>>7,n[e+14]|=(i&127)<<1;for(var o=0;a>=1;++o,a/=256)n[e+o]=a&255;n[e+15]|=t>=0?0:128}function zc(n,e){var t=e?e[0]:0,i=n[t]&127;e:if(n[t++]>=128&&(i|=(n[t]&127)<<7,n[t++]<128||(i|=(n[t]&127)<<14,n[t++]<128)||(i|=(n[t]&127)<<21,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(i+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),i}function kt(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function Yo(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function _n(n){for(var e=[],t=[0];t[0]<n.length;){var i=t[0],a=zc(n,t),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var f=t[0];n[t[0]++]>=128;);u=n.slice(f,t[0])}break;case 5:l=4,u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=zc(n,t),u=n.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(i))}var m={data:u,type:o};e[a]==null?e[a]=[m]:e[a].push(m)}return e}function Fn(n){var e=[];return n.forEach(function(t,i){t.forEach(function(a){a.data&&(e.push(kt(i*8+a.type)),a.type==2&&e.push(kt(a.data.length)),e.push(a.data))})}),ns(e)}function ha(n){for(var e,t=[],i=[0];i[0]<n.length;){var a=zc(n,i),o=_n(n.slice(i[0],i[0]+a));i[0]+=a;var l={id:Yo(o[1][0].data),messages:[]};o[2].forEach(function(u){var f=_n(u.data),m=Yo(f[3][0].data);l.messages.push({meta:f,data:n.slice(i[0],i[0]+m)}),i[0]+=m}),(e=o[3])!=null&&e[0]&&(l.merge=Yo(o[3][0].data)>>>0>0),t.push(l)}return t}function Io(n){var e=[];return n.forEach(function(t){var i=[];i[1]=[{data:kt(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:kt(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:kt(l.data.length)}],i[2].push({data:Fn(l.meta),type:2})});var o=Fn(i);e.push(kt(o.length)),e.push(o),a.forEach(function(l){return e.push(l)})}),ns(e)}function $R(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],i=zc(e,t),a=[];t[0]<e.length;){var o=e[t[0]]&3;if(o==0){var l=e[t[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[t[0]],u>1&&(l|=e[t[0]+1]<<8),u>2&&(l|=e[t[0]+2]<<16),u>3&&(l|=e[t[0]+3]<<24),l>>>=0,l++,t[0]+=u}a.push(e.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,m=0;if(o==1?(m=(e[t[0]]>>2&7)+4,f=(e[t[0]++]&224)<<3,f|=e[t[0]++]):(m=(e[t[0]++]>>2)+1,o==2?(f=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(f=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),a=[ns(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(m>=f)for(a.push(a[0].slice(-f)),m-=f;m>=a[a.length-1].length;)a.push(a[a.length-1]),m-=a[a.length-1].length;a.push(a[0].slice(-f,-f+m))}}var p=ns(a);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function ma(n){for(var e=[],t=0;t<n.length;){var i=n[t++],a=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push($R(i,n.slice(t,t+a))),t+=a}if(t!==n.length)throw new Error("data is not a valid framed stream!");return ns(e)}function Po(n){for(var e=[],t=0;t<n.length;){var i=Math.min(n.length-t,268435455),a=new Uint8Array(4);e.push(a);var o=kt(i),l=o.length;e.push(o),i<=60?(l++,e.push(new Uint8Array([i-1<<2]))):i<=256?(l+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(l+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(l+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(l+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(n.slice(t,t+i)),l+=i,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,t+=i}return ns(e)}function Wm(n,e){var t=new Uint8Array(32),i=nf(t),a=12,o=0;switch(t[0]=5,n.t){case"n":t[1]=2,XR(t,a,n.v),o|=1,a+=16;break;case"b":t[1]=6,i.setFloat64(a,n.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,i.setUint32(a,e.indexOf(n.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,o,!0),t.slice(0,a)}function Vm(n,e){var t=new Uint8Array(32),i=nf(t),a=12,o=0;switch(t[0]=3,n.t){case"n":t[2]=2,i.setFloat64(a,n.v,!0),o|=32,a+=8;break;case"b":t[2]=6,i.setFloat64(a,n.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,i.setUint32(a,e.indexOf(n.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(4,o,!0),t.slice(0,a)}function Vr(n){var e=_n(n);return zc(e[1][0].data)}function qR(n,e,t){var i,a,o,l;if(!((i=n[6])!=null&&i[0])||!((a=n[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=n[8])==null?void 0:o[0])==null?void 0:l.data)&&Yo(n[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,m=nf(n[7][0].data),p=0,v=[],y=nf(n[4][0].data),S=0,_=[],x=0;x<e.length;++x){if(e[x]==null){m.setUint16(x*2,65535,!0),y.setUint16(x*2,65535);continue}m.setUint16(x*2,p,!0),y.setUint16(x*2,S,!0);var T,w;switch(typeof e[x]){case"string":T=Wm({t:"s",v:e[x]},t),w=Vm({t:"s",v:e[x]},t);break;case"number":T=Wm({t:"n",v:e[x]},t),w=Vm({t:"n",v:e[x]},t);break;case"boolean":T=Wm({t:"b",v:e[x]},t),w=Vm({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}v.push(T),p+=T.length,_.push(w),S+=w.length,++f}for(n[2][0].data=kt(f);x<n[7][0].data.length/2;++x)m.setUint16(x*2,65535,!0),y.setUint16(x*2,65535,!0);return n[6][0].data=ns(v),n[3][0].data=ns(_),f}function KR(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Fi(t["!ref"]);i.s.r=i.s.c=0;var a=!1;i.e.c>9&&(a=!0,i.e.c=9),i.e.r>49&&(a=!0,i.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(gn(i)));var o=af(t,{range:i,header:1}),l=["~Sh33tJ5~"];o.forEach(function(Y){return Y.forEach(function(V){typeof V=="string"&&l.push(V)})});var u={},f=[],m=Pt.read(e.numbers,{type:"base64"});m.FileIndex.map(function(Y,V){return[Y,m.FullPaths[V]]}).forEach(function(Y){var V=Y[0],q=Y[1];if(V.type==2&&V.name.match(/\.iwa/)){var re=V.content,Me=ma(re),Ce=ha(Me);Ce.forEach(function(Le){f.push(Le.id),u[Le.id]={deps:[],location:q,type:Yo(Le.messages[0].meta[1][0].data)}})}}),f.sort(function(Y,V){return Y-V});var p=f.filter(function(Y){return Y>1}).map(function(Y){return[Y,kt(Y)]});m.FileIndex.map(function(Y,V){return[Y,m.FullPaths[V]]}).forEach(function(Y){var V=Y[0];if(Y[1],!!V.name.match(/\.iwa/)){var q=ha(ma(V.content));q.forEach(function(re){re.messages.forEach(function(Me){p.forEach(function(Ce){re.messages.some(function(Le){return Yo(Le.meta[1][0].data)!=11006&&YR(Le.data,Ce[1])})&&u[Ce[0]].deps.push(re.id)})})})}});for(var v=Pt.find(m,u[1].location),y=ha(ma(v.content)),S,_=0;_<y.length;++_){var x=y[_];x.id==1&&(S=x)}var T=Vr(_n(S.messages[0].data)[1][0].data);for(v=Pt.find(m,u[T].location),y=ha(ma(v.content)),_=0;_<y.length;++_)x=y[_],x.id==T&&(S=x);for(T=Vr(_n(S.messages[0].data)[2][0].data),v=Pt.find(m,u[T].location),y=ha(ma(v.content)),_=0;_<y.length;++_)x=y[_],x.id==T&&(S=x);for(T=Vr(_n(S.messages[0].data)[2][0].data),v=Pt.find(m,u[T].location),y=ha(ma(v.content)),_=0;_<y.length;++_)x=y[_],x.id==T&&(S=x);var w=_n(S.messages[0].data);{w[6][0].data=kt(i.e.r+1),w[7][0].data=kt(i.e.c+1);var E=Vr(w[46][0].data),C=Pt.find(m,u[E].location),N=ha(ma(C.content));{for(var A=0;A<N.length&&N[A].id!=E;++A);if(N[A].id!=E)throw"Bad ColumnRowUIDMapArchive";var I=_n(N[A].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var D=0;D<=i.e.c;++D){var z=[];z[1]=z[2]=[{type:0,data:kt(D+420690)}],I[1].push({type:2,data:Fn(z)}),I[2].push({type:0,data:kt(D)}),I[3].push({type:0,data:kt(D)})}I[4]=[],I[5]=[],I[6]=[];for(var L=0;L<=i.e.r;++L)z=[],z[1]=z[2]=[{type:0,data:kt(L+726270)}],I[4].push({type:2,data:Fn(z)}),I[5].push({type:0,data:kt(L)}),I[6].push({type:0,data:kt(L)});N[A].messages[0].data=Fn(I)}C.content=Po(Io(N)),C.size=C.content.length,delete w[46];var H=_n(w[4][0].data);{H[7][0].data=kt(i.e.r+1);var K=_n(H[1][0].data),ne=Vr(K[2][0].data);C=Pt.find(m,u[ne].location),N=ha(ma(C.content));{if(N[0].id!=ne)throw"Bad HeaderStorageBucket";var xe=_n(N[0].messages[0].data);for(L=0;L<o.length;++L){var He=_n(xe[2][0].data);He[1][0].data=kt(L),He[4][0].data=kt(o[L].length),xe[2][L]={type:xe[2][0].type,data:Fn(He)}}N[0].messages[0].data=Fn(xe)}C.content=Po(Io(N)),C.size=C.content.length;var _e=Vr(H[2][0].data);C=Pt.find(m,u[_e].location),N=ha(ma(C.content));{if(N[0].id!=_e)throw"Bad HeaderStorageBucket";for(xe=_n(N[0].messages[0].data),D=0;D<=i.e.c;++D)He=_n(xe[2][0].data),He[1][0].data=kt(D),He[4][0].data=kt(i.e.r+1),xe[2][D]={type:xe[2][0].type,data:Fn(He)};N[0].messages[0].data=Fn(xe)}C.content=Po(Io(N)),C.size=C.content.length;var ie=Vr(H[4][0].data);(function(){for(var Y=Pt.find(m,u[ie].location),V=ha(ma(Y.content)),q,re=0;re<V.length;++re){var Me=V[re];Me.id==ie&&(q=Me)}var Ce=_n(q.messages[0].data);{Ce[3]=[];var Le=[];l.forEach(function(Je,Ht){Le[1]=[{type:0,data:kt(Ht)}],Le[2]=[{type:0,data:kt(1)}],Le[3]=[{type:2,data:GR(Je)}],Ce[3].push({type:2,data:Fn(Le)})})}q.messages[0].data=Fn(Ce);var Ae=Io(V),ct=Po(Ae);Y.content=ct,Y.size=Y.content.length})();var he=_n(H[3][0].data);{var Ne=he[1][0];delete he[2];var Be=_n(Ne.data);{var X=Vr(Be[2][0].data);(function(){for(var Y=Pt.find(m,u[X].location),V=ha(ma(Y.content)),q,re=0;re<V.length;++re){var Me=V[re];Me.id==X&&(q=Me)}var Ce=_n(q.messages[0].data);{delete Ce[6],delete he[7];var Le=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var Ae=0,ct=0;ct<=i.e.r;++ct){var Je=_n(Le);Ae+=qR(Je,o[ct],l),Je[1][0].data=kt(ct),Ce[5].push({data:Fn(Je),type:2})}Ce[1]=[{type:0,data:kt(i.e.c+1)}],Ce[2]=[{type:0,data:kt(i.e.r+1)}],Ce[3]=[{type:0,data:kt(Ae)}],Ce[4]=[{type:0,data:kt(i.e.r+1)}]}q.messages[0].data=Fn(Ce);var Ht=Io(V),at=Po(Ht);Y.content=at,Y.size=Y.content.length})()}Ne.data=Fn(Be)}H[3][0].data=Fn(he)}w[4][0].data=Fn(H)}S.messages[0].data=Fn(w);var pe=Io(y),P=Po(pe);return v.content=P,v.size=v.content.length,m}function ZR(n){return function(t){for(var i=0;i!=n.length;++i){var a=n[i];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function eg(n){ZR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function QR(n,e){return e.bookType=="ods"?C_(n,e):e.bookType=="numbers"?KR(n,e):e.bookType=="xlsb"?JR(n,e):eM(n,e)}function JR(n,e){Uo=1024,n&&!n.SSF&&(n.SSF=Ti(sn)),n&&n.SSF&&(mf(),hf(n.SSF),e.revssf=pf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,kc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",i=u_.indexOf(e.bookType)>-1,a=FS();eg(e=e||{});var o=Bp(),l="",u=0;if(e.cellXfs=[],as(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",nt(o,l,WS(n.Props,e)),a.coreprops.push(l),Ct(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],m=0;m<n.SheetNames.length;++m)(n.Workbook.Sheets[m]||{}).Hidden!=2&&f.push(n.SheetNames[m]);n.Props.SheetNames=f}for(n.Props.Worksheets=n.Props.SheetNames.length,nt(o,l,GS(n.Props)),a.extprops.push(l),Ct(e.rels,3,l,bt.EXT_PROPS),n.Custprops!==n.Props&&Vn(n.Custprops||{}).length>0&&(l="docProps/custom.xml",nt(o,l,YS(n.Custprops)),a.custprops.push(l),Ct(e.rels,4,l,bt.CUST_PROPS)),u=1;u<=n.SheetNames.length;++u){var p={"!id":{}},v=n.Sheets[n.SheetNames[u-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,nt(o,l,nR(u-1,l,e,n,p)),a.sheets.push(l),Ct(e.wbrels,-1,"worksheets/sheet"+u+"."+t,bt.WS[0])}if(v){var S=v["!comments"],_=!1,x="";S&&S.length>0&&(x="xl/comments"+u+"."+t,nt(o,x,rR(S,x)),a.comments.push(x),Ct(p,-1,"../comments"+u+"."+t,bt.CMNT),_=!0),v["!legacy"]&&_&&nt(o,"xl/drawings/vmlDrawing"+u+".vml",l_(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&nt(o,zS(l),Vo(p))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,nt(o,l,aR(e.Strings,l,e)),a.strs.push(l),Ct(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,nt(o,l,tR(n,l)),a.workbooks.push(l),Ct(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",nt(o,l,s_(n.Themes,e)),a.themes.push(l),Ct(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,nt(o,l,iR(n,l,e)),a.styles.push(l),Ct(e.wbrels,-1,"styles."+t,bt.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",nt(o,l,n.vbaraw),a.vba.push(l),Ct(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,nt(o,l,sR(l)),a.metadata.push(l),Ct(e.wbrels,-1,"metadata."+t,bt.XLMETA),nt(o,"[Content_Types].xml",US(a,e)),nt(o,"_rels/.rels",Vo(e.rels)),nt(o,"xl/_rels/workbook."+t+".rels",Vo(e.wbrels)),delete e.revssf,delete e.ssf,o}function eM(n,e){Uo=1024,n&&!n.SSF&&(n.SSF=Ti(sn)),n&&n.SSF&&(mf(),hf(n.SSF),e.revssf=pf(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,kc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",i=u_.indexOf(e.bookType)>-1,a=FS();eg(e=e||{});var o=Bp(),l="",u=0;if(e.cellXfs=[],as(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",nt(o,l,WS(n.Props,e)),a.coreprops.push(l),Ct(e.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],m=0;m<n.SheetNames.length;++m)(n.Workbook.Sheets[m]||{}).Hidden!=2&&f.push(n.SheetNames[m]);n.Props.SheetNames=f}n.Props.Worksheets=n.Props.SheetNames.length,nt(o,l,GS(n.Props)),a.extprops.push(l),Ct(e.rels,3,l,bt.EXT_PROPS),n.Custprops!==n.Props&&Vn(n.Custprops||{}).length>0&&(l="docProps/custom.xml",nt(o,l,YS(n.Custprops)),a.custprops.push(l),Ct(e.rels,4,l,bt.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=n.SheetNames.length;++u){var v={"!id":{}},y=n.Sheets[n.SheetNames[u-1]],S=(y||{})["!type"]||"sheet";switch(S){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,nt(o,l,x_(u-1,e,n,v)),a.sheets.push(l),Ct(e.wbrels,-1,"worksheets/sheet"+u+"."+t,bt.WS[0])}if(y){var _=y["!comments"],x=!1,T="";if(_&&_.length>0){var w=!1;_.forEach(function(E){E[1].forEach(function(C){C.T==!0&&(w=!0)})}),w&&(T="xl/threadedComments/threadedComment"+u+"."+t,nt(o,T,Nj(_,p,e)),a.threadedcomments.push(T),Ct(v,-1,"../threadedComments/threadedComment"+u+"."+t,bt.TCMNT)),T="xl/comments"+u+"."+t,nt(o,T,c_(_)),a.comments.push(T),Ct(v,-1,"../comments"+u+"."+t,bt.CMNT),x=!0}y["!legacy"]&&x&&nt(o,"xl/drawings/vmlDrawing"+u+".vml",l_(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}v["!id"].rId1&&nt(o,zS(l),Vo(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,nt(o,l,e_(e.Strings,e)),a.strs.push(l),Ct(e.wbrels,-1,"sharedStrings."+t,bt.SST)),l="xl/workbook."+t,nt(o,l,__(n)),a.workbooks.push(l),Ct(e.rels,1,l,bt.WB),l="xl/theme/theme1.xml",nt(o,l,s_(n.Themes,e)),a.themes.push(l),Ct(e.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+t,nt(o,l,a_(n,e)),a.styles.push(l),Ct(e.wbrels,-1,"styles."+t,bt.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",nt(o,l,n.vbaraw),a.vba.push(l),Ct(e.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+t,nt(o,l,o_()),a.metadata.push(l),Ct(e.wbrels,-1,"metadata."+t,bt.XLMETA),p.length>1&&(l="xl/persons/person.xml",nt(o,l,Oj(p)),a.people.push(l),Ct(e.wbrels,-1,"persons/person.xml",bt.PEOPLE)),nt(o,"[Content_Types].xml",US(a,e)),nt(o,"_rels/.rels",Vo(e.rels)),nt(o,"xl/_rels/workbook."+t+".rels",Vo(e.wbrels)),delete e.revssf,delete e.ssf,o}function tM(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=hr(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function j_(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return qc(e.file,Pt.write(n,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pt.write(n,e)}function nM(n,e){var t=Ti(e||{}),i=QR(n,t);return iM(i,t)}function iM(n,e){var t={},i=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=i;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var a=n.FullPaths?Pt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(ff(a))}return e.password&&typeof encrypt_agile<"u"?j_(encrypt_agile(a,e.password),e):e.type==="file"?qc(e.file,a):e.type=="string"?Tc(a):a}function aM(n,e){var t=e||{},i=bR(n,t);return j_(i,t)}function Oa(n,e,t){t||(t="");var i=t+n;switch(e.type){case"base64":return Pc(Fc(i));case"binary":return Fc(i);case"string":return n;case"file":return qc(e.file,i,"utf8");case"buffer":return _t?gr(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Oa(i,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function rM(n,e){switch(e.type){case"base64":return Pc(n);case"binary":return n;case"string":return n;case"file":return qc(e.file,n,"binary");case"buffer":return _t?gr(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function jd(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",i=0;i<n.length;++i)t+=String.fromCharCode(n[i]);return e.type=="base64"?Pc(t):e.type=="string"?Tc(t):t;case"file":return qc(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function D_(n,e){R6(),VO(n);var t=Ti(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=D_(n,t);return t.type="array",ff(i)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=n.SheetNames.indexOf(t.sheet),!n.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Oa(yR(n,t),t);case"slk":case"sylk":return Oa(zC.from_sheet(n.Sheets[n.SheetNames[a]],t),t);case"htm":case"html":return Oa(E_(n.Sheets[n.SheetNames[a]],t),t);case"txt":return rM(N_(n.Sheets[n.SheetNames[a]],t),t);case"csv":return Oa(tg(n.Sheets[n.SheetNames[a]],t),t,"\uFEFF");case"dif":return Oa(HC.from_sheet(n.Sheets[n.SheetNames[a]],t),t);case"dbf":return jd(UC.from_sheet(n.Sheets[n.SheetNames[a]],t),t);case"prn":return Oa(WC.from_sheet(n.Sheets[n.SheetNames[a]],t),t);case"rtf":return Oa(KC.from_sheet(n.Sheets[n.SheetNames[a]],t),t);case"eth":return Oa(JS.from_sheet(n.Sheets[n.SheetNames[a]],t),t);case"fods":return Oa(C_(n,t),t);case"wk1":return jd(Ix.sheet_to_wk1(n.Sheets[n.SheetNames[a]],t),t);case"wk3":return jd(Ix.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),jd(w_(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),aM(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nM(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function sM(n,e,t,i,a,o,l,u){var f=Wn(t),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!l||n[t])for(var S=e.s.c;S<=e.e.c;++S){var _=l?n[t][S]:n[i[S]+f];if(_===void 0||_.t===void 0){if(m===void 0)continue;o[S]!=null&&(y[o[S]]=m);continue}var x=_.v;switch(_.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(o[S]!=null){if(x==null)if(_.t=="e"&&x===null)y[o[S]]=null;else if(m!==void 0)y[o[S]]=m;else if(p&&x===null)y[o[S]]=null;else continue;else y[o[S]]=p&&(_.t!=="n"||_.t==="n"&&u.rawNumbers!==!1)?x:mr(_,x,u);x!=null&&(v=!1)}}return{row:y,isempty:v}}function af(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},i=0,a=1,o=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},p=m.range!=null?m.range:n["!ref"];switch(m.header===1?i=1:m.header==="A"?i=2:Array.isArray(m.header)?i=3:m.header==null&&(i=0),typeof p){case"string":f=Vt(p);break;case"number":f=Vt(n["!ref"]),f.s.r=p;break;default:f=p}i>0&&(a=0);var v=Wn(f.s.r),y=[],S=[],_=0,x=0,T=Array.isArray(n),w=f.s.r,E=0,C={};T&&!n[w]&&(n[w]=[]);var N=m.skipHidden&&n["!cols"]||[],A=m.skipHidden&&n["!rows"]||[];for(E=f.s.c;E<=f.e.c;++E)if(!(N[E]||{}).hidden)switch(y[E]=Zn(E),t=T?n[w][E]:n[y[E]+v],i){case 1:o[E]=E-f.s.c;break;case 2:o[E]=y[E];break;case 3:o[E]=m.header[E-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=l=mr(t,null,m),x=C[l]||0,!x)C[l]=1;else{do u=l+"_"+x++;while(C[u]);C[l]=x,C[u]=1}o[E]=u}for(w=f.s.r+a;w<=f.e.r;++w)if(!(A[w]||{}).hidden){var I=sM(n,f,w,y,i,o,T,m);(I.isempty===!1||(i===1?m.blankrows!==!1:m.blankrows))&&(S[_++]=I.row)}return S.length=_,S}var Vx=/"/g;function oM(n,e,t,i,a,o,l,u){for(var f=!0,m=[],p="",v=Wn(t),y=e.s.c;y<=e.e.c;++y)if(i[y]){var S=u.dense?(n[t]||[])[y]:n[i[y]+v];if(S==null)p="";else if(S.v!=null){f=!1,p=""+(u.rawNumbers&&S.t=="n"?S.v:mr(S,null,u));for(var _=0,x=0;_!==p.length;++_)if((x=p.charCodeAt(_))===a||x===o||x===34||u.forceQuotes){p='"'+p.replace(Vx,'""')+'"';break}p=="ID"&&(p='"ID"')}else S.f!=null&&!S.F?(f=!1,p="="+S.f,p.indexOf(",")>=0&&(p='"'+p.replace(Vx,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&f?null:m.join(l)}function tg(n,e){var t=[],i=e??{};if(n==null||n["!ref"]==null)return"";var a=Vt(n["!ref"]),o=i.FS!==void 0?i.FS:",",l=o.charCodeAt(0),u=i.RS!==void 0?i.RS:`
`,f=u.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];i.dense=Array.isArray(n);for(var y=i.skipHidden&&n["!cols"]||[],S=i.skipHidden&&n["!rows"]||[],_=a.s.c;_<=a.e.c;++_)(y[_]||{}).hidden||(v[_]=Zn(_));for(var x=0,T=a.s.r;T<=a.e.r;++T)(S[T]||{}).hidden||(p=oM(n,a,T,v,l,f,o,i),p!=null&&(i.strip&&(p=p.replace(m,"")),(p||i.blankrows!==!1)&&t.push((x++?u:"")+p)));return delete i.dense,t.join("")}function N_(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=tg(n,e);return t}function lM(n){var e="",t,i="";if(n==null||n["!ref"]==null)return[];var a=Vt(n["!ref"]),o="",l=[],u,f=[],m=Array.isArray(n);for(u=a.s.c;u<=a.e.c;++u)l[u]=Zn(u);for(var p=a.s.r;p<=a.e.r;++p)for(o=Wn(p),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+o,t=m?(n[p]||[])[u]:n[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}f[f.length]=e+"="+i}return f}function O_(n,e,t){var i=t||{},a=+!i.skipHeader,o=n||{},l=0,u=0;if(o&&i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Nn(i.origin):i.origin;l=f.r,u=f.c}var m,p={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(o["!ref"]){var v=Vt(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+e.length-1+a)}else l==-1&&(l=0,p.e.r=e.length-1+a);var y=i.header||[],S=0;e.forEach(function(x,T){Vn(x).forEach(function(w){(S=y.indexOf(w))==-1&&(y[S=y.length]=w);var E=x[w],C="z",N="",A=Nt({c:u+S,r:l+T+a});m=Hc(o,A),E&&typeof E=="object"&&!(E instanceof Date)?o[A]=E:(typeof E=="number"?C="n":typeof E=="boolean"?C="b":typeof E=="string"?C="s":E instanceof Date?(C="d",i.cellDates||(C="n",E=_i(E)),N=i.dateNF||sn[14]):E===null&&i.nullError&&(C="e",E=0),m?(m.t=C,m.v=E,delete m.w,delete m.R,N&&(m.z=N)):o[A]=m={t:C,v:E},N&&(m.z=N))})}),p.e.c=Math.max(p.e.c,u+y.length-1);var _=Wn(l);if(a)for(S=0;S<y.length;++S)o[Zn(S+u)+_]={t:"s",v:y[S]};return o["!ref"]=gn(p),o}function cM(n,e){return O_(null,n,e)}function Hc(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var i=Nn(e);return n[i.r]||(n[i.r]=[]),n[i.r][i.c]||(n[i.r][i.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Hc(n,Nt(e)):Hc(n,Nt({r:e,c:t||0}))}function uM(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function dM(){return{SheetNames:[],Sheets:{}}}function fM(n,e,t,i){var a=1;if(!t)for(;a<=65535&&n.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&n.SheetNames.indexOf(t=l+a)!=-1;++a);}if(S_(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function hM(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=uM(n,e);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[i].Hidden=t}function mM(n,e){return n.z=e,n}function R_(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function pM(n,e,t){return R_(n,"#"+e,t)}function gM(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function vM(n,e,t,i){for(var a=typeof e!="string"?e:Vt(e),o=typeof e=="string"?e:gn(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var f=Hc(n,l,u);f.t="n",f.F=o,delete f.v,l==a.s.r&&u==a.s.c&&(f.f=t,i&&(f.D=!0))}return n}var Bn={encode_col:Zn,encode_row:Wn,encode_cell:Nt,encode_range:gn,decode_col:Vp,decode_row:Wp,split_cell:R5,decode_cell:Nn,decode_range:Fi,format_cell:mr,sheet_add_aoa:RS,sheet_add_json:O_,sheet_add_dom:A_,aoa_to_sheet:nl,json_to_sheet:cM,table_to_sheet:k_,table_to_book:HR,sheet_to_csv:tg,sheet_to_txt:N_,sheet_to_json:af,sheet_to_html:E_,sheet_to_formulae:lM,sheet_to_row_object_array:af,sheet_get_cell:Hc,book_new:dM,book_append_sheet:fM,book_set_sheet_visibility:hM,cell_set_number_format:mM,cell_set_hyperlink:R_,cell_set_internal_link:pM,cell_add_comment:gM,sheet_set_array_formula:vM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class yM{async exportReport(e,t,i,a,o){const l=Bn.book_new();if(o.includeSummary){const p=this.createSummarySheet(e,o);Bn.book_append_sheet(l,p,"Summary")}if(o.includeDetailedData){const p=this.createDetailedDataSheet(t,i,a);Bn.book_append_sheet(l,p,"Time Entries")}const u=this.createProjectsSheet(e,i);if(Bn.book_append_sheet(l,u,"Project Analysis"),o.includeTrends){const p=this.createTrendsSheet(e);Bn.book_append_sheet(l,p,"Daily Trends")}if(e.topClients&&e.topClients.length>0){const p=this.createClientsSheet(e);Bn.book_append_sheet(l,p,"Client Analysis")}const f=this.createEfficiencySheet(e);Bn.book_append_sheet(l,f,"Efficiency");const m=D_(l,{bookType:"xlsx",type:"array",cellStyles:!0});return new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}createSummarySheet(e,t){const i=[["TimeBeacon Analytics Report"],["Generated on:",new Date().toLocaleDateString()],["Report Period:",`${t.dateFormat||"Custom Range"}`],["Generated by:",t.generatedBy||"TimeBeacon User"],[],[" KEY METRICS"],["Metric","Value","Status"],["Total Hours Tracked",e.totalHours.toFixed(2),this.getStatusIndicator(e.totalHours,40,"hours")],["Billable Hours",e.billableHours.toFixed(2),this.getStatusIndicator(e.billableHours,30,"hours")],["Non-Billable Hours",e.nonBillableHours.toFixed(2),""],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`,this.getStatusIndicator(e.utilizationRate,75,"percentage")],["Productivity Score",`${e.productivityScore.toFixed(1)}%`,this.getStatusIndicator(e.productivityScore,80,"percentage")],["Average Session Length",`${e.averageSessionLength.toFixed(1)} min`,this.getStatusIndicator(e.averageSessionLength,120,"minutes")],["Total Sessions",e.totalSessions.toString(),""],[],[" TOP PROJECTS (by hours)"],["Rank","Project Name","Hours","Percentage"],...e.topProjects.slice(0,10).map((o,l)=>[l+1,o.name,o.hours.toFixed(2),`${o.percentage.toFixed(1)}%`]),[],[" PERFORMANCE INDICATORS"],["Indicator","Current","Target","Status"],["Daily Average Hours",(e.totalHours/30).toFixed(1),"8.0",this.getPerformanceStatus(e.totalHours/30,8)],["Consistency Score",(e.productivityScore/100).toFixed(2),"0.85",this.getPerformanceStatus(e.productivityScore/100,.85)],["Project Focus",e.topProjects.length>0?e.topProjects[0].percentage.toFixed(1)+"%":"0%","60%",""]],a=Bn.aoa_to_sheet(i);return this.applyBasicFormatting(a),a["!cols"]=[{width:25},{width:15},{width:12},{width:12}],a}createDetailedDataSheet(e,t,i){const a=["Date","Project","Client","Description","Start Time","End Time","Duration (hours)","Billable","Hourly Rate","Earnings","Status","Category","Tags"],o=[a,...e.map(u=>{const f=t.find(y=>y.id===u.projectId),m=i.find(y=>y.id===u.clientId),p=(u.duration||0)/60,v=p*(u.hourlyRate||0);return[new Date(u.date).toLocaleDateString(),f?.name||"Unknown Project",m?.name||"No Client",u.description||"",u.startTime||"",u.endTime||"",p.toFixed(2),u.billable?"Yes":"No",u.hourlyRate?.toFixed(2)||"0.00",v.toFixed(2),u.status||"Pending",f?.category||"",u.tags?.join(", ")||""]})],l=Bn.aoa_to_sheet(o);return this.applyTableFormatting(l,a.length),l["!cols"]=[{width:12},{width:20},{width:18},{width:30},{width:10},{width:10},{width:12},{width:10},{width:12},{width:12},{width:12},{width:15},{width:20}],l}createProjectsSheet(e,t){const i=[["Project Performance Analysis"],["Generated on:",new Date().toLocaleDateString()],[],[" PROJECT SUMMARY"],["Project Name","Hours Logged","Percentage","Status","Budget Used"],...e.topProjects.map(o=>{const l=t.find(f=>f.name===o.name),u=l?.budget?(o.hours*(l.hourlyRate||50)/l.budget*100).toFixed(1)+"%":"No Budget";return[o.name,o.hours.toFixed(2),`${o.percentage.toFixed(1)}%`,this.getProjectStatus(o.percentage),u]}),[],[" EFFICIENCY ANALYSIS"],["Project","Planned Hours","Actual Hours","Efficiency %","Variance"],...e.projectEfficiency.map(o=>[o.project,o.plannedHours.toFixed(1),o.actualHours.toFixed(1),`${o.efficiency.toFixed(1)}%`,(o.plannedHours-o.actualHours).toFixed(1)])],a=Bn.aoa_to_sheet(i);return this.applyBasicFormatting(a),a["!cols"]=[{width:25},{width:15},{width:12},{width:15},{width:15}],a}createTrendsSheet(e){const t=[["Daily Productivity Trends"],["Analysis Period:",`${e.dailyTrends.length} days`],[],["Date","Hours Tracked","Sessions","Avg Session Length","Productivity Index"],...e.dailyTrends.map(a=>{const o=a.sessions>0?a.hours*60/a.sessions:0,l=this.calculateDailyProductivityIndex(a.hours,a.sessions);return[a.date,a.hours.toFixed(2),a.sessions.toString(),`${o.toFixed(1)} min`,l.toFixed(1)]}),[],[" TREND SUMMARY"],["Metric","Average","Best Day","Lowest Day"],["Daily Hours",(e.dailyTrends.reduce((a,o)=>a+o.hours,0)/e.dailyTrends.length).toFixed(2),Math.max(...e.dailyTrends.map(a=>a.hours)).toFixed(2),Math.min(...e.dailyTrends.map(a=>a.hours)).toFixed(2)],["Daily Sessions",(e.dailyTrends.reduce((a,o)=>a+o.sessions,0)/e.dailyTrends.length).toFixed(1),Math.max(...e.dailyTrends.map(a=>a.sessions)).toString(),Math.min(...e.dailyTrends.map(a=>a.sessions)).toString()]],i=Bn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:12},{width:15},{width:12},{width:18},{width:16}],i}createClientsSheet(e){const t=[["Client Performance Analysis"],[],[" CLIENT METRICS"],["Client Name","Hours Logged","Revenue Generated","Avg Hourly Rate","Projects"],...e.topClients.map(a=>[a.name,a.hours.toFixed(2),`$${a.revenue.toFixed(2)}`,a.hours>0?`$${(a.revenue/a.hours).toFixed(2)}`:"$0.00","1"]),[],[" REVENUE BREAKDOWN"],["Revenue Tier","Client Count","Total Revenue","Percentage"],...this.analyzeRevenueDistribution(e.topClients)],i=Bn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:25},{width:15},{width:18},{width:16},{width:12}],i}createEfficiencySheet(e){const t=[["Efficiency & Performance Analysis"],[],[" EFFICIENCY METRICS"],["Project","Planned Hours","Actual Hours","Efficiency %","Time Variance","Status"],...e.projectEfficiency.map(a=>[a.project,a.plannedHours.toFixed(1),a.actualHours.toFixed(1),`${a.efficiency.toFixed(1)}%`,`${(a.plannedHours-a.actualHours).toFixed(1)}h`,this.getEfficiencyStatus(a.efficiency)]),[],[" PRODUCTIVITY RECOMMENDATIONS"],["Area","Current Score","Target","Action Required"],["Session Management",`${e.averageSessionLength.toFixed(0)} min avg`,"90-120 min",e.averageSessionLength<90?"Increase focus time":"Optimal"],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`,">75%",e.utilizationRate<75?"Increase billable work":"Excellent"],["Project Focus",`${e.topProjects.length} active`,"<5 active",e.topProjects.length>5?"Reduce project count":"Good focus"]],i=Bn.aoa_to_sheet(t);return this.applyBasicFormatting(i),i["!cols"]=[{width:20},{width:15},{width:15},{width:12},{width:15},{width:20}],i}getStatusIndicator(e,t,i){const a=e/t;return a>=1?" Excellent":a>=.8?" Good":a>=.6?" Fair":" Needs Improvement"}getPerformanceStatus(e,t){const i=e/t;return i>=1?" Target Met":i>=.9?" Close":" Below Target"}getProjectStatus(e){return e>=30?"Primary Focus":e>=15?"Active":e>=5?"Minor":"Minimal"}getEfficiencyStatus(e){return e>=100?" On/Under Budget":e>=80?" Slight Overrun":" Over Budget"}calculateDailyProductivityIndex(e,t){const i=Math.min(e/8*100,100),a=t>0?Math.min(e*60/t/120*100,100):0;return i*.6+a*.4}analyzeRevenueDistribution(e){const t=[{name:"High Value (>$1000)",min:1e3,count:0,revenue:0},{name:"Medium Value ($500-$1000)",min:500,count:0,revenue:0},{name:"Low Value (<$500)",min:0,count:0,revenue:0}],i=e.reduce((a,o)=>a+o.revenue,0);return e.forEach(a=>{a.revenue>=1e3?(t[0].count++,t[0].revenue+=a.revenue):a.revenue>=500?(t[1].count++,t[1].revenue+=a.revenue):(t[2].count++,t[2].revenue+=a.revenue)}),t.map(a=>[a.name,a.count.toString(),`$${a.revenue.toFixed(2)}`,i>0?`${(a.revenue/i*100).toFixed(1)}%`:"0%"])}applyBasicFormatting(e){if(!e["!ref"])return;const t=Bn.decode_range(e["!ref"]);for(let i=t.s.r;i<=Math.min(t.s.r+3,t.e.r);i++)for(let a=t.s.c;a<=t.e.c;a++){const o=e[Bn.encode_cell({r:i,c:a})];o&&(o.s={font:{bold:!0}})}}applyTableFormatting(e,t){if(!e["!ref"])return;const i=Bn.decode_range(e["!ref"]);for(let a=i.s.c;a<t;a++){const o=e[Bn.encode_cell({r:0,c:a})];o&&(o.s={font:{bold:!0},fill:{fgColor:{rgb:"E5E5E5"}}})}}}const xM=new yM;class bM{generateAdvancedMetrics(e,t,i,a){const o=this.filterEntriesByDateRange(e,a),l=this.calculateTotalHours(o),u=this.calculateBillableHours(o),f=l-u,m=l>0?u/l*100:0,p=this.calculateProductivityScore(o),v=this.calculateAverageSessionLength(o),y=this.countUniqueSessions(o),S=this.getTopProjects(o,t),_=this.getTopClients(o,i),x=this.getDailyTrends(o,a),T=this.getWeeklyComparison(e,a),w=this.getProjectEfficiency(o,t);return{totalHours:l,billableHours:u,nonBillableHours:f,utilizationRate:m,productivityScore:p,averageSessionLength:v,totalSessions:y,topProjects:S,topClients:_,dailyTrends:x,weeklyComparison:T,projectEfficiency:w}}generateAdvancedCharts(e){return[{type:"doughnut",title:"Time Distribution",interactive:!0,drilldown:!0,data:{labels:["Billable Hours","Non-Billable Hours"],datasets:[{data:[e.billableHours,e.nonBillableHours],backgroundColor:["#10B981","#F59E0B"],borderWidth:0,hoverBorderWidth:2}]},options:{responsive:!0,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:t=>{const i=(t.parsed/e.totalHours*100).toFixed(1);return`${t.label}: ${t.parsed.toFixed(1)}h (${i}%)`}}}}}},{type:"line",title:"Daily Productivity Trends",interactive:!0,data:{labels:e.dailyTrends.map(t=>t.date),datasets:[{label:"Hours Tracked",data:e.dailyTrends.map(t=>t.hours),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4},{label:"Sessions",data:e.dailyTrends.map(t=>t.sessions),borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!1,yAxisID:"y1"}]},options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Hours"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Sessions"},grid:{drawOnChartArea:!1}}},plugins:{zoom:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0}},pan:{enabled:!0}}}}},{type:"bar",title:"Top Projects by Hours",interactive:!0,drilldown:!0,data:{labels:e.topProjects.map(t=>t.name),datasets:[{label:"Hours",data:e.topProjects.map(t=>t.hours),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#6366F1"],borderRadius:4}]},options:{responsive:!0,plugins:{tooltip:{callbacks:{afterLabel:t=>`${e.topProjects[t.dataIndex].percentage.toFixed(1)}% of total time`}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}},{type:"radar",title:"Project Efficiency Analysis",interactive:!0,data:{labels:e.projectEfficiency.map(t=>t.project),datasets:[{label:"Efficiency Score",data:e.projectEfficiency.map(t=>t.efficiency),backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"#3B82F6",pointBackgroundColor:"#3B82F6",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"#3B82F6"}]},options:{responsive:!0,scales:{r:{beginAtZero:!0,max:120,ticks:{stepSize:20,callback:t=>`${t}%`}}}}},{type:"bar",title:"Year-over-Year Comparison",interactive:!0,data:{labels:e.weeklyComparison.map(t=>t.week),datasets:[{label:"Current Year",data:e.weeklyComparison.map(t=>t.currentYear),backgroundColor:"#10B981"},{label:"Previous Year",data:e.weeklyComparison.map(t=>t.previousYear),backgroundColor:"#6B7280"}]},options:{responsive:!0,plugins:{tooltip:{callbacks:{afterBody:t=>{const i=t[0]?.parsed?.y||0,a=t[1]?.parsed?.y||0;return[`Change: ${a>0?((i-a)/a*100).toFixed(1):"N/A"}%`]}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}}]}async exportToExcel(e,t,i,a,o){return xM.exportReport(e,t,i,a,{includeCharts:o.includeCharts,includeSummary:!0,includeDetailedData:!0,includeTrends:!0,dateFormat:o.dateFormat||"Custom Range",reportTitle:"TimeBeacon Analytics Report",generatedBy:"TimeBeacon User"})}async exportToPDF(e,t,i){const a=this.generatePDFContent(e,t,i);return new Blob([a],{type:"text/html"})}subscribeToRealtimeUpdates(e,t=6e4){const i=setInterval(()=>{e({})},t);return()=>clearInterval(i)}scheduleReport(e){const t=crypto.randomUUID(),i=JSON.parse(localStorage.getItem("report_schedules")||"[]");return i.push({id:t,...e,createdAt:new Date().toISOString(),lastRun:null,nextRun:this.calculateNextRun(e.frequency,e.time)}),localStorage.setItem("report_schedules",JSON.stringify(i)),t}filterEntriesByDateRange(e,t){return e.filter(i=>{const a=new Date(i.date);return a>=t.start&&a<=t.end})}calculateTotalHours(e){return e.reduce((t,i)=>t+(i.duration||0),0)/60}calculateBillableHours(e){return e.filter(t=>t.billable).reduce((t,i)=>t+(i.duration||0),0)/60}calculateProductivityScore(e){const t=this.countUniqueSessions(e),i=this.calculateAverageSessionLength(e),a=this.calculateConsistencyScore(e),o=Math.min(t/8*100,100),l=Math.min(i/120*100,100),u=a*100;return o*.3+l*.4+u*.3}calculateAverageSessionLength(e){return e.length===0?0:e.reduce((i,a)=>i+(a.duration||0),0)/e.length}countUniqueSessions(e){const t=new Set;return e.forEach(i=>{const a=`${i.date}-${i.projectId}`;t.add(a)}),t.size}calculateConsistencyScore(e){const t=new Map;e.forEach(u=>{const f=u.date.split("T")[0],m=(u.duration||0)/60;t.set(f,(t.get(f)||0)+m)});const i=Array.from(t.values());if(i.length<2)return 1;const a=i.reduce((u,f)=>u+f,0)/i.length,o=i.reduce((u,f)=>u+Math.pow(f-a,2),0)/i.length,l=Math.sqrt(o);return Math.max(0,1-l/a)}getTopProjects(e,t){const i=new Map,a=this.calculateTotalHours(e);return e.forEach(o=>{const l=(o.duration||0)/60;i.set(o.projectId,(i.get(o.projectId)||0)+l)}),Array.from(i.entries()).map(([o,l])=>({name:t.find(f=>f.id===o)?.name||"Unknown Project",hours:l,percentage:l/a*100})).sort((o,l)=>l.hours-o.hours).slice(0,10)}getTopClients(e,t){const i=new Map;return e.forEach(a=>{if(a.clientId){const o=(a.duration||0)/60,l=o*(a.hourlyRate||0),u=i.get(a.clientId)||{hours:0,revenue:0};i.set(a.clientId,{hours:u.hours+o,revenue:u.revenue+l})}}),Array.from(i.entries()).map(([a,o])=>({name:t.find(u=>u.id===a)?.name||"Unknown Client",...o})).sort((a,o)=>o.hours-a.hours).slice(0,10)}getDailyTrends(e,t){const i=new Map,a=new Date(t.start);for(;a<=t.end;){const o=a.toISOString().split("T")[0];i.set(o,{hours:0,sessions:new Set}),a.setDate(a.getDate()+1)}return e.forEach(o=>{const l=o.date.split("T")[0],u=i.get(l);u&&(u.hours+=(o.duration||0)/60,u.sessions.add(`${o.projectId}-${o.startTime}`))}),Array.from(i.entries()).map(([o,l])=>({date:o,hours:l.hours,sessions:l.sessions.size})).sort((o,l)=>o.date.localeCompare(l.date))}getWeeklyComparison(e,t){return t.start.getFullYear(),[{week:"Week 1",currentYear:40,previousYear:35},{week:"Week 2",currentYear:42,previousYear:38},{week:"Week 3",currentYear:38,previousYear:40},{week:"Week 4",currentYear:45,previousYear:42}]}getProjectEfficiency(e,t){const i=new Map;return e.forEach(a=>{const o=(a.duration||0)/60;i.set(a.projectId,(i.get(a.projectId)||0)+o)}),Array.from(i.entries()).map(([a,o])=>{const l=t.find(m=>m.id===a),u=l?.estimatedHours||o*1.2,f=u>0?u/o*100:100;return{project:l?.name||"Unknown Project",plannedHours:u,actualHours:o,efficiency:Math.min(f,150)}}).slice(0,10)}generateSummarySheet(e){return[["Metric","Value"],["Total Hours",e.totalHours.toFixed(2)],["Billable Hours",e.billableHours.toFixed(2)],["Utilization Rate",`${e.utilizationRate.toFixed(1)}%`],["Productivity Score",`${e.productivityScore.toFixed(1)}%`],["Average Session Length",`${e.averageSessionLength.toFixed(1)} minutes`],["Total Sessions",e.totalSessions.toString()]]}generateDetailedSheet(e){const t=["Date","Project","Client","Description","Duration (hours)","Billable","Rate","Earnings"],i=e.map(a=>[a.date,a.projectId,a.clientId||"",a.description,((a.duration||0)/60).toFixed(2),a.billable?"Yes":"No",a.hourlyRate?.toFixed(2)||"",((a.duration||0)/60*(a.hourlyRate||0)).toFixed(2)]);return[t,...i]}generateChartsDataSheet(e){return[["Chart Type","Data"],["Top Projects",JSON.stringify(e.topProjects)],["Daily Trends",JSON.stringify(e.dailyTrends)],["Project Efficiency",JSON.stringify(e.projectEfficiency)]]}generateTrendsSheet(e){const t=["Date","Hours","Sessions"],i=e.dailyTrends.map(a=>[a.date,a.hours.toFixed(2),a.sessions.toString()]);return[t,...i]}generatePDFContent(e,t,i){return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>TimeBeacon Report</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; margin-bottom: 30px; }
          .metric { display: inline-block; margin: 10px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
          .chart-container { margin: 20px 0; page-break-inside: avoid; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>TimeBeacon Analytics Report</h1>
          <p>Generated on ${new Date().toLocaleDateString()}</p>
        </div>
        
        <div class="metrics-summary">
          <div class="metric">
            <h3>Total Hours</h3>
            <p>${e.totalHours.toFixed(2)}</p>
          </div>
          <div class="metric">
            <h3>Utilization Rate</h3>
            <p>${e.utilizationRate.toFixed(1)}%</p>
          </div>
          <div class="metric">
            <h3>Productivity Score</h3>
            <p>${e.productivityScore.toFixed(1)}%</p>
          </div>
        </div>

        <div class="top-projects">
          <h2>Top Projects</h2>
          <table>
            <tr><th>Project</th><th>Hours</th><th>Percentage</th></tr>
            ${e.topProjects.map(a=>`<tr><td>${a.name}</td><td>${a.hours.toFixed(2)}</td><td>${a.percentage.toFixed(1)}%</td></tr>`).join("")}
          </table>
        </div>
      </body>
      </html>
    `}calculateNextRun(e,t){const i=new Date,a=new Date(i);switch(e){case"daily":a.setDate(i.getDate()+1);break;case"weekly":a.setDate(i.getDate()+7);break;case"monthly":a.setMonth(i.getMonth()+1);break}if(t){const[o,l]=t.split(":").map(Number);a.setHours(o,l,0,0)}return a}}const Dd=new bM;cf.register(n6,a6,Ik,jk,Dk,xk,y6,Vk,Qk,Hk);const SM=()=>{const{user:n,checkPermission:e}=Gc(),{timeEntries:t,projects:i,clients:a}=Jb(),[o,l]=W.useState({dateRange:{start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0],preset:"month"},selectedProjects:[],selectedClients:[],selectedTeamMembers:[],reportType:"overview"}),[u,f]=W.useState([]),[m,p]=W.useState(!1),[v,y]=W.useState("pdf"),S=W.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||n.role==="manager"||e("reports","read")),[n,e]);W.useEffect(()=>{if(S){const A=[{id:"user-1",visitorId:"10001",email:"john.doe@company.com",name:"John Doe",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Developer",department:"Engineering"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10002",email:"jane.smith@company.com",name:"Jane Smith",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Designer",department:"Design"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1}];f(A)}},[S,n]);const _=W.useMemo(()=>{let A=t;const I=new Date(o.dateRange.start),D=new Date(o.dateRange.end);return A=A.filter(z=>{const L=new Date(z.date);return L>=I&&L<=D}),o.selectedProjects.length>0&&(A=A.filter(z=>o.selectedProjects.includes(z.projectId))),o.selectedClients.length>0&&(A=A.filter(z=>z.clientId&&o.selectedClients.includes(z.clientId))),S&&o.selectedTeamMembers.length>0?A=A.filter(z=>o.selectedTeamMembers.includes(z.userId||n?.id||"")):S||(A=A.filter(z=>z.userId===n?.id)),A},[t,o,S,n]),x=W.useMemo(()=>{const A={start:new Date(o.dateRange.start),end:new Date(o.dateRange.end)};return Dd.generateAdvancedMetrics(_,i,a,A)},[_,i,a,o.dateRange]),T=W.useMemo(()=>Dd.generateAdvancedCharts(x),[x]),w=A=>{const I=new Date;let D=new Date,z=new Date;switch(A){case"today":D=new Date(I),z=new Date(I);break;case"week":D=new Date(I.getTime()-7*24*60*60*1e3);break;case"month":D=new Date(I.getFullYear(),I.getMonth(),1);break;case"quarter":const L=Math.floor(I.getMonth()/3);D=new Date(I.getFullYear(),L*3,1);break;case"year":D=new Date(I.getFullYear(),0,1);break;default:return}l(L=>({...L,dateRange:{start:D.toISOString().split("T")[0],end:z.toISOString().split("T")[0],preset:A}}))},E=async A=>{p(!0);try{let I,D;switch(A){case"pdf":I=await Dd.exportToPDF(x,T,{format:"pdf",includeCharts:!0,template:"detailed"}),D=`timebeacon-report-${o.dateRange.start}-to-${o.dateRange.end}.pdf`;break;case"excel":I=await Dd.exportToExcel(x,_,i,a,{format:"xlsx",includeCharts:!0,template:"detailed"}),D=`timebeacon-report-${o.dateRange.start}-to-${o.dateRange.end}.xlsx`;break;case"png":I=await C(),D=`timebeacon-charts-${o.dateRange.start}-to-${o.dateRange.end}.zip`;break;default:throw new Error("Unsupported export format")}const z=URL.createObjectURL(I),L=document.createElement("a");L.href=z,L.download=D,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(z)}catch(I){console.error("Export failed:",I),alert("Export failed. Please try again.")}finally{p(!1)}},C=async()=>{const A=JSON.stringify({message:"Chart images would be here"});return new Blob([A],{type:"application/json"})},N=(A,I)=>{const D={data:A.data,options:{...A.options,responsive:!0,maintainAspectRatio:!1}};switch(A.type){case"doughnut":return d.jsx(j6,{...D},I);case"line":return d.jsx(A6,{...D},I);case"bar":return d.jsx(k6,{...D},I);case"radar":return d.jsx(C6,{...D},I);default:return d.jsx("div",{children:"Unsupported chart type"},I)}};return d.jsxs("div",{className:"enhanced-reports",children:[d.jsxs("div",{className:"reports-header",children:[d.jsx("h1",{children:"Analytics & Reports"}),d.jsx("p",{children:"Comprehensive analytics and insights for your time tracking data"})]}),d.jsxs("div",{className:"reports-filters",children:[d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Date Range"}),d.jsx("div",{className:"date-presets",children:["today","week","month","quarter","year"].map(A=>d.jsx("button",{className:`preset-button ${o.dateRange.preset===A?"active":""}`,onClick:()=>w(A),children:A.charAt(0).toUpperCase()+A.slice(1)},A))}),d.jsxs("div",{className:"custom-date-range",children:[d.jsx("input",{type:"date",value:o.dateRange.start,onChange:A=>l(I=>({...I,dateRange:{...I.dateRange,start:A.target.value,preset:"custom"}}))}),d.jsx("span",{children:"to"}),d.jsx("input",{type:"date",value:o.dateRange.end,onChange:A=>l(I=>({...I,dateRange:{...I.dateRange,end:A.target.value,preset:"custom"}}))})]})]}),S&&u.length>0&&d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Team Members"}),d.jsxs("div",{className:"team-member-filters",children:[d.jsx("button",{className:`filter-button ${o.selectedTeamMembers.length===0?"active":""}`,onClick:()=>l(A=>({...A,selectedTeamMembers:[]})),children:"All Team Members"}),u.map(A=>d.jsxs("button",{className:`filter-button ${o.selectedTeamMembers.includes(A.id)?"active":""}`,onClick:()=>{l(I=>({...I,selectedTeamMembers:I.selectedTeamMembers.includes(A.id)?I.selectedTeamMembers.filter(D=>D!==A.id):[...I.selectedTeamMembers,A.id]}))},children:[A.name," (",A.profile?.jobTitle,")"]},A.id))]})]}),d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Projects"}),d.jsxs("div",{className:"project-filters",children:[d.jsx("button",{className:`filter-button ${o.selectedProjects.length===0?"active":""}`,onClick:()=>l(A=>({...A,selectedProjects:[]})),children:"All Projects"}),i.slice(0,8).map(A=>d.jsx("button",{className:`filter-button ${o.selectedProjects.includes(A.id)?"active":""}`,onClick:()=>{l(I=>({...I,selectedProjects:I.selectedProjects.includes(A.id)?I.selectedProjects.filter(D=>D!==A.id):[...I.selectedProjects,A.id]}))},children:A.name},A.id))]})]}),d.jsxs("div",{className:"filter-section",children:[d.jsx("h3",{children:"Export Reports"}),d.jsxs("div",{className:"export-controls",children:[d.jsxs("select",{value:v,onChange:A=>y(A.target.value),children:[d.jsx("option",{value:"pdf",children:"PDF Report"}),d.jsx("option",{value:"excel",children:"Excel Spreadsheet"}),d.jsx("option",{value:"png",children:"Chart Images"})]}),d.jsx("button",{className:"export-button",onClick:()=>E(v),disabled:m,children:m?"Exporting...":"Export"})]})]})]}),d.jsxs("div",{className:"summary-cards",children:[d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Total Hours"}),d.jsxs("div",{className:"metric-value",children:[x.totalHours.toFixed(1),"h"]}),d.jsxs("div",{className:"metric-subtitle",children:[x.billableHours.toFixed(1),"h billable"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Utilization"}),d.jsxs("div",{className:"metric-value",children:[x.utilizationRate.toFixed(1),"%"]}),d.jsx("div",{className:"metric-subtitle",children:x.utilizationRate>=75?"Excellent":x.utilizationRate>=50?"Good":"Needs Improvement"})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Productivity"}),d.jsxs("div",{className:"metric-value",children:[x.productivityScore.toFixed(1),"%"]}),d.jsxs("div",{className:"metric-subtitle",children:[x.totalSessions," sessions tracked"]})]}),d.jsxs("div",{className:"summary-card",children:[d.jsx("h3",{children:"Top Project"}),d.jsx("div",{className:"metric-value",children:x.topProjects[0]?.name||"No data"}),d.jsxs("div",{className:"metric-subtitle",children:[x.topProjects[0]?.hours.toFixed(1),"h logged"]})]})]}),d.jsx("div",{className:"charts-grid",children:T.map((A,I)=>d.jsxs("div",{className:"chart-container",children:[d.jsx("h3",{children:A.title}),d.jsx("div",{className:"chart-wrapper",children:N(A,I)})]},I))}),d.jsxs("div",{className:"data-table-section",children:[d.jsx("h3",{children:"Detailed Time Entries"}),d.jsxs("div",{className:"table-container",children:[d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Duration"}),d.jsx("th",{children:"Billable"}),S&&d.jsx("th",{children:"Team Member"}),d.jsx("th",{children:"Status"})]})}),d.jsx("tbody",{children:_.slice(0,50).map((A,I)=>d.jsxs("tr",{children:[d.jsx("td",{children:new Date(A.date).toLocaleDateString()}),d.jsx("td",{children:i.find(D=>D.id===A.projectId)?.name||"Unknown"}),d.jsx("td",{children:A.description}),d.jsxs("td",{children:[((A.duration||0)/60).toFixed(1),"h"]}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${A.billable?"billable":"non-billable"}`,children:A.billable?"Billable":"Non-billable"})}),S&&d.jsx("td",{children:u.find(D=>D.id===A.userId)?.name||"You"}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${A.status||"pending"}`,children:A.status||"pending"})})]},I))})]}),_.length>50&&d.jsx("div",{className:"table-footer",children:d.jsx("p",{children:"Showing first 50 entries. Export for complete data."})})]})]}),d.jsx("style",{jsx:!0,children:`
        .enhanced-reports {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }

        .reports-header {
          text-align: center;
          margin-bottom: 30px;
        }

        .reports-header h1 {
          font-size: 2.5rem;
          margin-bottom: 10px;
          color: #1f2937;
        }

        .reports-filters {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 30px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .filter-section {
          margin-bottom: 20px;
        }

        .filter-section h3 {
          margin-bottom: 10px;
          color: #374151;
          font-size: 1.1rem;
        }

        .date-presets, .team-member-filters, .project-filters {
          display: flex;
          gap: 8px;
          flex-wrap: wrap;
          margin-bottom: 10px;
        }

        .preset-button, .filter-button {
          padding: 8px 16px;
          border: 2px solid #e5e7eb;
          border-radius: 8px;
          background: white;
          cursor: pointer;
          transition: all 0.2s;
          font-size: 0.9rem;
        }

        .preset-button:hover, .filter-button:hover {
          border-color: #3b82f6;
          background: #eff6ff;
        }

        .preset-button.active, .filter-button.active {
          background: #3b82f6;
          color: white;
          border-color: #3b82f6;
        }

        .custom-date-range {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-top: 10px;
        }

        .custom-date-range input {
          padding: 8px 12px;
          border: 1px solid #d1d5db;
          border-radius: 6px;
        }

        .export-controls {
          display: flex;
          gap: 10px;
          align-items: center;
        }

        .export-controls select {
          padding: 8px 12px;
          border: 1px solid #d1d5db;
          border-radius: 6px;
          background: white;
        }

        .export-button {
          padding: 8px 16px;
          background: #10b981;
          color: white;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          transition: background 0.2s;
        }

        .export-button:hover:not(:disabled) {
          background: #059669;
        }

        .export-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .summary-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .summary-card {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
          text-align: center;
        }

        .summary-card h3 {
          margin-bottom: 10px;
          color: #6b7280;
          font-size: 1rem;
        }

        .metric-value {
          font-size: 2rem;
          font-weight: bold;
          color: #1f2937;
          margin-bottom: 5px;
        }

        .metric-subtitle {
          color: #6b7280;
          font-size: 0.9rem;
        }

        .charts-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .chart-container {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .chart-container h3 {
          margin-bottom: 15px;
          color: #374151;
          text-align: center;
        }

        .chart-wrapper {
          height: 300px;
          position: relative;
        }

        .data-table-section {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .table-container {
          overflow-x: auto;
        }

        .data-table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
        }

        .data-table th,
        .data-table td {
          padding: 12px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .data-table th {
          background: #f9fafb;
          font-weight: 600;
          color: #374151;
        }

        .data-table tr:hover {
          background: #f9fafb;
        }

        .status-badge {
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 0.8rem;
          font-weight: 500;
        }

        .status-badge.billable {
          background: #d1fae5;
          color: #065f46;
        }

        .status-badge.non-billable {
          background: #fef3c7;
          color: #92400e;
        }

        .status-badge.pending {
          background: #e0e7ff;
          color: #3730a3;
        }

        .status-badge.approved {
          background: #d1fae5;
          color: #065f46;
        }

        .table-footer {
          text-align: center;
          margin-top: 15px;
          color: #6b7280;
          font-style: italic;
        }

        @media (max-width: 768px) {
          .charts-grid {
            grid-template-columns: 1fr;
          }
          
          .summary-cards {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          }
          
          .date-presets, .team-member-filters, .project-filters {
            flex-direction: column;
          }
        }
      `})]})},_M=()=>{const{user:n,checkPermission:e}=Gc(),[t,i]=W.useState([]),[a,o]=W.useState(null),[l,u]=W.useState([]),[f,m]=W.useState([]),[p,v]=W.useState(!0),[y,S]=W.useState("roles"),_=W.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||e("users","manage")),[n,e]),x=W.useMemo(()=>n&&(n.role==="owner"||n.role==="admin"||n.role==="manager"||e("teams","manage")),[n,e]);W.useEffect(()=>{(_||x)&&T()},[_,x]);const T=async()=>{v(!0);try{const N=[{id:"user-1",visitorId:"10001",email:"john.doe@company.com",name:"John Doe",companyId:n?.companyId||"",role:"individual_contributor",permissions:[],profile:{firstName:"John",lastName:"Doe",jobTitle:"Senior Developer",department:"Engineering",manager:n?.id,accessLevel:"senior"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1},{id:"user-2",visitorId:"10002",email:"jane.smith@company.com",name:"Jane Smith",companyId:n?.companyId||"",role:"manager",permissions:[],profile:{firstName:"Jane",lastName:"Smith",jobTitle:"Engineering Manager",department:"Engineering",directReports:["user-1","user-3"],accessLevel:"elevated"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!0},{id:"user-3",visitorId:"10003",email:"mike.wilson@company.com",name:"Mike Wilson",companyId:n?.companyId||"",role:"employee",permissions:[],profile:{firstName:"Mike",lastName:"Wilson",jobTitle:"Junior Developer",department:"Engineering",manager:"user-2",accessLevel:"basic"},settings:{},status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mfaEnabled:!1}];i(N);const A=[{userId:"user-1",managerId:n?.id||"",department:"Engineering",startDate:"2024-01-01"},{userId:"user-3",managerId:"user-2",department:"Engineering",startDate:"2024-02-01"}];u(A);const I=[{id:"1",userId:"user-1",action:"granted",permission:"Project Lead Access",grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:"Promoted to Senior Developer"},{id:"2",userId:"user-2",action:"granted",permission:"Team Management",grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:"Assigned as Engineering Manager"}];m(I)}catch(N){console.error("Failed to load permissions data:",N)}finally{v(!1)}},w=async(N,A,I)=>{if(_)try{const D=t.find(H=>H.id===N);if(!D)return;const z={...D,role:A};i(H=>H.map(K=>K.id===N?z:K));const L={id:Date.now().toString(),userId:N,action:"modified",permission:`Role changed to ${Oo[A].title}`,grantedBy:n?.id||"",timestamp:new Date().toISOString(),reason:I};m(H=>[L,...H]),console.log(` Updated ${D.name} role to ${A}`)}catch(D){console.error("Failed to update user role:",D)}},E=N=>[...lb[N.role]||[],...N.permissions],C=W.useMemo(()=>n?n.role==="owner"||n.role==="admin"?t:n.role==="manager"?t.filter(N=>N.profile?.manager===n.id):[]:[],[t,n]);return!_&&!x?d.jsx("div",{className:"permissions-manager",children:d.jsxs("div",{className:"access-denied",children:[d.jsx("h2",{children:"Access Denied"}),d.jsx("p",{children:"You don't have permission to manage user roles and permissions."})]})}):p?d.jsxs("div",{className:"permissions-manager loading",children:[d.jsx("div",{className:"loading-spinner"}),d.jsx("p",{children:"Loading permissions data..."})]}):d.jsxs("div",{className:"permissions-manager",children:[d.jsxs("div",{className:"permissions-header",children:[d.jsx("h1",{children:"Permissions & Team Management"}),d.jsx("p",{children:"Manage user roles, permissions, and team assignments"})]}),d.jsxs("div",{className:"permissions-tabs",children:[d.jsx("button",{className:`tab ${y==="roles"?"active":""}`,onClick:()=>S("roles"),children:"Roles & Users"}),d.jsx("button",{className:`tab ${y==="permissions"?"active":""}`,onClick:()=>S("permissions"),children:"Permissions"}),x&&d.jsx("button",{className:`tab ${y==="teams"?"active":""}`,onClick:()=>S("teams"),children:"Team Management"}),d.jsx("button",{className:`tab ${y==="audit"?"active":""}`,onClick:()=>S("audit"),children:"Audit Log"})]}),y==="roles"&&d.jsxs("div",{className:"roles-section",children:[d.jsx("h2",{children:"User Roles"}),d.jsxs("div",{className:"role-hierarchy",children:[d.jsx("h3",{children:"Role Hierarchy"}),d.jsx("div",{className:"role-cards",children:Object.entries(Oo).sort(([,N],[,A])=>A.level-N.level).map(([N,A])=>d.jsxs("div",{className:"role-card",children:[d.jsx("div",{className:"role-title",children:A.title}),d.jsxs("div",{className:"role-level",children:["Level ",A.level]}),d.jsx("div",{className:"role-description",children:A.description}),d.jsxs("div",{className:"role-count",children:[t.filter(I=>I.role===N).length," users"]})]},N))})]}),d.jsxs("div",{className:"users-list",children:[d.jsx("h3",{children:"Manage Users"}),d.jsx("div",{className:"users-table",children:d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Name"}),d.jsx("th",{children:"Email"}),d.jsx("th",{children:"Current Role"}),d.jsx("th",{children:"Department"}),d.jsx("th",{children:"Manager"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:C.map(N=>d.jsxs("tr",{children:[d.jsx("td",{children:d.jsxs("div",{className:"user-info",children:[d.jsx("strong",{children:N.name}),d.jsx("div",{className:"user-title",children:N.profile?.jobTitle})]})}),d.jsx("td",{children:N.email}),d.jsx("td",{children:d.jsx("span",{className:`role-badge ${N.role}`,children:Oo[N.role].title})}),d.jsx("td",{children:N.profile?.department||"Unassigned"}),d.jsx("td",{children:N.profile?.manager?t.find(A=>A.id===N.profile?.manager)?.name||"Unknown":"None"}),d.jsx("td",{children:d.jsxs("div",{className:"user-actions",children:[d.jsx("select",{value:N.role,onChange:A=>w(N.id,A.target.value,"Role change via admin panel"),disabled:!_,children:Object.entries(Oo).map(([A,I])=>d.jsx("option",{value:A,children:I.title},A))}),d.jsx("button",{className:"btn btn-sm",onClick:()=>o(N),children:"Details"})]})})]},N.id))})]})})]})]}),y==="permissions"&&d.jsxs("div",{className:"permissions-section",children:[d.jsx("h2",{children:"Detailed Permissions"}),a?d.jsxs("div",{className:"user-permissions",children:[d.jsxs("h3",{children:["Permissions for ",a.name]}),d.jsx("div",{className:"permission-categories",children:Object.entries(E(a).reduce((N,A)=>(N[A.resource]||(N[A.resource]=[]),N[A.resource].push(A),N),{})).map(([N,A])=>d.jsxs("div",{className:"permission-category",children:[d.jsx("h4",{children:N.charAt(0).toUpperCase()+N.slice(1)}),d.jsx("div",{className:"permission-actions",children:A.map((I,D)=>d.jsxs("div",{className:"permission-item",children:[d.jsx("div",{className:"permission-actions-list",children:I.actions.map(z=>d.jsx("span",{className:"action-badge",children:z},z))}),I.scope&&d.jsxs("div",{className:"permission-scope",children:["Scope: ",I.scope.all?"All":I.scope.own?"Own Data Only":I.scope.team?"Team Members":I.scope.department?"Department":"Limited"]})]},D))})]},N))}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>o(null),children:"Back to Users"})]}):d.jsx("div",{className:"select-user",children:d.jsx("p",{children:"Select a user from the Roles tab to view their detailed permissions."})})]}),y==="teams"&&x&&d.jsxs("div",{className:"teams-section",children:[d.jsx("h2",{children:"Team Assignments"}),d.jsxs("div",{className:"team-structure",children:[d.jsx("h3",{children:"Organizational Structure"}),d.jsx("div",{className:"org-chart",children:t.filter(N=>N.role==="manager"||N.role==="admin"||N.role==="owner").map(N=>d.jsxs("div",{className:"manager-group",children:[d.jsxs("div",{className:"manager-card",children:[d.jsx("h4",{children:N.name}),d.jsx("div",{className:"manager-role",children:Oo[N.role].title}),d.jsx("div",{className:"manager-department",children:N.profile?.department})]}),d.jsx("div",{className:"direct-reports",children:t.filter(A=>A.profile?.manager===N.id).map(A=>d.jsxs("div",{className:"report-card",children:[d.jsx("div",{className:"report-name",children:A.name}),d.jsx("div",{className:"report-role",children:Oo[A.role].title}),d.jsx("div",{className:"report-title",children:A.profile?.jobTitle})]},A.id))})]},N.id))})]}),d.jsxs("div",{className:"team-assignments",children:[d.jsx("h3",{children:"Team Assignments"}),d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Team Member"}),d.jsx("th",{children:"Manager"}),d.jsx("th",{children:"Department"}),d.jsx("th",{children:"Start Date"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:l.map(N=>{const A=t.find(D=>D.id===N.userId),I=t.find(D=>D.id===N.managerId);return d.jsxs("tr",{children:[d.jsx("td",{children:A?.name||"Unknown"}),d.jsx("td",{children:I?.name||"Unknown"}),d.jsx("td",{children:N.department}),d.jsx("td",{children:new Date(N.startDate).toLocaleDateString()}),d.jsx("td",{children:d.jsx("button",{className:"btn btn-sm btn-secondary",children:"Reassign"})})]},N.userId)})})]})]})]}),y==="audit"&&d.jsxs("div",{className:"audit-section",children:[d.jsx("h2",{children:"Permission Audit Log"}),d.jsx("div",{className:"audit-log",children:f.map(N=>d.jsxs("div",{className:"audit-entry",children:[d.jsxs("div",{className:"audit-header",children:[d.jsx("span",{className:`audit-action ${N.action}`,children:N.action.charAt(0).toUpperCase()+N.action.slice(1)}),d.jsx("span",{className:"audit-timestamp",children:new Date(N.timestamp).toLocaleString()})]}),d.jsxs("div",{className:"audit-details",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"User:"})," ",t.find(A=>A.id===N.userId)?.name||"Unknown"]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Permission:"})," ",N.permission]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Changed by:"})," ",t.find(A=>A.id===N.grantedBy)?.name||"System"]}),N.reason&&d.jsxs("div",{children:[d.jsx("strong",{children:"Reason:"})," ",N.reason]})]})]},N.id))})]}),d.jsx("style",{jsx:!0,children:`
        .permissions-manager {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }

        .permissions-header {
          text-align: center;
          margin-bottom: 30px;
        }

        .permissions-header h1 {
          font-size: 2.5rem;
          margin-bottom: 10px;
          color: #1f2937;
        }

        .permissions-tabs {
          display: flex;
          border-bottom: 2px solid #e5e7eb;
          margin-bottom: 30px;
        }

        .tab {
          padding: 12px 24px;
          border: none;
          background: none;
          cursor: pointer;
          border-bottom: 3px solid transparent;
          font-weight: 500;
          transition: all 0.2s;
        }

        .tab:hover {
          background: #f3f4f6;
        }

        .tab.active {
          border-bottom-color: #3b82f6;
          color: #3b82f6;
        }

        .role-hierarchy {
          background: white;
          border-radius: 12px;
          padding: 20px;
          margin-bottom: 30px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .role-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 15px;
        }

        .role-card {
          border: 2px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
          text-align: center;
          transition: all 0.2s;
        }

        .role-card:hover {
          border-color: #3b82f6;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }

        .role-title {
          font-size: 1.1rem;
          font-weight: 600;
          margin-bottom: 5px;
        }

        .role-level {
          font-size: 0.9rem;
          color: #6b7280;
          margin-bottom: 8px;
        }

        .role-description {
          font-size: 0.85rem;
          color: #374151;
          margin-bottom: 8px;
          line-height: 1.4;
        }

        .role-count {
          font-size: 0.8rem;
          color: #059669;
          font-weight: 500;
        }

        .users-list {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .users-table {
          overflow-x: auto;
        }

        .users-table table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
        }

        .users-table th,
        .users-table td {
          padding: 12px;
          text-align: left;
          border-bottom: 1px solid #e5e7eb;
        }

        .users-table th {
          background: #f9fafb;
          font-weight: 600;
          color: #374151;
        }

        .user-info strong {
          display: block;
          margin-bottom: 4px;
        }

        .user-title {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .role-badge {
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 0.8rem;
          font-weight: 500;
        }

        .role-badge.owner { background: #fef3c7; color: #92400e; }
        .role-badge.admin { background: #ddd6fe; color: #5b21b6; }
        .role-badge.manager { background: #d1fae5; color: #065f46; }
        .role-badge.individual_contributor { background: #e0e7ff; color: #3730a3; }
        .role-badge.employee { background: #e5e7eb; color: #374151; }
        .role-badge.viewer { background: #f3f4f6; color: #6b7280; }

        .user-actions {
          display: flex;
          gap: 8px;
          align-items: center;
        }

        .user-actions select {
          padding: 4px 8px;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 0.8rem;
        }

        .btn {
          padding: 8px 16px;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          font-weight: 500;
          transition: all 0.2s;
        }

        .btn-sm {
          padding: 4px 8px;
          font-size: 0.8rem;
        }

        .btn-secondary {
          background: #6b7280;
          color: white;
        }

        .btn-secondary:hover {
          background: #4b5563;
        }

        .permission-categories {
          display: grid;
          gap: 20px;
        }

        .permission-category {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .permission-category h4 {
          margin-bottom: 10px;
          color: #374151;
          border-bottom: 1px solid #e5e7eb;
          padding-bottom: 5px;
        }

        .permission-item {
          margin-bottom: 10px;
        }

        .permission-actions-list {
          display: flex;
          gap: 6px;
          flex-wrap: wrap;
          margin-bottom: 5px;
        }

        .action-badge {
          padding: 2px 6px;
          background: #3b82f6;
          color: white;
          border-radius: 4px;
          font-size: 0.7rem;
        }

        .permission-scope {
          font-size: 0.8rem;
          color: #6b7280;
          font-style: italic;
        }

        .org-chart {
          display: flex;
          flex-direction: column;
          gap: 20px;
        }

        .manager-group {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .manager-card {
          background: #f8fafc;
          border-radius: 6px;
          padding: 12px;
          margin-bottom: 15px;
        }

        .manager-card h4 {
          margin-bottom: 5px;
        }

        .manager-role, .manager-department {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .direct-reports {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
          gap: 10px;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 10px;
        }

        .report-name {
          font-weight: 500;
          margin-bottom: 4px;
        }

        .report-role, .report-title {
          font-size: 0.8rem;
          color: #6b7280;
        }

        .audit-log {
          display: flex;
          flex-direction: column;
          gap: 15px;
        }

        .audit-entry {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 15px;
        }

        .audit-header {
          display: flex;
          justify-content: between;
          align-items: center;
          margin-bottom: 10px;
        }

        .audit-action {
          font-weight: 600;
          margin-right: 10px;
        }

        .audit-action.granted { color: #059669; }
        .audit-action.revoked { color: #dc2626; }
        .audit-action.modified { color: #d97706; }

        .audit-timestamp {
          font-size: 0.8rem;
          color: #6b7280;
          margin-left: auto;
        }

        .audit-details {
          display: grid;
          gap: 4px;
          font-size: 0.9rem;
        }

        .access-denied, .select-user {
          text-align: center;
          padding: 40px;
          background: white;
          border-radius: 12px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .loading {
          text-align: center;
          padding: 40px;
        }

        .loading-spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top: 4px solid #3b82f6;
          border-radius: 50%;
          animation: spin 1s linear infinite;
          margin: 0 auto 20px;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .role-cards {
            grid-template-columns: 1fr;
          }
          
          .permissions-tabs {
            flex-wrap: wrap;
          }
          
          .direct-reports {
            grid-template-columns: 1fr;
          }
        }
      `})]})},fc={name:"",email:"",company:"",jobTitle:"",phone:"",startTime:"09:00",endTime:"17:00",timezone:"America/New_York",browserNotifications:!1,emailNotifications:{enabled:!1,cadence:"daily",time:"17:00",weeklyDay:"friday"},slackNotifications:{enabled:!1,cadence:"realtime",channel:"",dailyTime:"17:00",weeklyDay:"friday",weeklyTime:"09:00"},autoBreaks:!1},TM=()=>{const[n,e]=W.useState(fc),[t,i]=W.useState(fc),[a,o]=W.useState(""),[l,u]=W.useState(!1);W.useEffect(()=>{try{const x=localStorage.getItem("timebeacon_settings_simplified");if(x){const T=JSON.parse(x),w={...fc,...T,emailNotifications:{...fc.emailNotifications,...T.emailNotifications||{}},slackNotifications:{...fc.slackNotifications,...T.slackNotifications||{}}};e(w),i(w)}}catch(x){console.error("Failed to load settings:",x)}},[]);const f=()=>{try{if(n.slackNotifications.enabled&&!n.slackNotifications.channel?.trim()){o("Error: Slack channel required!"),setTimeout(()=>o(""),4e3);return}o("Saving..."),localStorage.setItem("timebeacon_settings_simplified",JSON.stringify(n)),i(n),u(!1),o("Saved "),setTimeout(()=>o(""),3e3),console.log("Settings saved:",n)}catch(x){console.error("Save failed:",x),o("Save failed!"),setTimeout(()=>o(""),3e3)}},m=(x,T)=>{const w={...n,[x]:T};e(w),u(JSON.stringify(w)!==JSON.stringify(t))},p=()=>{try{const x=JSON.parse(localStorage.getItem("timebeacon_entries_v6")||"[]");if(x.length===0){alert("No time entries found");return}const T=["Date,Start Time,End Time,Duration,Project,Client,Description,Billable",...x.map(N=>`"${N.date}","${N.startTime}","${N.endTime}",${N.duration},"${N.project}","${N.client}","${N.description}",${N.billable?"Yes":"No"}`)].join("\\n"),w=new Blob([T],{type:"text/csv"}),E=URL.createObjectURL(w),C=document.createElement("a");C.href=E,C.download=`timebeacon-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(E),alert(`Exported ${x.length} entries!`)}catch{alert("Export failed!")}},v={width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px",backgroundColor:"white"},y={display:"block",marginBottom:"6px",fontWeight:"500",color:"#333"},S={backgroundColor:"white",border:"1px solid #e5e5e5",borderRadius:"8px",padding:"24px",marginBottom:"20px"},_={backgroundColor:l?"#3b82f6":"#94a3b8",color:"white",border:"none",borderRadius:"6px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:l?"pointer":"not-allowed",transition:"all 0.2s",minWidth:"120px"};return d.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",padding:"20px"},children:[d.jsxs("div",{style:{marginBottom:"32px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#111",marginBottom:"8px"},children:"Settings"}),d.jsx("p",{style:{color:"#666",fontSize:"16px"},children:"Configure your TimeBeacon preferences"})]}),d.jsx("button",{onClick:f,disabled:!l,style:_,children:a==="Saving..."?"Saving...":l?"Save Settings":"No Changes"})]}),l&&d.jsx("div",{style:{padding:"12px 16px",backgroundColor:"#fef3c7",color:"#92400e",borderRadius:"6px",fontSize:"14px",border:"1px solid #fcd34d",marginTop:"12px"},children:" You have unsaved changes"})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Profile Information"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Full Name"}),d.jsx("input",{type:"text",value:n.name,onChange:x=>m("name",x.target.value),placeholder:"Enter your name",style:v})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Email"}),d.jsx("input",{type:"email",value:n.email,onChange:x=>m("email",x.target.value),placeholder:"Enter your email",style:v})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Company"}),d.jsx("input",{type:"text",value:n.company,onChange:x=>m("company",x.target.value),placeholder:"Enter your company",style:v})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Job Title"}),d.jsx("input",{type:"text",value:n.jobTitle,onChange:x=>m("jobTitle",x.target.value),placeholder:"Enter your job title",style:v})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Phone"}),d.jsx("input",{type:"tel",value:n.phone,onChange:x=>m("phone",x.target.value),placeholder:"Enter your phone number",style:v})]})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Working Hours"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Start Time"}),d.jsx("input",{type:"time",value:n.startTime,onChange:x=>m("startTime",x.target.value),style:v})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"End Time"}),d.jsx("input",{type:"time",value:n.endTime,onChange:x=>m("endTime",x.target.value),style:v})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Timezone"}),d.jsxs("select",{value:n.timezone,onChange:x=>m("timezone",x.target.value),style:v,children:[d.jsx("option",{value:"America/New_York",children:"Eastern Time"}),d.jsx("option",{value:"America/Chicago",children:"Central Time"}),d.jsx("option",{value:"America/Denver",children:"Mountain Time"}),d.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),d.jsx("option",{value:"UTC",children:"UTC"})]})]})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Notifications"}),d.jsx("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"#f8fafc",borderRadius:"8px"},children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",marginBottom:"8px"},children:[d.jsx("input",{type:"checkbox",checked:n.browserNotifications,onChange:x=>m("browserNotifications",x.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"600",color:"#374151"},children:"Browser Notifications"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Get notified in your browser for time tracking reminders"})]})]})}),d.jsxs("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:n.emailNotifications.enabled?"#f0f9ff":"#f8fafc",borderRadius:"8px",border:n.emailNotifications.enabled?"2px solid #3b82f6":"1px solid #e2e8f0"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",marginBottom:"16px"},children:[d.jsx("input",{type:"checkbox",checked:n.emailNotifications.enabled,onChange:x=>m("emailNotifications",{...n.emailNotifications,enabled:x.target.checked}),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontWeight:"600",color:"#374151"},children:["Email Notifications",n.emailNotifications.enabled&&d.jsx("span",{style:{color:"#3b82f6",marginLeft:"8px"},children:" Enabled"})]}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Receive time tracking summaries and reminders via email"})]})]}),n.emailNotifications.enabled&&d.jsxs("div",{style:{marginTop:"16px"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Notification Frequency"}),d.jsxs("select",{value:n.emailNotifications.cadence,onChange:x=>m("emailNotifications",{...n.emailNotifications,cadence:x.target.value}),style:v,children:[d.jsx("option",{value:"realtime",children:"Real-time (immediate)"}),d.jsx("option",{value:"hourly",children:"Every hour"}),d.jsx("option",{value:"daily",children:"Daily digest"}),d.jsx("option",{value:"weekly",children:"Weekly summary"})]})]}),n.emailNotifications.cadence==="daily"&&d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Daily Email Time"}),d.jsx("input",{type:"time",value:n.emailNotifications.time||"17:00",onChange:x=>m("emailNotifications",{...n.emailNotifications,time:x.target.value}),style:v})]})]}),n.emailNotifications.cadence==="weekly"&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Day"}),d.jsxs("select",{value:n.emailNotifications.weeklyDay||"friday",onChange:x=>m("emailNotifications",{...n.emailNotifications,weeklyDay:x.target.value}),style:v,children:[d.jsx("option",{value:"monday",children:"Monday"}),d.jsx("option",{value:"tuesday",children:"Tuesday"}),d.jsx("option",{value:"wednesday",children:"Wednesday"}),d.jsx("option",{value:"thursday",children:"Thursday"}),d.jsx("option",{value:"friday",children:"Friday"}),d.jsx("option",{value:"saturday",children:"Saturday"}),d.jsx("option",{value:"sunday",children:"Sunday"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Email Time"}),d.jsx("input",{type:"time",value:n.emailNotifications.time||"17:00",onChange:x=>m("emailNotifications",{...n.emailNotifications,time:x.target.value}),style:v})]})]})]})]}),d.jsxs("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:n.slackNotifications.enabled?"#f0f9ff":"#f8fafc",borderRadius:"8px",border:n.slackNotifications.enabled?"2px solid #3b82f6":"1px solid #e2e8f0"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",marginBottom:"16px"},children:[d.jsx("input",{type:"checkbox",checked:n.slackNotifications.enabled,onChange:x=>m("slackNotifications",{...n.slackNotifications,enabled:x.target.checked}),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontWeight:"600",color:"#374151"},children:["Slack Notifications",n.slackNotifications.enabled&&d.jsx("span",{style:{color:"#3b82f6",marginLeft:"8px"},children:" Enabled"})]}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Send time tracking updates to a specific Slack channel or user"})]})]}),n.slackNotifications.enabled&&d.jsxs("div",{style:{marginTop:"16px"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Notification Frequency"}),d.jsxs("select",{value:n.slackNotifications.cadence,onChange:x=>m("slackNotifications",{...n.slackNotifications,cadence:x.target.value}),style:v,children:[d.jsx("option",{value:"realtime",children:"Real-time updates"}),d.jsx("option",{value:"hourly",children:"Hourly summaries"}),d.jsx("option",{value:"daily",children:"Daily reports"}),d.jsx("option",{value:"weekly",children:"Weekly summaries"})]})]}),d.jsxs("div",{children:[d.jsxs("label",{style:y,children:["Slack Channel/User ",d.jsx("span",{style:{color:"#ef4444",fontSize:"14px"},children:"*"})]}),d.jsx("input",{type:"text",value:n.slackNotifications.channel||"",onChange:x=>m("slackNotifications",{...n.slackNotifications,channel:x.target.value}),placeholder:"#general, #timebeacon, or @username",style:{...v,borderColor:n.slackNotifications.enabled&&!n.slackNotifications.channel?"#ef4444":"#ccc"},required:n.slackNotifications.enabled}),n.slackNotifications.enabled&&!n.slackNotifications.channel&&d.jsx("div",{style:{fontSize:"12px",color:"#ef4444",marginTop:"4px"},children:"Channel or user is required for Slack notifications"})]})]}),n.slackNotifications.cadence==="daily"&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Daily Slack Time"}),d.jsx("input",{type:"time",value:n.slackNotifications.dailyTime||"17:00",onChange:x=>m("slackNotifications",{...n.slackNotifications,dailyTime:x.target.value}),style:v})]}),d.jsx("div",{})," "]}),n.slackNotifications.cadence==="weekly"&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Day"}),d.jsxs("select",{value:n.slackNotifications.weeklyDay||"friday",onChange:x=>m("slackNotifications",{...n.slackNotifications,weeklyDay:x.target.value}),style:v,children:[d.jsx("option",{value:"monday",children:"Monday"}),d.jsx("option",{value:"tuesday",children:"Tuesday"}),d.jsx("option",{value:"wednesday",children:"Wednesday"}),d.jsx("option",{value:"thursday",children:"Thursday"}),d.jsx("option",{value:"friday",children:"Friday"}),d.jsx("option",{value:"saturday",children:"Saturday"}),d.jsx("option",{value:"sunday",children:"Sunday"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:y,children:"Weekly Slack Time"}),d.jsx("input",{type:"time",value:n.slackNotifications.weeklyTime||"09:00",onChange:x=>m("slackNotifications",{...n.slackNotifications,weeklyTime:x.target.value}),style:v})]})]})]})]}),d.jsx("div",{style:{marginBottom:"0",padding:"16px",backgroundColor:"#f8fafc",borderRadius:"8px"},children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[d.jsx("input",{type:"checkbox",checked:n.autoBreaks,onChange:x=>m("autoBreaks",x.target.checked),style:{width:"18px",height:"18px",accentColor:"#3b82f6"}}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"600",color:"#374151"},children:"Automatic Break Detection"}),d.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Automatically detect and suggest breaks during long work sessions"})]})]})})]}),d.jsxs("div",{style:S,children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#111"},children:"Export & Tools"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[d.jsx("button",{onClick:p,style:{padding:"16px",border:"1px solid #ccc",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",textAlign:"center",fontSize:"14px"},children:" Export to CSV"}),d.jsx("button",{onClick:()=>window.location.href="/integrations",style:{padding:"16px",border:"1px solid #ccc",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",textAlign:"center",fontSize:"14px"},children:" Integrations"})]})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"24px",backgroundColor:l?"#f8fafc":"transparent",border:l?"1px solid #e2e8f0":"none",borderRadius:"8px",textAlign:"center"},children:[d.jsx("button",{onClick:f,disabled:!l,style:{..._,fontSize:"18px",padding:"16px 32px",minWidth:"200px"},children:a==="Saving..."?"Saving Changes...":l?"Save All Settings":"All Settings Saved"}),l&&d.jsx("p",{style:{marginTop:"12px",color:"#64748b",fontSize:"14px",margin:"12px 0 0 0"},children:"Don't forget to save your changes before leaving this page"})]})]})};class wM{accessToken=null;refreshToken=null;API_BASE_URL="http://localhost:3001";demoMode=!1;constructor(){this.loadStoredTokens()}loadStoredTokens(){try{const e=localStorage.getItem("google_tokens");if(e){const t=JSON.parse(e);this.accessToken=t.access_token,this.refreshToken=t.refresh_token,t.expiry_date&&Date.now()>t.expiry_date&&this.refreshAccessToken()}}catch(e){console.error("Error loading stored tokens:",e)}}async refreshAccessToken(){if(!this.refreshToken)return!1;try{const t=await(await fetch(`${this.API_BASE_URL}/auth/google/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:this.refreshToken})})).json();if(t.success)return this.accessToken=t.tokens.access_token,this.saveTokens({access_token:t.tokens.access_token,refresh_token:this.refreshToken,expiry_date:t.tokens.expiry_date}),!0}catch(e){console.error("Error refreshing token:",e)}return!1}saveTokens(e){try{localStorage.setItem("google_tokens",JSON.stringify(e))}catch(t){console.error("Error saving tokens:",t)}}async authenticateGoogle(){try{if(this.demoMode)return console.log("Demo mode: Simulating Google authentication"),this.accessToken="demo-token",localStorage.setItem("google_demo_token","demo-token"),await new Promise(e=>setTimeout(e,1e3)),!0;try{const t=await(await fetch(`${this.API_BASE_URL}/auth/google/url`)).json();if(!t.authUrl)throw new Error("Failed to get OAuth URL");const i=window.open(t.authUrl,"google-oauth","width=500,height=600,scrollbars=yes,resizable=yes");return new Promise(a=>{const o=setInterval(()=>{if(i?.closed){clearInterval(o);const l=localStorage.getItem("google_tokens");if(l){const u=JSON.parse(l);this.accessToken=u.access_token,this.refreshToken=u.refresh_token,a(!0)}else a(!1)}},1e3);setTimeout(()=>{clearInterval(o),i&&!i.closed&&i.close(),a(!1)},3e5)})}catch(e){return console.error("API authentication failed, falling back to demo mode:",e),this.accessToken="demo-token",localStorage.setItem("google_demo_token","demo-token"),!0}}catch(e){return console.error("Google authentication failed:",e),this.accessToken="demo-token",localStorage.setItem("google_demo_token","demo-token"),!0}}async isAuthenticated(){if(!this.accessToken){const e=localStorage.getItem("google_demo_token");return e?(this.accessToken=e,!0):!1}return this.accessToken==="demo-token"||this.demoMode,!0}async getGmailMessages(e=10){if(!this.accessToken)throw new Error("Not authenticated");if(this.accessToken==="demo-token"||this.demoMode)return[{id:"demo1",payload:{headers:[{name:"Subject",value:"Project Update - Q4 Deliverables"},{name:"From",value:"John Smith <john@salesforce.com>"},{name:"Date",value:new Date().toISOString()}]},snippet:"Project update and next steps for the Q4 deliverables..."},{id:"demo2",payload:{headers:[{name:"Subject",value:"Follow-up: Client Strategy Meeting"},{name:"From",value:"Sarah Johnson <sarah@hubspot.com>"},{name:"Date",value:new Date(Date.now()-36e5).toISOString()}]},snippet:"Meeting follow-up and action items from client call..."}];try{return(await(await fetch(`${this.API_BASE_URL}/gmail/messages?access_token=${this.accessToken}&maxResults=${e}`)).json()).messages||[]}catch(t){return console.error("Failed to fetch Gmail messages:",t),[]}}async getCalendarEvents(){if(!this.accessToken)throw new Error("Not authenticated");if(this.accessToken==="demo-token"||this.demoMode)return[{id:"demo-event-1",summary:"Client Strategy Meeting",start:{dateTime:new Date().toISOString()},end:{dateTime:new Date(Date.now()+36e5).toISOString()},attendees:[{email:"client@company.com",displayName:"Client Name"}]},{id:"demo-event-2",summary:"Project Review",start:{dateTime:new Date(Date.now()+72e5).toISOString()},end:{dateTime:new Date(Date.now()+108e5).toISOString()},creator:{email:"team@company.com",displayName:"Team Lead"}}];try{return(await(await fetch(`${this.API_BASE_URL}/calendar/events?access_token=${this.accessToken}`)).json()).events||[]}catch(e){return console.error("Failed to fetch calendar events:",e),[]}}async getDriveFiles(e){if(!this.accessToken)throw new Error("Not authenticated");if(this.accessToken==="demo-token"||this.demoMode)return{docs:[{id:"demo-doc-1",name:"Client Proposal - Q4 2024",modifiedTime:new Date().toISOString(),lastModifyingUser:{displayName:"You",emailAddress:"you@company.com"},webViewLink:"https://docs.google.com/document/d/demo-doc-1"}],sheets:[{id:"demo-sheet-1",name:"Project Timeline & Budget",modifiedTime:new Date(Date.now()-18e5).toISOString(),lastModifyingUser:{displayName:"Team Member",emailAddress:"team@company.com"},webViewLink:"https://docs.google.com/spreadsheets/d/demo-sheet-1"}],slides:[{id:"demo-slides-1",name:"Client Presentation - Strategy Overview",modifiedTime:new Date(Date.now()-36e5).toISOString(),lastModifyingUser:{displayName:"You",emailAddress:"you@company.com"},webViewLink:"https://docs.google.com/presentation/d/demo-slides-1"}]}[e]||[];try{return(await(await fetch(`${this.API_BASE_URL}/drive/files?access_token=${this.accessToken}&type=${e}`)).json()).files||[]}catch(t){return console.error(`Failed to fetch ${e} files:`,t),[]}}async trackActivity(e,t,i){if(i<.05)return;const a={date:new Date().toISOString().split("T")[0],startTime:new Date(Date.now()-i*60*60*1e3).toTimeString().slice(0,5),endTime:new Date().toTimeString().slice(0,5),duration:i,description:this.generateDescription(e,t),category:this.categorizeActivity(e,t),automated:!0,source:e,billable:this.shouldBeBillable(t),client:this.inferClient(t),project:this.inferProject(t)};await this.createTimeEntry(a)}generateDescription(e,t){switch(e){case"gmail":return`Email: ${t.subject||"Email Activity"}`;case"calendar":return`Meeting: ${t.summary||"Calendar Event"}`;case"docs":return`Document: ${t.name||"Google Doc"}`;case"sheets":return`Spreadsheet: ${t.name||"Google Sheet"}`;case"slides":return`Presentation: ${t.name||"Google Slides"}`;default:return`${e} activity`}}categorizeActivity(e,t){return{gmail:"communication",calendar:"meeting",docs:"documentation",sheets:"analysis",slides:"presentation"}[e]||"productivity"}shouldBeBillable(e){const t=["client","project","meeting","proposal","deliverable"],i=JSON.stringify(e).toLowerCase();return t.some(a=>i.includes(a))}inferClient(e){const t=JSON.stringify(e).toLowerCase();return t.includes("salesforce")?"Salesforce":t.includes("hubspot")?"HubSpot":t.includes("zendesk")?"Zendesk":"Unknown Client"}inferProject(e){const t=JSON.stringify(e).toLowerCase();return t.includes("implementation")?"Implementation Project":t.includes("strategy")?"Strategy Consulting":t.includes("review")?"Project Review":"General Work"}async createTimeEntry(e){console.log("Creating time entry from Google activity:",e);const t=JSON.parse(localStorage.getItem("timeEntries")||"[]"),i={...e,id:Date.now().toString(),status:"pending"};t.push(i),localStorage.setItem("timeEntries",JSON.stringify(t)),window.dispatchEvent(new CustomEvent("timeEntryCreated",{detail:i}))}disconnect(){this.accessToken=null,this.refreshToken=null,localStorage.removeItem("google_tokens"),localStorage.removeItem("google_demo_token")}}const Bo=new wM,EM={gmail:{name:"Gmail",icon:"",color:"#EA4335",features:["Email reading time detection","Automatic client identification","Smart project categorization","Billable time classification"]},calendar:{name:"Google Calendar",icon:"",color:"#4285F4",features:["Automatic meeting time tracking","Participant detection","Meeting type classification","Calendar block synchronization"]},docs:{name:"Google Docs",icon:"",color:"#4285F4",features:["Document editing time tracking","Collaboration time detection","Project document categorization","Client document identification"]},sheets:{name:"Google Sheets",icon:"",color:"#34A853",features:["Spreadsheet analysis time tracking","Data work categorization","Project sheet identification","Collaborative editing detection"]},slides:{name:"Google Slides",icon:"",color:"#FF6D01",features:["Presentation creation time tracking","Client presentation detection","Design work categorization","Collaboration time tracking"]}},AM=({service:n,onAuthSuccess:e,onAuthError:t})=>{const[i,a]=W.useState(!1),[o,l]=W.useState(!1),[u,f]=W.useState(0),m=EM[n];W.useEffect(()=>{p()},[]);const p=async()=>{try{const _=await Bo.isAuthenticated();l(_),_&&await v()}catch(_){console.error("Failed to check Google auth status:",_)}},v=async()=>{try{let _=0;switch(n){case"gmail":_=(await Bo.getGmailMessages(5)).length;break;case"calendar":_=(await Bo.getCalendarEvents()).length;break;case"docs":case"sheets":case"slides":_=(await Bo.getDriveFiles(n)).length;break}f(_)}catch(_){console.error(`Failed to load ${n} activity:`,_)}},y=async()=>{a(!0);try{await Bo.authenticateGoogle()?(l(!0),e(),await v()):t("Failed to authenticate with Google")}catch(_){t(`Authentication error: ${_}`)}finally{a(!1)}},S=()=>{Bo.disconnect(),l(!1),f(0)};return o?d.jsxs("div",{className:"google-auth-success",children:[d.jsxs("div",{className:"auth-status",children:[d.jsx("div",{className:"status-indicator connected"}),d.jsxs("div",{className:"status-info",children:[d.jsxs("h4",{children:[m.name," Connected"]}),d.jsx("p",{children:"Tracking activity automatically"}),d.jsxs("small",{children:[u," recent items processed"]})]})]}),d.jsx("div",{className:"auth-actions",children:d.jsx("button",{onClick:S,className:"btn btn-secondary btn-sm",children:"Disconnect"})}),d.jsxs("div",{className:"tracking-info",children:[d.jsx("h5",{children:"Active Tracking Features:"}),d.jsx("ul",{className:"feature-list",children:m.features.map((_,x)=>d.jsxs("li",{children:[" ",_]},x))})]}),d.jsxs("div",{className:"privacy-notice",children:[d.jsx("h5",{children:" Privacy & Security:"}),d.jsxs("ul",{children:[d.jsx("li",{children:" Read-only access only"}),d.jsx("li",{children:" No content modification"}),d.jsx("li",{children:" Encrypted data transmission"}),d.jsx("li",{children:" You can disconnect anytime"})]})]})]}):d.jsxs("div",{className:"google-auth-setup",children:[d.jsxs("div",{className:"auth-header",children:[d.jsx("div",{className:"service-icon",style:{color:m.color},children:m.icon}),d.jsxs("div",{children:[d.jsxs("h4",{children:["Connect ",m.name]}),d.jsxs("p",{children:["Automatically track time spent on ",n==="gmail"?"email":n==="calendar"?"meetings":"documents"]})]})]}),d.jsxs("div",{className:"auth-benefits",children:[d.jsx("h5",{children:"Smart Tracking Features:"}),m.features.map((_,x)=>d.jsxs("div",{className:"benefit-item",children:[d.jsx("span",{className:"benefit-icon",children:""}),d.jsx("div",{children:_})]},x))]}),d.jsxs("div",{className:"auth-permissions",children:[d.jsx("h5",{children:"Required Permissions:"}),d.jsxs("ul",{children:[d.jsxs("li",{children:["Read ",n==="gmail"?"email headers and metadata":n==="calendar"?"calendar events and details":"document metadata and activity"]}),d.jsx("li",{children:"Access modification timestamps"}),d.jsx("li",{children:"No content reading or modification"})]})]}),d.jsx("button",{onClick:y,disabled:i,className:"btn btn-primary auth-button",style:{backgroundColor:m.color},children:i?"Connecting...":`Connect ${m.name}`}),d.jsx("div",{className:"privacy-note",children:d.jsxs("small",{children:["We only access metadata for time tracking. Your ",n==="gmail"?"email content":"document content","remains private and is never stored or transmitted."]})})]})},hc=[{id:"google-calendar",name:"Google Calendar",description:"Automatically create time entries from calendar meetings and events",icon:"",color:"#4285F4",category:"Calendar & Scheduling",status:"available",features:["Auto-import meetings as time entries","Detect meeting participants and duration","Categorize by meeting type","Sync calendar blocks as work time"],setupSteps:['Click "Connect Google Calendar" below',"Sign in to your Google account","Grant calendar read permissions","Configure automatic import settings"]},{id:"gmail",name:"Gmail",description:"Track time spent reading and writing emails with AI-powered categorization",icon:"",color:"#EA4335",category:"Communication",status:"available",features:["Automatic email reading time tracking","AI-powered client and project detection","Smart billable time classification","Real-time activity monitoring"],setupSteps:['Click "Connect Gmail" below',"Sign in to your Google account","Grant Gmail read permissions","Start automatic email tracking"]},{id:"slack",name:"Slack",description:"Track time spent in client channels, DMs, and meetings",icon:"",color:"#4A154B",category:"Communication",status:"coming-soon",features:["Track time in client channels","Detect client vs internal conversations","Log meeting time from Slack calls","Auto-categorize by workspace"]},{id:"zoom",name:"Zoom",description:"Auto-track meeting duration, participants, and context",icon:"",color:"#2D8CFF",category:"Video Conferencing",status:"coming-soon",features:["Automatic meeting time tracking","Participant detection","Meeting recording integration","Client vs internal meeting classification"]},{id:"teams",name:"Microsoft Teams",description:"Track meetings, calls, and collaboration time in Teams",icon:"",color:"#6264A7",category:"Video Conferencing",status:"coming-soon",features:["Meeting and call tracking","Channel activity monitoring","Integration with Office 365","Team collaboration time logging"]},{id:"github",name:"GitHub",description:"Track development time based on commits, PRs, and issues",icon:"",color:"#24292e",category:"Development",status:"coming-soon",features:["Commit-based time tracking","Pull request review time","Issue resolution tracking","Repository activity monitoring"]},{id:"jira",name:"Jira",description:"Sync project tasks and track time against tickets",icon:"",color:"#0052CC",category:"Project Management",status:"coming-soon",features:["Ticket-based time tracking","Project synchronization","Sprint time analysis","Automatic time logging from activity"]},{id:"asana",name:"Asana",description:"Connect tasks and projects for seamless time tracking",icon:"",color:"#F06A6A",category:"Project Management",status:"coming-soon",features:["Task-based time entries","Project milestone tracking","Team collaboration insights","Automatic time allocation"]},{id:"notion",name:"Notion",description:"Track time spent on documents, projects, and databases",icon:"",color:"#000000",category:"Productivity",status:"coming-soon",features:["Document editing time tracking","Database activity monitoring","Project page time logging","Collaboration time insights"]}],kM=({integrations:n,onToggleIntegration:e})=>{const[t,i]=W.useState("all"),[a,o]=W.useState(null),l=["all",...Array.from(new Set(hc.map(v=>v.category)))],u=t==="all"?hc:hc.filter(v=>v.category===t),f=v=>{switch(v){case"connected":return d.jsx("span",{className:"status-badge connected",children:" Connected"});case"error":return d.jsx("span",{className:"status-badge error",children:" Error"});case"available":return d.jsx("span",{className:"status-badge available",children:" Available"});case"coming-soon":return d.jsx("span",{className:"status-badge coming-soon",children:" Coming Soon"});default:return null}},m=v=>{["google-calendar","gmail","google-docs","google-sheets","google-slides"].includes(v)?o(v):alert("This integration is coming soon! We'll notify you when it's available.")},p=()=>{alert("Google Calendar integration would be set up here. For demo purposes, this feature is not fully implemented."),o(null)};return d.jsxs("div",{className:"integrations-page",children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Integrations"}),d.jsx("p",{className:"dashboard-subtitle",children:"Connect your favorite tools to automatically track time and enhance productivity"})]}),d.jsxs("div",{className:"integration-stats",children:[d.jsxs("div",{className:"stat-item",children:[d.jsx("span",{className:"stat-value",children:hc.filter(v=>v.status==="connected").length}),d.jsx("span",{className:"stat-label",children:"Connected"})]}),d.jsxs("div",{className:"stat-item",children:[d.jsx("span",{className:"stat-value",children:hc.filter(v=>v.status==="available").length}),d.jsx("span",{className:"stat-label",children:"Available"})]})]})]}),d.jsx("div",{className:"category-filter",children:l.map(v=>d.jsx("button",{className:`category-btn ${t===v?"active":""}`,onClick:()=>i(v),children:v==="all"?" All":v},v))}),t==="all"&&d.jsx("div",{className:"featured-integration",children:d.jsxs("div",{className:"featured-content",children:[d.jsxs("div",{className:"featured-text",children:[d.jsx("h2",{children:" NEW: AI-Powered Gmail Integration"}),d.jsx("p",{children:"Automatically track time spent reading and writing emails with intelligent client and project detection. Perfect for professionals who handle extensive email communication."}),d.jsxs("div",{className:"featured-benefits",children:[d.jsxs("div",{className:"benefit-item",children:[d.jsx("div",{className:"benefit-icon",children:""}),d.jsx("div",{children:"AI automatically categorizes emails by client and project"})]}),d.jsxs("div",{className:"benefit-item",children:[d.jsx("div",{className:"benefit-icon",children:""}),d.jsx("div",{children:"Track exact time spent on email activities"})]}),d.jsxs("div",{className:"benefit-item",children:[d.jsx("div",{className:"benefit-icon",children:""}),d.jsx("div",{children:"Smart billable time detection"})]})]}),d.jsxs("div",{className:"featured-buttons",children:[d.jsx("button",{className:"btn btn-primary btn-large",onClick:()=>m("gmail"),children:" Connect Gmail"}),d.jsx("button",{className:"btn btn-secondary btn-large",onClick:()=>m("google-calendar"),children:" Connect Calendar"})]})]}),d.jsx("div",{className:"featured-visual",children:d.jsx("div",{className:"integration-preview",children:d.jsxs("div",{className:"preview-item",children:[d.jsx("div",{className:"preview-icon",children:""}),d.jsxs("div",{className:"preview-text",children:[d.jsx("div",{className:"preview-title",children:"Client Proposal Review"}),d.jsx("div",{className:"preview-time",children:"Email from client@company.com"})]}),d.jsx("div",{className:"preview-arrow",children:""}),d.jsxs("div",{className:"preview-entry",children:[d.jsx("div",{className:"entry-badge",children:" 0.3h"}),d.jsx("div",{className:"entry-label",children:"AI-tracked"})]})]})})})]})}),d.jsx("div",{className:"integrations-grid",children:u.map(v=>d.jsxs("div",{className:"integration-card",children:[d.jsxs("div",{className:"integration-header",children:[d.jsx("div",{className:"integration-icon",style:{backgroundColor:v.color+"20"},children:v.icon}),d.jsxs("div",{className:"integration-info",children:[d.jsx("h3",{className:"integration-name",children:v.name}),d.jsx("p",{className:"integration-category",children:v.category})]}),f(v.status)]}),d.jsx("p",{className:"integration-description",children:v.description}),d.jsxs("div",{className:"integration-features",children:[d.jsx("h4",{children:"Features:"}),d.jsx("ul",{children:v.features.map((y,S)=>d.jsx("li",{children:y},S))})]}),d.jsxs("div",{className:"integration-actions",children:[v.status==="available"&&d.jsxs("button",{className:"btn btn-primary",onClick:()=>m(v.id),children:["Connect ",v.name]}),v.status==="connected"&&d.jsxs("div",{className:"connected-actions",children:[d.jsx("button",{className:"btn btn-secondary",children:"Configure"}),d.jsx("button",{className:"btn btn-outline",children:"Disconnect"})]}),v.status==="coming-soon"&&d.jsx("button",{className:"btn btn-secondary",disabled:!0,children:"Coming Soon"}),v.status==="error"&&d.jsx("button",{className:"btn btn-warning",children:"Reconnect"})]})]},v.id))}),a&&d.jsx("div",{className:"modal-overlay",onClick:()=>o(null),children:d.jsxs("div",{className:"modal-content setup-modal",onClick:v=>v.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:a==="gmail"?" Connect Gmail":" Connect Google Calendar"}),d.jsx("button",{className:"modal-close",onClick:()=>o(null),children:""})]}),d.jsx("div",{className:"modal-body",children:a&&["gmail","google-calendar","google-docs","google-sheets","google-slides"].includes(a)?d.jsx(AM,{service:a.replace("google-",""),onAuthSuccess:()=>{o(null)},onAuthError:v=>{console.error("Google auth error:",v),alert("Failed to connect Google service: "+v)}}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"setup-steps",children:[d.jsx("h4",{children:"Setup Steps:"}),d.jsxs("ol",{children:[d.jsx("li",{children:`Click "Authorize Access" below to open Google's authentication`}),d.jsx("li",{children:"Sign in to your Google account"}),d.jsx("li",{children:"Grant TimeBeacon permission to read your calendar"}),d.jsx("li",{children:"Configure which calendars to sync"}),d.jsx("li",{children:"Set automatic import preferences"})]})]}),d.jsxs("div",{className:"setup-security",children:[d.jsx("h4",{children:" Privacy & Security:"}),d.jsxs("ul",{children:[d.jsx("li",{children:" We only read calendar event titles, times, and attendees"}),d.jsx("li",{children:" We never access email or other Google services"}),d.jsx("li",{children:" You can disconnect at any time"}),d.jsx("li",{children:" All data stays within your TimeBeacon account"})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>o(null),children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:p,children:" Authorize Access"})]})]})})]})}),d.jsxs("div",{className:"help-section",children:[d.jsxs("div",{className:"help-card",children:[d.jsx("h3",{children:" Need Help?"}),d.jsx("p",{children:"Setting up integrations is easy, but if you need assistance:"}),d.jsxs("div",{className:"help-actions",children:[d.jsx("button",{className:"btn btn-outline",children:" View Setup Guides"}),d.jsx("button",{className:"btn btn-outline",children:" Contact Support"}),d.jsx("button",{className:"btn btn-outline",children:" Watch Tutorials"})]})]}),d.jsxs("div",{className:"help-card",children:[d.jsx("h3",{children:" Coming Soon"}),d.jsx("p",{children:"We're working on more integrations based on user feedback:"}),d.jsxs("div",{className:"roadmap-items",children:[d.jsxs("div",{className:"roadmap-item",children:[d.jsx("span",{className:"roadmap-icon",children:""}),d.jsx("span",{children:"Slack & Microsoft Teams"})]}),d.jsxs("div",{className:"roadmap-item",children:[d.jsx("span",{className:"roadmap-icon",children:""}),d.jsx("span",{children:"GitHub & GitLab"})]}),d.jsxs("div",{className:"roadmap-item",children:[d.jsx("span",{className:"roadmap-icon",children:""}),d.jsx("span",{children:"Jira & Linear"})]})]}),d.jsx("button",{className:"btn btn-outline",children:" Request Integration"})]})]})]})},CM=({privacySettings:n,dataSources:e,auditLogs:t,onUpdatePrivacySettings:i,onExportData:a,onDeleteAllData:o})=>{const[l,u]=W.useState(!1),[f,m]=W.useState(""),p=()=>{i({...n,masterPauseEnabled:!n.masterPauseEnabled,dataProcessingEnabled:!n.masterPauseEnabled})},v=()=>{f==="DELETE MY DATA"&&(o(),u(!1),m(""))},y=e.filter(x=>x.enabled),S=t.length,_=t[0]?.timestamp||"Never";return d.jsxs("div",{children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"Privacy & Data Ownership"}),d.jsx("p",{className:"dashboard-subtitle",children:"Your data, your control, your choice. TimeBeacon is your personal assistant, not surveillance software."})]}),d.jsx("div",{style:{display:"flex",gap:"12px"},children:d.jsx("button",{className:`btn ${n.masterPauseEnabled?"btn-danger":"btn-secondary"}`,onClick:p,children:n.masterPauseEnabled?" Tracking Paused":" Pause All Tracking"})})]}),d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"linear-gradient(135deg, var(--brand-primary), var(--brand-accent))",color:"white",border:"none"},children:d.jsxs("div",{style:{padding:"48px 32px"},children:[d.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"24px",color:"white"},children:" Built for Employee Privacy & Empowerment"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"32px"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:" Your Data Stays Yours"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"All content processing happens locally on your machine. Zero raw emails, messages, or documents ever leave your device. You own and control every bit of your data."})]}),d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:" Personal Assistant, Not Surveillance"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"TimeBeacon helps you document your valuable work, not monitor you. Every feature is designed to empower you, not your employer. You control what gets tracked and shared."})]}),d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"rgba(255,255,255,0.95)"},children:" Effortless Exit"}),d.jsx("p",{style:{lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"Want to leave? Export all your data or delete everything with one click. No hidden data, no retention policies, no questions asked. Your choice, your control."})]})]})]})}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:" Data Sources & Permissions"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"You explicitly control what TimeBeacon can access. Every connection requires your consent."})]}),d.jsx("div",{style:{padding:"32px"},children:e.length===0?d.jsxs("div",{style:{textAlign:"center",padding:"48px",color:"var(--text-secondary)"},children:[d.jsx("span",{style:{fontSize:"48px",marginBottom:"16px",display:"block"},children:""}),d.jsx("h3",{children:"No Data Sources Connected"}),d.jsx("p",{children:"TimeBeacon only accesses what you explicitly allow. Connect your tools when you're ready."})]}):d.jsx("div",{style:{display:"grid",gap:"24px"},children:e.map(x=>d.jsxs("div",{className:"integration-card",style:{border:x.enabled?"2px solid var(--success)":"1px solid var(--border)"},children:[d.jsx("div",{className:"integration-header",children:d.jsx("div",{className:"integration-info",children:d.jsxs("div",{className:"integration-icon-name",children:[d.jsxs("div",{className:"integration-icon",children:[x.type==="email"&&"",x.type==="calendar"&&"",x.type==="slack"&&"",x.type==="github"&&"",x.type==="notion"&&"",x.type==="jira"&&"",x.type==="linear"&&""]}),d.jsxs("div",{children:[d.jsx("h3",{className:"integration-name",children:x.name}),d.jsx("p",{className:"integration-description",children:x.enabled?` Active  Last accessed: ${x.lastAccessed?new Date(x.lastAccessed).toLocaleDateString():"Never"}`:" Paused"})]})]})})}),d.jsx("div",{className:"integration-status",children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Total Accesses"}),d.jsx("span",{className:"status-value",children:x.totalAccessCount})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Consent Granted"}),d.jsx("span",{className:"status-value",children:new Date(x.consentGrantedAt).toLocaleDateString()})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Projects Tracked"}),d.jsx("span",{className:"status-value",children:x.permissions.allowedProjects?.length||"All"})]}),d.jsxs("div",{className:"status-item",children:[d.jsx("span",{className:"status-label",children:"Approval Required"}),d.jsx("span",{className:`status-value ${x.permissions.requireApproval?"enabled":"disabled"}`,children:x.permissions.requireApproval?"Yes":"No"})]})]})}),d.jsxs("div",{style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid var(--border-light)"},children:[d.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:"Permissions Granted"}),d.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[x.permissions.canReadMetadata&&d.jsx("span",{className:"integration-badge",children:" Metadata"}),x.permissions.canReadContent&&d.jsx("span",{className:"integration-badge",children:" Content (Local Only)"}),x.permissions.canReadAttachments&&d.jsx("span",{className:"integration-badge",children:" Attachments"}),x.permissions.pausedUntil&&d.jsxs("span",{className:"integration-badge",style:{background:"var(--warning-light)",color:"var(--warning)"},children:[" Paused until ",new Date(x.permissions.pausedUntil).toLocaleDateString()]})]})]})]},x.id))})})]}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:" Transparency Dashboard"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"See exactly what TimeBeacon has accessed and analyzed. No hidden activity."})]}),d.jsxs("div",{style:{padding:"32px"},children:[d.jsxs("div",{className:"stats-grid",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Total Data Accesses"}),d.jsx("div",{className:"stat-value",children:S}),d.jsx("div",{className:"stat-change",children:"All logged and auditable"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Active Data Sources"}),d.jsx("div",{className:"stat-value",children:y.length}),d.jsx("div",{className:"stat-change",children:"You control each one"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Last Activity"}),d.jsx("div",{className:"stat-value",children:_==="Never"?"Never":new Date(_).toLocaleDateString()}),d.jsx("div",{className:"stat-change",children:"Real-time tracking"})]}),d.jsxs("div",{className:"stat-card",children:[d.jsx("div",{className:"stat-label",children:"Data Retention"}),d.jsxs("div",{className:"stat-value",children:[n.auditLogRetentionDays," days"]}),d.jsx("div",{className:"stat-change",children:n.autoDeleteOldData?" Auto-delete enabled":" Manual cleanup"})]})]}),t.length>0&&d.jsxs("div",{children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px"},children:"Recent Activity Log"}),d.jsx("div",{className:"table-container",children:d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Timestamp"}),d.jsx("th",{children:"Action"}),d.jsx("th",{children:"Source"}),d.jsx("th",{children:"Items Processed"}),d.jsx("th",{children:"Processing Time"})]})}),d.jsx("tbody",{children:t.slice(0,10).map(x=>d.jsxs("tr",{children:[d.jsxs("td",{className:"time-value",children:[new Date(x.timestamp).toLocaleDateString()," ",new Date(x.timestamp).toLocaleTimeString()]}),d.jsx("td",{style:{textTransform:"capitalize"},children:x.action.replace("_"," ")}),d.jsx("td",{children:d.jsx("span",{style:{textTransform:"capitalize"},children:x.source})}),d.jsx("td",{children:x.details.itemsAnalyzed||x.details.itemsAccessed||"-"}),d.jsx("td",{children:x.details.processingTimeMs?`${x.details.processingTimeMs}ms`:"-"})]},x.id))})]})})]})]})]}),d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:" Data Control Center"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Complete control over your data. Export, delete, or modify anything at any time."})]}),d.jsx("div",{style:{padding:"32px"},children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"24px"},children:[d.jsxs("div",{style:{padding:"24px",border:"1px solid var(--border)",borderRadius:"12px",background:"var(--surface)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:" Export Your Data"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"20px",fontSize:"14px"},children:"Download all your time entries, settings, and audit logs. Your data, your format."}),d.jsxs("div",{style:{display:"flex",gap:"8px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>a("json"),children:"Export JSON"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>a("csv"),children:"Export CSV"})]})]}),d.jsxs("div",{style:{padding:"24px",border:"1px solid var(--border)",borderRadius:"12px",background:"var(--surface)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:" Privacy Controls"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.requireManualApproval,onChange:x=>i({...n,requireManualApproval:x.target.checked})}),"Require approval for all AI suggestions"]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.showDetailedAuditLogs,onChange:x=>i({...n,showDetailedAuditLogs:x.target.checked})}),"Show detailed audit logs"]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},children:[d.jsx("input",{type:"checkbox",checked:n.autoDeleteOldData,onChange:x=>i({...n,autoDeleteOldData:x.target.checked})}),"Auto-delete old audit logs"]})]})]}),d.jsxs("div",{style:{padding:"24px",border:"2px solid var(--error)",borderRadius:"12px",background:"var(--error-light)"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:" Emergency Controls"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"20px",fontSize:"14px"},children:"Need to stop everything immediately? These controls give you instant control."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsx("button",{className:"btn btn-danger",onClick:p,children:n.masterPauseEnabled?" Resume All Tracking":" Pause All Tracking"}),d.jsx("button",{className:"btn btn-danger",onClick:()=>u(!0),children:" Delete All Data"})]})]})]})})]}),l&&d.jsx("div",{className:"modal-overlay",onClick:()=>u(!1),children:d.jsxs("div",{className:"modal-content",onClick:x=>x.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{children:" Delete All Data"}),d.jsx("button",{className:"modal-close",onClick:()=>u(!1),children:""})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{background:"var(--error-light)",padding:"16px",borderRadius:"8px",marginBottom:"24px"},children:[d.jsx("p",{style:{color:"var(--error)",fontWeight:"600",marginBottom:"8px"},children:"This action cannot be undone!"}),d.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:"This will permanently delete:"}),d.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px",color:"var(--text-secondary)",fontSize:"14px"},children:[d.jsx("li",{children:"All time entries and projects"}),d.jsx("li",{children:"All data source connections"}),d.jsx("li",{children:"All audit logs and analysis data"}),d.jsx("li",{children:"All settings and preferences"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{style:{fontWeight:"600"},children:'Type "DELETE MY DATA" to confirm:'}),d.jsx("input",{type:"text",value:f,onChange:x=>m(x.target.value),className:"form-input",placeholder:"DELETE MY DATA",style:{marginTop:"8px"}})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>{u(!1),m("")},children:"Cancel"}),d.jsx("button",{className:"btn btn-danger",onClick:v,disabled:f!=="DELETE MY DATA",children:"Delete Everything"})]})]})}),d.jsx("div",{className:"content-card",style:{background:"var(--surface)",border:"1px solid var(--success)"},children:d.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--success)"},children:" Our Privacy Commitment"}),d.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[d.jsx("p",{style:{fontSize:"16px",lineHeight:"1.6",color:"var(--text-secondary)",marginBottom:"24px"},children:"TimeBeacon exists to empower you, not monitor you. We've designed every feature with your privacy and autonomy in mind. Your work is valuable, and you deserve tools that respect that value."}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",fontSize:"14px"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:" Local Processing"}),d.jsx("br",{}),"Content never leaves your device"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Full Transparency"}),d.jsx("br",{}),"See exactly what we access"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Complete Control"}),d.jsx("br",{}),"Pause, export, or delete anytime"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" No Hidden Data"}),d.jsx("br",{}),"What you see is what we have"]})]})]})]})})]})},jM=({onClose:n})=>{const[e,t]=W.useState(Gr.getStatus()),[i,a]=W.useState(ta.getStats()),[o,l]=W.useState(Ma.getStatus()),[u,f]=W.useState(!1),[m,p]=W.useState(null);W.useEffect(()=>{const _=setInterval(()=>{t(Gr.getStatus()),a(ta.getStats()),l(Ma.getStatus())},5e3);return()=>clearInterval(_)},[]);const v=async()=>{f(!0),p(null);try{const _=await Gr.testService();p(_)}catch{p({success:!1,error:"Test failed"})}finally{f(!1)}},y=async()=>{try{const _=await Ma.testConnection();console.log("Calendar test result:",_)}catch(_){console.error("Calendar test failed:",_)}},S=async()=>{try{const _=await Ma.forceSync();console.log("Force sync result:",_)}catch(_){console.error("Force sync failed:",_)}};return d.jsxs("div",{className:"content-card",children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:" AI Processing System"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Configure and monitor your local AI processing capabilities"}),n&&d.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Close"})]}),d.jsxs("div",{style:{padding:"32px"},children:[d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Local AI Engine (Ollama)"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"AI Service"}),d.jsx("div",{className:`status-value ${e.available?"status-success":"status-error"}`,children:e.available?" Available":" Not Available"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Model"}),d.jsx("div",{className:"status-value",children:e.model})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Processing"}),d.jsx("div",{className:`status-value ${e.enabled?"status-success":"status-warning"}`,children:e.enabled?" Enabled":" Disabled"})]})]}),!e.available&&d.jsxs("div",{className:"alert alert-info",children:[d.jsx("h4",{children:" Ollama Setup Required"}),d.jsx("p",{children:"To enable local AI processing, install Ollama and the required model:"}),d.jsx("div",{className:"code-block",children:d.jsxs("code",{children:["# Install Ollama (macOS/Linux)",d.jsx("br",{}),"curl -fsSL https://ollama.com/install.sh | sh",d.jsx("br",{}),d.jsx("br",{}),"# Pull the model",d.jsx("br",{}),"ollama pull llama3.2:3b",d.jsx("br",{}),d.jsx("br",{}),"# Start Ollama service",d.jsx("br",{}),"ollama serve"]})}),d.jsxs("p",{style:{marginTop:"16px"},children:[d.jsx("strong",{children:"Privacy Note:"})," All AI processing happens locally on your machine. No data is sent to external servers."]})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"16px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:v,disabled:u,children:u?" Testing...":" Test AI Service"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>Gr.checkOllamaAvailability(),children:" Refresh Status"})]}),m&&d.jsx("div",{className:`alert ${m.success?"alert-success":"alert-error"}`,style:{marginTop:"16px"},children:m.success?d.jsxs("p",{children:[" AI service test successful! Latency: ",m.latency,"ms"]}):d.jsxs("p",{children:[" AI service test failed: ",m.error]})})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Content Analyzer"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Queue Length"}),d.jsx("div",{className:"status-value",children:i.queueLength})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Processing"}),d.jsx("div",{className:`status-value ${i.isProcessing?"status-warning":"status-success"}`,children:i.isProcessing?" Active":" Idle"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Cache Size"}),d.jsx("div",{className:"status-value",children:i.cacheSize})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Total Suggestions"}),d.jsx("div",{className:"status-value",children:i.totalSuggestions})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Pending Review"}),d.jsx("div",{className:"status-value",children:i.pendingSuggestions})]})]}),d.jsx("div",{style:{display:"flex",gap:"12px"},children:d.jsx("button",{className:"btn btn-secondary",onClick:()=>ta.clearOldSuggestions(7),children:" Clear Old Suggestions"})})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Calendar Integration"}),d.jsxs("div",{className:"status-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Status"}),d.jsx("div",{className:`status-value ${o.enabled?"status-success":"status-warning"}`,children:o.enabled?" Connected":" Disconnected"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Last Sync"}),d.jsx("div",{className:"status-value",children:o.lastSync?new Date(o.lastSync).toLocaleString():"Never"})]}),d.jsxs("div",{className:"status-card",children:[d.jsx("div",{className:"status-label",children:"Events Processed"}),d.jsx("div",{className:"status-value",children:o.processedEventsCount})]})]}),d.jsxs("div",{style:{display:"flex",gap:"12px"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:y,children:" Test Connection"}),d.jsx("button",{className:"btn btn-secondary",onClick:S,children:" Force Sync"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>Ma.clearHistory(),children:" Clear History"})]})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Privacy & Security"}),d.jsxs("div",{className:"alert alert-success",children:[d.jsx("h4",{children:" Privacy-First Architecture"}),d.jsxs("ul",{style:{margin:"12px 0",paddingLeft:"20px"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Local Processing:"})," All AI analysis happens on your device"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"No Data Transmission:"})," Raw content never leaves your computer"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Encrypted Storage:"})," Suggestions stored locally with encryption"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"User Control:"})," You approve every AI-generated time entry"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Audit Trail:"})," Complete visibility into AI decision-making"]})]})]}),d.jsxs("div",{className:"alert alert-info",children:[d.jsx("h4",{children:" What the AI Analyzes"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px",marginTop:"12px"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:" Calendar Events"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Meeting titles and descriptions"}),d.jsx("li",{children:"Attendee information"}),d.jsx("li",{children:"Meeting duration and timing"}),d.jsx("li",{children:"Location details"})]})]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Email Content (Future)"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Subject lines for project matching"}),d.jsx("li",{children:"Sender/recipient analysis"}),d.jsx("li",{children:"Project keywords and references"}),d.jsx("li",{children:"Time-related discussions"})]})]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Slack Messages (Future)"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Project channel discussions"}),d.jsx("li",{children:"Client interaction threads"}),d.jsx("li",{children:"Work status updates"}),d.jsx("li",{children:"Meeting coordination"})]})]})]})]})]}),d.jsxs("div",{className:"settings-section",children:[d.jsx("h3",{className:"settings-section-title",children:" Performance Optimization"}),d.jsxs("div",{className:"tips-grid",style:{display:"grid",gap:"16px"},children:[d.jsxs("div",{className:"tip-card",children:[d.jsx("h4",{children:" Speed Tips"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Use a smaller model (llama3.2:1b) for faster processing"}),d.jsx("li",{children:"Increase RAM allocation to Ollama for better performance"}),d.jsx("li",{children:"Close unnecessary applications when AI is processing"}),d.jsx("li",{children:"Process activities in batches for efficiency"})]})]}),d.jsxs("div",{className:"tip-card",children:[d.jsx("h4",{children:" Accuracy Tips"}),d.jsxs("ul",{style:{fontSize:"14px",margin:"8px 0",paddingLeft:"16px"},children:[d.jsx("li",{children:"Use descriptive meeting titles and descriptions"}),d.jsx("li",{children:"Maintain consistent project and client naming"}),d.jsx("li",{children:"Review and approve suggestions to train the system"}),d.jsx("li",{children:"Keep your project and client lists up to date"})]})]})]})]})]})]})},DM=({onApproveSuggestion:n,onRejectSuggestion:e,aiEnabled:t,onToggleAI:i})=>{const[a,o]=W.useState(null),[l,u]=W.useState([]),[f,m]=W.useState(!1),[p,v]=W.useState(Gr.getStatus()),[y,S]=W.useState(Ma.getStatus());W.useEffect(()=>{const A=()=>{const D=ta.getStoredSuggestions();u(D)};A();const I=setInterval(A,3e4);return()=>clearInterval(I)},[]),W.useEffect(()=>{const I=setInterval(()=>{v(Gr.getStatus()),S(Ma.getStatus())},5e3);return()=>clearInterval(I)},[]);const _=async(A,I)=>{try{await ta.approveSuggestion(A,I),u(ta.getStoredSuggestions()),n(A,I)}catch(D){console.error("Failed to approve suggestion:",D)}},x=async(A,I)=>{try{await ta.rejectSuggestion(A,I),u(ta.getStoredSuggestions()),e(A,I)}catch(D){console.error("Failed to reject suggestion:",D)}},T=async()=>{try{await Ma.forceSync(),setTimeout(()=>{u(ta.getStoredSuggestions())},2e3)}catch(A){console.error("Force sync failed:",A)}},w=l.filter(A=>A.status==="pending"),E=l.filter(A=>A.status!=="pending").slice(0,5),C=A=>A>=.8?"var(--success)":A>=.6?"var(--warning)":"var(--error)",N=A=>A>=.8?"High Confidence":A>=.6?"Medium Confidence":"Low Confidence";return d.jsxs("div",{children:[d.jsxs("div",{className:"dashboard-header",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"dashboard-title",children:"AI Insights"}),d.jsx("p",{className:"dashboard-subtitle",children:"AI-generated time entry suggestions  All processing happens locally on your device"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[d.jsx("button",{className:"btn btn-secondary",onClick:()=>m(!0),children:" AI Settings"}),d.jsx("button",{className:"btn btn-secondary",onClick:T,disabled:!y.enabled,children:" Sync Calendar"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"var(--text-secondary)"},children:"AI Analysis"}),d.jsxs("div",{className:"toggle-switch",children:[d.jsx("input",{type:"checkbox",checked:t&&p.available,onChange:i,id:"ai-toggle",disabled:!p.available}),d.jsx("label",{htmlFor:"ai-toggle",className:"toggle-slider"})]})]})]})]}),!p.available&&d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"var(--warning-light)",border:"1px solid var(--warning)"},children:d.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[d.jsx("span",{style:{fontSize:"48px",marginBottom:"16px",display:"block"},children:""}),d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--warning-dark)"},children:"AI Service Setup Required"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",maxWidth:"500px",margin:"0 auto 24px"},children:"TimeBeacon uses Ollama for local AI processing. Install Ollama and the required model to enable intelligent time entry suggestions. All processing happens locally - your content never leaves this device."}),d.jsx("button",{className:"btn btn-primary",onClick:()=>m(!0),children:"Setup Instructions"})]})}),!t&&p.available&&d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"var(--info-light)",border:"1px solid var(--info)"},children:d.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[d.jsx("span",{style:{fontSize:"48px",marginBottom:"16px",display:"block"},children:""}),d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--info-dark)"},children:"AI Analysis Paused"}),d.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",maxWidth:"500px",margin:"0 auto 24px"},children:"Your AI assistant is ready but currently paused. Enable AI analysis to automatically generate time entry suggestions from your digital activities. All processing happens locally - your content never leaves this device."}),d.jsx("button",{className:"btn btn-primary",onClick:i,children:"Enable AI Analysis"})]})}),t&&p.available&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"content-card",style:{marginBottom:"32px",background:"var(--success-light)",border:"1px solid var(--success)"},children:d.jsxs("div",{style:{padding:"24px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",margin:0,color:"var(--success-dark)",display:"flex",alignItems:"center",gap:"8px"},children:" Privacy Protected - AI Active"}),d.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"14px"},children:[d.jsxs("span",{style:{color:"var(--text-secondary)"},children:["AI Model: ",d.jsx("strong",{children:p.model})]}),d.jsxs("span",{style:{color:"var(--text-secondary)"},children:["Calendar: ",d.jsx("strong",{children:y.enabled?"Connected":"Disconnected"})]})]})]}),d.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"14px",margin:0},children:"AI analysis runs entirely on your device using Ollama. Your emails, messages, and documents never leave your computer. Only approved time entry summaries are stored."})]})}),w.length>0&&d.jsxs("div",{className:"content-card",style:{marginBottom:"32px"},children:[d.jsxs("div",{className:"card-header",children:[d.jsxs("h2",{className:"card-title",children:["Pending Suggestions (",w.length,")"]}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Review and approve AI-generated time entries"})]}),d.jsx("div",{style:{padding:"32px"},children:d.jsx("div",{style:{display:"grid",gap:"24px"},children:w.map(A=>d.jsx("div",{className:"content-card",style:{border:`2px solid ${C(A.confidence)}20`,background:"var(--surface-elevated)",cursor:"pointer"},onClick:()=>o(a===A.id?null:A.id),children:d.jsxs("div",{style:{padding:"24px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[d.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",margin:0,color:"var(--text-primary)"},children:A.suggestedProject}),d.jsxs("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:`${C(A.confidence)}20`,color:C(A.confidence)},children:[N(A.confidence)," (",Math.round(A.confidence*100),"%)"]})]}),d.jsxs("p",{style:{color:"var(--text-secondary)",margin:"0 0 12px 0"},children:[A.suggestedClient,"  ",A.suggestedDuration,"h  ",new Date(A.suggestedDate).toLocaleDateString()]}),d.jsx("p",{style:{color:"var(--text-primary)",margin:0,lineHeight:"1.5"},children:A.suggestedDescription})]}),d.jsxs("div",{style:{display:"flex",gap:"8px",flexShrink:0,marginLeft:"16px"},children:[d.jsx("button",{className:"btn btn-success btn-small",onClick:I=>{I.stopPropagation(),_(A.id)},children:" Approve"}),d.jsx("button",{className:"btn btn-danger btn-small",onClick:I=>{I.stopPropagation(),x(A.id,"User rejected")},children:" Reject"})]})]}),a===A.id&&d.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:"16px",marginTop:"16px",background:"var(--background-secondary)",padding:"16px",borderRadius:"8px"},children:[d.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"12px",color:"var(--text-primary)"},children:"AI Analysis Details"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",fontSize:"13px"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Generated:"}),d.jsx("br",{}),d.jsx("span",{style:{color:"var(--text-primary)"},children:new Date(A.generatedAt).toLocaleString()})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Source:"}),d.jsx("br",{}),d.jsx("span",{style:{color:"var(--text-primary)",textTransform:"capitalize"},children:A.source})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Data Sources:"}),d.jsx("br",{}),d.jsx("span",{style:{color:"var(--text-primary)"},children:A.basedOnDataFrom.join(", ")})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--text-secondary)"},children:"Tags:"}),d.jsx("br",{}),d.jsx("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap",marginTop:"4px"},children:A.suggestedTags.map(I=>d.jsx("span",{style:{padding:"2px 6px",background:"var(--brand-primary-light)",color:"var(--brand-primary)",borderRadius:"4px",fontSize:"11px"},children:I},I))})]})]})]})]})},A.id))})})]}),E.length>0&&d.jsxs("div",{className:"content-card",children:[d.jsxs("div",{className:"card-header",children:[d.jsx("h2",{className:"card-title",children:"Recently Processed"}),d.jsx("p",{style:{color:"var(--text-secondary)",margin:"8px 0 0 0"},children:"Your recent AI suggestion decisions"})]}),d.jsx("div",{className:"table-container",children:d.jsxs("table",{className:"data-table",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Date"}),d.jsx("th",{children:"Project"}),d.jsx("th",{children:"Description"}),d.jsx("th",{children:"Confidence"}),d.jsx("th",{children:"Decision"}),d.jsx("th",{children:"Processed"})]})}),d.jsx("tbody",{children:E.map(A=>d.jsxs("tr",{children:[d.jsx("td",{children:new Date(A.suggestedDate).toLocaleDateString()}),d.jsx("td",{children:A.suggestedProject}),d.jsx("td",{style:{maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis"},children:A.suggestedDescription}),d.jsx("td",{children:d.jsxs("span",{style:{color:C(A.confidence),fontWeight:"600"},children:[Math.round(A.confidence*100),"%"]})}),d.jsx("td",{children:d.jsx("span",{className:`status-badge ${A.status==="approved"?"status-approved":A.status==="rejected"?"status-rejected":"status-pending"}`,children:A.status})}),d.jsx("td",{className:"time-value",children:A.approvedAt?new Date(A.approvedAt).toLocaleDateString():A.rejectedAt?new Date(A.rejectedAt).toLocaleDateString():"-"})]},A.id))})]})})]}),w.length===0&&E.length===0&&d.jsx("div",{className:"content-card",children:d.jsxs("div",{style:{padding:"64px",textAlign:"center"},children:[d.jsx("span",{style:{fontSize:"64px",marginBottom:"24px",display:"block"},children:""}),d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--text-primary)"},children:"AI Learning Your Patterns"}),d.jsx("p",{style:{color:"var(--text-secondary)",maxWidth:"500px",margin:"0 auto",fontSize:"16px",lineHeight:"1.6"},children:"Your AI assistant is analyzing your digital activities to learn your work patterns. Suggestions will appear here as the AI identifies potential time entries from your calendar and other sources."}),d.jsxs("div",{style:{marginTop:"32px",display:"flex",gap:"12px",justifyContent:"center"},children:[d.jsx("button",{className:"btn btn-primary",onClick:T,children:" Sync Calendar Now"}),d.jsx("button",{className:"btn btn-secondary",onClick:()=>m(!0),children:" Configure AI"})]}),d.jsxs("div",{style:{marginTop:"32px",padding:"24px",background:"var(--background-secondary)",borderRadius:"12px",maxWidth:"600px",margin:"32px auto 0"},children:[d.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"var(--text-primary)"},children:"What the AI Analyzes (Locally)"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",fontSize:"14px"},children:[d.jsxs("div",{children:[d.jsx("strong",{children:" Calendar Events"}),d.jsx("br",{}),"Meeting titles, attendees, durations (Active)"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Email Content"}),d.jsx("br",{}),"Project mentions, client names (Coming Soon)"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Slack Messages"}),d.jsx("br",{}),"Project discussions, client interactions (Coming Soon)"]}),d.jsxs("div",{children:[d.jsx("strong",{children:" Document Access"}),d.jsx("br",{}),"File names, project folders (Coming Soon)"]})]})]})]})})]}),f&&d.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:d.jsx("div",{style:{background:"var(--background)",borderRadius:"12px",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflow:"auto"},children:d.jsx(jM,{onClose:()=>m(!1)})})})]})},NM=n=>({defaultClients:[],defaultProjects:[],workingHours:{start:n.workingHours?.start||"09:00",end:n.workingHours?.end||"17:00",timezone:n.timezone||"UTC"},billableByDefault:!0,autoTrackMeetings:!0,autoTrackSlack:!1,minimumSessionLength:15,notifications:n.notifications?.enableDesktop||!0,autoBreaks:!1,theme:n.theme||"light",emailNotifications:{enabled:!1,dailyReviewTime:"17:00",approvalReminders:!0,weeklyDigest:!0,email:""},integrations:Object.entries(n.integrations||{}).map(([e,t])=>({id:e,name:e,enabled:t.enabled||!1,lastSync:t.lastSync,settings:t.settings||{}}))}),OM=()=>{const n=Jb(),e=W.useCallback(S=>{const _={...S,id:crypto.randomUUID()};return n.addTimeEntry(S).catch(x=>{console.error("Failed to persist time entry:",x)}),_},[n]),t=W.useCallback((S,_)=>{n.updateTimeEntry(S,_).catch(x=>{console.error("Failed to update time entry:",x)})},[n]),i=W.useCallback(S=>{n.deleteTimeEntry(S).catch(_=>{console.error("Failed to delete time entry:",_)})},[n]),a=W.useCallback(S=>{const _={...S,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return n.addProject(S).catch(x=>{console.error("Failed to persist project:",x)}),_},[n]),o=W.useCallback((S,_)=>{n.updateProject(S,_).catch(x=>{console.error("Failed to update project:",x)})},[n]),l=W.useCallback(S=>{n.deleteProject(S).catch(_=>{console.error("Failed to delete project:",_)})},[n]),u=W.useCallback(S=>{const _={...S,id:crypto.randomUUID(),createdAt:new Date().toISOString()};return n.addClient(S).catch(x=>{console.error("Failed to persist client:",x)}),_},[n]),f=W.useCallback((S,_)=>{n.updateClient(S,_).catch(x=>{console.error("Failed to update client:",x)})},[n]),m=W.useCallback(S=>{n.deleteClient(S).catch(_=>{console.error("Failed to delete client:",_)})},[n]),p=W.useCallback(S=>{const _={theme:S.theme,timezone:S.workingHours.timezone,workingHours:{start:S.workingHours.start,end:S.workingHours.end,workingDays:[1,2,3,4,5]},notifications:{enableDesktop:S.notifications,reminderInterval:60,endOfDayReminder:!0},privacy:{trackActiveWindow:!1,trackKeystrokes:!1,trackMouse:!1,blurScreenshots:!0},integrations:S.integrations.reduce((x,T)=>(x[T.id]={enabled:T.enabled,lastSync:T.lastSync,settings:T.settings},x),{})};n.setSettings(_).catch(x=>{console.error("Failed to update settings:",x)})},[n]),v=W.useCallback(S=>{n.toggleIntegration(S)},[n]),y=W.useMemo(()=>{const S=new Date().toISOString().split("T")[0],_=new Date,x=new Date(_.getFullYear(),_.getMonth(),_.getDate()-_.getDay()),T=new Date(_.getFullYear(),_.getMonth(),1),w=n.timeEntries.filter(L=>L.date===S),E=n.timeEntries.filter(L=>new Date(L.date)>=x),C=n.timeEntries.filter(L=>new Date(L.date)>=T),N=w.reduce((L,H)=>L+H.duration,0),A=E.reduce((L,H)=>L+H.duration,0),I=C.reduce((L,H)=>L+H.duration,0),D=n.timeEntries.filter(L=>L.billable&&L.status==="approved"),z=D.reduce((L,H)=>L+H.duration*100,0);return{todayHours:N,weekHours:A,monthHours:I,billableHours:D.reduce((L,H)=>L+H.duration,0),nonBillableHours:n.timeEntries.filter(L=>!L.billable).reduce((L,H)=>L+H.duration,0),pendingEntries:n.timeEntries.filter(L=>L.status==="pending").length,totalClients:n.clients.length,activeProjects:n.projects.filter(L=>L.active).length,totalEarnings:z,utilizationRate:A>0?D.filter(L=>E.includes(L)).reduce((L,H)=>L+H.duration,0)/A*100:0,automatedEntries:C.filter(L=>L.automated).length}},[n.timeEntries,n.projects,n.clients]);return{timeEntries:n.timeEntries,projects:n.projects,clients:n.clients,settings:NM(n.settings),stats:y,isLoading:n.isLoading,error:n.error,addTimeEntry:e,updateTimeEntry:t,deleteTimeEntry:i,addProject:a,updateProject:o,deleteProject:l,addClient:u,updateClient:f,deleteClient:m,setSettings:p,toggleIntegration:v,exportData:n.exportData,clearAllData:n.clearAllData}};function vi(){const n=Fa(),e=Jo(),[t,i]=W.useState(!1),[a,o]=W.useState(!0),l=OM(),u=()=>{const x=n.pathname;return x.includes("/reports")?"reports":x.includes("/ai-insights")?"ai-insights":x.includes("/permissions")?"permissions":x.includes("/settings")?"settings":x.includes("/privacy")?"privacy":x.includes("/integrations")?"integrations":"dashboard"},[f,m]=W.useState(u());W.useEffect(()=>{m(u())},[n.pathname]);const p=x=>{e(`/${x}`),m(x)},v=()=>{const x=!t;i(x),Gr.updateConfig({enabled:x}),console.log(x?" AI analysis enabled":" AI analysis paused")},y=async(x,T)=>{try{await ta.approveSuggestion(x,T),console.log(" Suggestion approved and time entry created")}catch(w){console.error("Failed to approve suggestion:",w)}},S=async(x,T)=>{try{await ta.rejectSuggestion(x,T),console.log(" Suggestion rejected:",T)}catch(w){console.error("Failed to reject suggestion:",w)}},_=()=>{switch(f){case"dashboard":return d.jsx(zv,{entries:l.timeEntries,projects:l.projects,onUpdateEntry:l.updateTimeEntry,onDeleteEntry:l.deleteTimeEntry,onAddEntry:l.addTimeEntry});case"reports":return a?d.jsx(SM,{}):d.jsx(RE,{entries:l.timeEntries,projects:l.projects});case"ai-insights":return d.jsx(DM,{onApproveSuggestion:y,onRejectSuggestion:S,aiEnabled:t,onToggleAI:v});case"integrations":return d.jsx(kM,{integrations:l.settings.integrations,onToggleIntegration:l.toggleIntegration});case"permissions":return d.jsx(_M,{});case"settings":return d.jsx(TM,{});case"privacy":return d.jsx(CM,{privacySettings:{dataProcessingEnabled:!0,auditLogRetentionDays:30,contentAnalysisRetentionDays:7,autoDeleteOldData:!0,aiAnalysisEnabled:!0,maxConfidenceThreshold:.7,requireManualApproval:!0,showDetailedAuditLogs:!0,notifyOnDataAccess:!1,exportFormat:"json",masterPauseEnabled:!1,emergencyWipeEnabled:!0},dataSources:[],auditLogs:[],onUpdatePrivacySettings:()=>{},onExportData:l.exportData,onDeleteAllData:l.clearAllData});default:return d.jsx(zv,{entries:l.timeEntries,projects:l.projects,onUpdateEntry:l.updateTimeEntry,onDeleteEntry:l.deleteTimeEntry,onAddEntry:l.addTimeEntry})}};return l.isLoading?d.jsx("div",{className:"app-container",children:d.jsxs("div",{className:"loading-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"24px",background:"var(--background)"},children:[d.jsx("div",{className:"loading-spinner",style:{width:"48px",height:"48px",border:"4px solid var(--border)",borderTop:"4px solid var(--brand-primary)",borderRadius:"50%",animation:"spin 1s linear infinite"}}),d.jsxs("div",{style:{textAlign:"center",color:"var(--text-secondary)"},children:[d.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"8px",color:"var(--text-primary)"},children:" Initializing TimeBeacon"}),d.jsx("p",{children:"Setting up your local-first database..."})]})]})}):l.error?d.jsx("div",{className:"app-container",children:d.jsx("div",{className:"error-container",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"24px",background:"var(--background)",padding:"32px"},children:d.jsxs("div",{style:{textAlign:"center",maxWidth:"500px"},children:[d.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",color:"var(--error)"},children:" Database Error"}),d.jsxs("p",{style:{color:"var(--text-secondary)",marginBottom:"24px",lineHeight:"1.6"},children:["Failed to initialize the local database: ",l.error]}),d.jsx("button",{className:"btn btn-primary",onClick:()=>window.location.reload(),children:" Retry"})]})})}):d.jsxs("div",{className:"app-container",children:[d.jsx(TE,{activeItem:f,onItemClick:p}),d.jsx("main",{className:"main-content","data-testid":"main-content",children:_()})]})}class RM{config;authWindow=null;constructor(){this.config={clientId:"829394557114-32bedmchkqvru4gvtg52ojgef7fssusn.apps.googleusercontent.com",clientSecret:"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",redirectUri:"http://localhost:3001/auth/google/callback",scopes:["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/calendar.readonly","https://www.googleapis.com/auth/gmail.readonly","https://www.googleapis.com/auth/documents.readonly","https://www.googleapis.com/auth/spreadsheets.readonly","https://www.googleapis.com/auth/drive.activity.readonly"]}}async authenticate(){return new Promise(async(e,t)=>{if(this.config.clientId==="demo-client-id"){setTimeout(()=>{const i={email:"user@company.com",name:"John Doe",picture:"https://via.placeholder.com/100",accessToken:"mock-access-token",refreshToken:"mock-refresh-token",expiresAt:Date.now()+36e5};this.storeAccount(i),e(i)},1e3);return}try{const o=await(await fetch("http://localhost:3001/auth/google/url")).json();if(!o.authUrl)throw new Error("Failed to get OAuth URL");this.authWindow=window.open(o.authUrl,"google-auth","width=500,height=600,scrollbars=yes,resizable=yes");const l=f=>{if(f.data.type==="GOOGLE_AUTH_SUCCESS"){window.removeEventListener("message",l),this.authWindow?.close();const m={email:"user@example.com",name:"User",picture:"",accessToken:f.data.tokens.access_token,refreshToken:f.data.tokens.refresh_token,expiresAt:f.data.tokens.expiry_date||Date.now()+3600*1e3};this.storeAccount(m),e(m)}else f.data.type==="GOOGLE_AUTH_ERROR"&&(window.removeEventListener("message",l),this.authWindow?.close(),t(new Error(f.data.error)))};window.addEventListener("message",l);const u=setInterval(()=>{if(this.authWindow?.closed){clearInterval(u),window.removeEventListener("message",l);const f=localStorage.getItem("google_tokens");if(f){const m=JSON.parse(f),p={email:"user@example.com",name:"User",picture:"",accessToken:m.access_token,refreshToken:m.refresh_token,expiresAt:m.expiry_date||Date.now()+3600*1e3};this.storeAccount(p),e(p)}else t(new Error("Authentication cancelled"))}},1e3);setTimeout(()=>{this.authWindow&&!this.authWindow.closed&&(this.authWindow.close(),window.removeEventListener("message",l),t(new Error("Authentication timeout")))},3e5)}catch(i){t(i)}})}buildAuthUrl(){return`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:this.config.clientId,redirect_uri:this.config.redirectUri,scope:this.config.scopes.join(" "),response_type:"code",access_type:"offline",prompt:"consent",state:crypto.randomUUID()})}`}async exchangeCodeForTokens(e){try{const i=await(await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:this.config.clientId,client_secret:this.config.clientSecret,code:e,grant_type:"authorization_code",redirect_uri:this.config.redirectUri})})).json(),o=await(await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${i.access_token}`}})).json(),l={email:o.email,name:o.name,picture:o.picture,accessToken:i.access_token,refreshToken:i.refresh_token,expiresAt:Date.now()+i.expires_in*1e3};return this.storeAccount(l),l}catch(t){throw console.error("Token exchange failed:",t),t}}storeAccount(e){localStorage.setItem("google_account",JSON.stringify(e))}getStoredAccount(){try{const e=localStorage.getItem("google_account");if(!e)return null;const t=JSON.parse(e);return Date.now()>t.expiresAt&&this.refreshToken(t),t}catch{return null}}async refreshToken(e){try{const i=await(await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:this.config.clientId,client_secret:this.config.clientSecret,refresh_token:e.refreshToken,grant_type:"refresh_token"})})).json();e.accessToken=i.access_token,e.expiresAt=Date.now()+i.expires_in*1e3,this.storeAccount(e)}catch(t){console.error("Token refresh failed:",t),this.disconnect()}}disconnect(){localStorage.removeItem("google_account")}isConnected(){const e=this.getStoredAccount();return e!==null&&Date.now()<e.expiresAt}async fetchGmailActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockGmailActivities();try{const i=t?`after:${Math.floor(t.getTime()/1e3)}`:"in:sent OR in:inbox",o=await(await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages?q=${encodeURIComponent(i)}&maxResults=50`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json(),l=[];for(const u of o.messages||[]){const m=await(await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${u.id}`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json(),p=this.parseGmailMessage(m);p&&l.push(p)}return l}catch(i){return console.error("Gmail fetch failed:",i),[]}}async fetchCalendarActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockCalendarActivities();try{const i=t?t.toISOString():new Date(Date.now()-6048e5).toISOString();return((await(await fetch(`https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=${i}&singleEvents=true&orderBy=startTime`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json()).items||[]).map(this.parseCalendarEvent).filter(Boolean)}catch(i){return console.error("Calendar fetch failed:",i),[]}}async fetchDocsActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockDocsActivities();try{const i=t?`modifiedTime > '${t.toISOString()}'`:"";return((await(await fetch(`https://www.googleapis.com/drive/v3/files?q=mimeType='application/vnd.google-apps.document'${i?` and ${i}`:""}&fields=files(id,name,modifiedTime,lastModifyingUser)&orderBy=modifiedTime desc`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json()).files||[]).map(this.parseDocsActivity).filter(Boolean)}catch(i){return console.error("Docs fetch failed:",i),[]}}async fetchSheetsActivities(e,t){if(this.config.clientId==="demo-client-id")return this.getMockSheetsActivities();try{const i=t?`modifiedTime > '${t.toISOString()}'`:"";return((await(await fetch(`https://www.googleapis.com/drive/v3/files?q=mimeType='application/vnd.google-apps.spreadsheet'${i?` and ${i}`:""}&fields=files(id,name,modifiedTime,lastModifyingUser)&orderBy=modifiedTime desc`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).json()).files||[]).map(this.parseSheetsActivity).filter(Boolean)}catch(i){return console.error("Sheets fetch failed:",i),[]}}async fetchAllActivities(e){const t=this.getStoredAccount();if(!t)return[];const[i,a,o,l]=await Promise.all([this.fetchGmailActivities(t,e),this.fetchCalendarActivities(t,e),this.fetchDocsActivities(t,e),this.fetchSheetsActivities(t,e)]);return[...i,...a,...o,...l].sort((u,f)=>new Date(f.startTime).getTime()-new Date(u.startTime).getTime())}parseGmailMessage(e){try{const t=e.payload.headers,i=t.find(u=>u.name==="Subject")?.value||"No Subject",a=t.find(u=>u.name==="From")?.value||"",o=t.find(u=>u.name==="To")?.value||"",l=t.find(u=>u.name==="Date")?.value;return{id:`gmail-${e.id}`,type:"gmail",title:`Email: ${i}`,description:`From: ${a}, To: ${o}`,startTime:new Date(l).toISOString(),duration:5,participants:[a,o].filter(Boolean),emailId:e.id,suggestedProject:this.suggestProject(i),suggestedClient:this.suggestClient(a+" "+o),confidence:.7,metadata:{subject:i,from:a,to:o,threadId:e.threadId}}}catch{return null}}parseCalendarEvent=e=>{try{const t=new Date(e.start?.dateTime||e.start?.date),i=new Date(e.end?.dateTime||e.end?.date),a=Math.round((i.getTime()-t.getTime())/(1e3*60));return{id:`calendar-${e.id}`,type:"calendar",title:e.summary||"Untitled Event",description:e.description||"",startTime:t.toISOString(),endTime:i.toISOString(),duration:a,participants:(e.attendees||[]).map(o=>o.email),calendarEventId:e.id,suggestedProject:this.suggestProject(e.summary||""),suggestedClient:this.suggestClient((e.attendees||[]).map(o=>o.email).join(" ")),confidence:.9,metadata:{location:e.location,hangoutLink:e.hangoutLink}}}catch{return null}};parseDocsActivity=e=>{try{const t=new Date(e.modifiedTime);return{id:`docs-${e.id}`,type:"docs",title:`Document: ${e.name}`,description:"Edited document",startTime:t.toISOString(),duration:30,documentId:e.id,suggestedProject:this.suggestProject(e.name),suggestedClient:this.suggestClient(e.name),confidence:.6,metadata:{fileName:e.name,lastModifyingUser:e.lastModifyingUser}}}catch{return null}};parseSheetsActivity=e=>{try{const t=new Date(e.modifiedTime);return{id:`sheets-${e.id}`,type:"sheets",title:`Spreadsheet: ${e.name}`,description:"Updated spreadsheet",startTime:t.toISOString(),duration:20,documentId:e.id,suggestedProject:this.suggestProject(e.name),suggestedClient:this.suggestClient(e.name),confidence:.6,metadata:{fileName:e.name,lastModifyingUser:e.lastModifyingUser}}}catch{return null}};suggestProject(e){const t={"project alpha":"Project Alpha",beta:"Project Beta",website:"Website Development",mobile:"Mobile App",api:"API Development",design:"Design Work",meeting:"Client Meetings",planning:"Project Planning"},i=e.toLowerCase();for(const[a,o]of Object.entries(t))if(i.includes(a))return o;return"General Work"}suggestClient(e){const t={acme:"Acme Corp",tech:"TechCorp",global:"Global Industries",startup:"Startup Inc",enterprise:"Enterprise Solutions"},i=e.toLowerCase();for(const[a,o]of Object.entries(t))if(i.includes(a))return o;return"Internal"}getMockGmailActivities(){return[{id:"gmail-1",type:"gmail",title:"Email: Project Alpha Status Update",description:"From: client@acme.com, To: me@company.com",startTime:new Date(Date.now()-2*60*60*1e3).toISOString(),duration:5,participants:["client@acme.com","me@company.com"],emailId:"msg-123",suggestedProject:"Project Alpha",suggestedClient:"Acme Corp",confidence:.8,metadata:{subject:"Project Alpha Status Update"}},{id:"gmail-2",type:"gmail",title:"Email: Meeting Follow-up",description:"From: me@company.com, To: team@techcorp.com",startTime:new Date(Date.now()-4*60*60*1e3).toISOString(),duration:3,participants:["me@company.com","team@techcorp.com"],emailId:"msg-124",suggestedProject:"Client Meetings",suggestedClient:"TechCorp",confidence:.7,metadata:{subject:"Meeting Follow-up"}}]}getMockCalendarActivities(){return[{id:"calendar-1",type:"calendar",title:"Project Alpha Planning Meeting",description:"Quarterly planning session for Project Alpha",startTime:new Date(Date.now()-1*60*60*1e3).toISOString(),endTime:new Date(Date.now()-0*60*60*1e3).toISOString(),duration:60,participants:["john@acme.com","sarah@acme.com"],calendarEventId:"cal-123",suggestedProject:"Project Alpha",suggestedClient:"Acme Corp",confidence:.9,metadata:{location:"Conference Room A"}}]}getMockDocsActivities(){return[{id:"docs-1",type:"docs",title:"Document: Project Specification",description:"Edited document",startTime:new Date(Date.now()-3*60*60*1e3).toISOString(),duration:45,documentId:"doc-123",suggestedProject:"Project Alpha",suggestedClient:"Acme Corp",confidence:.8,metadata:{fileName:"Project Specification"}}]}getMockSheetsActivities(){return[{id:"sheets-1",type:"sheets",title:"Spreadsheet: Budget Tracking",description:"Updated spreadsheet",startTime:new Date(Date.now()-5*60*60*1e3).toISOString(),duration:25,documentId:"sheet-123",suggestedProject:"Project Planning",suggestedClient:"Internal",confidence:.6,metadata:{fileName:"Budget Tracking"}}]}}const MM=new RM;function LM(){const[n,e]=W.useState("loading"),[t,i]=W.useState("Processing Google authentication..."),[a]=rE(),o=Jo();return W.useEffect(()=>{(async()=>{try{const u=a.get("code"),f=a.get("error"),m=a.get("state");if(f)throw new Error(`Authentication failed: ${f}`);if(!u)throw new Error("No authorization code received");const p=await MM.exchangeCodeForTokens(u);window.opener?(window.opener.postMessage({type:"GOOGLE_AUTH_SUCCESS",account:p},window.location.origin),window.close()):(e("success"),i("Google account connected successfully! Redirecting..."),setTimeout(()=>{o("/integrations")},2e3))}catch(u){console.error("OAuth callback error:",u),e("error"),i(u instanceof Error?u.message:"Authentication failed"),window.opener?(window.opener.postMessage({type:"GOOGLE_AUTH_ERROR",error:u instanceof Error?u.message:"Authentication failed"},window.location.origin),window.close()):setTimeout(()=>{o("/integrations")},3e3)}})()},[a,o]),d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center",children:[n==="loading"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connecting to Google"}),d.jsx("p",{className:"text-gray-600",children:t})]}),n==="success"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-green-100 rounded-full",children:d.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),d.jsx("h2",{className:"text-xl font-semibold text-green-900 mb-2",children:"Success!"}),d.jsx("p",{className:"text-green-600",children:t})]}),n==="error"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:d.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),d.jsx("h2",{className:"text-xl font-semibold text-red-900 mb-2",children:"Authentication Failed"}),d.jsx("p",{className:"text-red-600 mb-4",children:t}),d.jsx("button",{onClick:()=>o("/integrations"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Back to Integrations"})]})]})})}function IM(){return d.jsx(fE,{children:d.jsx(gE,{children:d.jsx(eE,{children:d.jsxs(Dw,{children:[d.jsx(jn,{path:"/login",element:d.jsx(SE,{})}),d.jsx(jn,{path:"/auth/google/callback",element:d.jsx(LM,{})}),d.jsx(jn,{path:"/:accountId/:visitorId/dashboard",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/reports",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/ai-insights",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/permissions",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/settings",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/privacy",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/:accountId/:visitorId/integrations",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/dashboard",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/reports",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/ai-insights",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/permissions",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/settings",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/privacy",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/integrations",element:d.jsx(pi,{children:d.jsx(vi,{})})}),d.jsx(jn,{path:"/",element:d.jsx(eb,{to:"/dashboard",replace:!0})})]})})})})}UT.createRoot(document.getElementById("root")).render(d.jsx(zo.StrictMode,{children:d.jsx(IM,{})}));
